---
ms.assetid: 
title: aaaAzure Key Vault mjuk borttagning | Microsoft Docs
ms.service: key-vault
author: BrucePerlerMS
ms.author: bruceper
manager: mbaldwin
ms.date: 07/10/2017
ms.openlocfilehash: 1b402c58db6f25ae4ae5e2720786fa81eb0e839a
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 10/06/2017
---
# <a name="azure-key-vault-soft-delete-overview"></a><span data-ttu-id="32ef0-102">Översikt för mjuk borttagning av Azure Key Vault</span><span class="sxs-lookup"><span data-stu-id="32ef0-102">Azure Key Vault soft-delete overview</span></span>

<span data-ttu-id="32ef0-103">Key Vault mjuk borttagning funktionen kan återställning av hello bort valv och valvet objekt, kallas även mjuk borttagning.</span><span class="sxs-lookup"><span data-stu-id="32ef0-103">Key Vault's soft delete feature allows recovery of hello deleted vaults and vault objects, known as soft-delete.</span></span> <span data-ttu-id="32ef0-104">Mer specifikt adressera vi hello följande scenarier:</span><span class="sxs-lookup"><span data-stu-id="32ef0-104">Specifically, we address hello following scenarios:</span></span>

- <span data-ttu-id="32ef0-105">Stöd för återställningsbara borttagningen av ett nyckelvalv</span><span class="sxs-lookup"><span data-stu-id="32ef0-105">Support for recoverable deletion of a key vault</span></span>
- <span data-ttu-id="32ef0-106">Stöd för återställningsbara borttagning av nyckelvalv objekt (t.ex.</span><span class="sxs-lookup"><span data-stu-id="32ef0-106">Support for recoverable deletion of key vault objects (ex.</span></span> <span data-ttu-id="32ef0-107">nycklar, hemligheter, certifikat)</span><span class="sxs-lookup"><span data-stu-id="32ef0-107">keys, secrets, certificates)</span></span>

## <a name="supporting-interfaces"></a><span data-ttu-id="32ef0-108">Stöder gränssnitt</span><span class="sxs-lookup"><span data-stu-id="32ef0-108">Supporting interfaces</span></span>

<span data-ttu-id="32ef0-109">hello soft-ta bort funktionen är är tillgängliga via hello vila, .NET / C# och PowerShell-gränssnitt.</span><span class="sxs-lookup"><span data-stu-id="32ef0-109">hello soft-delete feature is initially available through hello REST, .NET/C# and PowerShell interfaces.</span></span> <span data-ttu-id="32ef0-110">Se toohello referenser för dessa mer information [valvet nyckelreferens](https://docs.microsoft.com/azure/key-vault/).</span><span class="sxs-lookup"><span data-stu-id="32ef0-110">Refer toohello references for these for more details, [Key Vault Reference](https://docs.microsoft.com/azure/key-vault/).</span></span>

## <a name="scenarios"></a><span data-ttu-id="32ef0-111">Scenarier</span><span class="sxs-lookup"><span data-stu-id="32ef0-111">Scenarios</span></span>

<span data-ttu-id="32ef0-112">Azure Key valv är spårade resurser som hanteras av Azure Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="32ef0-112">Azure Key Vaults are tracked resources, managed by Azure Resource Manager.</span></span> <span data-ttu-id="32ef0-113">Azure Resource Manager anger också en väldefinierad beteendet för borttagning, vilket kräver att en lyckad borttagningsåtgärd måste resultera i den här resursen inte är tillgänglig längre.</span><span class="sxs-lookup"><span data-stu-id="32ef0-113">Azure Resource Manager also specifies a well-defined behavior for deletion, which requires that a successful DELETE operation must result in that resource not being accessible anymore.</span></span> <span data-ttu-id="32ef0-114">hello soft-ta bort funktionen adresser hello återställning av hello bort objektet om hello borttagning har oavsiktligt eller avsiktligt.</span><span class="sxs-lookup"><span data-stu-id="32ef0-114">hello soft-delete feature addresses hello recovery of hello deleted object, whether hello deletion was accidental or intentional.</span></span>

1. <span data-ttu-id="32ef0-115">I hello typiskt scenario, kan en användare ha oavsiktligt bort ett nyckelvalv eller ett nyckelvalv-objekt. Om den nyckelvalv eller nyckel valvet objektet har toobe återställningsbara för en förutbestämd tid, hello användaren Ångra hello borttagning och återställa data.</span><span class="sxs-lookup"><span data-stu-id="32ef0-115">In hello typical scenario, a user may have inadvertently deleted a key vault or a key vault object; if that key vault or key vault object were toobe recoverable for a predetermined period, hello user may undo hello deletion and recover their data.</span></span>

2. <span data-ttu-id="32ef0-116">I ett annat scenario kan en obehörig användare försöka toodelete ett nyckelvalv eller ett nyckelvalv objekt, t.ex en nyckel i ett valv, toocause avbrott i verksamheten.</span><span class="sxs-lookup"><span data-stu-id="32ef0-116">In a different scenario, a rogue user may attempt toodelete a key vault or a key vault object, such as a key inside a vault, toocause a business disruption.</span></span> <span data-ttu-id="32ef0-117">Avgränsa hello borttagning av hello nyckelvalv eller nyckelvalv objekt från hello faktiska borttagning av hello underliggande data kan användas som en säkerhetsåtgärd genom att, exempelvis att begränsa behörigheter för data tas bort tooa olika, betrodd roll.</span><span class="sxs-lookup"><span data-stu-id="32ef0-117">Separating hello deletion of hello key vault or key vault object from hello actual deletion of hello underlying data can be used as a safety measure by, for instance, restricting permissions on data deletion tooa different, trusted role.</span></span> <span data-ttu-id="32ef0-118">Den här metoden kräver i praktiken kvorum för en åtgärd som annars kan leda till en omedelbar dataförlust.</span><span class="sxs-lookup"><span data-stu-id="32ef0-118">This approach effectively requires quorum for an operation which might otherwise result in an immediate data loss.</span></span>

### <a name="soft-delete-behavior"></a><span data-ttu-id="32ef0-119">Beteende för mjuk borttagning</span><span class="sxs-lookup"><span data-stu-id="32ef0-119">Soft-delete behavior</span></span>

<span data-ttu-id="32ef0-120">Med den här funktionen hello DELETE-åtgärden på ett nyckelvalv eller nyckelvalv objektet är en mjuk borttagning effektivt hålla hello resurser under en viss period, medan ger hello utseende hello objektet tas bort.</span><span class="sxs-lookup"><span data-stu-id="32ef0-120">With this feature, hello DELETE operation on a key vault or key vault object is a soft-delete, effectively holding hello resources for a given retention period, while giving hello appearance that hello object is deleted.</span></span> <span data-ttu-id="32ef0-121">ytterligare hello-tjänsten tillhandahåller en mekanism för att återställa hello bort objektet, i stort sett Ångra hello borttagning.</span><span class="sxs-lookup"><span data-stu-id="32ef0-121">hello service further provides a mechanism for recovering hello deleted object, essentially undoing hello deletion.</span></span> 

<span data-ttu-id="32ef0-122">Mjuk borttagning är ett valfritt Key Vault-beteende och **inte aktiverad som standard** i den här versionen.</span><span class="sxs-lookup"><span data-stu-id="32ef0-122">Soft-delete is an optional Key Vault behavior and is **not enabled by default** in this release.</span></span> <span data-ttu-id="32ef0-123">Mer information om hur du aktiverar mjuk borttagning för nyckelvalvet, finns hello specifika anvisningar i hello referens för hello-gränssnittet för ditt val [valvet nyckelreferens](https://docs.microsoft.com/azure/key-vault/).</span><span class="sxs-lookup"><span data-stu-id="32ef0-123">For details on enabling soft-delete for your key vault, see hello specific guidance in hello reference for hello interface of your choice, [Key Vault Reference](https://docs.microsoft.com/azure/key-vault/).</span></span>

### <a name="key-vault-recovery"></a><span data-ttu-id="32ef0-124">Nyckelvalv återställning</span><span class="sxs-lookup"><span data-stu-id="32ef0-124">Key vault recovery</span></span>

<span data-ttu-id="32ef0-125">När du tar bort ett nyckelvalv skapar hello tjänsten en proxy-resurs under hello-prenumeration, lägga till tillräckligt metadata för återställning.</span><span class="sxs-lookup"><span data-stu-id="32ef0-125">Upon deleting a key vault, hello service creates a proxy resource under hello subscription, adding sufficient metadata for recovery.</span></span> <span data-ttu-id="32ef0-126">hello proxy resursen är en lagrade objektet finns i hello samma plats som hello bort nyckelvalvet.</span><span class="sxs-lookup"><span data-stu-id="32ef0-126">hello proxy resource is a stored object, available in hello same location as hello deleted key vault.</span></span> 

### <a name="key-vault-object-recovery"></a><span data-ttu-id="32ef0-127">Nyckelvalv objektåterställning</span><span class="sxs-lookup"><span data-stu-id="32ef0-127">Key vault object recovery</span></span>

<span data-ttu-id="32ef0-128">När du tar bort ett nyckelvalv objekt, t.ex en nyckel placerar hello service hello objekt i ett borttaget tillstånd vilket gör den tillgänglig tooany hämtning av åtgärder.</span><span class="sxs-lookup"><span data-stu-id="32ef0-128">Upon deleting a key vault object, such as a key, hello service will place hello object in a deleted state, thus making it inaccessible tooany retrieval operations.</span></span> <span data-ttu-id="32ef0-129">I det här tillståndet kan hello nyckelvalv objekt bara visas, återställda eller tvång/tas bort permanent.</span><span class="sxs-lookup"><span data-stu-id="32ef0-129">While in this state, hello key vault object can only be listed, recovered, or forcefully/permanently deleted.</span></span> 

<span data-ttu-id="32ef0-130">Vid hello samma time, Key Vault schemalägger hello borttagning av hello underliggande data motsvarande toohello bort nyckelvalv eller nyckelvalv objekt för körning när ett förutbestämt Kvarhållningsintervall.</span><span class="sxs-lookup"><span data-stu-id="32ef0-130">At hello same time, Key Vault will schedule hello deletion of hello underlying data corresponding toohello deleted key vault or key vault object for execution after a predetermined retention interval.</span></span> <span data-ttu-id="32ef0-131">hello DNS-poster motsvarande toohello valv bevaras också hello länge hello Kvarhållningsintervall.</span><span class="sxs-lookup"><span data-stu-id="32ef0-131">hello DNS record corresponding toohello vault is also retained for hello duration of hello retention interval.</span></span>

### <a name="soft-delete-retention-period"></a><span data-ttu-id="32ef0-132">Kvarhållningsperiod för mjuk borttagning</span><span class="sxs-lookup"><span data-stu-id="32ef0-132">Soft-delete retention period</span></span>

<span data-ttu-id="32ef0-133">Ej permanent borttagna resurser bevaras under en angiven tidsperiod, 90 dagar.</span><span class="sxs-lookup"><span data-stu-id="32ef0-133">Soft deleted resources are retained for a set period of time, 90 days.</span></span> <span data-ttu-id="32ef0-134">Under hello mjuk borttagning Kvarhållningsintervall, hello följande gäller:</span><span class="sxs-lookup"><span data-stu-id="32ef0-134">During hello soft-delete retention interval, hello following apply:</span></span>

- <span data-ttu-id="32ef0-135">Du kan visa alla hello nyckelvalv och nyckelvalv objekt borttagningsstatus hello soft-för din prenumeration, samt komma åt tas bort och återställa information om dem.</span><span class="sxs-lookup"><span data-stu-id="32ef0-135">You may list all of hello key vaults and key vault objects in hello soft-delete state for your subscription as well as access deletion and recovery information about them.</span></span>
    - <span data-ttu-id="32ef0-136">Endast användare med särskilda behörigheter kan visa en lista över borttagna valv.</span><span class="sxs-lookup"><span data-stu-id="32ef0-136">Only users with special permissions can list deleted vaults.</span></span> <span data-ttu-id="32ef0-137">Vi rekommenderar att våra användare skapar en anpassad roll med dessa särskilda behörigheter för hantering av bort valv.</span><span class="sxs-lookup"><span data-stu-id="32ef0-137">We recommend that our users create a custom role with these special permissions for handling deleted vaults.</span></span>
- <span data-ttu-id="32ef0-138">Nyckelvalv med samma namn inte kan skapas i hello hello samma plats. på motsvarande sätt ett nyckelvalv-objekt kan inte skapas i ett givet valv om att nyckelvalvet innehåller ett objekt med hello samma namn och som är i ett borttaget tillstånd</span><span class="sxs-lookup"><span data-stu-id="32ef0-138">A key vault with hello same name cannot be created in hello same location; correspondingly, a key vault object cannot be created in a given vault if that key vault contains an object with hello same name and which is in a deleted state</span></span> 
- <span data-ttu-id="32ef0-139">Endast en specifikt Privilegierade användare kan återställa en nyckelvalv eller ett nyckelvalv objekt genom att utfärda kommandot Återställ på hello motsvarande proxy-resurs.</span><span class="sxs-lookup"><span data-stu-id="32ef0-139">Only a specifically privileged user may restore a key vault or key vault object by issuing a recover command on hello corresponding proxy resource.</span></span>
    - <span data-ttu-id="32ef0-140">hello användaren tillhör hello anpassad roll, som har hello privilegium toocreate nyckelvalv under hello resursgrupp kan återställa hello-valvet.</span><span class="sxs-lookup"><span data-stu-id="32ef0-140">hello user, member of hello custom role, who has hello privilege toocreate a key vault under hello resource group can restore hello vault.</span></span>
- <span data-ttu-id="32ef0-141">Bara en specifikt Privilegierade användare kan framtvinga ta bort ett nyckelvalv eller nyckelvalv objekt genom att utfärda ett borttagningskommando på hello motsvarande proxy-resurs.</span><span class="sxs-lookup"><span data-stu-id="32ef0-141">Only a specifically privileged user may forcibly delete a key vault or key vault object by issuing a delete command on hello corresponding proxy resource.</span></span>

<span data-ttu-id="32ef0-142">Om ett nyckelvalv eller nyckelvalv objekt återställs utför hello slutet av hello kvarhållning intervall hello-tjänsten en rensning av hello ej permanent borttagna nyckelvalv eller nyckelvalv objekt och dess innehåll.</span><span class="sxs-lookup"><span data-stu-id="32ef0-142">Unless a key vault or key vault object is recovered, at hello end of hello retention interval hello service performs a purge of hello soft-deleted key vault or key vault object and its content.</span></span> <span data-ttu-id="32ef0-143">Ta bort resursen kan inte planeras.</span><span class="sxs-lookup"><span data-stu-id="32ef0-143">Resource deletion may not be rescheduled.</span></span>

### <a name="permitted-purge"></a><span data-ttu-id="32ef0-144">Tillåtna Rensa</span><span class="sxs-lookup"><span data-stu-id="32ef0-144">Permitted purge</span></span>

<span data-ttu-id="32ef0-145">Permanent ta bort, rensa, ett nyckelvalv går via en POST-åtgärd på hello proxy resursen och kräver särskilda behörigheter.</span><span class="sxs-lookup"><span data-stu-id="32ef0-145">Permanently deleting, purging, a key vault is possible via a POST operation on hello proxy resource and requires special privileges.</span></span> <span data-ttu-id="32ef0-146">I allmänhet blir endast hello prenumerationsägaren kan toopurge ett nyckelvalv.</span><span class="sxs-lookup"><span data-stu-id="32ef0-146">Generally, only hello subscription owner will be able toopurge a key vault.</span></span> <span data-ttu-id="32ef0-147">hello efter åtgärden utlösare hello omedelbart och oåterkalleligt borttagning av det valvet.</span><span class="sxs-lookup"><span data-stu-id="32ef0-147">hello POST operation triggers hello immediate and irrecoverable deletion of that vault.</span></span> 

<span data-ttu-id="32ef0-148">Ett undantag toothis gäller hello när hello Azure-prenumeration har markerats som *permanent*.</span><span class="sxs-lookup"><span data-stu-id="32ef0-148">An exception toothis is hello case when hello Azure subscription has been marked as *undeletable*.</span></span> <span data-ttu-id="32ef0-149">I det här fallet hello-tjänsten kan sedan utföra hello faktiska borttagning och sker detta som en schemalagd process.</span><span class="sxs-lookup"><span data-stu-id="32ef0-149">In this case, only hello service may then perform hello actual deletion, and does so as a scheduled process.</span></span> 



