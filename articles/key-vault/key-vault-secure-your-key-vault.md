---
title: aaaSecure din nyckel valvet | Microsoft Docs
description: "Hantera åtkomstbehörigheter för nyckelvalv för att hantera valv och nycklar och hemligheter. Autentisering och auktorisering modell för nyckelvalvet och hur toosecure din nyckel valvet"
services: key-vault
documentationcenter: 
author: amitbapat
manager: mbaldwin
tags: azure-resource-manager
ms.assetid: e5b4e083-4a39-4410-8e3a-2832ad6db405
ms.service: key-vault
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: hero-article
ms.date: 01/07/2017
ms.author: ambapat
ms.openlocfilehash: 84f5fc18142a1ad89babbd11f4f65eca105afc32
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 10/06/2017
---
# <a name="secure-your-key-vault"></a><span data-ttu-id="9d313-104">Säkra ditt nyckelvalv</span><span class="sxs-lookup"><span data-stu-id="9d313-104">Secure your key vault</span></span>
<span data-ttu-id="9d313-105">Azure Key Vault är en molntjänst som skyddar krypteringsnycklar och hemligheter (som certifikat, anslutningssträngar, lösenord) för dina molnprogram.</span><span class="sxs-lookup"><span data-stu-id="9d313-105">Azure Key Vault is a cloud service that safeguards encryption keys and secrets (such as certificates, connection strings, passwords) for your cloud applications.</span></span> <span data-ttu-id="9d313-106">Eftersom dessa data är skiftlägeskänsliga och verksamhetskritiska, du vill toosecure åtkomst tooyour nyckelvalv så att endast behöriga program och användare kan komma åt nyckelvalvet.</span><span class="sxs-lookup"><span data-stu-id="9d313-106">Since this data is sensitive and business critical, you want toosecure access tooyour key vaults so that only authorized applications and users can access key vault.</span></span> <span data-ttu-id="9d313-107">Den här artikeln innehåller en översikt över nyckelvalv modell, förklarar autentisering och auktorisering och beskriver hur toosecure åtkomst tookey valvet för dina molnprogram med ett exempel.</span><span class="sxs-lookup"><span data-stu-id="9d313-107">This article provides an overview of key vault access model, explains authentication and authorization, and describes how toosecure access tookey vault for your cloud applications with an example.</span></span>

## <a name="overview"></a><span data-ttu-id="9d313-108">Översikt</span><span class="sxs-lookup"><span data-stu-id="9d313-108">Overview</span></span>
<span data-ttu-id="9d313-109">Åtkomst tooa nyckelvalv styrs via två separata gränssnitt: management plan och dataplan.</span><span class="sxs-lookup"><span data-stu-id="9d313-109">Access tooa key vault is controlled through two separate interfaces: management plane and data plane.</span></span> <span data-ttu-id="9d313-110">För båda planen krävs korrekt autentisering och auktorisering innan en anropare (en användare eller ett program) får åtkomst tookey valvet.</span><span class="sxs-lookup"><span data-stu-id="9d313-110">For both planes proper authentication and authorization is required before a caller (a user or an application) can get access tookey vault.</span></span> <span data-ttu-id="9d313-111">Autentisering upprättar hello identitet hello anroparen medan auktorisering avgör vilka åtgärder hello anroparen tillåts tooperform.</span><span class="sxs-lookup"><span data-stu-id="9d313-111">Authentication establishes hello identity of hello caller, while authorization determines what operations hello caller is allowed tooperform.</span></span>

<span data-ttu-id="9d313-112">Både hanteringsplanet och dataplanet använder sig av Azure Active Directory för autentisering.</span><span class="sxs-lookup"><span data-stu-id="9d313-112">For authentication both management plane and data plane use Azure Active Directory.</span></span> <span data-ttu-id="9d313-113">För auktorisering använder sig hanteringsplanet av rollbaserad åtkomstkontroll (RBAC) medan dataplanet använder sig av nyckelvalvets åtkomstprincip.</span><span class="sxs-lookup"><span data-stu-id="9d313-113">For authorization, management plane uses role-based access control (RBAC) while data plane uses key vault access policy.</span></span>

<span data-ttu-id="9d313-114">Här är en kort översikt över hello ämnen som:</span><span class="sxs-lookup"><span data-stu-id="9d313-114">Here is a brief overview of hello topics covered:</span></span>

<span data-ttu-id="9d313-115">[Autentisering med hjälp av Azure Active Directory](#authentication-using-azure-active-directory) – det här avsnittet beskrivs hur en anropare autentiserar med Azure Active Directory tooaccess nyckelvalv via management plan och dataplan.</span><span class="sxs-lookup"><span data-stu-id="9d313-115">[Authentication using Azure Active Directory](#authentication-using-azure-active-directory) - This section explains how a caller authenticates with Azure Active Directory tooaccess a key vault via management plane and data plane.</span></span> 

<span data-ttu-id="9d313-116">[Hanteringsplanet och dataplanet](#management-plane-and-data-plane) – Hanteringsplanet och dataplanet är två åtkomstplan som används för åtkomst till ditt nyckelvalv.</span><span class="sxs-lookup"><span data-stu-id="9d313-116">[Management plane and data plane](#management-plane-and-data-plane) - Management plane and data plane are two access planes used for accessing your key vault.</span></span> <span data-ttu-id="9d313-117">Varje åtkomstplan har stöd för specifika åtgärder.</span><span class="sxs-lookup"><span data-stu-id="9d313-117">Each access plane supports specific operations.</span></span> <span data-ttu-id="9d313-118">Det här avsnittet beskrivs hello åtkomst slutpunkter, åtgärder som stöds och åtkomst till kontrollmetod som används av varje plan.</span><span class="sxs-lookup"><span data-stu-id="9d313-118">This section describes hello access endpoints, operations supported, and access control method used by each plane.</span></span> 

<span data-ttu-id="9d313-119">[Åtkomstkontroll för hantering av plan](#management-plane-access-control) – i det här avsnittet ska vi titta på att tillåta åtkomst toomanagement plan åtgärder med hjälp av rollbaserad åtkomstkontroll.</span><span class="sxs-lookup"><span data-stu-id="9d313-119">[Management plane access control](#management-plane-access-control) - In this section we'll look at allowing access toomanagement plane operations using role-based access control.</span></span>

<span data-ttu-id="9d313-120">[Åtkomstkontroll för data plan](#data-plane-access-control) – det här avsnittet beskrivs hur toocontrol för toouse nyckelvalv åtkomst principdata plan åtkomst.</span><span class="sxs-lookup"><span data-stu-id="9d313-120">[Data plane access control](#data-plane-access-control) - This section describes how toouse key vault access policy toocontrol data plane access.</span></span>

<span data-ttu-id="9d313-121">[Exempel](#example) -detta exempel beskrivs hur toosetup åtkomstkontroll för ditt nyckelvalv tooallow tre olika teamen (säkerhetsteam, utvecklare/operatorer och granskare) tooperform specifika uppgifter toodevelop, hantera och övervaka ett program i Azure .</span><span class="sxs-lookup"><span data-stu-id="9d313-121">[Example](#example) - This example describes how toosetup access control for your key vault tooallow three different teams (security team, developers/operators, and auditors) tooperform specific tasks toodevelop, manage and monitor an application in Azure.</span></span>

## <a name="authentication-using-azure-active-directory"></a><span data-ttu-id="9d313-122">Autentisering med Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="9d313-122">Authentication using Azure Active Directory</span></span>
<span data-ttu-id="9d313-123">När du skapar en nyckelvalvet i en Azure-prenumeration associeras den automatiskt med hello prenumeration Azure Active Directory-klient.</span><span class="sxs-lookup"><span data-stu-id="9d313-123">When you create a key vault in an Azure subscription, it is automatically associated with hello subscription's Azure Active Directory tenant.</span></span> <span data-ttu-id="9d313-124">Anropare (användare och program) måste vara registrerade i den här innehavaren tooaccess denna nyckelvalvet.</span><span class="sxs-lookup"><span data-stu-id="9d313-124">All callers (users and applications) must be registered in this tenant tooaccess this key vault.</span></span> <span data-ttu-id="9d313-125">Ett program eller en användare måste autentisera med Azure Active Directory tooaccess nyckelvalvet.</span><span class="sxs-lookup"><span data-stu-id="9d313-125">An application or a user must authenticate with Azure Active Directory tooaccess key vault.</span></span> <span data-ttu-id="9d313-126">Detta gäller tooboth management plan och dataplan åtkomst.</span><span class="sxs-lookup"><span data-stu-id="9d313-126">This applies tooboth management plane and data plane access.</span></span> <span data-ttu-id="9d313-127">I bägge fallen, kan ett program få åtkomst till nyckelvalvet på två sätt:</span><span class="sxs-lookup"><span data-stu-id="9d313-127">In both cases, an application can access key vault in two ways:</span></span>

* <span data-ttu-id="9d313-128">**användare+appåtkomst** – vanligtvis är det här för program som har åtkomst till nyckelvalvet åt en inloggad användare.</span><span class="sxs-lookup"><span data-stu-id="9d313-128">**user+app access** - usually this is for applications that access key vault on behalf of a signed-in user.</span></span> <span data-ttu-id="9d313-129">Azure PowerShell, Azure Portal är exempel på den här typen av åtkomst.</span><span class="sxs-lookup"><span data-stu-id="9d313-129">Azure PowerShell, Azure Portal are examples of this type of access.</span></span> <span data-ttu-id="9d313-130">Det finns två sätt toogrant åtkomst toousers: enkelriktade toogrant åtkomst toousers så att de kan komma åt nyckelvalvet från alla program och hello annat sätt är toogrant ett användaren åtkomst tookey valv endast när de använder ett visst program (refererad tooas sammansatt identitet).</span><span class="sxs-lookup"><span data-stu-id="9d313-130">There are two ways toogrant access toousers: one way is toogrant access toousers so they can access key vault from any application and hello other way is toogrant a user access tookey vault only when they use a specific application (referred tooas compound identity).</span></span> 
* <span data-ttu-id="9d313-131">**endast App-åtkomst** – för program att köra daemon services bakgrundsjobb etc. hello Programidentitet beviljas åtkomst till toohello nyckeln valvet.</span><span class="sxs-lookup"><span data-stu-id="9d313-131">**app-only access** - for applications that run daemon services, background jobs etc. hello application's identity is granted access toohello key vault.</span></span>

<span data-ttu-id="9d313-132">I båda typer av program hello programmet autentiserar med Azure Active Directory med hjälp av hello [stöds autentiseringsmetoder](../active-directory/active-directory-authentication-scenarios.md) och skaffar en token.</span><span class="sxs-lookup"><span data-stu-id="9d313-132">In both types of applications, hello application authenticates with Azure Active Directory using any of hello [supported authentication methods](../active-directory/active-directory-authentication-scenarios.md) and acquires a token.</span></span> <span data-ttu-id="9d313-133">Autentiseringsmetod som används beror på programmet hello.</span><span class="sxs-lookup"><span data-stu-id="9d313-133">Authentication method used depends on hello application type.</span></span> <span data-ttu-id="9d313-134">Sedan hello program använder den här token och skickar REST API-begäran tookey valvet.</span><span class="sxs-lookup"><span data-stu-id="9d313-134">Then hello application uses this token and sends REST API request tookey vault.</span></span> <span data-ttu-id="9d313-135">Vid hantering av plan åtkomst hello dirigeras begäranden via Azure Resource Manager-slutpunkten.</span><span class="sxs-lookup"><span data-stu-id="9d313-135">In case of management plane access hello requests are routed through Azure Resource Manager endpoint.</span></span> <span data-ttu-id="9d313-136">Vid åtkomst till dataplan pratar hello program direkt tooa nyckelvalv slutpunkt.</span><span class="sxs-lookup"><span data-stu-id="9d313-136">When accessing data plane, hello applications talks directly tooa key vault endpoint.</span></span> <span data-ttu-id="9d313-137">Visa mer information om hello [hela autentiseringsflödet](../active-directory/active-directory-protocols-oauth-code.md).</span><span class="sxs-lookup"><span data-stu-id="9d313-137">See more details on hello [whole authentication flow](../active-directory/active-directory-protocols-oauth-code.md).</span></span> 

<span data-ttu-id="9d313-138">hello resursnamnet som hello begär en token är olika beroende på om hello programmet försöker använda management plan eller dataplan.</span><span class="sxs-lookup"><span data-stu-id="9d313-138">hello resource name for which hello application requests a token is different depending on whether hello application is accessing management plane or data plane.</span></span> <span data-ttu-id="9d313-139">Därför är hello resursnamnet antingen plan eller data plan hanteringsslutpunkten beskrivs i hello tabell i ett senare avsnitt, beroende på hello Azure-miljön.</span><span class="sxs-lookup"><span data-stu-id="9d313-139">Hence hello resource name is either management plane or data plane endpoint described in hello table in a later section, depending on hello Azure environment.</span></span>

<span data-ttu-id="9d313-140">Med en mekanism för autentisering tooboth har hanterings- och plan sin egen fördelar:</span><span class="sxs-lookup"><span data-stu-id="9d313-140">Having one single mechanism for authentication tooboth management and data plane has its own benefits:</span></span>

* <span data-ttu-id="9d313-141">Organisationer kan centralt styra åtkomst tooall nyckelvalv i organisationen</span><span class="sxs-lookup"><span data-stu-id="9d313-141">Organizations can centrally control access tooall key vaults in their organization</span></span>
* <span data-ttu-id="9d313-142">Om en användare lämnar förlora de omedelbart åtkomsten tooall nyckelvalv i hello organisation</span><span class="sxs-lookup"><span data-stu-id="9d313-142">If a user leaves, they instantly lose access tooall key vaults in hello organization</span></span>
* <span data-ttu-id="9d313-143">Organisationer kan anpassa autentisering via hello alternativ i Azure Active Directory (till exempel aktiverar multifaktorautentisering för extra säkerhet)</span><span class="sxs-lookup"><span data-stu-id="9d313-143">Organizations can customize authentication via hello options in Azure Active Directory (for example, enabling multi-factor authentication for added security)</span></span>

## <a name="management-plane-and-data-plane"></a><span data-ttu-id="9d313-144">Hanteringsplanet och dataplanet</span><span class="sxs-lookup"><span data-stu-id="9d313-144">Management plane and data plane</span></span>
<span data-ttu-id="9d313-145">Azure Key Vault är en Azure-tjänst som finns tillgänglig via distributionsmodellen Azure Resouce Manager.</span><span class="sxs-lookup"><span data-stu-id="9d313-145">Azure Key Vault is an Azure service available via Azure Resource Manager deployment model.</span></span> <span data-ttu-id="9d313-146">När du skapar ett nyckelvalv, får du en virtuell behållare i vilken du kan skapa andra objekt som nycklar, hemligheter och certifikat.</span><span class="sxs-lookup"><span data-stu-id="9d313-146">When you create a key vault, you get a virtual container inside which you can create other objects like keys, secrets, and certificates.</span></span> <span data-ttu-id="9d313-147">Sedan får du åtkomst till nyckelvalvet med plan och data plan tooperform specifika hanteringsåtgärder.</span><span class="sxs-lookup"><span data-stu-id="9d313-147">Then you access your key vault using management plane and data plane tooperform specific operations.</span></span> <span data-ttu-id="9d313-148">Plan för hanteringsgränssnitt är används toomanage din nyckel valvet sig själv, till exempel skapa, ta bort, uppdaterar nyckelvalv attribut och ange åtkomstprinciper för dataplan.</span><span class="sxs-lookup"><span data-stu-id="9d313-148">Management plane interface is used toomanage your key vault itself, such as creating, deleting, updating key vault attributes and setting access policies for data plane.</span></span> <span data-ttu-id="9d313-149">Data plan gränssnittet har använt tooadd, ta bort, ändra och använda hello nycklar och hemligheter certifikat som lagras i nyckelvalvet.</span><span class="sxs-lookup"><span data-stu-id="9d313-149">Data plane interface is used tooadd, delete, modify, and use hello keys, secrets, and certificates stored in your key vault.</span></span>

<span data-ttu-id="9d313-150">hello plan och data plan hanteringsgränssnitt kan nås via olika slutpunkter (se tabell).</span><span class="sxs-lookup"><span data-stu-id="9d313-150">hello management plane and data plane interfaces are accessed through different endpoints (see table).</span></span> <span data-ttu-id="9d313-151">hello andra kolumnen i tabellen hello beskriver hello DNS-namn för de här slutpunkterna i olika miljöer i Azure.</span><span class="sxs-lookup"><span data-stu-id="9d313-151">hello second column in hello table describes hello DNS names for these endpoints in different Azure environments.</span></span> <span data-ttu-id="9d313-152">hello tredje kolumnen beskriver hello åtgärder du kan utföra från varje åtkomst plan.</span><span class="sxs-lookup"><span data-stu-id="9d313-152">hello third column describes hello operations you can perform from each access plane.</span></span> <span data-ttu-id="9d313-153">Varje åtkomstplan har sin egen åtkomstkontroll: för hanteringsplanet är åtkomstkontrollen inställd med Azure Resource Manager rollbaserad åtkomstkontroll (RBAC), medan dataplanets åtkomstkontroll är inställd via nyckelvalvets åtkomstprinciper.</span><span class="sxs-lookup"><span data-stu-id="9d313-153">Each access plane also has its own access control mechanism: for management plane access control is set using Azure Resource Manager Role-Based Access Control (RBAC), while for data plane access control is set using key vault access policy.</span></span>

| <span data-ttu-id="9d313-154">Åtkomstplan</span><span class="sxs-lookup"><span data-stu-id="9d313-154">Access plane</span></span> | <span data-ttu-id="9d313-155">Slutpunkter för åtkomst</span><span class="sxs-lookup"><span data-stu-id="9d313-155">Access endpoints</span></span> | <span data-ttu-id="9d313-156">Åtgärder</span><span class="sxs-lookup"><span data-stu-id="9d313-156">Operations</span></span> | <span data-ttu-id="9d313-157">Åtkomstkontrollmekanismer</span><span class="sxs-lookup"><span data-stu-id="9d313-157">Access control mechanism</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="9d313-158">Hanteringsplanet</span><span class="sxs-lookup"><span data-stu-id="9d313-158">Management plane</span></span> |<span data-ttu-id="9d313-159">**Globalt:**</span><span class="sxs-lookup"><span data-stu-id="9d313-159">**Global:**</span></span><br> <span data-ttu-id="9d313-160">management.azure.com:443</span><span class="sxs-lookup"><span data-stu-id="9d313-160">management.azure.com:443</span></span><br><br> <span data-ttu-id="9d313-161">**Azure i Kina:**</span><span class="sxs-lookup"><span data-stu-id="9d313-161">**Azure China:**</span></span><br> <span data-ttu-id="9d313-162">management.chinacloudapi.cn:443</span><span class="sxs-lookup"><span data-stu-id="9d313-162">management.chinacloudapi.cn:443</span></span><br><br> <span data-ttu-id="9d313-163">**Azure för amerikanska myndigheter:**</span><span class="sxs-lookup"><span data-stu-id="9d313-163">**Azure US Government:**</span></span><br> <span data-ttu-id="9d313-164">management.usgovcloudapi.net:443</span><span class="sxs-lookup"><span data-stu-id="9d313-164">management.usgovcloudapi.net:443</span></span><br><br> <span data-ttu-id="9d313-165">**Azure i Tyskland:**</span><span class="sxs-lookup"><span data-stu-id="9d313-165">**Azure Germany:**</span></span><br> <span data-ttu-id="9d313-166">management.microsoftazure.de:443</span><span class="sxs-lookup"><span data-stu-id="9d313-166">management.microsoftazure.de:443</span></span> |<span data-ttu-id="9d313-167">Skapa/läsa/Uppdatera/Ta bort nyckelvalv</span><span class="sxs-lookup"><span data-stu-id="9d313-167">Create/Read/Update/Delete key vault</span></span> <br> <span data-ttu-id="9d313-168">Ställ in åtkomstprinciper för nyckelvalvet</span><span class="sxs-lookup"><span data-stu-id="9d313-168">Set access policies for key vault</span></span><br><span data-ttu-id="9d313-169">Ställ in taggar för nyckelvalvet</span><span class="sxs-lookup"><span data-stu-id="9d313-169">Set tags for key vault</span></span> |<span data-ttu-id="9d313-170">Azure Resource Manager rollbaserad åtkomstkontroll (RBAC)</span><span class="sxs-lookup"><span data-stu-id="9d313-170">Azure Resource Manager Role-Based Access Control (RBAC)</span></span> |
| <span data-ttu-id="9d313-171">Dataplanet</span><span class="sxs-lookup"><span data-stu-id="9d313-171">Data plane</span></span> |<span data-ttu-id="9d313-172">**Globalt:**</span><span class="sxs-lookup"><span data-stu-id="9d313-172">**Global:**</span></span><br> <span data-ttu-id="9d313-173">&lt;vault-name&gt;.vault.azure.net:443</span><span class="sxs-lookup"><span data-stu-id="9d313-173">&lt;vault-name&gt;.vault.azure.net:443</span></span><br><br> <span data-ttu-id="9d313-174">**Azure i Kina:**</span><span class="sxs-lookup"><span data-stu-id="9d313-174">**Azure China:**</span></span><br> <span data-ttu-id="9d313-175">&lt;vault-name&gt;.vault.azure.cn:443</span><span class="sxs-lookup"><span data-stu-id="9d313-175">&lt;vault-name&gt;.vault.azure.cn:443</span></span><br><br> <span data-ttu-id="9d313-176">**Azure för amerikanska myndigheter:**</span><span class="sxs-lookup"><span data-stu-id="9d313-176">**Azure US Government:**</span></span><br> <span data-ttu-id="9d313-177">&lt;vault-name&gt;.vault.usgovcloudapi.net:443</span><span class="sxs-lookup"><span data-stu-id="9d313-177">&lt;vault-name&gt;.vault.usgovcloudapi.net:443</span></span><br><br> <span data-ttu-id="9d313-178">**Azure i Tyskland:**</span><span class="sxs-lookup"><span data-stu-id="9d313-178">**Azure Germany:**</span></span><br> <span data-ttu-id="9d313-179">&lt;vault-name&gt;.vault.microsoftazure.de:443</span><span class="sxs-lookup"><span data-stu-id="9d313-179">&lt;vault-name&gt;.vault.microsoftazure.de:443</span></span> |<span data-ttu-id="9d313-180">För nycklar: Dekryptera, kryptera, UnwrapKey, WrapKey, verifiera, signera, hämta, lista, uppdatera, skapa, importera, ta bort, säkerhetskopiera, återställa</span><span class="sxs-lookup"><span data-stu-id="9d313-180">For Keys: Decrypt, Encrypt, UnwrapKey, WrapKey, Verify, Sign, Get, List, Update, Create, Import, Delete, Backup, Restore</span></span><br><br> <span data-ttu-id="9d313-181">För hemligheter: hämta, lista, ställ in, ta bort</span><span class="sxs-lookup"><span data-stu-id="9d313-181">For secrets: Get, List, Set, Delete</span></span> |<span data-ttu-id="9d313-182">Åtkomstprincip för nyckelvalvet</span><span class="sxs-lookup"><span data-stu-id="9d313-182">Key vault access policy</span></span> |

<span data-ttu-id="9d313-183">hello management plan och data plan åtkomstkontroller fungerar oberoende av varandra.</span><span class="sxs-lookup"><span data-stu-id="9d313-183">hello management plane and data plane access controls work independently.</span></span> <span data-ttu-id="9d313-184">Om du vill toogrant en toouse snabbtangenter i en nyckelvalvet, behöver du bara toogrant plan åtkomstbehörighet för data med hjälp av principer för åtkomst av nyckelvalvet och ingen plan åtkomst krävs för det här programmet.</span><span class="sxs-lookup"><span data-stu-id="9d313-184">For example, if you want toogrant an application access toouse keys in a key vault, you only need toogrant data plane access permissions using key vault access policies and no management plane access is needed for this application.</span></span> <span data-ttu-id="9d313-185">Och omvänt, om du vill att en användare toobe kan tooread valvet egenskaper och taggar, men har inte någon åtkomst tookeys, hemligheter eller certifikat, kan du bevilja den här användaren, ”läsa” åtkomst med hjälp av RBAC och ingen åtkomst toodata plan måste anges.</span><span class="sxs-lookup"><span data-stu-id="9d313-185">And conversely, if you want a user toobe able tooread vault properties and tags, but not have any access tookeys, secrets, or certificates, you can grant this user, 'read' access using RBAC and no access toodata plane is required.</span></span>

## <a name="management-plane-access-control"></a><span data-ttu-id="9d313-186">Åtkomstkontroll för hanteringsplanet</span><span class="sxs-lookup"><span data-stu-id="9d313-186">Management plane access control</span></span>
<span data-ttu-id="9d313-187">hello management plan består av åtgärder som påverkar hello nyckelvalv sig själv.</span><span class="sxs-lookup"><span data-stu-id="9d313-187">hello management plane consists of operations that affect hello key vault itself.</span></span> <span data-ttu-id="9d313-188">Du kan till exempel skapa eller ta bort ett nyckelvalv.</span><span class="sxs-lookup"><span data-stu-id="9d313-188">For example, you can create or delete a key vault.</span></span> <span data-ttu-id="9d313-189">Du kan hämta en lista över valv i en prenumeration.</span><span class="sxs-lookup"><span data-stu-id="9d313-189">You can get a list of vaults in a subscription.</span></span> <span data-ttu-id="9d313-190">Du kan hämta nyckelvalv egenskaper (till exempel SKU taggar) och ange nyckelvalv åtkomstprinciper som styr hello användare och program som kan komma åt nycklar och hemligheter i nyckelvalvet hello.</span><span class="sxs-lookup"><span data-stu-id="9d313-190">You can retrieve key vault properties (such as SKU, tags) and set key vault access policies that control hello users and applications that can access keys and secrets in hello key vault.</span></span> <span data-ttu-id="9d313-191">Åtkomstkontroll för hanteringsplanet använder sig av RBAC.</span><span class="sxs-lookup"><span data-stu-id="9d313-191">Management plane access control uses RBAC.</span></span> <span data-ttu-id="9d313-192">Visa hello fullständig lista över nyckelvalv åtgärder som kan utföras via management plan i hello tabellen i föregående avsnitt.</span><span class="sxs-lookup"><span data-stu-id="9d313-192">See hello complete list of key vault operations that can be performed via management plane in hello table in preceding section.</span></span> 

### <a name="role-based-access-control-rbac"></a><span data-ttu-id="9d313-193">Rollbaserad åtkomstkontroll (RBAC)</span><span class="sxs-lookup"><span data-stu-id="9d313-193">Role-based Access Control (RBAC)</span></span>
<span data-ttu-id="9d313-194">Varje Azure-prenumerationen har en Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="9d313-194">Each Azure subscription has an Azure Active Directory.</span></span> <span data-ttu-id="9d313-195">Användare, grupper och program från den här katalogen kan beviljas åtkomst toomanage resurser i hello Azure-prenumeration som använder hello Azure Resource Manager-distributionsmodellen.</span><span class="sxs-lookup"><span data-stu-id="9d313-195">Users, groups, and applications from this directory can be granted access toomanage resources in hello Azure subscription that use hello Azure Resource Manager deployment model.</span></span> <span data-ttu-id="9d313-196">Den här typen av åtkomstkontroll är refererad tooas rollbaserad åtkomstkontroll (RBAC).</span><span class="sxs-lookup"><span data-stu-id="9d313-196">This type of access control is referred tooas Role-Based Access Control (RBAC).</span></span> <span data-ttu-id="9d313-197">toomanage detta åtkomst, kan du använda hello [Azure-portalen](https://portal.azure.com/), hello [Azure CLI-verktygen](../cli-install-nodejs.md), [PowerShell](/powershell/azureps-cmdlets-docs), eller hello [Azure Resource Manager REST API: er](https://msdn.microsoft.com/library/azure/dn906885.aspx).</span><span class="sxs-lookup"><span data-stu-id="9d313-197">toomanage this access, you can use hello [Azure portal](https://portal.azure.com/), hello [Azure CLI tools](../cli-install-nodejs.md), [PowerShell](/powershell/azureps-cmdlets-docs), or hello [Azure Resource Manager REST APIs](https://msdn.microsoft.com/library/azure/dn906885.aspx).</span></span>

<span data-ttu-id="9d313-198">Med hello Azure Resource Manager-modellen skapa nyckelvalvet i en resurs grupp och kontroll åtkomst toohello management plan för den här nyckelvalv med hjälp av Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="9d313-198">With hello Azure Resource Manager model, you create your key vault in a resource group and control access toohello management plane of this key vault by using Azure Active Directory.</span></span> <span data-ttu-id="9d313-199">Du kan till exempel ge användare eller en grupp kan toomanage nyckelvalv i en viss resursgrupp.</span><span class="sxs-lookup"><span data-stu-id="9d313-199">For example, you can grant users or a group ability toomanage key vaults in a specific resource group.</span></span>

<span data-ttu-id="9d313-200">Du kan bevilja åtkomst toousers, grupper och program på ett specifikt omfång genom att tilldela relevanta RBAC-roller.</span><span class="sxs-lookup"><span data-stu-id="9d313-200">You can grant access toousers, groups and applications at a specific scope by assigning appropriate RBAC roles.</span></span> <span data-ttu-id="9d313-201">Till exempel toogrant åt tooa användare toomanage nyckelvalv du ska tilldela en fördefinierad roll 'key vault deltagare' toothis användare på ett specifikt omfång.</span><span class="sxs-lookup"><span data-stu-id="9d313-201">For example, toogrant access tooa user toomanage key vaults you would assign a predefined role 'key vault Contributor' toothis user at a specific scope.</span></span> <span data-ttu-id="9d313-202">hello scope är i det här fallet en prenumeration, resursgrupp eller bara en viss nyckelvalvet.</span><span class="sxs-lookup"><span data-stu-id="9d313-202">hello scope in this case would be either a subscription, a resource group, or just a specific key vault.</span></span> <span data-ttu-id="9d313-203">En roll som tilldelats på prenumerationsnivå gäller tooall resursgrupper och resurser i den prenumerationen.</span><span class="sxs-lookup"><span data-stu-id="9d313-203">A role assigned at subscription level applies tooall resource groups and resources within that subscription.</span></span> <span data-ttu-id="9d313-204">En roll som tilldelats på resursgruppsnivå gäller tooall resurser i resursgruppen.</span><span class="sxs-lookup"><span data-stu-id="9d313-204">A role assigned at resource group level applies tooall resources in that resource group.</span></span> <span data-ttu-id="9d313-205">En roll som tilldelats för en viss resurs gäller bara toothat resurs.</span><span class="sxs-lookup"><span data-stu-id="9d313-205">A role assigned for a specific resource only applies toothat resource.</span></span> <span data-ttu-id="9d313-206">Det finns flera fördefinierade roller (se [RBAC: inbyggda roller](../active-directory/role-based-access-built-in-roles.md)), och om hello fördefinierade roller inte passar dina behov kan du definiera egna roller.</span><span class="sxs-lookup"><span data-stu-id="9d313-206">There are several predefined roles (see [RBAC: Built-in roles](../active-directory/role-based-access-built-in-roles.md)), and if hello predefined roles do not fit your needs you can also define your own roles.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="9d313-207">Observera att om en användare har deltagare behörigheter (RBAC) tooa nyckelvalv management plan, hon kan bevilja sig själv åtkomst toodata plan genom att ange nyckelvalv åtkomstprincip som styr åtkomsten toodata plan.</span><span class="sxs-lookup"><span data-stu-id="9d313-207">Note that if a user has Contributor permissions (RBAC) tooa key vault management plane, she can grant herself access toodata plane, by setting key vault access policy, which controls access toodata plane.</span></span> <span data-ttu-id="9d313-208">Därför rekommenderas tootightly kontrollera vem som har ”bidragsgivare” åtkomst tooyour nyckelvalv tooensure endast behöriga personer kan komma åt och hantera nyckelvalv, nycklar, hemligheter och certifikat.</span><span class="sxs-lookup"><span data-stu-id="9d313-208">Therefore, it is recommended tootightly control who has 'Contributor' access tooyour key vaults tooensure only authorized persons can access and manage your key vaults, keys, secrets, and certificates.</span></span>
> 
> 

## <a name="data-plane-access-control"></a><span data-ttu-id="9d313-209">Åtkomstkontroll för dataplanet</span><span class="sxs-lookup"><span data-stu-id="9d313-209">Data plane access control</span></span>
<span data-ttu-id="9d313-210">Hej nyckelvalv dataplan består av åtgärder som påverkar hello objekt i nyckelvalvet, till exempel nycklar och hemligheter certifikat.</span><span class="sxs-lookup"><span data-stu-id="9d313-210">hello key vault data plane consists of operations that affect hello objects in a key vault, such as keys, secrets, and certificates.</span></span>  <span data-ttu-id="9d313-211">Det omfattar nyckelåtgärder som att skapa, importera, uppdatera, lista, säkerhetskopiera och återställa nycklar, kryptografiska åtgärder som att signera, verifiera, kryptera, avkryptera, wrappa och unwrappa samt ställa in taggar och andra attribut för nycklar.</span><span class="sxs-lookup"><span data-stu-id="9d313-211">This includes key operations such as create, import, update, list, backup, and restore keys, cryptographic operations such as sign, verify, encrypt, decrypt, wrap, and unwrap, and set tags and other attributes for keys.</span></span> <span data-ttu-id="9d313-212">För hemligheter inkluderar det att hämta, ställa in, lista och ta bort.</span><span class="sxs-lookup"><span data-stu-id="9d313-212">Similarly, for secrets it includes, get, set, list, delete.</span></span>

<span data-ttu-id="9d313-213">Åtkomst till dataplanet ges genom att ställa in åtkomstprinciper för ett nyckelvalv.</span><span class="sxs-lookup"><span data-stu-id="9d313-213">Data plane access is granted by setting access policies for a key vault.</span></span> <span data-ttu-id="9d313-214">En användare, grupp eller ett program måste ha bidragsgivarbehörighet (RBAC) för hantering av plan för ett nyckelvalv toobe kan tooset åtkomstprinciper för att nyckelvalvet.</span><span class="sxs-lookup"><span data-stu-id="9d313-214">A user, group, or an application must have Contributor permissions (RBAC) for management plane for a key vault toobe able tooset access policies for that key vault.</span></span> <span data-ttu-id="9d313-215">En användare, grupp eller ett program kan beviljas åtkomst tooperform specifika åtgärder för nycklar och hemligheter i en nyckelvalvet.</span><span class="sxs-lookup"><span data-stu-id="9d313-215">A user, group, or application can be granted access tooperform specific operations for keys or secrets in a key vault.</span></span> <span data-ttu-id="9d313-216">Stöd för nyckelvalvet in too16 åtkomst Principposter för ett nyckelvalv.</span><span class="sxs-lookup"><span data-stu-id="9d313-216">Key vault support up too16 access policy entries for a key vault.</span></span> <span data-ttu-id="9d313-217">Skapa en säkerhetsgrupp i Azure Active Directory och Lägg till användare toothat grupp toogrant data plan åtkomst tooseveral användare tooa nyckelvalvet.</span><span class="sxs-lookup"><span data-stu-id="9d313-217">Create an Azure Active Directory security group and add users toothat group toogrant data plane access tooseveral users tooa key vault.</span></span>

### <a name="key-vault-access-policies"></a><span data-ttu-id="9d313-218">Åtkomstprinciper för nyckelvalvet</span><span class="sxs-lookup"><span data-stu-id="9d313-218">Key vault Access Policies</span></span>
<span data-ttu-id="9d313-219">Nyckelvalv åtkomstprinciper bevilja behörigheter tookeys, hemligheter och certifikat separat.</span><span class="sxs-lookup"><span data-stu-id="9d313-219">Key vault access policies grant permissions tookeys, secrets and certificates separately.</span></span> <span data-ttu-id="9d313-220">Exempelvis kan du ge en användare åtkomst tooonly nycklar, men ingen behörighet till hemligheter.</span><span class="sxs-lookup"><span data-stu-id="9d313-220">For example, you can give a user access tooonly keys, but no permissions for secrets.</span></span> <span data-ttu-id="9d313-221">Behörigheter tooaccess nycklar och hemligheter eller certifikat är på nivå för hello-valvet.</span><span class="sxs-lookup"><span data-stu-id="9d313-221">However, permissions tooaccess keys or secrets or certificates are at hello vault level.</span></span> <span data-ttu-id="9d313-222">Med andra ord stöder inte åtkomstprinciper för nyckelvalvet behörigheter på objektsnivå.</span><span class="sxs-lookup"><span data-stu-id="9d313-222">In other words, key vault access policy does not support object level permissions.</span></span> <span data-ttu-id="9d313-223">Du kan använda [Azure-portalen](https://portal.azure.com/), hello [Azure CLI-verktygen](../cli-install-nodejs.md), [PowerShell](/powershell/azureps-cmdlets-docs), eller hello [nyckelvalv Management REST API: er](https://msdn.microsoft.com/library/azure/mt620024.aspx) tooset åtkomstprinciper för nyckelvalv.</span><span class="sxs-lookup"><span data-stu-id="9d313-223">You can use [Azure portal](https://portal.azure.com/), hello [Azure CLI tools](../cli-install-nodejs.md), [PowerShell](/powershell/azureps-cmdlets-docs), or hello [key vault Management REST APIs](https://msdn.microsoft.com/library/azure/mt620024.aspx) tooset access policies for a key vault.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="9d313-224">Observera att nyckelvalvet åtkomstprinciper tillämpas på hello valvet nivå.</span><span class="sxs-lookup"><span data-stu-id="9d313-224">Note that key vault access policies apply at hello vault level.</span></span> <span data-ttu-id="9d313-225">När en användare beviljas behörighet toocreate och ta bort nycklar utför dessa åtgärder på alla nycklar i det nyckelvalvet.</span><span class="sxs-lookup"><span data-stu-id="9d313-225">For example, when a user is granted permission toocreate and delete keys, she can perform those operations on all keys in that key vault.</span></span>
> 
> 

## <a name="example"></a><span data-ttu-id="9d313-226">Exempel</span><span class="sxs-lookup"><span data-stu-id="9d313-226">Example</span></span>
<span data-ttu-id="9d313-227">Anta att du utvecklar ett program som använder ett certifikat för SSL, Azure Storage för att lagra data och använder sig av en RSA 2048-bitars nyckel för signeringsåtgärder.</span><span class="sxs-lookup"><span data-stu-id="9d313-227">Let's say you are developing an application that uses a certificate for SSL, Azure storage for storing data, and uses an RSA 2048-bit key for sign operations.</span></span> <span data-ttu-id="9d313-228">Anta att det här programmet körs i en VM (eller en VM-skaluppsättning).</span><span class="sxs-lookup"><span data-stu-id="9d313-228">Let's say this application is running in a VM (or a VM Scale Set).</span></span> <span data-ttu-id="9d313-229">Du kan använda ett nyckelvalv toostore alla hello programmet hemligheter och använda nyckelvalv toostore hello bootstrap certifikat som används av hello programmet tooauthenticate med Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="9d313-229">You can use a key vault toostore all hello application secrets, and use key vault toostore hello bootstrap certificate that is used by hello application tooauthenticate with Azure Active Directory.</span></span>

<span data-ttu-id="9d313-230">Så är här en sammanfattning av alla hello nycklar och hemligheter toobe att lagras i en nyckelvalvet.</span><span class="sxs-lookup"><span data-stu-id="9d313-230">So, here's a summary of all hello keys and secrets toobe stored in a key vault.</span></span>

* <span data-ttu-id="9d313-231">**SSL-certifikat** – används för SSL</span><span class="sxs-lookup"><span data-stu-id="9d313-231">**SSL Cert** - used for SSL</span></span>
* <span data-ttu-id="9d313-232">**Nyckeln för säkerhetslagring** -används tooget tooStorage konto</span><span class="sxs-lookup"><span data-stu-id="9d313-232">**Storage Key** - used tooget access tooStorage account</span></span>
* <span data-ttu-id="9d313-233">**RSA 2048-bitars nyckel** – används för signeringsåtgärder</span><span class="sxs-lookup"><span data-stu-id="9d313-233">**RSA 2048-bit key** - used for sign operations</span></span>
* <span data-ttu-id="9d313-234">**Bootstrap certifikat** -användas tooauthenticate tooAzure Active Directory, tooget åtkomst tookey toofetch hello lagring valvnyckeln och Använd hello RSA-nyckel för signering.</span><span class="sxs-lookup"><span data-stu-id="9d313-234">**Bootstrap certificate** - used tooauthenticate tooAzure Active Directory, tooget access tookey vault toofetch hello storage key and use hello RSA key for signing.</span></span>

<span data-ttu-id="9d313-235">Nu ska vi uppfyller hello personer som hantera, distribuera och granskning av det här programmet.</span><span class="sxs-lookup"><span data-stu-id="9d313-235">Now let's meet hello people who are managing, deploying and auditing this application.</span></span> <span data-ttu-id="9d313-236">Vi använder oss av tre roller i det här exemplet.</span><span class="sxs-lookup"><span data-stu-id="9d313-236">We'll use three roles in this example.</span></span>

* <span data-ttu-id="9d313-237">**Säkerhetsteam** – detta är vanligtvis IT-personal från hello 'office av hello rederiets (chefen säkerhetsansvarig), eller motsvarande, ansvarar för hello rätt förvaras av hemligheter som SSL-certifikat, RSA-nycklar som används för att signera anslutningssträngar för databaser lagringskontonycklar.</span><span class="sxs-lookup"><span data-stu-id="9d313-237">**Security team** - These are typically IT staff from hello 'office of hello CSO (Chief Security Officer)' or equivalent, responsible for hello proper safekeeping of secrets such as SSL certificates, RSA keys used for signing, connection strings for databases, storage account keys.</span></span>
* <span data-ttu-id="9d313-238">**Utvecklare/operatörer** -dessa är hello-avdelningen som utvecklar programmet och distribuerar den i Azure.</span><span class="sxs-lookup"><span data-stu-id="9d313-238">**Developers/operators** - These are hello folks who develop this application and then deploy it in Azure.</span></span> <span data-ttu-id="9d313-239">Vanligtvis är inte en del av hello säkerhetsteam och därför de inte borde ha åtkomst tooany känsliga data, till exempel SSL-certifikat, RSA-nycklar, men hello-program som de distribuerar ska ha åtkomst toothose.</span><span class="sxs-lookup"><span data-stu-id="9d313-239">Typically, they are not part of hello security team, and hence they should not have access tooany sensitive data, such as SSL certificates, RSA keys, but hello application they deploy should have access toothose.</span></span>
* <span data-ttu-id="9d313-240">**Granskare** -detta är vanligtvis en annan uppsättning personer isoleras från hello utvecklare och allmänna IT-personal.</span><span class="sxs-lookup"><span data-stu-id="9d313-240">**Auditors** - This is usually a different set of people, isolated from hello developers and general IT staff.</span></span> <span data-ttu-id="9d313-241">Sitt ansvar att säkerställa att kraven data security standards är tooreview användning och underhåll av certifikat, nycklar, osv.</span><span class="sxs-lookup"><span data-stu-id="9d313-241">Their responsibility is tooreview proper use and maintenance of certificates, keys, etc. and ensure compliance with data security standards.</span></span> 

<span data-ttu-id="9d313-242">Det finns en mer roll som är utanför hello omfånget för det här programmet men relevanta här toobe anges, och som skulle vara hello prenumeration (eller resursgrupp) administratör.</span><span class="sxs-lookup"><span data-stu-id="9d313-242">There is one more role that is outside hello scope of this application, but relevant here toobe mentioned, and that would be hello subscription (or resource group) administrator.</span></span> <span data-ttu-id="9d313-243">Prenumerationen administratören konfigurerar inledande åtkomstbehörigheter för hello säkerhetsteam.</span><span class="sxs-lookup"><span data-stu-id="9d313-243">Subscription administrator sets up initial access permissions for hello security team.</span></span> <span data-ttu-id="9d313-244">Vi förutsätter här hello prenumeration administratören har beviljat åtkomst toohello security team tooa resursgruppen där hello alla resurser som krävs för det här programmet bor.</span><span class="sxs-lookup"><span data-stu-id="9d313-244">Here we assume that hello subscription administrator has granted access toohello security team tooa resource group in which all hello resources needed for this application reside.</span></span>

<span data-ttu-id="9d313-245">Nu ska vi se vad varje roll utför hello kontexten för det här programmet.</span><span class="sxs-lookup"><span data-stu-id="9d313-245">Now let's see what actions each role performs in hello context of this application.</span></span>

* <span data-ttu-id="9d313-246">**Säkerhetsteamet**</span><span class="sxs-lookup"><span data-stu-id="9d313-246">**Security team**</span></span>
  * <span data-ttu-id="9d313-247">Skapa nyckelvalv</span><span class="sxs-lookup"><span data-stu-id="9d313-247">Create key vaults</span></span>
  * <span data-ttu-id="9d313-248">Slå på nyckelvalvs-loggning</span><span class="sxs-lookup"><span data-stu-id="9d313-248">Turns on key vault logging</span></span>
  * <span data-ttu-id="9d313-249">Lägger till nycklar/hemligheter</span><span class="sxs-lookup"><span data-stu-id="9d313-249">Add keys/secrets</span></span>
  * <span data-ttu-id="9d313-250">Skapar säkerhetskopior av nycklar för haveriberedskap</span><span class="sxs-lookup"><span data-stu-id="9d313-250">Create backup of keys for disaster recovery</span></span>
  * <span data-ttu-id="9d313-251">Ange nyckelvalv toogrant behörigheter toousers och program tooperform specifika åtgärder</span><span class="sxs-lookup"><span data-stu-id="9d313-251">Set key vault access policy toogrant permissions toousers and applications tooperform specific operations</span></span>
  * <span data-ttu-id="9d313-252">Byter periodvis nycklar/hemligheter</span><span class="sxs-lookup"><span data-stu-id="9d313-252">Periodically roll keys/secrets</span></span>
* <span data-ttu-id="9d313-253">**Utvecklare/operatörer**</span><span class="sxs-lookup"><span data-stu-id="9d313-253">**Developers/operators**</span></span>
  * <span data-ttu-id="9d313-254">Hämta referenser toobootstrap och SSL-certifikat (tumavtryck) lagringsnyckel (hemliga URI) och logga nyckel (nyckel URI) från säkerhetsteam</span><span class="sxs-lookup"><span data-stu-id="9d313-254">Get references toobootstrap and SSL certs (thumbprints), storage key (secret URI) and signing key (Key URI) from security team</span></span>
  * <span data-ttu-id="9d313-255">Utvecklar och distribuerar programmet som har programmässig åtkomst till nycklar och hemligheter</span><span class="sxs-lookup"><span data-stu-id="9d313-255">Develop and deploy application that accesses keys and secrets programmatically</span></span>
* <span data-ttu-id="9d313-256">**Granskare**</span><span class="sxs-lookup"><span data-stu-id="9d313-256">**Auditors**</span></span>
  * <span data-ttu-id="9d313-257">Granska användning loggar tooconfirm nyckel/hemlighet användning och kompatibilitet med data security standards</span><span class="sxs-lookup"><span data-stu-id="9d313-257">Review usage logs tooconfirm proper key/secret use and compliance with data security standards</span></span>

<span data-ttu-id="9d313-258">Nu ska vi se vilka åtkomst behörigheter tookey valvet behövs av varje roll (och hello program) tooperform tilldelade aktiviteter.</span><span class="sxs-lookup"><span data-stu-id="9d313-258">Now let's see what access permissions tookey vault are needed by each role (and hello application) tooperform their assigned tasks.</span></span> 

| <span data-ttu-id="9d313-259">Användarroll</span><span class="sxs-lookup"><span data-stu-id="9d313-259">User Role</span></span> | <span data-ttu-id="9d313-260">Behörigheter på hanteringsplanet</span><span class="sxs-lookup"><span data-stu-id="9d313-260">Management plane permissions</span></span> | <span data-ttu-id="9d313-261">Behörigheter på dataplanet</span><span class="sxs-lookup"><span data-stu-id="9d313-261">Data plane permissions</span></span> |
| --- | --- | --- |
| <span data-ttu-id="9d313-262">Säkerhetsteamet</span><span class="sxs-lookup"><span data-stu-id="9d313-262">Security Team</span></span> |<span data-ttu-id="9d313-263">nyckelvalvsbidragare</span><span class="sxs-lookup"><span data-stu-id="9d313-263">key vault Contributor</span></span> |<span data-ttu-id="9d313-264">Nycklar: säkerhetskopiering, skapa, ta bort, hämta, importera, lista, återställa</span><span class="sxs-lookup"><span data-stu-id="9d313-264">Keys: backup, create, delete, get, import, list, restore</span></span> <br> <span data-ttu-id="9d313-265">Hemligheter: alla</span><span class="sxs-lookup"><span data-stu-id="9d313-265">Secrets: all</span></span> |
| <span data-ttu-id="9d313-266">Utvecklare/operatör</span><span class="sxs-lookup"><span data-stu-id="9d313-266">Developers/Operator</span></span> |<span data-ttu-id="9d313-267">nyckelvalv distribuera behörighet så att hello VMs de distribuerar kan hämta hemligheter från hello nyckelvalv</span><span class="sxs-lookup"><span data-stu-id="9d313-267">key vault deploy permission so that hello VMs they deploy can fetch secrets from hello key vault</span></span> |<span data-ttu-id="9d313-268">Ingen</span><span class="sxs-lookup"><span data-stu-id="9d313-268">None</span></span> |
| <span data-ttu-id="9d313-269">Granskare</span><span class="sxs-lookup"><span data-stu-id="9d313-269">Auditors</span></span> |<span data-ttu-id="9d313-270">Ingen</span><span class="sxs-lookup"><span data-stu-id="9d313-270">None</span></span> |<span data-ttu-id="9d313-271">Nycklar: lista</span><span class="sxs-lookup"><span data-stu-id="9d313-271">Keys: list</span></span><br><span data-ttu-id="9d313-272">Hemligheter: lista</span><span class="sxs-lookup"><span data-stu-id="9d313-272">Secrets: list</span></span> |
| <span data-ttu-id="9d313-273">Program</span><span class="sxs-lookup"><span data-stu-id="9d313-273">Application</span></span> |<span data-ttu-id="9d313-274">Ingen</span><span class="sxs-lookup"><span data-stu-id="9d313-274">None</span></span> |<span data-ttu-id="9d313-275">Nycklar: signera</span><span class="sxs-lookup"><span data-stu-id="9d313-275">Keys: sign</span></span><br><span data-ttu-id="9d313-276">Hemligheter: hämta</span><span class="sxs-lookup"><span data-stu-id="9d313-276">Secrets: get</span></span> |

> [!NOTE]
> <span data-ttu-id="9d313-277">Granskare måste listan för nycklar och hemligheter så att de kan inspektera attribut för nycklar och hemligheter som inte har orsakat i hello loggar, till exempel taggar, aktivering och förfallodatum.</span><span class="sxs-lookup"><span data-stu-id="9d313-277">Auditors need list permission for keys and secrets so they can inspect attributes for keys and secrets that are not emitted in hello logs, such as tags, activation and expiration dates.</span></span>
> 
> 

<span data-ttu-id="9d313-278">Förutom behörighet tookey valvet, alla tre roller också behöver komma åt tooother resurser.</span><span class="sxs-lookup"><span data-stu-id="9d313-278">Besides permission tookey vault, all three roles also need access tooother resources.</span></span> <span data-ttu-id="9d313-279">Till exempel toobe kan toodeploy virtuella datorer (eller Web Apps osv.) Utvecklare/operatorer måste också 'Deltagare' åtkomst toothose resurstyper.</span><span class="sxs-lookup"><span data-stu-id="9d313-279">For example, toobe able toodeploy VMs (or Web Apps etc.) Developers/Operators also need 'Contributor' access toothose resource types.</span></span> <span data-ttu-id="9d313-280">Granskare måste läsbehörighet toohello storage-konto där hello nyckelvalv loggar lagras.</span><span class="sxs-lookup"><span data-stu-id="9d313-280">Auditors need read access toohello storage account where hello key vault logs are stored.</span></span>

<span data-ttu-id="9d313-281">Eftersom hello fokus i den här artikeln är att säkra åtkomsten tooyour nyckelvalvet, vi bara illustrera hello relevanta delar hör toothis avsnittet och hoppa över information om distribution av certifikat, använda nycklar och hemligheter programmässigt etc. De uppgifterna täcks av andra avsnitt.</span><span class="sxs-lookup"><span data-stu-id="9d313-281">Since hello focus of this article is securing access tooyour key vault, we only illustrate hello relevant portions pertaining toothis topic and skip details regarding deploying certificates, accessing keys and secrets programmatically etc. Those details are already covered elsewhere.</span></span> <span data-ttu-id="9d313-282">Distribution av certifikat som lagras i nyckelvalvet tooVMs ingår i en [blogginlägget](https://blogs.technet.microsoft.com/kv/2016/09/14/updated-deploy-certificates-to-vms-from-customer-managed-key-vault/), och det finns [exempelkoden](https://www.microsoft.com/download/details.aspx?id=45343) tillgängliga som illustrerar hur toouse bootstrap certifikat tooauthenticate tooAzure AD tooget åtkomst tookey valvet.</span><span class="sxs-lookup"><span data-stu-id="9d313-282">Deploying certificates stored in key vault tooVMs is covered in a [blog post](https://blogs.technet.microsoft.com/kv/2016/09/14/updated-deploy-certificates-to-vms-from-customer-managed-key-vault/), and there is [sample code](https://www.microsoft.com/download/details.aspx?id=45343) available that illustrates how toouse bootstrap certificate tooauthenticate tooAzure AD tooget access tookey vault.</span></span>

<span data-ttu-id="9d313-283">De flesta av hello behörighet kan beviljas med hjälp av Azure portal, men toogrant detaljerade behörigheter som du kan behöva toouse Azure PowerShell (eller Azure CLI) tooachieve hello önskat resultat.</span><span class="sxs-lookup"><span data-stu-id="9d313-283">Most of hello access permissions can be granted using Azure portal, but toogrant granular permissions you may need toouse Azure PowerShell (or Azure CLI) tooachieve hello desired result.</span></span> 

<span data-ttu-id="9d313-284">Anta att hello följande kodavsnitt PowerShell:</span><span class="sxs-lookup"><span data-stu-id="9d313-284">hello following PowerShell snippets assume:</span></span>

* <span data-ttu-id="9d313-285">hello Azure Active Directory-administratören har skapat säkerhetsgrupper som representerar hello tre roller, nämligen Contoso säkerhetsteam, Contoso App Devops Contoso App Auditors.</span><span class="sxs-lookup"><span data-stu-id="9d313-285">hello Azure Active Directory administrator has created security groups that represent hello three roles, namely Contoso Security Team, Contoso App Devops, Contoso App Auditors.</span></span> <span data-ttu-id="9d313-286">Hej administratör har även lagt till användare toohello grupper som de tillhör.</span><span class="sxs-lookup"><span data-stu-id="9d313-286">hello administrator has also added users toohello groups they belong.</span></span>
* <span data-ttu-id="9d313-287">**ContosoAppRG** är hello resursgrupp där alla hello resurserna finns.</span><span class="sxs-lookup"><span data-stu-id="9d313-287">**ContosoAppRG** is hello resource group where all hello resources reside.</span></span> <span data-ttu-id="9d313-288">**contosologstorage** är där hello loggar lagras.</span><span class="sxs-lookup"><span data-stu-id="9d313-288">**contosologstorage** is where hello logs are stored.</span></span> 
* <span data-ttu-id="9d313-289">Nyckelvalv **ContosoKeyVault** och storage-kontot som används för nyckelvalvet loggar **contosologstorage** hello måste ha samma Azure-plats</span><span class="sxs-lookup"><span data-stu-id="9d313-289">Key vault **ContosoKeyVault** and storage account used for key vault logs **contosologstorage** must be in hello same Azure location</span></span>

<span data-ttu-id="9d313-290">Första hello prenumeration administratören tilldelar 'nyckeln valvet deltagare' och ' administratör för användaråtkomst ' roller toohello säkerhetsteam.</span><span class="sxs-lookup"><span data-stu-id="9d313-290">First hello subscription administrator assigns 'key vault Contributor' and 'User Access Administrator' roles toohello security team.</span></span> <span data-ttu-id="9d313-291">Detta gör hello team toomanage åtkomst tooother säkerhetsresurser och hantera nyckelvalv i hello resursgruppen ContosoAppRG.</span><span class="sxs-lookup"><span data-stu-id="9d313-291">This allows hello security team toomanage access tooother resources and manage key vaults in hello resource group ContosoAppRG.</span></span>

```
New-AzureRmRoleAssignment -ObjectId (Get-AzureRmADGroup -SearchString 'Contoso Security Team')[0].Id -RoleDefinitionName "key vault Contributor" -ResourceGroupName ContosoAppRG
New-AzureRmRoleAssignment -ObjectId (Get-AzureRmADGroup -SearchString 'Contoso Security Team')[0].Id -RoleDefinitionName "User Access Administrator" -ResourceGroupName ContosoAppRG
```

<span data-ttu-id="9d313-292">hello följande skript visar hur hello säkerhetsteam kan skapa en nyckelvalvet, konfigurera loggning och ange åtkomstbehörigheter för andra roller och hello program.</span><span class="sxs-lookup"><span data-stu-id="9d313-292">hello following script illustrates how hello security team can create a key vault, setup logging, and set access permissions for other roles and hello application.</span></span> 

```
# Create key vault and enable logging
$sa = Get-AzureRmStorageAccount -ResourceGroup ContosoAppRG -Name contosologstorage
$kv = New-AzureRmKeyVault -VaultName ContosoKeyVault -ResourceGroup ContosoAppRG -SKU premium -Location 'westus' -EnabledForDeployment
Set-AzureRmDiagnosticSetting -ResourceId $kv.ResourceId -StorageAccountId $sa.Id -Enabled $true -Categories AuditEvent

# Data plane permissions for Security team
Set-AzureRmKeyVaultAccessPolicy -VaultName ContosoKeyVault -ObjectId (Get-AzureRmADGroup -SearchString 'Contoso Security Team')[0].Id -PermissionsToKeys backup,create,delete,get,import,list,restore -PermissionsToSecrets all

# Management plane permissions for Dev/ops
# Create a new role from an existing role
$devopsrole = Get-AzureRmRoleDefinition -Name "Virtual Machine Contributor"
$devopsrole.Id = $null
$devopsrole.Name = "Contoso App Devops"
$devopsrole.Description = "Can deploy VMs that need secrets from key vault"
$devopsrole.AssignableScopes = @("/subscriptions/<SUBSCRIPTION-GUID>")

# Add permission for dev/ops so they can deploy VMs that have secrets deployed from key vaults
$devopsrole.Actions.Add("Microsoft.KeyVault/vaults/deploy/action")
New-AzureRmRoleDefinition -Role $devopsrole

# Assign this newly defined role tooDev ops security group
New-AzureRmRoleAssignment -ObjectId (Get-AzureRmADGroup -SearchString 'Contoso App Devops')[0].Id -RoleDefinitionName "Contoso App Devops" -ResourceGroupName ContosoAppRG

# Data plane permissions for Auditors
Set-AzureRmKeyVaultAccessPolicy -VaultName ContosoKeyVault -ObjectId (Get-AzureRmADGroup -SearchString 'Contoso App Auditors')[0].Id -PermissionsToKeys list -PermissionsToSecrets list
```

<span data-ttu-id="9d313-293">hello anpassad roll definierats är endast tilldelas toohello prenumeration där hello ContosoAppRG resursgruppen har skapats.</span><span class="sxs-lookup"><span data-stu-id="9d313-293">hello custom role defined, is only assignable toohello subscription where hello ContosoAppRG resource group is created.</span></span> <span data-ttu-id="9d313-294">Om hello samma anpassade roller ska användas för andra projekt i andra prenumerationer, kan dess scope ha flera prenumerationer som lagts till.</span><span class="sxs-lookup"><span data-stu-id="9d313-294">If hello same custom roles will be used for other projects in other subscriptions, it's scope could have more subscriptions added.</span></span>

<span data-ttu-id="9d313-295">hello anpassade rolltilldelning hello utvecklare/operatorer för hello ”distribuera/åtgärd” behörighet är begränsade toohello resursgrupp.</span><span class="sxs-lookup"><span data-stu-id="9d313-295">hello custom role assignment for hello developers/operators for hello "deploy/action" permission is scoped toohello resource group.</span></span> <span data-ttu-id="9d313-296">Det här sättet endast hello virtuella datorer skapas i hello resursgrupp 'ContosoAppRG' får hello hemligheter (SSL-certifikat och bootstrap cert).</span><span class="sxs-lookup"><span data-stu-id="9d313-296">This way only hello VMs created in hello resource group 'ContosoAppRG' will get hello secrets (SSL cert and bootstrap cert).</span></span> <span data-ttu-id="9d313-297">Virtuella datorer som en medlem dev/ops skapar i andra resursgruppen kommer inte att kunna tooget dessa hemligheter även om de känner hello hemlighet URI: er.</span><span class="sxs-lookup"><span data-stu-id="9d313-297">Any VMs that a member of dev/ops team creates in other resource group will not be able tooget these secrets even if they knew hello secret URIs.</span></span>

<span data-ttu-id="9d313-298">Det här exemplet visar ett enkelt scenario.</span><span class="sxs-lookup"><span data-stu-id="9d313-298">This example depicts a simple scenario.</span></span> <span data-ttu-id="9d313-299">Verkligheten scenarier kan vara mer komplicerat och du kan behöva tooadjust behörigheter tooyour nyckelvalv baserat på dina behov.</span><span class="sxs-lookup"><span data-stu-id="9d313-299">Real life scenarios may be more complex and you may need tooadjust permissions tooyour key vault based on your needs.</span></span> <span data-ttu-id="9d313-300">I vårt exempel antar vi till exempel att säkerhetsteam ger hello nyckel och hemliga referenser (URI: er och tumavtryck) som utvecklare/operatörer team måste tooreference i sina program.</span><span class="sxs-lookup"><span data-stu-id="9d313-300">For example, in our example, we assume that security team will provide hello key and secret references (URIs and thumbprints) that developers/operators team need tooreference in their applications.</span></span> <span data-ttu-id="9d313-301">Därför behöver toogrant utvecklare/operatörer någon plan dataåtkomst.</span><span class="sxs-lookup"><span data-stu-id="9d313-301">Hence, they don't need toogrant developers/operators any data plane access.</span></span> <span data-ttu-id="9d313-302">Tänk också på att det här exemplet fokuserar på att skydda ditt nyckelvalv.</span><span class="sxs-lookup"><span data-stu-id="9d313-302">Also, note that this example focuses on securing your key vault.</span></span> <span data-ttu-id="9d313-303">Liknande bör övervägas toosecure [din virtuella dator](https://azure.microsoft.com/services/virtual-machines/security/), [lagringskonton](../storage/common/storage-security-guide.md) och andra Azure-resurser för.</span><span class="sxs-lookup"><span data-stu-id="9d313-303">Similar consideration should be given toosecure [your VMs](https://azure.microsoft.com/services/virtual-machines/security/), [storage accounts](../storage/common/storage-security-guide.md) and other Azure resources too.</span></span>

> [!NOTE]
> <span data-ttu-id="9d313-304">Obs: Det här exemplet visar hur åtkomst till nyckelvalvet låses i produktionen.</span><span class="sxs-lookup"><span data-stu-id="9d313-304">Note: This example shows how key vault access will be locked down in production.</span></span> <span data-ttu-id="9d313-305">hello utvecklare ska ha sin egen prenumeration eller resursgrupp där de har fullständig behörighet toomanage sina valv, virtuella datorer och storage-konto där de utvecklar programmet hello.</span><span class="sxs-lookup"><span data-stu-id="9d313-305">hello developers should have their own subscription or resourcegroup where they have full permissions toomanage their vaults, VMs and storage account where they develop hello application.</span></span>
> 
> 

## <a name="resources"></a><span data-ttu-id="9d313-306">Resurser</span><span class="sxs-lookup"><span data-stu-id="9d313-306">Resources</span></span>
* [<span data-ttu-id="9d313-307">Azure Active Directory rollbaserad åtkomstkontroll</span><span class="sxs-lookup"><span data-stu-id="9d313-307">Azure Active Directory Role-based Access Control</span></span>](../active-directory/role-based-access-control-configure.md)
  
  <span data-ttu-id="9d313-308">Den här artikeln förklarar hello Azure Active Directory-rollbaserad åtkomstkontroll och hur det fungerar.</span><span class="sxs-lookup"><span data-stu-id="9d313-308">This article explains hello Azure Active Directory Role-based Access Control and how it works.</span></span>
* [<span data-ttu-id="9d313-309">RBAC: inbyggda roller</span><span class="sxs-lookup"><span data-stu-id="9d313-309">RBAC: Built in Roles</span></span>](../active-directory/role-based-access-built-in-roles.md)
  
  <span data-ttu-id="9d313-310">Den här artikeln information om alla hello inbyggda roller som är tillgängliga i RBAC.</span><span class="sxs-lookup"><span data-stu-id="9d313-310">This article details all hello built-in roles available in RBAC.</span></span>
* [<span data-ttu-id="9d313-311">Förstå Resource Manager-distribution och klassisk distribution</span><span class="sxs-lookup"><span data-stu-id="9d313-311">Understanding Resource Manager deployment and classic deployment</span></span>](../azure-resource-manager/resource-manager-deployment-model.md)
  
  <span data-ttu-id="9d313-312">Den här artikeln beskriver hello Resource Manager-distribution och klassisk distributionsmodeller och förklarar hello fördelarna med att använda hello Resource Manager och resursgrupper</span><span class="sxs-lookup"><span data-stu-id="9d313-312">This article explains hello Resource Manager deployment and classic deployment models, and explains hello benefits of using hello Resource Manager and resource groups</span></span>
* [<span data-ttu-id="9d313-313">Hantera rollbaserad åtkomstkontroll med Azure PowerShell</span><span class="sxs-lookup"><span data-stu-id="9d313-313">Manage Role-Based Access Control with Azure PowerShell</span></span>](../active-directory/role-based-access-control-manage-access-powershell.md)
  
  <span data-ttu-id="9d313-314">Den här artikeln förklarar hur toomanage rollbaserad åtkomstkontroll med Azure PowerShell</span><span class="sxs-lookup"><span data-stu-id="9d313-314">This article explains how toomanage role-based access control with Azure PowerShell</span></span>
* [<span data-ttu-id="9d313-315">Hantera rollbaserad åtkomstkontroll med hello REST API</span><span class="sxs-lookup"><span data-stu-id="9d313-315">Managing Role-Based Access Control with hello REST API</span></span>](../active-directory/role-based-access-control-manage-access-rest.md)
  
  <span data-ttu-id="9d313-316">Den här artikeln visar hur toouse hello REST API toomanage RBAC.</span><span class="sxs-lookup"><span data-stu-id="9d313-316">This article shows how toouse hello REST API toomanage RBAC.</span></span>
* [<span data-ttu-id="9d313-317">Rollbaserad åtkomstkontroll i Microsoft Azure från Ignite</span><span class="sxs-lookup"><span data-stu-id="9d313-317">Role-Based Access Control for Microsoft Azure from Ignite</span></span>](https://channel9.msdn.com/events/Ignite/2015/BRK2707)
  
  <span data-ttu-id="9d313-318">Det här är en video på Channel 9 från hello 2015 MS Ignite konferens tooa för länken.</span><span class="sxs-lookup"><span data-stu-id="9d313-318">This is a link tooa video on Channel 9 from hello 2015 MS Ignite conference.</span></span> <span data-ttu-id="9d313-319">I den här sessionen de talar om åtkomst till hanterings- och rapporteringsfunktioner i Azure och utforska bästa metoderna för att skydda åtkomsten tooAzure prenumerationer med hjälp av Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="9d313-319">In this session, they talk about access management and reporting capabilities in Azure, and explore best practices around securing access tooAzure subscriptions using Azure Active Directory.</span></span>
* [<span data-ttu-id="9d313-320">Auktorisera åtkomst tooweb program med hjälp av OAuth 2.0 och Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="9d313-320">Authorize access tooweb applications using OAuth 2.0 and Azure Active Directory</span></span>](../active-directory/active-directory-protocols-oauth-code.md)
  
  <span data-ttu-id="9d313-321">Den här artikeln beskriver det fullständiga OAuth 2.0-flödet för att autentisera med Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="9d313-321">This article describes complete OAuth 2.0 flow for authenticating with Azure Active Directory.</span></span>
* [<span data-ttu-id="9d313-322">REST API:er för nyckelvalvshantering</span><span class="sxs-lookup"><span data-stu-id="9d313-322">key vault Management REST APIs</span></span>](https://msdn.microsoft.com/library/azure/mt620024.aspx)
  
  <span data-ttu-id="9d313-323">Det här dokumentet är hello referens för hello REST API: er toomanage din nyckel valvet programmässigt, inklusive principen för nyckelvalvet åtkomst.</span><span class="sxs-lookup"><span data-stu-id="9d313-323">This document is hello reference for hello REST APIs toomanage your key vault programmatically, including setting key vault access policy.</span></span>
* [<span data-ttu-id="9d313-324">REST API:er för nyckelvalvet</span><span class="sxs-lookup"><span data-stu-id="9d313-324">key vault REST APIs</span></span>](https://msdn.microsoft.com/library/azure/dn903609.aspx)
  
  <span data-ttu-id="9d313-325">Länken tookey valvet REST API-referensdokumentation.</span><span class="sxs-lookup"><span data-stu-id="9d313-325">Link tookey vault REST API reference documentation.</span></span>
* [<span data-ttu-id="9d313-326">Nyckelåtkomstkontroll</span><span class="sxs-lookup"><span data-stu-id="9d313-326">Key access control</span></span>](https://msdn.microsoft.com/library/azure/dn903623.aspx#BKMK_KeyAccessControl)
  
  <span data-ttu-id="9d313-327">Länka tooSecret access control-referensdokumentation.</span><span class="sxs-lookup"><span data-stu-id="9d313-327">Link tooSecret access control reference documentation.</span></span>
* [<span data-ttu-id="9d313-328">Åtkomstkontroll till hemlighet</span><span class="sxs-lookup"><span data-stu-id="9d313-328">Secret access control</span></span>](https://msdn.microsoft.com/library/azure/dn903623.aspx#BKMK_SecretAccessControl)
  
  <span data-ttu-id="9d313-329">Länka tooKey access control-referensdokumentation.</span><span class="sxs-lookup"><span data-stu-id="9d313-329">Link tooKey access control reference documentation.</span></span>
* <span data-ttu-id="9d313-330">[Ange](https://msdn.microsoft.com/library/mt603625.aspx) och [ta bort](https://msdn.microsoft.com/library/mt619427.aspx) åtkomstprincip för nyckelvalvet med PowerShell</span><span class="sxs-lookup"><span data-stu-id="9d313-330">[Set](https://msdn.microsoft.com/library/mt603625.aspx) and [Remove](https://msdn.microsoft.com/library/mt619427.aspx) key vault access policy using PowerShell</span></span>
  
  <span data-ttu-id="9d313-331">Länkar tooreference dokumentation för PowerShell-cmdlets toomanage nyckelvalv åtkomstprincip.</span><span class="sxs-lookup"><span data-stu-id="9d313-331">Links tooreference documentation for PowerShell cmdlets toomanage key vault access policy.</span></span>

## <a name="next-steps"></a><span data-ttu-id="9d313-332">Nästa steg</span><span class="sxs-lookup"><span data-stu-id="9d313-332">Next Steps</span></span>
<span data-ttu-id="9d313-333">För en komma igång-självstudie för administratörer, kan du se [Kom igång med Azure Key Vault](key-vault-get-started.md).</span><span class="sxs-lookup"><span data-stu-id="9d313-333">For a getting started tutorial for an administrator, see [Get Started with Azure key vault](key-vault-get-started.md).</span></span>

<span data-ttu-id="9d313-334">Mer information om av användningsloggning för Key Vault finns i avsnittet om [Azure Key Vault-loggning](key-vault-logging.md).</span><span class="sxs-lookup"><span data-stu-id="9d313-334">For more information about usage logging for key vault, see [Azure key vault Logging](key-vault-logging.md).</span></span>

<span data-ttu-id="9d313-335">Mer information om hur du använder nycklar och hemligheter med Azure Key Vault finns i [Om nycklar och hemligheter](https://msdn.microsoft.com/library/azure/dn903623.aspx).</span><span class="sxs-lookup"><span data-stu-id="9d313-335">For more information about using keys and secrets with Azure key vault, see [About Keys and Secrets](https://msdn.microsoft.com/library/azure/dn903623.aspx).</span></span>

<span data-ttu-id="9d313-336">Om du har frågor om nyckelvalv gå hello [Azure key vault forum](https://social.msdn.microsoft.com/forums/azure/home?forum=AzureKeyVault)</span><span class="sxs-lookup"><span data-stu-id="9d313-336">If you have questions about key vault, visit hello [Azure key vault Forums](https://social.msdn.microsoft.com/forums/azure/home?forum=AzureKeyVault)</span></span>

