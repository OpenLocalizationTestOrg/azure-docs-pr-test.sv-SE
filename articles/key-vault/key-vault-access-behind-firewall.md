---
title: "Få åtkomst till Key Vault bakom en brandvägg | Microsoft Docs"
description: "Läs om hur man kommer åt Azure Key Vault från ett program bakom en brandvägg"
services: key-vault
documentationcenter: 
author: amitbapat
manager: mbaldwin
tags: azure-resource-manager
ms.assetid: 50d21774-2ee1-4212-8995-570c9de603c5
ms.service: key-vault
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: hero-article
ms.date: 01/07/2017
ms.author: ambapat
ms.openlocfilehash: d00c6e0acf437d2bfc3c27e948f4646a6685b08f
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 07/11/2017
---
# <a name="access-azure-key-vault-behind-a-firewall"></a><span data-ttu-id="d8b09-103">Få åtkomst till Azure Key Vault bakom en brandvägg</span><span class="sxs-lookup"><span data-stu-id="d8b09-103">Access Azure Key Vault behind a firewall</span></span>
### <a name="q-my-key-vault-client-application-needs-to-be-behind-a-firewall-what-ports-hosts-or-ip-addresses-should-i-open-to-enable-access-to-a-key-vault"></a><span data-ttu-id="d8b09-104">F: Mitt key vault-klientprogram måste ligga bakom en brandvägg.</span><span class="sxs-lookup"><span data-stu-id="d8b09-104">Q: My key vault client application needs to be behind a firewall.</span></span> <span data-ttu-id="d8b09-105">Vilka portar, värdar eller IP-adresser ska jag öppna om för att möjliggöra åtkomst till ett nyckelvalv?</span><span class="sxs-lookup"><span data-stu-id="d8b09-105">What ports, hosts, or IP addresses should I open to enable access to a key vault?</span></span>
<span data-ttu-id="d8b09-106">För att få åtkomst till ett nyckelvalv måste ditt klientprogram ha åtkomst till flera slutpunkter för olika funktioner:</span><span class="sxs-lookup"><span data-stu-id="d8b09-106">To access a key vault, your key vault client application has to access multiple endpoints for various functionalities:</span></span>

* <span data-ttu-id="d8b09-107">Autentisering via Azure Active Directory (Azure AD).</span><span class="sxs-lookup"><span data-stu-id="d8b09-107">Authentication via Azure Active Directory (Azure AD).</span></span>
* <span data-ttu-id="d8b09-108">Hantering av Azure Key Vault.</span><span class="sxs-lookup"><span data-stu-id="d8b09-108">Management of Azure Key Vault.</span></span> <span data-ttu-id="d8b09-109">Detta omfattar att skapa, läsa, uppdatera, ta bort och ange åtkomstprinciper via Azure Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="d8b09-109">This includes creating, reading, updating, deleting, and setting access policies through Azure Resource Manager.</span></span>
* <span data-ttu-id="d8b09-110">Åtkomst till och hantering av objekt (nycklar och hemligheter) som lagras i själva nyckelvalvet går via den specifika slutpunkten för nyckelvalv (t.ex. [https://yourvaultname.vault.azure.net](https://yourvaultname.vault.azure.net)).</span><span class="sxs-lookup"><span data-stu-id="d8b09-110">Accessing and managing objects (keys and secrets) stored in Key Vault itself, going through the Key Vault-specific endpoint (for example, [https://yourvaultname.vault.azure.net](https://yourvaultname.vault.azure.net)).</span></span>  

<span data-ttu-id="d8b09-111">Det finns vissa varianter beroende på din konfiguration och miljö.</span><span class="sxs-lookup"><span data-stu-id="d8b09-111">Depending on your configuration and environment, there are some variations.</span></span>   

## <a name="ports"></a><span data-ttu-id="d8b09-112">Portar</span><span class="sxs-lookup"><span data-stu-id="d8b09-112">Ports</span></span>
<span data-ttu-id="d8b09-113">All trafik till nyckelvalvet för alla tre funktioner (autentisering, hantering och dataplanåtkomst) går över HTTPS: port 443.</span><span class="sxs-lookup"><span data-stu-id="d8b09-113">All traffic to a key vault for all three functions (authentication, management, and data plane access) goes over HTTPS: port 443.</span></span> <span data-ttu-id="d8b09-114">Det är dock ibland HTTP (port 80)-trafik för CRL.</span><span class="sxs-lookup"><span data-stu-id="d8b09-114">However, there will occasionally be HTTP (port 80) traffic for CRL.</span></span> <span data-ttu-id="d8b09-115">Klienter som har stöd för OCSP ska inte nå CRL, men kan ibland nå [http://cdp1.public-trust.com/CRL/Omniroot2025.crl](http://cdp1.public-trust.com/CRL/Omniroot2025.crl).</span><span class="sxs-lookup"><span data-stu-id="d8b09-115">Clients that support OCSP shouldn't reach CRL, but may occasionally reach [http://cdp1.public-trust.com/CRL/Omniroot2025.crl](http://cdp1.public-trust.com/CRL/Omniroot2025.crl).</span></span>  

## <a name="authentication"></a><span data-ttu-id="d8b09-116">Autentisering</span><span class="sxs-lookup"><span data-stu-id="d8b09-116">Authentication</span></span>
<span data-ttu-id="d8b09-117">Nyckelvalv-klientprogram behöver åtkomst till Azure Active Directory-slutpunkter för autentisering.</span><span class="sxs-lookup"><span data-stu-id="d8b09-117">Key vault client applications will need to access Azure Active Directory endpoints for authentication.</span></span> <span data-ttu-id="d8b09-118">Den slutpunkt som används beror på Azure AD-klientkonfiguration, typ av huvudkonto (användarens eller tjänstens huvudnamn) och typ av konto, t.ex. ett Microsoft-konto eller ett arbets- eller skolkonto.</span><span class="sxs-lookup"><span data-stu-id="d8b09-118">The endpoint used depends on the Azure AD tenant configuration, the type of principal (user principal or service principal), and the type of account--for example, a Microsoft account or a work or school account.</span></span>  

| <span data-ttu-id="d8b09-119">Typ av huvudkonto</span><span class="sxs-lookup"><span data-stu-id="d8b09-119">Principal type</span></span> | <span data-ttu-id="d8b09-120">Slutpunkt:port</span><span class="sxs-lookup"><span data-stu-id="d8b09-120">Endpoint:port</span></span> |
| --- | --- |
| <span data-ttu-id="d8b09-121">Användare som använder Microsoft-konto</span><span class="sxs-lookup"><span data-stu-id="d8b09-121">User using Microsoft account</span></span><br> <span data-ttu-id="d8b09-122">(till exempel user@hotmail.com)</span><span class="sxs-lookup"><span data-stu-id="d8b09-122">(for example, user@hotmail.com)</span></span> |<span data-ttu-id="d8b09-123">**Globalt:**</span><span class="sxs-lookup"><span data-stu-id="d8b09-123">**Global:**</span></span><br> <span data-ttu-id="d8b09-124">login.microsoftonline.com:443</span><span class="sxs-lookup"><span data-stu-id="d8b09-124">login.microsoftonline.com:443</span></span><br><br> <span data-ttu-id="d8b09-125">**Azure i Kina:**</span><span class="sxs-lookup"><span data-stu-id="d8b09-125">**Azure China:**</span></span><br> <span data-ttu-id="d8b09-126">login.chinacloudapi.cn:443</span><span class="sxs-lookup"><span data-stu-id="d8b09-126">login.chinacloudapi.cn:443</span></span><br><br><span data-ttu-id="d8b09-127">**Azure för amerikanska myndigheter:**</span><span class="sxs-lookup"><span data-stu-id="d8b09-127">**Azure US Government:**</span></span><br> <span data-ttu-id="d8b09-128">login-us.microsoftonline.com:443</span><span class="sxs-lookup"><span data-stu-id="d8b09-128">login-us.microsoftonline.com:443</span></span><br><br><span data-ttu-id="d8b09-129">**Azure i Tyskland:**</span><span class="sxs-lookup"><span data-stu-id="d8b09-129">**Azure Germany:**</span></span><br> <span data-ttu-id="d8b09-130">login.microsoftonline.de:443</span><span class="sxs-lookup"><span data-stu-id="d8b09-130">login.microsoftonline.de:443</span></span><br><br> <span data-ttu-id="d8b09-131">och</span><span class="sxs-lookup"><span data-stu-id="d8b09-131">and</span></span> <br><span data-ttu-id="d8b09-132">login.live.com:443</span><span class="sxs-lookup"><span data-stu-id="d8b09-132">login.live.com:443</span></span> |
| <span data-ttu-id="d8b09-133">Användaren eller tjänstens huvudnamn med ett arbets- eller skolkonto med Azure AD (till exempel user@contoso.com)</span><span class="sxs-lookup"><span data-stu-id="d8b09-133">User or service principal using a work or school account with Azure AD (for example, user@contoso.com)</span></span> |<span data-ttu-id="d8b09-134">**Globalt:**</span><span class="sxs-lookup"><span data-stu-id="d8b09-134">**Global:**</span></span><br> <span data-ttu-id="d8b09-135">login.microsoftonline.com:443</span><span class="sxs-lookup"><span data-stu-id="d8b09-135">login.microsoftonline.com:443</span></span><br><br> <span data-ttu-id="d8b09-136">**Azure i Kina:**</span><span class="sxs-lookup"><span data-stu-id="d8b09-136">**Azure China:**</span></span><br> <span data-ttu-id="d8b09-137">login.chinacloudapi.cn:443</span><span class="sxs-lookup"><span data-stu-id="d8b09-137">login.chinacloudapi.cn:443</span></span><br><br><span data-ttu-id="d8b09-138">**Azure för amerikanska myndigheter:**</span><span class="sxs-lookup"><span data-stu-id="d8b09-138">**Azure US Government:**</span></span><br> <span data-ttu-id="d8b09-139">login-us.microsoftonline.com:443</span><span class="sxs-lookup"><span data-stu-id="d8b09-139">login-us.microsoftonline.com:443</span></span><br><br><span data-ttu-id="d8b09-140">**Azure i Tyskland:**</span><span class="sxs-lookup"><span data-stu-id="d8b09-140">**Azure Germany:**</span></span><br> <span data-ttu-id="d8b09-141">login.microsoftonline.de:443</span><span class="sxs-lookup"><span data-stu-id="d8b09-141">login.microsoftonline.de:443</span></span> |
| <span data-ttu-id="d8b09-142">Användaren eller tjänstens huvudnamn med hjälp av en arbets- eller skolkonto, plus Active Directory Federation Services (AD FS) eller andra externa slutpunkten (till exempel user@contoso.com)</span><span class="sxs-lookup"><span data-stu-id="d8b09-142">User or service principal using a work or school account, plus Active Directory Federation Services (AD FS) or other federated endpoint (for example, user@contoso.com)</span></span> |<span data-ttu-id="d8b09-143">Alla slutpunkter för ett arbets- eller skolkonto, plus AD FS eller andra federerade slutpunkter</span><span class="sxs-lookup"><span data-stu-id="d8b09-143">All endpoints for a work or school account, plus AD FS or other federated endpoints</span></span> |

<span data-ttu-id="d8b09-144">Det finns andra möjliga avancerade scenarier.</span><span class="sxs-lookup"><span data-stu-id="d8b09-144">There are other possible complex scenarios.</span></span> <span data-ttu-id="d8b09-145">Se [Azure Active Directory Authentication Flow](/documentation/articles/active-directory-authentication-scenarios/), [Integrera program med Azure Active Directory](/documentation/articles/active-directory-integrating-applications/) och [Active Directory-autentiseringsprotokoll](https://msdn.microsoft.com/library/azure/dn151124.aspx) för mer information.</span><span class="sxs-lookup"><span data-stu-id="d8b09-145">Refer to [Azure Active Directory Authentication Flow](/documentation/articles/active-directory-authentication-scenarios/), [Integrating Applications with Azure Active Directory](/documentation/articles/active-directory-integrating-applications/), and [Active Directory Authentication Protocols](https://msdn.microsoft.com/library/azure/dn151124.aspx) for additional information.</span></span>  

## <a name="key-vault-management"></a><span data-ttu-id="d8b09-146">Hantering av Nyckelvalv</span><span class="sxs-lookup"><span data-stu-id="d8b09-146">Key Vault management</span></span>
<span data-ttu-id="d8b09-147">För hantering av Nyckelvalv (CRUD och inställning av åtkomstprincip) måste klientprogrammet för nyckelvalv ha åtkomst till Azure Resource Manager-slutpunkten.</span><span class="sxs-lookup"><span data-stu-id="d8b09-147">For Key Vault management (CRUD and setting access policy), the key vault client application needs to access an Azure Resource Manager endpoint.</span></span>  

| <span data-ttu-id="d8b09-148">Typ av åtgärd</span><span class="sxs-lookup"><span data-stu-id="d8b09-148">Type of operation</span></span> | <span data-ttu-id="d8b09-149">Slutpunkt:port</span><span class="sxs-lookup"><span data-stu-id="d8b09-149">Endpoint:port</span></span> |
| --- | --- |
| <span data-ttu-id="d8b09-150">Kontrollplanåtgärder för Nyckelvalv</span><span class="sxs-lookup"><span data-stu-id="d8b09-150">Key Vault control plane operations</span></span><br> <span data-ttu-id="d8b09-151">via Azure Resource Manager</span><span class="sxs-lookup"><span data-stu-id="d8b09-151">via Azure Resource Manager</span></span> |<span data-ttu-id="d8b09-152">**Globalt:**</span><span class="sxs-lookup"><span data-stu-id="d8b09-152">**Global:**</span></span><br> <span data-ttu-id="d8b09-153">management.azure.com:443</span><span class="sxs-lookup"><span data-stu-id="d8b09-153">management.azure.com:443</span></span><br><br> <span data-ttu-id="d8b09-154">**Azure i Kina:**</span><span class="sxs-lookup"><span data-stu-id="d8b09-154">**Azure China:**</span></span><br> <span data-ttu-id="d8b09-155">management.chinacloudapi.cn:443</span><span class="sxs-lookup"><span data-stu-id="d8b09-155">management.chinacloudapi.cn:443</span></span><br><br> <span data-ttu-id="d8b09-156">**Azure för amerikanska myndigheter:**</span><span class="sxs-lookup"><span data-stu-id="d8b09-156">**Azure US Government:**</span></span><br> <span data-ttu-id="d8b09-157">management.usgovcloudapi.net:443</span><span class="sxs-lookup"><span data-stu-id="d8b09-157">management.usgovcloudapi.net:443</span></span><br><br> <span data-ttu-id="d8b09-158">**Azure i Tyskland:**</span><span class="sxs-lookup"><span data-stu-id="d8b09-158">**Azure Germany:**</span></span><br> <span data-ttu-id="d8b09-159">management.microsoftazure.de:443</span><span class="sxs-lookup"><span data-stu-id="d8b09-159">management.microsoftazure.de:443</span></span> |
| <span data-ttu-id="d8b09-160">Azure Active Directory Graph API</span><span class="sxs-lookup"><span data-stu-id="d8b09-160">Azure Active Directory Graph API</span></span> |<span data-ttu-id="d8b09-161">**Globalt:**</span><span class="sxs-lookup"><span data-stu-id="d8b09-161">**Global:**</span></span><br> <span data-ttu-id="d8b09-162">graph.windows.net:443</span><span class="sxs-lookup"><span data-stu-id="d8b09-162">graph.windows.net:443</span></span><br><br> <span data-ttu-id="d8b09-163">**Azure i Kina:**</span><span class="sxs-lookup"><span data-stu-id="d8b09-163">**Azure China:**</span></span><br> <span data-ttu-id="d8b09-164">graph.chinacloudapi.cn:443</span><span class="sxs-lookup"><span data-stu-id="d8b09-164">graph.chinacloudapi.cn:443</span></span><br><br> <span data-ttu-id="d8b09-165">**Azure för amerikanska myndigheter:**</span><span class="sxs-lookup"><span data-stu-id="d8b09-165">**Azure US Government:**</span></span><br> <span data-ttu-id="d8b09-166">graph.windows.net:443</span><span class="sxs-lookup"><span data-stu-id="d8b09-166">graph.windows.net:443</span></span><br><br> <span data-ttu-id="d8b09-167">**Azure i Tyskland:**</span><span class="sxs-lookup"><span data-stu-id="d8b09-167">**Azure Germany:**</span></span><br> <span data-ttu-id="d8b09-168">graph.cloudapi.de:443</span><span class="sxs-lookup"><span data-stu-id="d8b09-168">graph.cloudapi.de:443</span></span> |

## <a name="key-vault-operations"></a><span data-ttu-id="d8b09-169">Åtgärder i Nyckelvalv</span><span class="sxs-lookup"><span data-stu-id="d8b09-169">Key Vault operations</span></span>
<span data-ttu-id="d8b09-170">Vid all hantering och kryptografiska åtgärder för nyckelvalvsobjekt (nycklar och hemligheter) måste klientprogrammet för nyckelvalv ha åtkomst till slutpunkten för nyckelvalvet.</span><span class="sxs-lookup"><span data-stu-id="d8b09-170">For all key vault object (keys and secrets) management and cryptographic operations, the key vault client needs to access the key vault endpoint.</span></span> <span data-ttu-id="d8b09-171">Slutpunktens DNS-suffix är olika beroende på placeringen av ditt nyckelvalv.</span><span class="sxs-lookup"><span data-stu-id="d8b09-171">The endpoint DNS suffix varies depending on the location of your key vault.</span></span> <span data-ttu-id="d8b09-172">Slutpunkten för Nyckelvalv har följande format: *valvnamn*.*regionsspecifikt dns-suffix* som beskrivs i följande tabell.</span><span class="sxs-lookup"><span data-stu-id="d8b09-172">The key vault endpoint is of the format *vault-name*.*region-specific-dns-suffix*, as described in the following table.</span></span>  

| <span data-ttu-id="d8b09-173">Typ av åtgärd</span><span class="sxs-lookup"><span data-stu-id="d8b09-173">Type of operation</span></span> | <span data-ttu-id="d8b09-174">Slutpunkt:port</span><span class="sxs-lookup"><span data-stu-id="d8b09-174">Endpoint:port</span></span> |
| --- | --- |
| <span data-ttu-id="d8b09-175">Åtgärder inklusive kryptografiska åtgärder på nycklar, skapa, läsa, uppdatera och ta bort nycklar och hemligheter, ställa in eller få taggar och andra attribut för nyckelvalvobjekt (nycklar eller hemligheter)</span><span class="sxs-lookup"><span data-stu-id="d8b09-175">Operations including cryptographic operations on keys; creating, reading, updating, and deleting keys and secrets; setting or getting tags and other attributes on key vault objects (keys or secrets)</span></span> |<span data-ttu-id="d8b09-176">**Globalt:**</span><span class="sxs-lookup"><span data-stu-id="d8b09-176">**Global:**</span></span><br> <span data-ttu-id="d8b09-177">&lt;vault-name&gt;.vault.azure.net:443</span><span class="sxs-lookup"><span data-stu-id="d8b09-177">&lt;vault-name&gt;.vault.azure.net:443</span></span><br><br> <span data-ttu-id="d8b09-178">**Azure i Kina:**</span><span class="sxs-lookup"><span data-stu-id="d8b09-178">**Azure China:**</span></span><br> <span data-ttu-id="d8b09-179">&lt;vault-name&gt;.vault.azure.cn:443</span><span class="sxs-lookup"><span data-stu-id="d8b09-179">&lt;vault-name&gt;.vault.azure.cn:443</span></span><br><br> <span data-ttu-id="d8b09-180">**Azure för amerikanska myndigheter:**</span><span class="sxs-lookup"><span data-stu-id="d8b09-180">**Azure US Government:**</span></span><br> <span data-ttu-id="d8b09-181">&lt;vault-name&gt;.vault.usgovcloudapi.net:443</span><span class="sxs-lookup"><span data-stu-id="d8b09-181">&lt;vault-name&gt;.vault.usgovcloudapi.net:443</span></span><br><br> <span data-ttu-id="d8b09-182">**Azure i Tyskland:**</span><span class="sxs-lookup"><span data-stu-id="d8b09-182">**Azure Germany:**</span></span><br> <span data-ttu-id="d8b09-183">&lt;vault-name&gt;.vault.microsoftazure.de:443</span><span class="sxs-lookup"><span data-stu-id="d8b09-183">&lt;vault-name&gt;.vault.microsoftazure.de:443</span></span> |

## <a name="ip-address-ranges"></a><span data-ttu-id="d8b09-184">IP-adressintervall</span><span class="sxs-lookup"><span data-stu-id="d8b09-184">IP address ranges</span></span>
<span data-ttu-id="d8b09-185">Key Vault-tjänsten använder andra Azure-resurser, som PaaS-infrastruktur.</span><span class="sxs-lookup"><span data-stu-id="d8b09-185">The Key Vault service uses other Azure resources like PaaS infrastructure.</span></span> <span data-ttu-id="d8b09-186">Därför är det inte möjligt att ange ett specifikt IP-adressintervall som Key Vault-tjänstens slutpunkter har vid given tidpunkt.</span><span class="sxs-lookup"><span data-stu-id="d8b09-186">So it's not possible to provide a specific range of IP addresses that Key Vault service endpoints will have at any particular time.</span></span> <span data-ttu-id="d8b09-187">Om din brandvägg endast har stöd för IP-adressintervall finns det mer information i dokumentet [Microsoft Azure Datacenter IP-intervall](https://www.microsoft.com/download/details.aspx?id=41653).</span><span class="sxs-lookup"><span data-stu-id="d8b09-187">If your firewall supports only IP address ranges, refer to the [Microsoft Azure Datacenter IP Ranges](https://www.microsoft.com/download/details.aspx?id=41653) document.</span></span> <span data-ttu-id="d8b09-188">För autentisering och identitet (Azure Active Directory) måste ditt program kunna ansluta till de slutpunkter som beskrivs i [Autentisering och identitetsadresser](https://support.office.com/article/Office-365-URLs-and-IP-address-ranges-8548a211-3fe7-47cb-abb1-355ea5aa88a2).</span><span class="sxs-lookup"><span data-stu-id="d8b09-188">For authentication and identity (Azure Active Directory), your application must be able to connect to the endpoints described in [Authentication and identity addresses](https://support.office.com/article/Office-365-URLs-and-IP-address-ranges-8548a211-3fe7-47cb-abb1-355ea5aa88a2).</span></span>

## <a name="next-steps"></a><span data-ttu-id="d8b09-189">Nästa steg</span><span class="sxs-lookup"><span data-stu-id="d8b09-189">Next steps</span></span>
<span data-ttu-id="d8b09-190">Om du har några frågor om Key Vault ska du gå till [Azure Key Vault-forumet](https://social.msdn.microsoft.com/forums/azure/home?forum=AzureKeyVault).</span><span class="sxs-lookup"><span data-stu-id="d8b09-190">If you have questions about Key Vault, visit the [Azure Key Vault Forums](https://social.msdn.microsoft.com/forums/azure/home?forum=AzureKeyVault).</span></span>

