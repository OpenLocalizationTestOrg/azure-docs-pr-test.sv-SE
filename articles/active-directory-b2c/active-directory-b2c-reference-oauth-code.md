---
title: "Auktoriseringskodflödet - Azure AD B2C | Microsoft Docs"
description: "Lär dig mer om att skapa webbprogram med hjälp av autentiseringsprotokollet Azure AD B2C och OpenID Connect."
services: active-directory-b2c
documentationcenter: 
author: saeedakhter-msft
manager: krassk
editor: parakhj
ms.assetid: c371aaab-813a-4317-97df-b62e2f53d865
ms.service: active-directory-b2c
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 08/16/2017
ms.author: saeedakhter-msft
ms.openlocfilehash: dfc4f2e84704307ccbea6141c0dbc8d089733b22
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 08/29/2017
---
# <a name="azure-active-directory-b2c-oauth-20-authorization-code-flow"></a><span data-ttu-id="c7c8a-103">Azure Active Directory B2C: OAuth 2.0-auktoriseringskodflödet</span><span class="sxs-lookup"><span data-stu-id="c7c8a-103">Azure Active Directory B2C: OAuth 2.0 authorization code flow</span></span>
<span data-ttu-id="c7c8a-104">Du kan använda OAuth 2.0 auktorisering kod bevilja i appar som installeras på en enhet för att få åtkomst till skyddade resurser, till exempel web API: er.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-104">You can use the OAuth 2.0 authorization code grant in apps installed on a device to gain access to protected resources, such as web APIs.</span></span> <span data-ttu-id="c7c8a-105">Med hjälp av Azure Active Directory B2C (Azure AD B2C) implementering av OAuth 2.0, kan du lägga till registrering, inloggning och andra Identitetshantering uppgifter till dina appar och program.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-105">By using the Azure Active Directory B2C (Azure AD B2C) implementation of OAuth 2.0, you can add sign-up, sign-in, and other identity management tasks to your mobile and desktop apps.</span></span> <span data-ttu-id="c7c8a-106">Den här artikeln är språkoberoende.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-106">This article is language-independent.</span></span> <span data-ttu-id="c7c8a-107">I artikeln beskrivs hur du skickar och tar emot HTTP-meddelanden utan att använda alla bibliotek med öppen källkod.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-107">In the article, we describe how to send and receive HTTP messages without using any open-source libraries.</span></span>

<!-- TODO: Need link to libraries -->

<span data-ttu-id="c7c8a-108">OAuth 2.0-auktoriseringskodflödet beskrivs i [avsnittet 4.1 i OAuth 2.0-specifikationen](http://tools.ietf.org/html/rfc6749).</span><span class="sxs-lookup"><span data-stu-id="c7c8a-108">The OAuth 2.0 authorization code flow is described in [section 4.1 of the OAuth 2.0 specification](http://tools.ietf.org/html/rfc6749).</span></span> <span data-ttu-id="c7c8a-109">Du kan använda för autentisering och auktorisering i de flesta apptyper, inklusive [webbappar](active-directory-b2c-apps.md#web-apps) och [internt installerade appar](active-directory-b2c-apps.md#mobile-and-native-apps).</span><span class="sxs-lookup"><span data-stu-id="c7c8a-109">You can use it for authentication and authorization in most app types, including [web apps](active-directory-b2c-apps.md#web-apps) and [natively installed apps](active-directory-b2c-apps.md#mobile-and-native-apps).</span></span> <span data-ttu-id="c7c8a-110">Du kan använda OAuth 2.0-auktoriseringskodflödet att på ett säkert sätt hämta *åtkomst till token* för dina appar som kan användas för att komma åt resurser som skyddas av en [auktorisering server](active-directory-b2c-reference-protocols.md#the-basics).</span><span class="sxs-lookup"><span data-stu-id="c7c8a-110">You can use the OAuth 2.0 authorization code flow to securely acquire *access tokens* for your apps, which can be used to access resources that are secured by an [authorization server](active-directory-b2c-reference-protocols.md#the-basics).</span></span>

<span data-ttu-id="c7c8a-111">Den här artikeln fokuserar på de **offentliga klienter** OAuth 2.0-auktoriseringskodflödet.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-111">This article focuses on the **public clients** OAuth 2.0 authorization code flow.</span></span> <span data-ttu-id="c7c8a-112">En offentlig klient är alla klientprogram som inte är betrott på ett säkert sätt Underhåll integriteten hos ett hemligt lösenord.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-112">A public client is any client application that cannot be trusted to securely maintain the integrity of a secret password.</span></span> <span data-ttu-id="c7c8a-113">Detta inkluderar mobilappar och skrivbordsappar i stort sett alla program som körs på en enhet och behöver få åtkomst-token.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-113">This includes mobile apps, desktop apps, and essentially any application that runs on a device and needs to get access tokens.</span></span> 

> [!NOTE]
> <span data-ttu-id="c7c8a-114">Lägg till Identitetshantering i ett webbprogram med hjälp av Azure AD B2C genom att använda [OpenID Connect](active-directory-b2c-reference-oidc.md) i stället för OAuth 2.0.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-114">To add identity management to a web app by using Azure AD B2C, use [OpenID Connect](active-directory-b2c-reference-oidc.md) instead of OAuth 2.0.</span></span>

<span data-ttu-id="c7c8a-115">Azure AD B2C utökar standard OAuth 2.0 flödar om du vill göra mer än enkel autentisering och auktorisering.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-115">Azure AD B2C extends the standard OAuth 2.0 flows to do more than simple authentication and authorization.</span></span> <span data-ttu-id="c7c8a-116">Det inför den [parametern](active-directory-b2c-reference-policies.md).</span><span class="sxs-lookup"><span data-stu-id="c7c8a-116">It introduces the [policy parameter](active-directory-b2c-reference-policies.md).</span></span> <span data-ttu-id="c7c8a-117">Med inbyggda principer, du kan använda OAuth 2.0 att lägga till användarupplevelser i din app som registrering, inloggning och profilhantering.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-117">With built-in policies, you can use OAuth 2.0 to add user experiences to your app, such as sign-up, sign-in, and profile management.</span></span> <span data-ttu-id="c7c8a-118">I den här artikeln hur vi du använder OAuth 2.0 och principer för att implementera var och en av dessa upplevelser i dina interna program.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-118">In this article, we show you how to use OAuth 2.0 and policies to implement each of these experiences in your native applications.</span></span> <span data-ttu-id="c7c8a-119">Vi också hur du få åtkomst-token för åtkomst till webb-API: er.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-119">We also show you how to get access tokens for accessing web APIs.</span></span>

<span data-ttu-id="c7c8a-120">I exempel HTTP-begäranden i den här artikeln använder vi våra exempel Azure AD B2C-katalog, **fabrikamb2c.onmicrosoft.com**. Vi använder också våra exempelprogrammet och principer.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-120">In the example HTTP requests in this article, we use our sample Azure AD B2C directory, **fabrikamb2c.onmicrosoft.com**. We also use our sample application and policies.</span></span> <span data-ttu-id="c7c8a-121">Du kan också försöka begäranden med hjälp av dessa värden eller ersätta dem med egna värden.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-121">You can try the requests yourself by using these values, or you can replace them with your own values.</span></span>
<span data-ttu-id="c7c8a-122">Lär dig hur du [hämta egna Azure AD B2C-katalog, program och principer](#use-your-own-azure-ad-b2c-directory).</span><span class="sxs-lookup"><span data-stu-id="c7c8a-122">Learn how to [get your own Azure AD B2C directory, application, and policies](#use-your-own-azure-ad-b2c-directory).</span></span>

## <a name="1-get-an-authorization-code"></a><span data-ttu-id="c7c8a-123">1. Hämta en auktoriseringskod för</span><span class="sxs-lookup"><span data-stu-id="c7c8a-123">1. Get an authorization code</span></span>
<span data-ttu-id="c7c8a-124">Auktoriseringskodflödet börjar med klienten dirigera användare till den `/authorize` slutpunkt.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-124">The authorization code flow begins with the client directing the user to the `/authorize` endpoint.</span></span> <span data-ttu-id="c7c8a-125">Detta är den interaktiva delen av flödet, där användaren vidtar åtgärder.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-125">This is the interactive part of the flow, where the user takes action.</span></span> <span data-ttu-id="c7c8a-126">I den här förfrågan klienten anger i den `scope` parametern de behörigheter som krävs för att hämta från användaren.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-126">In this request, the client indicates in the `scope` parameter the permissions that it needs to acquire from the user.</span></span> <span data-ttu-id="c7c8a-127">I den `p` parametern anger principen som ska köras.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-127">In the `p` parameter, it indicates the policy to execute.</span></span> <span data-ttu-id="c7c8a-128">Följande tre exempel (med radbrytningar för att läsa) varje använda en annan princip.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-128">The following three examples (with line breaks for readability) each use a different policy.</span></span>

### <a name="use-a-sign-in-policy"></a><span data-ttu-id="c7c8a-129">Använda en princip för inloggning</span><span class="sxs-lookup"><span data-stu-id="c7c8a-129">Use a sign-in policy</span></span>
```
GET https://login.microsoftonline.com/fabrikamb2c.onmicrosoft.com/oauth2/v2.0/authorize?
client_id=90c0fe63-bcf2-44d5-8fb7-b8bbc0b29dc6
&response_type=code
&redirect_uri=urn%3Aietf%3Awg%3Aoauth%3A2.0%3Aoob
&response_mode=query
&scope=90c0fe63-bcf2-44d5-8fb7-b8bbc0b29dc6%20offline_access
&state=arbitrary_data_you_can_receive_in_the_response
&p=b2c_1_sign_in
```

### <a name="use-a-sign-up-policy"></a><span data-ttu-id="c7c8a-130">Använda en princip för registrering</span><span class="sxs-lookup"><span data-stu-id="c7c8a-130">Use a sign-up policy</span></span>
```
GET https://login.microsoftonline.com/fabrikamb2c.onmicrosoft.com/oauth2/v2.0/authorize?
client_id=90c0fe63-bcf2-44d5-8fb7-b8bbc0b29dc6
&response_type=code
&redirect_uri=urn%3Aietf%3Awg%3Aoauth%3A2.0%3Aoob
&response_mode=query
&scope=90c0fe63-bcf2-44d5-8fb7-b8bbc0b29dc6%20offline_access
&state=arbitrary_data_you_can_receive_in_the_response
&p=b2c_1_sign_up
```

### <a name="use-an-edit-profile-policy"></a><span data-ttu-id="c7c8a-131">Använda en princip för Redigera-profil</span><span class="sxs-lookup"><span data-stu-id="c7c8a-131">Use an edit-profile policy</span></span>
```
GET https://login.microsoftonline.com/fabrikamb2c.onmicrosoft.com/oauth2/v2.0/authorize?
client_id=90c0fe63-bcf2-44d5-8fb7-b8bbc0b29dc6
&response_type=code
&redirect_uri=urn%3Aietf%3Awg%3Aoauth%3A2.0%3Aoob
&response_mode=query
&scope=90c0fe63-bcf2-44d5-8fb7-b8bbc0b29dc6%20offline_access
&state=arbitrary_data_you_can_receive_in_the_response
&p=b2c_1_edit_profile
```

| <span data-ttu-id="c7c8a-132">Parameter</span><span class="sxs-lookup"><span data-stu-id="c7c8a-132">Parameter</span></span> | <span data-ttu-id="c7c8a-133">Krävs?</span><span class="sxs-lookup"><span data-stu-id="c7c8a-133">Required?</span></span> | <span data-ttu-id="c7c8a-134">Beskrivning</span><span class="sxs-lookup"><span data-stu-id="c7c8a-134">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="c7c8a-135">client_id</span><span class="sxs-lookup"><span data-stu-id="c7c8a-135">client_id</span></span> |<span data-ttu-id="c7c8a-136">Krävs</span><span class="sxs-lookup"><span data-stu-id="c7c8a-136">Required</span></span> |<span data-ttu-id="c7c8a-137">Det program-ID som har tilldelats din app i den [Azure-portalen](https://portal.azure.com).</span><span class="sxs-lookup"><span data-stu-id="c7c8a-137">The application ID assigned to your app in the [Azure portal](https://portal.azure.com).</span></span> |
| <span data-ttu-id="c7c8a-138">response_type</span><span class="sxs-lookup"><span data-stu-id="c7c8a-138">response_type</span></span> |<span data-ttu-id="c7c8a-139">Krävs</span><span class="sxs-lookup"><span data-stu-id="c7c8a-139">Required</span></span> |<span data-ttu-id="c7c8a-140">Svarstyp som måste innehålla `code` för auktoriseringskodflödet.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-140">The response type, which must include `code` for the authorization code flow.</span></span> |
| <span data-ttu-id="c7c8a-141">redirect_uri</span><span class="sxs-lookup"><span data-stu-id="c7c8a-141">redirect_uri</span></span> |<span data-ttu-id="c7c8a-142">Krävs</span><span class="sxs-lookup"><span data-stu-id="c7c8a-142">Required</span></span> |<span data-ttu-id="c7c8a-143">Omdirigerings-URI för din app, där autentisering svar skickas och tas emot av din app.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-143">The redirect URI of your app, where authentication responses are sent and received by your app.</span></span> <span data-ttu-id="c7c8a-144">Den måste matcha en omdirigerings-URI: er som du har registrerat i portalen, förutom att det måste vara URL-kodade.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-144">It must exactly match one of the redirect URIs that you registered in the portal, except that it must be URL-encoded.</span></span> |
| <span data-ttu-id="c7c8a-145">Omfång</span><span class="sxs-lookup"><span data-stu-id="c7c8a-145">scope</span></span> |<span data-ttu-id="c7c8a-146">Krävs</span><span class="sxs-lookup"><span data-stu-id="c7c8a-146">Required</span></span> |<span data-ttu-id="c7c8a-147">En blankstegsavgränsad lista över scope.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-147">A space-separated list of scopes.</span></span> <span data-ttu-id="c7c8a-148">Ett enda scope-värde som anger till Azure Active Directory (AD Azure) båda de behörigheter som krävs.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-148">A single scope value indicates to Azure Active Directory (Azure AD) both of the permissions that are being requested.</span></span> <span data-ttu-id="c7c8a-149">Med klient-ID som omfattningen visar att din app behöver ett åtkomsttoken som kan användas med tjänsten eller webb-API, som representeras av samma klient-ID.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-149">Using the client ID as the scope indicates that your app needs an access token that can be used against your own service or web API, represented by the same client ID.</span></span>  <span data-ttu-id="c7c8a-150">Den `offline_access` scope visar att din app behöver en uppdateringstoken för långlivade åtkomst till resurser.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-150">The `offline_access` scope indicates that your app needs a refresh token for long-lived access to resources.</span></span> <span data-ttu-id="c7c8a-151">Du kan också använda den `openid` scope för att begära en ID-token från Azure AD B2C.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-151">You also can use the `openid` scope to request an ID token from Azure AD B2C.</span></span> |
| <span data-ttu-id="c7c8a-152">response_mode</span><span class="sxs-lookup"><span data-stu-id="c7c8a-152">response_mode</span></span> |<span data-ttu-id="c7c8a-153">Rekommenderas</span><span class="sxs-lookup"><span data-stu-id="c7c8a-153">Recommended</span></span> |<span data-ttu-id="c7c8a-154">Den metod som används för att skicka den resulterande Auktoriseringskoden tillbaka till din app.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-154">The method that you use to send the resulting authorization code back to your app.</span></span> <span data-ttu-id="c7c8a-155">Det kan vara `query`, `form_post`, eller `fragment`.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-155">It can be `query`, `form_post`, or `fragment`.</span></span> |
| <span data-ttu-id="c7c8a-156">state</span><span class="sxs-lookup"><span data-stu-id="c7c8a-156">state</span></span> |<span data-ttu-id="c7c8a-157">Rekommenderas</span><span class="sxs-lookup"><span data-stu-id="c7c8a-157">Recommended</span></span> |<span data-ttu-id="c7c8a-158">Ett värde som ingår i denna begäran som returneras i token svaret.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-158">A value included in the request that is returned in the token response.</span></span> <span data-ttu-id="c7c8a-159">Det kan vara en sträng med innehåll som du vill använda.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-159">It can be a string of any content that you want to use.</span></span> <span data-ttu-id="c7c8a-160">Vanligtvis används ett slumpmässigt genererat unikt värde för att förhindra attacker med förfalskning av begäran.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-160">Usually, a randomly generated unique value is  used, to prevent cross-site request forgery attacks.</span></span> <span data-ttu-id="c7c8a-161">Tillståndet också används för att koda information om användarens tillstånd i appen innan autentiseringsbegäran inträffade.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-161">The state also is used to encode information about the user's state in the app before the authentication request occurred.</span></span> <span data-ttu-id="c7c8a-162">Till exempel sidan användaren utfördes eller den princip som kördes.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-162">For example, the page the user was on, or the policy that was being executed.</span></span> |
| <span data-ttu-id="c7c8a-163">P</span><span class="sxs-lookup"><span data-stu-id="c7c8a-163">p</span></span> |<span data-ttu-id="c7c8a-164">Krävs</span><span class="sxs-lookup"><span data-stu-id="c7c8a-164">Required</span></span> |<span data-ttu-id="c7c8a-165">Den princip som körs.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-165">The policy that is executed.</span></span> <span data-ttu-id="c7c8a-166">Det är namnet på en princip som har skapats i Azure AD B2C-katalogen.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-166">It's the name of a policy that is created in your Azure AD B2C directory.</span></span> <span data-ttu-id="c7c8a-167">Princip för namn-värde ska inledas med **b2c\_1\_**.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-167">The policy name value should begin with **b2c\_1\_**.</span></span> <span data-ttu-id="c7c8a-168">Mer information om principer finns [Azure AD B2C inbyggda principer](active-directory-b2c-reference-policies.md).</span><span class="sxs-lookup"><span data-stu-id="c7c8a-168">To learn more about policies, see [Azure AD B2C built-in policies](active-directory-b2c-reference-policies.md).</span></span> |
| <span data-ttu-id="c7c8a-169">kommandotolk</span><span class="sxs-lookup"><span data-stu-id="c7c8a-169">prompt</span></span> |<span data-ttu-id="c7c8a-170">Valfri</span><span class="sxs-lookup"><span data-stu-id="c7c8a-170">Optional</span></span> |<span data-ttu-id="c7c8a-171">Typ av användarinteraktion som krävs.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-171">The type of user interaction that is required.</span></span> <span data-ttu-id="c7c8a-172">Det enda giltiga värdet är för närvarande `login`, som tvingar användaren att ange sina autentiseringsuppgifter på begäran.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-172">Currently, the only valid value is `login`, which forces the user to enter their credentials on that request.</span></span> <span data-ttu-id="c7c8a-173">Enkel inloggning börjar inte gälla.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-173">Single sign-on will not take effect.</span></span> |

<span data-ttu-id="c7c8a-174">Nu uppmanas användaren att slutföra arbetsflödet för den principen.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-174">At this point, the user is asked to complete the policy's workflow.</span></span> <span data-ttu-id="c7c8a-175">Detta kan handla om användaren att ange sina användarnamn och lösenord, logga in med en sociala identitet registrerar sig för katalogen, eller en annan siffra steg.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-175">This might involve the user entering their username and password, signing in with a social identity, signing up for the directory, or any other number of steps.</span></span> <span data-ttu-id="c7c8a-176">Användaråtgärder beror på hur principen har definierats.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-176">User actions depend on how the policy is defined.</span></span>

<span data-ttu-id="c7c8a-177">När användaren uppfyller principen, Azure AD tillbaka ett svar på din app på värdet som du använde för `redirect_uri`.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-177">After the user completes the policy, Azure AD returns a response to your app at the value you used for `redirect_uri`.</span></span> <span data-ttu-id="c7c8a-178">Den använder metoden som anges i den `response_mode` parameter.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-178">It uses the method specified in the `response_mode` parameter.</span></span> <span data-ttu-id="c7c8a-179">Svaret är exakt samma för alla användare åtgärd scenarier, oberoende av den princip som har utförts.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-179">The response is exactly the same for each of the user action scenarios, independent of the policy that was executed.</span></span>

<span data-ttu-id="c7c8a-180">Ett lyckat svar som använder `response_mode=query` ser ut så här:</span><span class="sxs-lookup"><span data-stu-id="c7c8a-180">A successful response that uses `response_mode=query` looks like this:</span></span>

```
GET urn:ietf:wg:oauth:2.0:oob?
code=AwABAAAAvPM1KaPlrEqdFSBzjqfTGBCmLdgfSTLEMPGYuNHSUYBrq...        // the authorization_code, truncated
&state=arbitrary_data_you_can_receive_in_the_response                // the value provided in the request
```

| <span data-ttu-id="c7c8a-181">Parameter</span><span class="sxs-lookup"><span data-stu-id="c7c8a-181">Parameter</span></span> | <span data-ttu-id="c7c8a-182">Beskrivning</span><span class="sxs-lookup"><span data-stu-id="c7c8a-182">Description</span></span> |
| --- | --- |
| <span data-ttu-id="c7c8a-183">Koden</span><span class="sxs-lookup"><span data-stu-id="c7c8a-183">code</span></span> |<span data-ttu-id="c7c8a-184">Auktoriseringskoden som begärts av appen.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-184">The authorization code that the app requested.</span></span> <span data-ttu-id="c7c8a-185">Appen kan använda Auktoriseringskoden för att begära en åtkomst-token för en målresurs.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-185">The app can use the authorization code to request an access token for a target resource.</span></span> <span data-ttu-id="c7c8a-186">Auktoriseringskoder är mycket tillfällig.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-186">Authorization codes are very short-lived.</span></span> <span data-ttu-id="c7c8a-187">Vanligtvis de går ut efter 10 minuter.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-187">Typically, they expire after about 10 minutes.</span></span> |
| <span data-ttu-id="c7c8a-188">state</span><span class="sxs-lookup"><span data-stu-id="c7c8a-188">state</span></span> |<span data-ttu-id="c7c8a-189">Se den fullständiga beskrivningen i tabellen i föregående avsnitt.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-189">See the full description in the table in the preceding section.</span></span> <span data-ttu-id="c7c8a-190">Om en `state` parametern ingår i begäran, samma värde som ska visas i svaret.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-190">If a `state` parameter is included in the request, the same value should appear in the response.</span></span> <span data-ttu-id="c7c8a-191">Appen bör kontrollera att den `state` värden i förfrågan och svar är identiska.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-191">The app should verify that the `state` values in the request and response are identical.</span></span> |

<span data-ttu-id="c7c8a-192">Felsvar kan också skickas till omdirigerings-URI så att appen kan hantera dem på rätt sätt:</span><span class="sxs-lookup"><span data-stu-id="c7c8a-192">Error responses also can be sent to the redirect URI so that the app can handle them appropriately:</span></span>

```
GET urn:ietf:wg:oauth:2.0:oob?
error=access_denied
&error_description=The+user+has+cancelled+entering+self-asserted+information
&state=arbitrary_data_you_can_receive_in_the_response
```

| <span data-ttu-id="c7c8a-193">Parameter</span><span class="sxs-lookup"><span data-stu-id="c7c8a-193">Parameter</span></span> | <span data-ttu-id="c7c8a-194">Beskrivning</span><span class="sxs-lookup"><span data-stu-id="c7c8a-194">Description</span></span> |
| --- | --- |
| <span data-ttu-id="c7c8a-195">fel</span><span class="sxs-lookup"><span data-stu-id="c7c8a-195">error</span></span> |<span data-ttu-id="c7c8a-196">Ett felkod sträng som du kan använda för att klassificera typerna av fel som inträffar.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-196">An error code string that you can use to classify the types of errors that occur.</span></span> <span data-ttu-id="c7c8a-197">Du kan också använda strängen att ta hänsyn till fel.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-197">You also can use the string to react to errors.</span></span> |
| <span data-ttu-id="c7c8a-198">error_description</span><span class="sxs-lookup"><span data-stu-id="c7c8a-198">error_description</span></span> |<span data-ttu-id="c7c8a-199">Ett felmeddelande som kan hjälpa dig att identifiera orsaken till ett autentiseringsfel.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-199">A specific error message that can help you identify the root cause of an authentication error.</span></span> |
| <span data-ttu-id="c7c8a-200">state</span><span class="sxs-lookup"><span data-stu-id="c7c8a-200">state</span></span> |<span data-ttu-id="c7c8a-201">Se den fullständiga beskrivningen i föregående tabell.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-201">See the full description in the preceding table.</span></span> <span data-ttu-id="c7c8a-202">Om en `state` parametern ingår i begäran, samma värde som ska visas i svaret.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-202">If a `state` parameter is included in the request, the same value should appear in the response.</span></span> <span data-ttu-id="c7c8a-203">Appen bör kontrollera att den `state` värden i förfrågan och svar är identiska.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-203">The app should verify that the `state` values in the request and response are identical.</span></span> |

## <a name="2-get-a-token"></a><span data-ttu-id="c7c8a-204">2. Hämta en token</span><span class="sxs-lookup"><span data-stu-id="c7c8a-204">2. Get a token</span></span>
<span data-ttu-id="c7c8a-205">Nu när du har skaffat ett auktoriseringskod, kan du lösa in den `code` för en token för den avsedda resursen genom att skicka en POST-begäran till den `/token` slutpunkt.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-205">Now that you've acquired an authorization code, you can redeem the `code` for a token to the intended resource by sending a POST request to the `/token` endpoint.</span></span> <span data-ttu-id="c7c8a-206">I Azure AD B2C är den enda resursen som du kan begära en token för ditt Apps egen backend-webb-API.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-206">In Azure AD B2C, the only resource that you can request a token for is your app's own back-end web API.</span></span> <span data-ttu-id="c7c8a-207">Konventionen som används för att begära en token till dig själv är att använda appens klient-ID som scope:</span><span class="sxs-lookup"><span data-stu-id="c7c8a-207">The convention that's used for requesting a token to yourself is to use your app's client ID as the scope:</span></span>

```
POST fabrikamb2c.onmicrosoft.com/oauth2/v2.0/token?p=b2c_1_sign_in HTTP/1.1
Host: https://login.microsoftonline.com
Content-Type: application/x-www-form-urlencoded

grant_type=authorization_code&client_id=90c0fe63-bcf2-44d5-8fb7-b8bbc0b29dc6&scope=90c0fe63-bcf2-44d5-8fb7-b8bbc0b29dc6 offline_access&code=AwABAAAAvPM1KaPlrEqdFSBzjqfTGBCmLdgfSTLEMPGYuNHSUYBrq...&redirect_uri=urn:ietf:wg:oauth:2.0:oob

```

| <span data-ttu-id="c7c8a-208">Parameter</span><span class="sxs-lookup"><span data-stu-id="c7c8a-208">Parameter</span></span> | <span data-ttu-id="c7c8a-209">Krävs?</span><span class="sxs-lookup"><span data-stu-id="c7c8a-209">Required?</span></span> | <span data-ttu-id="c7c8a-210">Beskrivning</span><span class="sxs-lookup"><span data-stu-id="c7c8a-210">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="c7c8a-211">P</span><span class="sxs-lookup"><span data-stu-id="c7c8a-211">p</span></span> |<span data-ttu-id="c7c8a-212">Krävs</span><span class="sxs-lookup"><span data-stu-id="c7c8a-212">Required</span></span> |<span data-ttu-id="c7c8a-213">Den princip som användes för att hämta Auktoriseringskoden.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-213">The policy that was used to acquire the authorization code.</span></span> <span data-ttu-id="c7c8a-214">Du kan inte använda en annan princip i den här förfrågan.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-214">You cannot use a different policy in this request.</span></span> <span data-ttu-id="c7c8a-215">Observera att du lägger till den här parametern till den *frågesträng*, inte i själva POST.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-215">Note that you add this parameter to the *query string*, not in the POST body.</span></span> |
| <span data-ttu-id="c7c8a-216">client_id</span><span class="sxs-lookup"><span data-stu-id="c7c8a-216">client_id</span></span> |<span data-ttu-id="c7c8a-217">Krävs</span><span class="sxs-lookup"><span data-stu-id="c7c8a-217">Required</span></span> |<span data-ttu-id="c7c8a-218">Det program-ID som har tilldelats din app i den [Azure-portalen](https://portal.azure.com).</span><span class="sxs-lookup"><span data-stu-id="c7c8a-218">The application ID assigned to your app in the [Azure portal](https://portal.azure.com).</span></span> |
| <span data-ttu-id="c7c8a-219">grant_type</span><span class="sxs-lookup"><span data-stu-id="c7c8a-219">grant_type</span></span> |<span data-ttu-id="c7c8a-220">Krävs</span><span class="sxs-lookup"><span data-stu-id="c7c8a-220">Required</span></span> |<span data-ttu-id="c7c8a-221">Typ av bevilja.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-221">The type of grant.</span></span> <span data-ttu-id="c7c8a-222">För auktoriseringskodflödet, grant-typen måste vara `authorization_code`.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-222">For the authorization code flow, the grant type must be `authorization_code`.</span></span> |
| <span data-ttu-id="c7c8a-223">Omfång</span><span class="sxs-lookup"><span data-stu-id="c7c8a-223">scope</span></span> |<span data-ttu-id="c7c8a-224">Rekommenderas</span><span class="sxs-lookup"><span data-stu-id="c7c8a-224">Recommended</span></span> |<span data-ttu-id="c7c8a-225">En blankstegsavgränsad lista över scope.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-225">A space-separated list of scopes.</span></span> <span data-ttu-id="c7c8a-226">Ett enda scope-värde som anger till Azure AD båda de behörigheter som krävs.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-226">A single scope value indicates to Azure AD both of the permissions that are being requested.</span></span> <span data-ttu-id="c7c8a-227">Med klient-ID som omfattningen visar att din app behöver ett åtkomsttoken som kan användas med tjänsten eller webb-API, som representeras av samma klient-ID.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-227">Using the client ID as the scope indicates that your app needs an access token that can be used against your own service or web API, represented by the same client ID.</span></span>  <span data-ttu-id="c7c8a-228">Den `offline_access` scope visar att din app behöver en uppdateringstoken för långlivade åtkomst till resurser.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-228">The `offline_access` scope indicates that your app needs a refresh token for long-lived access to resources.</span></span>  <span data-ttu-id="c7c8a-229">Du kan också använda den `openid` scope för att begära en ID-token från Azure AD B2C.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-229">You also can use the `openid` scope to request an ID token from Azure AD B2C.</span></span> |
| <span data-ttu-id="c7c8a-230">Koden</span><span class="sxs-lookup"><span data-stu-id="c7c8a-230">code</span></span> |<span data-ttu-id="c7c8a-231">Krävs</span><span class="sxs-lookup"><span data-stu-id="c7c8a-231">Required</span></span> |<span data-ttu-id="c7c8a-232">Auktoriseringskoden som du har införskaffade i den första del av flödet.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-232">The authorization code that you acquired in the first leg of the flow.</span></span> |
| <span data-ttu-id="c7c8a-233">redirect_uri</span><span class="sxs-lookup"><span data-stu-id="c7c8a-233">redirect_uri</span></span> |<span data-ttu-id="c7c8a-234">Krävs</span><span class="sxs-lookup"><span data-stu-id="c7c8a-234">Required</span></span> |<span data-ttu-id="c7c8a-235">Omdirigerings-URI för det program som du fick Auktoriseringskoden.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-235">The redirect URI of the application where you received the authorization code.</span></span> |

<span data-ttu-id="c7c8a-236">Ett lyckat svar för token som ser ut så här:</span><span class="sxs-lookup"><span data-stu-id="c7c8a-236">A successful token response looks like this:</span></span>

```
{
    "not_before": "1442340812",
    "token_type": "Bearer",
    "access_token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ik5HVEZ2ZEstZnl0aEV1Q...",
    "scope": "90c0fe63-bcf2-44d5-8fb7-b8bbc0b29dc6 offline_access",
    "expires_in": "3600",
    "refresh_token": "AAQfQmvuDy8WtUv-sd0TBwWVQs1rC-Lfxa_NDkLqpg50Cxp5Dxj0VPF1mx2Z...",
}
```
| <span data-ttu-id="c7c8a-237">Parameter</span><span class="sxs-lookup"><span data-stu-id="c7c8a-237">Parameter</span></span> | <span data-ttu-id="c7c8a-238">Beskrivning</span><span class="sxs-lookup"><span data-stu-id="c7c8a-238">Description</span></span> |
| --- | --- |
| <span data-ttu-id="c7c8a-239">not_before</span><span class="sxs-lookup"><span data-stu-id="c7c8a-239">not_before</span></span> |<span data-ttu-id="c7c8a-240">Den tid då token betraktas som giltigt epok tidpunkt.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-240">The time at which the token is considered valid, in epoch time.</span></span> |
| <span data-ttu-id="c7c8a-241">token_type</span><span class="sxs-lookup"><span data-stu-id="c7c8a-241">token_type</span></span> |<span data-ttu-id="c7c8a-242">Tokentypen-värde.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-242">The token type value.</span></span> <span data-ttu-id="c7c8a-243">Den enda typen som har stöd för Azure AD är ägar.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-243">The only type that Azure AD supports is Bearer.</span></span> |
| <span data-ttu-id="c7c8a-244">access_token</span><span class="sxs-lookup"><span data-stu-id="c7c8a-244">access_token</span></span> |<span data-ttu-id="c7c8a-245">Den signerade JSON-Webbtoken (JWT) som du har begärt.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-245">The signed JSON Web Token (JWT) that you requested.</span></span> |
| <span data-ttu-id="c7c8a-246">Omfång</span><span class="sxs-lookup"><span data-stu-id="c7c8a-246">scope</span></span> |<span data-ttu-id="c7c8a-247">Scope som gäller för token.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-247">The scopes that the token is valid for.</span></span> <span data-ttu-id="c7c8a-248">Du kan också använda omfång cache-tokens för senare användning.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-248">You also can use scopes to cache tokens for later use.</span></span> |
| <span data-ttu-id="c7c8a-249">expires_in</span><span class="sxs-lookup"><span data-stu-id="c7c8a-249">expires_in</span></span> |<span data-ttu-id="c7c8a-250">Hur lång tid som denna token är giltig (i sekunder).</span><span class="sxs-lookup"><span data-stu-id="c7c8a-250">The length of time that the token is valid (in seconds).</span></span> |
| <span data-ttu-id="c7c8a-251">refresh_token</span><span class="sxs-lookup"><span data-stu-id="c7c8a-251">refresh_token</span></span> |<span data-ttu-id="c7c8a-252">En token för uppdatering av OAuth 2.0.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-252">An OAuth 2.0 refresh token.</span></span> <span data-ttu-id="c7c8a-253">Appen kan använda denna token för att hämta ytterligare token när den aktuella token upphör att gälla.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-253">The app can use this token to acquire additional tokens after the current token expires.</span></span> <span data-ttu-id="c7c8a-254">Uppdateringstoken är långlivade.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-254">Refresh tokens are long-lived.</span></span> <span data-ttu-id="c7c8a-255">Du kan använda dem för att få åtkomst till resurser för längre tid.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-255">You can use them to retain access to resources for extended periods of time.</span></span> <span data-ttu-id="c7c8a-256">Mer information finns i [Azure AD B2C tokenreferens](active-directory-b2c-reference-tokens.md).</span><span class="sxs-lookup"><span data-stu-id="c7c8a-256">For more information, see the [Azure AD B2C token reference](active-directory-b2c-reference-tokens.md).</span></span> |

<span data-ttu-id="c7c8a-257">Felsvar se ut så här:</span><span class="sxs-lookup"><span data-stu-id="c7c8a-257">Error responses look like this:</span></span>

```
{
    "error": "access_denied",
    "error_description": "The user revoked access to the app.",
}
```

| <span data-ttu-id="c7c8a-258">Parameter</span><span class="sxs-lookup"><span data-stu-id="c7c8a-258">Parameter</span></span> | <span data-ttu-id="c7c8a-259">Beskrivning</span><span class="sxs-lookup"><span data-stu-id="c7c8a-259">Description</span></span> |
| --- | --- |
| <span data-ttu-id="c7c8a-260">fel</span><span class="sxs-lookup"><span data-stu-id="c7c8a-260">error</span></span> |<span data-ttu-id="c7c8a-261">Ett felkod sträng som du kan använda för att klassificera typerna av fel som inträffar.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-261">An error code string that you can use to classify the types of errors that occur.</span></span> <span data-ttu-id="c7c8a-262">Du kan också använda strängen att ta hänsyn till fel.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-262">You also can use the string to react to errors.</span></span> |
| <span data-ttu-id="c7c8a-263">error_description</span><span class="sxs-lookup"><span data-stu-id="c7c8a-263">error_description</span></span> |<span data-ttu-id="c7c8a-264">Ett felmeddelande som kan hjälpa dig att identifiera orsaken till ett autentiseringsfel.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-264">A specific error message that can help you identify the root cause of an authentication error.</span></span> |

## <a name="3-use-the-token"></a><span data-ttu-id="c7c8a-265">3. Använda token</span><span class="sxs-lookup"><span data-stu-id="c7c8a-265">3. Use the token</span></span>
<span data-ttu-id="c7c8a-266">Nu när du har har skaffat ett åtkomsttoken, kan du använda token i begäranden till din backend-webb-API: er genom att inkludera den i den `Authorization` huvud:</span><span class="sxs-lookup"><span data-stu-id="c7c8a-266">Now that you've successfully acquired an access token, you can use the token in requests to your back-end web APIs by including it in the `Authorization` header:</span></span>

```
GET /tasks
Host: https://mytaskwebapi.com
Authorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ik5HVEZ2ZEstZnl0aEV1Q...
```

## <a name="4-refresh-the-token"></a><span data-ttu-id="c7c8a-267">4. Uppdatera token</span><span class="sxs-lookup"><span data-stu-id="c7c8a-267">4. Refresh the token</span></span>
<span data-ttu-id="c7c8a-268">Åtkomst-token och ID-token är tillfällig.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-268">Access tokens and ID tokens are short-lived.</span></span> <span data-ttu-id="c7c8a-269">När de upphör att gälla måste du uppdatera dem. Om du vill fortsätta att komma åt resurser.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-269">After they expire, you must refresh them to continue to access resources.</span></span> <span data-ttu-id="c7c8a-270">Det gör du genom att skicka en annan POST-begäran till den `/token` slutpunkt.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-270">To do this, submit another POST request to the `/token` endpoint.</span></span> <span data-ttu-id="c7c8a-271">Den här gången den `refresh_token` i stället för den `code`:</span><span class="sxs-lookup"><span data-stu-id="c7c8a-271">This time, provide the `refresh_token` instead of the `code`:</span></span>

```
POST fabrikamb2c.onmicrosoft.com/oauth2/v2.0/token?p=b2c_1_sign_in HTTP/1.1
Host: https://login.microsoftonline.com
Content-Type: application/x-www-form-urlencoded

grant_type=refresh_token&client_id=90c0fe63-bcf2-44d5-8fb7-b8bbc0b29dc6&scope=90c0fe63-bcf2-44d5-8fb7-b8bbc0b29dc6 offline_access&refresh_token=AwABAAAAvPM1KaPlrEqdFSBzjqfTGBCmLdgfSTLEMPGYuNHSUYBrq...&redirect_uri=urn:ietf:wg:oauth:2.0:oob
```

| <span data-ttu-id="c7c8a-272">Parameter</span><span class="sxs-lookup"><span data-stu-id="c7c8a-272">Parameter</span></span> | <span data-ttu-id="c7c8a-273">Krävs?</span><span class="sxs-lookup"><span data-stu-id="c7c8a-273">Required?</span></span> | <span data-ttu-id="c7c8a-274">Beskrivning</span><span class="sxs-lookup"><span data-stu-id="c7c8a-274">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="c7c8a-275">P</span><span class="sxs-lookup"><span data-stu-id="c7c8a-275">p</span></span> |<span data-ttu-id="c7c8a-276">Krävs</span><span class="sxs-lookup"><span data-stu-id="c7c8a-276">Required</span></span> |<span data-ttu-id="c7c8a-277">Den princip som användes för att hämta den ursprungliga uppdateringstoken.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-277">The policy that was used to acquire the original refresh token.</span></span> <span data-ttu-id="c7c8a-278">Du kan inte använda en annan princip i den här förfrågan.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-278">You cannot use a different policy in this request.</span></span> <span data-ttu-id="c7c8a-279">Observera att du lägger till den här parametern till den *frågesträng*, inte i själva POST.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-279">Note that you add this parameter to the *query string*, not in the POST body.</span></span> |
| <span data-ttu-id="c7c8a-280">client_id</span><span class="sxs-lookup"><span data-stu-id="c7c8a-280">client_id</span></span> |<span data-ttu-id="c7c8a-281">Rekommenderas</span><span class="sxs-lookup"><span data-stu-id="c7c8a-281">Recommended</span></span> |<span data-ttu-id="c7c8a-282">Det program-ID som har tilldelats din app i den [Azure-portalen](https://portal.azure.com).</span><span class="sxs-lookup"><span data-stu-id="c7c8a-282">The application ID assigned to your app in the [Azure portal](https://portal.azure.com).</span></span> |
| <span data-ttu-id="c7c8a-283">grant_type</span><span class="sxs-lookup"><span data-stu-id="c7c8a-283">grant_type</span></span> |<span data-ttu-id="c7c8a-284">Krävs</span><span class="sxs-lookup"><span data-stu-id="c7c8a-284">Required</span></span> |<span data-ttu-id="c7c8a-285">Typ av bevilja.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-285">The type of grant.</span></span> <span data-ttu-id="c7c8a-286">För denna del av auktoriseringskodflödet grant-typen måste vara `refresh_token`.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-286">For this leg of the authorization code flow, the grant type must be `refresh_token`.</span></span> |
| <span data-ttu-id="c7c8a-287">Omfång</span><span class="sxs-lookup"><span data-stu-id="c7c8a-287">scope</span></span> |<span data-ttu-id="c7c8a-288">Rekommenderas</span><span class="sxs-lookup"><span data-stu-id="c7c8a-288">Recommended</span></span> |<span data-ttu-id="c7c8a-289">En blankstegsavgränsad lista över scope.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-289">A space-separated list of scopes.</span></span> <span data-ttu-id="c7c8a-290">Ett enda scope-värde som anger till Azure AD båda de behörigheter som krävs.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-290">A single scope value indicates to Azure AD both of the permissions that are being requested.</span></span> <span data-ttu-id="c7c8a-291">Med klient-ID som omfattningen visar att din app behöver ett åtkomsttoken som kan användas med tjänsten eller webb-API, som representeras av samma klient-ID.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-291">Using the client ID as the scope indicates that your app needs an access token that can be used against your own service or web API, represented by the same client ID.</span></span>  <span data-ttu-id="c7c8a-292">Den `offline_access` omfång anger att din app måste en uppdateringstoken för långlivade åtkomst till resurser.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-292">The `offline_access` scope indicates that your app will need a refresh token for long-lived access to resources.</span></span>  <span data-ttu-id="c7c8a-293">Du kan också använda den `openid` scope för att begära en ID-token från Azure AD B2C.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-293">You also can use the `openid` scope to request an ID token from Azure AD B2C.</span></span> |
| <span data-ttu-id="c7c8a-294">redirect_uri</span><span class="sxs-lookup"><span data-stu-id="c7c8a-294">redirect_uri</span></span> |<span data-ttu-id="c7c8a-295">Valfri</span><span class="sxs-lookup"><span data-stu-id="c7c8a-295">Optional</span></span> |<span data-ttu-id="c7c8a-296">Omdirigerings-URI för det program som du fick Auktoriseringskoden.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-296">The redirect URI of the application where you received the authorization code.</span></span> |
| <span data-ttu-id="c7c8a-297">refresh_token</span><span class="sxs-lookup"><span data-stu-id="c7c8a-297">refresh_token</span></span> |<span data-ttu-id="c7c8a-298">Krävs</span><span class="sxs-lookup"><span data-stu-id="c7c8a-298">Required</span></span> |<span data-ttu-id="c7c8a-299">Den ursprungliga uppdateringstoken som du har införskaffade i andra del av flödet.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-299">The original refresh token that you acquired in the second leg of the flow.</span></span> |

<span data-ttu-id="c7c8a-300">Ett lyckat svar för token som ser ut så här:</span><span class="sxs-lookup"><span data-stu-id="c7c8a-300">A successful token response looks like this:</span></span>

```
{
    "not_before": "1442340812",
    "token_type": "Bearer",
    "access_token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ik5HVEZ2ZEstZnl0aEV1Q...",
    "scope": "90c0fe63-bcf2-44d5-8fb7-b8bbc0b29dc6 offline_access",
    "expires_in": "3600",
    "refresh_token": "AAQfQmvuDy8WtUv-sd0TBwWVQs1rC-Lfxa_NDkLqpg50Cxp5Dxj0VPF1mx2Z...",
}
```
| <span data-ttu-id="c7c8a-301">Parameter</span><span class="sxs-lookup"><span data-stu-id="c7c8a-301">Parameter</span></span> | <span data-ttu-id="c7c8a-302">Beskrivning</span><span class="sxs-lookup"><span data-stu-id="c7c8a-302">Description</span></span> |
| --- | --- |
| <span data-ttu-id="c7c8a-303">not_before</span><span class="sxs-lookup"><span data-stu-id="c7c8a-303">not_before</span></span> |<span data-ttu-id="c7c8a-304">Den tid då token betraktas som giltigt epok tidpunkt.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-304">The time at which the token is considered valid, in epoch time.</span></span> |
| <span data-ttu-id="c7c8a-305">token_type</span><span class="sxs-lookup"><span data-stu-id="c7c8a-305">token_type</span></span> |<span data-ttu-id="c7c8a-306">Tokentypen-värde.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-306">The token type value.</span></span> <span data-ttu-id="c7c8a-307">Den enda typen som har stöd för Azure AD är ägar.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-307">The only type that Azure AD supports is Bearer.</span></span> |
| <span data-ttu-id="c7c8a-308">access_token</span><span class="sxs-lookup"><span data-stu-id="c7c8a-308">access_token</span></span> |<span data-ttu-id="c7c8a-309">Den signerade JWT som du har begärt.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-309">The signed JWT that you requested.</span></span> |
| <span data-ttu-id="c7c8a-310">Omfång</span><span class="sxs-lookup"><span data-stu-id="c7c8a-310">scope</span></span> |<span data-ttu-id="c7c8a-311">Scope som gäller för token.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-311">The scopes that the token is valid for.</span></span> <span data-ttu-id="c7c8a-312">Du kan också använda omfång cache-tokens för senare användning.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-312">You also can use the scopes to cache tokens for later use.</span></span> |
| <span data-ttu-id="c7c8a-313">expires_in</span><span class="sxs-lookup"><span data-stu-id="c7c8a-313">expires_in</span></span> |<span data-ttu-id="c7c8a-314">Hur lång tid som denna token är giltig (i sekunder).</span><span class="sxs-lookup"><span data-stu-id="c7c8a-314">The length of time that the token is valid (in seconds).</span></span> |
| <span data-ttu-id="c7c8a-315">refresh_token</span><span class="sxs-lookup"><span data-stu-id="c7c8a-315">refresh_token</span></span> |<span data-ttu-id="c7c8a-316">En token för uppdatering av OAuth 2.0.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-316">An OAuth 2.0 refresh token.</span></span> <span data-ttu-id="c7c8a-317">Appen kan använda denna token för att hämta ytterligare token när den aktuella token upphör att gälla.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-317">The app can use this token to acquire additional tokens after the current token expires.</span></span> <span data-ttu-id="c7c8a-318">Uppdatera token är långlivade och kan användas för att få åtkomst till resurser för längre tid.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-318">Refresh tokens are long-lived, and can be used to retain access to resources for extended periods of time.</span></span> <span data-ttu-id="c7c8a-319">Mer information finns i [Azure AD B2C tokenreferens](active-directory-b2c-reference-tokens.md).</span><span class="sxs-lookup"><span data-stu-id="c7c8a-319">For more information, see the [Azure AD B2C token reference](active-directory-b2c-reference-tokens.md).</span></span> |

<span data-ttu-id="c7c8a-320">Felsvar se ut så här:</span><span class="sxs-lookup"><span data-stu-id="c7c8a-320">Error responses look like this:</span></span>

```
{
    "error": "access_denied",
    "error_description": "The user revoked access to the app.",
}
```

| <span data-ttu-id="c7c8a-321">Parameter</span><span class="sxs-lookup"><span data-stu-id="c7c8a-321">Parameter</span></span> | <span data-ttu-id="c7c8a-322">Beskrivning</span><span class="sxs-lookup"><span data-stu-id="c7c8a-322">Description</span></span> |
| --- | --- |
| <span data-ttu-id="c7c8a-323">fel</span><span class="sxs-lookup"><span data-stu-id="c7c8a-323">error</span></span> |<span data-ttu-id="c7c8a-324">Ett felkod sträng som du kan använda för att klassificera typer av fel som inträffar.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-324">An error code string that you can use to classify types of errors that occur.</span></span> <span data-ttu-id="c7c8a-325">Du kan också använda strängen att ta hänsyn till fel.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-325">You also can use the string to react to errors.</span></span> |
| <span data-ttu-id="c7c8a-326">error_description</span><span class="sxs-lookup"><span data-stu-id="c7c8a-326">error_description</span></span> |<span data-ttu-id="c7c8a-327">Ett felmeddelande som kan hjälpa dig att identifiera orsaken till ett autentiseringsfel.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-327">A specific error message that can help you identify the root cause of an authentication error.</span></span> |

## <a name="use-your-own-azure-ad-b2c-directory"></a><span data-ttu-id="c7c8a-328">Använda din egen Azure AD B2C-katalog</span><span class="sxs-lookup"><span data-stu-id="c7c8a-328">Use your own Azure AD B2C directory</span></span>
<span data-ttu-id="c7c8a-329">Utför följande steg om du vill testa dessa begäranden själv.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-329">To try these requests yourself, complete the following steps.</span></span> <span data-ttu-id="c7c8a-330">Ersätt exempelvärden som vi använde i den här artikeln med egna värden.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-330">Replace the example values we used in this article with your own values.</span></span>

1. <span data-ttu-id="c7c8a-331">[Skapa en Azure AD B2C-katalog](active-directory-b2c-get-started.md).</span><span class="sxs-lookup"><span data-stu-id="c7c8a-331">[Create an Azure AD B2C directory](active-directory-b2c-get-started.md).</span></span> <span data-ttu-id="c7c8a-332">Använd namnet på din katalog i begäranden.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-332">Use the name of your directory in the requests.</span></span>
2. <span data-ttu-id="c7c8a-333">[Skapa ett program](active-directory-b2c-app-registration.md) att få ett program-ID och omdirigerings-URI.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-333">[Create an application](active-directory-b2c-app-registration.md) to obtain an application ID and a redirect URI.</span></span> <span data-ttu-id="c7c8a-334">Inkludera en intern klient i din app.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-334">Include a native client in your app.</span></span>
3. <span data-ttu-id="c7c8a-335">[Skapa dina principer](active-directory-b2c-reference-policies.md) att hämta principens namn.</span><span class="sxs-lookup"><span data-stu-id="c7c8a-335">[Create your policies](active-directory-b2c-reference-policies.md) to obtain your policy names.</span></span>

