---
title: aaaAzure Traffic Manager - trafikroutningsmetoder | Microsoft Docs
description: "Det här artiklarna hjälper till att du förstår hello olika trafikroutningsmetoder används av Traffic Manager"
services: traffic-manager
documentationcenter: 
author: KumudD
manager: timlt
editor: 
ms.assetid: db1efbf6-6762-4c7a-ac99-675d4eeb54d0
ms.service: traffic-manager
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 07/13/2017
ms.author: kumud
ms.openlocfilehash: b3eeca63ab5f2b9cd4a3a6b6a8fd3e40059e32b5
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 10/06/2017
---
# <a name="traffic-manager-routing-methods"></a><span data-ttu-id="54bb4-103">Traffic Manager-dirigeringsmetoder</span><span class="sxs-lookup"><span data-stu-id="54bb4-103">Traffic Manager routing methods</span></span>

<span data-ttu-id="54bb4-104">Azure Traffic Manager stöder fyra routning av nätverkstrafik metoder toodetermine hur nätverk tooroute trafik toohello olika slutpunkter.</span><span class="sxs-lookup"><span data-stu-id="54bb4-104">Azure Traffic Manager supports four traffic-routing methods toodetermine how tooroute network traffic toohello various service endpoints.</span></span> <span data-ttu-id="54bb4-105">Traffic Manager gäller hello routning av nätverkstrafik metoden tooeach DNS-fråga tas emot.</span><span class="sxs-lookup"><span data-stu-id="54bb4-105">Traffic Manager applies hello traffic-routing method tooeach DNS query it receives.</span></span> <span data-ttu-id="54bb4-106">hello routning av nätverkstrafik metoden anger vilken slutpunkt returneras i hello DNS-svar.</span><span class="sxs-lookup"><span data-stu-id="54bb4-106">hello traffic-routing method determines which endpoint returned in hello DNS response.</span></span>

<span data-ttu-id="54bb4-107">Det finns fyra trafikroutningsmetoder i Traffic Manager:</span><span class="sxs-lookup"><span data-stu-id="54bb4-107">There are four traffic routing methods available in Traffic Manager:</span></span>

* <span data-ttu-id="54bb4-108">**[Prioritet](#priority):** Välj **prioritet** när du vill toouse primära tjänstslutpunkten för all trafik och ange säkerhetskopieringar om hello primära eller hello säkerhetskopiering slutpunkter inte är tillgängliga.</span><span class="sxs-lookup"><span data-stu-id="54bb4-108">**[Priority](#priority):** Select **Priority** when you want toouse a primary service endpoint for all traffic, and provide backups in case hello primary or hello backup endpoints are unavailable.</span></span>
* <span data-ttu-id="54bb4-109">**[Viktat](#weighted):** Välj **viktat** när du vill toodistribute trafik över en uppsättning slutpunkter, antingen jämnt eller bl.a tooweights som du definierar.</span><span class="sxs-lookup"><span data-stu-id="54bb4-109">**[Weighted](#weighted):** Select **Weighted** when you want toodistribute traffic across a set of endpoints, either evenly or according tooweights, which you define.</span></span>
* <span data-ttu-id="54bb4-110">**[Prestanda](#performance):** Välj **prestanda** när du har slutpunkter i olika geografiska platser och du vill att slutanvändarna toouse hello ”närmaste” endpoint vad gäller hello lägsta Nätverksfördröjningen.</span><span class="sxs-lookup"><span data-stu-id="54bb4-110">**[Performance](#performance):** Select **Performance** when you have endpoints in different geographic locations and you want end users toouse hello "closest" endpoint in terms of hello lowest network latency.</span></span>
* <span data-ttu-id="54bb4-111">**[Geografisk](#geographic):** Välj **geografiska** så att användare dirigerad toospecific slutpunkter (Azure, externt eller kapslade) baserat på vilka geografiska plats deras DNS-fråga kommer från.</span><span class="sxs-lookup"><span data-stu-id="54bb4-111">**[Geographic](#geographic):** Select **Geographic** so that users are directed toospecific endpoints (Azure, External, or Nested) based on which geographic location their DNS query originates from.</span></span> <span data-ttu-id="54bb4-112">Detta ger Traffic Manager kunder tooenable scenarier där känna till en användares geografisk region och routning dem baserat på som är viktigt.</span><span class="sxs-lookup"><span data-stu-id="54bb4-112">This empowers Traffic Manager customers tooenable scenarios where knowing a user’s geographic region and routing them based on that is important.</span></span> <span data-ttu-id="54bb4-113">Exempel: uppfyller data suveränitet uppdrag, lokalisering av användaren & innehåll och mäta trafik från olika regioner.</span><span class="sxs-lookup"><span data-stu-id="54bb4-113">Examples include complying with data sovereignty mandates, localization of content & user experience and measuring traffic from different regions.</span></span>

<span data-ttu-id="54bb4-114">Alla Traffic Manager-profiler innehåller övervakning av hälsotillstånd för slutpunkten och automatisk endpoint växling vid fel.</span><span class="sxs-lookup"><span data-stu-id="54bb4-114">All Traffic Manager profiles include monitoring of endpoint health and automatic endpoint failover.</span></span> <span data-ttu-id="54bb4-115">Mer information finns i [Traffic Manager-slutpunkten övervakning](traffic-manager-monitoring.md).</span><span class="sxs-lookup"><span data-stu-id="54bb4-115">For more information, see [Traffic Manager Endpoint Monitoring](traffic-manager-monitoring.md).</span></span> <span data-ttu-id="54bb4-116">En enskild Traffic Manager-profil kan använda en enda trafikroutningsmetod.</span><span class="sxs-lookup"><span data-stu-id="54bb4-116">A single Traffic Manager profile can use only one traffic routing method.</span></span> <span data-ttu-id="54bb4-117">Du kan välja en annan trafikroutningsmetod för din profil när som helst.</span><span class="sxs-lookup"><span data-stu-id="54bb4-117">You can select a different traffic routing method for your profile at any time.</span></span> <span data-ttu-id="54bb4-118">Ändringarna tillämpas inom en minut och utan avbrott uppstår.</span><span class="sxs-lookup"><span data-stu-id="54bb4-118">Changes are applied within one minute, and no downtime is incurred.</span></span> <span data-ttu-id="54bb4-119">Routning av nätverkstrafik metoder kan kombineras med hjälp av kapslade Traffic Manager-profiler.</span><span class="sxs-lookup"><span data-stu-id="54bb4-119">Traffic-routing methods can be combined by using nested Traffic Manager profiles.</span></span> <span data-ttu-id="54bb4-120">Kapsling gör avancerade och flexibel routning av nätverkstrafik konfigurationer som uppfyller behoven för hello av större, komplexa program.</span><span class="sxs-lookup"><span data-stu-id="54bb4-120">Nesting enables sophisticated and flexible traffic-routing configurations that meet hello needs of larger, complex applications.</span></span> <span data-ttu-id="54bb4-121">Mer information finns i [kapslade Traffic Manager-profiler](traffic-manager-nested-profiles.md).</span><span class="sxs-lookup"><span data-stu-id="54bb4-121">For more information, see [nested Traffic Manager profiles](traffic-manager-nested-profiles.md).</span></span>

## <span data-ttu-id="54bb4-122"><a name = "priority"></a>Prioritet routning av nätverkstrafik metod</span><span class="sxs-lookup"><span data-stu-id="54bb4-122"><a name = "priority"></a>Priority traffic-routing method</span></span>

<span data-ttu-id="54bb4-123">Organisationen vill ofta tooprovide tillförlitlighet för dess tjänster genom att distribuera en eller flera säkerhetskopierade tjänster om deras primära tjänsten kraschar.</span><span class="sxs-lookup"><span data-stu-id="54bb4-123">Often an organization wants tooprovide reliability for its services by deploying one or more backup services in case their primary service goes down.</span></span> <span data-ttu-id="54bb4-124">hello 'Priority'-trafikroutning metoden kan Azure kunder tooeasily implementerar det här mönstret för växling vid fel.</span><span class="sxs-lookup"><span data-stu-id="54bb4-124">hello 'Priority' traffic-routing method allows Azure customers tooeasily implement this failover pattern.</span></span>

![Azure Traffic Manager 'Priority' routning av nätverkstrafik, metod][1]

<span data-ttu-id="54bb4-126">Hej trafikhanterarprofil innehåller en prioriterad lista med slutpunkter.</span><span class="sxs-lookup"><span data-stu-id="54bb4-126">hello Traffic Manager profile contains a prioritized list of service endpoints.</span></span> <span data-ttu-id="54bb4-127">Som standard skickar alla trafik toohello primära (högsta prioritet) slutpunkt i Traffic Manager.</span><span class="sxs-lookup"><span data-stu-id="54bb4-127">By default, Traffic Manager sends all traffic toohello primary (highest-priority) endpoint.</span></span> <span data-ttu-id="54bb4-128">Om hello primära slutpunkt inte är tillgänglig, hello Traffic Manager vägar trafik toohello andra slutpunkten.</span><span class="sxs-lookup"><span data-stu-id="54bb4-128">If hello primary endpoint is not available, Traffic Manager routes hello traffic toohello second endpoint.</span></span> <span data-ttu-id="54bb4-129">Om båda hello primära och sekundära slutpunkter inte är tillgängliga går hello trafik toohello tredje, och så vidare.</span><span class="sxs-lookup"><span data-stu-id="54bb4-129">If both hello primary and secondary endpoints are not available, hello traffic goes toohello third, and so on.</span></span> <span data-ttu-id="54bb4-130">Tillgänglighet för hello slutpunkten är baserat på hello konfigurerats status (aktiverade eller inaktiverade) och hello pågående slutpunktsövervakning.</span><span class="sxs-lookup"><span data-stu-id="54bb4-130">Availability of hello endpoint is based on hello configured status (enabled or disabled) and hello ongoing endpoint monitoring.</span></span>

### <a name="configuring-endpoints"></a><span data-ttu-id="54bb4-131">Konfigurera slutpunkter</span><span class="sxs-lookup"><span data-stu-id="54bb4-131">Configuring endpoints</span></span>

<span data-ttu-id="54bb4-132">Med Azure Resource Manager kan du konfigurera hello slutpunktsprioritet uttryckligen med hjälp av hello 'priority'-egenskapen för varje slutpunkt.</span><span class="sxs-lookup"><span data-stu-id="54bb4-132">With Azure Resource Manager, you configure hello endpoint priority explicitly using hello 'priority' property for each endpoint.</span></span> <span data-ttu-id="54bb4-133">Den här egenskapen är ett värde mellan 1 och 1000.</span><span class="sxs-lookup"><span data-stu-id="54bb4-133">This property is a value between 1 and 1000.</span></span> <span data-ttu-id="54bb4-134">Lägre värden motsvarar högre prioritet.</span><span class="sxs-lookup"><span data-stu-id="54bb4-134">Lower values represent a higher priority.</span></span> <span data-ttu-id="54bb4-135">Slutpunkter kan inte dela prioritetsvärdet.</span><span class="sxs-lookup"><span data-stu-id="54bb4-135">Endpoints cannot share priority values.</span></span> <span data-ttu-id="54bb4-136">Hello-egenskapen är valfri.</span><span class="sxs-lookup"><span data-stu-id="54bb4-136">Setting hello property is optional.</span></span> <span data-ttu-id="54bb4-137">När utelämnas används en standardprioritet utifrån hello endpoint ordning.</span><span class="sxs-lookup"><span data-stu-id="54bb4-137">When omitted, a default priority based on hello endpoint order is used.</span></span>

##<span data-ttu-id="54bb4-138"><a name = "weighted"></a>Viktade routning av nätverkstrafik, metod</span><span class="sxs-lookup"><span data-stu-id="54bb4-138"><a name = "weighted"></a>Weighted traffic-routing method</span></span>
<span data-ttu-id="54bb4-139">hello 'Viktat'-trafikroutning metod kan du toodistribute trafiken jämnt eller toouse en fördefinierad vikt.</span><span class="sxs-lookup"><span data-stu-id="54bb4-139">hello 'Weighted' traffic-routing method allows you toodistribute traffic evenly or toouse a pre-defined weighting.</span></span>

![Azure Traffic Manager-viktad' routning av nätverkstrafik metod][2]

<span data-ttu-id="54bb4-141">Hello viktat routning av nätverkstrafik metoden kan du tilldela en vikt tooeach slutpunkt i konfigurationen för hello Traffic Manager-profilen.</span><span class="sxs-lookup"><span data-stu-id="54bb4-141">In hello Weighted traffic-routing method, you assign a weight tooeach endpoint in hello Traffic Manager profile configuration.</span></span> <span data-ttu-id="54bb4-142">hello vikt är ett heltal från 1 too1000.</span><span class="sxs-lookup"><span data-stu-id="54bb4-142">hello weight is an integer from 1 too1000.</span></span> <span data-ttu-id="54bb4-143">Den här parametern är valfri.</span><span class="sxs-lookup"><span data-stu-id="54bb4-143">This parameter is optional.</span></span> <span data-ttu-id="54bb4-144">Om det utelämnas används trafik chefer en standard vikt '1'.</span><span class="sxs-lookup"><span data-stu-id="54bb4-144">If omitted, Traffic Managers uses a default weight of '1'.</span></span>

<span data-ttu-id="54bb4-145">För varje DNS-fråga tas emot, väljer slumpmässigt en tillgänglig slutpunkt i Traffic Manager.</span><span class="sxs-lookup"><span data-stu-id="54bb4-145">For each DNS query received, Traffic Manager randomly chooses an available endpoint.</span></span> <span data-ttu-id="54bb4-146">hello sannolikheten för att välja en slutpunkt som baseras på hello viktningar som tilldelats tooall tillgängliga slutpunkter.</span><span class="sxs-lookup"><span data-stu-id="54bb4-146">hello probability of choosing an endpoint is based on hello weights assigned tooall available endpoints.</span></span> <span data-ttu-id="54bb4-147">Med hjälp av hello vikt samma över alla slutpunkter resultat i en trafiken fördelas jämnt.</span><span class="sxs-lookup"><span data-stu-id="54bb4-147">Using hello same weight across all endpoints results in an even traffic distribution.</span></span> <span data-ttu-id="54bb4-148">Med högre eller lägre vikterna på specifika slutpunkter gör dessa slutpunkter toobe returnerade mer eller mindre ofta i hello DNS-svar.</span><span class="sxs-lookup"><span data-stu-id="54bb4-148">Using higher or lower weights on specific endpoints causes those endpoints toobe returned more or less frequently in hello DNS responses.</span></span>

<span data-ttu-id="54bb4-149">hello viktas möjliggör vissa användbara scenarier:</span><span class="sxs-lookup"><span data-stu-id="54bb4-149">hello weighted method enables some useful scenarios:</span></span>

* <span data-ttu-id="54bb4-150">Stegvis Programuppgradering: tilldela en procentandel av trafiken tooroute tooa ny slutpunkt och gradvis öka hello-trafik över tid too100%.</span><span class="sxs-lookup"><span data-stu-id="54bb4-150">Gradual application upgrade: Allocate a percentage of traffic tooroute tooa new endpoint, and gradually increase hello traffic over time too100%.</span></span>
* <span data-ttu-id="54bb4-151">Programmet migrering tooAzure: skapa en profil med både Azure och externa slutpunkter.</span><span class="sxs-lookup"><span data-stu-id="54bb4-151">Application migration tooAzure: Create a profile with both Azure and external endpoints.</span></span> <span data-ttu-id="54bb4-152">Justera hello vikt hello slutpunkter tooprefer hello nya slutpunkter.</span><span class="sxs-lookup"><span data-stu-id="54bb4-152">Adjust hello weight of hello endpoints tooprefer hello new endpoints.</span></span>
* <span data-ttu-id="54bb4-153">Moln-burst-överföring för ytterligare kapacitet: snabbt expandera en lokal distribution i hello moln genom att lägga till bakom en Traffic Manager-profilen.</span><span class="sxs-lookup"><span data-stu-id="54bb4-153">Cloud-bursting for additional capacity: Quickly expand an on-premises deployment into hello cloud by putting it behind a Traffic Manager profile.</span></span> <span data-ttu-id="54bb4-154">När du behöver extra kapacitet i hello moln du lägga till eller aktivera flera slutpunkter och anger vilken del av trafiken går tooeach slutpunkt.</span><span class="sxs-lookup"><span data-stu-id="54bb4-154">When you need extra capacity in hello cloud, you can add or enable more endpoints and specify what portion of traffic goes tooeach endpoint.</span></span>

<span data-ttu-id="54bb4-155">hello Azure Resource Manager-portalen stöder hello konfiguration av Routning av viktat nätverkstrafik.</span><span class="sxs-lookup"><span data-stu-id="54bb4-155">hello Resource Manager Azure portal supports hello configuration of weighted traffic routing.</span></span>  <span data-ttu-id="54bb4-156">Du kan konfigurera vikterna med hello Resource Manager-versioner av Azure PowerShell, CLI och hello REST API: er.</span><span class="sxs-lookup"><span data-stu-id="54bb4-156">You can configure weights using hello Resource Manager versions of Azure PowerShell, CLI, and hello REST APIs.</span></span>

<span data-ttu-id="54bb4-157">Det är viktigt toounderstand att DNS-svar cachelagras av klienter och av hello rekursiv DNS-servrar som hello klienter använder tooresolve DNS-namn.</span><span class="sxs-lookup"><span data-stu-id="54bb4-157">It is important toounderstand that DNS responses are cached by clients and by hello recursive DNS servers that hello clients use tooresolve DNS names.</span></span> <span data-ttu-id="54bb4-158">Den här cachelagring kan påverka viktat trafik distributioner.</span><span class="sxs-lookup"><span data-stu-id="54bb4-158">This caching can have an impact on weighted traffic distributions.</span></span> <span data-ttu-id="54bb4-159">När hello antalet klienter och rekursiva DNS-servrar är stort, fungerar trafikfördelning som förväntat.</span><span class="sxs-lookup"><span data-stu-id="54bb4-159">When hello number of clients and recursive DNS servers is large, traffic distribution works as expected.</span></span> <span data-ttu-id="54bb4-160">Men när hello antalet klienter eller rekursiv DNS-servrar är litet kan cachelagring avsevärt skeva hello trafikfördelning.</span><span class="sxs-lookup"><span data-stu-id="54bb4-160">However, when hello number of clients or recursive DNS servers is small, caching can significantly skew hello traffic distribution.</span></span>

<span data-ttu-id="54bb4-161">Vanliga användningsområden omfattar:</span><span class="sxs-lookup"><span data-stu-id="54bb4-161">Common use cases include:</span></span>

* <span data-ttu-id="54bb4-162">Utvecklings- och testmiljöer</span><span class="sxs-lookup"><span data-stu-id="54bb4-162">Development and testing environments</span></span>
* <span data-ttu-id="54bb4-163">Program kommunikation</span><span class="sxs-lookup"><span data-stu-id="54bb4-163">Application-to-application communications</span></span>
* <span data-ttu-id="54bb4-164">Program syftar till att en smala-användarbas som delar en gemensam rekursiv DNS-infrastruktur (till exempel anställda på företaget som ansluter via en proxyserver)</span><span class="sxs-lookup"><span data-stu-id="54bb4-164">Applications aimed at a narrow user-base that share a common recursive DNS infrastructure (for example, employees of company connecting through a proxy)</span></span>

<span data-ttu-id="54bb4-165">Dessa DNS-cachelagring effekter är vanliga tooall DNS-baserad trafik system, inte bara Azure Traffic Manager.</span><span class="sxs-lookup"><span data-stu-id="54bb4-165">These DNS caching effects are common tooall DNS-based traffic routing systems, not just Azure Traffic Manager.</span></span> <span data-ttu-id="54bb4-166">I vissa fall kan ger uttryckligen rensar hello DNS-cache en lösning.</span><span class="sxs-lookup"><span data-stu-id="54bb4-166">In some cases, explicitly clearing hello DNS cache may provide a workaround.</span></span> <span data-ttu-id="54bb4-167">I andra fall måste vara en alternativ metod för routning av nätverkstrafik lämpligare.</span><span class="sxs-lookup"><span data-stu-id="54bb4-167">In other cases, an alternative traffic-routing method may be more appropriate.</span></span>

## <span data-ttu-id="54bb4-168"><a name = "performance"></a>Prestanda routning av nätverkstrafik metod</span><span class="sxs-lookup"><span data-stu-id="54bb4-168"><a name = "performance"></a>Performance traffic-routing method</span></span>

<span data-ttu-id="54bb4-169">Distribuera slutpunkter i två eller flera platser över hela världen hello kan förbättra hello svarstider för många program av Routning trafik toohello plats som är 'närmaste' tooyou.</span><span class="sxs-lookup"><span data-stu-id="54bb4-169">Deploying endpoints in two or more locations across hello globe can improve hello responsiveness of many applications by routing traffic toohello location that is 'closest' tooyou.</span></span> <span data-ttu-id="54bb4-170">hello-prestanda' routning av nätverkstrafik metoden ger den här funktionen.</span><span class="sxs-lookup"><span data-stu-id="54bb4-170">hello 'Performance' traffic-routing method provides this capability.</span></span>

![Azure Traffic Manager-prestanda' routning av nätverkstrafik, metod][3]

<span data-ttu-id="54bb4-172">hello 'närmaste' slutpunkt är inte nödvändigtvis närmaste mätt av geografiska avstånd.</span><span class="sxs-lookup"><span data-stu-id="54bb4-172">hello 'closest' endpoint is not necessarily closest as measured by geographic distance.</span></span> <span data-ttu-id="54bb4-173">I stället anger hello 'Prestanda' routning av nätverkstrafik metoden hello närmaste slutpunkten genom att mäta Nätverksfördröjningen.</span><span class="sxs-lookup"><span data-stu-id="54bb4-173">Instead, hello 'Performance' traffic-routing method determines hello closest endpoint by measuring network latency.</span></span> <span data-ttu-id="54bb4-174">Traffic Manager upprätthåller ett Internet latens tabell tootrack hello fram och åter tiden mellan IP-adressintervall och varje Azure-datacenter.</span><span class="sxs-lookup"><span data-stu-id="54bb4-174">Traffic Manager maintains an Internet Latency Table tootrack hello round-trip time between IP address ranges and each Azure datacenter.</span></span>

<span data-ttu-id="54bb4-175">Traffic Manager letar upp hello källans IP-adress för hello inkommande DNS-begäran i hello Internet svarstid för tabellen.</span><span class="sxs-lookup"><span data-stu-id="54bb4-175">Traffic Manager looks up hello source IP address of hello incoming DNS request in hello Internet Latency Table.</span></span> <span data-ttu-id="54bb4-176">Traffic Manager väljer en tillgänglig slutpunkt i hello Azure-datacenter som har hello lägsta fördröjningen för IP-adressintervall, och returnerar sedan denna slutpunkt i hello DNS-svar.</span><span class="sxs-lookup"><span data-stu-id="54bb4-176">Traffic Manager chooses an available endpoint in hello Azure datacenter that has hello lowest latency for that IP address range, then returns that endpoint in hello DNS response.</span></span>

<span data-ttu-id="54bb4-177">Enligt beskrivningen i [så Traffic Manager fungerar](traffic-manager-overview.md#how-traffic-manager-works), Traffic Manager får inte DNS-frågor direkt från klienter.</span><span class="sxs-lookup"><span data-stu-id="54bb4-177">As explained in [How Traffic Manager Works](traffic-manager-overview.md#how-traffic-manager-works), Traffic Manager does not receive DNS queries directly from clients.</span></span> <span data-ttu-id="54bb4-178">DNS-frågor kommer i stället från att hello klienter är konfigurerade toouse hello rekursiv DNS-tjänsten.</span><span class="sxs-lookup"><span data-stu-id="54bb4-178">Rather, DNS queries come from hello recursive DNS service that hello clients are configured toouse.</span></span> <span data-ttu-id="54bb4-179">Därför hello IP-adress som används för toodetermine hello 'närmaste' slutpunkt är inte hello klientens IP-adress, men det är hello IP-adressen för hello rekursiv DNS-tjänsten.</span><span class="sxs-lookup"><span data-stu-id="54bb4-179">Therefore, hello IP address used toodetermine hello 'closest' endpoint is not hello client's IP address, but it is hello IP address of hello recursive DNS service.</span></span> <span data-ttu-id="54bb4-180">I praktiken är IP-adressen en bra proxy för hello-klienten.</span><span class="sxs-lookup"><span data-stu-id="54bb4-180">In practice, this IP address is a good proxy for hello client.</span></span>


<span data-ttu-id="54bb4-181">Traffic Manager regelbundet uppdateringar hello Internet latens tabell tooaccount efter ändringar i hello globala Internet och nya Azure-regioner.</span><span class="sxs-lookup"><span data-stu-id="54bb4-181">Traffic Manager regularly updates hello Internet Latency Table tooaccount for changes in hello global Internet and new Azure regions.</span></span> <span data-ttu-id="54bb4-182">Programprestanda varierar, beroende på realtid variationer i belastningen över hello Internet.</span><span class="sxs-lookup"><span data-stu-id="54bb4-182">However, application performance varies based on real-time variations in load across hello Internet.</span></span> <span data-ttu-id="54bb4-183">Routning av prestanda-trafik övervakar inte belastningen på en viss tjänstslutpunkt.</span><span class="sxs-lookup"><span data-stu-id="54bb4-183">Performance traffic-routing does not monitor load on a given service endpoint.</span></span> <span data-ttu-id="54bb4-184">Men om en slutpunkt blir otillgänglig, ingår Traffic Manager inte i DNS-svar på frågor.</span><span class="sxs-lookup"><span data-stu-id="54bb4-184">However, if an endpoint becomes unavailable, Traffic Manager does not include it in DNS query responses.</span></span>


<span data-ttu-id="54bb4-185">Punkter toonote:</span><span class="sxs-lookup"><span data-stu-id="54bb4-185">Points toonote:</span></span>

* <span data-ttu-id="54bb4-186">Om din profil innehåller flera slutpunkter i hello samma Azure-region, och sedan Traffic Manager fördelar trafiken jämnt över hello tillgängliga slutpunkterna i den regionen.</span><span class="sxs-lookup"><span data-stu-id="54bb4-186">If your profile contains multiple endpoints in hello same Azure region, then Traffic Manager distributes traffic evenly across hello available endpoints in that region.</span></span> <span data-ttu-id="54bb4-187">Om du föredrar en annan trafikfördelning inom en region, kan du använda [kapslade Traffic Manager-profiler](traffic-manager-nested-profiles.md).</span><span class="sxs-lookup"><span data-stu-id="54bb4-187">If you prefer a different traffic distribution within a region, you can use [nested Traffic Manager profiles](traffic-manager-nested-profiles.md).</span></span>
* <span data-ttu-id="54bb4-188">Om alla aktiverade slutpunkter i hello närmaste Azure-regionen är försämrad, Traffic Manager flyttar trafik toohello slutpunkter i hello nästa närmaste Azure-region.</span><span class="sxs-lookup"><span data-stu-id="54bb4-188">If all enabled endpoints in hello closest Azure region are degraded, Traffic Manager moves traffic toohello endpoints in hello next closest Azure region.</span></span> <span data-ttu-id="54bb4-189">Om du vill toodefine en prioriterad failover-sekvens, Använd [kapslade Traffic Manager-profiler](traffic-manager-nested-profiles.md).</span><span class="sxs-lookup"><span data-stu-id="54bb4-189">If you want toodefine a preferred failover sequence, use [nested Traffic Manager profiles](traffic-manager-nested-profiles.md).</span></span>
* <span data-ttu-id="54bb4-190">När du använder hello prestanda trafikroutningsmetod med externa slutpunkter eller kapslade slutpunkter, måste toospecify hello platsen för dessa slutpunkter.</span><span class="sxs-lookup"><span data-stu-id="54bb4-190">When using hello Performance traffic routing method with external endpoints or nested endpoints, you need toospecify hello location of those endpoints.</span></span> <span data-ttu-id="54bb4-191">Välj hello Azure-region närmaste tooyour distribution.</span><span class="sxs-lookup"><span data-stu-id="54bb4-191">Choose hello Azure region closest tooyour deployment.</span></span> <span data-ttu-id="54bb4-192">Dessa platser är hello värden som stöds av hello Internet svarstid för tabellen.</span><span class="sxs-lookup"><span data-stu-id="54bb4-192">Those locations are hello values supported by hello Internet Latency Table.</span></span>
* <span data-ttu-id="54bb4-193">hello-algoritmen som väljer hello slutpunkten är deterministisk.</span><span class="sxs-lookup"><span data-stu-id="54bb4-193">hello algorithm that chooses hello endpoint is deterministic.</span></span> <span data-ttu-id="54bb4-194">Upprepad DNS-frågor från hello samma klient är dirigeras toohello samma slutpunkt.</span><span class="sxs-lookup"><span data-stu-id="54bb4-194">Repeated DNS queries from hello same client are directed toohello same endpoint.</span></span> <span data-ttu-id="54bb4-195">Klienter använder normalt olika rekursiv DNS-servrar när du reser.</span><span class="sxs-lookup"><span data-stu-id="54bb4-195">Typically, clients use different recursive DNS servers when traveling.</span></span> <span data-ttu-id="54bb4-196">hello klienten kanske routade tooa annan endpoint.</span><span class="sxs-lookup"><span data-stu-id="54bb4-196">hello client may be routed tooa different endpoint.</span></span> <span data-ttu-id="54bb4-197">Routning kan också påverkas av uppdateringar toohello Internet svarstid för tabellen.</span><span class="sxs-lookup"><span data-stu-id="54bb4-197">Routing can also be affected by updates toohello Internet Latency Table.</span></span> <span data-ttu-id="54bb4-198">Därför hello prestanda routning av nätverkstrafik metoden inte garanterar att en klient är alltid dirigeras toohello samma slutpunkt.</span><span class="sxs-lookup"><span data-stu-id="54bb4-198">Therefore, hello Performance traffic-routing method does not guarantee that a client is always routed toohello same endpoint.</span></span>
* <span data-ttu-id="54bb4-199">När hello Internet latens tabellen ändras, kan du se att vissa klienter finns dirigerad tooa annan endpoint.</span><span class="sxs-lookup"><span data-stu-id="54bb4-199">When hello Internet Latency Table changes, you may notice that some clients are directed tooa different endpoint.</span></span> <span data-ttu-id="54bb4-200">Ändringen routning är exaktare baserat på aktuella svarstidsdata.</span><span class="sxs-lookup"><span data-stu-id="54bb4-200">This routing change is more accurate based on current latency data.</span></span> <span data-ttu-id="54bb4-201">De här uppdateringarna är nödvändiga toomaintain hello riktighet prestanda-routning av nätverkstrafik som hello Internet ständigt utvecklas.</span><span class="sxs-lookup"><span data-stu-id="54bb4-201">These updates are essential toomaintain hello accuracy of Performance traffic-routing as hello Internet continually evolves.</span></span>

## <span data-ttu-id="54bb4-202"><a name = "geographic"></a>Geografisk routning av nätverkstrafik metod</span><span class="sxs-lookup"><span data-stu-id="54bb4-202"><a name = "geographic"></a>Geographic traffic-routing method</span></span>

<span data-ttu-id="54bb4-203">Traffic Manager-profiler kan vara konfigurerade toouse hello geografiska routning metoden så att användare dirigeras toospecific slutpunkter (Azure, externt eller kapslade) baserat på vilka geografiska plats deras DNS-fråga som kommer från.</span><span class="sxs-lookup"><span data-stu-id="54bb4-203">Traffic Manager profiles can be configured toouse hello Geographic routing method so that users are directed toospecific endpoints (Azure, External or Nested) based on which geographic location their DNS query originates from.</span></span> <span data-ttu-id="54bb4-204">Detta ger Traffic Manager kunder tooenable scenarier där känna till en användares geografisk region och routning dem baserat på som är viktigt.</span><span class="sxs-lookup"><span data-stu-id="54bb4-204">This empowers Traffic Manager customers tooenable scenarios where knowing a user’s geographic region and routing them based on that is important.</span></span> <span data-ttu-id="54bb4-205">Exempel: uppfyller data suveränitet uppdrag, lokalisering av användaren & innehåll och mäta trafik från olika regioner.</span><span class="sxs-lookup"><span data-stu-id="54bb4-205">Examples include complying with data sovereignty mandates, localization of content & user experience and measuring traffic from different regions.</span></span>
<span data-ttu-id="54bb4-206">När en profil har konfigurerats för geografisk routning varje slutpunkt som är kopplade till att profilen måste toohave en uppsättning geografiska områden som tilldelats tooit.</span><span class="sxs-lookup"><span data-stu-id="54bb4-206">When a profile is configured for geographic routing, each endpoint associated with that profile needs toohave a set of geographic regions assigned tooit.</span></span> <span data-ttu-id="54bb4-207">Ett geografiskt område kan vara på följande detaljnivåer</span><span class="sxs-lookup"><span data-stu-id="54bb4-207">A geographic region can be at following levels of granularity</span></span> 
- <span data-ttu-id="54bb4-208">World – en region</span><span class="sxs-lookup"><span data-stu-id="54bb4-208">World– any region</span></span>
- <span data-ttu-id="54bb4-209">Regional gruppering – till exempel Afrika, Mellanöstern, Australien/Pacific osv.</span><span class="sxs-lookup"><span data-stu-id="54bb4-209">Regional Grouping – for example, Africa, Middle East, Australia/Pacific etc.</span></span> 
- <span data-ttu-id="54bb4-210">Land/Region – till exempel Irland Peru, Hongkong SAR osv.</span><span class="sxs-lookup"><span data-stu-id="54bb4-210">Country/Region – for example, Ireland, Peru, Hong Kong SAR etc.</span></span> 
- <span data-ttu-id="54bb4-211">Region – till exempel USA California, Australien-Queensland Kanada Alberta etc. (Obs: den här filnivå stöds bara för tillstånd / regioner i Australien, Kanada, Storbritannien och USA).</span><span class="sxs-lookup"><span data-stu-id="54bb4-211">State/Province – for example, USA-California, Australia-Queensland, Canada-Alberta etc. (note: this granularity level is supported only for states / provinces in Australia, Canada, UK, and USA).</span></span>

<span data-ttu-id="54bb4-212">När en region eller en uppsättning regioner tilldelas tooan slutpunkt, hämtar förfrågningar från dessa regioner routade endast toothat slutpunkt.</span><span class="sxs-lookup"><span data-stu-id="54bb4-212">When a region or a set of regions is assigned tooan endpoint, any requests from those regions gets routed only toothat endpoint.</span></span> <span data-ttu-id="54bb4-213">Traffic Manager använder hello källans IP-adress för hello DNS-fråga toodetermine hello region där en användare efterfrågar från – vanligtvis är hello IP-adressen för hello lokala DNS-matchning gör hello frågan hello användarens räkning.</span><span class="sxs-lookup"><span data-stu-id="54bb4-213">Traffic Manager uses hello source IP address of hello DNS query toodetermine hello region from which a user is querying from – usually this is hello IP address of hello local DNS resolver doing hello query on behalf of hello user.</span></span>  

![Azure Traffic Manager-geografiska' routning av nätverkstrafik metod](./media/traffic-manager-routing-methods/geographic.png)

<span data-ttu-id="54bb4-215">Traffic Manager läser hello källans IP-adress för hello DNS-fråga och bestämmer vilka geografiska region som det härstammar från.</span><span class="sxs-lookup"><span data-stu-id="54bb4-215">Traffic Manager reads hello source IP address of hello DNS query and decides which geographic region it is originating from.</span></span> <span data-ttu-id="54bb4-216">Den söker sedan toosee om det finns en slutpunkt som har den här geografiska region som mappats tooit.</span><span class="sxs-lookup"><span data-stu-id="54bb4-216">It then looks toosee if there is an endpoint that has this geographic region mapped tooit.</span></span> <span data-ttu-id="54bb4-217">Den här sökningen börjar vid hello lägsta filnivå (region där den stöds, annars hello Land/Region nivån) och går alla hello sätt in toohello högsta nivån, som är **World**.</span><span class="sxs-lookup"><span data-stu-id="54bb4-217">This lookup starts at hello lowest granularity level (State/Province where it is supported, else at hello Country/Region level) and goes all hello way up toohello highest level, which is **World**.</span></span> <span data-ttu-id="54bb4-218">hello matchning första med hjälp av den här traversal utses hello endpoint tooreturn i hello frågesvar.</span><span class="sxs-lookup"><span data-stu-id="54bb4-218">hello first match found using this traversal is designated as hello endpoint tooreturn in hello query response.</span></span> <span data-ttu-id="54bb4-219">När matchning med en slutpunkt för kapslad typ, en slutpunkt inom den underordnade profilen returneras, baserat på dess routningsmetoden.</span><span class="sxs-lookup"><span data-stu-id="54bb4-219">When matching with a Nested type endpoint, an endpoint within that child profile is returned, based on its routing method.</span></span> <span data-ttu-id="54bb4-220">följande punkter hello är tillämpliga toothis beteende:</span><span class="sxs-lookup"><span data-stu-id="54bb4-220">hello following points are applicable toothis behavior:</span></span>

- <span data-ttu-id="54bb4-221">Ett geografiskt område kan vara mappade endast tooone slutpunkt i Traffic Manager-profil när hello routning är geografiska routning.</span><span class="sxs-lookup"><span data-stu-id="54bb4-221">A geographic region can be mapped only tooone endpoint in a Traffic Manager profile when hello routing type is Geographic Routing.</span></span> <span data-ttu-id="54bb4-222">Detta säkerställer att routning av användare är deterministisk och kunder kan aktivera scenarier som kräver entydigt geografisk gränser.</span><span class="sxs-lookup"><span data-stu-id="54bb4-222">This ensures that routing of users is deterministic, and customers can enable scenarios that require unambiguous geographic boundaries.</span></span>
- <span data-ttu-id="54bb4-223">Om en användares region kommer under två olika slutpunkter geografiska mappning, väljer hello slutpunkt med hello lägsta granularitet Traffic Manager och tar inte hänsyn routning begäranden från den region toohello andra slutpunkten.</span><span class="sxs-lookup"><span data-stu-id="54bb4-223">If a user’s region comes under two different endpoints’ geographic mapping, Traffic Manager selects hello endpoint with hello lowest granularity and does not consider routing requests from that region toohello other endpoint.</span></span> <span data-ttu-id="54bb4-224">Anta till exempel att en geografisk routning typen profil med två slutpunkter - slutpunkt 1 och Endpoint2.</span><span class="sxs-lookup"><span data-stu-id="54bb4-224">For example, consider a Geographic Routing type profile with two endpoints - Endpoint1 and Endpoint2.</span></span> <span data-ttu-id="54bb4-225">Slutpunkt 1 konfigureras tooreceive trafik från Irland och Endpoint2 konfigureras tooreceive trafik från Europa.</span><span class="sxs-lookup"><span data-stu-id="54bb4-225">Endpoint1 is configured tooreceive traffic from Ireland and Endpoint2 is configured tooreceive traffic from Europe.</span></span> <span data-ttu-id="54bb4-226">Om en begäran kommer från Irland, men det är alltid dirigeras tooEndpoint1.</span><span class="sxs-lookup"><span data-stu-id="54bb4-226">If a request originates from Ireland, it is always routed tooEndpoint1.</span></span>
- <span data-ttu-id="54bb4-227">Eftersom en region kan vara mappade endast tooone slutpunkt, returneras den Traffic Manager oavsett hello slutpunkten är felfri eller inte.</span><span class="sxs-lookup"><span data-stu-id="54bb4-227">Since a region can be mapped only tooone endpoint, Traffic Manager returns it regardless of whether hello endpoint is healthy or not.</span></span>

    >[!IMPORTANT]
    ><span data-ttu-id="54bb4-228">Du rekommenderas att kunder som använder hello geografiska routningsmetoden associeras med hello kapslade typen slutpunkter som har underordnade profiler som innehåller minst två slutpunkter inom varje.</span><span class="sxs-lookup"><span data-stu-id="54bb4-228">It is strongly recommended that customers using hello geographic routing method associate it with hello Nested type endpoints that has child profiles containing at least two endpoints within each.</span></span>
- <span data-ttu-id="54bb4-229">Om en matchning slutpunkt och som slutpunkten har hello **stoppad** tillstånd Traffic Manager returnerar svaret inga data.</span><span class="sxs-lookup"><span data-stu-id="54bb4-229">If an endpoint match is found and that endpoint is in hello **Stopped** state, Traffic Manager returns a NODATA response.</span></span> <span data-ttu-id="54bb4-230">I det här fallet inga ytterligare sökningar görs högre upp i hierarkin för hello geografiska region.</span><span class="sxs-lookup"><span data-stu-id="54bb4-230">In this case, no further lookups is made higher up in hello geographic region hierarchy.</span></span> <span data-ttu-id="54bb4-231">Detta gäller även för kapslade slutpunktstyper när hello underordnade profil i hello **stoppad** eller **inaktiverad** tillstånd.</span><span class="sxs-lookup"><span data-stu-id="54bb4-231">This behavior is also applicable for nested endpoint types when hello child profile is in hello **Stopped** or **Disabled** state.</span></span>
- <span data-ttu-id="54bb4-232">Om en slutpunkt visar en **inaktiverad** status, inte tas med i hello region matchning process.</span><span class="sxs-lookup"><span data-stu-id="54bb4-232">If an endpoint displays a **Disabled** status, it won’t be included in hello region matching process.</span></span> <span data-ttu-id="54bb4-233">Detta gäller även för kapslade slutpunktstyper när hello-slutpunkten har hello **inaktiverad** tillstånd.</span><span class="sxs-lookup"><span data-stu-id="54bb4-233">This behavior is also applicable for nested endpoint types when hello endpoint is in hello **Disabled** state.</span></span>
- <span data-ttu-id="54bb4-234">Om en fråga kommer från en geografisk region som inte har någon mappning i den här profilen, returnerar Traffic Manager svaret inga data.</span><span class="sxs-lookup"><span data-stu-id="54bb4-234">If a query is coming from a geographic region that has no mapping in that profile, Traffic Manager returns a NODATA response.</span></span> <span data-ttu-id="54bb4-235">Därför rekommenderar vi att kunder använder geografiska routning med en slutpunkt som helst av typen kapslade med minst två slutpunkter inom hello underordnade profilen med hello region **World** tilldelade tooit.</span><span class="sxs-lookup"><span data-stu-id="54bb4-235">Therefore, it is strongly recommended that customers use geographic routing with one endpoint, ideally of type Nested with at least two endpoints within hello child profile, with hello region **World** assigned tooit.</span></span> <span data-ttu-id="54bb4-236">Detta säkerställer att alla IP-adresser som inte mappas tooa region hanteras.</span><span class="sxs-lookup"><span data-stu-id="54bb4-236">This also ensures that any IP addresses that do not map tooa region are handled.</span></span>

<span data-ttu-id="54bb4-237">Enligt beskrivningen i [så Traffic Manager fungerar](traffic-manager-how-traffic-manager-works.md), Traffic Manager får inte DNS-frågor direkt från klienter.</span><span class="sxs-lookup"><span data-stu-id="54bb4-237">As explained in [How Traffic Manager Works](traffic-manager-how-traffic-manager-works.md), Traffic Manager does not receive DNS queries directly from clients.</span></span> <span data-ttu-id="54bb4-238">DNS-frågor kommer i stället från att hello klienter är konfigurerade toouse hello rekursiv DNS-tjänsten.</span><span class="sxs-lookup"><span data-stu-id="54bb4-238">Rather, DNS queries come from hello recursive DNS service that hello clients are configured toouse.</span></span> <span data-ttu-id="54bb4-239">Hello IP-adress som används för toodetermine hello regionen är därför inte hello klientens IP-adress, men det är hello IP-adressen för hello rekursiv DNS-tjänsten.</span><span class="sxs-lookup"><span data-stu-id="54bb4-239">Therefore, hello IP address used toodetermine hello region is not hello client's IP address, but it is hello IP address of hello recursive DNS service.</span></span> <span data-ttu-id="54bb4-240">I praktiken är IP-adressen en bra proxy för hello-klienten.</span><span class="sxs-lookup"><span data-stu-id="54bb4-240">In practice, this IP address is a good proxy for hello client.</span></span>


## <a name="next-steps"></a><span data-ttu-id="54bb4-241">Nästa steg</span><span class="sxs-lookup"><span data-stu-id="54bb4-241">Next steps</span></span>

<span data-ttu-id="54bb4-242">Lär dig hur toodevelop program med hög tillgänglighet med hjälp av [slutpunktsövervakning för Traffic Manager](traffic-manager-monitoring.md)</span><span class="sxs-lookup"><span data-stu-id="54bb4-242">Learn how toodevelop high-availability applications using [Traffic Manager endpoint monitoring](traffic-manager-monitoring.md)</span></span>

<span data-ttu-id="54bb4-243">Lär dig hur för[skapa en Traffic Manager-profil](traffic-manager-create-profile.md)</span><span class="sxs-lookup"><span data-stu-id="54bb4-243">Learn how too[create a Traffic Manager profile](traffic-manager-create-profile.md)</span></span>

<!--Image references-->
[1]: ./media/traffic-manager-routing-methods/priority.png
[2]: ./media/traffic-manager-routing-methods/weighted.png
[3]: ./media/traffic-manager-routing-methods/performance.png



