---
title: "aaaHow stöder Hyper-V-replikering tooAzure arbete i Site Recovery? | Microsoft Docs"
description: "I den här artikeln får du en översikt över hur Hyper-V-replikering fungerar i Azure Site Recovery"
services: site-recovery
documentationcenter: 
author: rayne-wiselman
manager: jwhit
editor: 
ms.assetid: c413efcd-d750-4b22-b34b-15bcaa03934a
ms.service: site-recovery
ms.workload: storage-backup-recovery
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: get-started-article
ms.date: 06/14/2017
ms.author: raynew
ROBOTS: NOINDEX, NOFOLLOW
redirect_url: site-recovery-architecture-hyper-v-to-azure
ms.openlocfilehash: e982806b4d6cdec2f71f82d8c73c17cc50ad3c33
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 10/06/2017
---
# <a name="how-does-hyper-v-replication-tooazure-work"></a><span data-ttu-id="1d61d-104">Hur fungerar Hyper-V-replikering tooAzure?</span><span class="sxs-lookup"><span data-stu-id="1d61d-104">How does Hyper-V replication tooAzure work?</span></span>

<span data-ttu-id="1d61d-105">Läs den här artikeln toounderstand hello arkitektur och arbetsflöden för Hyper-V-replikering tooAzure med hello [Azure Site Recovery](site-recovery-overview.md) service.</span><span class="sxs-lookup"><span data-stu-id="1d61d-105">Read this article toounderstand hello architecture and workflows for Hyper-V replication tooAzure using hello [Azure Site Recovery](site-recovery-overview.md) service.</span></span>

<span data-ttu-id="1d61d-106">Bokför eventuella kommentarer längst ned hello av den här artikeln eller i hello [Azure Recovery Services-forumet](https://social.msdn.microsoft.com/forums/azure/home?forum=hypervrecovmgr).</span><span class="sxs-lookup"><span data-stu-id="1d61d-106">Post any comments at hello bottom of this article, or in hello [Azure Recovery Services Forum](https://social.msdn.microsoft.com/forums/azure/home?forum=hypervrecovmgr).</span></span>

<span data-ttu-id="1d61d-107">Du kan replikera hello följande tooAzure:</span><span class="sxs-lookup"><span data-stu-id="1d61d-107">You can replicate hello following tooAzure:</span></span>
- <span data-ttu-id="1d61d-108">**Hyper-V med VMM**: Virtuella datorer som finns på en lokal Hyper-V-värd hanteras i System Center Virtual Machine Manager (VMM)-moln.</span><span class="sxs-lookup"><span data-stu-id="1d61d-108">**Hyper-V with VMM**: VMs located on on-premises Hyper-V hosts managed in  System Center Virtual MAchine Manager (VMM) clouds.</span></span> <span data-ttu-id="1d61d-109">Värdar kan köras på valfritt [operativsystem som stöds](site-recovery-support-matrix-to-azure.md#support-for-datacenter-management-servers).</span><span class="sxs-lookup"><span data-stu-id="1d61d-109">Hosts can be running any [supported operating system](site-recovery-support-matrix-to-azure.md#support-for-datacenter-management-servers).</span></span> <span data-ttu-id="1d61d-110">Du kan replikera virtuella Hyper-V-datorer som körs på ett gästoperativsystem [som stöds av Hyper-V och Azure](https://technet.microsoft.com/en-us/windows-server-docs/compute/hyper-v/supported-windows-guest-operating-systems-for-hyper-v-on-windows).</span><span class="sxs-lookup"><span data-stu-id="1d61d-110">You can replicate Hyper-V VMs running any guest operating system [supported by Hyper-V and Azure](https://technet.microsoft.com/en-us/windows-server-docs/compute/hyper-v/supported-windows-guest-operating-systems-for-hyper-v-on-windows).</span></span>
- <span data-ttu-id="1d61d-111">**Hyper-V utan VMM**: Lokala virtuella datorer som finns på Hyper-V-värdar som inte hanteras i VMM-moln.</span><span class="sxs-lookup"><span data-stu-id="1d61d-111">**Hyper-V without VMM**: On-premises VMs located on Hyper-V hosts that aren't managed in VMM clouds.</span></span> <span data-ttu-id="1d61d-112">Värdar kan köra någon av hello [operativsystem](site-recovery-support-matrix-to-azure.md#support-for-replicated-machine-os-versions).</span><span class="sxs-lookup"><span data-stu-id="1d61d-112">Hosts can run any of hello [supported operating systems](site-recovery-support-matrix-to-azure.md#support-for-replicated-machine-os-versions).</span></span> <span data-ttu-id="1d61d-113">Du kan replikera virtuella Hyper-V-datorer som körs på ett gästoperativsystem [som stöds av Hyper-V och Azure](https://technet.microsoft.com/en-us/windows-server-docs/compute/hyper-v/supported-windows-guest-operating-systems-for-hyper-v-on-windows).</span><span class="sxs-lookup"><span data-stu-id="1d61d-113">You can replicate Hyper-V VMs running any guest operating system [supported by Hyper-V and Azure](https://technet.microsoft.com/en-us/windows-server-docs/compute/hyper-v/supported-windows-guest-operating-systems-for-hyper-v-on-windows).</span></span>


## <a name="architectural-components"></a><span data-ttu-id="1d61d-114">Arkitekturkomponenter</span><span class="sxs-lookup"><span data-stu-id="1d61d-114">Architectural components</span></span>

<span data-ttu-id="1d61d-115">**Område**</span><span class="sxs-lookup"><span data-stu-id="1d61d-115">**Area**</span></span> | <span data-ttu-id="1d61d-116">**Komponent**</span><span class="sxs-lookup"><span data-stu-id="1d61d-116">**Component**</span></span> | <span data-ttu-id="1d61d-117">**Detaljer**</span><span class="sxs-lookup"><span data-stu-id="1d61d-117">**Details**</span></span>
--- | --- | ---
<span data-ttu-id="1d61d-118">**Azure**</span><span class="sxs-lookup"><span data-stu-id="1d61d-118">**Azure**</span></span> | <span data-ttu-id="1d61d-119">I Azure behöver du ett Microsoft Azure-konto, ett Azure-lagringskonto och ett Azure-nätverk.</span><span class="sxs-lookup"><span data-stu-id="1d61d-119">In Azure you need a Microsoft Azure account, an Azure storage account, and a Azure network.</span></span> | <span data-ttu-id="1d61d-120">Lagring och nätverk kan vara Resource Manager-baserade eller klassiska konton.</span><span class="sxs-lookup"><span data-stu-id="1d61d-120">Storage and network can be Resource Manager-based, or classic accounts.</span></span><br/><br/> <span data-ttu-id="1d61d-121">Replikerade data lagras i hello storage-konto och virtuella Azure-datorer skapas med hello replikerade data när det uppstår redundans från din lokala plats.</span><span class="sxs-lookup"><span data-stu-id="1d61d-121">Replicated data is stored in hello storage account, and Azure VMs are created with hello replicated data when failover from your on-premises site occurs.</span></span><br/><br/> <span data-ttu-id="1d61d-122">hello Azure virtuella datorer ansluta toohello virtuella Azure-nätverket när de skapas.</span><span class="sxs-lookup"><span data-stu-id="1d61d-122">hello Azure VMs connect toohello Azure virtual network when they're created.</span></span>
<span data-ttu-id="1d61d-123">**VMM-server**</span><span class="sxs-lookup"><span data-stu-id="1d61d-123">**VMM server**</span></span> | <span data-ttu-id="1d61d-124">Hyper-V-värdar i VMM-moln</span><span class="sxs-lookup"><span data-stu-id="1d61d-124">Hyper-V hosts located in VMM clouds</span></span> | <span data-ttu-id="1d61d-125">Om Hyper-V-värdar hanteras i VMM-moln, registrera hello VMM-servern i hello Recovery Services-valvet.</span><span class="sxs-lookup"><span data-stu-id="1d61d-125">If Hyper-V hosts are managed in VMM clouds, you register hello VMM server in hello Recovery Services vault.</span></span><br/><br/> <span data-ttu-id="1d61d-126">På hello VMM-servern installerar du hello Site Recovery-providern tooorchestrate replikering med Azure.</span><span class="sxs-lookup"><span data-stu-id="1d61d-126">On hello VMM server you install hello Site Recovery Provider tooorchestrate replication with Azure.</span></span><br/><br/> <span data-ttu-id="1d61d-127">Behöver du logiska och Virtuella datornätverk konfigurera tooconfigure nätverksmappning.</span><span class="sxs-lookup"><span data-stu-id="1d61d-127">You need logical and VM networks set up tooconfigure network mapping.</span></span> <span data-ttu-id="1d61d-128">Ett Virtuellt datornätverk ska vara länkade tooa logiskt nätverk som är kopplad till hello molnet.</span><span class="sxs-lookup"><span data-stu-id="1d61d-128">A VM network should be linked tooa logical network that's associated with hello cloud.</span></span>
<span data-ttu-id="1d61d-129">**Hyper-V-värd**</span><span class="sxs-lookup"><span data-stu-id="1d61d-129">**Hyper-V host**</span></span> | <span data-ttu-id="1d61d-130">Hyper-V-servrar kan distribueras med eller utan VMM-servern.</span><span class="sxs-lookup"><span data-stu-id="1d61d-130">Hyper-V servers can be deployed with or without VMM server.</span></span> | <span data-ttu-id="1d61d-131">Om det finns ingen VMM-server, hello hello Site Recovery-providern är installerad på hello värden tooorchestrate replikeringen med Site Recovery via internet.</span><span class="sxs-lookup"><span data-stu-id="1d61d-131">If there's no VMM server, hello Site Recovery Provider is installed on hello host tooorchestrate replication with Site Recovery over hello internet.</span></span> <span data-ttu-id="1d61d-132">Om det finns en VMM-server, har hello providern installerats på den och inte på hello värden.</span><span class="sxs-lookup"><span data-stu-id="1d61d-132">If there's a VMM server, hello Provider is installed on it, and not on hello host.</span></span><br/><br/> <span data-ttu-id="1d61d-133">hello Recovery Services-agenten är installerad på hello värden toohandle replikering.</span><span class="sxs-lookup"><span data-stu-id="1d61d-133">hello Recovery Services agent is installed on hello host toohandle data replication.</span></span><br/><br/> <span data-ttu-id="1d61d-134">Kommunikation från både hello providern och hello-agenten är säker och krypterad.</span><span class="sxs-lookup"><span data-stu-id="1d61d-134">Communications from both hello Provider and hello agent are secure and encrypted.</span></span> <span data-ttu-id="1d61d-135">Replikerade data i Azure-lagring krypteras också.</span><span class="sxs-lookup"><span data-stu-id="1d61d-135">Replicated data in Azure storage is also encrypted.</span></span>
<span data-ttu-id="1d61d-136">**Virtuella Hyper-V-datorer**</span><span class="sxs-lookup"><span data-stu-id="1d61d-136">**Hyper-V VMs**</span></span> | <span data-ttu-id="1d61d-137">Du behöver en eller flera virtuella datorer på hello Hyper-V-värdservern.</span><span class="sxs-lookup"><span data-stu-id="1d61d-137">You need one or more VMs on hello Hyper-V host server.</span></span> | <span data-ttu-id="1d61d-138">Behövs inga tooexplicitly som installerats på virtuella datorer</span><span class="sxs-lookup"><span data-stu-id="1d61d-138">Nothing needs tooexplicitly installed on VMs</span></span>

## <a name="deployment-steps"></a><span data-ttu-id="1d61d-139">Distributionssteg</span><span class="sxs-lookup"><span data-stu-id="1d61d-139">Deployment steps</span></span>

1. <span data-ttu-id="1d61d-140">**Azure**: du ställer in hello Azure komponenter.</span><span class="sxs-lookup"><span data-stu-id="1d61d-140">**Azure**: You set up hello Azure components.</span></span> <span data-ttu-id="1d61d-141">Vi rekommenderar att du ställer in konton för lagring och nätverk innan du påbörjar Site Recovery-distributionen.</span><span class="sxs-lookup"><span data-stu-id="1d61d-141">We recommend you set up storage and network accounts before you begin Site Recovery deployment.</span></span>
2. <span data-ttu-id="1d61d-142">**Valv**: Du skapar ett Recovery Services-valv för Site Recovery och konfigurerar valvinställningarna, däribland inställningar för källa och mål, konfiguration av en replikeringsprincip och aktivering av replikering.</span><span class="sxs-lookup"><span data-stu-id="1d61d-142">**Vault**: You create a Recovery Services vault for Site Recovery, and configure vault settings, including configuring source and target settings, setting up a replication policy, and enabling replication.</span></span>
3. <span data-ttu-id="1d61d-143">**Källa och mål**:</span><span class="sxs-lookup"><span data-stu-id="1d61d-143">**Source and target**:</span></span>
    - <span data-ttu-id="1d61d-144">**Hyper-V-värdar i VMM-moln**: som en del av att ange inställningar för datakälla kan du hämta och installera hello Azure Site Recovery Provider på hello VMM-servern och hello Azure Recovery Services-agenten på varje Hyper-V-värd.</span><span class="sxs-lookup"><span data-stu-id="1d61d-144">**Hyper-V hosts in VMM clouds**: As part of specifying source settings, you download and install hello Azure Site Recovery Provider on hello VMM server, and hello Azure Recovery Services agent on each Hyper-V host.</span></span> <span data-ttu-id="1d61d-145">hello datakälla kommer att hello VMM-servern.</span><span class="sxs-lookup"><span data-stu-id="1d61d-145">hello source will be hello VMM server.</span></span> <span data-ttu-id="1d61d-146">hello målet är Azure.</span><span class="sxs-lookup"><span data-stu-id="1d61d-146">hello target is Azure.</span></span>
    - <span data-ttu-id="1d61d-147">Hyper-V-värdar utan VMM: när du anger inställningar för datakälla kan du hämta och installera hello providern och agenten på varje Hyper-V-värd.</span><span class="sxs-lookup"><span data-stu-id="1d61d-147">Hyper-V hosts without VMM: When you specify source settings, you download and install hello Provider and agent on each Hyper-V host.</span></span> <span data-ttu-id="1d61d-148">Under distributionen samla hello värdar i ett Hyper-V-platsen och ange platsen som hello källa.</span><span class="sxs-lookup"><span data-stu-id="1d61d-148">During deployment you gather hello hosts into a Hyper-V site, and specify this site as hello source.</span></span> <span data-ttu-id="1d61d-149">hello målet är Azure.</span><span class="sxs-lookup"><span data-stu-id="1d61d-149">hello target is Azure.</span></span>

    <span data-ttu-id="1d61d-150">![VMM-Hyper-V-replikering tooAzure](./media/site-recovery-components/arch-onprem-onprem-azure-vmm.png) ![tooAzure för Hyper-V plats-replikering](./media/site-recovery-components/arch-onprem-azure-hypervsite.png)</span><span class="sxs-lookup"><span data-stu-id="1d61d-150">![Hyper-V/VMM replication tooAzure](./media/site-recovery-components/arch-onprem-onprem-azure-vmm.png) ![Hyper-V site replication tooAzure](./media/site-recovery-components/arch-onprem-azure-hypervsite.png)</span></span>


4. <span data-ttu-id="1d61d-151">**Replikeringsprincip**: du kan skapa en replikeringsprincip för hello Hyper-V-plats eller VMM-moln.</span><span class="sxs-lookup"><span data-stu-id="1d61d-151">**Replication policy**: You create a replication policy for hello Hyper-V site or VMM cloud.</span></span> <span data-ttu-id="1d61d-152">hello principen är tillämpade tooall virtuella datorer på värdar i hello plats eller molnet.</span><span class="sxs-lookup"><span data-stu-id="1d61d-152">hello policy is applied tooall VMs located on hosts in hello site or cloud.</span></span>
5. <span data-ttu-id="1d61d-153">**Aktivera replikering**: Du aktiverar replikering för virtuella Hyper-V-datorer.</span><span class="sxs-lookup"><span data-stu-id="1d61d-153">**Enable replication**: You enable replication for Hyper-V VMs.</span></span> <span data-ttu-id="1d61d-154">Den inledande replikeringen sker i enlighet med hello replikeringsprincipens inställningar.</span><span class="sxs-lookup"><span data-stu-id="1d61d-154">Initial replication occurs in accordance with hello replication policy settings.</span></span> <span data-ttu-id="1d61d-155">Dataändringar spåras och replikering av delta ändringar tooAzure börjar när hello replikeringen har slutförts.</span><span class="sxs-lookup"><span data-stu-id="1d61d-155">Data changes are tracked, and replication of delta changes tooAzure begins after hello initial replication finishes.</span></span> <span data-ttu-id="1d61d-156">Spårade ändringar för ett objekt lagras i en .hrl-fil.</span><span class="sxs-lookup"><span data-stu-id="1d61d-156">Tracked changes for an item are held in a .hrl file.</span></span>
6. <span data-ttu-id="1d61d-157">**Testa redundans**: du kör ett test redundans toomake att allt fungerar som förväntat.</span><span class="sxs-lookup"><span data-stu-id="1d61d-157">**Test failover**:  You run a test failover toomake sure everything's working as expected.</span></span>

<span data-ttu-id="1d61d-158">Lär dig mer om distribution:</span><span class="sxs-lookup"><span data-stu-id="1d61d-158">Learn more about deployment:</span></span>
- [<span data-ttu-id="1d61d-159">Komma igång med Hyper-V VM replikering tooAzure - med VMM</span><span class="sxs-lookup"><span data-stu-id="1d61d-159">Get started with Hyper-V VM replication tooAzure - with VMM</span></span>](site-recovery-vmm-to-azure.md)
- [<span data-ttu-id="1d61d-160">Komma igång med Hyper-V VM replikering tooAzure - utan VMM</span><span class="sxs-lookup"><span data-stu-id="1d61d-160">Get started with Hyper-V VM replication tooAzure - without VMM</span></span>](site-recovery-hyper-v-site-to-azure.md)

## <a name="hyper-v-replication-workflow"></a><span data-ttu-id="1d61d-161">Arbetsflöde för Hyper-V-replikering</span><span class="sxs-lookup"><span data-stu-id="1d61d-161">Hyper-V replication workflow</span></span>

### <a name="enable-protection"></a><span data-ttu-id="1d61d-162">Aktivera skydd</span><span class="sxs-lookup"><span data-stu-id="1d61d-162">Enable protection</span></span>

1. <span data-ttu-id="1d61d-163">När du aktiverar skyddet för en Hyper-V virtuell dator i hello Azure-portalen eller lokalt, hello **Aktivera skydd** startar.</span><span class="sxs-lookup"><span data-stu-id="1d61d-163">After you enable protection for a Hyper-V VM, in hello Azure portal or on-premises, hello **Enable protection** starts.</span></span>
2. <span data-ttu-id="1d61d-164">hello jobbet kontrollerar att hello-datorn uppfyller kraven, innan du anropar hello [CreateReplicationRelationship](https://msdn.microsoft.com/library/hh850036.aspx), tooset konfigurerar replikering med hello-inställningar som du har konfigurerat.</span><span class="sxs-lookup"><span data-stu-id="1d61d-164">hello job checks that hello machine complies with prerequisites, before invoking hello [CreateReplicationRelationship](https://msdn.microsoft.com/library/hh850036.aspx), tooset up replication with hello settings you've configured.</span></span>
3. <span data-ttu-id="1d61d-165">hello jobbet startar den inledande replikeringen genom att anropa hello [StartReplication](https://msdn.microsoft.com/library/hh850303.aspx) metod, tooinitialize en fullständig replikering av Virtuella och skicka hello VM virtuella diskar tooAzure.</span><span class="sxs-lookup"><span data-stu-id="1d61d-165">hello job starts initial replication by invoking hello [StartReplication](https://msdn.microsoft.com/library/hh850303.aspx) method, tooinitialize a full VM replication, and send hello VM's virtual disks tooAzure.</span></span>
4. <span data-ttu-id="1d61d-166">Du kan övervaka hello jobb i hello **jobb** fliken.      ![Lista över jobb](media/site-recovery-hyper-v-azure-architecture/image1.png) ![Detaljnivå för Aktivera skydd](media/site-recovery-hyper-v-azure-architecture/image2.png)</span><span class="sxs-lookup"><span data-stu-id="1d61d-166">You can monitor hello job in hello **Jobs** tab.      ![Jobs list](media/site-recovery-hyper-v-azure-architecture/image1.png) ![Enable protection drill down](media/site-recovery-hyper-v-azure-architecture/image2.png)</span></span>

### <a name="initial-replication"></a><span data-ttu-id="1d61d-167">Inledande replikering</span><span class="sxs-lookup"><span data-stu-id="1d61d-167">Initial replication</span></span>

1. <span data-ttu-id="1d61d-168">En [ögonblicksbild av en virtuell Hyper-V-dator](https://technet.microsoft.com/library/dd560637.aspx) tas när den initiala replikeringen utlöses.</span><span class="sxs-lookup"><span data-stu-id="1d61d-168">A [Hyper-V VM snapshot](https://technet.microsoft.com/library/dd560637.aspx) snapshot is taken when initial replication is triggered.</span></span>
2. <span data-ttu-id="1d61d-169">Virtuella hårddiskar är replikeras en i taget tills de är alla kopierade tooAzure.</span><span class="sxs-lookup"><span data-stu-id="1d61d-169">Virtual hard disks are replicated one by one until they're all copied tooAzure.</span></span> <span data-ttu-id="1d61d-170">Det kan ta en stund, beroende på hello VM-storlek och nätverkets bandbredd.</span><span class="sxs-lookup"><span data-stu-id="1d61d-170">It could take a while, depending on hello VM size, and network bandwidth.</span></span> <span data-ttu-id="1d61d-171">toooptimize användningen av nätverket, se [hur toomanage lokalt tooAzure skydd av nätverksbandbredden](https://support.microsoft.com/kb/3056159).</span><span class="sxs-lookup"><span data-stu-id="1d61d-171">toooptimize your network usage, see [How toomanage on-premises tooAzure protection network bandwidth usage](https://support.microsoft.com/kb/3056159).</span></span>
3. <span data-ttu-id="1d61d-172">Om det inträffar under den inledande replikeringen pågår, spårar hello Hyper-V-replikering Diskändringar ändringarna som Hyper-V-Replikeringsloggar (.hrl).</span><span class="sxs-lookup"><span data-stu-id="1d61d-172">If disk changes occur while initial replication is in progress, hello Hyper-V Replica Replication Tracker tracks those changes as Hyper-V Replication Logs (.hrl).</span></span> <span data-ttu-id="1d61d-173">Dessa filer finns i hello samma mapp som hello diskar.</span><span class="sxs-lookup"><span data-stu-id="1d61d-173">These files are located in hello same folder as hello disks.</span></span> <span data-ttu-id="1d61d-174">Varje disk har en associerad hrl-fil som ska skickas toosecondary lagring.</span><span class="sxs-lookup"><span data-stu-id="1d61d-174">Each disk has an associated .hrl file that will be sent toosecondary storage.</span></span>
4. <span data-ttu-id="1d61d-175">hello ögonblicksbilden och loggfilerna använder diskresurser när den inledande replikeringen pågår.</span><span class="sxs-lookup"><span data-stu-id="1d61d-175">hello snapshot and log files consume disk resources while initial replication is in progress.</span></span>
5. <span data-ttu-id="1d61d-176">Hello VM-ögonblicksbild tas bort när hello den inledande replikeringen är klar.</span><span class="sxs-lookup"><span data-stu-id="1d61d-176">When hello initial replication finishes, hello VM snapshot is deleted.</span></span> <span data-ttu-id="1d61d-177">Diskförändringarna i hello loggen är synkroniserade och sammanfogade toohello överordnad disk.</span><span class="sxs-lookup"><span data-stu-id="1d61d-177">Delta disk changes in hello log are synchronized and merged toohello parent disk.</span></span>


### <a name="finalize-protection"></a><span data-ttu-id="1d61d-178">Slutför skyddet</span><span class="sxs-lookup"><span data-stu-id="1d61d-178">Finalize protection</span></span>

1. <span data-ttu-id="1d61d-179">När hello replikeringen har slutförts, hello **Slutför skydd på den virtuella datorn hello** jobbet konfigurerar nätverks- och andra inställningar för efter replikeringen så att hello virtuella datorn är skyddad.</span><span class="sxs-lookup"><span data-stu-id="1d61d-179">After hello initial replication finishes, hello **Finalize protection on hello virtual machine** job configures network and other post-replication settings, so that hello virtual machine is protected.</span></span>
    <span data-ttu-id="1d61d-180">![Slutför skyddet](media/site-recovery-hyper-v-azure-architecture/image3.png)</span><span class="sxs-lookup"><span data-stu-id="1d61d-180">![Finalize protection job](media/site-recovery-hyper-v-azure-architecture/image3.png)</span></span>
2. <span data-ttu-id="1d61d-181">Om du replikerar tooAzure behöva du tootweak hello inställningar för hello virtuella datorn så att den är redo för redundans.</span><span class="sxs-lookup"><span data-stu-id="1d61d-181">If you're replicating tooAzure, you might need tootweak hello settings for hello virtual machine so that it's ready for failover.</span></span> <span data-ttu-id="1d61d-182">Du kan nu köra ett test redundans toocheck allt fungerar som förväntat.</span><span class="sxs-lookup"><span data-stu-id="1d61d-182">At this point you can run a test failover toocheck everything is working as expected.</span></span>

### <a name="delta-replication"></a><span data-ttu-id="1d61d-183">Deltareplikering</span><span class="sxs-lookup"><span data-stu-id="1d61d-183">Delta replication</span></span>

1. <span data-ttu-id="1d61d-184">Efter den första replikeringen för hello startar i enlighet med inställningar för replikering.</span><span class="sxs-lookup"><span data-stu-id="1d61d-184">After hello initial replication, delta synchronization begins, in accordance with replication settings.</span></span>
2. <span data-ttu-id="1d61d-185">hello Hyper-V-replikering Diskändringar spårar hello ändringar tooa virtuell hårddisk som hrl-filerna.</span><span class="sxs-lookup"><span data-stu-id="1d61d-185">hello Hyper-V Replica Replication Tracker tracks hello changes tooa virtual hard disk as .hrl files.</span></span> <span data-ttu-id="1d61d-186">Varje disk som är konfigurerad för replikering har en associerad .hrl-fil.</span><span class="sxs-lookup"><span data-stu-id="1d61d-186">Each disk that's configured for replication has an associated .hrl file.</span></span> <span data-ttu-id="1d61d-187">Den här loggen skickas toohello kundens lagringskonto när den inledande replikeringen är klar.</span><span class="sxs-lookup"><span data-stu-id="1d61d-187">This log is sent toohello customer's storage account after initial replication is complete.</span></span> <span data-ttu-id="1d61d-188">När en logg i överföringen tooAzure spåras hello ändringar i hello primär disk i en loggfil i hello samma katalog.</span><span class="sxs-lookup"><span data-stu-id="1d61d-188">When a log is in transit tooAzure, hello changes in hello primary disk are tracked in another log file, in hello same directory.</span></span>
3. <span data-ttu-id="1d61d-189">Du kan övervaka hello VM i hello VM-vyn under inledande och delta.</span><span class="sxs-lookup"><span data-stu-id="1d61d-189">During initial and delta replication, you can monitor hello VM in hello VM view.</span></span> <span data-ttu-id="1d61d-190">[Läs mer](site-recovery-monitoring-and-troubleshooting.md#monitor-replication-health-for-virtual-machines).</span><span class="sxs-lookup"><span data-stu-id="1d61d-190">[Learn more](site-recovery-monitoring-and-troubleshooting.md#monitor-replication-health-for-virtual-machines).</span></span>  

### <a name="replication-synchronization"></a><span data-ttu-id="1d61d-191">Replikeringssynkronisering</span><span class="sxs-lookup"><span data-stu-id="1d61d-191">Replication synchronization</span></span>

1. <span data-ttu-id="1d61d-192">Om deltareplikeringen misslyckas och om en fullständig replikering skulle bli för tids- och bandbreddskrävande så markeras en virtuell dator för omsynkronisering.</span><span class="sxs-lookup"><span data-stu-id="1d61d-192">If delta replication fails, and a full replication would be costly in terms of bandwidth or time, then a VM is marked for resynchronization.</span></span> <span data-ttu-id="1d61d-193">Till exempel om hello hrl-filerna når 50% av diskstorleken hello, markeras sedan hello VM för omsynkronisering.</span><span class="sxs-lookup"><span data-stu-id="1d61d-193">For example, if hello .hrl files reach 50% of hello disk size, then hello VM will be marked for resynchronization.</span></span>
2.  <span data-ttu-id="1d61d-194">Omsynkroniseringen minimerar hello mängden data som skickas genom att beräkna kontrollsummor för hello käll- och virtuella datorer och skicka endast hello delta-data.</span><span class="sxs-lookup"><span data-stu-id="1d61d-194">Resynchronization minimizes hello amount of data sent by computing checksums of hello source and target virtual machines, and sending only hello delta data.</span></span> <span data-ttu-id="1d61d-195">Omsynkronisering använder en segmenteringsalgoritm med fasta block där käll- och målfiler delas in i fasta segment.</span><span class="sxs-lookup"><span data-stu-id="1d61d-195">Resynchronization uses a fixed-block chunking algorithm where source and target files are divided into fixed chunks.</span></span> <span data-ttu-id="1d61d-196">Kontrollsummor för varje segment genereras och sedan jämförs toodetermine som blockerar från hello källa måste toobe tillämpade toohello målet.</span><span class="sxs-lookup"><span data-stu-id="1d61d-196">Checksums for each chunk are generated and then compared toodetermine which blocks from hello source need toobe applied toohello target.</span></span>
3. <span data-ttu-id="1d61d-197">När omsynkroniseringen är klar ska den normala deltareplikeringen återupptas.</span><span class="sxs-lookup"><span data-stu-id="1d61d-197">After resynchronization finishes, normal delta replication should resume.</span></span> <span data-ttu-id="1d61d-198">Omsynkroniseringen är som standard schemalagda toorun automatiskt utanför kontorstid, men du kan synkronisera om en virtuell dator manuellt.</span><span class="sxs-lookup"><span data-stu-id="1d61d-198">By default resynchronization is scheduled toorun automatically outside office hours, but you can resynchronize a virtual machine manually.</span></span> <span data-ttu-id="1d61d-199">Du kan till exempel återuppta omsynkroniseringen om ett nätverksavbrott eller något annat avbrott inträffar.</span><span class="sxs-lookup"><span data-stu-id="1d61d-199">For example, you can resume resynchronization if a network outage or another outage occurs.</span></span> <span data-ttu-id="1d61d-200">toodo detta, Välj hello VM i hello portal > **synkronisera om**.</span><span class="sxs-lookup"><span data-stu-id="1d61d-200">toodo this, select hello VM in hello portal > **Resynchronize**.</span></span>

    ![Manuell omsynkronisering](media/site-recovery-hyper-v-azure-architecture/image4.png)


### <a name="retries"></a><span data-ttu-id="1d61d-202">Antal försök</span><span class="sxs-lookup"><span data-stu-id="1d61d-202">Retries</span></span>

<span data-ttu-id="1d61d-203">Om det uppstår ett replikeringsfel finns det en inbyggd funktion som gör ett nytt försök.</span><span class="sxs-lookup"><span data-stu-id="1d61d-203">If a replication error occurs, there's a built-in retry.</span></span> <span data-ttu-id="1d61d-204">Den här logiken kan delas in i två kategorier:</span><span class="sxs-lookup"><span data-stu-id="1d61d-204">This logic can be classified into two categories:</span></span>

<span data-ttu-id="1d61d-205">**Kategori**</span><span class="sxs-lookup"><span data-stu-id="1d61d-205">**Category**</span></span> | <span data-ttu-id="1d61d-206">**Detaljer**</span><span class="sxs-lookup"><span data-stu-id="1d61d-206">**Details**</span></span>
--- | ---
<span data-ttu-id="1d61d-207">**Oåterkalleliga fel**</span><span class="sxs-lookup"><span data-stu-id="1d61d-207">**Non-recoverable errors**</span></span> | <span data-ttu-id="1d61d-208">Inga nya försök görs.</span><span class="sxs-lookup"><span data-stu-id="1d61d-208">No retry is attempted.</span></span> <span data-ttu-id="1d61d-209">Status för den virtuella datorn är **kritisk**, och administratören måste ingripa.</span><span class="sxs-lookup"><span data-stu-id="1d61d-209">VM status will be **Critical**, and administrator intervention is required.</span></span> <span data-ttu-id="1d61d-210">Exempel på dessa fel är: skadad VHD-enhet. Ogiltigt tillstånd för hello replikerade virtuella datorn; Nätverk autentiseringsfel: auktorisering fel. VM hittades inte-fel (för fristående Hyper-V-servrar)</span><span class="sxs-lookup"><span data-stu-id="1d61d-210">Examples of these errors include: broken VHD chain; Invalid state for hello replica VM; Network authentication errors: authorization errors; VM not found errors (for standalone Hyper-V servers)</span></span>
<span data-ttu-id="1d61d-211">**Återkalleliga fel**</span><span class="sxs-lookup"><span data-stu-id="1d61d-211">**Recoverable errors**</span></span> | <span data-ttu-id="1d61d-212">Försök inträffa varje intervall för replikering med hjälp av en exponentiell inte som ökar hello återförsöksintervall från hello start av hello första försöket genom 1, 2, 4, 8 och 10 minuter.</span><span class="sxs-lookup"><span data-stu-id="1d61d-212">Retries occur every replication interval, using an exponential back-off that increases hello retry interval from hello start of hello first attempt by 1, 2, 4, 8, and 10 minutes.</span></span> <span data-ttu-id="1d61d-213">Om felet kvarstår försöker du var 30: e minut.</span><span class="sxs-lookup"><span data-stu-id="1d61d-213">If an error persists, retry every 30 minutes.</span></span> <span data-ttu-id="1d61d-214">Exempel: nätverksfel, för lite diskutrymme, för lite minne</span><span class="sxs-lookup"><span data-stu-id="1d61d-214">Examples include: network errors; low disk  errors; low memory conditions</span></span> |

## <a name="protection-and-recovery-lifecycle"></a><span data-ttu-id="1d61d-215">Livscykel för skydd och återställning</span><span class="sxs-lookup"><span data-stu-id="1d61d-215">Protection and recovery lifecycle</span></span>

![arbetsflöde](./media/site-recovery-components/arch-hyperv-azure-workflow.png)

## <a name="next-steps"></a><span data-ttu-id="1d61d-217">Nästa steg</span><span class="sxs-lookup"><span data-stu-id="1d61d-217">Next steps</span></span>

- [<span data-ttu-id="1d61d-218">Kontrollera förhandskrav för distribution</span><span class="sxs-lookup"><span data-stu-id="1d61d-218">Check deployment prerequisites</span></span>](site-recovery-prereq.md)
- <span data-ttu-id="1d61d-219">Felsök med:</span><span class="sxs-lookup"><span data-stu-id="1d61d-219">Troubleshoot with:</span></span>
    - [<span data-ttu-id="1d61d-220">Övervaka och felsöka skydd</span><span class="sxs-lookup"><span data-stu-id="1d61d-220">Monitor and troubleshoot protection</span></span>](site-recovery-monitoring-and-troubleshooting.md)
    - [<span data-ttu-id="1d61d-221">Hjälp från Microsoft Support</span><span class="sxs-lookup"><span data-stu-id="1d61d-221">Help from Microsoft support</span></span>](site-recovery-monitoring-and-troubleshooting.md#reach-out-for-microsoft-support)
    - [<span data-ttu-id="1d61d-222">Vanliga fel och lösningar</span><span class="sxs-lookup"><span data-stu-id="1d61d-222">Common errors and resolutions</span></span>](site-recovery-monitoring-and-troubleshooting.md#common-azure-site-recovery-errors-and-their-resolutions)
