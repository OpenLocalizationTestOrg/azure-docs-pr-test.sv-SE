---
title: "aaaReplicate en SharePoint-flernivåapp med hjälp av Azure Site Recovery | Microsoft Docs"
description: "Den här artikeln beskriver hur tooreplicate en SharePoint-flernivåapp med hjälp av Azure Site Recovery-funktioner."
services: site-recovery
documentationcenter: 
author: sujayt
manager: rochakm
editor: 
ms.assetid: 
ms.service: site-recovery
ms.workload: storage-backup-recovery
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 05/10/2017
ms.author: sutalasi
ms.openlocfilehash: d856034ac2a3c95b0c1f0cf85e62c4e7a5a3210f
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 10/06/2017
---
# <a name="replicate-a-multi-tier-sharepoint-application-for-disaster-recovery-using-azure-site-recovery"></a><span data-ttu-id="a1cb4-103">Replikera en SharePoint-flernivåapp för haveriberedskap med hjälp av Azure Site Recovery</span><span class="sxs-lookup"><span data-stu-id="a1cb4-103">Replicate a multi-tier SharePoint application for disaster recovery using Azure Site Recovery</span></span>

<span data-ttu-id="a1cb4-104">Den här artikeln beskrivs i detalj hur en SharePoint-program med tooprotect [Azure Site Recovery](site-recovery-overview.md).</span><span class="sxs-lookup"><span data-stu-id="a1cb4-104">This article describes in detail how tooprotect a SharePoint application using  [Azure Site Recovery](site-recovery-overview.md).</span></span>


## <a name="overview"></a><span data-ttu-id="a1cb4-105">Översikt</span><span class="sxs-lookup"><span data-stu-id="a1cb4-105">Overview</span></span>

<span data-ttu-id="a1cb4-106">Microsoft SharePoint är ett kraftfullt program som kan hjälpa en grupp eller avdelning ordna samarbeta och dela information.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-106">Microsoft SharePoint is a powerful application that can help a group or department organize, collaborate, and share information.</span></span> <span data-ttu-id="a1cb4-107">SharePoint kan ge intranät portaler, dokument och filhantering, samarbete, sociala nätverk, extranät, webbplatser, enterprise-sökningen och business intelligence.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-107">SharePoint can provide intranet portals, document and file management, collaboration, social networks, extranets, websites, enterprise search, and business intelligence.</span></span> <span data-ttu-id="a1cb4-108">Det har också integrering, integrering och funktioner för automatisering av arbetsflödet.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-108">It also has system integration, process integration, and workflow automation capabilities.</span></span> <span data-ttu-id="a1cb4-109">Normalt organisationer tycker att det som en nivå 1 programmet känsliga toodowntime och förlust av data.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-109">Typically, organizations consider it as a Tier-1 application sensitive toodowntime and data loss.</span></span>

<span data-ttu-id="a1cb4-110">Idag, tillhandahåller Microsoft SharePoint inte några funktioner för out box katastrofåterställning.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-110">Today, Microsoft SharePoint  does not provide any out-of-the-box disaster recovery capabilities.</span></span> <span data-ttu-id="a1cb4-111">Återställning innebär hello användning av ett vänteläge datacenter som du kan återställa hello grupp till oavsett hello-typen och skalan för en katastrofåterställning.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-111">Regardless of hello type and scale of a disaster, recovery involves hello use of a standby data center that you can recover hello farm to.</span></span> <span data-ttu-id="a1cb4-112">Vänteläge Datacenter krävs för scenarier där lokala redundanta system och säkerhetskopieringar inte kan återställa från hello avbrott på hello primära datacenter.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-112">Standby data centers are required for scenarios where local redundant systems and backups cannot recover from hello outage at hello primary data center.</span></span>

<span data-ttu-id="a1cb4-113">En bra lösning för haveriberedskap ska tillåta modellering av återställningsplaner runt hello komplexa programarkitekturer, till exempel SharePoint.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-113">A good disaster recovery solution should allow modeling of recovery plans around hello  complex application architectures such as SharePoint.</span></span> <span data-ttu-id="a1cb4-114">Det bör också ha hello möjlighet tooadd anpassade steg toohandle mappning mellan olika nivåer och därför att tillhandahålla ett enda musklick redundanskluster med en lägre RTO i hello-händelsen för en katastrofåterställning.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-114">It should also have hello ability tooadd customized steps toohandle application mappings between various tiers and hence providing a single-click failover with a lower RTO in hello event of a disaster.</span></span>

<span data-ttu-id="a1cb4-115">Den här artikeln beskrivs i detalj hur en SharePoint-program med tooprotect [Azure Site Recovery](site-recovery-overview.md).</span><span class="sxs-lookup"><span data-stu-id="a1cb4-115">This article describes in detail how tooprotect a SharePoint application using [Azure Site Recovery](site-recovery-overview.md).</span></span> <span data-ttu-id="a1cb4-116">Den här artikeln beskriver bästa praxis för att replikera en tre nivåer SharePoint programmet tooAzure, gör du en katastrof återställningsgranskning och hur du kan redundans hello programmet tooAzure.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-116">This article will cover best practices for replicating a three tier SharePoint application tooAzure, how you can do a disaster recovery drill, and how you can failover hello application tooAzure.</span></span>

<span data-ttu-id="a1cb4-117">Du kan titta på hello nedan video om hur du återställer en flera nivåer program tooAzure.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-117">You can watch hello below video about recovering a multi tier application tooAzure.</span></span>

> [!VIDEO https://channel9.msdn.com/Series/Azure-Site-Recovery/Disaster-Recovery-of-load-balanced-multi-tier-applications-using-Azure-Site-Recovery/player]


## <a name="prerequisites"></a><span data-ttu-id="a1cb4-118">Krav</span><span class="sxs-lookup"><span data-stu-id="a1cb4-118">Prerequisites</span></span>

<span data-ttu-id="a1cb4-119">Innan du börjar, kontrollera att du förstår hello följande:</span><span class="sxs-lookup"><span data-stu-id="a1cb4-119">Before you start, make sure you understand hello following:</span></span>

1. [<span data-ttu-id="a1cb4-120">Replikera en virtuell dator tooAzure</span><span class="sxs-lookup"><span data-stu-id="a1cb4-120">Replicating a virtual machine tooAzure</span></span>](site-recovery-vmware-to-azure.md)
2. <span data-ttu-id="a1cb4-121">Hur för[utforma ett nätverk för återställning](site-recovery-network-design.md)</span><span class="sxs-lookup"><span data-stu-id="a1cb4-121">How too[design a recovery network](site-recovery-network-design.md)</span></span>
3. [<span data-ttu-id="a1cb4-122">Gör en testa redundans tooAzure</span><span class="sxs-lookup"><span data-stu-id="a1cb4-122">Doing a test failover tooAzure</span></span>](site-recovery-test-failover-to-azure.md)
4. [<span data-ttu-id="a1cb4-123">Gör en tooAzure för växling vid fel</span><span class="sxs-lookup"><span data-stu-id="a1cb4-123">Doing a failover tooAzure</span></span>](site-recovery-failover.md)
5. <span data-ttu-id="a1cb4-124">Hur för[replikera en domänkontrollant](site-recovery-active-directory.md)</span><span class="sxs-lookup"><span data-stu-id="a1cb4-124">How too[replicate a domain controller](site-recovery-active-directory.md)</span></span>
6. <span data-ttu-id="a1cb4-125">Hur för[replikera SQL Server](site-recovery-sql.md)</span><span class="sxs-lookup"><span data-stu-id="a1cb4-125">How too[replicate SQL Server](site-recovery-sql.md)</span></span>

## <a name="sharepoint-architecture"></a><span data-ttu-id="a1cb4-126">SharePoint-arkitektur</span><span class="sxs-lookup"><span data-stu-id="a1cb4-126">SharePoint architecture</span></span>

<span data-ttu-id="a1cb4-127">SharePoint kan distribueras på en eller flera servrar med hjälp av nivåindelade topologier och server roller tooimplement en servergrupp design som uppfyller specifika mål och -mål.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-127">SharePoint can be deployed on one or more servers using tiered topologies and server roles tooimplement a farm design that meets specific goals and objectives.</span></span> <span data-ttu-id="a1cb4-128">En typisk stora, hög SharePoint-servergrupp som stöder ett stort antal samtidiga användare och ett stort antal innehållsobjekt använda tjänsten gruppering som en del av deras skalbarhet-strategi.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-128">A typical large, high-demand SharePoint server farm that supports a high number of concurrent users and a large number of content items use service grouping as part of their scalability strategy.</span></span> <span data-ttu-id="a1cb4-129">Den här metoden innebär att du kör tjänster på dedicerade servrar, gruppera dessa tjänster och sedan skala ut hello servrar som en grupp.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-129">This approach involves running services on dedicated servers, grouping these services together, and then scaling out hello servers as a group.</span></span> <span data-ttu-id="a1cb4-130">hello illustrerar följande topologi hello-tjänsten och server gruppering för ett tre skikt SharePoint-servergrupp.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-130">hello following topology illustrates hello service and server grouping for a three tier SharePoint server farm.</span></span> <span data-ttu-id="a1cb4-131">Se tooSharePoint dokumentation och produkten rad arkitekturer för detaljerad information om olika SharePoint-topologier.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-131">Please refer tooSharePoint documentation and product line architectures for detailed guidance on different SharePoint topologies.</span></span> <span data-ttu-id="a1cb4-132">Du hittar mer information om distribution av SharePoint 2013 i [dokumentet](https://technet.microsoft.com/en-us/library/cc303422.aspx).</span><span class="sxs-lookup"><span data-stu-id="a1cb4-132">You can find more details about SharePoint 2013 deployment in [this document](https://technet.microsoft.com/en-us/library/cc303422.aspx).</span></span>



![Distribution av mönstret 1](./media/site-recovery-sharepoint/sharepointarch.png)


## <a name="site-recovery-support"></a><span data-ttu-id="a1cb4-134">Site Recovery-stöd</span><span class="sxs-lookup"><span data-stu-id="a1cb4-134">Site Recovery support</span></span>

<span data-ttu-id="a1cb4-135">VMware-datorer med Windows Server 2012 R2 Enterprise användes för att skapa den här artikeln.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-135">For creating this article, VMware virtual machines with Windows Server 2012 R2 Enterprise were used.</span></span> <span data-ttu-id="a1cb4-136">SharePoint 2013 Enterprise edition och SQL server 2014 Enterprise edition användes.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-136">SharePoint 2013 Enterprise edition and SQL server 2014 Enterprise edition were used.</span></span> <span data-ttu-id="a1cb4-137">Eftersom Site Recovery replikering oberoende av programmet hello rekommendationer som anges här förväntade toohold på samt följande scenarier.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-137">As Site Recovery replication is application agnostic, hello recommendations provided here are expected toohold on for following scenarios as well.</span></span>

### <a name="source-and-target"></a><span data-ttu-id="a1cb4-138">Källa och mål</span><span class="sxs-lookup"><span data-stu-id="a1cb4-138">Source and target</span></span>

<span data-ttu-id="a1cb4-139">**Scenario**</span><span class="sxs-lookup"><span data-stu-id="a1cb4-139">**Scenario**</span></span> | <span data-ttu-id="a1cb4-140">**tooa sekundär plats**</span><span class="sxs-lookup"><span data-stu-id="a1cb4-140">**tooa secondary site**</span></span> | <span data-ttu-id="a1cb4-141">**tooAzure**</span><span class="sxs-lookup"><span data-stu-id="a1cb4-141">**tooAzure**</span></span>
--- | --- | ---
<span data-ttu-id="a1cb4-142">**Hyper-V**</span><span class="sxs-lookup"><span data-stu-id="a1cb4-142">**Hyper-V**</span></span> | <span data-ttu-id="a1cb4-143">Ja</span><span class="sxs-lookup"><span data-stu-id="a1cb4-143">Yes</span></span> | <span data-ttu-id="a1cb4-144">Ja</span><span class="sxs-lookup"><span data-stu-id="a1cb4-144">Yes</span></span>
<span data-ttu-id="a1cb4-145">**VMware**</span><span class="sxs-lookup"><span data-stu-id="a1cb4-145">**VMware**</span></span> | <span data-ttu-id="a1cb4-146">Ja</span><span class="sxs-lookup"><span data-stu-id="a1cb4-146">Yes</span></span> | <span data-ttu-id="a1cb4-147">Ja</span><span class="sxs-lookup"><span data-stu-id="a1cb4-147">Yes</span></span>
<span data-ttu-id="a1cb4-148">**Fysisk server**</span><span class="sxs-lookup"><span data-stu-id="a1cb4-148">**Physical server**</span></span> | <span data-ttu-id="a1cb4-149">Ja</span><span class="sxs-lookup"><span data-stu-id="a1cb4-149">Yes</span></span> | <span data-ttu-id="a1cb4-150">Ja</span><span class="sxs-lookup"><span data-stu-id="a1cb4-150">Yes</span></span>

### <a name="sharepoint-versions"></a><span data-ttu-id="a1cb4-151">SharePoint-versioner</span><span class="sxs-lookup"><span data-stu-id="a1cb4-151">SharePoint Versions</span></span>
<span data-ttu-id="a1cb4-152">hello följande SharePoint server-versioner stöds.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-152">hello following SharePoint server versions are supported.</span></span>

* <span data-ttu-id="a1cb4-153">SharePoint server 2013 Standard</span><span class="sxs-lookup"><span data-stu-id="a1cb4-153">SharePoint server 2013 Standard</span></span>
* <span data-ttu-id="a1cb4-154">SharePoint server 2013 Enterprise</span><span class="sxs-lookup"><span data-stu-id="a1cb4-154">SharePoint server 2013 Enterprise</span></span>
* <span data-ttu-id="a1cb4-155">SharePoint server 2016 Standard</span><span class="sxs-lookup"><span data-stu-id="a1cb4-155">SharePoint server 2016 Standard</span></span>
* <span data-ttu-id="a1cb4-156">SharePoint server 2016 Enterprise</span><span class="sxs-lookup"><span data-stu-id="a1cb4-156">SharePoint server 2016 Enterprise</span></span>

### <a name="things-tookeep-in-mind"></a><span data-ttu-id="a1cb4-157">Saker tookeep i åtanke</span><span class="sxs-lookup"><span data-stu-id="a1cb4-157">Things tookeep in mind</span></span>

<span data-ttu-id="a1cb4-158">Om du använder en delad disk-kluster som en nivå i ditt program så att du kommer inte att kunna toouse Site Recovery replikering tooreplicate de virtuella datorerna.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-158">If you are using a shared disk-based cluster as any tier in your application then you will not be able toouse Site Recovery replication tooreplicate those virtual machines.</span></span> <span data-ttu-id="a1cb4-159">Du kan använda inbyggda replikering som tillhandahålls av programmet hello och sedan använda en [återställningsplanen](site-recovery-create-recovery-plans.md) toofailover alla nivåer.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-159">You can use native replication provided by hello application and then use a [recovery plan](site-recovery-create-recovery-plans.md) toofailover all tiers.</span></span>

## <a name="replicating-virtual-machines"></a><span data-ttu-id="a1cb4-160">Replikering av virtuella datorer</span><span class="sxs-lookup"><span data-stu-id="a1cb4-160">Replicating virtual machines</span></span>

<span data-ttu-id="a1cb4-161">Följ [vägledningen](site-recovery-vmware-to-azure.md) toostart replikerar hello virtuella tooAzure.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-161">Follow [this guidance](site-recovery-vmware-to-azure.md) toostart replicating hello virtual machine tooAzure.</span></span>

* <span data-ttu-id="a1cb4-162">När hello replikeringen är klar, måste du gå tooeach virtuell dator för varje nivå och välj samma tillgänglighetsuppsättning i ' replikerade objekt > Inställningar > Egenskaper > beräkning och nätverk ”.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-162">Once hello replication is complete, make sure you go tooeach virtual machine of each tier and select same availability set in 'Replicated item > Settings > Properties > Compute and Network'.</span></span> <span data-ttu-id="a1cb4-163">Till exempel om din webbnivå har 3 virtuella datorer, se till att alla hello 3 virtuella datorer är konfigurerade toobe tillhör samma tillgänglighetsuppsättning i Azure.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-163">For example, if your web tier has 3 VMs, ensure all hello 3 VMs are configured toobe part of same availability set in Azure.</span></span>

    ![Ange Tillgänglighetsuppsättning](./media/site-recovery-sharepoint/select-av-set.png)

* <span data-ttu-id="a1cb4-165">För anvisningar om hur du skyddar Active Directory och DNS, se för[skydda Active Directory och DNS](site-recovery-active-directory.md) dokumentet.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-165">For guidance on protecting Active Directory and DNS, refer too[Protect Active Directory and DNS](site-recovery-active-directory.md) document.</span></span>

* <span data-ttu-id="a1cb4-166">För anvisningar om hur du skyddar databasnivå som körs på SQLServer, se för[skydda SQL Server](site-recovery-active-directory.md) dokumentet.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-166">For guidance on protecting database tier running on SQL server, refer too[Protect SQL Server](site-recovery-active-directory.md) document.</span></span>

## <a name="networking-configuration"></a><span data-ttu-id="a1cb4-167">Nätverkskonfiguration</span><span class="sxs-lookup"><span data-stu-id="a1cb4-167">Networking configuration</span></span>

### <a name="network-properties"></a><span data-ttu-id="a1cb4-168">Egenskaper för nätverk</span><span class="sxs-lookup"><span data-stu-id="a1cb4-168">Network properties</span></span>

* <span data-ttu-id="a1cb4-169">Konfigurera nätverksinställningar i Azure-portalen för hello App och webbnivå virtuella datorer, så att hello VMs hämta bifogade toohello rätt DR-nätverket efter redundans.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-169">For hello App and Web tier VMs, configure network settings in Azure portal so that hello VMs get attached toohello right DR network after failover.</span></span>

    ![Välj nätverk](./media/site-recovery-sharepoint/select-network.png)


* <span data-ttu-id="a1cb4-171">Om du använder en statisk IP-adress och ange sedan hello IP-adress som du vill hello virtuella tootake i hello **mål-IP** fält</span><span class="sxs-lookup"><span data-stu-id="a1cb4-171">If you are using a static IP, then specify hello IP that you want hello virtual machine tootake in hello **Target IP** field</span></span>

    ![Ange statisk IP-adress](./media/site-recovery-sharepoint/set-static-ip.png)

### <a name="dns-and-traffic-routing"></a><span data-ttu-id="a1cb4-173">DNS- och routning av nätverkstrafik</span><span class="sxs-lookup"><span data-stu-id="a1cb4-173">DNS and Traffic Routing</span></span>

<span data-ttu-id="a1cb4-174">För platser, mot internet [skapa en trafikhanterarprofil av typen 'Priority'](../traffic-manager/traffic-manager-create-profile.md) i hello Azure-prenumeration.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-174">For internet facing sites, [create a Traffic Manager profile of 'Priority' type](../traffic-manager/traffic-manager-create-profile.md) in hello Azure subscription.</span></span> <span data-ttu-id="a1cb4-175">Och sedan konfigurera DNS- och Traffic Manager-profilen i hello följande sätt.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-175">And then configure your DNS and Traffic Manager profile in hello following manner.</span></span>


| <span data-ttu-id="a1cb4-176">**Där**</span><span class="sxs-lookup"><span data-stu-id="a1cb4-176">**Where**</span></span> | <span data-ttu-id="a1cb4-177">**Källa**</span><span class="sxs-lookup"><span data-stu-id="a1cb4-177">**Source**</span></span> | <span data-ttu-id="a1cb4-178">**Mål**</span><span class="sxs-lookup"><span data-stu-id="a1cb4-178">**Target**</span></span>|
| --- | --- | --- |
| <span data-ttu-id="a1cb4-179">Offentliga DNS</span><span class="sxs-lookup"><span data-stu-id="a1cb4-179">Public DNS</span></span> | <span data-ttu-id="a1cb4-180">Offentliga DNS för SharePoint-webbplatser</span><span class="sxs-lookup"><span data-stu-id="a1cb4-180">Public DNS for SharePoint sites</span></span> <br/><br/> <span data-ttu-id="a1cb4-181">Ex: sharepoint.contoso.com</span><span class="sxs-lookup"><span data-stu-id="a1cb4-181">Ex: sharepoint.contoso.com</span></span> | <span data-ttu-id="a1cb4-182">Traffic Manager</span><span class="sxs-lookup"><span data-stu-id="a1cb4-182">Traffic Manager</span></span> <br/><br/> <span data-ttu-id="a1cb4-183">contososharepoint.trafficmanager.NET</span><span class="sxs-lookup"><span data-stu-id="a1cb4-183">contososharepoint.trafficmanager.net</span></span> |
| <span data-ttu-id="a1cb4-184">Lokal DNS</span><span class="sxs-lookup"><span data-stu-id="a1cb4-184">On-premises DNS</span></span> | <span data-ttu-id="a1cb4-185">sharepointonprem.contoso.com</span><span class="sxs-lookup"><span data-stu-id="a1cb4-185">sharepointonprem.contoso.com</span></span> | <span data-ttu-id="a1cb4-186">Offentliga IP-adress på hello lokal grupp</span><span class="sxs-lookup"><span data-stu-id="a1cb4-186">Public IP on hello on-premises farm</span></span> |


<span data-ttu-id="a1cb4-187">I hello Traffic Manager-profilen [skapa hello primära platsen och återställningsplatsen slutpunkter](../traffic-manager/traffic-manager-configure-priority-routing-method.md).</span><span class="sxs-lookup"><span data-stu-id="a1cb4-187">In hello Traffic Manager profile, [create hello primary and recovery endpoints](../traffic-manager/traffic-manager-configure-priority-routing-method.md).</span></span> <span data-ttu-id="a1cb4-188">Använd hello externa slutpunkten för den lokala slutpunkten och offentliga IP för Azure slutpunkt.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-188">Use hello external endpoint for on-premises endpoint and public IP for Azure endpoint.</span></span> <span data-ttu-id="a1cb4-189">Se till att hello prioriteten högre tooon lokala slutpunkt.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-189">Ensure that hello priority is set higher tooon-premises endpoint.</span></span>

<span data-ttu-id="a1cb4-190">Värden en testsida på en viss port (t.ex, 800) i hello SharePoint webbnivå för Traffic Manager tooautomatically identifiera tillgänglighet efter växling vid fel.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-190">Host a test page on a specific port (for example, 800) in hello SharePoint web tier in order for Traffic Manager tooautomatically detect availability post failover.</span></span> <span data-ttu-id="a1cb4-191">Detta är en lösning om du inte kan aktivera anonym autentisering på någon av SharePoint-webbplatser.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-191">This is a workaround in case you cannot enable anonymous authentication on any of your SharePoint sites.</span></span>

<span data-ttu-id="a1cb4-192">[Konfigurera hello trafikhanterarprofil](../traffic-manager/traffic-manager-configure-priority-routing-method.md) med hello under inställningar.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-192">[Configure hello Traffic Manager profile](../traffic-manager/traffic-manager-configure-priority-routing-method.md) with hello below settings.</span></span>

* <span data-ttu-id="a1cb4-193">Routningsmetoden - 'Priority'</span><span class="sxs-lookup"><span data-stu-id="a1cb4-193">Routing method - 'Priority'</span></span>
* <span data-ttu-id="a1cb4-194">DNS tid toolive (TTL) - 30 sekunder:</span><span class="sxs-lookup"><span data-stu-id="a1cb4-194">DNS time toolive (TTL) - '30 seconds'</span></span>
* <span data-ttu-id="a1cb4-195">Övervakaren slutpunktsinställningar - om du kan aktivera anonym autentisering kan du ge en viss webbplats slutpunkt.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-195">Endpoint monitor settings - If you can enable anonymous authentication, you can give a specific website endpoint.</span></span> <span data-ttu-id="a1cb4-196">Eller så kan du använda en testsida på en viss port (t.ex, 800).</span><span class="sxs-lookup"><span data-stu-id="a1cb4-196">Or, you can use a test page on a specific port (for example, 800).</span></span>

## <a name="creating-a-recovery-plan"></a><span data-ttu-id="a1cb4-197">Skapa en återställningsplan</span><span class="sxs-lookup"><span data-stu-id="a1cb4-197">Creating a recovery plan</span></span>

<span data-ttu-id="a1cb4-198">En återställningsplan kan ordningsföljd hello växling vid fel på olika nivåer i en flernivåapp, därför kan upprätthålla programkonsekvens.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-198">A recovery plan allows sequencing hello failover of various tiers in a multi-tier application, hence, maintaining application consistency.</span></span> <span data-ttu-id="a1cb4-199">Följ hello nedanstående steg när du skapar en återställningsplan för ett webbprogram med flera nivåer.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-199">Follow hello below steps while creating a recovery plan for a multi-tier web application.</span></span> <span data-ttu-id="a1cb4-200">[Lär dig mer om hur du skapar en återställningsplan](site-recovery-runbook-automation.md#customize-the-recovery-plan).</span><span class="sxs-lookup"><span data-stu-id="a1cb4-200">[Learn more about creating a recovery plan](site-recovery-runbook-automation.md#customize-the-recovery-plan).</span></span>

### <a name="adding-virtual-machines-toofailover-groups"></a><span data-ttu-id="a1cb4-201">Lägga till virtuella datorer toofailover grupper</span><span class="sxs-lookup"><span data-stu-id="a1cb4-201">Adding virtual machines toofailover groups</span></span>

1. <span data-ttu-id="a1cb4-202">Skapa en återställningsplan genom att lägga till hello App och webbnivå virtuella datorer.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-202">Create a recovery plan by adding hello App and Web tier VMs.</span></span>
2. <span data-ttu-id="a1cb4-203">Klicka på 'Anpassa' toogroup hello virtuella datorer.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-203">Click on 'Customize' toogroup hello VMs.</span></span> <span data-ttu-id="a1cb4-204">Som standard är alla virtuella datorer som en del av grupp 1.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-204">By default, all VMs are part of 'Group 1'.</span></span>

    ![Anpassa RP](./media/site-recovery-sharepoint/rp-groups.png)

3. <span data-ttu-id="a1cb4-206">Skapar en ny grupp (Grupp2) och flytta hello webbnivå virtuella datorer till hello ny grupp.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-206">Create another Group (Group 2) and move hello Web tier VMs into hello new group.</span></span> <span data-ttu-id="a1cb4-207">App-nivå VMs ska vara en del av grupp 1 och webbnivå VMs ska vara en del av Grupp2.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-207">Your App tier VMs should be part of 'Group 1' and Web tier VMs should be part of 'Group 2'.</span></span> <span data-ttu-id="a1cb4-208">Detta är tooensure som hello App nivå virtuella datorer starta först följt av Web nivå virtuella datorer.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-208">This is tooensure that hello App tier VMs boot up first followed by Web tier VMs.</span></span>


### <a name="adding-scripts-toohello-recovery-plan"></a><span data-ttu-id="a1cb4-209">Lägga till skript toohello återställningsplan</span><span class="sxs-lookup"><span data-stu-id="a1cb4-209">Adding scripts toohello recovery plan</span></span>

<span data-ttu-id="a1cb4-210">Du kan distribuera de vanligaste hello Azure Site Recovery skript i ditt Automation-konto genom att klicka på hello ”distribuera tooAzure” nedan.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-210">You can deploy hello most commonly used Azure Site Recovery scripts into your Automation account clicking hello 'Deploy tooAzure' button below.</span></span> <span data-ttu-id="a1cb4-211">När du använder alla publicerade skript Se till att du följer hello riktlinjerna i hello skript.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-211">When you are using any published script, ensure you follow hello guidance in hello script.</span></span>

<span data-ttu-id="a1cb4-212">[![Distribuera tooAzure](https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/c4803408-340e-49e3-9a1f-0ed3f689813d.png)](https://aka.ms/asr-automationrunbooks-deploy)</span><span class="sxs-lookup"><span data-stu-id="a1cb4-212">[![Deploy tooAzure](https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/c4803408-340e-49e3-9a1f-0ed3f689813d.png)](https://aka.ms/asr-automationrunbooks-deploy)</span></span>

1. <span data-ttu-id="a1cb4-213">Lägg till en före åtgärdsskriptet too'Group 1 toofailover SQL-tillgänglighetsgrupp.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-213">Add a pre-action script too'Group 1' toofailover SQL Availability group.</span></span> <span data-ttu-id="a1cb4-214">Använda hello 'ASR-SQL-FailoverAG' skript som publiceras i hello exempelskript.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-214">Use hello 'ASR-SQL-FailoverAG' script published in hello sample scripts.</span></span> <span data-ttu-id="a1cb4-215">Se till att du följer hello riktlinjerna i hello skript och ändra hello som krävs i hello skript på lämpligt sätt.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-215">Ensure you follow hello guidance in hello script and make hello required changes in hello script appropriately.</span></span>

    ![Lägg till-AG-skript för-steg-1](./media/site-recovery-sharepoint/add-ag-script-step1.png)

    ![Lägg till-AG-skript för-steg-2](./media/site-recovery-sharepoint/add-ag-script-step2.png)

2. <span data-ttu-id="a1cb4-218">Lägg till post åtgärd skriptet tooattach belastningsutjämning på hello misslyckades för virtuella datorer av webbnivå (Grupp2).</span><span class="sxs-lookup"><span data-stu-id="a1cb4-218">Add a post action script tooattach a load balancer on hello failed over virtual machines of Web tier (Group 2).</span></span> <span data-ttu-id="a1cb4-219">Använda hello 'ASR AddSingleLoadBalancer' skript som publiceras i hello exempelskript.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-219">Use hello 'ASR-AddSingleLoadBalancer' script published in hello sample scripts.</span></span> <span data-ttu-id="a1cb4-220">Se till att du följer hello riktlinjerna i hello skript och ändra hello som krävs i hello skript på lämpligt sätt.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-220">Ensure you follow hello guidance in hello script and make hello required changes in hello script appropriately.</span></span>

    ![Lägg till-LB-skript för-steg-1](./media/site-recovery-sharepoint/add-lb-script-step1.png)

    ![Lägg till-LB-skript för-steg-2](./media/site-recovery-sharepoint/add-lb-script-step2.png)

3. <span data-ttu-id="a1cb4-223">Lägg till en manuell åtgärd tooupdate hello DNS-poster toopoint toohello ny grupp i Azure.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-223">Add a manual step tooupdate hello DNS records toopoint toohello new farm in Azure.</span></span>

    * <span data-ttu-id="a1cb4-224">För internet facing platser, inga DNS-uppdateringar som är nödvändiga efter växling vid fel.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-224">For internet facing sites, no DNS updates are required post failover.</span></span> <span data-ttu-id="a1cb4-225">Följ hello stegen som beskrivs i hello vägledning för nätverk avsnittet tooconfigure Traffic Manager.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-225">Follow hello steps described in hello 'Networking guidance' section tooconfigure Traffic Manager.</span></span> <span data-ttu-id="a1cb4-226">Om hello Traffic Manager-profil har konfigurerats enligt beskrivningen i föregående avsnitt i hello, lägga till en skriptet tooopen dummy port (800 i hello exempel) på hello Azure VM.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-226">If hello Traffic Manager profile has been set up as described in hello previous section, add a script tooopen dummy port (800 in hello example) on hello Azure VM.</span></span>

    * <span data-ttu-id="a1cb4-227">Lägg till en manuell åtgärd tooupdate hello DNS-poster toopoint toohello nya Web nivå virtuell dators belastningen belastningsutjämnaren IP för interna Internetriktade platser.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-227">For internal facing sites, add a manual step tooupdate hello DNS record toopoint toohello new Web tier VM’s load balancer IP.</span></span>

4. <span data-ttu-id="a1cb4-228">Lägg till ett manuellt steg toorestore sökprogram från en säkerhetskopia eller starta en ny search-tjänsten.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-228">Add a manual step toorestore search application from a backup or start a new search service.</span></span>

5. <span data-ttu-id="a1cb4-229">Följ nedanstående steg för att återställa Sök efter tjänstprogram från en säkerhetskopia.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-229">For restoring Search service application from a backup, follow below steps.</span></span>

    * <span data-ttu-id="a1cb4-230">Den här metoden förutsätter att en säkerhetskopia av hello Sök-tjänstprogrammet har utförts innan hello oåterkallelig händelse och hello säkerhetskopian finns på hello DR-webbplats.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-230">This method assumes that a backup of hello Search Service Application was performed before hello catastrophic event and that hello backup is available at hello DR site.</span></span>
    * <span data-ttu-id="a1cb4-231">Detta kan enkelt uppnås genom att schemalägga hello säkerhetskopiering (till exempel, en gång om dagen) och använda en procedur tooplace hello säkerhetskopiering på hello DR-plats.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-231">This can easily be achieved by scheduling hello backup (for example, once daily) and using a copy procedure tooplace hello backup at hello DR site.</span></span> <span data-ttu-id="a1cb4-232">Kopiera procedurer kan omfatta skriptbaserade program, till exempel AzCopy (Azure kopia) eller konfigurera DFSR (Distributed File Services Replication).</span><span class="sxs-lookup"><span data-stu-id="a1cb4-232">Copy procedures could include scripted programs such as AzCopy (Azure Copy) or setting up DFSR (Distributed File Services Replication).</span></span>
    * <span data-ttu-id="a1cb4-233">Nu att hello SharePoint-servergruppen kör går hello Central Administration ”säkerhetskopiera och återställa” och väljer återställning.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-233">Now that hello SharePoint farm is running, navigate hello Central Administration, 'Backup and Restore' and select Restore.</span></span> <span data-ttu-id="a1cb4-234">hello återställning interrogates hello säkerhetskopieringsplatsen angetts (du kanske måste tooupdate hello värdet).</span><span class="sxs-lookup"><span data-stu-id="a1cb4-234">hello restore interrogates hello backup location specified (you may need tooupdate hello value).</span></span> <span data-ttu-id="a1cb4-235">Välj hello Sök efter tjänstprogram säkerhetskopia som toorestore.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-235">Select hello Search Service Application backup you would like toorestore.</span></span>
    * <span data-ttu-id="a1cb4-236">Sökningen har återställts.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-236">Search is restored.</span></span> <span data-ttu-id="a1cb4-237">Tänk på att hello återställning förväntar toofind hello samma topologi (samma antal servrar) och samma hårddisk bokstäver tilldelade toothose servrar.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-237">Keep in mind that hello restore expects toofind hello same topology (same number of servers) and same hard drive letters assigned toothose servers.</span></span> <span data-ttu-id="a1cb4-238">Mer information finns i [återställa Sök-tjänstprogrammet i SharePoint 2013](https://technet.microsoft.com/library/ee748654.aspx) dokumentet.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-238">For more information, see ['Restore Search service application in SharePoint 2013'](https://technet.microsoft.com/library/ee748654.aspx) document.</span></span>


6. <span data-ttu-id="a1cb4-239">Följ nedanstående steg för för att starta med ett nytt program för Search-tjänsten.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-239">For starting with a new Search service application, follow below steps.</span></span>

    * <span data-ttu-id="a1cb4-240">Den här metoden förutsätter att en säkerhetskopia av hello ”sökadministration” databasen är tillgänglig på hello DR-plats.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-240">This method assumes that a backup of hello “Search Administration” database is available at hello DR site.</span></span>
    * <span data-ttu-id="a1cb4-241">Eftersom hello andra Sök efter tjänstprogram databaser inte replikeras, måste de toobe skapas på nytt.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-241">Since hello other Search Service Application databases are not replicated, they need toobe re-created.</span></span> <span data-ttu-id="a1cb4-242">toodo så gå tooCentral Administration och ta bort hello Sök-tjänstprogrammet.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-242">toodo so, navigate tooCentral Administration and delete hello Search Service Application.</span></span> <span data-ttu-id="a1cb4-243">Vilka värden hello sökindex, ta bort hello indexfiler på alla servrar.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-243">On any servers which host hello Search Index, delete hello index files.</span></span>
    * <span data-ttu-id="a1cb4-244">Återskapa hello Sök efter tjänstprogram och den här återskapar hello-databaser.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-244">Re-create hello Search Service Application and this re-creates hello databases.</span></span> <span data-ttu-id="a1cb4-245">Det rekommenderas toohave förberedda skript som skapar detta tjänstprogram eftersom den inte är möjligt tooperform alla åtgärder via hello GUI.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-245">It is recommended toohave a prepared script that re-creates this service application since it is not possible tooperform all actions via hello GUI.</span></span> <span data-ttu-id="a1cb4-246">Till exempel är att hello index enhetsplats och konfigurera hello söktopologi bara möjligt med SharePoint PowerShell-cmdlets.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-246">For example, setting hello index drive location and configuring hello search topology are only possible by using SharePoint PowerShell cmdlets.</span></span> <span data-ttu-id="a1cb4-247">Använd hello Windows PowerShell-cmdleten återställning SPEnterpriseSearchServiceApplication och ange hello loggen levererade och replikerad databas för Search-Administration, Search_Service__DB.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-247">Use hello Windows PowerShell cmdlet Restore-SPEnterpriseSearchServiceApplication and specify hello log-shipped and replicated Search Administration database, Search_Service__DB.</span></span> <span data-ttu-id="a1cb4-248">Denna cmdlet ger hello sökkonfigurationen, schema, hanterade egenskaper, regler och källor och skapar en standarduppsättning hello andra komponenter.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-248">This cmdlet gives hello search configuration, schema, managed properties, rules, and sources and creates a default set of hello other components.</span></span>
    * <span data-ttu-id="a1cb4-249">När hello Sök-tjänstprogrammet har skapas på nytt, måste du starta en fullständig crawl för varje innehållskälla toorestore hello Search-tjänsten.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-249">Once hello Search Service Application has be re-created, you must start a full crawl for each content source toorestore hello Search Service.</span></span> <span data-ttu-id="a1cb4-250">Du förlorar analytics information från hello lokalt servergrupp, till exempel sökning rekommendationer.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-250">You lose some analytics information from hello on-premises farm, such as search recommendations.</span></span>

7. <span data-ttu-id="a1cb4-251">När alla hello steg har slutförts, spara hello återställningsplan och hello slutliga återställningsplan ser ut följande.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-251">Once all hello steps are completed, save hello recovery plan and hello final recovery plan will look like following.</span></span>

    ![Sparade RP](./media/site-recovery-sharepoint/saved-rp.png)

## <a name="doing-a-test-failover"></a><span data-ttu-id="a1cb4-253">Gör ett redundanstest</span><span class="sxs-lookup"><span data-stu-id="a1cb4-253">Doing a test failover</span></span>
<span data-ttu-id="a1cb4-254">Följ [vägledningen](site-recovery-test-failover-to-azure.md) toodo testa redundans.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-254">Follow [this guidance](site-recovery-test-failover-to-azure.md) toodo a test failover.</span></span>

1.  <span data-ttu-id="a1cb4-255">Gå tooAzure portal och välj Recovery-tjänsten-valvet.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-255">Go tooAzure portal and select your Recovery Service vault.</span></span>
2.  <span data-ttu-id="a1cb4-256">Klicka på hello återställningsplan som skapats för SharePoint-programmet.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-256">Click on hello recovery plan created for SharePoint application.</span></span>
3.  <span data-ttu-id="a1cb4-257">Klicka på Testa redundans.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-257">Click on 'Test Failover'.</span></span>
4.  <span data-ttu-id="a1cb4-258">Välj återställningspunkten och den virtuella Azure-nätverket toostart hello test failover-processen.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-258">Select recovery point and Azure virtual network toostart hello test failover process.</span></span>
5.  <span data-ttu-id="a1cb4-259">Du kan utföra din verifieringar när hello sekundära miljön är upp.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-259">Once hello secondary environment is up, you can perform your validations.</span></span>
6.  <span data-ttu-id="a1cb4-260">När hello verifieringar har slutförts kan du klicka på ”Rensa redundanstestet' på hello återställningsplan och hello redundanstestmiljön har rensats.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-260">Once hello validations are complete, you can click 'Cleanup test failover' on hello recovery plan and hello test failover environment is cleaned.</span></span>

<span data-ttu-id="a1cb4-261">Anvisningar om hur du gör testa redundans för AD och DNS, finns för[Redundanstestning för AD- och DNS](site-recovery-active-directory.md#test-failover-considerations) dokumentet.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-261">For guidance on doing test failover for AD and DNS, refer too[Test failover considerations for AD and DNS](site-recovery-active-directory.md#test-failover-considerations) document.</span></span>

<span data-ttu-id="a1cb4-262">För anvisningar om hur du gör testa redundans för SQL Always ON-Tillgänglighetsgrupper, se för[gör testa redundans för SQL Server alltid aktiverad](site-recovery-sql.md#steps-to-do-a-test-failover) dokumentet.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-262">For guidance on doing test failover for SQL Always ON availability groups, refer too[Doing Test failover for SQL Server Always On](site-recovery-sql.md#steps-to-do-a-test-failover) document.</span></span>

## <a name="doing-a-failover"></a><span data-ttu-id="a1cb4-263">Genomför en redundansväxling enligt</span><span class="sxs-lookup"><span data-stu-id="a1cb4-263">Doing a failover</span></span>
<span data-ttu-id="a1cb4-264">Följ [vägledningen](site-recovery-failover.md) för att göra en växling vid fel.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-264">Follow [this guidance](site-recovery-failover.md) for doing a failover.</span></span>

1.  <span data-ttu-id="a1cb4-265">Gå tooAzure portal och välj Recovery Services-valvet.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-265">Go tooAzure portal and select your Recovery Services vault.</span></span>
2.  <span data-ttu-id="a1cb4-266">Klicka på hello återställningsplan som skapats för SharePoint-programmet.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-266">Click on hello recovery plan created for SharePoint application.</span></span>
3.  <span data-ttu-id="a1cb4-267">Klicka på 'Redundans'.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-267">Click on 'Failover'.</span></span>
4.  <span data-ttu-id="a1cb4-268">Välj återställningsprocessen punkt toostart hello växling vid fel.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-268">Select recovery point toostart hello failover process.</span></span>

## <a name="next-steps"></a><span data-ttu-id="a1cb4-269">Nästa steg</span><span class="sxs-lookup"><span data-stu-id="a1cb4-269">Next steps</span></span>
<span data-ttu-id="a1cb4-270">Du kan lära dig mer om [replikering av andra program](site-recovery-workload.md) med Site Recovery.</span><span class="sxs-lookup"><span data-stu-id="a1cb4-270">You can learn more about [replicating other applications](site-recovery-workload.md) using Site Recovery.</span></span>
