---
title: "aaaConfigure hello Azure MFA NPS-tillägg | Microsoft Docs"
description: "När du installerar tillägget för hello NPS, Följ dessa steg för avancerad konfiguration som vitlistning av IP- och UPN-ersättning."
services: multi-factor-authentication
documentationcenter: 
author: kgremban
manager: femila
ms.assetid: 
ms.service: multi-factor-authentication
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/14/2017
ms.author: kgremban
ms.reviewer: yossib
ms.custom: it-pro
ms.openlocfilehash: c3aed077b23c95f874861eb00c8e6dca668329c1
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 10/06/2017
---
# <a name="advanced-configuration-options-for-hello-nps-extension-for-multi-factor-authentication"></a><span data-ttu-id="2d6f0-103">Avancerade konfigurationsalternativ för hello NPS-tillägg för Multifaktorautentisering</span><span class="sxs-lookup"><span data-stu-id="2d6f0-103">Advanced configuration options for hello NPS extension for Multi-Factor Authentication</span></span>

<span data-ttu-id="2d6f0-104">hello Server (NPS) tillägget utökar din molnbaserade Azure Multi-Factor Authentication-funktioner till din lokala infrastruktur.</span><span class="sxs-lookup"><span data-stu-id="2d6f0-104">hello Network Policy Server (NPS) extension extends your cloud-based Azure Multi-Factor Authentication features into your on-premises infrastructure.</span></span> <span data-ttu-id="2d6f0-105">Den här artikeln förutsätter att du redan har hello tillägget installeras och nu vill tooknow hur toocustomize hello-tillägget som du behöver.</span><span class="sxs-lookup"><span data-stu-id="2d6f0-105">This article assumes that you already have hello extension installed, and now want tooknow how toocustomize hello extension for you needs.</span></span> 

## <a name="alternate-login-id"></a><span data-ttu-id="2d6f0-106">Alternativt inloggnings-ID</span><span class="sxs-lookup"><span data-stu-id="2d6f0-106">Alternate login ID</span></span>

<span data-ttu-id="2d6f0-107">Eftersom hello NPS tillägget ansluter tooboth dina lokala kataloger och molnet kataloger, som kan uppstå ett problem där din lokala användarens huvudnamn (UPN) inte matchar hello namn i hello molnet.</span><span class="sxs-lookup"><span data-stu-id="2d6f0-107">Since hello NPS extension connects tooboth your on-premises and cloud directories, you might encounter an issue where your on-premises user principal names (UPNs) don't match hello names in hello cloud.</span></span> <span data-ttu-id="2d6f0-108">toosolve problemet, Använd alternativa inloggnings-ID: N.</span><span class="sxs-lookup"><span data-stu-id="2d6f0-108">toosolve this problem, use alternate login IDs.</span></span> 

<span data-ttu-id="2d6f0-109">Du kan ange en toobe för Active Directory-attribut som används i stället för hello UPN för Azure Multi-Factor Authentication i hello NPS-tillägget.</span><span class="sxs-lookup"><span data-stu-id="2d6f0-109">Within hello NPS extension, you can designate an Active Directory attribute toobe used in place of hello UPN for Azure Multi-Factor Authentication.</span></span> <span data-ttu-id="2d6f0-110">Detta gör att du tooprotect dina lokala resurser med tvåstegsverifiering utan att ändra din lokala UPN-namn.</span><span class="sxs-lookup"><span data-stu-id="2d6f0-110">This enables you tooprotect your on-premises resources with two-step verification without modifying your on-premises UPNs.</span></span> 

<span data-ttu-id="2d6f0-111">tooconfigure alternativt inloggnings-ID, gå för`HKLM\SOFTWARE\Microsoft\AzureMfa` och redigera hello följande registervärden:</span><span class="sxs-lookup"><span data-stu-id="2d6f0-111">tooconfigure alternate login IDs, go too`HKLM\SOFTWARE\Microsoft\AzureMfa` and edit hello following registry values:</span></span>

| <span data-ttu-id="2d6f0-112">Namn</span><span class="sxs-lookup"><span data-stu-id="2d6f0-112">Name</span></span> | <span data-ttu-id="2d6f0-113">Typ</span><span class="sxs-lookup"><span data-stu-id="2d6f0-113">Type</span></span> | <span data-ttu-id="2d6f0-114">Standardvärde</span><span class="sxs-lookup"><span data-stu-id="2d6f0-114">Default value</span></span> | <span data-ttu-id="2d6f0-115">Beskrivning</span><span class="sxs-lookup"><span data-stu-id="2d6f0-115">Description</span></span> |
| ---- | ---- | ------------- | ----------- |
| <span data-ttu-id="2d6f0-116">LDAP_ALTERNATE_LOGINID_ATTRIBUTE</span><span class="sxs-lookup"><span data-stu-id="2d6f0-116">LDAP_ALTERNATE_LOGINID_ATTRIBUTE</span></span> | <span data-ttu-id="2d6f0-117">Sträng</span><span class="sxs-lookup"><span data-stu-id="2d6f0-117">string</span></span> | <span data-ttu-id="2d6f0-118">tom</span><span class="sxs-lookup"><span data-stu-id="2d6f0-118">Empty</span></span> | <span data-ttu-id="2d6f0-119">Ange hello namnet på Active Directory-attribut som du vill toouse i stället för hello UPN.</span><span class="sxs-lookup"><span data-stu-id="2d6f0-119">Designate hello name of Active Directory attribute that you want toouse instead of hello UPN.</span></span> <span data-ttu-id="2d6f0-120">Det här attributet används som hello AlternateLoginId attribut.</span><span class="sxs-lookup"><span data-stu-id="2d6f0-120">This attribute is used as hello AlternateLoginId attribute.</span></span> <span data-ttu-id="2d6f0-121">Om värdet anges tooa [giltigt Active Directory-attribut](https://msdn.microsoft.com/library/ms675090.aspx) (till exempel e-post eller displayName), sedan hello attributvärde används i stället för hello användarens UPN för autentisering.</span><span class="sxs-lookup"><span data-stu-id="2d6f0-121">If this registry value is set tooa [valid Active Directory attribute](https://msdn.microsoft.com/library/ms675090.aspx) (for example, mail or displayName), then hello attribute's value is used in place of hello user's UPN for authentication.</span></span> <span data-ttu-id="2d6f0-122">Om värdet är tomt eller inte konfigurerad, sedan AlternateLoginId är inaktiverat och hello användares UPN används för autentisering.</span><span class="sxs-lookup"><span data-stu-id="2d6f0-122">If this registry value is empty or not configured, then AlternateLoginId is disabled and hello user's UPN is used for authentication.</span></span> |
| <span data-ttu-id="2d6f0-123">LDAP_FORCE_GLOBAL_CATALOG</span><span class="sxs-lookup"><span data-stu-id="2d6f0-123">LDAP_FORCE_GLOBAL_CATALOG</span></span> | <span data-ttu-id="2d6f0-124">Booleskt värde</span><span class="sxs-lookup"><span data-stu-id="2d6f0-124">boolean</span></span> | <span data-ttu-id="2d6f0-125">False</span><span class="sxs-lookup"><span data-stu-id="2d6f0-125">False</span></span> | <span data-ttu-id="2d6f0-126">Använd den här flaggan tooforce hello användningen av den globala katalogen för LDAP-sökningar när du söker efter AlternateLoginId.</span><span class="sxs-lookup"><span data-stu-id="2d6f0-126">Use this flag tooforce hello use of Global Catalog for LDAP searches when looking up AlternateLoginId.</span></span> <span data-ttu-id="2d6f0-127">Konfigurera en domänkontrollant som en Global katalog, Lägg till hello AlternateLoginId attributet toohello Global katalog och sedan aktivera den här flaggan.</span><span class="sxs-lookup"><span data-stu-id="2d6f0-127">Configure a domain controller as a Global Catalog, add hello AlternateLoginId attribute toohello Global Catalog, and then enable this flag.</span></span> <br><br> <span data-ttu-id="2d6f0-128">Om LDAP_LOOKUP_FORESTS konfigureras (inte tomt) **flaggan tillämpas som SANT**, oavsett hello hello registret inställningens värde.</span><span class="sxs-lookup"><span data-stu-id="2d6f0-128">If LDAP_LOOKUP_FORESTS is configured (not empty), **this flag is enforced as true**, regardless of hello value of hello registry setting.</span></span> <span data-ttu-id="2d6f0-129">I det här fallet kräver hello NPS tillägget hello Global katalog toobe konfigurerats med hello AlternateLoginId attribut för varje skog.</span><span class="sxs-lookup"><span data-stu-id="2d6f0-129">In this case, hello NPS extension requires hello Global Catalog toobe configured with hello AlternateLoginId attribute for each forest.</span></span> |
| <span data-ttu-id="2d6f0-130">LDAP_LOOKUP_FORESTS</span><span class="sxs-lookup"><span data-stu-id="2d6f0-130">LDAP_LOOKUP_FORESTS</span></span> | <span data-ttu-id="2d6f0-131">Sträng</span><span class="sxs-lookup"><span data-stu-id="2d6f0-131">string</span></span> | <span data-ttu-id="2d6f0-132">tom</span><span class="sxs-lookup"><span data-stu-id="2d6f0-132">Empty</span></span> | <span data-ttu-id="2d6f0-133">Ange en lista över skogar toosearch som gäller avgränsas med semikolon.</span><span class="sxs-lookup"><span data-stu-id="2d6f0-133">Provide a semi-colon separated list of forests toosearch.</span></span> <span data-ttu-id="2d6f0-134">Till exempel *contoso.com;foobar.com*. Om det här registervärdet som är konfigurerad, söker hello NPS tillägget upprepade gånger alla hello skogar i hello ordning som de visas i listan, och returnerar hello första lyckade AlternateLoginId värdet.</span><span class="sxs-lookup"><span data-stu-id="2d6f0-134">For example, *contoso.com;foobar.com*. If this registry value is configured, hello NPS extension iteratively searches all hello forests in hello order in which they were listed, and returns hello first successful AlternateLoginId value.</span></span> <span data-ttu-id="2d6f0-135">Om det här registervärdet som inte har konfigurerats är hello AlternateLoginId sökning slutna toohello aktuella domänen.</span><span class="sxs-lookup"><span data-stu-id="2d6f0-135">If this registry value is not configured, hello AlternateLoginId lookup is confined toohello current domain.</span></span>|

<span data-ttu-id="2d6f0-136">tootroubleshoot problem med alternativt inloggnings-ID, använder hello rekommenderade steg för [alternativa inloggnings-ID fel](multi-factor-authentication-nps-errors.md#alternate-login-id-errors).</span><span class="sxs-lookup"><span data-stu-id="2d6f0-136">tootroubleshoot problems with alternate login IDs, use hello recommended steps for [Alternate login ID errors](multi-factor-authentication-nps-errors.md#alternate-login-id-errors).</span></span>

## <a name="ip-exceptions"></a><span data-ttu-id="2d6f0-137">IP-undantag</span><span class="sxs-lookup"><span data-stu-id="2d6f0-137">IP exceptions</span></span>

<span data-ttu-id="2d6f0-138">Om du behöver toomonitor servertillgänglighet, som om belastningsutjämnare kontrollera vilka servrar som körs innan du skickar arbetsbelastningar kan vill du inte att dessa kontroller toobe blockeras av verifiering begäranden.</span><span class="sxs-lookup"><span data-stu-id="2d6f0-138">If you need toomonitor server availability, like if load balancers verify which servers are running before sending workloads, you don't want these checks toobe blocked by verification requests.</span></span> <span data-ttu-id="2d6f0-139">I stället skapa en lista med IP-adresser som du vet används av tjänstkonton och inaktivera Multifaktorautentisering krav för listan.</span><span class="sxs-lookup"><span data-stu-id="2d6f0-139">Instead, create a list of IP addresses that you know are used by service accounts, and disable Multi-Factor Authentication requirements for that list.</span></span> 

<span data-ttu-id="2d6f0-140">tooconfigure en godkänd IP-lista, gå för`HKLM\SOFTWARE\Microsoft\AzureMfa` och konfigurera hello följande registervärde:</span><span class="sxs-lookup"><span data-stu-id="2d6f0-140">tooconfigure an IP whitelist, go too`HKLM\SOFTWARE\Microsoft\AzureMfa` and configure hello following registry value:</span></span> 

| <span data-ttu-id="2d6f0-141">Namn</span><span class="sxs-lookup"><span data-stu-id="2d6f0-141">Name</span></span> | <span data-ttu-id="2d6f0-142">Typ</span><span class="sxs-lookup"><span data-stu-id="2d6f0-142">Type</span></span> | <span data-ttu-id="2d6f0-143">Standardvärde</span><span class="sxs-lookup"><span data-stu-id="2d6f0-143">Default value</span></span> | <span data-ttu-id="2d6f0-144">Beskrivning</span><span class="sxs-lookup"><span data-stu-id="2d6f0-144">Description</span></span> |
| ---- | ---- | ------------- | ----------- |
| <span data-ttu-id="2d6f0-145">IP_WHITELIST</span><span class="sxs-lookup"><span data-stu-id="2d6f0-145">IP_WHITELIST</span></span> | <span data-ttu-id="2d6f0-146">Sträng</span><span class="sxs-lookup"><span data-stu-id="2d6f0-146">string</span></span> | <span data-ttu-id="2d6f0-147">tom</span><span class="sxs-lookup"><span data-stu-id="2d6f0-147">Empty</span></span> | <span data-ttu-id="2d6f0-148">Ange en lista över IP-adresser som gäller avgränsas med semikolon.</span><span class="sxs-lookup"><span data-stu-id="2d6f0-148">Provide a semi-colon separated list of IP addresses.</span></span> <span data-ttu-id="2d6f0-149">Inkludera hello IP-adresserna för de datorer där tjänstbegäranden kommer som hello NAS-VPN-server.</span><span class="sxs-lookup"><span data-stu-id="2d6f0-149">Include hello IP addresses of machines where service requests originate, like hello NAS/VPN server.</span></span> <span data-ttu-id="2d6f0-150">IP-adressintervall är undernät inte stöds.</span><span class="sxs-lookup"><span data-stu-id="2d6f0-150">IP ranges are subnets are not supported.</span></span> <br><br> <span data-ttu-id="2d6f0-151">Till exempel *10.0.0.1;10.0.0.2;10.0.0.3*.</span><span class="sxs-lookup"><span data-stu-id="2d6f0-151">For example, *10.0.0.1;10.0.0.2;10.0.0.3*.</span></span>

<span data-ttu-id="2d6f0-152">När en begäran kommer från en IP-adress som finns i listan över godkända hello ignoreras tvåstegsverifiering.</span><span class="sxs-lookup"><span data-stu-id="2d6f0-152">When a request comes in from an IP address that exists in hello whitelist, two-step verification is skipped.</span></span> <span data-ttu-id="2d6f0-153">hello godkänd IP-lista är jämfört med toohello IP-adress som har angetts i hello *ratNASIPAddress* attribut för hello RADIUS-begäranden.</span><span class="sxs-lookup"><span data-stu-id="2d6f0-153">hello IP whitelist is compared toohello IP address that is provided in hello *ratNASIPAddress* attribute of hello RADIUS request.</span></span> <span data-ttu-id="2d6f0-154">Om en RADIUS-begäran kommer utan hello ratNASIPAddress attribut, loggas hello följande varning: ”P_WHITE_LIST_WARNING::IP godkända ignoreras som käll-IP saknas i RADIUS-begäranden i NasIpAddress attribut”.</span><span class="sxs-lookup"><span data-stu-id="2d6f0-154">If a RADIUS request comes in without hello ratNASIPAddress attribute, hello following warning is logged: "P_WHITE_LIST_WARNING::IP Whitelist is being ignored as source IP is missing in RADIUS request in NasIpAddress attribute."</span></span>

## <a name="next-steps"></a><span data-ttu-id="2d6f0-155">Nästa steg</span><span class="sxs-lookup"><span data-stu-id="2d6f0-155">Next steps</span></span>

[<span data-ttu-id="2d6f0-156">Lösa felmeddelanden från hello NPS-tillägg för Azure Multi-Factor Authentication</span><span class="sxs-lookup"><span data-stu-id="2d6f0-156">Resolve error messages from hello NPS extension for Azure Multi-Factor Authentication</span></span>](multi-factor-authentication-nps-errors.md)
