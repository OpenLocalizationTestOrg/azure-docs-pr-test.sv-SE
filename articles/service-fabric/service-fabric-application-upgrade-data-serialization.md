---
title: 'Uppgradering av programmet: dataserialisering | Microsoft Docs'
description: "Metodtips för dataserialisering och hur den påverkar rullande programuppgraderingar."
services: service-fabric
documentationcenter: .net
author: vturecek
manager: timlt
editor: 
ms.assetid: a5f36366-a2ab-4ae3-bb08-bc2f9533bc5a
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 06/29/2017
ms.author: vturecek
ms.openlocfilehash: 1b65dfd3813423550631490640a81953864f58e3
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 10/06/2017
---
# <a name="how-data-serialization-affects-an-application-upgrade"></a><span data-ttu-id="c16a1-103">Hur dataserialisering påverkar en uppgradering av programmet</span><span class="sxs-lookup"><span data-stu-id="c16a1-103">How data serialization affects an application upgrade</span></span>
<span data-ttu-id="c16a1-104">I en [löpande uppgradering av programmet](service-fabric-application-upgrade.md), hello uppgraderingen är tillämpade tooa del noder, en domän i taget.</span><span class="sxs-lookup"><span data-stu-id="c16a1-104">In a [rolling application upgrade](service-fabric-application-upgrade.md), hello upgrade is applied tooa subset of nodes, one upgrade domain at a time.</span></span> <span data-ttu-id="c16a1-105">Under den här processen vissa uppgraderingsdomäner finns på hello nyare version av programmet, och vissa uppgraderingsdomäner hello äldre versioner av programmet.</span><span class="sxs-lookup"><span data-stu-id="c16a1-105">During this process, some upgrade domains are on hello newer version of your application, and some upgrade domains are on hello older version of your application.</span></span> <span data-ttu-id="c16a1-106">Under den här fasen hello hello ny version av programmet måste vara kan tooread hello gammal version av dina data och hello gammal version av programmet måste vara kan tooread hello ny version av dina data.</span><span class="sxs-lookup"><span data-stu-id="c16a1-106">During hello rollout, hello new version of your application must be able tooread hello old version of your data, and hello old version of your application must be able tooread hello new version of your data.</span></span> <span data-ttu-id="c16a1-107">Om hello dataformat inte framåt och bakåt kompatibla, hello-uppgraderingen kan misslyckas eller värre, data går förlorat eller skadat.</span><span class="sxs-lookup"><span data-stu-id="c16a1-107">If hello data format is not forward and backward compatible, hello upgrade may fail, or worse, data may be lost or corrupted.</span></span> <span data-ttu-id="c16a1-108">Den här artikeln beskrivs vad som utgör ditt dataformat och ger bästa praxis för att säkerställa att dina data är framåt och bakåt kompatibel.</span><span class="sxs-lookup"><span data-stu-id="c16a1-108">This article discusses what constitutes your data format and offers best practices for ensuring that your data is forward and backward compatible.</span></span>

## <a name="what-makes-up-your-data-format"></a><span data-ttu-id="c16a1-109">Hur får din dataformat?</span><span class="sxs-lookup"><span data-stu-id="c16a1-109">What makes up your data format?</span></span>
<span data-ttu-id="c16a1-110">I Azure Service Fabric hello data som är sparade som replikeras som kommer från C#-klasser.</span><span class="sxs-lookup"><span data-stu-id="c16a1-110">In Azure Service Fabric, hello data that is persisted and replicated comes from your C# classes.</span></span> <span data-ttu-id="c16a1-111">För program som använder [tillförlitliga samlingar](service-fabric-reliable-services-reliable-collections.md), att data är hello objekt i hello tillförlitliga ordböcker och köer.</span><span class="sxs-lookup"><span data-stu-id="c16a1-111">For applications that use [Reliable Collections](service-fabric-reliable-services-reliable-collections.md), that data is hello objects in hello reliable dictionaries and queues.</span></span> <span data-ttu-id="c16a1-112">För program som använder [Reliable Actors](service-fabric-reliable-actors-introduction.md), som är hello säkerhetskopiering tillstånd för hello aktören.</span><span class="sxs-lookup"><span data-stu-id="c16a1-112">For applications that use [Reliable Actors](service-fabric-reliable-actors-introduction.md), that is hello backing state for hello actor.</span></span> <span data-ttu-id="c16a1-113">Dessa klasser i C# måste kunna serialiseras toobe beständiga och replikeras.</span><span class="sxs-lookup"><span data-stu-id="c16a1-113">These C# classes must be serializable toobe persisted and replicated.</span></span> <span data-ttu-id="c16a1-114">Därför definieras hello dataformatet av hello fält och egenskaper som serialiseras, samt hur de serialiseras.</span><span class="sxs-lookup"><span data-stu-id="c16a1-114">Therefore, hello data format is defined by hello fields and properties that are serialized, as well as how they are serialized.</span></span> <span data-ttu-id="c16a1-115">Till exempel i en `IReliableDictionary<int, MyClass>` hello data är en serialiserad `int` och en serialiserad `MyClass`.</span><span class="sxs-lookup"><span data-stu-id="c16a1-115">For example, in an `IReliableDictionary<int, MyClass>` hello data is a serialized `int` and a serialized `MyClass`.</span></span>

### <a name="code-changes-that-result-in-a-data-format-change"></a><span data-ttu-id="c16a1-116">Kod ändrar som resulterar i en data-formatändring</span><span class="sxs-lookup"><span data-stu-id="c16a1-116">Code changes that result in a data format change</span></span>
<span data-ttu-id="c16a1-117">Eftersom hello dataformat bestäms av klasser i C#, kan ändringar toohello klasser orsaka en formatändring data.</span><span class="sxs-lookup"><span data-stu-id="c16a1-117">Since hello data format is determined by C# classes, changes toohello classes may cause a data format change.</span></span> <span data-ttu-id="c16a1-118">Var försiktig tooensure som en uppgradering kan hantera hello dataformat ändringen.</span><span class="sxs-lookup"><span data-stu-id="c16a1-118">Care must be taken tooensure that a rolling upgrade can handle hello data format change.</span></span> <span data-ttu-id="c16a1-119">Exempel som kan orsaka dataändringar format:</span><span class="sxs-lookup"><span data-stu-id="c16a1-119">Examples that may cause data format changes:</span></span>

* <span data-ttu-id="c16a1-120">Lägga till eller ta bort fält eller egenskaper</span><span class="sxs-lookup"><span data-stu-id="c16a1-120">Adding or removing fields or properties</span></span>
* <span data-ttu-id="c16a1-121">Byta namn på fält eller egenskaper</span><span class="sxs-lookup"><span data-stu-id="c16a1-121">Renaming fields or properties</span></span>
* <span data-ttu-id="c16a1-122">Ändra hello typer av fält eller egenskaper</span><span class="sxs-lookup"><span data-stu-id="c16a1-122">Changing hello types of fields or properties</span></span>
* <span data-ttu-id="c16a1-123">Ändra hello klassnamn eller namnområde</span><span class="sxs-lookup"><span data-stu-id="c16a1-123">Changing hello class name or namespace</span></span>

### <a name="data-contract-as-hello-default-serializer"></a><span data-ttu-id="c16a1-124">Datakontrakt som hello standard serialiseraren</span><span class="sxs-lookup"><span data-stu-id="c16a1-124">Data Contract as hello default serializer</span></span>
<span data-ttu-id="c16a1-125">hello serialiseraren används vanligtvis för Datainläsningen hello och avserialisering till hello aktuella versionen, även om hello data i en äldre eller *nyare* version.</span><span class="sxs-lookup"><span data-stu-id="c16a1-125">hello serializer is generally responsible for reading hello data and deserializing it into hello current version, even if hello data is in an older or *newer* version.</span></span> <span data-ttu-id="c16a1-126">hello standard serialiseraren är hello [datakontrakt serialiseraren](https://msdn.microsoft.com/library/ms733127.aspx), som har väldefinierade versionshantering regler.</span><span class="sxs-lookup"><span data-stu-id="c16a1-126">hello default serializer is hello [Data Contract serializer](https://msdn.microsoft.com/library/ms733127.aspx), which has well-defined versioning rules.</span></span> <span data-ttu-id="c16a1-127">Tillförlitliga samlingar kan hello serialiseraren toobe åsidosätts, men Reliable Actors för närvarande inte.</span><span class="sxs-lookup"><span data-stu-id="c16a1-127">Reliable Collections allow hello serializer toobe overridden, but Reliable Actors currently do not.</span></span> <span data-ttu-id="c16a1-128">hello data serialiseraren spelar en viktig roll i att aktivera löpande uppgraderingar.</span><span class="sxs-lookup"><span data-stu-id="c16a1-128">hello data serializer plays an important role in enabling rolling upgrades.</span></span> <span data-ttu-id="c16a1-129">hello datakontrakt serialiseraren är hello serialiseraren som vi rekommenderar för Service Fabric-program.</span><span class="sxs-lookup"><span data-stu-id="c16a1-129">hello Data Contract serializer is hello serializer that we recommend for Service Fabric applications.</span></span>

## <a name="how-hello-data-format-affects-a-rolling-upgrade"></a><span data-ttu-id="c16a1-130">Hur påverkar hello dataformat löpande uppgradering</span><span class="sxs-lookup"><span data-stu-id="c16a1-130">How hello data format affects a rolling upgrade</span></span>
<span data-ttu-id="c16a1-131">Det finns två huvudscenarier där hello serialiseraren kan stöta på en äldre under en uppgradering eller *nyare* version av dina data:</span><span class="sxs-lookup"><span data-stu-id="c16a1-131">During a rolling upgrade, there are two main scenarios where hello serializer may encounter an older or *newer* version of your data:</span></span>

1. <span data-ttu-id="c16a1-132">När en nod har uppgraderats och börjar säkerhetskopiera, laddar hello nya serialiseraren hello data beständiga toodisk av hello gamla versionen.</span><span class="sxs-lookup"><span data-stu-id="c16a1-132">After a node is upgraded and starts back up, hello new serializer will load hello data that was persisted toodisk by hello old version.</span></span>
2. <span data-ttu-id="c16a1-133">Under hello löpande uppgradering, innehåller hello kluster en blandning av hello gamla och nya versioner av din kod.</span><span class="sxs-lookup"><span data-stu-id="c16a1-133">During hello rolling upgrade, hello cluster will contain a mix of hello old and new versions of your code.</span></span> <span data-ttu-id="c16a1-134">Eftersom repliker kan placeras i olika uppgraderingsdomäner och repliker skicka data tooeach andra hello nya eller gamla kan versionen av data påträffas i hello nya eller gamla versionen av din serialiseraren.</span><span class="sxs-lookup"><span data-stu-id="c16a1-134">Since replicas may be placed in different upgrade domains, and replicas send data tooeach other, hello new and/or old version of your data may be encountered by hello new and/or old version of your serializer.</span></span>

> [!NOTE]
> <span data-ttu-id="c16a1-135">Hej ”ny” och ”gamla versionen” här finns toohello version av din kod som körs.</span><span class="sxs-lookup"><span data-stu-id="c16a1-135">hello "new version" and "old version" here refer toohello version of your code that is running.</span></span> <span data-ttu-id="c16a1-136">Hej ”nya serialiseraren” refererar toohello serialiseraren kod som körs i hello nya versionen av programmet.</span><span class="sxs-lookup"><span data-stu-id="c16a1-136">hello "new serializer" refers toohello serializer code that is executing in hello new version of your application.</span></span> <span data-ttu-id="c16a1-137">Hej ”nya data” refererar toohello serialiseras C#-klass från hello ny version av programmet.</span><span class="sxs-lookup"><span data-stu-id="c16a1-137">hello "new data" refers toohello serialized C# class from hello new version of your application.</span></span>
> 
> 

<span data-ttu-id="c16a1-138">Hej två versioner av koden och dataformat måste vara både framåt och bakåt kompatibel.</span><span class="sxs-lookup"><span data-stu-id="c16a1-138">hello two versions of code and data format must be both forward and backward compatible.</span></span> <span data-ttu-id="c16a1-139">Om de inte är kompatibla hello löpande uppgradering misslyckas eller data kan gå förlorade.</span><span class="sxs-lookup"><span data-stu-id="c16a1-139">If they are not compatible, hello rolling upgrade may fail or data may be lost.</span></span> <span data-ttu-id="c16a1-140">hello löpande uppgradering misslyckas eftersom hello-kod eller serialiseraren kan utlösa undantag eller ett fel när den stöter på hello andra versionen.</span><span class="sxs-lookup"><span data-stu-id="c16a1-140">hello rolling upgrade may fail because hello code or serializer may throw exceptions or a fault when it encounters hello other version.</span></span> <span data-ttu-id="c16a1-141">Data kan gå förlorade om du till exempel en ny egenskap har lagts till men hello gamla serialiseraren den under deserialisering.</span><span class="sxs-lookup"><span data-stu-id="c16a1-141">Data may be lost if, for example, a new property was added but hello old serializer discards it during deserialization.</span></span>

<span data-ttu-id="c16a1-142">Datakontrakt är hello rekommenderade lösningen för att säkerställa att dina data är kompatibel.</span><span class="sxs-lookup"><span data-stu-id="c16a1-142">Data Contract is hello recommended solution for ensuring that your data is compatible.</span></span> <span data-ttu-id="c16a1-143">Det har väldefinierade versionshantering regler för att lägga till, ta bort och ändra fält.</span><span class="sxs-lookup"><span data-stu-id="c16a1-143">It has well-defined versioning rules for adding, removing, and changing fields.</span></span> <span data-ttu-id="c16a1-144">Det har också stöd för behandlar okänt fält, koppla upp i hello serialisering och deserialisering processen och behandlar klassarv.</span><span class="sxs-lookup"><span data-stu-id="c16a1-144">It also has support for dealing with unknown fields, hooking into hello serialization and deserialization process, and dealing with class inheritance.</span></span> <span data-ttu-id="c16a1-145">Mer information finns i [med datakontrakt](https://msdn.microsoft.com/library/ms733127.aspx).</span><span class="sxs-lookup"><span data-stu-id="c16a1-145">For more information, see [Using Data Contract](https://msdn.microsoft.com/library/ms733127.aspx).</span></span>

## <a name="next-steps"></a><span data-ttu-id="c16a1-146">Nästa steg</span><span class="sxs-lookup"><span data-stu-id="c16a1-146">Next steps</span></span>
<span data-ttu-id="c16a1-147">[Uppgradera ditt program med hjälp av Visual Studio](service-fabric-application-upgrade-tutorial.md) vägleder dig genom en uppgradering av programmet med hjälp av Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="c16a1-147">[Upgrading your Application Using Visual Studio](service-fabric-application-upgrade-tutorial.md) walks you through an application upgrade using Visual Studio.</span></span>

<span data-ttu-id="c16a1-148">[Uppgradera ditt program med hjälp av Powershell](service-fabric-application-upgrade-tutorial-powershell.md) vägleder dig genom en uppgradering av programmet med hjälp av PowerShell.</span><span class="sxs-lookup"><span data-stu-id="c16a1-148">[Upgrading your Application Using Powershell](service-fabric-application-upgrade-tutorial-powershell.md) walks you through an application upgrade using PowerShell.</span></span>

<span data-ttu-id="c16a1-149">Styra hur programmet ska uppgraderas med hjälp av [uppgradera parametrar](service-fabric-application-upgrade-parameters.md).</span><span class="sxs-lookup"><span data-stu-id="c16a1-149">Control how your application upgrades by using [Upgrade Parameters](service-fabric-application-upgrade-parameters.md).</span></span>

<span data-ttu-id="c16a1-150">Lär dig hur toouse avancerade funktioner när du uppgraderar ditt program genom att referera för[avancerade ämnen](service-fabric-application-upgrade-advanced.md).</span><span class="sxs-lookup"><span data-stu-id="c16a1-150">Learn how toouse advanced functionality while upgrading your application by referring too[Advanced Topics](service-fabric-application-upgrade-advanced.md).</span></span>

<span data-ttu-id="c16a1-151">Lösa vanliga problem i programuppgraderingar genom att referera toohello stegen i [felsökning programuppgraderingar ](service-fabric-application-upgrade-troubleshooting.md).</span><span class="sxs-lookup"><span data-stu-id="c16a1-151">Fix common problems in application upgrades by referring toohello steps in [Troubleshooting Application Upgrades ](service-fabric-application-upgrade-troubleshooting.md).</span></span>

