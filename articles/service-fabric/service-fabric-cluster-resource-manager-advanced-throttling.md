---
title: aaaThrottling i hello Service Fabric-kluster resource manager | Microsoft Docs
description: "Lär dig tooconfigure hello begränsningar som tillhandahålls av hello resurshanteraren för Service Fabric-klustret."
services: service-fabric
documentationcenter: .net
author: masnider
manager: timlt
editor: 
ms.assetid: 4a44678b-a5aa-4d30-958f-dc4332ebfb63
ms.service: Service-Fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 08/18/2017
ms.author: masnider
ms.openlocfilehash: f418536911d3e3814e78a4d9f057dfb867ca7c63
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 10/06/2017
---
# <a name="throttling-hello-service-fabric-cluster-resource-manager"></a><span data-ttu-id="865d9-103">Begränsning hello resurshanteraren för Service Fabric-kluster</span><span class="sxs-lookup"><span data-stu-id="865d9-103">Throttling hello Service Fabric Cluster Resource Manager</span></span>
<span data-ttu-id="865d9-104">Även om du har rätt konfigurerad hello klustret Resource Manager kan få upplöst hello klustret.</span><span class="sxs-lookup"><span data-stu-id="865d9-104">Even if you’ve configured hello Cluster Resource Manager correctly, hello cluster can get disrupted.</span></span> <span data-ttu-id="865d9-105">Det kan till exempel vara samtidiga nod och feltolerans domän fel - vad som skulle hända om som uppstod under en uppgradering? hello klustret Resource Manager försöker alltid toofix allt använder hello klustrets resurser och försök tooreorganize och fixa hello-klustret.</span><span class="sxs-lookup"><span data-stu-id="865d9-105">For example, there could be simultaneous node and fault domain failures - what would happen if that occurred during an upgrade? hello Cluster Resource Manager always tries toofix everything, consuming hello cluster's resources trying tooreorganize and fix hello cluster.</span></span> <span data-ttu-id="865d9-106">Begränsningar ger en backstop så att hello klustret kan använda resurser toostabilize - hello noder komma tillbaka, hello nätverkspartitioner läka, korrigerade bits distribueras.</span><span class="sxs-lookup"><span data-stu-id="865d9-106">Throttles help provide a backstop so that hello cluster can use resources toostabilize - hello nodes come back, hello network partitions heal, corrected bits get deployed.</span></span>

<span data-ttu-id="865d9-107">toohelp med sådana här situationer hello resurshanteraren för Service Fabric-kluster innehåller flera begränsningar.</span><span class="sxs-lookup"><span data-stu-id="865d9-107">toohelp with these sorts of situations, hello Service Fabric Cluster Resource Manager includes several throttles.</span></span> <span data-ttu-id="865d9-108">Dessa begränsningar är alla ganska stort hammare.</span><span class="sxs-lookup"><span data-stu-id="865d9-108">These throttles are all fairly large hammers.</span></span> <span data-ttu-id="865d9-109">I allmänhet de får inte ändras utan noggrann planering och testning.</span><span class="sxs-lookup"><span data-stu-id="865d9-109">Generally they shouldn’t be changed without careful planning and testing.</span></span>

<span data-ttu-id="865d9-110">Om du ändrar hello klustret resurshanterare begränsas, bör du finjustera dem tooyour faktiska belastning.</span><span class="sxs-lookup"><span data-stu-id="865d9-110">If you change hello Cluster Resource Manager's throttles, you should tune them tooyour expected actual load.</span></span> <span data-ttu-id="865d9-111">Du kan kontrollera du behöver toohave vissa begränsar på plats, även om det innebär hello klustret tar längre tid toostabilize i vissa situationer.</span><span class="sxs-lookup"><span data-stu-id="865d9-111">You may determine you need toohave some throttles in place, even if it means hello cluster takes longer toostabilize in some situations.</span></span> <span data-ttu-id="865d9-112">Testning är obligatoriska toodetermine hello korrekta värden för begränsas.</span><span class="sxs-lookup"><span data-stu-id="865d9-112">Testing is required toodetermine hello correct values for throttles.</span></span> <span data-ttu-id="865d9-113">Begränsningar måste toobe tillräckligt högt tooallow hello klustret toorespond toochanges inom en rimlig tid och låg tillräckligt med tooactually hindra för mycket resursförbrukning.</span><span class="sxs-lookup"><span data-stu-id="865d9-113">Throttles need toobe high enough tooallow hello cluster toorespond toochanges in a reasonable amount of time, and low enough tooactually prevent too much resource consumption.</span></span> 

<span data-ttu-id="865d9-114">De flesta hello tid som vi har sett kunder använder begränsningar har eftersom de redan i en miljö med begränsad resurs.</span><span class="sxs-lookup"><span data-stu-id="865d9-114">Most of hello time we’ve seen customers use throttles it has been because they were already in a resource constrained environment.</span></span> <span data-ttu-id="865d9-115">Några exempel är begränsad nätverksbandbredd för enskilda noder eller diskar som inte kan toobuild många tillståndskänslig repliker i parallella på grund av toothroughput begränsningar.</span><span class="sxs-lookup"><span data-stu-id="865d9-115">Some examples would be limited network bandwidth for individual nodes, or disks that aren't able toobuild many stateful replicas in parallel due toothroughput limitations.</span></span> <span data-ttu-id="865d9-116">Utan begränsningar, kan operations överväldigande resurserna orsakar operations toofail eller vara långsam.</span><span class="sxs-lookup"><span data-stu-id="865d9-116">Without throttles, operations could overwhelm these resources, causing operations toofail or be slow.</span></span> <span data-ttu-id="865d9-117">I sådana situationer kunder används begränsningar och känner de utöka hello lång tid det tar hello klustret tooreach ett stabilt tillstånd.</span><span class="sxs-lookup"><span data-stu-id="865d9-117">In these situations customers used throttles and knew they were extending hello amount of time it would take hello cluster tooreach a stable state.</span></span> <span data-ttu-id="865d9-118">Kunder kan också förstått de kan hamna körs med lägre pålitlighet när de har begränsats.</span><span class="sxs-lookup"><span data-stu-id="865d9-118">Customers also understood they could end up running at lower overall reliability while they were throttled.</span></span>


## <a name="configuring-hello-throttles"></a><span data-ttu-id="865d9-119">Konfigurera hello begränsar</span><span class="sxs-lookup"><span data-stu-id="865d9-119">Configuring hello throttles</span></span>

<span data-ttu-id="865d9-120">Service Fabric har två mekanismer för begränsning hello antalet replik förflyttningar.</span><span class="sxs-lookup"><span data-stu-id="865d9-120">Service Fabric has two mechanisms for throttling hello number of replica movements.</span></span> <span data-ttu-id="865d9-121">hello standardmekanism som fanns före Service Fabric 5.7 representerar begränsning som ett absolut antal flyttar tillåts.</span><span class="sxs-lookup"><span data-stu-id="865d9-121">hello default mechanism that existed before Service Fabric 5.7 represents throttling as an absolute number of moves allowed.</span></span> <span data-ttu-id="865d9-122">Detta fungerar inte för kluster i alla storlekar.</span><span class="sxs-lookup"><span data-stu-id="865d9-122">This does not work for clusters of all sizes.</span></span> <span data-ttu-id="865d9-123">I synnerhet för stora kluster hello standard kan värdet vara för liten avsevärt långsammare belastningsutjämning även när det är nödvändigt, samtidigt som du har ingen effekt i mindre kluster.</span><span class="sxs-lookup"><span data-stu-id="865d9-123">In particular, for large clusters hello default value can be too small, significantly slowing down balancing even when it is necessary, while having no effect in smaller clusters.</span></span> <span data-ttu-id="865d9-124">Denna mekanism för tidigare har ersatts av procent-baserade begränsning skalas bättre med dynamiska kluster i vilka hello antal tjänster och noder ändras regelbundet.</span><span class="sxs-lookup"><span data-stu-id="865d9-124">This prior mechanism has been superseded by percentage-based throttling, which scales better with dynamic clusters in which hello number of services and nodes change regularly.</span></span>

<span data-ttu-id="865d9-125">hello begränsas baseras på en procentandel av hello antal repliker i hello kluster.</span><span class="sxs-lookup"><span data-stu-id="865d9-125">hello throttles are based on a percentage of hello number of replicas in hello clusters.</span></span> <span data-ttu-id="865d9-126">Percetage baserat begränsas aktivera uttrycka hello regel: ”inte flytta mer än 10% av repliker 10: e minut”, till exempel.</span><span class="sxs-lookup"><span data-stu-id="865d9-126">Percetage based throttles enable expressing hello rule: "do not move more than 10% of replicas in a 10 minute interval", for example.</span></span>

<span data-ttu-id="865d9-127">hello konfigurationsinställningarna för procent-baserade begränsning är:</span><span class="sxs-lookup"><span data-stu-id="865d9-127">hello configuration settings for percentage-based throttling are:</span></span>

  - <span data-ttu-id="865d9-128">GlobalMovementThrottleThresholdPercentage - maximalt antal förflyttningar tillåts i klustret när som helst, uttryckt i procent av totalt antal repliker i hello klustret.</span><span class="sxs-lookup"><span data-stu-id="865d9-128">GlobalMovementThrottleThresholdPercentage - Maximum number of movements allowed in cluster at any time, expressed as percentage of total number of replicas in hello cluster.</span></span> <span data-ttu-id="865d9-129">0 anger att ingen gräns.</span><span class="sxs-lookup"><span data-stu-id="865d9-129">0 indicates no limit.</span></span> <span data-ttu-id="865d9-130">hello standardvärdet är 0.</span><span class="sxs-lookup"><span data-stu-id="865d9-130">hello default value is 0.</span></span> <span data-ttu-id="865d9-131">Om både den här inställningen och GlobalMovementThrottleThreshold anges används hello mer konservativ gränsen.</span><span class="sxs-lookup"><span data-stu-id="865d9-131">If both this setting and GlobalMovementThrottleThreshold are specified, then hello more conservative limit is used.</span></span>
  - <span data-ttu-id="865d9-132">GlobalMovementThrottleThresholdPercentageForPlacement - maximalt antal förflyttningar av typ får användas under hello placering fas, uttryckt i procent av totalt antal repliker i hello klustret.</span><span class="sxs-lookup"><span data-stu-id="865d9-132">GlobalMovementThrottleThresholdPercentageForPlacement - Maximum number of movements allowed during hello placement phase, expressed as percentage of total number of replicas in hello cluster.</span></span> <span data-ttu-id="865d9-133">0 anger att ingen gräns.</span><span class="sxs-lookup"><span data-stu-id="865d9-133">0 indicates no limit.</span></span> <span data-ttu-id="865d9-134">hello standardvärdet är 0.</span><span class="sxs-lookup"><span data-stu-id="865d9-134">hello default value is 0.</span></span> <span data-ttu-id="865d9-135">Om både den här inställningen och GlobalMovementThrottleThresholdForPlacement anges används hello mer konservativ gränsen.</span><span class="sxs-lookup"><span data-stu-id="865d9-135">If both this setting and GlobalMovementThrottleThresholdForPlacement are specified, then hello more conservative limit is used.</span></span>
  - <span data-ttu-id="865d9-136">GlobalMovementThrottleThresholdPercentageForBalancing - maximalt antal förflyttningar av typ får användas under hello NLB fas, uttryckt i procent av totalt antal repliker i hello klustret.</span><span class="sxs-lookup"><span data-stu-id="865d9-136">GlobalMovementThrottleThresholdPercentageForBalancing - Maximum number of movements allowed during hello balancing phase, expressed as percentage of total number of replicas in hello cluster.</span></span> <span data-ttu-id="865d9-137">0 anger att ingen gräns.</span><span class="sxs-lookup"><span data-stu-id="865d9-137">0 indicates no limit.</span></span> <span data-ttu-id="865d9-138">hello standardvärdet är 0.</span><span class="sxs-lookup"><span data-stu-id="865d9-138">hello default value is 0.</span></span> <span data-ttu-id="865d9-139">Om både den här inställningen och GlobalMovementThrottleThresholdForBalancing anges används hello mer konservativ gränsen.</span><span class="sxs-lookup"><span data-stu-id="865d9-139">If both this setting and GlobalMovementThrottleThresholdForBalancing are specified, then hello more conservative limit is used.</span></span>

<span data-ttu-id="865d9-140">När du anger hello begränsning i procent, anger du 5% som 0,05.</span><span class="sxs-lookup"><span data-stu-id="865d9-140">When specifying hello throttle percentage, you'd specify 5% as 0.05.</span></span> <span data-ttu-id="865d9-141">Hej är då dessa begränsningar regleras hello GlobalMovementThrottleCountingInterval som anges i sekunder.</span><span class="sxs-lookup"><span data-stu-id="865d9-141">hello interval on which these throttles are governed is hello GlobalMovementThrottleCountingInterval, which is specified in seconds.</span></span>


``` xml
<Section Name="PlacementAndLoadBalancing">
     <Parameter Name="GlobalMovementThrottleThresholdPercentage" Value="0" />
     <Parameter Name="GlobalMovementThrottleThresholdPercentageForPlacement" Value="0" />
     <Parameter Name="GlobalMovementThrottleThresholdPercentageForBalancing" Value="0" />
     <Parameter Name="GlobalMovementThrottleCountingInterval" Value="600" />
</Section>
```

<span data-ttu-id="865d9-142">värdbaserade kluster via ClusterConfig.json för fristående distributioner eller Template.json för Azure:</span><span class="sxs-lookup"><span data-stu-id="865d9-142">via ClusterConfig.json for Standalone deployments or Template.json for Azure hosted clusters:</span></span>

```json
"fabricSettings": [
  {
    "name": "PlacementAndLoadBalancing",
    "parameters": [
      {
          "name": "GlobalMovementThrottleThresholdPercentage",
          "value": "0.0"
      },
      {
          "name": "GlobalMovementThrottleThresholdPercentageForPlacement",
          "value": "0.0"
      },
      {
          "name": "GlobalMovementThrottleThresholdPercentageForBalancing",
          "value": "0.0"
      },
      {
          "name": "GlobalMovementThrottleCountingInterval",
          "value": "600"
      }
    ]
  }
]
```

### <a name="default-count-based-throttles"></a><span data-ttu-id="865d9-143">Standard antal baserat begränsningar</span><span class="sxs-lookup"><span data-stu-id="865d9-143">Default count based throttles</span></span>
<span data-ttu-id="865d9-144">Den här informationen anges om du har äldre kluster eller fortfarande behålla dessa konfigurationer i kluster som sedan har uppgraderats.</span><span class="sxs-lookup"><span data-stu-id="865d9-144">This information is provided in case you have older clusters or still retain these configurations in clusters that have since been upgraded.</span></span> <span data-ttu-id="865d9-145">I allmänhet rekommenderar vi att dessa ersätts med hello procent-baserade begränsas ovan.</span><span class="sxs-lookup"><span data-stu-id="865d9-145">In general, it is recommended that these are replaced with hello percentage-based throttles above.</span></span> <span data-ttu-id="865d9-146">Eftersom procent-baserade begränsning är inaktiverad som standard är dessa begränsningar hello standard begränsningar för ett kluster tills de är inaktiverade och ersätts med hello procent-baserade begränsas.</span><span class="sxs-lookup"><span data-stu-id="865d9-146">Since percentage-based throttling is disabled by default, these throttles remain hello default throttles for a cluster until they are disabled and replaced with hello percentage-based throttles.</span></span> 

  - <span data-ttu-id="865d9-147">GlobalMovementThrottleThreshold – den här inställningen styr hello Totalt antal förflyttningar i hello kluster över tid.</span><span class="sxs-lookup"><span data-stu-id="865d9-147">GlobalMovementThrottleThreshold – this setting controls hello total number of movements in hello cluster over some time.</span></span> <span data-ttu-id="865d9-148">hello mängden tid har angetts i sekunder som hello GlobalMovementThrottleCountingInterval.</span><span class="sxs-lookup"><span data-stu-id="865d9-148">hello amount of time is specified in seconds as hello GlobalMovementThrottleCountingInterval.</span></span> <span data-ttu-id="865d9-149">hello standardvärdet för hello GlobalMovementThrottleThreshold är 1000 och hello standardvärdet för hello GlobalMovementThrottleCountingInterval är 600.</span><span class="sxs-lookup"><span data-stu-id="865d9-149">hello default value for hello GlobalMovementThrottleThreshold is 1000 and hello default value for hello GlobalMovementThrottleCountingInterval is 600.</span></span>
  - <span data-ttu-id="865d9-150">MovementPerPartitionThrottleThreshold – den här inställningen styr hello Totalt antal förflyttningar för alla partitioner för tjänsten över tid.</span><span class="sxs-lookup"><span data-stu-id="865d9-150">MovementPerPartitionThrottleThreshold – this setting controls hello total number of movements for any service partition over some time.</span></span> <span data-ttu-id="865d9-151">hello mängden tid har angetts i sekunder som hello MovementPerPartitionThrottleCountingInterval.</span><span class="sxs-lookup"><span data-stu-id="865d9-151">hello amount of time is specified in seconds as hello MovementPerPartitionThrottleCountingInterval.</span></span> <span data-ttu-id="865d9-152">hello standardvärdet för hello MovementPerPartitionThrottleThreshold är 50 och hello standardvärdet för hello MovementPerPartitionThrottleCountingInterval är 600.</span><span class="sxs-lookup"><span data-stu-id="865d9-152">hello default value for hello MovementPerPartitionThrottleThreshold is 50 and hello default value for hello MovementPerPartitionThrottleCountingInterval is 600.</span></span>

<span data-ttu-id="865d9-153">hello-konfiguration för dessa begränsningar följer samma mönster som hello procent-baserade begränsning hello.</span><span class="sxs-lookup"><span data-stu-id="865d9-153">hello configuration for these throttles follows hello same pattern as hello percentage-based throttling.</span></span>

## <a name="next-steps"></a><span data-ttu-id="865d9-154">Nästa steg</span><span class="sxs-lookup"><span data-stu-id="865d9-154">Next steps</span></span>
- <span data-ttu-id="865d9-155">toofind ut om hur hello klustret Resource Manager hanterar och balanserar belastningen i hello kluster kolla hello artikel på [belastningsutjämning](service-fabric-cluster-resource-manager-balancing.md)</span><span class="sxs-lookup"><span data-stu-id="865d9-155">toofind out about how hello Cluster Resource Manager manages and balances load in hello cluster, check out hello article on [balancing load](service-fabric-cluster-resource-manager-balancing.md)</span></span>
- <span data-ttu-id="865d9-156">hello klustret Resource Manager har många alternativ för att beskriva hello klustret.</span><span class="sxs-lookup"><span data-stu-id="865d9-156">hello Cluster Resource Manager has many options for describing hello cluster.</span></span> <span data-ttu-id="865d9-157">toofind mer information om dem, Kolla in den här artikeln på [som beskriver ett Service Fabric-kluster](service-fabric-cluster-resource-manager-cluster-description.md)</span><span class="sxs-lookup"><span data-stu-id="865d9-157">toofind out more about them, check out this article on [describing a Service Fabric cluster](service-fabric-cluster-resource-manager-cluster-description.md)</span></span>
