---
title: "Felsöka Azure mikrotjänster i Windows | Microsoft Docs"
description: "Lär dig mer om att övervaka och diagnostisera dina tjänster som skrivits med Microsoft Azure Service Fabric på en dator för lokal utveckling."
services: service-fabric
documentationcenter: .net
author: dkkapur
manager: timlt
editor: 
ms.assetid: edcc0631-ed2d-45a3-851d-2c4fa0f4a326
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 04/24/2017
ms.author: dekapur
ms.openlocfilehash: 08998340afb2f242b9a268331607b0d1ddb9b0c6
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 07/11/2017
---
# <a name="monitor-and-diagnose-services-in-a-local-machine-development-setup"></a><span data-ttu-id="efcef-103">Övervaka och diagnostisera tjänster i en inställning för utveckling av lokal dator</span><span class="sxs-lookup"><span data-stu-id="efcef-103">Monitor and diagnose services in a local machine development setup</span></span>
> [!div class="op_single_selector"]
> * [<span data-ttu-id="efcef-104">Windows</span><span class="sxs-lookup"><span data-stu-id="efcef-104">Windows</span></span>](service-fabric-diagnostics-how-to-monitor-and-diagnose-services-locally.md)
> * [<span data-ttu-id="efcef-105">Linux</span><span class="sxs-lookup"><span data-stu-id="efcef-105">Linux</span></span>](service-fabric-diagnostics-how-to-monitor-and-diagnose-services-locally-linux.md)
> 
> 

<span data-ttu-id="efcef-106">Övervaka, identifiera, diagnostisera och felsöka Tillåt för tjänster att fortsätta med minimala störningar för användarupplevelsen.</span><span class="sxs-lookup"><span data-stu-id="efcef-106">Monitoring, detecting, diagnosing, and troubleshooting allow for services to continue with minimal disruption to the user experience.</span></span> <span data-ttu-id="efcef-107">Övervakning och diagnostik är viktiga i en verklig distribuerade produktionsmiljön, beror effektiviteten på införandet av en liknande modell under utvecklingen av tjänster så att de fungerar när du flyttar till en verklig installation.</span><span class="sxs-lookup"><span data-stu-id="efcef-107">While monitoring and diagnostics are critical in an actual deployed production environment, the efficiency will depend on adopting a similar model during development of services to ensure they work when you move to a real-world setup.</span></span> <span data-ttu-id="efcef-108">Service Fabric gör det enkelt för tjänstutvecklare att implementera diagnostik fungerar sömlöst över både inställningar för enskild dator lokal utveckling och produktion verkliga klustret installationsprogram.</span><span class="sxs-lookup"><span data-stu-id="efcef-108">Service Fabric makes it easy for service developers to implement diagnostics that can seamlessly work across both single-machine local development setups and real-world production cluster setups.</span></span>

## <a name="event-tracing-for-windows"></a><span data-ttu-id="efcef-109">Händelsespårning för Windows</span><span class="sxs-lookup"><span data-stu-id="efcef-109">Event Tracing for Windows</span></span>
<span data-ttu-id="efcef-110">[Event Tracing for Windows](https://msdn.microsoft.com/library/windows/desktop/bb968803.aspx) (ETW) är den rekommenderade tekniken för spårning av meddelanden i Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="efcef-110">[Event Tracing for Windows](https://msdn.microsoft.com/library/windows/desktop/bb968803.aspx) (ETW) is the recommended technology for tracing messages in Service Fabric.</span></span> <span data-ttu-id="efcef-111">Några av fördelarna med att använda ETW är:</span><span class="sxs-lookup"><span data-stu-id="efcef-111">Some benefits of using ETW are:</span></span>

* <span data-ttu-id="efcef-112">**ETW är snabbt.**</span><span class="sxs-lookup"><span data-stu-id="efcef-112">**ETW is fast.**</span></span> <span data-ttu-id="efcef-113">Det har skapats som en spårning-teknik som har minimal inverkan på koden körningstider.</span><span class="sxs-lookup"><span data-stu-id="efcef-113">It was built as a tracing technology that has minimal impact on code execution times.</span></span>
* <span data-ttu-id="efcef-114">**ETW-spårning fungerar sömlöst över lokala utvecklingsmiljöer och verkliga klustret inställningar.**</span><span class="sxs-lookup"><span data-stu-id="efcef-114">**ETW tracing works seamlessly across local development environments and also real-world cluster setups.**</span></span> <span data-ttu-id="efcef-115">Det innebär att du inte behöver skriva om koden och spårning när du är redo att distribuera din kod till verkliga klustret.</span><span class="sxs-lookup"><span data-stu-id="efcef-115">This  means you don't have to rewrite your tracing code when you are ready to deploy your code to a real cluster.</span></span>
* <span data-ttu-id="efcef-116">**Service Fabric system koden används även ETW för interna spårning.**</span><span class="sxs-lookup"><span data-stu-id="efcef-116">**Service Fabric system code also uses ETW for internal tracing.**</span></span> <span data-ttu-id="efcef-117">På så sätt kan du visa programspårningar överlagrat med Service Fabric system spårningar.</span><span class="sxs-lookup"><span data-stu-id="efcef-117">This allows you to view your application traces interleaved with Service Fabric system traces.</span></span> <span data-ttu-id="efcef-118">Det hjälper dig också att lättare förstå sekvenser och relationer mellan din programkod och händelser i det underliggande systemet.</span><span class="sxs-lookup"><span data-stu-id="efcef-118">It also helps you to more easily understand the sequences and interrelationships between your application code and events in the underlying system.</span></span>
* <span data-ttu-id="efcef-119">**Det finns inbyggt stöd i Visual Studio för Service Fabric-verktyg för att visa ETW-händelser.**</span><span class="sxs-lookup"><span data-stu-id="efcef-119">**There is built-in support in Service Fabric Visual Studio tools to view ETW events.**</span></span> <span data-ttu-id="efcef-120">ETW-händelser som visas i vyn diagnostiska händelser i Visual Studio när Visual Studio är korrekt konfigurerad med Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="efcef-120">ETW events appear in the Diagnostic Events view of Visual Studio once Visual Studio is correctly configured with Service Fabric.</span></span> 

## <a name="view-service-fabric-system-events-in-visual-studio"></a><span data-ttu-id="efcef-121">Visa händelser för Service Fabric-system i Visual Studio</span><span class="sxs-lookup"><span data-stu-id="efcef-121">View Service Fabric system events in Visual Studio</span></span>
<span data-ttu-id="efcef-122">Service Fabric avger ETW-händelser för att förstå vad som händer i plattformen för programutvecklare.</span><span class="sxs-lookup"><span data-stu-id="efcef-122">Service Fabric emits ETW events to help application developers understand what's happening in the platform.</span></span> <span data-ttu-id="efcef-123">Om du inte redan gjort det. Gå vidare och följ stegen i [skapa ditt första program i Visual Studio](service-fabric-create-your-first-application-in-visual-studio.md).</span><span class="sxs-lookup"><span data-stu-id="efcef-123">If you haven't already done so, go ahead and follow the steps in [Creating your first application in Visual Studio](service-fabric-create-your-first-application-in-visual-studio.md).</span></span> <span data-ttu-id="efcef-124">Den här informationen hjälper dig att få ett program körs med diagnostik Loggboken visar trace-meddelanden.</span><span class="sxs-lookup"><span data-stu-id="efcef-124">This information will help you get an application up and running with the Diagnostics Events Viewer showing the trace messages.</span></span>

1. <span data-ttu-id="efcef-125">Om diagnostik händelser fönster inte visas automatiskt, går till den **visa** i Visual Studio, Välj **andra fönster** och sedan **diagnostiska Loggboken**.</span><span class="sxs-lookup"><span data-stu-id="efcef-125">If the diagnostics events window does not automatically show, Go to the **View** tab in Visual Studio, choose **Other Windows** and then **Diagnostic Events Viewer**.</span></span>
2. <span data-ttu-id="efcef-126">Varje händelse har standard metadatainformation om den noden, program och tjänsten händelsen kommer från.</span><span class="sxs-lookup"><span data-stu-id="efcef-126">Each event has standard metadata information that tells you the node, application and service the event is coming from.</span></span> <span data-ttu-id="efcef-127">Du kan också filtrera listan över händelser med hjälp av den **Filtrera händelser** rutan längst upp i fönstret händelser.</span><span class="sxs-lookup"><span data-stu-id="efcef-127">You can also filter the list of events by using the **Filter events** box at the top of the events window.</span></span> <span data-ttu-id="efcef-128">Du kan till exempel filtrera på **nodnamnet** eller **tjänstnamn.**</span><span class="sxs-lookup"><span data-stu-id="efcef-128">For example, you can filter on **Node Name** or **Service Name.**</span></span> <span data-ttu-id="efcef-129">Och när du tittar på händelseinformationen, du kan också pausa med hjälp av den **pausa** längst upp i fönstret händelser och återuppta senare utan att förlora händelser.</span><span class="sxs-lookup"><span data-stu-id="efcef-129">And when you're looking at event details, you can also pause by using the **Pause** button at the top of the events window and resume later without any loss of events.</span></span>
   
   ![Visual Studio diagnostik Loggboken](./media/service-fabric-diagnostics-how-to-monitor-and-diagnose-services-locally/DiagEventsExamples2.png)

## <a name="add-your-own-custom-traces-to-the-application-code"></a><span data-ttu-id="efcef-131">Lägg till dina egna anpassade spår i programkoden</span><span class="sxs-lookup"><span data-stu-id="efcef-131">Add your own custom traces to the application code</span></span>
<span data-ttu-id="efcef-132">Service Fabric Visual Studio-projektmallar innehåller exempelkod.</span><span class="sxs-lookup"><span data-stu-id="efcef-132">The Service Fabric Visual Studio project templates contain sample code.</span></span> <span data-ttu-id="efcef-133">Koden visar hur du lägger till anpassad kod ETW programspårningar som visas i visningsprogrammet för Visual Studio ETW tillsammans med system spår från Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="efcef-133">The code shows how to add custom application code ETW traces that show up in the Visual Studio ETW viewer alongside system traces from Service Fabric.</span></span> <span data-ttu-id="efcef-134">Fördelen med den här metoden är att metadata läggs automatiskt till spårningar och av Visual Studio diagnostiska Loggboken har redan konfigurerats för att visa dem..</span><span class="sxs-lookup"><span data-stu-id="efcef-134">The advantage of this method is that metadata is automatically added to traces, and the Visual Studio Diagnostic Events Viewer is already configured to display them.</span></span>

<span data-ttu-id="efcef-135">För projekt som skapas från den **tjänstmallar** (tillståndslösa och tillståndskänsliga) bara söka efter den `RunAsync` implementering:</span><span class="sxs-lookup"><span data-stu-id="efcef-135">For projects created from the **service templates** (stateless or stateful) just search for the `RunAsync` implementation:</span></span>

1. <span data-ttu-id="efcef-136">Anropet till `ServiceEventSource.Current.ServiceMessage` i den `RunAsync` metoden visar ett exempel på en anpassad ETW-spårning från programkoden.</span><span class="sxs-lookup"><span data-stu-id="efcef-136">The call to `ServiceEventSource.Current.ServiceMessage` in the `RunAsync` method shows an example of a custom ETW trace from the application code.</span></span>
2. <span data-ttu-id="efcef-137">I den **ServiceEventSource.cs** filen hittar du en överlagring för den `ServiceEventSource.ServiceMessage` metod som ska användas för hög frekvens händelser på grund av prestandaskäl.</span><span class="sxs-lookup"><span data-stu-id="efcef-137">In the **ServiceEventSource.cs** file, you will find an overload for the `ServiceEventSource.ServiceMessage` method that should be used for high-frequency events due to performance reasons.</span></span>

<span data-ttu-id="efcef-138">För projekt som skapas från den **aktören mallar** (tillståndslösa och tillståndskänsliga):</span><span class="sxs-lookup"><span data-stu-id="efcef-138">For projects created from the **actor templates** (stateless or stateful):</span></span>

1. <span data-ttu-id="efcef-139">Öppna den **”projektnamn” .cs** filen var *projektnamn* är det namn du angav för Visual Studio-projekt.</span><span class="sxs-lookup"><span data-stu-id="efcef-139">Open the **"ProjectName".cs** file where *ProjectName* is the name you chose for your Visual Studio project.</span></span>  
2. <span data-ttu-id="efcef-140">Sök efter koden `ActorEventSource.Current.ActorMessage(this, "Doing Work");` i den *DoWorkAsync* metod.</span><span class="sxs-lookup"><span data-stu-id="efcef-140">Find the code `ActorEventSource.Current.ActorMessage(this, "Doing Work");` in the *DoWorkAsync* method.</span></span>  <span data-ttu-id="efcef-141">Detta är ett exempel på en anpassad ETW-spårning som skrivs från programkod.</span><span class="sxs-lookup"><span data-stu-id="efcef-141">This is an example of a custom ETW trace written from application code.</span></span>  
3. <span data-ttu-id="efcef-142">I filen **ActorEventSource.cs**, hittar du en överlagring för den `ActorEventSource.ActorMessage` metod som ska användas för hög frekvens händelser på grund av prestandaskäl.</span><span class="sxs-lookup"><span data-stu-id="efcef-142">In file **ActorEventSource.cs**, you will find an overload for the `ActorEventSource.ActorMessage` method that should be used for high-frequency events due to performance reasons.</span></span>

<span data-ttu-id="efcef-143">När du lägger till anpassade ETW-spårning i koden för tjänsten, kan du skapa, distribuera och kör programmet igen för att se din händelse(r) i visningsprogrammet diagnostiska händelser.</span><span class="sxs-lookup"><span data-stu-id="efcef-143">After adding custom ETW tracing to your service code, you can build, deploy, and run the application again to see your event(s) in the Diagnostic Events Viewer.</span></span> <span data-ttu-id="efcef-144">Om du felsöker programmet med **F5**, av diagnostiska Loggboken öppnas automatiskt.</span><span class="sxs-lookup"><span data-stu-id="efcef-144">If you debug the application with **F5**, the Diagnostic Events Viewer will open automatically.</span></span>

## <a name="next-steps"></a><span data-ttu-id="efcef-145">Nästa steg</span><span class="sxs-lookup"><span data-stu-id="efcef-145">Next steps</span></span>
<span data-ttu-id="efcef-146">Samma spårning kod som du lagt till ditt program ovan för lokala diagnostik fungerar med verktyg som du kan använda för att visa dessa händelser när du kör programmet på ett Azure-kluster.</span><span class="sxs-lookup"><span data-stu-id="efcef-146">The same tracing code that you added to your application above for local diagnostics will work with tools that you can use to view these events when running your application on an Azure cluster.</span></span> <span data-ttu-id="efcef-147">Gå igenom dessa artiklar som beskrivs de olika alternativen för verktyg och beskriver hur du kan konfigurera dem.</span><span class="sxs-lookup"><span data-stu-id="efcef-147">Check out these articles that discuss the different options for the tools and describe how you can set them up.</span></span>

* [<span data-ttu-id="efcef-148">Hur du samlar in loggar med Azure-diagnostik</span><span class="sxs-lookup"><span data-stu-id="efcef-148">How to collect logs with Azure Diagnostics</span></span>](service-fabric-diagnostics-how-to-setup-wad.md)
* [<span data-ttu-id="efcef-149">Aggregering av händelse och med EventFlow</span><span class="sxs-lookup"><span data-stu-id="efcef-149">Event aggregation and collection using EventFlow</span></span>](service-fabric-diagnostics-event-aggregation-eventflow.md)

