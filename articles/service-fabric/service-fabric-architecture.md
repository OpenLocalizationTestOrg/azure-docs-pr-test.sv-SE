---
title: Arkitekturen i Azure Service Fabric | Microsoft Docs
description: "Service Fabric är en plattform för distribuerade system som används för att skapa skalbara, tillförlitliga och enkelt hanteras program för molnet. Den här artikeln visar arkitekturen för Service Fabric."
services: service-fabric
documentationcenter: .net
author: rishirsinha
manager: timlt
editor: rishirsinha
ms.assetid: 6b554243-70cb-4c22-9b28-1a8b4703f45e
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 04/19/2017
ms.author: rsinha
ms.openlocfilehash: 3cf019bf9a08574c984e92985452df438f3eeb77
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 07/11/2017
---
# <a name="service-fabric-architecture"></a><span data-ttu-id="258f9-104">Arkitektur för Service Fabric</span><span class="sxs-lookup"><span data-stu-id="258f9-104">Service Fabric architecture</span></span>
<span data-ttu-id="258f9-105">Service Fabric bygger med överlappande undersystem.</span><span class="sxs-lookup"><span data-stu-id="258f9-105">Service Fabric is built with layered subsystems.</span></span> <span data-ttu-id="258f9-106">Dessa delsystem kan du skriva program som är:</span><span class="sxs-lookup"><span data-stu-id="258f9-106">These subsystems enable you to write applications that are:</span></span>

* <span data-ttu-id="258f9-107">Hög tillgänglighet</span><span class="sxs-lookup"><span data-stu-id="258f9-107">Highly available</span></span>
* <span data-ttu-id="258f9-108">Skalbar</span><span class="sxs-lookup"><span data-stu-id="258f9-108">Scalable</span></span>
* <span data-ttu-id="258f9-109">Hanterbara</span><span class="sxs-lookup"><span data-stu-id="258f9-109">Manageable</span></span>
* <span data-ttu-id="258f9-110">Kan testas</span><span class="sxs-lookup"><span data-stu-id="258f9-110">Testable</span></span>

<span data-ttu-id="258f9-111">Följande diagram visar viktiga undersystem för Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="258f9-111">The following diagram shows the major subsystems of Service Fabric.</span></span>

![Diagram över Service Fabric-arkitektur](media/service-fabric-architecture/service-fabric-architecture.png)

<span data-ttu-id="258f9-113">Möjligheten att säker kommunikation mellan noder i ett kluster är avgörande för ett distribuerat system.</span><span class="sxs-lookup"><span data-stu-id="258f9-113">In a distributed system, the ability to securely communicate between nodes in a cluster is crucial.</span></span> <span data-ttu-id="258f9-114">Basen för stacken är delsystemet transport, som tillhandahåller säker kommunikation mellan noder.</span><span class="sxs-lookup"><span data-stu-id="258f9-114">At the base of the stack is the transport subsystem, which provides secure communication between nodes.</span></span> <span data-ttu-id="258f9-115">Undersystemet ligger ovanför transporten undersystemet federation som kluster olika noder i en enda entitet (kallas kluster) så att Service Fabric kan identifiera fel, utföra ledande val och ger konsekvent routning.</span><span class="sxs-lookup"><span data-stu-id="258f9-115">Above the transport subsystem lies the federation subsystem, which clusters the different nodes into a single entity (named clusters) so that Service Fabric can detect failures, perform leader election, and provide consistent routing.</span></span> <span data-ttu-id="258f9-116">Undersystemet tillförlitlighet lager ovanpå undersystemet federation ansvarar för tillförlitligheten för Service Fabric-tjänster genom mekanismer som replikering, resurshantering och växling vid fel.</span><span class="sxs-lookup"><span data-stu-id="258f9-116">The reliability subsystem, layered on top of the federation subsystem, is responsible for the reliability of Service Fabric services through mechanisms such as replication, resource management, and failover.</span></span> <span data-ttu-id="258f9-117">Undersystemet federation för också delsystemet värd och aktivering, som hanterar livscykeln för ett program på en enda nod.</span><span class="sxs-lookup"><span data-stu-id="258f9-117">The federation subsystem also underlies the hosting and activation subsystem, which manages the lifecycle of an application on a single node.</span></span> <span data-ttu-id="258f9-118">Undersystem för nätverkshantering hanterar livscykeln för program och tjänster.</span><span class="sxs-lookup"><span data-stu-id="258f9-118">The management subsystem manages the lifecycle of applications and services.</span></span> <span data-ttu-id="258f9-119">Undersystemet datatillgång hjälper programutvecklare testa sina tjänster via simulerade fel före och efter distribution av program och tjänster till produktionsmiljöer.</span><span class="sxs-lookup"><span data-stu-id="258f9-119">The testability subsystem helps application developers test their services through simulated faults before and after deploying applications and services to production environments.</span></span> <span data-ttu-id="258f9-120">Service Fabric ger möjlighet att lösa tjänstplatserna via dess undersystemet för kommunikation.</span><span class="sxs-lookup"><span data-stu-id="258f9-120">Service Fabric provides the ability to resolve service locations through its communication subsystem.</span></span> <span data-ttu-id="258f9-121">Programmet programmeringsmodeller exponeras för utvecklare läggs ovanpå dessa delsystem tillsammans med programmodell att aktivera verktygsuppsättning.</span><span class="sxs-lookup"><span data-stu-id="258f9-121">The application programming models exposed to developers are layered on top of these subsystems along with the application model to enable tooling.</span></span>

## <a name="transport-subsystem"></a><span data-ttu-id="258f9-122">Transport-undersystemet</span><span class="sxs-lookup"><span data-stu-id="258f9-122">Transport subsystem</span></span>
<span data-ttu-id="258f9-123">Transport-undersystemet implementerar en point-to-point datagram kommunikationskanal.</span><span class="sxs-lookup"><span data-stu-id="258f9-123">The transport subsystem implements a point-to-point datagram communication channel.</span></span> <span data-ttu-id="258f9-124">Den här kanalen används för kommunikation inom service fabric-kluster och kommunikation mellan service fabric-kluster och klienter.</span><span class="sxs-lookup"><span data-stu-id="258f9-124">This channel is used for communication within service fabric clusters and communication between the service fabric cluster and clients.</span></span> <span data-ttu-id="258f9-125">Den stöder enkelriktade och request-reply-kommunikationsmönster som utgör grunden för att implementera broadcast och multicast i lagret för Federation.</span><span class="sxs-lookup"><span data-stu-id="258f9-125">It supports one-way and request-reply communication patterns, which provides the basis for implementing broadcast and multicast in the Federation layer.</span></span> <span data-ttu-id="258f9-126">Transport-undersystemet skyddar kommunikation med hjälp av X509 certifikat eller Windows-säkerhet.</span><span class="sxs-lookup"><span data-stu-id="258f9-126">The transport subsystem secures communication by using X509 certificates or Windows security.</span></span> <span data-ttu-id="258f9-127">Den här undersystemet används internt av Service Fabric och är inte direkt tillgänglig för utvecklare för programmering.</span><span class="sxs-lookup"><span data-stu-id="258f9-127">This subsystem is used internally by Service Fabric and is not directly accessible to developers for application programming.</span></span>

## <a name="federation-subsystem"></a><span data-ttu-id="258f9-128">Undersystemet för Federation</span><span class="sxs-lookup"><span data-stu-id="258f9-128">Federation subsystem</span></span>
<span data-ttu-id="258f9-129">Du måste ha en konsekvent vy av systemet för att kunna skäl om en uppsättning noder i ett distribuerat system.</span><span class="sxs-lookup"><span data-stu-id="258f9-129">In order to reason about a set of nodes in a distributed system, you need to have a consistent view of the system.</span></span> <span data-ttu-id="258f9-130">Undersystemet federation använder de kommunikation primitiver som tillhandahålls av undersystemet transport och häftar samman olika noder i ett enda enhetlig kluster som den kan skäl om.</span><span class="sxs-lookup"><span data-stu-id="258f9-130">The federation subsystem uses the communication primitives provided by the transport subsystem and stitches the various nodes into a single unified cluster that it can reason about.</span></span> <span data-ttu-id="258f9-131">Det ger de distribuerade system primitiver som krävs av andra delsystem - felidentifiering ledande val och konsekvent routning.</span><span class="sxs-lookup"><span data-stu-id="258f9-131">It provides the distributed systems primitives needed by the other subsystems - failure detection, leader election, and consistent routing.</span></span> <span data-ttu-id="258f9-132">Undersystemet federation bygger på distribuerade hash-tabeller med en 128-bitars token utrymme.</span><span class="sxs-lookup"><span data-stu-id="258f9-132">The federation subsystem is built on top of distributed hash tables with a 128-bit token space.</span></span> <span data-ttu-id="258f9-133">Undersystemet skapar en ringtopologi över noder, med varje nod i ringen som har tilldelats en delmängd av token utrymme för ägarskap.</span><span class="sxs-lookup"><span data-stu-id="258f9-133">The subsystem creates a ring topology over the nodes, with each node in the ring being allocated a subset of the token space for ownership.</span></span> <span data-ttu-id="258f9-134">För att upptäcka fel används en leasingmekanism baserat på hjärta beating och skiljedom.</span><span class="sxs-lookup"><span data-stu-id="258f9-134">For failure detection, the layer uses a leasing mechanism based on heart beating and arbitration.</span></span> <span data-ttu-id="258f9-135">Undersystemet federation garanterar även via invecklade koppling och avvikelse protokoll som en enda ägare av en token finns när som helst.</span><span class="sxs-lookup"><span data-stu-id="258f9-135">The federation subsystem also guarantees through intricate join and departure protocols that only a single owner of a token exists at any time.</span></span> <span data-ttu-id="258f9-136">Detta ger ledande val och konsekvent routning garantier.</span><span class="sxs-lookup"><span data-stu-id="258f9-136">This provides leader election and consistent routing guarantees.</span></span>

## <a name="reliability-subsystem"></a><span data-ttu-id="258f9-137">Tillförlitlighet undersystemet</span><span class="sxs-lookup"><span data-stu-id="258f9-137">Reliability subsystem</span></span>
<span data-ttu-id="258f9-138">Undersystemet tillförlitlighet tillhandahåller en mekanism för att kontrollera tillståndet för en tjänst för Service Fabric hög tillgänglighet med den *replikatorn*, *Failover Manager*, och *resurs Belastningsutjämnaren*.</span><span class="sxs-lookup"><span data-stu-id="258f9-138">The reliability subsystem provides the mechanism to make the state of a Service Fabric service highly available through the use of the *Replicator*, *Failover Manager*, and *Resource Balancer*.</span></span>

* <span data-ttu-id="258f9-139">Replikatorn säkerställer att tillståndsändringar i replikeringen primära tjänsten automatiskt ska replikeras till sekundära repliker underhålla konsekvensen mellan primära och sekundära repliker i en replikuppsättning för tjänsten.</span><span class="sxs-lookup"><span data-stu-id="258f9-139">The Replicator ensures that state changes in the primary service replica will automatically be replicated to secondary replicas, maintaining consistency between the primary and secondary replicas in a service replica set.</span></span> <span data-ttu-id="258f9-140">Replikatorn är ansvarig för kvorumhantering av repliker i uppsättningen.</span><span class="sxs-lookup"><span data-stu-id="258f9-140">The replicator is responsible for quorum management among the replicas in the replica set.</span></span> <span data-ttu-id="258f9-141">Den samverkar med redundansenhet att hämta listan över åtgärder för att replikera och omkonfiguration agenten ger den konfigurationen av replikuppsättningen.</span><span class="sxs-lookup"><span data-stu-id="258f9-141">It interacts with the failover unit to get the list of operations to replicate, and the reconfiguration agent provides it with the configuration of the replica set.</span></span> <span data-ttu-id="258f9-142">Denna konfiguration anger vilka åtgärder som måste replikeras repliker.</span><span class="sxs-lookup"><span data-stu-id="258f9-142">That configuration indicates which replicas the operations need to be replicated.</span></span> <span data-ttu-id="258f9-143">Service Fabric tillhandahåller en standard replikatorn kallas Fabric replikatorn som kan användas av Programmeringsgränssnitt för modellen för att kontrollera tjänstens tillstånd hög tillgänglighet och tillförlitlig.</span><span class="sxs-lookup"><span data-stu-id="258f9-143">Service Fabric provides a default replicator called Fabric Replicator, which can be used by the programming model API to make the service state highly available and reliable.</span></span>
* <span data-ttu-id="258f9-144">Failover Manager säkerställer att om noder läggs till i eller tas bort från klustret, omdistribueras belastningen automatiskt över tillgängliga noder.</span><span class="sxs-lookup"><span data-stu-id="258f9-144">The Failover Manager ensures that when nodes are added to or removed from the cluster, the load is automatically redistributed across the available nodes.</span></span> <span data-ttu-id="258f9-145">Om en nod i klustret inte klustret automatiskt att konfigurera tjänsten replikerna för att upprätthålla tillgänglighet.</span><span class="sxs-lookup"><span data-stu-id="258f9-145">If a node in the cluster fails, the cluster will automatically reconfigure the service replicas to maintain availability.</span></span>
* <span data-ttu-id="258f9-146">Resurshanteraren placerar service repliker över fel domän i klustret och ser till att alla redundansenheter är fungerar.</span><span class="sxs-lookup"><span data-stu-id="258f9-146">The Resource Manager places service replicas across failure domain in the cluster and ensures that all failover units are operational.</span></span> <span data-ttu-id="258f9-147">Resurshanteraren balanserar också serviceresurser i den underliggande delade poolen med klusternoder för att uppnå optimal uniform belastningsdistribution.</span><span class="sxs-lookup"><span data-stu-id="258f9-147">The Resource Manager also balances service resources across the underlying shared pool of cluster nodes to achieve optimal uniform load distribution.</span></span>

## <a name="management-subsystem"></a><span data-ttu-id="258f9-148">Undersystem för nätverkshantering</span><span class="sxs-lookup"><span data-stu-id="258f9-148">Management subsystem</span></span>
<span data-ttu-id="258f9-149">Undersystemet management ger slutpunkt till slutpunkt-tjänsten och Livscykelhantering för programmet.</span><span class="sxs-lookup"><span data-stu-id="258f9-149">The management subsystem provides end-to-end service and application lifecycle management.</span></span> <span data-ttu-id="258f9-150">PowerShell-cmdlets och administrativa API: er kan du etablera, distribuera, uppdatera, uppgradera och avetablera program utan förlust av tillgänglighet.</span><span class="sxs-lookup"><span data-stu-id="258f9-150">PowerShell cmdlets and administrative APIs enable you to provision, deploy, patch, upgrade, and de-provision applications without loss of availability.</span></span> <span data-ttu-id="258f9-151">Undersystem för nätverkshantering utför via följande tjänster.</span><span class="sxs-lookup"><span data-stu-id="258f9-151">The management subsystem performs this through the following services.</span></span>

* <span data-ttu-id="258f9-152">**Klusterhanterare**: Detta är den primära tjänsten som interagerar med Failover Manager från tillförlitlighet att placera programmen på noder baserat på placeringen för tjänsten.</span><span class="sxs-lookup"><span data-stu-id="258f9-152">**Cluster Manager**: This is the primary service that interacts with the Failover Manager from reliability to place the applications on the nodes based on the service placement constraints.</span></span> <span data-ttu-id="258f9-153">Hanteraren för filserverresurser i redundans undersystemet säkerställer att begränsningarna aldrig är bruten.</span><span class="sxs-lookup"><span data-stu-id="258f9-153">The Resource Manager in failover subsystem ensures that the constraints are never broken.</span></span> <span data-ttu-id="258f9-154">Klusterhanteraren hanterar livscykeln för programmen från etableras på avetablera.</span><span class="sxs-lookup"><span data-stu-id="258f9-154">The cluster manager manages the lifecycle of the applications from provision to de-provision.</span></span> <span data-ttu-id="258f9-155">Den kan integreras med hälsoindikatorn så att programmets tillgänglighet inte är förlorade ur semantiska hälsa under uppgraderingar.</span><span class="sxs-lookup"><span data-stu-id="258f9-155">It integrates with the health manager to ensure that application availability is not lost from a semantic health perspective during upgrades.</span></span>
* <span data-ttu-id="258f9-156">**Hälsoindikatorn**: den här tjänsten kan hälsoövervakning av program, tjänster och klustret entiteter.</span><span class="sxs-lookup"><span data-stu-id="258f9-156">**Health Manager**: This service enables health monitoring of applications, services, and cluster entities.</span></span> <span data-ttu-id="258f9-157">Kluster-enheter (till exempel noder, partitioner för tjänsten och repliker) kan rapportera hälsoinformation sedan samman i arkivet för centraliserad hälsa.</span><span class="sxs-lookup"><span data-stu-id="258f9-157">Cluster entities (such as nodes, service partitions, and replicas) can report health information, which is then aggregated into the centralized health store.</span></span> <span data-ttu-id="258f9-158">Den här hälsoinformation ger en övergripande i tidpunkt hälsa ögonblicksbild av tjänster och noder som distribueras över flera noder i klustret, så att du kan vidta eventuella nödvändiga åtgärder.</span><span class="sxs-lookup"><span data-stu-id="258f9-158">This health information provides an overall point-in-time health snapshot of the services and nodes distributed across multiple nodes in the cluster, enabling you to take any needed corrective actions.</span></span> <span data-ttu-id="258f9-159">Hälsotillstånd frågan API: er kan du fråga händelserna hälsotillstånd rapporteras till undersystemet hälsa.</span><span class="sxs-lookup"><span data-stu-id="258f9-159">Health query APIs enable you to query the health events reported to the health subsystem.</span></span> <span data-ttu-id="258f9-160">Hälsotillstånd frågan API: er returnera rådata hälsa data som lagras i health store eller aggregerad, tolkas hälsa data för ett specifikt kluster-enheten.</span><span class="sxs-lookup"><span data-stu-id="258f9-160">The health query APIs return the raw health data stored in the health store or the aggregated, interpreted health data for a specific cluster entity.</span></span>
* <span data-ttu-id="258f9-161">**Image Store**: den här tjänsten tillhandahåller lagring och distribution av binärfilerna för programmet.</span><span class="sxs-lookup"><span data-stu-id="258f9-161">**Image Store**: This service provides storage and distribution of the application binaries.</span></span> <span data-ttu-id="258f9-162">Den här tjänsten tillhandahåller en enkel distribuerade filarkivet där programmen har överförts till och hämtas från.</span><span class="sxs-lookup"><span data-stu-id="258f9-162">This service provides a simple distributed file store where the applications are uploaded to and downloaded from.</span></span>

## <a name="hosting-subsystem"></a><span data-ttu-id="258f9-163">Värd för undersystemet</span><span class="sxs-lookup"><span data-stu-id="258f9-163">Hosting subsystem</span></span>
<span data-ttu-id="258f9-164">Klusterhanteraren informerar värd undersystemet (som körs på varje nod) vilka tjänster som behövs för att hantera för en viss nod.</span><span class="sxs-lookup"><span data-stu-id="258f9-164">The cluster manager informs the hosting subsystem (running on each node) which services it needs to manage for a particular node.</span></span> <span data-ttu-id="258f9-165">Undersystemet värd sedan hanterar livscykeln för programmet på noden.</span><span class="sxs-lookup"><span data-stu-id="258f9-165">The hosting subsystem then manages the lifecycle of the application on that node.</span></span> <span data-ttu-id="258f9-166">Den kommunicerar med tillförlitlighet komponenterna så att replikerna är på rätt plats och att de är felfria.</span><span class="sxs-lookup"><span data-stu-id="258f9-166">It interacts with the reliability and health components to ensure that the replicas are properly placed and are healthy.</span></span>

## <a name="communication-subsystem"></a><span data-ttu-id="258f9-167">Undersystemet för kommunikation</span><span class="sxs-lookup"><span data-stu-id="258f9-167">Communication subsystem</span></span>
<span data-ttu-id="258f9-168">Den här undersystemet erbjuder tillförlitlig meddelandehantering inom klustret och service discovery via Naming service.</span><span class="sxs-lookup"><span data-stu-id="258f9-168">This subsystem provides reliable messaging within the cluster and service discovery through the Naming service.</span></span> <span data-ttu-id="258f9-169">Tjänsten Naming matchar tjänstnamn till en plats i klustret och gör att användarna kan hantera tjänstnamn och egenskaper.</span><span class="sxs-lookup"><span data-stu-id="258f9-169">The Naming service resolves service names to a location in the cluster and enables users to manage service names and properties.</span></span> <span data-ttu-id="258f9-170">Med tjänsten Naming kommunicera klienter på ett säkert sätt med en nod i klustret för att lösa ett tjänstnamn och hämta service metadata.</span><span class="sxs-lookup"><span data-stu-id="258f9-170">Using the Naming service, clients can securely communicate with any node in the cluster to resolve a service name and retrieve service metadata.</span></span> <span data-ttu-id="258f9-171">Med en enkel Naming klient API kan utveckla användare av Service Fabric tjänster och klienter som kan lösa klientens aktuella nätverksplats trots nod dynamik eller nytt storlek i klustret.</span><span class="sxs-lookup"><span data-stu-id="258f9-171">Using a simple Naming client API, users of Service Fabric can develop services and clients capable of resolving the current network location despite node dynamism or the re-sizing of the cluster.</span></span>

## <a name="testability-subsystem"></a><span data-ttu-id="258f9-172">Möjlighet att testa undersystemet</span><span class="sxs-lookup"><span data-stu-id="258f9-172">Testability subsystem</span></span>
<span data-ttu-id="258f9-173">Möjlighet att testa är en uppsättning med verktyg som utformats för att testa tjänster som bygger på Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="258f9-173">Testability is a suite of tools specifically designed for testing services built on Service Fabric.</span></span> <span data-ttu-id="258f9-174">Verktygen kan utvecklare enkelt medföra meningsfulla fel och kör testscenarier att utöva och validera ett stort antal tillstånd och övergångar som en tjänst får under dess livslängd i en kontrollerad och säkert sätt.</span><span class="sxs-lookup"><span data-stu-id="258f9-174">The tools let a developer easily induce meaningful faults and run test scenarios to exercise and validate the numerous states and transitions that a service will experience throughout its lifetime, all in a controlled and safe manner.</span></span> <span data-ttu-id="258f9-175">Möjlighet att testa innehåller också en mekanism för att köra längre tester som kan iterera via olika möjliga fel utan att förlora tillgänglighet.</span><span class="sxs-lookup"><span data-stu-id="258f9-175">Testability also provides a mechanism to run longer tests that can iterate through various possible failures without losing availability.</span></span> <span data-ttu-id="258f9-176">Detta ger dig testa i produktionsmiljö.</span><span class="sxs-lookup"><span data-stu-id="258f9-176">This provides you with a test-in-production environment.</span></span>

