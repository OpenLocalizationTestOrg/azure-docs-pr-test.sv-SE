---
title: "aaaHealth övervakning i Service Fabric | Microsoft Docs"
description: "En introduktion toohello Azure Service Fabric hälsoövervakning modell, som ger övervakning av hello klustret och dess program och tjänster."
services: service-fabric
documentationcenter: .net
author: oanapl
manager: timlt
editor: 
ms.assetid: 1d979210-b1eb-4022-be24-799fd9d8e003
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 07/19/2017
ms.author: oanapl
ms.openlocfilehash: 904f36374ca6ca7e4caa1d43c92584e7e4c50087
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 10/06/2017
---
# <a name="introduction-tooservice-fabric-health-monitoring"></a><span data-ttu-id="2af0c-103">Introduktion tooService Fabric-hälsoövervakning</span><span class="sxs-lookup"><span data-stu-id="2af0c-103">Introduction tooService Fabric health monitoring</span></span>
<span data-ttu-id="2af0c-104">Azure Service Fabric introducerar en hälsomodell som ger omfattande, flexibla och utökningsbara hälsoutvärderingen och rapportering.</span><span class="sxs-lookup"><span data-stu-id="2af0c-104">Azure Service Fabric introduces a health model that provides rich, flexible, and extensible health evaluation and reporting.</span></span> <span data-ttu-id="2af0c-105">hello modellen tillåter nära realtid övervakning av hello tillståndet för hello kluster och hello-tjänster som körs i den.</span><span class="sxs-lookup"><span data-stu-id="2af0c-105">hello model allows near-real-time monitoring of hello state of hello cluster and hello services running in it.</span></span> <span data-ttu-id="2af0c-106">Du kan lätt få information om hälsa och rätta potentiella problem innan de sprids och orsaka massiv avbrott.</span><span class="sxs-lookup"><span data-stu-id="2af0c-106">You can easily obtain health information and correct potential issues before they cascade and cause massive outages.</span></span> <span data-ttu-id="2af0c-107">I vanliga modellen hello samman services skicka rapporter baserat på deras lokala vyer och att informationen är tooprovide en övergripande klusternivå vy.</span><span class="sxs-lookup"><span data-stu-id="2af0c-107">In hello typical model, services send reports based on their local views, and that information is aggregated tooprovide an overall cluster-level view.</span></span>

<span data-ttu-id="2af0c-108">Service Fabric-komponenter använder den här omfattande hälsa modellen tooreport det aktuella tillståndet.</span><span class="sxs-lookup"><span data-stu-id="2af0c-108">Service Fabric components use this rich health model tooreport their current state.</span></span> <span data-ttu-id="2af0c-109">Du kan använda hello samma mekanism tooreport hälsa från dina program.</span><span class="sxs-lookup"><span data-stu-id="2af0c-109">You can use hello same mechanism tooreport health from your applications.</span></span> <span data-ttu-id="2af0c-110">Om du investerar i hög kvalitet hälsa reporting som samlar in din anpassade villkor kan du identifiera och åtgärda problem för tillämpningsprogrammet körs mycket enklare.</span><span class="sxs-lookup"><span data-stu-id="2af0c-110">If you invest in high-quality health reporting that captures your custom conditions, you can detect and fix issues for your running application much more easily.</span></span>

<span data-ttu-id="2af0c-111">hello följande Microsoft Virtual Academy videon beskrivs också hello Service Fabric-hälsomodell och hur de används:<center><a target="_blank" href="https://mva.microsoft.com/training-courses/building-microservices-applications-on-azure-service-fabric-16747?l=tevZw56yC_1906218965">
<img src="./media/service-fabric-health-introduction/HealthIntroVid.png" WIDTH="360" HEIGHT="244">
</a></center></span><span class="sxs-lookup"><span data-stu-id="2af0c-111">hello following Microsoft Virtual Academy video also describes hello Service Fabric health model and how it's used: <center><a target="_blank" href="https://mva.microsoft.com/training-courses/building-microservices-applications-on-azure-service-fabric-16747?l=tevZw56yC_1906218965">
<img src="./media/service-fabric-health-introduction/HealthIntroVid.png" WIDTH="360" HEIGHT="244">
</a></center></span></span>

> [!NOTE]
> <span data-ttu-id="2af0c-112">Vi har startats hello hälsa undersystemet tooaddress behovet av övervakade uppgraderingar.</span><span class="sxs-lookup"><span data-stu-id="2af0c-112">We started hello health subsystem tooaddress a need for monitored upgrades.</span></span> <span data-ttu-id="2af0c-113">Service Fabric ger övervakade program och kluster uppgraderingar som säkerställa fullständig tillgänglighet, utan driftstopp och minimala toono åtgärder från användaren.</span><span class="sxs-lookup"><span data-stu-id="2af0c-113">Service Fabric provides monitored application and cluster upgrades that ensure full availability, no downtime and minimal toono user intervention.</span></span> <span data-ttu-id="2af0c-114">tooachieve dessa mål hello uppgradering kontrollerar hälsotillstånd baserat på konfigurerad uppgradera principer.</span><span class="sxs-lookup"><span data-stu-id="2af0c-114">tooachieve these goals, hello upgrade checks health based on configured upgrade policies.</span></span> <span data-ttu-id="2af0c-115">En uppgradering kan fortsätta endast när hälsa respekterar önskade trösklar.</span><span class="sxs-lookup"><span data-stu-id="2af0c-115">An upgrade can proceed only when health respects desired thresholds.</span></span> <span data-ttu-id="2af0c-116">Annars hello uppgraderingen automatiskt återställs antingen eller pausats toogive administratörer en chansen toofix hello problem.</span><span class="sxs-lookup"><span data-stu-id="2af0c-116">Otherwise, hello upgrade is either automatically rolled back or paused toogive administrators a chance toofix hello issues.</span></span> <span data-ttu-id="2af0c-117">toolearn mer om programmet uppgraderingar finns [i den här artikeln](service-fabric-application-upgrade.md).</span><span class="sxs-lookup"><span data-stu-id="2af0c-117">toolearn more about application upgrades, see [this article](service-fabric-application-upgrade.md).</span></span>
> 
> 

## <a name="health-store"></a><span data-ttu-id="2af0c-118">Hälsoarkivet</span><span class="sxs-lookup"><span data-stu-id="2af0c-118">Health store</span></span>
<span data-ttu-id="2af0c-119">Hej hälsoarkivet behåller hälsorelaterade information om entiteter i hello kluster för enkel hämtning och utvärdering.</span><span class="sxs-lookup"><span data-stu-id="2af0c-119">hello health store keeps health-related information about entities in hello cluster for easy retrieval and evaluation.</span></span> <span data-ttu-id="2af0c-120">Det implementeras som en Service Fabric beständiga tillståndskänslig service tooensure hög tillgänglighet och skalbarhet.</span><span class="sxs-lookup"><span data-stu-id="2af0c-120">It is implemented as a Service Fabric persisted stateful service tooensure high availability and scalability.</span></span> <span data-ttu-id="2af0c-121">hello health store är en del av hello **fabric: / System** programmet och det är tillgängligt när hello klustret fungerar och körs.</span><span class="sxs-lookup"><span data-stu-id="2af0c-121">hello health store is part of hello **fabric:/System** application, and it is available when hello cluster is up and running.</span></span>

## <a name="health-entities-and-hierarchy"></a><span data-ttu-id="2af0c-122">Hälsotillstånd entiteter och hierarki</span><span class="sxs-lookup"><span data-stu-id="2af0c-122">Health entities and hierarchy</span></span>
<span data-ttu-id="2af0c-123">hello hälsa entiteter är ordnade i logiska hierarkin som samlar in interaktioner och beroenden mellan olika enheter.</span><span class="sxs-lookup"><span data-stu-id="2af0c-123">hello health entities are organized in a logical hierarchy that captures interactions and dependencies among different entities.</span></span> <span data-ttu-id="2af0c-124">Hej hälsoarkivet skapar automatiskt hälsa entiteter och hierarki baserat på rapporter som tagits emot från Service Fabric-komponenter.</span><span class="sxs-lookup"><span data-stu-id="2af0c-124">hello health store automatically builds health entities and hierarchy based on reports received from Service Fabric components.</span></span>

<span data-ttu-id="2af0c-125">hello hälsa entiteter spegla hello Service Fabric-enheter.</span><span class="sxs-lookup"><span data-stu-id="2af0c-125">hello health entities mirror hello Service Fabric entities.</span></span> <span data-ttu-id="2af0c-126">(Till exempel **hälsa programmet entiteten** matchar en programinstans distribuerat i hello kluster när **hälsa nod entiteten** matchar ett Service Fabric.) hello hälsa hierarkin samlar in hello interaktioner hello systementiteter och det är hello grunden för avancerade hälsoutvärderingen.</span><span class="sxs-lookup"><span data-stu-id="2af0c-126">(For example, **health application entity** matches an application instance deployed in hello cluster, while **health node entity** matches a Service Fabric cluster node.) hello health hierarchy captures hello interactions of hello system entities, and it is hello basis for advanced health evaluation.</span></span> <span data-ttu-id="2af0c-127">Du kan lära dig om nyckelbegrepp i Service Fabric [teknisk översikt för Service Fabric](service-fabric-technical-overview.md).</span><span class="sxs-lookup"><span data-stu-id="2af0c-127">You can learn about key Service Fabric concepts in [Service Fabric technical overview](service-fabric-technical-overview.md).</span></span> <span data-ttu-id="2af0c-128">Mer information om programmet finns [Service Fabric programmodell](service-fabric-application-model.md).</span><span class="sxs-lookup"><span data-stu-id="2af0c-128">For more on application, see [Service Fabric application model](service-fabric-application-model.md).</span></span>

<span data-ttu-id="2af0c-129">Tillåt hello kluster och program toobe effektivt rapporterade felsökas och övervakas hello hälsa entiteter och hierarkin.</span><span class="sxs-lookup"><span data-stu-id="2af0c-129">hello health entities and hierarchy allow hello cluster and applications toobe effectively reported, debugged, and monitored.</span></span> <span data-ttu-id="2af0c-130">Hej hälsomodell ger en rättvisande *detaljerade* representation av hello hälsotillstånd hello många flytta delar i hello kluster.</span><span class="sxs-lookup"><span data-stu-id="2af0c-130">hello health model provides an accurate, *granular* representation of hello health of hello many moving pieces in hello cluster.</span></span>

<span data-ttu-id="2af0c-131">![Enheter som hälsa.][1]</span><span class="sxs-lookup"><span data-stu-id="2af0c-131">![Health entities.][1]</span></span>
<span data-ttu-id="2af0c-132">hello hälsa entiteter, ordnad i en hierarki baserat på överordnade och underordnade relationer.</span><span class="sxs-lookup"><span data-stu-id="2af0c-132">hello health entities, organized in a hierarchy based on parent-child relationships.</span></span>

[1]: ./media/service-fabric-health-introduction/servicefabric-health-hierarchy.png

<span data-ttu-id="2af0c-133">hello hälsa entiteter är:</span><span class="sxs-lookup"><span data-stu-id="2af0c-133">hello health entities are:</span></span>

* <span data-ttu-id="2af0c-134">**Klustret**.</span><span class="sxs-lookup"><span data-stu-id="2af0c-134">**Cluster**.</span></span> <span data-ttu-id="2af0c-135">Representerar hello hälsotillståndet för ett Service Fabric-kluster.</span><span class="sxs-lookup"><span data-stu-id="2af0c-135">Represents hello health of a Service Fabric cluster.</span></span> <span data-ttu-id="2af0c-136">Klustret hälsorapporter beskrivs villkor som påverkar hello hela klustret.</span><span class="sxs-lookup"><span data-stu-id="2af0c-136">Cluster health reports describe conditions that affect hello entire cluster.</span></span> <span data-ttu-id="2af0c-137">Dessa villkor påverkar flera entiteter i hello kluster eller själva hello-klustret.</span><span class="sxs-lookup"><span data-stu-id="2af0c-137">These conditions affect multiple entities in hello cluster or hello cluster itself.</span></span> <span data-ttu-id="2af0c-138">Baserat på villkor hello kan inte hello rapport begränsa hello problemet ned tooone eller fler underordnade som ohälsosamt.</span><span class="sxs-lookup"><span data-stu-id="2af0c-138">Based on hello condition, hello reporter can't narrow hello issue down tooone or more unhealthy children.</span></span> <span data-ttu-id="2af0c-139">Exempel: hello hjärna hello kluster dela på grund av problem med toonetwork partitionering eller kommunikation.</span><span class="sxs-lookup"><span data-stu-id="2af0c-139">Examples include hello brain of hello cluster splitting due toonetwork partitioning or communication issues.</span></span>
* <span data-ttu-id="2af0c-140">**Noden**.</span><span class="sxs-lookup"><span data-stu-id="2af0c-140">**Node**.</span></span> <span data-ttu-id="2af0c-141">Representerar hello hälsotillståndet för en Service Fabric-nod.</span><span class="sxs-lookup"><span data-stu-id="2af0c-141">Represents hello health of a Service Fabric node.</span></span> <span data-ttu-id="2af0c-142">Noden hälsorapporter beskrivs villkor som påverkar hello nod funktioner.</span><span class="sxs-lookup"><span data-stu-id="2af0c-142">Node health reports describe conditions that affect hello node functionality.</span></span> <span data-ttu-id="2af0c-143">De vanligtvis påverkar alla distribuerade hello entiteter som körs på den.</span><span class="sxs-lookup"><span data-stu-id="2af0c-143">They typically affect all hello deployed entities running on it.</span></span> <span data-ttu-id="2af0c-144">Exempel är noden slut på diskutrymme (eller andra datoromfattande egenskaper, till exempel minne, anslutningar) och när en nod är nere.</span><span class="sxs-lookup"><span data-stu-id="2af0c-144">Examples include node out of disk space (or other machine-wide properties, such as memory, connections) and when a node is down.</span></span> <span data-ttu-id="2af0c-145">hello identifieras nod av hello-nodnamnet (sträng).</span><span class="sxs-lookup"><span data-stu-id="2af0c-145">hello node entity is identified by hello node name (string).</span></span>
* <span data-ttu-id="2af0c-146">**Programmet**.</span><span class="sxs-lookup"><span data-stu-id="2af0c-146">**Application**.</span></span> <span data-ttu-id="2af0c-147">Representerar hello hälsotillståndet för en programinstans som körs i hello kluster.</span><span class="sxs-lookup"><span data-stu-id="2af0c-147">Represents hello health of an application instance running in hello cluster.</span></span> <span data-ttu-id="2af0c-148">Programhälsan rapporter beskriver villkoren som påverkar hello övergripande hälsa för hello program.</span><span class="sxs-lookup"><span data-stu-id="2af0c-148">Application health reports describe conditions that affect hello overall health of hello application.</span></span> <span data-ttu-id="2af0c-149">De kan inte begränsas av tooindividual underordnade (tjänster eller distribuerade program).</span><span class="sxs-lookup"><span data-stu-id="2af0c-149">They can't be narrowed down tooindividual children (services or deployed applications).</span></span> <span data-ttu-id="2af0c-150">Exempel inkluderar hello slutpunkt till slutpunkt interaktion mellan olika tjänster i hello program.</span><span class="sxs-lookup"><span data-stu-id="2af0c-150">Examples include hello end-to-end interaction among different services in hello application.</span></span> <span data-ttu-id="2af0c-151">hello identifieras programmet genom hello programnamn (URI).</span><span class="sxs-lookup"><span data-stu-id="2af0c-151">hello application entity is identified by hello application name (URI).</span></span>
* <span data-ttu-id="2af0c-152">**Tjänsten**.</span><span class="sxs-lookup"><span data-stu-id="2af0c-152">**Service**.</span></span> <span data-ttu-id="2af0c-153">Representerar hello hälsotillståndet för en tjänst som körs i hello kluster.</span><span class="sxs-lookup"><span data-stu-id="2af0c-153">Represents hello health of a service running in hello cluster.</span></span> <span data-ttu-id="2af0c-154">Tjänstens hälsa rapporter beskriver villkoren som påverkar hello övergripande hälsa för hello-tjänsten.</span><span class="sxs-lookup"><span data-stu-id="2af0c-154">Service health reports describe conditions that affect hello overall health of hello service.</span></span> <span data-ttu-id="2af0c-155">hello rapport kan inte begränsa hello problemet tooan ohälsosamt partition eller replik.</span><span class="sxs-lookup"><span data-stu-id="2af0c-155">hello reporter can't narrow down hello issue tooan unhealthy partition or replica.</span></span> <span data-ttu-id="2af0c-156">Exempel är en tjänstkonfiguration (till exempel port eller externa filresurs) som orsakar problem för alla partitioner.</span><span class="sxs-lookup"><span data-stu-id="2af0c-156">Examples include a service configuration (such as port or external file share) that is causing issues for all partitions.</span></span> <span data-ttu-id="2af0c-157">hello identifieras-tjänsten av hello tjänstnamn (URI).</span><span class="sxs-lookup"><span data-stu-id="2af0c-157">hello service entity is identified by hello service name (URI).</span></span>
* <span data-ttu-id="2af0c-158">**Partitionen**.</span><span class="sxs-lookup"><span data-stu-id="2af0c-158">**Partition**.</span></span> <span data-ttu-id="2af0c-159">Representerar hello hälsotillståndet för en partition med tjänsten.</span><span class="sxs-lookup"><span data-stu-id="2af0c-159">Represents hello health of a service partition.</span></span> <span data-ttu-id="2af0c-160">Partitionen hälsorapporter beskrivs villkor som påverkar hello hela replikuppsättningen.</span><span class="sxs-lookup"><span data-stu-id="2af0c-160">Partition health reports describe conditions that affect hello entire replica set.</span></span> <span data-ttu-id="2af0c-161">Exempel: när hello antalet repliker är under målantalet och när en partition är förlorar kvorum.</span><span class="sxs-lookup"><span data-stu-id="2af0c-161">Examples include when hello number of replicas is below target count and when a partition is in quorum loss.</span></span> <span data-ttu-id="2af0c-162">hello identifieras partition av hello partitions-ID (GUID).</span><span class="sxs-lookup"><span data-stu-id="2af0c-162">hello partition entity is identified by hello partition ID (GUID).</span></span>
* <span data-ttu-id="2af0c-163">**Replik**.</span><span class="sxs-lookup"><span data-stu-id="2af0c-163">**Replica**.</span></span> <span data-ttu-id="2af0c-164">Representerar hello hälsotillståndet för en tillståndskänslig service replik eller en tillståndslös tjänstinstans.</span><span class="sxs-lookup"><span data-stu-id="2af0c-164">Represents hello health of a stateful service replica or a stateless service instance.</span></span> <span data-ttu-id="2af0c-165">hello replik är hello minsta enheten watchdogs och dess komponenter kan rapportera om för ett program.</span><span class="sxs-lookup"><span data-stu-id="2af0c-165">hello replica is hello smallest unit that watchdogs and system components can report on for an application.</span></span> <span data-ttu-id="2af0c-166">Exempel är en primär replik som det går inte att replikera operations toosecondaries och långsam replikering för tillståndskänsliga tjänster.</span><span class="sxs-lookup"><span data-stu-id="2af0c-166">For stateful services, examples include a primary replica that can't replicate operations toosecondaries and slow replication.</span></span> <span data-ttu-id="2af0c-167">Dessutom kan en tillståndslös instans rapportera när den har snart slut på resurser eller har problem med nätverksanslutningen.</span><span class="sxs-lookup"><span data-stu-id="2af0c-167">Also, a stateless instance can report when it is running out of resources or has connectivity issues.</span></span> <span data-ttu-id="2af0c-168">Hej replikeringsentitet identifieras av hello partitions-ID (GUID) och hello målrepliker eller instanser-ID (länge).</span><span class="sxs-lookup"><span data-stu-id="2af0c-168">hello replica entity is identified by hello partition ID (GUID) and hello replica or instance ID (long).</span></span>
* <span data-ttu-id="2af0c-169">**DeployedApplication**.</span><span class="sxs-lookup"><span data-stu-id="2af0c-169">**DeployedApplication**.</span></span> <span data-ttu-id="2af0c-170">Representerar hello hälsotillståndet för en *program som körs på en nod*.</span><span class="sxs-lookup"><span data-stu-id="2af0c-170">Represents hello health of an *application running on a node*.</span></span> <span data-ttu-id="2af0c-171">Distribuerade program hälsorapporter beskrivs villkor specifika toohello program på hello-nod som kan begränsas av tooservice paket som har distribuerats på hello samma nod.</span><span class="sxs-lookup"><span data-stu-id="2af0c-171">Deployed application health reports describe conditions specific toohello application on hello node that can't be narrowed down tooservice packages deployed on hello same node.</span></span> <span data-ttu-id="2af0c-172">Exempel: fel när programpaket inte kan hämtas på noden och problem med att ställa in programmet säkerhetsobjekt på hello-nod.</span><span class="sxs-lookup"><span data-stu-id="2af0c-172">Examples include errors when application package can't be downloaded on that node and issues setting up application security principals on hello node.</span></span> <span data-ttu-id="2af0c-173">hello distribuerade program identifieras av namn (URI) och nodnamnet (sträng).</span><span class="sxs-lookup"><span data-stu-id="2af0c-173">hello deployed application is identified by application name (URI) and node name (string).</span></span>
* <span data-ttu-id="2af0c-174">**DeployedServicePackage**.</span><span class="sxs-lookup"><span data-stu-id="2af0c-174">**DeployedServicePackage**.</span></span> <span data-ttu-id="2af0c-175">Representerar hello hälsotillståndet för ett tjänstepaket som körs på en nod i klustret hello.</span><span class="sxs-lookup"><span data-stu-id="2af0c-175">Represents hello health of a service package running on a node in hello cluster.</span></span> <span data-ttu-id="2af0c-176">Beskriver villkor specifika tooa service-paket som inte påverkar hello andra servicepaket på hello samma nod för hello samma program.</span><span class="sxs-lookup"><span data-stu-id="2af0c-176">It describes conditions specific tooa service package that do not affect hello other service packages on hello same node for hello same application.</span></span> <span data-ttu-id="2af0c-177">Exempel är en kodpaketet i hello service-paket som inte kan startas och ett konfigurationspaket som inte kan läsas.</span><span class="sxs-lookup"><span data-stu-id="2af0c-177">Examples include a code package in hello service package that cannot be started and a configuration package that cannot be read.</span></span> <span data-ttu-id="2af0c-178">hello distribuerat tjänstpaket identifieras av programnamn (URI), nodnamnet (sträng), manifestet tjänstnamn (sträng) och activation service paket-ID (sträng).</span><span class="sxs-lookup"><span data-stu-id="2af0c-178">hello deployed service package is identified by application name (URI), node name (string), service manifest name (string), and service package activation ID (string).</span></span>

<span data-ttu-id="2af0c-179">hello Granulariteten för hello hälsomodell gör det enkelt toodetect och åtgärda problem.</span><span class="sxs-lookup"><span data-stu-id="2af0c-179">hello granularity of hello health model makes it easy toodetect and correct issues.</span></span> <span data-ttu-id="2af0c-180">Till exempel om en tjänst inte svarar, är det möjligt tooreport som hello programinstansen är felfri.</span><span class="sxs-lookup"><span data-stu-id="2af0c-180">For example, if a service is not responding, it is feasible tooreport that hello application instance is unhealthy.</span></span> <span data-ttu-id="2af0c-181">Rapportering på att nivå inte är idealiskt, men eftersom hello problemet inte kanske påverkar alla hello tjänster i programmet.</span><span class="sxs-lookup"><span data-stu-id="2af0c-181">Reporting at that level is not ideal, however, because hello issue might not be affecting all hello services within that application.</span></span> <span data-ttu-id="2af0c-182">hello rapporten ska vara tillämpade toohello ohälsosamt service eller tooa specifika underordnad partition om mer information pekar toothat partition.</span><span class="sxs-lookup"><span data-stu-id="2af0c-182">hello report should be applied toohello unhealthy service or tooa specific child partition, if more information points toothat partition.</span></span> <span data-ttu-id="2af0c-183">hello data automatiskt hämtar via hello hierarki och en ohälsosamt partition görs synliga på tjänster och program.</span><span class="sxs-lookup"><span data-stu-id="2af0c-183">hello data automatically surfaces through hello hierarchy, and an unhealthy partition is made visible at service and application levels.</span></span> <span data-ttu-id="2af0c-184">Den här aggregeringen hjälper toopinpoint och Lös hello grundorsaken till problemet hello snabbare.</span><span class="sxs-lookup"><span data-stu-id="2af0c-184">This aggregation helps toopinpoint and resolve hello root cause of hello issue more quickly.</span></span>

<span data-ttu-id="2af0c-185">hello hälsa hierarki består av överordnade och underordnade relationer.</span><span class="sxs-lookup"><span data-stu-id="2af0c-185">hello health hierarchy is composed of parent-child relationships.</span></span> <span data-ttu-id="2af0c-186">Ett kluster består av noder och program.</span><span class="sxs-lookup"><span data-stu-id="2af0c-186">A cluster is composed of nodes and applications.</span></span> <span data-ttu-id="2af0c-187">Program tjänster och distribuerade program.</span><span class="sxs-lookup"><span data-stu-id="2af0c-187">Applications have services and deployed applications.</span></span> <span data-ttu-id="2af0c-188">Distribuerade program har distribuerat tjänstpaket.</span><span class="sxs-lookup"><span data-stu-id="2af0c-188">Deployed applications have deployed service packages.</span></span> <span data-ttu-id="2af0c-189">Tjänster som har partitioner och varje partition har en eller flera repliker.</span><span class="sxs-lookup"><span data-stu-id="2af0c-189">Services have partitions, and each partition has one or more replicas.</span></span> <span data-ttu-id="2af0c-190">Det finns en särskild relation mellan noder och distribuerade entiteter.</span><span class="sxs-lookup"><span data-stu-id="2af0c-190">There is a special relationship between nodes and deployed entities.</span></span> <span data-ttu-id="2af0c-191">Ett feltillstånd nod påverkar som rapporteras av dess utfärdare systemkomponent hello Failover Manager service, hello distribuerade program, servicepaket och repliker som har distribuerats på den.</span><span class="sxs-lookup"><span data-stu-id="2af0c-191">An unhealthy node as reported by its authority system component, hello Failover Manager service, affects hello deployed applications, service packages, and replicas deployed on it.</span></span>

<span data-ttu-id="2af0c-192">hello hälsa hierarkin representerar hello senaste status för hello baserat på hello senaste hälsorapporter som är nästan realtidsdata.</span><span class="sxs-lookup"><span data-stu-id="2af0c-192">hello health hierarchy represents hello latest state of hello system based on hello latest health reports, which is almost real-time information.</span></span>
<span data-ttu-id="2af0c-193">Interna och externa watchdogs kan rapportera om hello samma entiteter baserat på programspecifika logik eller anpassade övervakade villkor.</span><span class="sxs-lookup"><span data-stu-id="2af0c-193">Internal and external watchdogs can report on hello same entities based on application-specific logic or custom monitored conditions.</span></span> <span data-ttu-id="2af0c-194">Användarrapporter samexistera med hello systemrapporter.</span><span class="sxs-lookup"><span data-stu-id="2af0c-194">User reports coexist with hello system reports.</span></span>

<span data-ttu-id="2af0c-195">Planera tooinvest i hur tooreport och svara toohealth under hello design av stora molntjänster.</span><span class="sxs-lookup"><span data-stu-id="2af0c-195">Plan tooinvest in how tooreport and respond toohealth during hello design of a large cloud service.</span></span> <span data-ttu-id="2af0c-196">Den här direkta investement gör hello service enklare toodebug, övervaka och hantera.</span><span class="sxs-lookup"><span data-stu-id="2af0c-196">This up-front investement makes hello service easier toodebug, monitor, and operate.</span></span>

## <a name="health-states"></a><span data-ttu-id="2af0c-197">Hälsotillstånd</span><span class="sxs-lookup"><span data-stu-id="2af0c-197">Health states</span></span>
<span data-ttu-id="2af0c-198">Service Fabric använder tre hälsotillstånd tillstånd toodescribe om en entitet är felfri eller inte: OK, varning och fel.</span><span class="sxs-lookup"><span data-stu-id="2af0c-198">Service Fabric uses three health states toodescribe whether an entity is healthy or not: OK, warning, and error.</span></span> <span data-ttu-id="2af0c-199">Alla rapporter skickas toohello hälsoarkivet måste ange ett av dessa lägen.</span><span class="sxs-lookup"><span data-stu-id="2af0c-199">Any report sent toohello health store must specify one of these states.</span></span> <span data-ttu-id="2af0c-200">utvärderingsresultat av hello hälsa är ett av dessa lägen.</span><span class="sxs-lookup"><span data-stu-id="2af0c-200">hello health evaluation result is one of these states.</span></span>

<span data-ttu-id="2af0c-201">Hej möjliga [hälsotillstånd](https://docs.microsoft.com/dotnet/api/system.fabric.health.healthstate) är:</span><span class="sxs-lookup"><span data-stu-id="2af0c-201">hello possible [health states](https://docs.microsoft.com/dotnet/api/system.fabric.health.healthstate) are:</span></span>

* <span data-ttu-id="2af0c-202">**OK**.</span><span class="sxs-lookup"><span data-stu-id="2af0c-202">**OK**.</span></span> <span data-ttu-id="2af0c-203">hello entiteten är felfri.</span><span class="sxs-lookup"><span data-stu-id="2af0c-203">hello entity is healthy.</span></span> <span data-ttu-id="2af0c-204">Det finns inga kända problem rapporteras på den eller dess underordnade objekt (i förekommande fall).</span><span class="sxs-lookup"><span data-stu-id="2af0c-204">There are no known issues reported on it or its children (when applicable).</span></span>
* <span data-ttu-id="2af0c-205">**Varning**.</span><span class="sxs-lookup"><span data-stu-id="2af0c-205">**Warning**.</span></span> <span data-ttu-id="2af0c-206">hello entiteten har några problem, men det kan fortfarande fungera korrekt.</span><span class="sxs-lookup"><span data-stu-id="2af0c-206">hello entity has some issues, but it can still function correctly.</span></span> <span data-ttu-id="2af0c-207">Till exempel fördröjning, men de gör inte problemen funktionella ännu.</span><span class="sxs-lookup"><span data-stu-id="2af0c-207">For example, there are delays, but they do not cause any functional issues yet.</span></span> <span data-ttu-id="2af0c-208">I vissa fall åtgärda hello varningsvillkor själva utan externa åtgärder.</span><span class="sxs-lookup"><span data-stu-id="2af0c-208">In some cases, hello warning condition may fix itself without external intervention.</span></span> <span data-ttu-id="2af0c-209">I dessa fall hälsorapporter öka medvetenhet och ger inblick i vad som händer.</span><span class="sxs-lookup"><span data-stu-id="2af0c-209">In these cases, health reports raise awareness and provide visibility into what is going on.</span></span> <span data-ttu-id="2af0c-210">I annat fall kan hello varningsvillkor försämras i ett allvarligt problem utan åtgärder från användaren.</span><span class="sxs-lookup"><span data-stu-id="2af0c-210">In other cases, hello warning condition may degrade into a severe problem without user intervention.</span></span>
* <span data-ttu-id="2af0c-211">**Fel**.</span><span class="sxs-lookup"><span data-stu-id="2af0c-211">**Error**.</span></span> <span data-ttu-id="2af0c-212">hello entiteten är felfri.</span><span class="sxs-lookup"><span data-stu-id="2af0c-212">hello entity is unhealthy.</span></span> <span data-ttu-id="2af0c-213">Måste åtgärdas toofix hello tillstånd hello entiteten eftersom den inte fungera korrekt.</span><span class="sxs-lookup"><span data-stu-id="2af0c-213">Action should be taken toofix hello state of hello entity, because it can't function properly.</span></span>
* <span data-ttu-id="2af0c-214">**Okänd**.</span><span class="sxs-lookup"><span data-stu-id="2af0c-214">**Unknown**.</span></span> <span data-ttu-id="2af0c-215">hello entiteten finns inte i hello health store.</span><span class="sxs-lookup"><span data-stu-id="2af0c-215">hello entity doesn't exist in hello health store.</span></span> <span data-ttu-id="2af0c-216">Det här resultatet kan hämtas från hello distribuerade frågor som sammanfoga resultat från flera komponenter.</span><span class="sxs-lookup"><span data-stu-id="2af0c-216">This result can be obtained from hello distributed queries that merge results from multiple components.</span></span> <span data-ttu-id="2af0c-217">Till exempel hello get nod listfrågan går för**FailoverManager**, **ClusterManager**, och **HealthManager**; hämta programmet listfrågan går för **ClusterManager** och **HealthManager**.</span><span class="sxs-lookup"><span data-stu-id="2af0c-217">For example, hello get node list query goes too**FailoverManager**, **ClusterManager**, and **HealthManager**; get application list query goes too**ClusterManager** and **HealthManager**.</span></span> <span data-ttu-id="2af0c-218">De här frågorna sammanfoga resultat från flera komponenter.</span><span class="sxs-lookup"><span data-stu-id="2af0c-218">These queries merge results from multiple system components.</span></span> <span data-ttu-id="2af0c-219">Om en annan komponent returnerar en entitet som inte finns i health store hello resultatet är okänd hälsotillstånd.</span><span class="sxs-lookup"><span data-stu-id="2af0c-219">If another system component returns an entity that is not present in health store, hello merged result has unknown health state.</span></span> <span data-ttu-id="2af0c-220">En entitet är inte i arkivet eftersom hälsorapporter som ännu inte har bearbetats eller hello enheten har rensats efter borttagningen.</span><span class="sxs-lookup"><span data-stu-id="2af0c-220">An entity is not in store because health reports have not yet been processed or hello entity has been cleaned up after deletion.</span></span>

## <a name="health-policies"></a><span data-ttu-id="2af0c-221">Hälsoprinciper</span><span class="sxs-lookup"><span data-stu-id="2af0c-221">Health policies</span></span>
<span data-ttu-id="2af0c-222">Hej hälsoarkivet gäller hälsa principer toodetermine om en entitet är felfri baserat på dess rapporter och dess underordnade.</span><span class="sxs-lookup"><span data-stu-id="2af0c-222">hello health store applies health policies toodetermine whether an entity is healthy based on its reports and its children.</span></span>

> [!NOTE]
> <span data-ttu-id="2af0c-223">Hälsoprinciper kan anges i hello klustermanifestet (för kluster- och nodnamn hälsoutvärderingen) eller hello programmanifestet (för utvärdering av programmet och alla dess underordnade).</span><span class="sxs-lookup"><span data-stu-id="2af0c-223">Health policies can be specified in hello cluster manifest (for cluster and node health evaluation) or in hello application manifest (for application evaluation and any of its children).</span></span> <span data-ttu-id="2af0c-224">Hälsotillstånd utvärdering begäranden kan även skicka in anpassade utvärdering hälsoprinciper som endast används för att utvärdering.</span><span class="sxs-lookup"><span data-stu-id="2af0c-224">Health evaluation requests can also pass in custom health evaluation policies, which are used only for that evaluation.</span></span>
> 
> 

<span data-ttu-id="2af0c-225">Som standard gäller strikta regler (allt måste vara felfria) för hello överordnad-underordnad hierarkisk relation i Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="2af0c-225">By default, Service Fabric applies strict rules (everything must be healthy) for hello parent-child hierarchical relationship.</span></span> <span data-ttu-id="2af0c-226">Om ett enda av hello underordnade har en ohälsosam händelse anses hello överordnade feltillstånd.</span><span class="sxs-lookup"><span data-stu-id="2af0c-226">If even one of hello children has one unhealthy event, hello parent is considered unhealthy.</span></span>

### <a name="cluster-health-policy"></a><span data-ttu-id="2af0c-227">Klustret hälsoprincip</span><span class="sxs-lookup"><span data-stu-id="2af0c-227">Cluster health policy</span></span>
<span data-ttu-id="2af0c-228">Hej [kluster hälsoprincip](https://docs.microsoft.com/dotnet/api/system.fabric.health.clusterhealthpolicy) är används tooevaluate hello klustret hälsa tillstånd och noden hälsotillstånd.</span><span class="sxs-lookup"><span data-stu-id="2af0c-228">hello [cluster health policy](https://docs.microsoft.com/dotnet/api/system.fabric.health.clusterhealthpolicy) is used tooevaluate hello cluster health state and node health states.</span></span> <span data-ttu-id="2af0c-229">hello princip kan definieras i hello klustermanifestet.</span><span class="sxs-lookup"><span data-stu-id="2af0c-229">hello policy can be defined in hello cluster manifest.</span></span> <span data-ttu-id="2af0c-230">Om det inte finns, används standardprincipen för hello (noll tillåten fel).</span><span class="sxs-lookup"><span data-stu-id="2af0c-230">If it is not present, hello default policy (zero tolerated failures) is used.</span></span>
<span data-ttu-id="2af0c-231">hello klustret hälsoprincip innehåller:</span><span class="sxs-lookup"><span data-stu-id="2af0c-231">hello cluster health policy contains:</span></span>

* <span data-ttu-id="2af0c-232">[ConsiderWarningAsError](https://docs.microsoft.com/dotnet/api/system.fabric.health.clusterhealthpolicy.considerwarningaserror).</span><span class="sxs-lookup"><span data-stu-id="2af0c-232">[ConsiderWarningAsError](https://docs.microsoft.com/dotnet/api/system.fabric.health.clusterhealthpolicy.considerwarningaserror).</span></span> <span data-ttu-id="2af0c-233">Anger om tootreat varning hälsorapporter som fel under hälsoutvärderingen.</span><span class="sxs-lookup"><span data-stu-id="2af0c-233">Specifies whether tootreat warning health reports as errors during health evaluation.</span></span> <span data-ttu-id="2af0c-234">Standard: false.</span><span class="sxs-lookup"><span data-stu-id="2af0c-234">Default: false.</span></span>
* <span data-ttu-id="2af0c-235">[MaxPercentUnhealthyApplications](https://docs.microsoft.com/dotnet/api/system.fabric.health.clusterhealthpolicy.maxpercentunhealthyapplications).</span><span class="sxs-lookup"><span data-stu-id="2af0c-235">[MaxPercentUnhealthyApplications](https://docs.microsoft.com/dotnet/api/system.fabric.health.clusterhealthpolicy.maxpercentunhealthyapplications).</span></span> <span data-ttu-id="2af0c-236">Anger hello maximalt tillåten procentandel av program som kan vara felaktiga innan hello klustret anses vara fel.</span><span class="sxs-lookup"><span data-stu-id="2af0c-236">Specifies hello maximum tolerated percentage of applications that can be unhealthy before hello cluster is considered in error.</span></span>
* <span data-ttu-id="2af0c-237">[MaxPercentUnhealthyNodes](https://docs.microsoft.com/dotnet/api/system.fabric.health.clusterhealthpolicy.maxpercentunhealthynodes).</span><span class="sxs-lookup"><span data-stu-id="2af0c-237">[MaxPercentUnhealthyNodes](https://docs.microsoft.com/dotnet/api/system.fabric.health.clusterhealthpolicy.maxpercentunhealthynodes).</span></span> <span data-ttu-id="2af0c-238">Anger hello maximalt tillåten procentandel noder som kan vara felaktiga innan hello klustret anses vara fel.</span><span class="sxs-lookup"><span data-stu-id="2af0c-238">Specifies hello maximum tolerated percentage of nodes that can be unhealthy before hello cluster is considered in error.</span></span> <span data-ttu-id="2af0c-239">I stora kluster är vissa noder alltid på eller ut för reparationer, så den här procentandelen ska vara konfigurerade tootolerate som.</span><span class="sxs-lookup"><span data-stu-id="2af0c-239">In large clusters, some nodes are always down or out for repairs, so this percentage should be configured tootolerate that.</span></span>
* <span data-ttu-id="2af0c-240">[ApplicationTypeHealthPolicyMap](https://docs.microsoft.com/dotnet/api/system.fabric.health.clusterhealthpolicy.applicationtypehealthpolicymap).</span><span class="sxs-lookup"><span data-stu-id="2af0c-240">[ApplicationTypeHealthPolicyMap](https://docs.microsoft.com/dotnet/api/system.fabric.health.clusterhealthpolicy.applicationtypehealthpolicymap).</span></span> <span data-ttu-id="2af0c-241">hello typen hälsa princip programavbildningen kan användas under klustret utvärdering toodescribe specialprogram hälsotyper.</span><span class="sxs-lookup"><span data-stu-id="2af0c-241">hello application type health policy map can be used during cluster health evaluation toodescribe special application types.</span></span> <span data-ttu-id="2af0c-242">Som standard är alla program sätta i en pool och med MaxPercentUnhealthyApplications.</span><span class="sxs-lookup"><span data-stu-id="2af0c-242">By default, all applications are put into a pool and evaluated with MaxPercentUnhealthyApplications.</span></span> <span data-ttu-id="2af0c-243">Om vissa programtyper ska behandlas annorlunda, kan de tas bort från hello globala poolen.</span><span class="sxs-lookup"><span data-stu-id="2af0c-243">If some application types should be treated differently, they can be taken out of hello global pool.</span></span> <span data-ttu-id="2af0c-244">I stället utvärderas de mot hello procenttal som är associerade med deras programmets typnamn i hello mappning.</span><span class="sxs-lookup"><span data-stu-id="2af0c-244">Instead, they are evaluated against hello percentages associated with their application type name in hello map.</span></span> <span data-ttu-id="2af0c-245">Till exempel i ett kluster finns tusentals program av olika typer och några programinstanser för kontroll av en särskild programtyp.</span><span class="sxs-lookup"><span data-stu-id="2af0c-245">For example, in a cluster there are thousands of applications of different types, and a few control application instances of a special application type.</span></span> <span data-ttu-id="2af0c-246">hello styra program ska aldrig vara fel.</span><span class="sxs-lookup"><span data-stu-id="2af0c-246">hello control applications should never be in error.</span></span> <span data-ttu-id="2af0c-247">Du kan ange globala MaxPercentUnhealthyApplications too20% tootolerate vissa fel, men för hello programtyp ”ControlApplicationType” ange hello MaxPercentUnhealthyApplications too0.</span><span class="sxs-lookup"><span data-stu-id="2af0c-247">You can specify global MaxPercentUnhealthyApplications too20% tootolerate some failures, but for hello application type "ControlApplicationType" set hello MaxPercentUnhealthyApplications too0.</span></span> <span data-ttu-id="2af0c-248">Det här sättet om några av hello många program är felfria, men under hello globala ohälsosamt procent hello klustret skulle vara utvärderas tooWarning.</span><span class="sxs-lookup"><span data-stu-id="2af0c-248">This way, if some of hello many applications are unhealthy, but below hello global unhealthy percentage, hello cluster would be evaluated tooWarning.</span></span> <span data-ttu-id="2af0c-249">Ett varningshälsotillstånd påverkar inte klustrets uppgraderingen eller andra övervakning utlöses av hälsotillståndet för fel.</span><span class="sxs-lookup"><span data-stu-id="2af0c-249">A warning health state does not impact cluster upgrade or other monitoring triggered by Error health state.</span></span> <span data-ttu-id="2af0c-250">Men även en kontrollprogrammet i fel skulle göra kluster feltillstånd, vilket utlöser återställningsfasen eller pausar hello klusteruppgradering, beroende på hello uppgradera konfiguration.</span><span class="sxs-lookup"><span data-stu-id="2af0c-250">But even one control application in error would make cluster unhealthy, which triggers roll back or pauses hello cluster upgrade, depending on hello upgrade configuration.</span></span>
  <span data-ttu-id="2af0c-251">För hello programmet typer som definieras i hello mappning, tas alla instanser av programmet ut ur hello global pool av program.</span><span class="sxs-lookup"><span data-stu-id="2af0c-251">For hello application types defined in hello map, all application instances are taken out of hello global pool of applications.</span></span> <span data-ttu-id="2af0c-252">De utvärderas baserat på hello Totalt antal program av hello programtyp, hello specifika MaxPercentUnhealthyApplications från hello mappa.</span><span class="sxs-lookup"><span data-stu-id="2af0c-252">They are evaluated based on hello total number of applications of hello application type, using hello specific MaxPercentUnhealthyApplications from hello map.</span></span> <span data-ttu-id="2af0c-253">Alla hello resten av hello program finns kvar i hello globala poolen och utvärderas med MaxPercentUnhealthyApplications.</span><span class="sxs-lookup"><span data-stu-id="2af0c-253">All hello rest of hello applications remain in hello global pool and are evaluated with MaxPercentUnhealthyApplications.</span></span>

<span data-ttu-id="2af0c-254">hello följande exempel är ett utdrag ur ett klustermanifest.</span><span class="sxs-lookup"><span data-stu-id="2af0c-254">hello following example is an excerpt from a cluster manifest.</span></span> <span data-ttu-id="2af0c-255">toodefine poster i hello typen programavbildningen, prefixet hello parametern med ”ApplicationTypeMaxPercentUnhealthyApplications-”, följt av hello programmets typnamn.</span><span class="sxs-lookup"><span data-stu-id="2af0c-255">toodefine entries in hello application type map, prefix hello parameter name with "ApplicationTypeMaxPercentUnhealthyApplications-", followed by hello application type name.</span></span>

```xml
<FabricSettings>
  <Section Name="HealthManager/ClusterHealthPolicy">
    <Parameter Name="ConsiderWarningAsError" Value="False" />
    <Parameter Name="MaxPercentUnhealthyApplications" Value="20" />
    <Parameter Name="MaxPercentUnhealthyNodes" Value="20" />
    <Parameter Name="ApplicationTypeMaxPercentUnhealthyApplications-ControlApplicationType" Value="0" />
  </Section>
</FabricSettings>
```

### <a name="application-health-policy"></a><span data-ttu-id="2af0c-256">Programmets hälsoprincip</span><span class="sxs-lookup"><span data-stu-id="2af0c-256">Application health policy</span></span>
<span data-ttu-id="2af0c-257">Hej [programmets hälsoprincip](https://docs.microsoft.com/dotnet/api/system.fabric.health.applicationhealthpolicy) beskriver hur hello utvärdering av händelser och underordnade tillstånd aggregeringen är klar för program och deras underordnade.</span><span class="sxs-lookup"><span data-stu-id="2af0c-257">hello [application health policy](https://docs.microsoft.com/dotnet/api/system.fabric.health.applicationhealthpolicy) describes how hello evaluation of events and child-states aggregation is done for applications and their children.</span></span> <span data-ttu-id="2af0c-258">Det kan definieras i hello programmanifestet **ApplicationManifest.xml**, i hello programpaketet.</span><span class="sxs-lookup"><span data-stu-id="2af0c-258">It can be defined in hello application manifest, **ApplicationManifest.xml**, in hello application package.</span></span> <span data-ttu-id="2af0c-259">Om inga principer anges, förutsätter Service Fabric att hello entitet feltillstånd om den har en hälsorapport eller en underordnad hello varnings- eller hälsotillstånd.</span><span class="sxs-lookup"><span data-stu-id="2af0c-259">If no policies are specified, Service Fabric assumes that hello entity is unhealthy if it has a health report or a child at hello warning or error health state.</span></span>
<span data-ttu-id="2af0c-260">hello konfigurerbara principerna är:</span><span class="sxs-lookup"><span data-stu-id="2af0c-260">hello configurable policies are:</span></span>

* <span data-ttu-id="2af0c-261">[ConsiderWarningAsError](https://docs.microsoft.com/dotnet/api/system.fabric.health.applicationhealthpolicy.considerwarningaserror.aspx).</span><span class="sxs-lookup"><span data-stu-id="2af0c-261">[ConsiderWarningAsError](https://docs.microsoft.com/dotnet/api/system.fabric.health.applicationhealthpolicy.considerwarningaserror.aspx).</span></span> <span data-ttu-id="2af0c-262">Anger om tootreat varning hälsorapporter som fel under hälsoutvärderingen.</span><span class="sxs-lookup"><span data-stu-id="2af0c-262">Specifies whether tootreat warning health reports as errors during health evaluation.</span></span> <span data-ttu-id="2af0c-263">Standard: false.</span><span class="sxs-lookup"><span data-stu-id="2af0c-263">Default: false.</span></span>
* <span data-ttu-id="2af0c-264">[MaxPercentUnhealthyDeployedApplications](https://docs.microsoft.com/dotnet/api/system.fabric.health.applicationhealthpolicy.maxpercentunhealthydeployedapplications).</span><span class="sxs-lookup"><span data-stu-id="2af0c-264">[MaxPercentUnhealthyDeployedApplications](https://docs.microsoft.com/dotnet/api/system.fabric.health.applicationhealthpolicy.maxpercentunhealthydeployedapplications).</span></span> <span data-ttu-id="2af0c-265">Anger hello maximala tolereras procentandelen av distribuerade program som kan vara felaktiga innan programmet hello anses vara fel.</span><span class="sxs-lookup"><span data-stu-id="2af0c-265">Specifies hello maximum tolerated percentage of deployed applications that can be unhealthy before hello application is considered in error.</span></span> <span data-ttu-id="2af0c-266">Den här procent beräknas genom att dividera hello antalet felaktiga distribuerade program över hello antalet noder som hello program för närvarande har distribuerats på i hello kluster.</span><span class="sxs-lookup"><span data-stu-id="2af0c-266">This percentage is calculated by dividing hello number of unhealthy deployed applications over hello number of nodes that hello applications are currently deployed on in hello cluster.</span></span> <span data-ttu-id="2af0c-267">hello beräkning Avrundar uppåt tootolerate ett fel på litet antal noder.</span><span class="sxs-lookup"><span data-stu-id="2af0c-267">hello computation rounds up tootolerate one failure on small numbers of nodes.</span></span> <span data-ttu-id="2af0c-268">Standard procentandel: noll.</span><span class="sxs-lookup"><span data-stu-id="2af0c-268">Default percentage: zero.</span></span>
* <span data-ttu-id="2af0c-269">[DefaultServiceTypeHealthPolicy](https://docs.microsoft.com/dotnet/api/system.fabric.health.applicationhealthpolicy.defaultservicetypehealthpolicy).</span><span class="sxs-lookup"><span data-stu-id="2af0c-269">[DefaultServiceTypeHealthPolicy](https://docs.microsoft.com/dotnet/api/system.fabric.health.applicationhealthpolicy.defaultservicetypehealthpolicy).</span></span> <span data-ttu-id="2af0c-270">Anger hello standard service typen hälsoprinciper, som ersätter hello hälsa standardprincipen för alla tjänsttyper av i hello program.</span><span class="sxs-lookup"><span data-stu-id="2af0c-270">Specifies hello default service type health policy, which replaces hello default health policy for all service types in hello application.</span></span>
* <span data-ttu-id="2af0c-271">[ServiceTypeHealthPolicyMap](https://docs.microsoft.com/dotnet/api/system.fabric.health.applicationhealthpolicy.servicetypehealthpolicymap).</span><span class="sxs-lookup"><span data-stu-id="2af0c-271">[ServiceTypeHealthPolicyMap](https://docs.microsoft.com/dotnet/api/system.fabric.health.applicationhealthpolicy.servicetypehealthpolicymap).</span></span> <span data-ttu-id="2af0c-272">Innehåller en karta över service hälsoprinciper per typ av tjänst.</span><span class="sxs-lookup"><span data-stu-id="2af0c-272">Provides a map of service health policies per service type.</span></span> <span data-ttu-id="2af0c-273">Dessa principer ersätter hello service typen hälsa standardprinciperna för varje typ av angivna tjänsten.</span><span class="sxs-lookup"><span data-stu-id="2af0c-273">These policies replace hello default service type health policies for each specified service type.</span></span> <span data-ttu-id="2af0c-274">Du kan till exempel konfigurera hello hälsoprinciper för utvärderingen annorlunda om ett program har en typ av tillståndslösa gateway och en tillståndskänslig engine service type.</span><span class="sxs-lookup"><span data-stu-id="2af0c-274">For example, if an application has a stateless gateway service type and a stateful engine service type, you can configure hello health policies for their evaluation differently.</span></span> <span data-ttu-id="2af0c-275">Du kan få mer detaljerad kontroll över hello hälsotillståndet för hello-tjänsten när du anger princip per typ av tjänst.</span><span class="sxs-lookup"><span data-stu-id="2af0c-275">When you specify policy per service type, you can gain more granular control of hello health of hello service.</span></span>

### <a name="service-type-health-policy"></a><span data-ttu-id="2af0c-276">Hälsoprincip för Service-typen</span><span class="sxs-lookup"><span data-stu-id="2af0c-276">Service type health policy</span></span>
<span data-ttu-id="2af0c-277">Hej [service type hälsoprincip](https://docs.microsoft.com/dotnet/api/system.fabric.health.servicetypehealthpolicy) anger hur tooevaluate och aggregering hello tjänster och hello underordnade tjänster.</span><span class="sxs-lookup"><span data-stu-id="2af0c-277">hello [service type health policy](https://docs.microsoft.com/dotnet/api/system.fabric.health.servicetypehealthpolicy) specifies how tooevaluate and aggregate hello services and hello children of services.</span></span> <span data-ttu-id="2af0c-278">hello principen innehåller:</span><span class="sxs-lookup"><span data-stu-id="2af0c-278">hello policy contains:</span></span>

* <span data-ttu-id="2af0c-279">[MaxPercentUnhealthyPartitionsPerService](https://docs.microsoft.com/dotnet/api/system.fabric.health.servicetypehealthpolicy.maxpercentunhealthypartitionsperservice).</span><span class="sxs-lookup"><span data-stu-id="2af0c-279">[MaxPercentUnhealthyPartitionsPerService](https://docs.microsoft.com/dotnet/api/system.fabric.health.servicetypehealthpolicy.maxpercentunhealthypartitionsperservice).</span></span> <span data-ttu-id="2af0c-280">Anger hello maximala tolereras procentandelen ohälsosamt partitioner innan en tjänst anses vara felaktig.</span><span class="sxs-lookup"><span data-stu-id="2af0c-280">Specifies hello maximum tolerated percentage of unhealthy partitions before a service is considered unhealthy.</span></span> <span data-ttu-id="2af0c-281">Standard procentandel: noll.</span><span class="sxs-lookup"><span data-stu-id="2af0c-281">Default percentage: zero.</span></span>
* <span data-ttu-id="2af0c-282">[MaxPercentUnhealthyReplicasPerPartition](https://docs.microsoft.com/dotnet/api/system.fabric.health.servicetypehealthpolicy.maxpercentunhealthyreplicasperpartition).</span><span class="sxs-lookup"><span data-stu-id="2af0c-282">[MaxPercentUnhealthyReplicasPerPartition](https://docs.microsoft.com/dotnet/api/system.fabric.health.servicetypehealthpolicy.maxpercentunhealthyreplicasperpartition).</span></span> <span data-ttu-id="2af0c-283">Anger hello maximala tolereras procentandelen ohälsosamt repliker innan en partition anses vara felaktig.</span><span class="sxs-lookup"><span data-stu-id="2af0c-283">Specifies hello maximum tolerated percentage of unhealthy replicas before a partition is considered unhealthy.</span></span> <span data-ttu-id="2af0c-284">Standard procentandel: noll.</span><span class="sxs-lookup"><span data-stu-id="2af0c-284">Default percentage: zero.</span></span>
* <span data-ttu-id="2af0c-285">[MaxPercentUnhealthyServices](https://docs.microsoft.com/dotnet/api/system.fabric.health.servicetypehealthpolicy.maxpercentunhealthyservices).</span><span class="sxs-lookup"><span data-stu-id="2af0c-285">[MaxPercentUnhealthyServices](https://docs.microsoft.com/dotnet/api/system.fabric.health.servicetypehealthpolicy.maxpercentunhealthyservices).</span></span> <span data-ttu-id="2af0c-286">Anger hello maximala tolereras procentandelen ohälsosamt services innan programmet hello anses vara felaktig.</span><span class="sxs-lookup"><span data-stu-id="2af0c-286">Specifies hello maximum tolerated percentage of unhealthy services before hello application is considered unhealthy.</span></span> <span data-ttu-id="2af0c-287">Standard procentandel: noll.</span><span class="sxs-lookup"><span data-stu-id="2af0c-287">Default percentage: zero.</span></span>

<span data-ttu-id="2af0c-288">hello följande exempel är ett utdrag ur ett programmanifest:</span><span class="sxs-lookup"><span data-stu-id="2af0c-288">hello following example is an excerpt from an application manifest:</span></span>

```xml
    <Policies>
        <HealthPolicy ConsiderWarningAsError="true" MaxPercentUnhealthyDeployedApplications="20">
            <DefaultServiceTypeHealthPolicy
                   MaxPercentUnhealthyServices="0"
                   MaxPercentUnhealthyPartitionsPerService="10"
                   MaxPercentUnhealthyReplicasPerPartition="0"/>
            <ServiceTypeHealthPolicy ServiceTypeName="FrontEndServiceType"
                   MaxPercentUnhealthyServices="0"
                   MaxPercentUnhealthyPartitionsPerService="20"
                   MaxPercentUnhealthyReplicasPerPartition="0"/>
            <ServiceTypeHealthPolicy ServiceTypeName="BackEndServiceType"
                   MaxPercentUnhealthyServices="20"
                   MaxPercentUnhealthyPartitionsPerService="0"
                   MaxPercentUnhealthyReplicasPerPartition="0">
            </ServiceTypeHealthPolicy>
        </HealthPolicy>
    </Policies>
```

## <a name="health-evaluation"></a><span data-ttu-id="2af0c-289">Utvärdering av hälsotillstånd</span><span class="sxs-lookup"><span data-stu-id="2af0c-289">Health evaluation</span></span>
<span data-ttu-id="2af0c-290">Användare och tjänster som automatiskt kan utvärdera hälsan för en enhet när som helst.</span><span class="sxs-lookup"><span data-stu-id="2af0c-290">Users and automated services can evaluate health for any entity at any time.</span></span> <span data-ttu-id="2af0c-291">tooevaluate en entitets hälsotillstånd, hello health store mängder hälsotillstånd rapporter om hello entiteten och utvärderar alla dess underordnade (i förekommande fall).</span><span class="sxs-lookup"><span data-stu-id="2af0c-291">tooevaluate an entity's health, hello health store aggregates all health reports on hello entity and evaluates all its children (when applicable).</span></span> <span data-ttu-id="2af0c-292">hello hälsa aggregering algoritmen använder hälsoprinciper som anger hur tooevaluate hälsorapporter och hur tooaggregate underordnade hälsotillstånd (i förekommande fall).</span><span class="sxs-lookup"><span data-stu-id="2af0c-292">hello health aggregation algorithm uses health policies that specify how tooevaluate health reports and how tooaggregate child health states (when applicable).</span></span>

### <a name="health-report-aggregation"></a><span data-ttu-id="2af0c-293">Hälsotillstånd rapporten aggregering</span><span class="sxs-lookup"><span data-stu-id="2af0c-293">Health report aggregation</span></span>
<span data-ttu-id="2af0c-294">En entitet kan ha flera hälsorapporter som skickas av olika rapportörer (systemkomponenter eller watchdogs) på olika egenskaper.</span><span class="sxs-lookup"><span data-stu-id="2af0c-294">One entity can have multiple health reports sent by different reporters (system components or watchdogs) on different properties.</span></span> <span data-ttu-id="2af0c-295">hello aggregering använder hello associerade hälsoprinciper, särskilt hello ConsiderWarningAsError medlem av programmet eller kluster hälsoprincip.</span><span class="sxs-lookup"><span data-stu-id="2af0c-295">hello aggregation uses hello associated health policies, in particular hello ConsiderWarningAsError member of application or cluster health policy.</span></span> <span data-ttu-id="2af0c-296">ConsiderWarningAsError anger hur tooevaluate varningar.</span><span class="sxs-lookup"><span data-stu-id="2af0c-296">ConsiderWarningAsError specifies how tooevaluate warnings.</span></span>

<span data-ttu-id="2af0c-297">hello aggregerade hälsotillstånd utlöses av hello *sämsta* hälsorapporter hello entiteten.</span><span class="sxs-lookup"><span data-stu-id="2af0c-297">hello aggregated health state is triggered by hello *worst* health reports on hello entity.</span></span> <span data-ttu-id="2af0c-298">Om det finns minst ett fel hälsorapport, hello aggregerade hälsotillståndet är ett fel.</span><span class="sxs-lookup"><span data-stu-id="2af0c-298">If there is at least one error health report, hello aggregated health state is an error.</span></span>

![Hälsotillstånd rapporten aggregering med felrapport.][2]

<span data-ttu-id="2af0c-300">En hälsa entitet som har en eller flera fel hälsorapporter utvärderas som fel.</span><span class="sxs-lookup"><span data-stu-id="2af0c-300">A health entity that has one or more error health reports is evaluated as Error.</span></span> <span data-ttu-id="2af0c-301">hello sak samma gäller för ett utgånget hälsorapport, oavsett dess hälsotillstånd.</span><span class="sxs-lookup"><span data-stu-id="2af0c-301">hello same is true for an expired health report, regardless of its health state.</span></span>

[2]: ./media/service-fabric-health-introduction/servicefabric-health-report-eval-error.png

<span data-ttu-id="2af0c-302">Om det finns inga felrapporter och en eller flera varningar, är hello aggregerade hälsotillstånd varning eller fel, beroende på hello ConsiderWarningAsError princip flaggan.</span><span class="sxs-lookup"><span data-stu-id="2af0c-302">If there are no error reports and one or more warnings, hello aggregated health state is either warning or error, depending on hello ConsiderWarningAsError policy flag.</span></span>

![Hälsotillstånd rapporten aggregering med varning rapporten och ConsiderWarningAsError false.][3]

<span data-ttu-id="2af0c-304">Hälsotillstånd rapporten aggregeringen med varning rapporten och ConsiderWarningAsError ange toofalse (standard).</span><span class="sxs-lookup"><span data-stu-id="2af0c-304">Health report aggregation with warning report and ConsiderWarningAsError set toofalse (default).</span></span>

[3]: ./media/service-fabric-health-introduction/servicefabric-health-report-eval-warning.png

### <a name="child-health-aggregation"></a><span data-ttu-id="2af0c-305">Underordnade hälsa aggregering</span><span class="sxs-lookup"><span data-stu-id="2af0c-305">Child health aggregation</span></span>
<span data-ttu-id="2af0c-306">hello visar aggregerade hälsotillståndet för en entitet hello underordnade hälsotillstånd (i förekommande fall).</span><span class="sxs-lookup"><span data-stu-id="2af0c-306">hello aggregated health state of an entity reflects hello child health states (when applicable).</span></span> <span data-ttu-id="2af0c-307">hello-algoritmen för sammanställningen underordnade hälsotillstånd använder hello hälsoprinciper tillämpliga baserat på hello entitetstypen.</span><span class="sxs-lookup"><span data-stu-id="2af0c-307">hello algorithm for aggregating child health states uses hello health policies applicable based on hello entity type.</span></span>

![Underordnade entiteter hälsa aggregering.][4]

<span data-ttu-id="2af0c-309">Underordnade aggregering baserat på hälsoprinciper.</span><span class="sxs-lookup"><span data-stu-id="2af0c-309">Child aggregation based on health policies.</span></span>

[4]: ./media/service-fabric-health-introduction/servicefabric-health-hierarchy-eval.png

<span data-ttu-id="2af0c-310">När hello health store har utvärderas alla hello underordnade aggregerar deras hälsotillstånd baserat på hello konfigurerade maximala procentandelen ohälsosamt underordnade.</span><span class="sxs-lookup"><span data-stu-id="2af0c-310">After hello health store has evaluated all hello children, it aggregates their health states based on hello configured maximum percentage of unhealthy children.</span></span> <span data-ttu-id="2af0c-311">Procenttalet hämtas från hello princip baserat på hello entiteten och underordnade.</span><span class="sxs-lookup"><span data-stu-id="2af0c-311">This percentage is taken from hello policy based on hello entity and child type.</span></span>

* <span data-ttu-id="2af0c-312">Om alla underordnade har OK tillstånd, är hälsotillstånd för hello underordnade aggregeras OK.</span><span class="sxs-lookup"><span data-stu-id="2af0c-312">If all children have OK states, hello child aggregated health state is OK.</span></span>
* <span data-ttu-id="2af0c-313">Om underordnade har både OK och varning tillstånd, hälsotillstånd för hello underordnade aggregeras är en varning.</span><span class="sxs-lookup"><span data-stu-id="2af0c-313">If children have both OK and warning states, hello child aggregated health state is warning.</span></span>
* <span data-ttu-id="2af0c-314">Om det finns underordnade med fel tillstånd som inte tar hänsyn till hello tillåtna procentandelen ohälsosamt underordnade, är hello aggregerade hälsotillstånd ett fel.</span><span class="sxs-lookup"><span data-stu-id="2af0c-314">If there are children with error states that do not respect hello maximum allowed percentage of unhealthy children, hello aggregated health state is an error.</span></span>
* <span data-ttu-id="2af0c-315">Om hello underordnade med fel tillstånd avseende hello maximalt tillåten procentandel av feltillstånd underordnade hello varning aggregerade hälsotillstånd.</span><span class="sxs-lookup"><span data-stu-id="2af0c-315">If hello children with error states respect hello maximum allowed percentage of unhealthy children, hello aggregated health state is warning.</span></span>

## <a name="health-reporting"></a><span data-ttu-id="2af0c-316">Rapportering av hälsotillstånd</span><span class="sxs-lookup"><span data-stu-id="2af0c-316">Health reporting</span></span>
<span data-ttu-id="2af0c-317">Systemkomponenter, System Fabric program och intern/extern watchdogs kan rapportera mot Service Fabric-enheter.</span><span class="sxs-lookup"><span data-stu-id="2af0c-317">System components, System Fabric applications, and internal/external watchdogs can report against Service Fabric entities.</span></span> <span data-ttu-id="2af0c-318">hello-rapportörer Se *lokala* bestämning av hello hälsotillstånd hello övervakas entiteter, baserat på hello villkor som de övervakar.</span><span class="sxs-lookup"><span data-stu-id="2af0c-318">hello reporters make *local* determinations of hello health of hello monitored entities, based on hello conditions they are monitoring.</span></span> <span data-ttu-id="2af0c-319">De behöver inte toolook vid varje globalt tillstånd eller samla in data.</span><span class="sxs-lookup"><span data-stu-id="2af0c-319">They don't need toolook at any global state or aggregate data.</span></span> <span data-ttu-id="2af0c-320">hello önskat beteende är toohave enkel rapportörer och inte komplexa organismer som behöver toolook på många saker tooinfer toosend vilken information.</span><span class="sxs-lookup"><span data-stu-id="2af0c-320">hello desired behavior is toohave simple reporters, and not complex organisms that need toolook at many things tooinfer what information toosend.</span></span>

<span data-ttu-id="2af0c-321">toosend hälsotillstånd toohello hälsa datalager, en rapport måste tooidentify hello påverkas entiteten och skapa en hälsorapport.</span><span class="sxs-lookup"><span data-stu-id="2af0c-321">toosend health data toohello health store, a reporter needs tooidentify hello affected entity and create a health report.</span></span> <span data-ttu-id="2af0c-322">toosend hello rapport, Använd hello [FabricClient.HealthClient.ReportHealth](https://docs.microsoft.com/dotnet/api/system.fabric.fabricclient.healthclient.reporthealth) API, rapporten hälsa API: er som är exponerad på hello `Partition` eller `CodePackageActivationContext` objekt, PowerShell-cmdletar och REST.</span><span class="sxs-lookup"><span data-stu-id="2af0c-322">toosend hello report, use hello [FabricClient.HealthClient.ReportHealth](https://docs.microsoft.com/dotnet/api/system.fabric.fabricclient.healthclient.reporthealth) API, report health APIs exposed on hello `Partition` or `CodePackageActivationContext` objects, PowerShell cmdlets, or REST.</span></span>

### <a name="health-reports"></a><span data-ttu-id="2af0c-323">Hälsorapporter</span><span class="sxs-lookup"><span data-stu-id="2af0c-323">Health reports</span></span>
<span data-ttu-id="2af0c-324">Hej [hälsorapporter](https://docs.microsoft.com/dotnet/api/system.fabric.health.healthreport) för varje hello entiteter i hello kluster innehåller hello följande information:</span><span class="sxs-lookup"><span data-stu-id="2af0c-324">hello [health reports](https://docs.microsoft.com/dotnet/api/system.fabric.health.healthreport) for each of hello entities in hello cluster contain hello following information:</span></span>

* <span data-ttu-id="2af0c-325">**SourceId**.</span><span class="sxs-lookup"><span data-stu-id="2af0c-325">**SourceId**.</span></span> <span data-ttu-id="2af0c-326">En sträng som unikt identifierar hello rapport hello hälsa händelse.</span><span class="sxs-lookup"><span data-stu-id="2af0c-326">A string that uniquely identifies hello reporter of hello health event.</span></span>
* <span data-ttu-id="2af0c-327">**Identifiering**.</span><span class="sxs-lookup"><span data-stu-id="2af0c-327">**Entity identifier**.</span></span> <span data-ttu-id="2af0c-328">Identifierar hello entiteten där hello rapporten används.</span><span class="sxs-lookup"><span data-stu-id="2af0c-328">Identifies hello entity where hello report is applied.</span></span> <span data-ttu-id="2af0c-329">Den skiljer sig beroende på hello [entitetstypen](service-fabric-health-introduction.md#health-entities-and-hierarchy):</span><span class="sxs-lookup"><span data-stu-id="2af0c-329">It differs based on hello [entity type](service-fabric-health-introduction.md#health-entities-and-hierarchy):</span></span>
  
  * <span data-ttu-id="2af0c-330">Kluster.</span><span class="sxs-lookup"><span data-stu-id="2af0c-330">Cluster.</span></span> <span data-ttu-id="2af0c-331">Ingen.</span><span class="sxs-lookup"><span data-stu-id="2af0c-331">None.</span></span>
  * <span data-ttu-id="2af0c-332">Noden.</span><span class="sxs-lookup"><span data-stu-id="2af0c-332">Node.</span></span> <span data-ttu-id="2af0c-333">Nodnamnet (sträng).</span><span class="sxs-lookup"><span data-stu-id="2af0c-333">Node name  (string).</span></span>
  * <span data-ttu-id="2af0c-334">Programmet.</span><span class="sxs-lookup"><span data-stu-id="2af0c-334">Application.</span></span> <span data-ttu-id="2af0c-335">Programnamn (URI).</span><span class="sxs-lookup"><span data-stu-id="2af0c-335">Application name (URI).</span></span> <span data-ttu-id="2af0c-336">Representerar hello namnet på hello programinstansen distribueras i hello kluster.</span><span class="sxs-lookup"><span data-stu-id="2af0c-336">Represents hello name of hello application instance deployed in hello cluster.</span></span>
  * <span data-ttu-id="2af0c-337">Tjänsten.</span><span class="sxs-lookup"><span data-stu-id="2af0c-337">Service.</span></span> <span data-ttu-id="2af0c-338">Tjänstens namn (URI).</span><span class="sxs-lookup"><span data-stu-id="2af0c-338">Service name (URI).</span></span> <span data-ttu-id="2af0c-339">Representerar hello namnet på hello tjänstinstans distribueras i hello kluster.</span><span class="sxs-lookup"><span data-stu-id="2af0c-339">Represents hello name of hello service instance deployed in hello cluster.</span></span>
  * <span data-ttu-id="2af0c-340">Partition.</span><span class="sxs-lookup"><span data-stu-id="2af0c-340">Partition.</span></span> <span data-ttu-id="2af0c-341">Partitions-ID (GUID).</span><span class="sxs-lookup"><span data-stu-id="2af0c-341">Partition ID (GUID).</span></span> <span data-ttu-id="2af0c-342">Representerar hello partition Unik identifierare.</span><span class="sxs-lookup"><span data-stu-id="2af0c-342">Represents hello partition unique identifier.</span></span>
  * <span data-ttu-id="2af0c-343">Repliken.</span><span class="sxs-lookup"><span data-stu-id="2af0c-343">Replica.</span></span> <span data-ttu-id="2af0c-344">hello tillståndskänslig service replik-ID eller hello tillståndslös tjänstinstans-ID (INT64).</span><span class="sxs-lookup"><span data-stu-id="2af0c-344">hello stateful service replica ID or hello stateless service instance ID (INT64).</span></span>
  * <span data-ttu-id="2af0c-345">DeployedApplication.</span><span class="sxs-lookup"><span data-stu-id="2af0c-345">DeployedApplication.</span></span> <span data-ttu-id="2af0c-346">Programnamnet (URI) och nodnamnet (sträng).</span><span class="sxs-lookup"><span data-stu-id="2af0c-346">Application name (URI) and node name (string).</span></span>
  * <span data-ttu-id="2af0c-347">DeployedServicePackage.</span><span class="sxs-lookup"><span data-stu-id="2af0c-347">DeployedServicePackage.</span></span> <span data-ttu-id="2af0c-348">Programnamn (URI), nodnamnet (sträng) och service manifest namn (sträng).</span><span class="sxs-lookup"><span data-stu-id="2af0c-348">Application name (URI), node name (string), and service manifest name (string).</span></span>
* <span data-ttu-id="2af0c-349">**Egenskapen**.</span><span class="sxs-lookup"><span data-stu-id="2af0c-349">**Property**.</span></span> <span data-ttu-id="2af0c-350">En *sträng* (inte en fast uppräkning) som gör att hello rapport toocategorize hello hälsa händelse för en specifik egenskap för hello entitet.</span><span class="sxs-lookup"><span data-stu-id="2af0c-350">A *string* (not a fixed enumeration) that allows hello reporter toocategorize hello health event for a specific property of hello entity.</span></span> <span data-ttu-id="2af0c-351">Till exempel rapport A kan rapportera hello hälsotillstånd hello Node01 ”” lagringsegenskap och rapport B kan rapportera hello hälsotillstånd hello Node01 ”anslutning”-egenskap.</span><span class="sxs-lookup"><span data-stu-id="2af0c-351">For example, reporter A can report hello health of hello Node01 "Storage" property and reporter B can report hello health of hello Node01 "Connectivity" property.</span></span> <span data-ttu-id="2af0c-352">Rapporterna behandlas som separata hälsa händelser för hello Node01 entiteten i hello health store.</span><span class="sxs-lookup"><span data-stu-id="2af0c-352">In hello health store, these reports are treated as separate health events for hello Node01 entity.</span></span>
* <span data-ttu-id="2af0c-353">**Beskrivning av**.</span><span class="sxs-lookup"><span data-stu-id="2af0c-353">**Description**.</span></span> <span data-ttu-id="2af0c-354">En sträng som gör att en rapport tooprovide detaljerad information om hello hälsohändelse.</span><span class="sxs-lookup"><span data-stu-id="2af0c-354">A string that allows a reporter tooprovide detailed information about hello health event.</span></span> <span data-ttu-id="2af0c-355">**SourceId**, **egenskapen**, och **HealthState** fullständigt beskriva hello rapporten.</span><span class="sxs-lookup"><span data-stu-id="2af0c-355">**SourceId**, **Property**, and **HealthState** should fully describe hello report.</span></span> <span data-ttu-id="2af0c-356">hello beskrivning lägger till läsbart information om hello rapport.</span><span class="sxs-lookup"><span data-stu-id="2af0c-356">hello description adds human-readable information about hello report.</span></span> <span data-ttu-id="2af0c-357">hello text gör det enklare för administratörer och användare toounderstand hello hälsorapport.</span><span class="sxs-lookup"><span data-stu-id="2af0c-357">hello text makes it easier for administrators and users toounderstand hello health report.</span></span>
* <span data-ttu-id="2af0c-358">**HealthState**.</span><span class="sxs-lookup"><span data-stu-id="2af0c-358">**HealthState**.</span></span> <span data-ttu-id="2af0c-359">En [uppräkningen](service-fabric-health-introduction.md#health-states) som beskriver hello hälsotillståndet för hello rapporten.</span><span class="sxs-lookup"><span data-stu-id="2af0c-359">An [enumeration](service-fabric-health-introduction.md#health-states) that describes hello health state of hello report.</span></span> <span data-ttu-id="2af0c-360">hello godkända värden är OK, varning och fel.</span><span class="sxs-lookup"><span data-stu-id="2af0c-360">hello accepted values are OK, Warning, and Error.</span></span>
* <span data-ttu-id="2af0c-361">**TimeToLive**.</span><span class="sxs-lookup"><span data-stu-id="2af0c-361">**TimeToLive**.</span></span> <span data-ttu-id="2af0c-362">Timespan som anger hur länge hello hälsorapport är giltig.</span><span class="sxs-lookup"><span data-stu-id="2af0c-362">A timespan that indicates how long hello health report is valid.</span></span> <span data-ttu-id="2af0c-363">Tillsammans med **RemoveWhenExpired**, gör det hello health store vet hur tooevaluate upphört att gälla händelser.</span><span class="sxs-lookup"><span data-stu-id="2af0c-363">Coupled with **RemoveWhenExpired**, it lets hello health store know how tooevaluate expired events.</span></span> <span data-ttu-id="2af0c-364">Som standard hello-värdet är oändlig och hello rapporten är giltig alltid.</span><span class="sxs-lookup"><span data-stu-id="2af0c-364">By default, hello value is infinite, and hello report is valid forever.</span></span>
* <span data-ttu-id="2af0c-365">**RemoveWhenExpired**.</span><span class="sxs-lookup"><span data-stu-id="2af0c-365">**RemoveWhenExpired**.</span></span> <span data-ttu-id="2af0c-366">Ett booleskt värde.</span><span class="sxs-lookup"><span data-stu-id="2af0c-366">A Boolean.</span></span> <span data-ttu-id="2af0c-367">Om ange tootrue, hello utgångna hälsa rapporten tas bort automatiskt från hello health store och hello rapporten påverkar inte entiteten hälsoutvärderingen.</span><span class="sxs-lookup"><span data-stu-id="2af0c-367">If set tootrue, hello expired health report is automatically removed from hello health store, and hello report doesn't impact entity health evaluation.</span></span> <span data-ttu-id="2af0c-368">Används när hello rapporten är giltig för en viss tidsperiod endast tid och hello-rapport behöver inte tooexplicitly rensa den. Det har också används toodelete rapporter från hello health store (till exempel en watchdog ändras och slutar att skicka rapporter med föregående käll- och egenskapen).</span><span class="sxs-lookup"><span data-stu-id="2af0c-368">Used when hello report is valid for a specified period of time only, and hello reporter doesn't need tooexplicitly clear it out. It's also used toodelete reports from hello health store (for example, a watchdog is changed and stops sending reports with previous source and property).</span></span> <span data-ttu-id="2af0c-369">Den kan skicka en rapport med en kort TimeToLive tillsammans med RemoveWhenExpired tooclear eventuella tidigare tillstånd från hello health store.</span><span class="sxs-lookup"><span data-stu-id="2af0c-369">It can send a report with a brief TimeToLive along with RemoveWhenExpired tooclear up any previous state from hello health store.</span></span> <span data-ttu-id="2af0c-370">Om hello värdet toofalse, behandlas hello utgångna rapporten som ett fel på hello hälsoutvärderingen.</span><span class="sxs-lookup"><span data-stu-id="2af0c-370">If hello value is set toofalse, hello expired report is treated as an error on hello health evaluation.</span></span> <span data-ttu-id="2af0c-371">hello FALSKT signalerar toohello health store hello källan bör rapportera regelbundet på den här egenskapen.</span><span class="sxs-lookup"><span data-stu-id="2af0c-371">hello false value signals toohello health store that hello source should report periodically on this property.</span></span> <span data-ttu-id="2af0c-372">Om det inte måste sedan det vara något fel med hello watchdog.</span><span class="sxs-lookup"><span data-stu-id="2af0c-372">If it doesn't, then there must be something wrong with hello watchdog.</span></span> <span data-ttu-id="2af0c-373">hello watchdog hälsa fångas av överväger hello händelsen som ett fel.</span><span class="sxs-lookup"><span data-stu-id="2af0c-373">hello watchdog's health is captured by considering hello event as an error.</span></span>
* <span data-ttu-id="2af0c-374">**SequenceNumber**.</span><span class="sxs-lookup"><span data-stu-id="2af0c-374">**SequenceNumber**.</span></span> <span data-ttu-id="2af0c-375">Ett positivt heltal som behöver toobe allt större representerar hello ordning hello rapporter.</span><span class="sxs-lookup"><span data-stu-id="2af0c-375">A positive integer that needs toobe ever-increasing, it represents hello order of hello reports.</span></span> <span data-ttu-id="2af0c-376">Den används av hello store toodetect inaktuella hälsorapporter som tas emot sent på grund av fördröjningar i nätverket eller andra problem.</span><span class="sxs-lookup"><span data-stu-id="2af0c-376">It is used by hello health store toodetect stale reports that are received late because of network delays or other issues.</span></span> <span data-ttu-id="2af0c-377">En rapport avvisas om hello sekvensnummer är mindre än eller lika med toohello nyligen använts nummer för hello samma entitet, källa och egenskapen.</span><span class="sxs-lookup"><span data-stu-id="2af0c-377">A report is rejected if hello sequence number is less than or equal toohello most recently applied number for hello same entity, source, and property.</span></span> <span data-ttu-id="2af0c-378">Om den inte är angiven ska hello sekvensnummer genereras automatiskt.</span><span class="sxs-lookup"><span data-stu-id="2af0c-378">If it is not specified, hello sequence number is generated automatically.</span></span> <span data-ttu-id="2af0c-379">Det är nödvändigt tooput i hello sekvensnummer endast när rapportering för övergångslägen.</span><span class="sxs-lookup"><span data-stu-id="2af0c-379">It is necessary tooput in hello sequence number only when reporting on state transitions.</span></span> <span data-ttu-id="2af0c-380">I den här situationen måste hello källa tooremember vilka rapporter som det skickas och hålla hello information för återställning vid redundans.</span><span class="sxs-lookup"><span data-stu-id="2af0c-380">In this situation, hello source needs tooremember which reports it sent and keep hello information for recovery on failover.</span></span>

<span data-ttu-id="2af0c-381">Dessa fyra delar av information – SourceId, identifiering, egenskap och HealthState--krävs för varje hälsorapport.</span><span class="sxs-lookup"><span data-stu-id="2af0c-381">These four pieces of information--SourceId, entity identifier, Property, and HealthState--are required for every health report.</span></span> <span data-ttu-id="2af0c-382">hello SourceId sträng är inte tillåten toostart med hello prefixet ”**System.**”, som är reserverad för systemrapporter.</span><span class="sxs-lookup"><span data-stu-id="2af0c-382">hello SourceId string is not allowed toostart with hello prefix "**System.**", which is reserved for system reports.</span></span> <span data-ttu-id="2af0c-383">För hello samma entitet det finns endast en rapport för hello samma käll- och egenskapen.</span><span class="sxs-lookup"><span data-stu-id="2af0c-383">For hello same entity, there is only one report for hello same source and property.</span></span> <span data-ttu-id="2af0c-384">Flera rapporter för hello samma källa och egenskapen åsidosätter varandra på hello hälsa på klientsidan (om de grupperas) eller på hello health store på klientsidan.</span><span class="sxs-lookup"><span data-stu-id="2af0c-384">Multiple reports for hello same source and property override each other, either on hello health client side (if they are batched) or on hello health store side.</span></span> <span data-ttu-id="2af0c-385">hello ersättning baseras på sekvensnummer; nyare rapporter (med högre sekvensnummer) ersätter äldre rapporter.</span><span class="sxs-lookup"><span data-stu-id="2af0c-385">hello replacement is based on sequence numbers; newer reports (with higher sequence numbers) replace older reports.</span></span>

### <a name="health-events"></a><span data-ttu-id="2af0c-386">Hälsotillstånd händelser</span><span class="sxs-lookup"><span data-stu-id="2af0c-386">Health events</span></span>
<span data-ttu-id="2af0c-387">Internt, för att hålla hello hälsoarkivet [hälsa händelser](https://docs.microsoft.com/dotnet/api/system.fabric.health.healthevent), som innehåller alla hello information från hello rapporter och ytterligare metadata.</span><span class="sxs-lookup"><span data-stu-id="2af0c-387">Internally, hello health store keeps [health events](https://docs.microsoft.com/dotnet/api/system.fabric.health.healthevent), which contain all hello information from hello reports, and additional metadata.</span></span> <span data-ttu-id="2af0c-388">hello metadata innehåller hello hello rapporten gavs toohello hälsa klienten och hello tid den ändrats på hello på serversidan.</span><span class="sxs-lookup"><span data-stu-id="2af0c-388">hello metadata includes hello time hello report was given toohello health client and hello time it was modified on hello server side.</span></span> <span data-ttu-id="2af0c-389">hello hälsa händelser som returneras av [hälsoförfrågningar](service-fabric-view-entities-aggregated-health.md#health-queries).</span><span class="sxs-lookup"><span data-stu-id="2af0c-389">hello health events are returned by [health queries](service-fabric-view-entities-aggregated-health.md#health-queries).</span></span>

<span data-ttu-id="2af0c-390">hello tillagda metadata innehåller:</span><span class="sxs-lookup"><span data-stu-id="2af0c-390">hello added metadata contains:</span></span>

* <span data-ttu-id="2af0c-391">**SourceUtcTimestamp**.</span><span class="sxs-lookup"><span data-stu-id="2af0c-391">**SourceUtcTimestamp**.</span></span> <span data-ttu-id="2af0c-392">hello tid hello rapporten har fått toohello hälsa klienten (Coordinated Universal Time).</span><span class="sxs-lookup"><span data-stu-id="2af0c-392">hello time hello report was given toohello health client (Coordinated Universal Time).</span></span>
* <span data-ttu-id="2af0c-393">**LastModifiedUtcTimestamp**.</span><span class="sxs-lookup"><span data-stu-id="2af0c-393">**LastModifiedUtcTimestamp**.</span></span> <span data-ttu-id="2af0c-394">hello tid hello rapporten senast ändrades på serversidan för hello (Coordinated Universal Time).</span><span class="sxs-lookup"><span data-stu-id="2af0c-394">hello time hello report was last modified on hello server side (Coordinated Universal Time).</span></span>
* <span data-ttu-id="2af0c-395">**IsExpired**.</span><span class="sxs-lookup"><span data-stu-id="2af0c-395">**IsExpired**.</span></span> <span data-ttu-id="2af0c-396">En flagga tooindicate om hello rapporten har upphört att gälla när hello frågan kördes av hello health store.</span><span class="sxs-lookup"><span data-stu-id="2af0c-396">A flag tooindicate whether hello report was expired when hello query was executed by hello health store.</span></span> <span data-ttu-id="2af0c-397">En händelse kan ha gått endast om RemoveWhenExpired är false.</span><span class="sxs-lookup"><span data-stu-id="2af0c-397">An event can be expired only if RemoveWhenExpired is false.</span></span> <span data-ttu-id="2af0c-398">Annars hello händelsen returneras inte av frågan och tas bort från hello store.</span><span class="sxs-lookup"><span data-stu-id="2af0c-398">Otherwise, hello event is not returned by query and is removed from hello store.</span></span>
* <span data-ttu-id="2af0c-399">**LastOkTransitionAt**, **LastWarningTransitionAt**, **LastErrorTransitionAt**.</span><span class="sxs-lookup"><span data-stu-id="2af0c-399">**LastOkTransitionAt**, **LastWarningTransitionAt**, **LastErrorTransitionAt**.</span></span> <span data-ttu-id="2af0c-400">hello senast för fel-OK/varning övergångar.</span><span class="sxs-lookup"><span data-stu-id="2af0c-400">hello last time for OK/warning/error transitions.</span></span> <span data-ttu-id="2af0c-401">De här fälten kan hello historik över hello hälsa tillståndsövergångar för hello-händelse.</span><span class="sxs-lookup"><span data-stu-id="2af0c-401">These fields give hello history of hello health state transitions for hello event.</span></span>

<span data-ttu-id="2af0c-402">hello tillstånd övergången fält kan användas för smartare aviseringar eller ”historiska” hälsoinformation för händelsen.</span><span class="sxs-lookup"><span data-stu-id="2af0c-402">hello state transition fields can be used for smarter alerts or "historical" health event information.</span></span> <span data-ttu-id="2af0c-403">De aktiverar som scenarier:</span><span class="sxs-lookup"><span data-stu-id="2af0c-403">They enable scenarios such as:</span></span>

* <span data-ttu-id="2af0c-404">Meddela när en egenskap har varit varning/fel för mer än X minuter.</span><span class="sxs-lookup"><span data-stu-id="2af0c-404">Alert when a property has been at warning/error for more than X minutes.</span></span> <span data-ttu-id="2af0c-405">Kontrollera hello villkoret för en viss tidsperiod undviker aviseringar på tillfälliga förhållanden.</span><span class="sxs-lookup"><span data-stu-id="2af0c-405">Checking hello condition for a period of time avoids alerts on temporary conditions.</span></span> <span data-ttu-id="2af0c-406">Till exempel en avisering om hello hälsotillstånd har varning under mer än fem minuter kan översättas till (HealthState == varning och nu - LastWarningTransitionTime > 5 minuter).</span><span class="sxs-lookup"><span data-stu-id="2af0c-406">For example, an alert if hello health state has been warning for more than five minutes can be translated into (HealthState == Warning and Now - LastWarningTransitionTime > 5 minutes).</span></span>
* <span data-ttu-id="2af0c-407">Meddela endast på de villkor som har ändrats i hello senast X minuter.</span><span class="sxs-lookup"><span data-stu-id="2af0c-407">Alert only on conditions that have changed in hello last X minutes.</span></span> <span data-ttu-id="2af0c-408">Om en rapport var redan vid fel innan hello angiven tid, ignoreras det eftersom den redan har signalerat tidigare.</span><span class="sxs-lookup"><span data-stu-id="2af0c-408">If a report was already at error before hello specified time, it can be ignored because it was already signaled previously.</span></span>
* <span data-ttu-id="2af0c-409">Om en egenskap växla mellan varnings- och bestämma hur länge den har varit ohälsosam (det vill säga inte OK).</span><span class="sxs-lookup"><span data-stu-id="2af0c-409">If a property is toggling between warning and error, determine how long it has been unhealthy (that is, not OK).</span></span> <span data-ttu-id="2af0c-410">Till exempel en avisering om hello-egenskapen inte har varit vid god hälsa under mer än fem minuter kan översättas till (HealthState! = Ok och nu - LastOkTransitionTime > 5 minuter).</span><span class="sxs-lookup"><span data-stu-id="2af0c-410">For example, an alert if hello property hasn't been healthy for more than five minutes can be translated into (HealthState != Ok and Now - LastOkTransitionTime > 5 minutes).</span></span>

## <a name="example-report-and-evaluate-application-health"></a><span data-ttu-id="2af0c-411">Exempel: Rapport och utvärdera programs hälsa</span><span class="sxs-lookup"><span data-stu-id="2af0c-411">Example: Report and evaluate application health</span></span>
<span data-ttu-id="2af0c-412">hello följande exempel skickas en hälsorapport via PowerShell på programmet hello **fabric: / WordCount** från hello källa **MyWatchdog**.</span><span class="sxs-lookup"><span data-stu-id="2af0c-412">hello following example sends a health report through PowerShell on hello application **fabric:/WordCount** from hello source **MyWatchdog**.</span></span> <span data-ttu-id="2af0c-413">hello hälsorapport innehåller information om hello hälsa egenskapen ”tillgänglighet” i ett felaktigt hälsotillstånd med oändlig TimeToLive.</span><span class="sxs-lookup"><span data-stu-id="2af0c-413">hello health report contains information about hello health property "availability" in an error health state, with infinite TimeToLive.</span></span> <span data-ttu-id="2af0c-414">Sedan hello programhälsan frågor som returnerar samman hälsa tillstånd fel och hello rapporterade hälsa händelser i hello lista över händelser som hälsa.</span><span class="sxs-lookup"><span data-stu-id="2af0c-414">Then it queries hello application health, which returns aggregated health state errors and hello reported health events in hello list of health events.</span></span>

```powershell
PS C:\> Send-ServiceFabricApplicationHealthReport –ApplicationName fabric:/WordCount –SourceId "MyWatchdog" –HealthProperty "Availability" –HealthState Error

PS C:\> Get-ServiceFabricApplicationHealth fabric:/WordCount -ExcludeHealthStatistics


ApplicationName                 : fabric:/WordCount
AggregatedHealthState           : Error
UnhealthyEvaluations            :
                                  Error event: SourceId='MyWatchdog', Property='Availability'.

ServiceHealthStates             :
                                  ServiceName           : fabric:/WordCount/WordCountService
                                  AggregatedHealthState : Error

                                  ServiceName           : fabric:/WordCount/WordCountWebService
                                  AggregatedHealthState : Ok

DeployedApplicationHealthStates :
                                  ApplicationName       : fabric:/WordCount
                                  NodeName              : _Node_0
                                  AggregatedHealthState : Ok

                                  ApplicationName       : fabric:/WordCount
                                  NodeName              : _Node_2
                                  AggregatedHealthState : Ok

                                  ApplicationName       : fabric:/WordCount
                                  NodeName              : _Node_3
                                  AggregatedHealthState : Ok

                                  ApplicationName       : fabric:/WordCount
                                  NodeName              : _Node_4
                                  AggregatedHealthState : Ok

                                  ApplicationName       : fabric:/WordCount
                                  NodeName              : _Node_1
                                  AggregatedHealthState : Ok

HealthEvents                    :
                                  SourceId              : System.CM
                                  Property              : State
                                  HealthState           : Ok
                                  SequenceNumber        : 360
                                  SentAt                : 3/22/2016 7:56:53 PM
                                  ReceivedAt            : 3/22/2016 7:56:53 PM
                                  TTL                   : Infinite
                                  Description           : Application has been created.
                                  RemoveWhenExpired     : False
                                  IsExpired             : False
                                  Transitions           : Error->Ok = 3/22/2016 7:56:53 PM, LastWarning = 1/1/0001 12:00:00 AM

                                  SourceId              : MyWatchdog
                                  Property              : Availability
                                  HealthState           : Error
                                  SequenceNumber        : 131032204762818013
                                  SentAt                : 3/23/2016 3:27:56 PM
                                  ReceivedAt            : 3/23/2016 3:27:56 PM
                                  TTL                   : Infinite
                                  Description           :
                                  RemoveWhenExpired     : False
                                  IsExpired             : False
                                  Transitions           : Ok->Error = 3/23/2016 3:27:56 PM, LastWarning = 1/1/0001 12:00:00 AM
```

## <a name="health-model-usage"></a><span data-ttu-id="2af0c-415">Hälsotillstånd Modellanvändning</span><span class="sxs-lookup"><span data-stu-id="2af0c-415">Health model usage</span></span>
<span data-ttu-id="2af0c-416">Hej hälsomodell kan molntjänster och hello underliggande Service Fabric-plattformen tooscale, eftersom övervakning och hälsa är fördelade på hello olika Övervakare i hello kluster.</span><span class="sxs-lookup"><span data-stu-id="2af0c-416">hello health model allows cloud services and hello underlying Service Fabric platform tooscale, because monitoring and health determinations are distributed among hello different monitors within hello cluster.</span></span>
<span data-ttu-id="2af0c-417">Andra system har en centraliserad tjänst på hello klusternivå som Parsar alla hello *potentiellt* användbar information som sänds av tjänster.</span><span class="sxs-lookup"><span data-stu-id="2af0c-417">Other systems have a single, centralized service at hello cluster level that parses all hello *potentially* useful information emitted by services.</span></span> <span data-ttu-id="2af0c-418">Den här metoden hämmar sina skalbarhet.</span><span class="sxs-lookup"><span data-stu-id="2af0c-418">This approach hinders their scalability.</span></span> <span data-ttu-id="2af0c-419">Den också tillåter inte dem toocollect specifik information toohelp identifiera potentiella problem och som Stäng toohello grundorsaken som möjligt.</span><span class="sxs-lookup"><span data-stu-id="2af0c-419">It also doesn't allow them toocollect specific information toohelp identify issues and potential issues as close toohello root cause as possible.</span></span>

<span data-ttu-id="2af0c-420">Hej hälsomodell används kraftigt för övervakning och diagnos av, för att bedöma hälsa för klustret och program och för övervakade uppgraderingar.</span><span class="sxs-lookup"><span data-stu-id="2af0c-420">hello health model is used heavily for monitoring and diagnosis, for evaluating cluster and application health, and for monitored upgrades.</span></span> <span data-ttu-id="2af0c-421">Andra tjänster använder hälsa data tooperform automatiska reparationer, skapa klustret hälsohistorik och utfärda aviseringar på vissa villkor.</span><span class="sxs-lookup"><span data-stu-id="2af0c-421">Other services use health data tooperform automatic repairs, build cluster health history, and issue alerts on certain conditions.</span></span>

## <a name="next-steps"></a><span data-ttu-id="2af0c-422">Nästa steg</span><span class="sxs-lookup"><span data-stu-id="2af0c-422">Next steps</span></span>
[<span data-ttu-id="2af0c-423">Visa Service Fabric-hälsorapporter</span><span class="sxs-lookup"><span data-stu-id="2af0c-423">View Service Fabric health reports</span></span>](service-fabric-view-entities-aggregated-health.md)

[<span data-ttu-id="2af0c-424">Använda systemet hälsorapporter för felsökning</span><span class="sxs-lookup"><span data-stu-id="2af0c-424">Use system health reports for troubleshooting</span></span>](service-fabric-understand-and-troubleshoot-with-system-health-reports.md)

[<span data-ttu-id="2af0c-425">Hur tooreport och kontrollera-tjänsten för hälsotillstånd</span><span class="sxs-lookup"><span data-stu-id="2af0c-425">How tooreport and check service health</span></span>](service-fabric-diagnostics-how-to-report-and-check-service-health.md)

[<span data-ttu-id="2af0c-426">Lägg till anpassade hälsorapporter för Service Fabric</span><span class="sxs-lookup"><span data-stu-id="2af0c-426">Add custom Service Fabric health reports</span></span>](service-fabric-report-health.md)

[<span data-ttu-id="2af0c-427">Övervaka och diagnostisera tjänster lokalt</span><span class="sxs-lookup"><span data-stu-id="2af0c-427">Monitor and diagnose services locally</span></span>](service-fabric-diagnostics-how-to-monitor-and-diagnose-services-locally.md)

[<span data-ttu-id="2af0c-428">Uppgradering av Service Fabric-programmet</span><span class="sxs-lookup"><span data-stu-id="2af0c-428">Service Fabric application upgrade</span></span>](service-fabric-application-upgrade.md)

