---
title: "aaaAzure Fabric värd tjänstmodell | Microsoft Docs"
description: "Beskriver relationen mellan repliker (eller instanser) av en distribuerad Servic Fabric-tjänst och värdprocessen för tjänsten."
services: service-fabric
documentationcenter: .net
author: harahma
manager: timlt
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 04/15/2017
ms.author: harahma
ms.openlocfilehash: 30e0ba19cd672a722f76477a311ecef7c213b055
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 10/06/2017
---
# <a name="service-fabric-hosting-model"></a><span data-ttu-id="2e31b-103">Service Fabric värdmodell</span><span class="sxs-lookup"><span data-stu-id="2e31b-103">Service Fabric hosting model</span></span>
<span data-ttu-id="2e31b-104">Den här artikeln innehåller en översikt över program som är värd för modeller som tillhandahålls av Service Fabric och beskriver hello skillnaderna mellan hello **delad Process** och **exklusiv processen** modeller.</span><span class="sxs-lookup"><span data-stu-id="2e31b-104">This article provides an overview of application hosting models provided by Service Fabric, and describes hello differences between hello **Shared Process** and **Exclusive Process** models.</span></span> <span data-ttu-id="2e31b-105">Beskriver hur ett distribuerat program visas på ett Service Fabric-noden och förhållandet mellan repliker (eller instanser) av hello-tjänsten och hello tjänstvärden processen.</span><span class="sxs-lookup"><span data-stu-id="2e31b-105">It describes how a deployed application looks on a Service Fabric node and relationship between replicas (or instances) of hello service and hello service-host process.</span></span>

<span data-ttu-id="2e31b-106">Innan du fortsätter, kontrollera att du är bekant med [Service Fabric-programmodell] [ a1] och förstå olika begrepp och relationen mellan dem..</span><span class="sxs-lookup"><span data-stu-id="2e31b-106">Before proceeding further, make sure that you are familiar with [Service Fabric Application Model][a1] and understand various concepts and relation among them.</span></span> 

> [!NOTE]
> <span data-ttu-id="2e31b-107">I den här artikeln för enkelhetens skull, såvida inte uttryckligen anges:</span><span class="sxs-lookup"><span data-stu-id="2e31b-107">In this article, for simplicity, unless explicitly mentioned:</span></span>
>
> - <span data-ttu-id="2e31b-108">All användning av word *replik* refererar tooboth en replik av en tillståndskänslig tjänst eller en instans av en statless tjänst.</span><span class="sxs-lookup"><span data-stu-id="2e31b-108">All uses of word *replica* refers tooboth a replica of a stateful service or an instance of a statless service.</span></span>
> - <span data-ttu-id="2e31b-109">*CodePackage* är behandlade motsvarande för*ServiceHost* process som registrerar en *ServiceType* och värdar repliker tjänster av som *ServiceType*.</span><span class="sxs-lookup"><span data-stu-id="2e31b-109">*CodePackage* is treated equivalent too*ServiceHost* process that registers a *ServiceType* and hosts replicas of services of that *ServiceType*.</span></span>
>

<span data-ttu-id="2e31b-110">toounderstand Hej värdmodell, låt oss gå igenom ett exempel.</span><span class="sxs-lookup"><span data-stu-id="2e31b-110">toounderstand hello hosting model, let us walk through an example.</span></span> <span data-ttu-id="2e31b-111">Låt oss säga vi har en *ApplicationType* 'MyAppType' som har en *ServiceType* 'MyServiceType' som tillhandahålls av *ServicePackage* 'MyServicePackage' som har en *CodePackage* 'MyCodePackage' som registrerar *ServiceType* 'MyServiceType' när den körs.</span><span class="sxs-lookup"><span data-stu-id="2e31b-111">Let us say, we have an *ApplicationType* 'MyAppType' which has a *ServiceType* 'MyServiceType' which is provided by *ServicePackage* 'MyServicePackage' which has a *CodePackage* 'MyCodePackage' which registers *ServiceType* 'MyServiceType' when it runs.</span></span>

<span data-ttu-id="2e31b-112">Anta att vi har ett kluster med 3 noder och skapar vi ett *programmet* **fabric: / App1** av typen 'MyAppType'.</span><span class="sxs-lookup"><span data-stu-id="2e31b-112">Let's say we have a 3 node cluster and we create an *application* **fabric:/App1** of type 'MyAppType'.</span></span> <span data-ttu-id="2e31b-113">I detta *programmet* **fabric: / App1** vi skapa en tjänst **fabric: / App1/ServiceA** av typen 'MyServiceType' som har 2 partitioner (säg **P1** & **P2**) och 3 repliker per partition.</span><span class="sxs-lookup"><span data-stu-id="2e31b-113">Inside this *application* **fabric:/App1** we create a service **fabric:/App1/ServiceA** of type 'MyServiceType' which has 2 partitions (say **P1** & **P2**) and 3 replicas per partition.</span></span> <span data-ttu-id="2e31b-114">hello följande diagram visar hello visning av det här programmet eftersom det hamnar distribuerad på en nod.</span><span class="sxs-lookup"><span data-stu-id="2e31b-114">hello following diagram shows hello view of this application as it ends up deployed on a node.</span></span>

<span data-ttu-id="2e31b-115"><center>
![Noden vy av distribuerade program][node-view-one]
</center></span><span class="sxs-lookup"><span data-stu-id="2e31b-115"><center>
![Node view of deployed application][node-view-one]
</center></span></span>

<span data-ttu-id="2e31b-116">Service Fabric aktiverat 'MyServicePackage' som startade 'MyCodePackage' som är värd repliker från båda hello-partitioner, d.v.s. **P1** & **P2**.</span><span class="sxs-lookup"><span data-stu-id="2e31b-116">Service Fabric activated 'MyServicePackage' which started 'MyCodePackage' which is hosting replicas from both hello partitions i.e. **P1** & **P2**.</span></span> <span data-ttu-id="2e31b-117">Observera att alla hello-noder i klustret hello kommer att ha samma vy eftersom vi valde antal repliker per partition lika toonumber av noderna i klustret hello.</span><span class="sxs-lookup"><span data-stu-id="2e31b-117">Note that all hello nodes in hello cluster will have same view since we chose number of replicas per partition equal toonumber of nodes in hello cluster.</span></span> <span data-ttu-id="2e31b-118">Nu ska vi skapa en annan tjänst **fabric: / App1/ServiceB** i programmet **fabric: / App1** som har 1 partition (säg **P3**) och 3 repliker per partition.</span><span class="sxs-lookup"><span data-stu-id="2e31b-118">Let's create another service **fabric:/App1/ServiceB** in application **fabric:/App1** which has 1 partition (say **P3**) and 3 replicas per partition.</span></span> <span data-ttu-id="2e31b-119">Följande diagram visar hello ny vy på hello nod:</span><span class="sxs-lookup"><span data-stu-id="2e31b-119">Following diagram shows hello new view on hello node:</span></span>

<span data-ttu-id="2e31b-120"><center>
![Noden vy av distribuerade program][node-view-two]
</center></span><span class="sxs-lookup"><span data-stu-id="2e31b-120"><center>
![Node view of deployed application][node-view-two]
</center></span></span>

<span data-ttu-id="2e31b-121">Som vi ser Service Fabric placeras hello nya repliken för partition **P3** för tjänsten **fabric: / App1/ServiceB** i hello befintliga aktivering av 'MyServicePackage'.</span><span class="sxs-lookup"><span data-stu-id="2e31b-121">As we can see Service Fabric placed hello new replica for partition **P3** of service **fabric:/App1/ServiceB** in hello existing activation of 'MyServicePackage'.</span></span> <span data-ttu-id="2e31b-122">Nu kan skapa en ny *programmet* **fabric: / App2** av typen 'MyAppType' och inuti **fabric: / App2** skapa tjänst **fabric: / App2/ServiceA** som har 2 partitioner (säger **P4** & **P5**) och 3 repliker per partition.</span><span class="sxs-lookup"><span data-stu-id="2e31b-122">Now lets create another *application* **fabric:/App2** of type 'MyAppType' and inside **fabric:/App2** create service **fabric:/App2/ServiceA** which has 2 partitions (say **P4** & **P5**) and 3 replicas per partition.</span></span> <span data-ttu-id="2e31b-123">Följande diagram visar hello ny nod vy:</span><span class="sxs-lookup"><span data-stu-id="2e31b-123">Following diagrams shows hello new node view:</span></span>

<span data-ttu-id="2e31b-124"><center>
![Noden vy av distribuerade program][node-view-three]
</center></span><span class="sxs-lookup"><span data-stu-id="2e31b-124"><center>
![Node view of deployed application][node-view-three]
</center></span></span>

<span data-ttu-id="2e31b-125">Den här gången Service Fabric har aktiverat en ny kopia av 'MyServicePackage ”som startar en ny kopia av 'MyCodePackage' och repliker från både partitioner för tjänsten **fabric: / App2/ServiceA** (d.v.s. **P4** & **P5**) placeras i den här nya kopian 'MyCodePackage'.</span><span class="sxs-lookup"><span data-stu-id="2e31b-125">This time Service Fabric has activated a new copy of 'MyServicePackage' which starts a new copy of 'MyCodePackage' and replicas from both partitions of service **fabric:/App2/ServiceA** (i.e. **P4** & **P5**) are placed in this new copy 'MyCodePackage'.</span></span>

## <a name="shared-process-model"></a><span data-ttu-id="2e31b-126">Delade processmodell</span><span class="sxs-lookup"><span data-stu-id="2e31b-126">Shared process model</span></span>
<span data-ttu-id="2e31b-127">Vad vi såg ovan är hello standard värdmodell som tillhandahålls av Service Fabric och kallas tooas **delad Process** modell.</span><span class="sxs-lookup"><span data-stu-id="2e31b-127">What we saw above is hello default hosting model provided by Service Fabric and is referred tooas **Shared Process** model.</span></span> <span data-ttu-id="2e31b-128">I den här modellen för en given *programmet*, bara en kopia av en angivna *ServicePackage* aktiveras på en *nod* (som startar alla hello *CodePackages* finns i den) och alla hello repliker av alla tjänster för en viss *ServiceType* placeras i hello *CodePackage* som registrerar som *ServiceType*.</span><span class="sxs-lookup"><span data-stu-id="2e31b-128">In this model, for a given *application*, only one copy of a given *ServicePackage* is activated on a *Node* (which starts all hello *CodePackages* contained in it) and all hello replicas of all services of a given  *ServiceType* are placed in hello *CodePackage* that registers that *ServiceType*.</span></span> <span data-ttu-id="2e31b-129">Med andra ord alla hello repliker av alla tjänster för en viss *ServiceType* dela hello samma process.</span><span class="sxs-lookup"><span data-stu-id="2e31b-129">In other words, all hello replicas of all services of a given *ServiceType* share hello same process.</span></span>

## <a name="exclusive-process-model"></a><span data-ttu-id="2e31b-130">Exklusiv processmodell</span><span class="sxs-lookup"><span data-stu-id="2e31b-130">Exclusive process model</span></span>
<span data-ttu-id="2e31b-131">hello andra värdmodell som tillhandahålls av Service Fabric är **exklusiv processen** modell.</span><span class="sxs-lookup"><span data-stu-id="2e31b-131">hello other hosting model provided by Service Fabric is **Exclusive Process** model.</span></span> <span data-ttu-id="2e31b-132">I den här modellen på en viss *nod*, placera varje replik Service Fabric aktiverar en ny kopia av *ServicePackage* (som startar alla hello *CodePackages* finns i den ) och repliken placeras i hello *CodePackage* den registrerade hello *ServiceType* av hello service toowhich repliken tillhör.</span><span class="sxs-lookup"><span data-stu-id="2e31b-132">In this model, on a given *Node*, for placing each replica, Service Fabric activates a new copy of *ServicePackage* (which starts all hello *CodePackages* contained in it) and replica is placed in hello *CodePackage* that registered hello *ServiceType* of hello service toowhich replica belongs.</span></span> <span data-ttu-id="2e31b-133">Med andra ord bor varje replik i sin egen dedikerade process.</span><span class="sxs-lookup"><span data-stu-id="2e31b-133">In other words, each replica lives in its own dedicated process.</span></span> 

<span data-ttu-id="2e31b-134">Den här modellen stöds startversion 5.6 i Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="2e31b-134">This model is supported starting version 5.6 of Service Fabric.</span></span> <span data-ttu-id="2e31b-135">**Exklusiv processen** modell kan väljas när hello för att skapa hello-tjänst (med hjälp av [PowerShell][p1], [REST] [ r1]eller [FabricClient][c1]) genom att ange **ServicePackageActivationMode** som 'ExclusiveProcess'.</span><span class="sxs-lookup"><span data-stu-id="2e31b-135">**Exclusive Process** model can be chosen at hello time of creating hello service (using [PowerShell][p1], [REST][r1] or [FabricClient][c1]) by specifying **ServicePackageActivationMode** as 'ExclusiveProcess'.</span></span>

```powershell
PS C:\>New-ServiceFabricService -ApplicationName "fabric:/App1" -ServiceName "fabric:/App1/ServiceA" -ServiceTypeName "MyServiceType" -Stateless -PartitionSchemeSingleton -InstanceCount -1 -ServicePackageActivationMode "ExclusiveProcess"
```

```csharp
var serviceDescription = new StatelessServiceDescription
{
    ApplicationName = new Uri("fabric:/App1"),
    ServiceName = new Uri("fabric:/App1/ServiceA"),
    ServiceTypeName = "MyServiceType",
    PartitionSchemeDescription = new SingletonPartitionSchemeDescription(),
    InstanceCount = -1,
    ServicePackageActivationMode = ServicePackageActivationMode.ExclusiveProcess
};

var fabricClient = new FabricClient(clusterEndpoints);
await fabricClient.ServiceManager.CreateServiceAsync(serviceDescription);
```

<span data-ttu-id="2e31b-136">Om du har en standardtjänst i programmanifestet kan du välja **exklusiv processen** modellen genom att ange **ServicePackageActivationMode** attribut som visas nedan:</span><span class="sxs-lookup"><span data-stu-id="2e31b-136">If you have a default service in your application manifest, you can choose **Exclusive Process** model by specifying **ServicePackageActivationMode** attribute as shown below:</span></span>

```xml
<DefaultServices>
  <Service Name="MyService" ServicePackageActivationMode="ExclusiveProcess">
    <StatelessService ServiceTypeName="MyServiceType" InstanceCount="1">
      <SingletonPartition/>
    </StatelessService>
  </Service>
</DefaultServices>
```
<span data-ttu-id="2e31b-137">Fortsätter med vårt exempel ovan kan skapa en annan tjänst **fabric: / App1/ServiceC** i programmet **fabric: / App1** som har 2 partitioner (säg **P6**  &  **P7**) och 3 repliker per partition med **ServicePackageActivationMode** ange too'ExclusiveProcess'.</span><span class="sxs-lookup"><span data-stu-id="2e31b-137">Continuing with our example above, lets create another service **fabric:/App1/ServiceC** in application **fabric:/App1** which has 2 partitions (say **P6** & **P7**) and 3 replicas per partition with **ServicePackageActivationMode** set too'ExclusiveProcess'.</span></span> <span data-ttu-id="2e31b-138">Följande diagram visar ny vy på hello nod:</span><span class="sxs-lookup"><span data-stu-id="2e31b-138">Following diagram shows new view on hello node:</span></span>

<span data-ttu-id="2e31b-139"><center>
![Noden vy av distribuerade program][node-view-four]
</center></span><span class="sxs-lookup"><span data-stu-id="2e31b-139"><center>
![Node view of deployed application][node-view-four]
</center></span></span>

<span data-ttu-id="2e31b-140">Som du kan se Service Fabric aktiverat två nya kopior av 'MyServicePackage' (en för varje replik från partition **P6** & **P7**) och placeras varje replik i den dedikerade kopian av *CodePackage*.</span><span class="sxs-lookup"><span data-stu-id="2e31b-140">As you can see, Service Fabric activated two new copies of 'MyServicePackage' (one for each replica from partition **P6** & **P7**) and placed each replica in its dedicated copy of *CodePackage*.</span></span> <span data-ttu-id="2e31b-141">En annan sak toonote här är när **exklusiv processen** modellen används för en viss *programmet*, flera kopior av en angivna *ServicePackage* kan vara aktiva i en  *Noden*.</span><span class="sxs-lookup"><span data-stu-id="2e31b-141">Another thing toonote here is, when **Exclusive Process** model is used, for a given *application*, multiple copies of a given *ServicePackage* can be active on a *Node*.</span></span> <span data-ttu-id="2e31b-142">I ovanstående exempel vi se att tre kopior av 'MyServicePackage' är aktiva för **fabric: / App1**.</span><span class="sxs-lookup"><span data-stu-id="2e31b-142">In above example, we see that three copies of 'MyServicePackage' are active for **fabric:/App1**.</span></span> <span data-ttu-id="2e31b-143">Var och en av dessa active kopior av 'MyServicePackage' har en **ServicePackageAtivationId** som är associerade med den som identifierar kopian i *programmet* **fabric: / App1**.</span><span class="sxs-lookup"><span data-stu-id="2e31b-143">Each of these active copies of 'MyServicePackage' has a **ServicePackageAtivationId** associated with it which identifies that copy within *application* **fabric:/App1**.</span></span>

<span data-ttu-id="2e31b-144">När bara **delad Process** mall används för ett *programmet*, till exempel **fabric: / App2** i ovanstående exempel det finns endast en aktiv kopia av *ServicePackage* på en *nod* och **ServicePackageAtivationId** för den här aktiveringen av *ServicePackage* ' tom sträng ”.</span><span class="sxs-lookup"><span data-stu-id="2e31b-144">When only **Shared Process** model is used for an *application*, like **fabric:/App2** in above example, there is only one active copy of *ServicePackage* on a *Node* and **ServicePackageAtivationId** for this activation of *ServicePackage* is 'empty string'.</span></span>

> [!NOTE]
>- <span data-ttu-id="2e31b-145">**Delad Process** värdmodell motsvarar för**ServicePackageAtivationMode** lika **SharedProcess**.</span><span class="sxs-lookup"><span data-stu-id="2e31b-145">**Shared Process** hosting model corresponds too**ServicePackageAtivationMode** equal **SharedProcess**.</span></span> <span data-ttu-id="2e31b-146">Detta är standardvärdet för hello värdmodell och **ServicePackageAtivationMode** behöver inte anges vid hello tiden för att skapa hello-tjänst.</span><span class="sxs-lookup"><span data-stu-id="2e31b-146">This is hello default hosting model and **ServicePackageAtivationMode** need not be specified at hello time of creating hello service.</span></span>
>
>- <span data-ttu-id="2e31b-147">**Exklusiv processen** värdmodell motsvarar för**ServicePackageAtivationMode** lika **ExclusiveProcess** och måste toobe explicit när hello skapar hello tjänsten.</span><span class="sxs-lookup"><span data-stu-id="2e31b-147">**Exclusive Process** hosting model corresponds too**ServicePackageAtivationMode** equal **ExclusiveProcess** and need toobe explicitly specified at hello time of creating hello service.</span></span> 
>
>- <span data-ttu-id="2e31b-148">Värdmodell av en tjänst kan identifieras genom att fråga hello [tjänstbeskrivningen] [ p2] och titta på värdet för **ServicePackageAtivationMode**.</span><span class="sxs-lookup"><span data-stu-id="2e31b-148">Hosting model of a service can be known by querying hello [service description][p2] and looking at value of **ServicePackageAtivationMode**.</span></span>
>
>

## <a name="working-with-deployed-service-package"></a><span data-ttu-id="2e31b-149">Arbeta med distribuerat tjänstpaket</span><span class="sxs-lookup"><span data-stu-id="2e31b-149">Working with deployed service package</span></span>
<span data-ttu-id="2e31b-150">En aktiv kopia av en *ServicePackage* på en nod kallas [distribuerat tjänstpaket][p3].</span><span class="sxs-lookup"><span data-stu-id="2e31b-150">An active copy of a *ServicePackage* on a node is referred as [deployed service package][p3].</span></span> <span data-ttu-id="2e31b-151">Som tidigare nämnts ovan, när **exklusiv processen** modellen används för att skapa tjänster, för en given *programmet*, kan det finnas flera distribuerad tjänst paket för hello samma  *ServicePackage*.</span><span class="sxs-lookup"><span data-stu-id="2e31b-151">As previously mentioned above, when **Exclusive Process** model is used for creating services, for a given *application*, there could be multiple deployed service packages for hello same *ServicePackage*.</span></span> <span data-ttu-id="2e31b-152">När du utför åtgärder specifika toodeployed tjänstpaket som [reporting hälsotillståndet för ett distribuerat tjänstpaket] [ p4] eller [att starta om kodpaketet för en distribuerad tjänstepaketet] [ p5] osv., **ServicePackageActivationId** behov toobe tillhandahålls tooidentify ett paket med specifika distribuerade tjänsten.</span><span class="sxs-lookup"><span data-stu-id="2e31b-152">While performing operations specific toodeployed service package like [reporting health of a deployed service package][p4] or [restarting code package of a deployed service package][p5] etc., **ServicePackageActivationId** needs toobe provided tooidentify a specific deployed service package.</span></span>

 <span data-ttu-id="2e31b-153">**ServicePackageActivationId** för en distribuerad tjänst paketet kan hämtas genom att fråga hello lista över [distribuerat tjänstpaket] [ p3] på en nod.</span><span class="sxs-lookup"><span data-stu-id="2e31b-153">**ServicePackageActivationId** of a deployed service package can be obtained by querying hello list of [deployed service packages][p3] on a node.</span></span> <span data-ttu-id="2e31b-154">När du frågar [distribueras tjänsttyper][p6], [distribueras repliker] [ p7] och [distribuerade kod paket] [ p8] på en nod, innehåller hello frågeresultat även hello **ServicePackageActivationId** i det överordnade distribuerade abonnemang.</span><span class="sxs-lookup"><span data-stu-id="2e31b-154">When querying [deployed service types][p6], [deployed replicas][p7] and [deployed code packages][p8] on a node, hello query result also contains hello **ServicePackageActivationId** of parent deployed service package.</span></span>

> [!NOTE]
>- <span data-ttu-id="2e31b-155">Under **delad Process** värdmodell, på en angivna *nod*, för en given *programmet*, bara en kopia av en *ServicePackage* har aktiverats.</span><span class="sxs-lookup"><span data-stu-id="2e31b-155">Under **Shared Process** hosting model, on a given *node*, for a given *application*, only one copy of a *ServicePackage* is activated.</span></span> <span data-ttu-id="2e31b-156">Den har **ServicePackageActivationId** lika med för*tom sträng* och behöver inte anges när utför distribuerat tjänstpaket relaterade åtgärder.</span><span class="sxs-lookup"><span data-stu-id="2e31b-156">It has **ServicePackageActivationId** equal too*empty string* and need not be specified while performing deployed service package related operations.</span></span> 
>
> - <span data-ttu-id="2e31b-157">Under **exklusiv processen** värdmodell, på en angivna *nod*, för en given *programmet*, en eller flera kopior av en *ServicePackage* kan vara aktiv.</span><span class="sxs-lookup"><span data-stu-id="2e31b-157">Under **Exclusive Process** hosting model, on a given *node*, for a given *application*, one or more copies of a *ServicePackage* can be active.</span></span> <span data-ttu-id="2e31b-158">Varje aktivering har en *icke-tom* **ServicePackageActivationId** och måste toobe anges när utför distribuerat tjänstpaket relaterade åtgärder.</span><span class="sxs-lookup"><span data-stu-id="2e31b-158">Each activation has a *non-empty* **ServicePackageActivationId** and needs toobe specified while performing deployed service package related operations.</span></span> 
>
> - <span data-ttu-id="2e31b-159">Om **ServicePackageActivationId** är ommited som standard too'empty strängen '.</span><span class="sxs-lookup"><span data-stu-id="2e31b-159">If **ServicePackageActivationId** is ommited it defaults too'empty string'.</span></span> <span data-ttu-id="2e31b-160">Om en distribuerad tjänst paketet som har aktiverats **delad Process** modellen finns och kommer att utföra åtgärden på den, annars hello misslyckas åtgärden.</span><span class="sxs-lookup"><span data-stu-id="2e31b-160">If a deployed service package that was activated under **Shared Process** model is present, then operation will be performed on it, otherwise hello operation will fail.</span></span>
>
> - <span data-ttu-id="2e31b-161">Det rekommenderas inte tooquery en gång och cache **ServicePackageActivationId** eftersom det genereras dynamiskt och ändra av olika skäl.</span><span class="sxs-lookup"><span data-stu-id="2e31b-161">It is not recommended tooquery once and cache **ServicePackageActivationId** as it is dynamically generated and can change for various reasons.</span></span> <span data-ttu-id="2e31b-162">Innan du utför en åtgärd som måste **ServicePackageActivationId**, bör du först läsa hello lista över [distribuerat tjänstpaket] [ p3] på en nod och sedan använda  *ServicePackageActivationId** från resultatet tooperform hello ursprungliga frågeåtgärden.</span><span class="sxs-lookup"><span data-stu-id="2e31b-162">Before performing an operation that needs **ServicePackageActivationId**, you should first query hello list of [deployed service packages][p3] on a node and then use *ServicePackageActivationId** from query result tooperform hello original operation.</span></span>
>
>

## <a name="guest-executable-and-container-applications"></a><span data-ttu-id="2e31b-163">Gästen körbar fil och en behållare program</span><span class="sxs-lookup"><span data-stu-id="2e31b-163">Guest executable and container applications</span></span>
<span data-ttu-id="2e31b-164">Service Fabric behandlar [gäst körbara] [ a2] och [behållare] [ a3] program som statless tjänster som är fristående dvs. det finns ingen Service Fabric-körningsmiljön i *ServiceHost* (en process eller behållaren).</span><span class="sxs-lookup"><span data-stu-id="2e31b-164">Service Fabric treats [Guest executable][a2] and [container][a3] applications as statless services which are self-contained i.e. there is no Service Fabric runtime in *ServiceHost* (a process or container).</span></span> <span data-ttu-id="2e31b-165">Eftersom dessa tjänster är fristående, antal repliker per *ServiceHost* gäller inte för dessa tjänster.</span><span class="sxs-lookup"><span data-stu-id="2e31b-165">Since these services are self-contained, number of replicas per *ServiceHost* is not applicable for these services.</span></span> <span data-ttu-id="2e31b-166">hello vanligaste konfigurationen används med tjänsterna är enskild partition med [InstanceCount] [ c2] lika med för-1 (dvs. en kopia av hello Tjänstkod som körs på varje nod i klustret).</span><span class="sxs-lookup"><span data-stu-id="2e31b-166">hello most common configuration used with these services is single-partition with [InstanceCount][c2] equal too-1 (i.e. one copy of hello service code running on each node of cluster).</span></span> 

<span data-ttu-id="2e31b-167">Hej standard **ServicePackageActivationMode** tjänsterna är **SharedProcess** då Service Fabric endast aktiverar en kopia av *ServicePackage* på en *Nod* för en given *programmet* vilket innebär att endast en kopia av tjänstkoden körs en *nod*.</span><span class="sxs-lookup"><span data-stu-id="2e31b-167">hello default **ServicePackageActivationMode** for these services is **SharedProcess** in which case Service Fabric only activates one copy of *ServicePackage* on a *Node* for a given *application* which means only one copy of service code will run a *Node*.</span></span> <span data-ttu-id="2e31b-168">Om du vill att flera kopior av dina service code toorun på en *nod* när du skapar flera tjänster (*Service1* för*ServiceN*) av *ServiceType* (anges i *ServiceManifest*) eller när tjänsten är multi-partitionerat, bör du ange **ServicePackageActivationMode** som **ExclusiveProcess**vid hello tiden för att skapa hello-tjänst.</span><span class="sxs-lookup"><span data-stu-id="2e31b-168">If you want multiple copies of your service code toorun on a *Node* when you create multiple services (*Service1* too*ServiceN*) of *ServiceType* (specified in *ServiceManifest*) or when your service is multi-partitioned, you should specify **ServicePackageActivationMode** as **ExclusiveProcess** at hello time of creating hello service.</span></span>

## <a name="changing-hosting-model-of-an-existing-service"></a><span data-ttu-id="2e31b-169">Ändra värdmodell en befintlig tjänst</span><span class="sxs-lookup"><span data-stu-id="2e31b-169">Changing hosting model of an existing service</span></span>
<span data-ttu-id="2e31b-170">Ändra värdmodell en befintlig tjänst från **delad Process** för**exklusiv processen** och vice versa via uppgradera eller uppdatera mekanism (eller tjänst i specifikationen i program Manifestet) stöds inte för närvarande.</span><span class="sxs-lookup"><span data-stu-id="2e31b-170">Changing hosting model of an existing service from **Shared Process** too**Exclusive Process** and vice-versa through upgrade or update mechanism (or in default service specification in application manifest) is currently not supported.</span></span> <span data-ttu-id="2e31b-171">Stöd för den här funktionen kommer i framtida versioner.</span><span class="sxs-lookup"><span data-stu-id="2e31b-171">Support for this feature will come in future versions.</span></span>

## <a name="choosing-between-shared-process-and-exclusive-process-model"></a><span data-ttu-id="2e31b-172">Att välja mellan delad process och exklusiv processmodell</span><span class="sxs-lookup"><span data-stu-id="2e31b-172">Choosing between shared process and exclusive process model</span></span>
<span data-ttu-id="2e31b-173">Både dessa värd modeller har dess- och nackdelar och användaren måste tooevaluate vilket som bäst passar deras behov.</span><span class="sxs-lookup"><span data-stu-id="2e31b-173">Both these hosting models have its pros and cons and user needs tooevaluate which one fits their requirements best.</span></span> <span data-ttu-id="2e31b-174">**Delad Process** modellen ger bättre användning av OS-resurser eftersom färre processer har initierat, flera repliker i hello samma process kan dela portar, osv. Om en av replikerna hello träffar ett fel där toobring ned hello tjänstvärden måste påverkar dock alla repliker i samma process.</span><span class="sxs-lookup"><span data-stu-id="2e31b-174">**Shared Process** model enables better utilization of OS resources because fewer processes are spawned, multiple replicas in hello same process can share ports, etc. However, if one of hello replicas hits an error where it needs toobring down hello service host, it will impact all other replicas in same process.</span></span>

 <span data-ttu-id="2e31b-175">**Exklusiv processen** modellen ger bättre isolering med varje replik i en egen process och en replik som påverkar inte andra repliker.</span><span class="sxs-lookup"><span data-stu-id="2e31b-175">**Exclusive Process** model provides better isolation with every replica in its own process and a misbehaving replica will not impact other replicas.</span></span> <span data-ttu-id="2e31b-176">Det är praktiskt i de fall där portdelning inte stöds av hello kommunikationsprotokoll.</span><span class="sxs-lookup"><span data-stu-id="2e31b-176">It comes in handy for cases where port sharing is not supported by hello communication protocol.</span></span> <span data-ttu-id="2e31b-177">Det underlättar hello möjlighet tooapply resurs styrning på replik-nivå.</span><span class="sxs-lookup"><span data-stu-id="2e31b-177">It facilitates hello ability tooapply resource governance at replica level.</span></span> <span data-ttu-id="2e31b-178">Hej å andra sidan **exklusiv processen** förbrukar mer OS-resurser som den skapas en process för varje replik på hello nod.</span><span class="sxs-lookup"><span data-stu-id="2e31b-178">On hello other hand, **Exclusive Process** will consume more OS resources as it spawns one process for each replica on hello node.</span></span>

## <a name="exclusive-process-model-and-application-model-considerations"></a><span data-ttu-id="2e31b-179">Exklusiv processmodellen och programmet modellen överväganden</span><span class="sxs-lookup"><span data-stu-id="2e31b-179">Exclusive process model and application model considerations</span></span>
<span data-ttu-id="2e31b-180">hello rekommenderat sätt toomodel ditt program i Service Fabric är tookeep en *ServiceType* per *ServicePackage* och den här modellen fungerar bra för de flesta av hello program.</span><span class="sxs-lookup"><span data-stu-id="2e31b-180">hello recommended way toomodel your application in Service Fabric is tookeep one *ServiceType* per *ServicePackage* and this model works well for most of hello applications.</span></span> 

<span data-ttu-id="2e31b-181">Dock tooenable särskilda scenarier där en *ServiceType* per *ServicePackage* får inte vara önskvärt funktionellt, Service Fabric kan toohave fler än ett *ServiceType* per *ServicePackage* (och en *CodePackage* kan registrera fler än en *ServiceType*).</span><span class="sxs-lookup"><span data-stu-id="2e31b-181">However, tooenable special scenarios where one *ServiceType* per *ServicePackage* may not be desirable, functionally, Service Fabric allows toohave more than one *ServiceType* per *ServicePackage* (and one *CodePackage* can register more than one *ServiceType*).</span></span> <span data-ttu-id="2e31b-182">Här följer några hello scenarier där de här konfigurationerna kan vara användbara:</span><span class="sxs-lookup"><span data-stu-id="2e31b-182">Following are some of hello scenarios where these configurations can be useful:</span></span>

- <span data-ttu-id="2e31b-183">Vill du toooptimize OS resursutnyttjande genom att skapa färre processer och med tätare replik processer.</span><span class="sxs-lookup"><span data-stu-id="2e31b-183">You want toooptimize OS resource utilization by spawning fewer processes and having higher replica density per process.</span></span>
- <span data-ttu-id="2e31b-184">Repliker från olika ServiceTypes måste tooshare vissa vanliga data som har en hög initiering eller minne kostnad.</span><span class="sxs-lookup"><span data-stu-id="2e31b-184">Replicas from different ServiceTypes need tooshare some common data that has a high initialization or memory cost.</span></span>
- <span data-ttu-id="2e31b-185">Du har ett ledigt tjänsterbjudande och du vill tooput en gräns på resursutnyttjande genom att placera alla repliker av hello service i samma process.</span><span class="sxs-lookup"><span data-stu-id="2e31b-185">You have a free service offering and you want tooput a limit on resource utilization by putting all replicas of hello service in same process.</span></span>

<span data-ttu-id="2e31b-186">**Exklusiv processen** värdmodell är inte konsekvent med programmodell att flera *ServiceTypes* per *ServicePackage*.</span><span class="sxs-lookup"><span data-stu-id="2e31b-186">**Exclusive Process** hosting model is not coherent with application model having multiple *ServiceTypes* per *ServicePackage*.</span></span> <span data-ttu-id="2e31b-187">Detta beror på att flera *ServiceTypes* per *ServicePackage* är utformad tooachieve högre resursdelning mellan replikerna och aktiverar tätare replik processer.</span><span class="sxs-lookup"><span data-stu-id="2e31b-187">This is because multiple *ServiceTypes* per *ServicePackage* is designed tooachieve higher resource sharing among replicas and enables higher replica density per process.</span></span> <span data-ttu-id="2e31b-188">Detta är motstridiga toowhat **exklusiv processen** modellen är utformad tooachieve.</span><span class="sxs-lookup"><span data-stu-id="2e31b-188">This is contrary toowhat **Exclusive Process** model is designed tooachieve.</span></span>

<span data-ttu-id="2e31b-189">Överväg att hello fallet med flera *ServiceTypes* per *ServicePackage* med olika *CodePackage* registrera varje *ServiceType*.</span><span class="sxs-lookup"><span data-stu-id="2e31b-189">Consider hello case of multiple *ServiceTypes* per *ServicePackage* with different *CodePackage* registering each *ServiceType*.</span></span> <span data-ttu-id="2e31b-190">Anta att vi har en *ServicePackage* 'MultiTypeServicePackge' som har två *CodePackages*:</span><span class="sxs-lookup"><span data-stu-id="2e31b-190">Let's say we have a *ServicePackage* 'MultiTypeServicePackge' which has two *CodePackages*:</span></span>

- <span data-ttu-id="2e31b-191">'MyCodePackageA' som registrerar *ServiceType* 'MyServiceTypeA'.</span><span class="sxs-lookup"><span data-stu-id="2e31b-191">'MyCodePackageA' which registers *ServiceType* 'MyServiceTypeA'.</span></span>
- <span data-ttu-id="2e31b-192">'MyCodePackageB' som registrerar *ServiceType* 'MyServiceTypeB'.</span><span class="sxs-lookup"><span data-stu-id="2e31b-192">'MyCodePackageB' which registers *ServiceType* 'MyServiceTypeB'.</span></span>

<span data-ttu-id="2e31b-193">Nu kan exempelvis skapar vi ett *programmet* **fabric: / SpecialApp** och i **fabric: / SpecialApp** vi skapa följande två tjänster med **exklusiv processen** modellen:</span><span class="sxs-lookup"><span data-stu-id="2e31b-193">Now, lets say, we create an *application* **fabric:/SpecialApp** and inside **fabric:/SpecialApp** we create following two services with **Exclusive Process** model:</span></span>

- <span data-ttu-id="2e31b-194">Tjänsten **fabric: / SpecialApp/ServiceA** av typen 'MyServiceTypeA' med två partitioner (säg **P1** och **P2**) och 3 repliker per partition.</span><span class="sxs-lookup"><span data-stu-id="2e31b-194">Service **fabric:/SpecialApp/ServiceA** of type 'MyServiceTypeA' with two partitions (say **P1** and **P2**) and 3 replicas per partition.</span></span>
- <span data-ttu-id="2e31b-195">Tjänsten **fabric: / SpecialApp/ServiceB** av typen 'MyServiceTypeB' med två partitioner (säg **P3** och **P4**) och 3 repliker per partition.</span><span class="sxs-lookup"><span data-stu-id="2e31b-195">Service **fabric:/SpecialApp/ServiceB** of type 'MyServiceTypeB' with two partitions (say **P3** and **P4**) and 3 replicas per partition.</span></span>

<span data-ttu-id="2e31b-196">På en viss nod har båda hello-tjänsterna två repliker.</span><span class="sxs-lookup"><span data-stu-id="2e31b-196">On a given node, both hello services will have two replicas each.</span></span> <span data-ttu-id="2e31b-197">Eftersom vi använde **exklusiv processen** model toocreate hello-tjänster, Service Fabric aktiverar en ny kopia av 'MyServicePackge' för varje replik.</span><span class="sxs-lookup"><span data-stu-id="2e31b-197">Since we used **Exclusive Process** model toocreate hello services, Service Fabric will activate a new copy of 'MyServicePackge' for each replica.</span></span> <span data-ttu-id="2e31b-198">Varje aktivering av 'MultiTypeServicePackge' startar en kopia av 'MyCodePackageA' och 'MyCodePackageB'.</span><span class="sxs-lookup"><span data-stu-id="2e31b-198">Each activation of 'MultiTypeServicePackge' will start a copy of 'MyCodePackageA' and 'MyCodePackageB'.</span></span> <span data-ttu-id="2e31b-199">Endast en av 'MyCodePackageA' eller 'MyCodePackageB' ska dock vara värd för hello replik som 'MultiTypeServicePackge' har aktiverats.</span><span class="sxs-lookup"><span data-stu-id="2e31b-199">However, only one of 'MyCodePackageA' or 'MyCodePackageB' will host hello replica for which 'MultiTypeServicePackge' was activated.</span></span> <span data-ttu-id="2e31b-200">Följande diagram visar hello nod vy:</span><span class="sxs-lookup"><span data-stu-id="2e31b-200">Following diagram shows hello node view:</span></span>

<span data-ttu-id="2e31b-201"><center>
![Noden vy av distribuerade program][node-view-five]
</center></span><span class="sxs-lookup"><span data-stu-id="2e31b-201"><center>
![Node view of deployed application][node-view-five]
</center></span></span>

 <span data-ttu-id="2e31b-202">Som vi kan se i hello aktivering av 'MultiTypeServicePackge' för replik av partitionen **P1** för tjänsten **fabric: / SpecialApp/ServiceA**, hello replik är värd för 'MyCodePackageA' och ' MyCodePackageB' är bara aktiv och körs.</span><span class="sxs-lookup"><span data-stu-id="2e31b-202">As we can see, in hello activation of 'MultiTypeServicePackge' for replica of partition **P1** of service **fabric:/SpecialApp/ServiceA**, 'MyCodePackageA' is hosting hello replica and 'MyCodePackageB' is just up and running.</span></span> <span data-ttu-id="2e31b-203">På samma sätt i aktivering av 'MultiTypeServicePackge' för replik av partitionen **P3** för tjänsten **fabric: / SpecialApp/ServiceB**, hello replik är värd för 'MyCodePackageB' och 'MyCodePackageA' är just igång och så vidare.</span><span class="sxs-lookup"><span data-stu-id="2e31b-203">Similarly, in activation of 'MultiTypeServicePackge' for replica of partition **P3** of service **fabric:/SpecialApp/ServiceB**, 'MyCodePackageB' is hosting hello replica and 'MyCodePackageA' is just up and running and so on.</span></span> <span data-ttu-id="2e31b-204">Därför mer hello antalet *CodePackages* (registrera olika *ServiceTypes*) per *ServicePackage*, högre är redundant Resursanvändning.</span><span class="sxs-lookup"><span data-stu-id="2e31b-204">Hence, more hello number of *CodePackages* (registering different *ServiceTypes*) per *ServicePackage*, higher will be redundant resource usage.</span></span> 
 
 <span data-ttu-id="2e31b-205">Hej i andra hand om vi skapa tjänster **fabric: / SpecialApp/ServiceA** och **fabric: / SpecialApp/ServiceB** med **delad Process** modellen, kommer Service Fabric Aktivera bara en kopia av 'MultiTypeServicePackge' för *programmet* **fabric: / SpecialApp** (som vi såg tidigare).</span><span class="sxs-lookup"><span data-stu-id="2e31b-205">On hello other hand if we create services **fabric:/SpecialApp/ServiceA** and **fabric:/SpecialApp/ServiceB** with **Shared Process** model, Service Fabric will activate only one copy of 'MultiTypeServicePackge' for *application* **fabric:/SpecialApp** (as we saw previously).</span></span> <span data-ttu-id="2e31b-206">'MyCodePackageA' ska vara värd för alla repliker för tjänsten **fabric: / SpecialApp/ServiceA** (eller för en tjänst av typen 'MyServiceTypeA' toobe mer exakta) och 'MyCodePackageB' ska vara värd för alla repliker för tjänsten **fabric: / SpecialApp/ServiceB** (eller för en tjänst av typen 'MyServiceTypeB' toobe mer exakta).</span><span class="sxs-lookup"><span data-stu-id="2e31b-206">'MyCodePackageA' will host all replicas for service **fabric:/SpecialApp/ServiceA** (or of any service of type 'MyServiceTypeA' toobe more precise) and 'MyCodePackageB' will host all replicas for service **fabric:/SpecialApp/ServiceB** (or of any service of type 'MyServiceTypeB' toobe more precise).</span></span> <span data-ttu-id="2e31b-207">Följande diagram visar hello nod vyn i den här inställningen:</span><span class="sxs-lookup"><span data-stu-id="2e31b-207">Following diagram shows hello node view in this setting:</span></span> 

<span data-ttu-id="2e31b-208"><center>
![Noden vy av distribuerade program][node-view-six]
</center></span><span class="sxs-lookup"><span data-stu-id="2e31b-208"><center>
![Node view of deployed application][node-view-six]
</center></span></span>

<span data-ttu-id="2e31b-209">I ovanstående exempel hello, du tror om 'MyCodePackageA' registrerar både 'MyServiceTypeA' och 'MyServiceTypeB' och det finns inga MyCodePackageB sedan det blir inte redundant *CodePackage* körs.</span><span class="sxs-lookup"><span data-stu-id="2e31b-209">In hello above example, you might think if 'MyCodePackageA' registers both 'MyServiceTypeA' and 'MyServiceTypeB' and there is no 'MyCodePackageB', then there will be no redundant *CodePackage* running.</span></span> <span data-ttu-id="2e31b-210">Det här är korrekt, men som tidigare nämnts är det här programmodell inte överensstämmer med **exklusiv processen** värdmodell.</span><span class="sxs-lookup"><span data-stu-id="2e31b-210">This is correct, however, as mentioned previously, this application model does not align with **Exclusive Process** hosting model.</span></span> <span data-ttu-id="2e31b-211">Om målet är tooput dedikerad varje replik i en egen process registrera både *ServiceTypes* från samma *CodePackage* inte behövs och placera varje *ServiceType* i en egen *ServicePacakge* är ett mer naturligt val.</span><span class="sxs-lookup"><span data-stu-id="2e31b-211">If goal is tooput each replica in its own dedicated process then registering both *ServiceTypes* from same *CodePackage* is not needed and putting each *ServiceType* in its own *ServicePacakge* is a more natural choice.</span></span>

## <a name="next-steps"></a><span data-ttu-id="2e31b-212">Nästa steg</span><span class="sxs-lookup"><span data-stu-id="2e31b-212">Next steps</span></span>
<span data-ttu-id="2e31b-213">[Paketerar ett program] [ a4] och få redo toodeploy.</span><span class="sxs-lookup"><span data-stu-id="2e31b-213">[Package an application][a4] and get it ready toodeploy.</span></span>

<span data-ttu-id="2e31b-214">[Distribuera och ta bort program] [ a5] beskriver hur toouse PowerShell toomanage programinstanser.</span><span class="sxs-lookup"><span data-stu-id="2e31b-214">[Deploy and remove applications][a5] describes how toouse PowerShell toomanage application instances.</span></span>

<!--Image references-->
[node-view-one]: ./media/service-fabric-hosting-model/node-view-one.png
[node-view-two]: ./media/service-fabric-hosting-model/node-view-two.png
[node-view-three]: ./media/service-fabric-hosting-model/node-view-three.png
[node-view-four]: ./media/service-fabric-hosting-model/node-view-four.png
[node-view-five]: ./media/service-fabric-hosting-model/node-view-five.png
[node-view-six]: ./media/service-fabric-hosting-model/node-view-six.png

<!--Link references--In actual articles, you only need a single period before hello slash-->
[a1]: service-fabric-application-model.md
[a2]: service-fabric-deploy-existing-app.md
[a3]: service-fabric-containers-overview.md
[a4]: service-fabric-package-apps.md
[a5]: service-fabric-deploy-remove-applications.md

[r1]: https://docs.microsoft.com/rest/api/servicefabric/sfclient-api-createservice

[c1]: https://docs.microsoft.com/dotnet/api/system.fabric.fabricclient.servicemanagementclient.createserviceasync
[c2]: https://docs.microsoft.com/dotnet/api/system.fabric.description.statelessservicedescription.instancecount

[p1]: https://docs.microsoft.com/powershell/servicefabric/vlatest/new-servicefabricservice
[p2]: https://docs.microsoft.com/powershell/servicefabric/vlatest/get-servicefabricservicedescription
[p3]: https://docs.microsoft.com/powershell/servicefabric/vlatest/get-servicefabricdeployedservicePackage
[p4]: https://docs.microsoft.com/powershell/servicefabric/vlatest/send-servicefabricdeployedservicepackagehealthreport
[p5]: https://docs.microsoft.com/powershell/servicefabric/vlatest/restart-servicefabricdeployedcodepackage
[p6]: https://docs.microsoft.com/powershell/servicefabric/vlatest/get-servicefabricdeployedservicetype
[p7]: https://docs.microsoft.com/powershell/servicefabric/vlatest/get-servicefabricdeployedreplica
[p8]: https://docs.microsoft.com/powershell/servicefabric/vlatest/get-servicefabricdeployedcodepackage