---
title: "Kapacitetsplanering för Service Fabric-appar | Microsoft Docs"
description: "Beskriver hur du identifierar antalet compute-noder som krävs för ett Service Fabric-program"
services: service-fabric
documentationcenter: .net
author: mani-ramaswamy
manager: markfuss
editor: 
ms.assetid: 9fa47be0-50a2-4a51-84a5-20992af94bea
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 8/9/2017
ms.author: subramar
ms.openlocfilehash: fc98bdd8b3597810b0c07563af507e93c611f769
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 08/18/2017
---
# <a name="capacity-planning-for-service-fabric-applications"></a><span data-ttu-id="1afd8-103">Kapacitetsplanering för Service Fabric-program</span><span class="sxs-lookup"><span data-stu-id="1afd8-103">Capacity planning for Service Fabric applications</span></span>
<span data-ttu-id="1afd8-104">Det här dokumentet lär du dig hur du beräkna hur mycket resurser (processorer, minne, disk och lagring) måste du köra dina Azure Service Fabric-program.</span><span class="sxs-lookup"><span data-stu-id="1afd8-104">This document teaches you how to estimate the amount of resources (CPUs, RAM, disk storage) you need to run your Azure Service Fabric applications.</span></span> <span data-ttu-id="1afd8-105">Det är vanligt att resurskraven att förändras över tid.</span><span class="sxs-lookup"><span data-stu-id="1afd8-105">It is common for your resource requirements to change over time.</span></span> <span data-ttu-id="1afd8-106">Du kräver vanligtvis några resurser som du utvecklar och testning i tjänsten och sedan kräver mer resurser som du gå till produktion och programmet växer i större utsträckning.</span><span class="sxs-lookup"><span data-stu-id="1afd8-106">You typically require few resources as you develop/test your service, and then require more resources as you go into production and your application grows in popularity.</span></span> <span data-ttu-id="1afd8-107">När du skapar ditt program kan tänka igenom de långsiktiga kraven och fatta beslut som gör att din tjänst ska skalas för att uppfylla hög kundernas behov.</span><span class="sxs-lookup"><span data-stu-id="1afd8-107">When you design your application, think through the long-term requirements and make choices that allow your service to scale to meet high customer demand.</span></span>

 <span data-ttu-id="1afd8-108">När du skapar ett Service Fabric-kluster kan bestämma du vilka typer av virtuella datorer (VM) utgör klustret.</span><span class="sxs-lookup"><span data-stu-id="1afd8-108">When you create a Service Fabric cluster, you decide what kinds of virtual machines (VMs) make up the cluster.</span></span> <span data-ttu-id="1afd8-109">Varje virtuell dator har en begränsad mängd resurser i form av CPU (kärnor och hastighet), nätverkets bandbredd, RAM-minne och diskutrymme.</span><span class="sxs-lookup"><span data-stu-id="1afd8-109">Each VM comes with a limited amount of resources in the form of CPUs (cores and speed), network bandwidth, RAM, and disk storage.</span></span> <span data-ttu-id="1afd8-110">När din tjänst växer med tiden kan uppgradera du till virtuella datorer som erbjuder större resurser och/eller lägga till fler virtuella datorer i klustret.</span><span class="sxs-lookup"><span data-stu-id="1afd8-110">As your service grows over time, you can upgrade to VMs that offer greater resources and/or add more VMs to your cluster.</span></span> <span data-ttu-id="1afd8-111">Om du vill göra det senare, måste du skapa din tjänst först så att den kan dra nytta av nya virtuella datorer som hämta läggs till i klustret dynamiskt.</span><span class="sxs-lookup"><span data-stu-id="1afd8-111">To do the latter, you must architect your service initially so it can take advantage of new VMs that get dynamically added to the cluster.</span></span>

<span data-ttu-id="1afd8-112">Vissa tjänster hantera lite eller inga data på virtuella datorerna.</span><span class="sxs-lookup"><span data-stu-id="1afd8-112">Some services manage little to no data on the VMs themselves.</span></span> <span data-ttu-id="1afd8-113">Kapacitetsplanering för dessa tjänster bör därför fokuserar huvudsakligen på prestanda, vilket innebär att välja lämplig CPU (kärnor och hastighet) på de virtuella datorerna.</span><span class="sxs-lookup"><span data-stu-id="1afd8-113">Therefore, capacity planning for these services should focus primarily on performance, which means selecting the appropriate CPUs (cores and speed) of the VMs.</span></span> <span data-ttu-id="1afd8-114">Dessutom bör du bandbredd i nätverket, inklusive hur ofta nätverket överföringar sker och hur mycket data överförs.</span><span class="sxs-lookup"><span data-stu-id="1afd8-114">In addition, you should consider network bandwidth, including how frequently network transfers are occurring and how much data is being transferred.</span></span> <span data-ttu-id="1afd8-115">Om din tjänst måste utföra såväl som tjänsten Minnesanvändningen ökar, du kan lägga till flera virtuella datorer till klustret och Läs in balansen nätverket begär över alla virtuella datorer.</span><span class="sxs-lookup"><span data-stu-id="1afd8-115">If your service needs to perform well as service usage increases, you can add more VMs to the cluster and load balance the network requests across all the VMs.</span></span>

<span data-ttu-id="1afd8-116">För tjänster som hanterar stora mängder data på virtuella datorer, bör kapacitetsplanering fokuserar främst på storleken.</span><span class="sxs-lookup"><span data-stu-id="1afd8-116">For services that manage large amounts of data on the VMs, capacity planning should focus primarily on size.</span></span> <span data-ttu-id="1afd8-117">Därför bör du noga överväga kapaciteten för den Virtuella datorns RAM-minne och diskutrymme.</span><span class="sxs-lookup"><span data-stu-id="1afd8-117">Thus, you should carefully consider the capacity of the VM's RAM and disk storage.</span></span> <span data-ttu-id="1afd8-118">Hanteringssystemet virtuellt minne i Windows gör diskutrymme se ut RAM-minne för att programkod.</span><span class="sxs-lookup"><span data-stu-id="1afd8-118">The virtual memory management system in Windows makes disk space look like RAM to application code.</span></span> <span data-ttu-id="1afd8-119">Dessutom ger Service Fabric runtime smart växling som endast varm data i minnet och flytta cold data till disk.</span><span class="sxs-lookup"><span data-stu-id="1afd8-119">In addition, the Service Fabric runtime provides smart paging keeping only hot data in memory and moving the cold data to disk.</span></span> <span data-ttu-id="1afd8-120">Program kan därmed använda mer minne än vad som är fysiskt tillgängligt på den virtuella datorn.</span><span class="sxs-lookup"><span data-stu-id="1afd8-120">Applications can thus use more memory than is physically available on the VM.</span></span> <span data-ttu-id="1afd8-121">Med mer RAM-minne bara ökar prestanda, eftersom den virtuella datorn kan ha flera disklagring i RAM-minne.</span><span class="sxs-lookup"><span data-stu-id="1afd8-121">Having more RAM simply increases performance, since the VM can keep more disk storage in RAM.</span></span> <span data-ttu-id="1afd8-122">Den virtuella datorn som du väljer måste ha en disk som är tillräckligt stor för att lagra de data som du vill använda på den virtuella datorn.</span><span class="sxs-lookup"><span data-stu-id="1afd8-122">The VM you select should have a disk large enough to store the data that you want on the VM.</span></span> <span data-ttu-id="1afd8-123">På liknande sätt ska den virtuella datorn ha tillräckligt med RAM-minne för att ge dig den prestanda som du önskar.</span><span class="sxs-lookup"><span data-stu-id="1afd8-123">Similarly, the VM should have enough RAM to provide you with the performance you desire.</span></span> <span data-ttu-id="1afd8-124">Din tjänst data växer över tid, kan du lägga till fler virtuella datorer till klustret och partition data över alla virtuella datorer.</span><span class="sxs-lookup"><span data-stu-id="1afd8-124">If your service's data grows over time, you can add more VMs to the cluster and partition the data across all the VMs.</span></span>

## <a name="determine-how-many-nodes-you-need"></a><span data-ttu-id="1afd8-125">Fastställa hur många noder du behöver</span><span class="sxs-lookup"><span data-stu-id="1afd8-125">Determine how many nodes you need</span></span>
<span data-ttu-id="1afd8-126">Partitionering din tjänst kan du skala upp din tjänst data.</span><span class="sxs-lookup"><span data-stu-id="1afd8-126">Partitioning your service allows you to scale out your service's data.</span></span> <span data-ttu-id="1afd8-127">Mer information om partitionering finns [partitionering Service Fabric](service-fabric-concepts-partitioning.md).</span><span class="sxs-lookup"><span data-stu-id="1afd8-127">For more information on partitioning, see [Partitioning Service Fabric](service-fabric-concepts-partitioning.md).</span></span> <span data-ttu-id="1afd8-128">Varje partition måste få plats i en enda virtuell dator, men flera (små) partitioner kan placeras på en enda virtuell dator.</span><span class="sxs-lookup"><span data-stu-id="1afd8-128">Each partition must fit within a single VM, but multiple (small) partitions can be placed on a single VM.</span></span> <span data-ttu-id="1afd8-129">Därför ger har flera mindre partitioner dig större flexibilitet än att ha några större partitioner.</span><span class="sxs-lookup"><span data-stu-id="1afd8-129">So, having more small partitions gives you greater flexibility than having a few larger partitions.</span></span> <span data-ttu-id="1afd8-130">En kompromiss är att ha många partitioner ökar Service Fabric kostnader och du kan inte utföra överförda åtgärder mellan partitioner.</span><span class="sxs-lookup"><span data-stu-id="1afd8-130">The trade-off is that having lots of partitions increases Service Fabric overhead and you cannot perform transacted operations across partitions.</span></span> <span data-ttu-id="1afd8-131">Det finns också flera potentiella nätverkstrafik om koden för tjänsten behöver ofta åtkomst till delar av data som finns i olika partitioner.</span><span class="sxs-lookup"><span data-stu-id="1afd8-131">There is also more potential network traffic if your service code frequently needs to access pieces of data that live in different partitions.</span></span> <span data-ttu-id="1afd8-132">När du utformar din tjänst kan bör du noggrant dessa- och nackdelar för att få fram en effektiv partitionering strategi.</span><span class="sxs-lookup"><span data-stu-id="1afd8-132">When designing your service, you should carefully consider these pros and cons to arrive at an effective partitioning strategy.</span></span>

<span data-ttu-id="1afd8-133">Anta att programmet har en enda tillståndskänslig tjänst som har en store-storlek som du förväntar dig att växa till DB_Size GB i ett år.</span><span class="sxs-lookup"><span data-stu-id="1afd8-133">Let's assume your application has a single stateful service that has a store size that you expect to grow to DB_Size GB in a year.</span></span> <span data-ttu-id="1afd8-134">Du är beredd att lägga till fler program (och partitioner) som uppstår tillväxt utöver det aktuella året.</span><span class="sxs-lookup"><span data-stu-id="1afd8-134">You are willing to add more applications (and partitions) as you experience growth beyond that year.</span></span>  <span data-ttu-id="1afd8-135">Replikering faktorn (RF) som anger antalet repliker för din tjänst påverkar den totala DB_Size.</span><span class="sxs-lookup"><span data-stu-id="1afd8-135">The replication factor (RF), which determines the number of replicas for your service impacts the total DB_Size.</span></span> <span data-ttu-id="1afd8-136">Totalt antal DB_Size över alla repliker är replikering faktorn multiplicerat med DB_Size.</span><span class="sxs-lookup"><span data-stu-id="1afd8-136">The total DB_Size across all replicas is the Replication Factor multiplied by DB_Size.</span></span>  <span data-ttu-id="1afd8-137">Node_Size representerar disk space/RAM per nod som du vill använda för din tjänst.</span><span class="sxs-lookup"><span data-stu-id="1afd8-137">Node_Size represents the disk space/RAM per node you want to use for your service.</span></span> <span data-ttu-id="1afd8-138">För bästa prestanda i DB_Size bör ryms i minnet i klustret och en Node_Size är runt ram-MINNET på den virtuella datorn bör väljas.</span><span class="sxs-lookup"><span data-stu-id="1afd8-138">For best performance, the DB_Size should fit into memory across the cluster, and a Node_Size that is around the RAM of the VM should be chosen.</span></span> <span data-ttu-id="1afd8-139">Genom att allokera en Node_Size som är större än kapaciteten som RAM-minne, måste sidindelning som tillhandahålls av Service Fabric-körningen.</span><span class="sxs-lookup"><span data-stu-id="1afd8-139">By allocating a Node_Size that is larger than the RAM capacity, you are relying on the paging provided by the Service Fabric runtime.</span></span> <span data-ttu-id="1afd8-140">Prestandan kanske därför inte är optimalt om din hela data ska anses vara varm (sedan dess data är växlingsbart systemminne in/ut).</span><span class="sxs-lookup"><span data-stu-id="1afd8-140">Thus, your performance may not be optimal if your entire data is considered to be hot (since then the data is paged in/out).</span></span> <span data-ttu-id="1afd8-141">För många tjänster där endast en del av data är hot, är det dock mer kostnadseffektivt.</span><span class="sxs-lookup"><span data-stu-id="1afd8-141">However, for many services where only a fraction of the data is hot, it is more cost-effective.</span></span>

<span data-ttu-id="1afd8-142">Antalet noder som krävs för maximala prestanda kan beräknas enligt följande:</span><span class="sxs-lookup"><span data-stu-id="1afd8-142">The number of nodes required for maximum performance can be computed as follows:</span></span>

```
Number of Nodes = (DB_Size * RF)/Node_Size

```


## <a name="account-for-growth"></a><span data-ttu-id="1afd8-143">Konto för tillväxt</span><span class="sxs-lookup"><span data-stu-id="1afd8-143">Account for growth</span></span>
<span data-ttu-id="1afd8-144">Du kanske vill beräkna antalet noder baserat på DB_Size som du förväntar dig att växa till, förutom DB_Size som du började med tjänsten.</span><span class="sxs-lookup"><span data-stu-id="1afd8-144">You may want to compute the number of nodes based on the DB_Size that you expect your service to grow to, in addition to the DB_Size that you began with.</span></span> <span data-ttu-id="1afd8-145">Utöka sedan antalet noder i takt med din tjänst växer så att du inte överbelasta antalet noder.</span><span class="sxs-lookup"><span data-stu-id="1afd8-145">Then, grow the number of nodes as your service grows so that you are not over-provisioning the number of nodes.</span></span> <span data-ttu-id="1afd8-146">Men antalet partitioner ska baseras på antalet noder som behövs när du kör din tjänst på högsta tillväxt.</span><span class="sxs-lookup"><span data-stu-id="1afd8-146">But the number of partitions should be based on the number of nodes that are needed when you're running your service at maximum growth.</span></span>

<span data-ttu-id="1afd8-147">Det är bra att ha vissa extra datorer som är tillgängliga när som helst så att du kan hantera alla oväntat toppar eller fel (till exempel om några virtuella datorer gå).</span><span class="sxs-lookup"><span data-stu-id="1afd8-147">It is good to have some extra machines available at any time so that you can handle any unexpected spikes or failure (for example, if a few VMs go down).</span></span>  <span data-ttu-id="1afd8-148">Extra kapacitet ska fastställas med hjälp av din förväntade toppar, utgångspunkt är att reservera några extra VM: ar (5-10 procent extra).</span><span class="sxs-lookup"><span data-stu-id="1afd8-148">While the extra capacity should be determined by using your expected spikes, a starting point is to reserve a few extra VMs (5-10 percent extra).</span></span>

<span data-ttu-id="1afd8-149">Den föregående förutsätter en enda tillståndskänslig tjänst.</span><span class="sxs-lookup"><span data-stu-id="1afd8-149">The preceding assumes a single stateful service.</span></span> <span data-ttu-id="1afd8-150">Om du har mer än en tillståndskänslig service måste du lägga till DB_Size som är associerade med andra tjänster till formeln.</span><span class="sxs-lookup"><span data-stu-id="1afd8-150">If you have more than one stateful service, you have to add the DB_Size associated with the other services into the equation.</span></span> <span data-ttu-id="1afd8-151">Alternativt kan du beräkna antalet noder separat för varje tillståndskänslig service.</span><span class="sxs-lookup"><span data-stu-id="1afd8-151">Alternatively, you can compute the number of nodes separately for each stateful service.</span></span>  <span data-ttu-id="1afd8-152">Tjänsten kan ha repliker eller partitioner som inte är Balanserat.</span><span class="sxs-lookup"><span data-stu-id="1afd8-152">Your service may have replicas or partitions that aren't balanced.</span></span> <span data-ttu-id="1afd8-153">Tänk på att partitioner kan också ha fler data än andra.</span><span class="sxs-lookup"><span data-stu-id="1afd8-153">Keep in mind that partitions may also have more data than others.</span></span> <span data-ttu-id="1afd8-154">Mer information om partitionering finns [partitionering artikel om bästa praxis](service-fabric-concepts-partitioning.md).</span><span class="sxs-lookup"><span data-stu-id="1afd8-154">For more information on partitioning, see [partitioning article on best practices](service-fabric-concepts-partitioning.md).</span></span> <span data-ttu-id="1afd8-155">Föregående formeln är dock partition och repliken storleksoberoende eftersom Service Fabric ser till att replikerna sprids bland noder på ett optimerat sätt.</span><span class="sxs-lookup"><span data-stu-id="1afd8-155">However, the preceding equation is partition and replica agnostic, because Service Fabric ensures that the replicas are spread out among the nodes in an optimized manner.</span></span>

## <a name="use-a-spreadsheet-for-cost-calculation"></a><span data-ttu-id="1afd8-156">Använda ett kalkylblad för beräkning</span><span class="sxs-lookup"><span data-stu-id="1afd8-156">Use a spreadsheet for cost calculation</span></span>
<span data-ttu-id="1afd8-157">Nu ska vi lägga reellt tal i formeln.</span><span class="sxs-lookup"><span data-stu-id="1afd8-157">Now let's put some real numbers in the formula.</span></span> <span data-ttu-id="1afd8-158">En [exempel kalkylblad](https://servicefabricsdkstorage.blob.core.windows.net/publicrelease/SF%20VM%20Cost%20calculator-NEW.xlsx) visar hur du planerar kapaciteten för ett program som innehåller tre typer av dataobjekt.</span><span class="sxs-lookup"><span data-stu-id="1afd8-158">An [example spreadsheet](https://servicefabricsdkstorage.blob.core.windows.net/publicrelease/SF%20VM%20Cost%20calculator-NEW.xlsx) shows how to plan the capacity for an application that contains three types of data objects.</span></span> <span data-ttu-id="1afd8-159">Vi ungefär storleken och hur många objekt som vi räknar med att ha för varje objekt.</span><span class="sxs-lookup"><span data-stu-id="1afd8-159">For each object, we approximate its size and how many objects we expect to have.</span></span> <span data-ttu-id="1afd8-160">Vi kan också välja hur många repliker som vi vill för varje objekttyp.</span><span class="sxs-lookup"><span data-stu-id="1afd8-160">We also select how many replicas we want of each object type.</span></span> <span data-ttu-id="1afd8-161">Kalkylbladet beräknar den totala mängden minne som ska lagras i klustret.</span><span class="sxs-lookup"><span data-stu-id="1afd8-161">The spreadsheet calculates the total amount of memory to be stored in the cluster.</span></span>

<span data-ttu-id="1afd8-162">Vi ange sedan ett VM-storlek och månadskostnaden.</span><span class="sxs-lookup"><span data-stu-id="1afd8-162">Then we enter a VM size and monthly cost.</span></span> <span data-ttu-id="1afd8-163">Baserat på VM-storlek, anger kalkylbladet det minsta antalet partitioner måste du använda för att dela dina data fysiskt plats på noderna.</span><span class="sxs-lookup"><span data-stu-id="1afd8-163">Based on the VM size, the spreadsheet tells you the minimum number of partitions you must use to split your data to physically fit on the nodes.</span></span> <span data-ttu-id="1afd8-164">Du kanske vill ha ett större antal partitioner för att hantera ditt programs specifika beräkning och nätverkstrafiken måste.</span><span class="sxs-lookup"><span data-stu-id="1afd8-164">You may desire a larger number of partitions to accommodate your application's specific computation and network traffic needs.</span></span> <span data-ttu-id="1afd8-165">Kalkylbladet visar antalet partitioner som hanterar profil användarobjekt har ökat från en till sex.</span><span class="sxs-lookup"><span data-stu-id="1afd8-165">The spreadsheet shows the number of partitions that are managing the user profile objects has increased from one to six.</span></span>

<span data-ttu-id="1afd8-166">Baserat på den här informationen i kalkylbladet innehåller nu att du fysiskt gick att hämta alla data med önskad partitioner och repliker på ett kluster med noder 26.</span><span class="sxs-lookup"><span data-stu-id="1afd8-166">Now, based on all this information, the spreadsheet shows that you could physically get all the data with the desired partitions and replicas on a 26-node cluster.</span></span> <span data-ttu-id="1afd8-167">Men skulle det här klustret tätt packas, så du kan vissa ytterligare noder för nodfel och uppgraderingar.</span><span class="sxs-lookup"><span data-stu-id="1afd8-167">However, this cluster would be densely packed, so you may want some additional nodes to accommodate node failures and upgrades.</span></span> <span data-ttu-id="1afd8-168">Kalkylbladet visar också att med mer än 57 noder ger inga ytterligare värde eftersom du ha tomma noder.</span><span class="sxs-lookup"><span data-stu-id="1afd8-168">The spreadsheet also shows that having more than 57 nodes provides no additional value because you would have empty nodes.</span></span> <span data-ttu-id="1afd8-169">Igen, kanske du vill gå över 57 noder ändå för att passa nodfel och uppgraderingar.</span><span class="sxs-lookup"><span data-stu-id="1afd8-169">Again, you may want to go above 57 nodes anyway to accommodate node failures and upgrades.</span></span> <span data-ttu-id="1afd8-170">Du kan justera kalkylblad för att matcha ditt programs specifika behov.</span><span class="sxs-lookup"><span data-stu-id="1afd8-170">You can tweak the spreadsheet to match your application's specific needs.</span></span>   

![Kalkylblad för beräkningen][Image1]

## <a name="next-steps"></a><span data-ttu-id="1afd8-172">Nästa steg</span><span class="sxs-lookup"><span data-stu-id="1afd8-172">Next steps</span></span>
<span data-ttu-id="1afd8-173">Checka ut [partitionering Service Fabric services] [ 10] för mer information om partitionering din tjänst.</span><span class="sxs-lookup"><span data-stu-id="1afd8-173">Check out [Partitioning Service Fabric services][10] to learn more about partitioning your service.</span></span>

<!--Image references-->
[Image1]: ./media/SF-Cost.png

<!--Link references--In actual articles, you only need a single period before the slash-->
[10]: service-fabric-concepts-partitioning.md
