---
title: uppgradering av aaaService Fabric programmet | Microsoft Docs
description: "Den här artikeln innehåller en introduktion tooupgrading ett Service Fabric-program, inklusive att välja uppgradera lägen och utför hälsokontroller."
services: service-fabric
documentationcenter: .net
author: mani-ramaswamy
manager: timlt
editor: 
ms.assetid: 803c9c63-373a-4d6a-8ef2-ea97e16e88dd
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 8/9/2017
ms.author: subramar
ms.openlocfilehash: 6f649ef4a5c0afab682522bcba7d2d66a4268ead
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 10/06/2017
---
# <a name="service-fabric-application-upgrade"></a><span data-ttu-id="dd90d-103">Uppgradera Service Fabric-programmet</span><span class="sxs-lookup"><span data-stu-id="dd90d-103">Service Fabric application upgrade</span></span>
<span data-ttu-id="dd90d-104">Ett program med Azure Service Fabric är en samling tjänster.</span><span class="sxs-lookup"><span data-stu-id="dd90d-104">An Azure Service Fabric application is a collection of services.</span></span> <span data-ttu-id="dd90d-105">Under en uppgradering, Service Fabric jämför hello nya [programmanifestet](service-fabric-application-model.md#describe-an-application) med hello tidigare version och avgör vilka tjänster i hello program kräver uppdateringar.</span><span class="sxs-lookup"><span data-stu-id="dd90d-105">During an upgrade, Service Fabric compares hello new [application manifest](service-fabric-application-model.md#describe-an-application) with hello previous version and determines which services in hello application require updates.</span></span> <span data-ttu-id="dd90d-106">Service Fabric jämför hello version siffror i hello-tjänsten visar hello versionsnumren i hello tidigare version.</span><span class="sxs-lookup"><span data-stu-id="dd90d-106">Service Fabric compares hello version numbers in hello service manifests with hello version numbers in hello previous version.</span></span> <span data-ttu-id="dd90d-107">Om en tjänst inte har ändrats, uppgraderas att tjänsten inte.</span><span class="sxs-lookup"><span data-stu-id="dd90d-107">If a service has not changed, that service is not upgraded.</span></span>

## <a name="rolling-upgrades-overview"></a><span data-ttu-id="dd90d-108">Rullande uppgraderingar översikt</span><span class="sxs-lookup"><span data-stu-id="dd90d-108">Rolling upgrades overview</span></span>
<span data-ttu-id="dd90d-109">I en löpande uppgradering av programmet utförs hello uppgraderingen i etapper.</span><span class="sxs-lookup"><span data-stu-id="dd90d-109">In a rolling application upgrade, hello upgrade is performed in stages.</span></span> <span data-ttu-id="dd90d-110">I varje fas är hello uppgradering tillämpade tooa delmängd av noderna i klustret hello, kallas en uppdateringsdomän.</span><span class="sxs-lookup"><span data-stu-id="dd90d-110">At each stage, hello upgrade is applied tooa subset of nodes in hello cluster, called an update domain.</span></span> <span data-ttu-id="dd90d-111">Därför kvar hello programmet hello uppgraderingens.</span><span class="sxs-lookup"><span data-stu-id="dd90d-111">As a result, hello application remains available throughout hello upgrade.</span></span> <span data-ttu-id="dd90d-112">Under uppgraderingen hello kan hello kluster innehåller en blandning av hello gamla och nya versioner.</span><span class="sxs-lookup"><span data-stu-id="dd90d-112">During hello upgrade, hello cluster may contain a mix of hello old and new versions.</span></span>

<span data-ttu-id="dd90d-113">Hello två versioner måste därför vara framåt och bakåt kompatibel.</span><span class="sxs-lookup"><span data-stu-id="dd90d-113">For that reason, hello two versions must be forward and backward compatible.</span></span> <span data-ttu-id="dd90d-114">Om de inte är kompatibla ansvarar hello programadministratör för mellanlagring av en flera-fas uppgradera toomaintain tillgänglighet.</span><span class="sxs-lookup"><span data-stu-id="dd90d-114">If they are not compatible, hello application administrator is responsible for staging a multiple-phase upgrade toomaintain availability.</span></span> <span data-ttu-id="dd90d-115">Uppgraderar en flera-fas uppgraderas hello första steget tooan mellanliggande version av hello-programmet som är kompatibel med hello tidigare version.</span><span class="sxs-lookup"><span data-stu-id="dd90d-115">In a multiple-phase upgrade, hello first step is upgrading tooan intermediate version of hello application that is compatible with hello previous version.</span></span> <span data-ttu-id="dd90d-116">hello andra steget är tooupgrade hello slutliga versionen som bryter kompatibilitet med hello före uppdateringen version, men som är kompatibel med hello mellanliggande versionen.</span><span class="sxs-lookup"><span data-stu-id="dd90d-116">hello second step is tooupgrade hello final version that breaks compatibility with hello pre-update version, but is compatible with hello intermediate version.</span></span>

<span data-ttu-id="dd90d-117">Uppdatera domäner har angetts i klustermanifestet hello när du konfigurerar hello kluster.</span><span class="sxs-lookup"><span data-stu-id="dd90d-117">Update domains are specified in hello cluster manifest when you configure hello cluster.</span></span> <span data-ttu-id="dd90d-118">Uppdatera domäner får inte uppdateringar i en viss ordning.</span><span class="sxs-lookup"><span data-stu-id="dd90d-118">Update domains do not receive updates in a particular order.</span></span> <span data-ttu-id="dd90d-119">En uppdateringsdomän är en logisk enhet för distribution för ett program.</span><span class="sxs-lookup"><span data-stu-id="dd90d-119">An update domain is a logical unit of deployment for an application.</span></span> <span data-ttu-id="dd90d-120">Uppdatera domäner tillåta hello tjänster tooremain vid hög tillgänglighet under en uppgradering.</span><span class="sxs-lookup"><span data-stu-id="dd90d-120">Update domains allow hello services tooremain at high availability during an upgrade.</span></span>

<span data-ttu-id="dd90d-121">Icke-rullande uppgraderingar kan utföras om hello uppgraderingen är tillämpade tooall noder i hello-kluster, vilket är fallet för hello när hello programmet har bara en uppdateringsdomän.</span><span class="sxs-lookup"><span data-stu-id="dd90d-121">Non-rolling upgrades are possible if hello upgrade is applied tooall nodes in hello cluster, which is hello case when hello application has only one update domain.</span></span> <span data-ttu-id="dd90d-122">Den här metoden rekommenderas inte eftersom tjänsten hello kraschar och inte är tillgänglig vid hello tiden för uppgraderingen.</span><span class="sxs-lookup"><span data-stu-id="dd90d-122">This approach is not recommended, since hello service goes down and isn't available at hello time of upgrade.</span></span> <span data-ttu-id="dd90d-123">Dessutom tillhandahåller inte Azure garantier när ett kluster har konfigurerats med endast en uppdateringsdomän.</span><span class="sxs-lookup"><span data-stu-id="dd90d-123">Additionally, Azure doesn't provide any guarantees when a cluster is set up with only one update domain.</span></span>

## <a name="health-checks-during-upgrades"></a><span data-ttu-id="dd90d-124">Hälsokontroller under uppgradering</span><span class="sxs-lookup"><span data-stu-id="dd90d-124">Health checks during upgrades</span></span>
<span data-ttu-id="dd90d-125">Hälsoprinciper har toobe som angetts för en uppgradering (eller standardvärden kan användas).</span><span class="sxs-lookup"><span data-stu-id="dd90d-125">For an upgrade, health policies have toobe set (or default values may be used).</span></span> <span data-ttu-id="dd90d-126">En uppgradering kallas lyckas när alla update domäner uppgraderas inom hello angivna timeout och när alla uppdaterar domäner bedöms felfritt.</span><span class="sxs-lookup"><span data-stu-id="dd90d-126">An upgrade is termed successful when all update domains are upgraded within hello specified time-outs, and when all update domains are deemed healthy.</span></span>  <span data-ttu-id="dd90d-127">En felfri uppdateringsdomän innebär hello update domänen skickas alla hello hälsokontroller som anges i hello hälsoprincip.</span><span class="sxs-lookup"><span data-stu-id="dd90d-127">A healthy update domain means that hello update domain passed all hello health checks specified in hello health policy.</span></span> <span data-ttu-id="dd90d-128">Till exempel en hälsoprincip kan behovet av att alla tjänster i en programinstans måste vara *felfri*, som health definieras av Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="dd90d-128">For example, a health policy may mandate that all services within an application instance must be *healthy*, as health is defined by Service Fabric.</span></span>

<span data-ttu-id="dd90d-129">Hälsoprinciper och kontrollerar under uppgradering av Service Fabric är oberoende av tjänster och program.</span><span class="sxs-lookup"><span data-stu-id="dd90d-129">Health policies and checks during upgrade by Service Fabric are service and application agnostic.</span></span> <span data-ttu-id="dd90d-130">Det vill säga är inga tjänstspecifika tester klar.</span><span class="sxs-lookup"><span data-stu-id="dd90d-130">That is, no service-specific tests are done.</span></span>  <span data-ttu-id="dd90d-131">Exempelvis din tjänst kan ha ett genomflöde krav, men Service Fabric saknar hello information toocheck genomflöde.</span><span class="sxs-lookup"><span data-stu-id="dd90d-131">For example, your service might have a throughput requirement, but Service Fabric does not have hello information toocheck throughput.</span></span> <span data-ttu-id="dd90d-132">Se toohello [hälsa artiklar](service-fabric-health-introduction.md) för hello-kontroller som utförs.</span><span class="sxs-lookup"><span data-stu-id="dd90d-132">Refer toohello [health articles](service-fabric-health-introduction.md) for hello checks that are performed.</span></span> <span data-ttu-id="dd90d-133">hello kontrollerar att inträffar under en uppgradering inkludera tester för om hello programpaketet har kopierats korrekt om hello-instansen har startats och så vidare.</span><span class="sxs-lookup"><span data-stu-id="dd90d-133">hello checks that happen during an upgrade include tests for whether hello application package was copied correctly, whether hello instance was started, and so on.</span></span>

<span data-ttu-id="dd90d-134">Hej programhälsan är en sammanställning av hello underordnade entiteter av programmet hello.</span><span class="sxs-lookup"><span data-stu-id="dd90d-134">hello application health is an aggregation of hello child entities of hello application.</span></span> <span data-ttu-id="dd90d-135">Kort sagt, utvärderar Service Fabric hello program via hello hälsa som rapporteras till hello programmet hello hälsa.</span><span class="sxs-lookup"><span data-stu-id="dd90d-135">In short, Service Fabric evaluates hello health of hello application through hello health that is reported on hello application.</span></span> <span data-ttu-id="dd90d-136">Även utvärderas hello hälsotillståndet för alla hello-tjänster för programmet hello det här sättet.</span><span class="sxs-lookup"><span data-stu-id="dd90d-136">It also evaluates hello health of all hello services for hello application this way.</span></span> <span data-ttu-id="dd90d-137">Service Fabric ytterligare utvärderar hello hälsotillstånd hello programtjänster genom att sammanställa hello hälsotillståndet för deras underordnade, till exempel hello service replik.</span><span class="sxs-lookup"><span data-stu-id="dd90d-137">Service Fabric further evaluates hello health of hello application services by aggregating hello health of their children, such as hello service replica.</span></span> <span data-ttu-id="dd90d-138">När hello programmets hälsoprincip är uppfyllt, kan hello uppgraderingen fortsätta.</span><span class="sxs-lookup"><span data-stu-id="dd90d-138">Once hello application health policy is satisfied, hello upgrade can proceed.</span></span> <span data-ttu-id="dd90d-139">Uppgradering av programmet hello misslyckas om hello hälsoprincip har överskridits.</span><span class="sxs-lookup"><span data-stu-id="dd90d-139">If hello health policy is violated, hello application upgrade fails.</span></span>

## <a name="upgrade-modes"></a><span data-ttu-id="dd90d-140">Uppgradera lägen</span><span class="sxs-lookup"><span data-stu-id="dd90d-140">Upgrade modes</span></span>
<span data-ttu-id="dd90d-141">hello-läge som vi rekommenderar för uppgradering av programmet är hello övervakas läge, som är vanliga hello läge.</span><span class="sxs-lookup"><span data-stu-id="dd90d-141">hello mode that we recommend for application upgrade is hello monitored mode, which is hello commonly used mode.</span></span> <span data-ttu-id="dd90d-142">Övervakat läge utför hello uppgradering på en uppdateringsdomän och om alla hälsa kontrollerar pass (per hello principen har angetts), flyttar toohello nästa uppdateringsdomän automatiskt.</span><span class="sxs-lookup"><span data-stu-id="dd90d-142">Monitored mode performs hello upgrade on one update domain, and if all health checks pass (per hello policy specified), moves on toohello next update domain automatically.</span></span>  <span data-ttu-id="dd90d-143">Om hälsokontroller misslyckas och/eller timeout har uppnåtts, hello uppgraderingen återställs antingen för hello uppdateringsdomän eller hello läge är ändrade toounmonitored manuell.</span><span class="sxs-lookup"><span data-stu-id="dd90d-143">If health checks fail and/or time-outs are reached, hello upgrade is either rolled back for hello update domain, or hello mode is changed toounmonitored manual.</span></span> <span data-ttu-id="dd90d-144">Du kan konfigurera hello uppgradera toochoose dessa två lägen för misslyckad uppgradering.</span><span class="sxs-lookup"><span data-stu-id="dd90d-144">You can configure hello upgrade toochoose one of those two modes for failed upgrades.</span></span> 

<span data-ttu-id="dd90d-145">Oövervakade manuellt läge måste manuell åtgärd efter varje uppgradering på en uppdateringsdomän, tookick av hello uppgraderingen på hello nästa uppdateringsdomän.</span><span class="sxs-lookup"><span data-stu-id="dd90d-145">Unmonitored manual mode needs manual intervention after every upgrade on an update domain, tookick off hello upgrade on hello next update domain.</span></span> <span data-ttu-id="dd90d-146">Ingen Service Fabric-hälsokontroller utförs.</span><span class="sxs-lookup"><span data-stu-id="dd90d-146">No Service Fabric health checks are performed.</span></span> <span data-ttu-id="dd90d-147">Hej administratör utför hello hälsa och status kontrollerna innan du påbörjar uppgraderingen hello i hello nästa uppdateringsdomän.</span><span class="sxs-lookup"><span data-stu-id="dd90d-147">hello administrator performs hello health or status checks before starting hello upgrade in hello next update domain.</span></span>

## <a name="upgrade-default-services"></a><span data-ttu-id="dd90d-148">Uppgradera standardtjänster</span><span class="sxs-lookup"><span data-stu-id="dd90d-148">Upgrade default services</span></span>
<span data-ttu-id="dd90d-149">Standardtjänster i Service Fabric-programmet kan uppgraderas under hello uppgraderingen av ett program.</span><span class="sxs-lookup"><span data-stu-id="dd90d-149">Default services within Service Fabric application can be upgraded during hello upgrade process of an application.</span></span> <span data-ttu-id="dd90d-150">Standardtjänster definieras i hello [programmanifestet](service-fabric-application-model.md#describe-an-application).</span><span class="sxs-lookup"><span data-stu-id="dd90d-150">Default services are defined in hello [application manifest](service-fabric-application-model.md#describe-an-application).</span></span> <span data-ttu-id="dd90d-151">hello standardregler för att uppgradera standardtjänster är:</span><span class="sxs-lookup"><span data-stu-id="dd90d-151">hello standard rules of upgrading default services are:</span></span>

1. <span data-ttu-id="dd90d-152">Standard tjänster i hello nya [programmanifestet](service-fabric-application-model.md#describe-an-application) som inte finns i hello klustret skapas.</span><span class="sxs-lookup"><span data-stu-id="dd90d-152">Default services in hello new [application manifest](service-fabric-application-model.md#describe-an-application) that do not exist in hello cluster are created.</span></span>
> [!TIP]
> <span data-ttu-id="dd90d-153">[EnableDefaultServicesUpgrade](service-fabric-cluster-fabric-settings.md#fabric-settings-that-you-can-customize) behov toobe ange tootrue tooenable hello följande regler.</span><span class="sxs-lookup"><span data-stu-id="dd90d-153">[EnableDefaultServicesUpgrade](service-fabric-cluster-fabric-settings.md#fabric-settings-that-you-can-customize) needs toobe set tootrue tooenable hello following rules.</span></span> <span data-ttu-id="dd90d-154">Den här funktionen stöds från version 5.5.</span><span class="sxs-lookup"><span data-stu-id="dd90d-154">This feature is supported from v5.5.</span></span>

2. <span data-ttu-id="dd90d-155">Standard tjänster finns i båda tidigare [programmanifestet](service-fabric-application-model.md#describe-an-application) och ny version har uppdaterats.</span><span class="sxs-lookup"><span data-stu-id="dd90d-155">Default services existing in both previous [application manifest](service-fabric-application-model.md#describe-an-application) and new version are updated.</span></span> <span data-ttu-id="dd90d-156">Beskrivningar av rolltjänster i den nya versionen av hello skulle skriva över de redan i hello klustret.</span><span class="sxs-lookup"><span data-stu-id="dd90d-156">Service descriptions in hello new version would overwrite those already in hello cluster.</span></span> <span data-ttu-id="dd90d-157">Uppgradering av programmet skulle återställning automatiskt vid uppdatering standard tjänstfel.</span><span class="sxs-lookup"><span data-stu-id="dd90d-157">Application upgrade would rollback automatically upon updating default service failure.</span></span>
3. <span data-ttu-id="dd90d-158">Standard tjänster i hello tidigare [programmanifestet](service-fabric-application-model.md#describe-an-application) men inte i den nya versionen av hello tas bort.</span><span class="sxs-lookup"><span data-stu-id="dd90d-158">Default services in hello previous [application manifest](service-fabric-application-model.md#describe-an-application) but not in hello new version are deleted.</span></span> <span data-ttu-id="dd90d-159">**Observera att detta tar bort standardtjänster inte kan återställas.**</span><span class="sxs-lookup"><span data-stu-id="dd90d-159">**Note that this deleting default services can not be reverted.**</span></span>

<span data-ttu-id="dd90d-160">Om ett program uppgraderingen återställs, är standardtjänster återställts toohello status innan uppgraderingen startas.</span><span class="sxs-lookup"><span data-stu-id="dd90d-160">In case of an application upgrade is rolled back, default services are reverted toohello status before upgrade started.</span></span> <span data-ttu-id="dd90d-161">Men aldrig borttagna tjänster kan skapas.</span><span class="sxs-lookup"><span data-stu-id="dd90d-161">But deleted services can never be created.</span></span>

## <a name="application-upgrade-flowchart"></a><span data-ttu-id="dd90d-162">Uppgradera flödesschema för programmet</span><span class="sxs-lookup"><span data-stu-id="dd90d-162">Application upgrade flowchart</span></span>
<span data-ttu-id="dd90d-163">hello flödesschema följande stycke kan hjälpa dig att förstå hello uppgraderingen av ett Service Fabric-program.</span><span class="sxs-lookup"><span data-stu-id="dd90d-163">hello flowchart following this paragraph can help you understand hello upgrade process of a Service Fabric application.</span></span> <span data-ttu-id="dd90d-164">I synnerhet hello flödet beskrivs hur hello timeout, inklusive *HealthCheckStableDuration*, *HealthCheckRetryTimeout*, och *UpgradeHealthCheckInterval*, hjälper dig att kontrollera när hello uppgradering i en uppdateringsdomän betraktas som en lyckats eller misslyckats.</span><span class="sxs-lookup"><span data-stu-id="dd90d-164">In particular, hello flow describes how hello time-outs, including *HealthCheckStableDuration*, *HealthCheckRetryTimeout*, and *UpgradeHealthCheckInterval*, help control when hello upgrade in one update domain is considered a success or a failure.</span></span>

![hello uppgraderingsprocessen för ett Service Fabric-program][image]

## <a name="next-steps"></a><span data-ttu-id="dd90d-166">Nästa steg</span><span class="sxs-lookup"><span data-stu-id="dd90d-166">Next steps</span></span>
<span data-ttu-id="dd90d-167">[Uppgradera ditt program med hjälp av Visual Studio](service-fabric-application-upgrade-tutorial.md) vägleder dig genom en uppgradering av programmet med hjälp av Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="dd90d-167">[Upgrading your Application Using Visual Studio](service-fabric-application-upgrade-tutorial.md) walks you through an application upgrade using Visual Studio.</span></span>

<span data-ttu-id="dd90d-168">[Uppgradera ditt program med hjälp av Powershell](service-fabric-application-upgrade-tutorial-powershell.md) vägleder dig genom en uppgradering av programmet med hjälp av PowerShell.</span><span class="sxs-lookup"><span data-stu-id="dd90d-168">[Upgrading your Application Using Powershell](service-fabric-application-upgrade-tutorial-powershell.md) walks you through an application upgrade using PowerShell.</span></span>

<span data-ttu-id="dd90d-169">Styra hur programmet ska uppgraderas med hjälp av [uppgradera parametrar](service-fabric-application-upgrade-parameters.md).</span><span class="sxs-lookup"><span data-stu-id="dd90d-169">Control how your application upgrades by using [Upgrade Parameters](service-fabric-application-upgrade-parameters.md).</span></span>

<span data-ttu-id="dd90d-170">Gör din programuppgraderingar kompatibla genom att lära dig hur toouse [dataserialisering](service-fabric-application-upgrade-data-serialization.md).</span><span class="sxs-lookup"><span data-stu-id="dd90d-170">Make your application upgrades compatible by learning how toouse [Data Serialization](service-fabric-application-upgrade-data-serialization.md).</span></span>

<span data-ttu-id="dd90d-171">Lär dig hur toouse avancerade funktioner när du uppgraderar ditt program genom att referera för[avancerade ämnen](service-fabric-application-upgrade-advanced.md).</span><span class="sxs-lookup"><span data-stu-id="dd90d-171">Learn how toouse advanced functionality while upgrading your application by referring too[Advanced Topics](service-fabric-application-upgrade-advanced.md).</span></span>

<span data-ttu-id="dd90d-172">Lösa vanliga problem i programuppgraderingar genom att referera toohello stegen i [felsökning programuppgraderingar](service-fabric-application-upgrade-troubleshooting.md).</span><span class="sxs-lookup"><span data-stu-id="dd90d-172">Fix common problems in application upgrades by referring toohello steps in [Troubleshooting Application Upgrades](service-fabric-application-upgrade-troubleshooting.md).</span></span>

[image]: media/service-fabric-application-upgrade/service-fabric-application-upgrade-flowchart.png
