---
title: Automatisera hantering av Azure Service Fabric | Microsoft Docs
description: "Distribuera, uppgradering, testa och ta bort Service Fabric-program med hjälp av PowerShell."
services: service-fabric
documentationcenter: .net
author: rwike77
manager: timlt
editor: 
ms.assetid: f03f4294-571d-4262-8a77-cc8b481b959d
ms.service: service-fabric
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: dotnet
ms.topic: article
ms.date: 06/16/2017
ms.author: ryanwi
redirect_url: /azure/service-fabric/service-fabric-deploy-remove-applications
ms.openlocfilehash: fb3c2a77ea887289eebf343e223c190781d0e4c2
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 07/11/2017
---
# <a name="automate-the-application-lifecycle-using-powershell"></a><span data-ttu-id="3df13-103">Automatisera livscykeln program med hjälp av PowerShell</span><span class="sxs-lookup"><span data-stu-id="3df13-103">Automate the application lifecycle using PowerShell</span></span>
<span data-ttu-id="3df13-104">Många aspekter av den [Service Fabric application livscykel](service-fabric-application-lifecycle.md) kan automatiseras.</span><span class="sxs-lookup"><span data-stu-id="3df13-104">Many aspects of the [Service Fabric application lifecycle](service-fabric-application-lifecycle.md) can be automated.</span></span>  <span data-ttu-id="3df13-105">Den här artikeln visar hur du använder PowerShell för att automatisera vanliga uppgifter för att distribuera, uppgradera, ta bort och testa Azure Service Fabric-program.</span><span class="sxs-lookup"><span data-stu-id="3df13-105">This article shows how to use PowerShell to automate common tasks for deploying, upgrading, removing, and testing Azure Service Fabric applications.</span></span>  <span data-ttu-id="3df13-106">Hanteras och HTTP-APIs för apphantering finns också tillgängliga.</span><span class="sxs-lookup"><span data-stu-id="3df13-106">Managed and HTTP APIs for app management are also available.</span></span> <span data-ttu-id="3df13-107">Se [applivscykeln](service-fabric-application-lifecycle.md) för mer information.</span><span class="sxs-lookup"><span data-stu-id="3df13-107">See [app lifecycle](service-fabric-application-lifecycle.md) for more information.</span></span>  

## <a name="prerequisites"></a><span data-ttu-id="3df13-108">Krav</span><span class="sxs-lookup"><span data-stu-id="3df13-108">Prerequisites</span></span>
<span data-ttu-id="3df13-109">Innan du gå vidare till aktiviteter i artikeln måste du:</span><span class="sxs-lookup"><span data-stu-id="3df13-109">Before you move on to the tasks in the article, be sure to:</span></span>

* <span data-ttu-id="3df13-110">Bekanta dig med Service Fabric-begrepp som beskrivs i [teknisk översikt över Service Fabric](service-fabric-technical-overview.md).</span><span class="sxs-lookup"><span data-stu-id="3df13-110">Get familiar with the Service Fabric concepts described in [Technical overview of Service Fabric](service-fabric-technical-overview.md).</span></span>
* <span data-ttu-id="3df13-111">[Installera runtime, verktyg och SDK](service-fabric-get-started.md), som installeras även den **ServiceFabric** PowerShell-modulen.</span><span class="sxs-lookup"><span data-stu-id="3df13-111">[Install the runtime, SDK, and tools](service-fabric-get-started.md), which also installs the **ServiceFabric** PowerShell module.</span></span>
* <span data-ttu-id="3df13-112">[Aktiverar körning av PowerShell-skript](service-fabric-get-started.md#enable-powershell-script-execution).</span><span class="sxs-lookup"><span data-stu-id="3df13-112">[Enable PowerShell script execution](service-fabric-get-started.md#enable-powershell-script-execution).</span></span>
* <span data-ttu-id="3df13-113">Starta en lokala klustret.</span><span class="sxs-lookup"><span data-stu-id="3df13-113">Start a local cluster.</span></span>  <span data-ttu-id="3df13-114">Starta ett nytt PowerShell-fönster som administratör och kör sedan installationsskriptet kluster från SDK-mappen:`& "$ENV:ProgramFiles\Microsoft SDKs\Service Fabric\ClusterSetup\DevClusterSetup.ps1"`</span><span class="sxs-lookup"><span data-stu-id="3df13-114">Launch a new PowerShell window as an administrator and then run the cluster setup script from the SDK folder: `& "$ENV:ProgramFiles\Microsoft SDKs\Service Fabric\ClusterSetup\DevClusterSetup.ps1"`</span></span>
* <span data-ttu-id="3df13-115">Innan du kör PowerShell-kommandon i den här artikeln först ansluta till det lokala Service Fabric-klustret med hjälp av [Connect-ServiceFabricCluster](/powershell/module/servicefabric/connect-servicefabriccluster?view=azureservicefabricps):`Connect-ServiceFabricCluster localhost:19000`</span><span class="sxs-lookup"><span data-stu-id="3df13-115">Before you run any PowerShell commands in this article, first connect to the local Service Fabric cluster by using [Connect-ServiceFabricCluster](/powershell/module/servicefabric/connect-servicefabriccluster?view=azureservicefabricps): `Connect-ServiceFabricCluster localhost:19000`</span></span>
* <span data-ttu-id="3df13-116">Följande uppgifter kräver ett v1-programpaket för att distribuera och ett v2 programpaket för uppgradering.</span><span class="sxs-lookup"><span data-stu-id="3df13-116">The following tasks require a v1 application package to deploy and a v2 application package for upgrade.</span></span> <span data-ttu-id="3df13-117">Hämta den [ **WordCount** exempelprogram](http://aka.ms/servicefabricsamples) (finns i komma igång-exempel).</span><span class="sxs-lookup"><span data-stu-id="3df13-117">Download the [**WordCount** sample application](http://aka.ms/servicefabricsamples) (located in the Getting Started samples).</span></span> <span data-ttu-id="3df13-118">Skapa och paketera program i Visual Studio (Högerklicka på **WordCount** i Solution Explorer och markera **paketet**).</span><span class="sxs-lookup"><span data-stu-id="3df13-118">Build and package the application in Visual Studio (right-click on **WordCount** in Solution Explorer and select **Package**).</span></span> <span data-ttu-id="3df13-119">Kopiera v1-paketet i `C:\ServiceFabricSamples\Services\WordCount\WordCount\pkg\Debug` till `C:\Temp\WordCount`.</span><span class="sxs-lookup"><span data-stu-id="3df13-119">Copy the v1 package in `C:\ServiceFabricSamples\Services\WordCount\WordCount\pkg\Debug` to `C:\Temp\WordCount`.</span></span> <span data-ttu-id="3df13-120">Kopiera `C:\Temp\WordCount` till `C:\Temp\WordCountV2`, skapar programpaket v2 för uppgradering.</span><span class="sxs-lookup"><span data-stu-id="3df13-120">Copy `C:\Temp\WordCount` to `C:\Temp\WordCountV2`, creating the v2 application package for upgrade.</span></span> <span data-ttu-id="3df13-121">Öppna `C:\Temp\WordCountV2\ApplicationManifest.xml` i en textredigerare.</span><span class="sxs-lookup"><span data-stu-id="3df13-121">Open `C:\Temp\WordCountV2\ApplicationManifest.xml` in a text editor.</span></span> <span data-ttu-id="3df13-122">I den **ApplicationManifest** element, ändring av **ApplicationTypeVersion** attribut från ”1.0.0” till ”2.0.0” för att uppdatera versionsnumret app.</span><span class="sxs-lookup"><span data-stu-id="3df13-122">In the **ApplicationManifest** element, change the **ApplicationTypeVersion** attribute from "1.0.0" to "2.0.0" to update the app version number.</span></span> <span data-ttu-id="3df13-123">Spara filen ändrade ApplicationManifest.xml.</span><span class="sxs-lookup"><span data-stu-id="3df13-123">Save the changed ApplicationManifest.xml file.</span></span>

## <a name="task-deploy-a-service-fabric-application"></a><span data-ttu-id="3df13-124">Uppgift: Distribuera ett Service Fabric-program</span><span class="sxs-lookup"><span data-stu-id="3df13-124">Task: Deploy a Service Fabric application</span></span>
<span data-ttu-id="3df13-125">När du har skapat och paketeras programmet (eller hämtat programpaketet), kan du distribuera programmet till en lokal Service Fabric-klustret.</span><span class="sxs-lookup"><span data-stu-id="3df13-125">After you've built and packaged the application (or downloaded the application package), you can deploy the application into a local Service Fabric cluster.</span></span> <span data-ttu-id="3df13-126">Distributionen omfattar ladda upp programpaketet, registrera programtypen och skapa programinstansen.</span><span class="sxs-lookup"><span data-stu-id="3df13-126">Deployment involves uploading the application package, registering the application type, and creating the application instance.</span></span> <span data-ttu-id="3df13-127">Följ instruktionerna i det här avsnittet för att distribuera ett nytt program till ett kluster.</span><span class="sxs-lookup"><span data-stu-id="3df13-127">Use the instructions in this section to deploy a new application to a cluster.</span></span>

### <a name="step-1-upload-the-application-package"></a><span data-ttu-id="3df13-128">Steg 1: Ladda upp programpaketet</span><span class="sxs-lookup"><span data-stu-id="3df13-128">Step 1: Upload the application package</span></span>
<span data-ttu-id="3df13-129">Ladda upp programpaketet image store placeras på en plats tillgänglig för interna Service Fabric-komponenter.</span><span class="sxs-lookup"><span data-stu-id="3df13-129">Uploading the application package to the image store puts it in a location accessible to internal Service Fabric components.</span></span>  <span data-ttu-id="3df13-130">Programpaketet innehåller nödvändiga programmanifestet och service manifest kod, konfiguration och data medan du skapar program och instanser av tjänsten.</span><span class="sxs-lookup"><span data-stu-id="3df13-130">The application package contains the necessary application manifest, service manifests, and code, configuration, and data package(s) to create the application and service instances.</span></span> <span data-ttu-id="3df13-131">Om du vill verifiera app-paketet lokalt använder den [Test ServiceFabricApplicationPackage](/powershell/servicefabric/vlatest/test-servicefabricapplicationpackage) cmdlet.</span><span class="sxs-lookup"><span data-stu-id="3df13-131">If you want to verify the app package locally, use the [Test-ServiceFabricApplicationPackage](/powershell/servicefabric/vlatest/test-servicefabricapplicationpackage) cmdlet.</span></span>  <span data-ttu-id="3df13-132">Den [kopiera ServiceFabricApplicationPackage](/powershell/module/servicefabric/copy-servicefabricapplicationpackage?view=azureservicefabricps) kommandot laddar upp paketet.</span><span class="sxs-lookup"><span data-stu-id="3df13-132">The [Copy-ServiceFabricApplicationPackage](/powershell/module/servicefabric/copy-servicefabricapplicationpackage?view=azureservicefabricps) command uploads the package.</span></span> <span data-ttu-id="3df13-133">Exempel:</span><span class="sxs-lookup"><span data-stu-id="3df13-133">For example:</span></span>

```powershell
Copy-ServiceFabricApplicationPackage C:\Temp\WordCount\ -ImageStoreConnectionString file:C:\SfDevCluster\Data\ImageStoreShare -ApplicationPackagePathInImageStore WordCount
```

### <a name="step-2-register-the-application-type"></a><span data-ttu-id="3df13-134">Steg 2: Registrera programtypen</span><span class="sxs-lookup"><span data-stu-id="3df13-134">Step 2: Register the application type</span></span>
<span data-ttu-id="3df13-135">Registrera programpaketet gör programtypen och versionen som deklarerats i programmanifestet tillgängliga för användning.</span><span class="sxs-lookup"><span data-stu-id="3df13-135">Registering the application package makes the application type and version declared in the application manifest available for use.</span></span> <span data-ttu-id="3df13-136">System-läsningar paketet har överförts i steg 1, kontrollera paketet (motsvarar körs [Test ServiceFabricApplicationPackage](/powershell/servicefabric/vlatest/test-servicefabricapplicationpackage) lokalt), bearbeta paketinnehållet och kopiera bearbetade paketet till en plats för internt system.</span><span class="sxs-lookup"><span data-stu-id="3df13-136">The system reads the package uploaded in the step 1, verify the package (equivalent to running [Test-ServiceFabricApplicationPackage](/powershell/servicefabric/vlatest/test-servicefabricapplicationpackage) locally), process the package contents, and copy the processed package to an internal system location.</span></span>  <span data-ttu-id="3df13-137">Kör den [registrera ServiceFabricApplicationType](/powershell/module/servicefabric/register-servicefabricapplicationtype?view=azureservicefabricps) cmdlet:</span><span class="sxs-lookup"><span data-stu-id="3df13-137">Run the [Register-ServiceFabricApplicationType](/powershell/module/servicefabric/register-servicefabricapplicationtype?view=azureservicefabricps) cmdlet:</span></span>

```powershell
Register-ServiceFabricApplicationType WordCount
```
<span data-ttu-id="3df13-138">Om du vill se alla programtyper som registrerats i klustret, kör den [Get-ServiceFabricApplicationType](/powershell/module/servicefabric/get-servicefabricapplicationtype?view=azureservicefabricps) cmdlet:</span><span class="sxs-lookup"><span data-stu-id="3df13-138">To see all the application types registered in the cluster, run the [Get-ServiceFabricApplicationType](/powershell/module/servicefabric/get-servicefabricapplicationtype?view=azureservicefabricps) cmdlet:</span></span>

```powershell
Get-ServiceFabricApplicationType
```

### <a name="step-3-create-the-application-instance"></a><span data-ttu-id="3df13-139">Steg 3: Skapa programinstansen</span><span class="sxs-lookup"><span data-stu-id="3df13-139">Step 3: Create the application instance</span></span>
<span data-ttu-id="3df13-140">Ett program kan initieras med hjälp av någon version av programmet som har registrerats med hjälp av den [ny ServiceFabricApplication](/powershell/module/servicefabric/new-servicefabricapplication?view=azureservicefabricps) kommando.</span><span class="sxs-lookup"><span data-stu-id="3df13-140">An application can be instantiated by using any application type version that has been registered successfully by using the [New-ServiceFabricApplication](/powershell/module/servicefabric/new-servicefabricapplication?view=azureservicefabricps) command.</span></span> <span data-ttu-id="3df13-141">Namnet på varje program som är deklarerad i distribuera tid och måste börja med den **fabric:** schemat och vara unikt för varje förekomst av programmet.</span><span class="sxs-lookup"><span data-stu-id="3df13-141">The name of each application is declared at deploy time and must start with the **fabric:** scheme and be unique for each application instance.</span></span> <span data-ttu-id="3df13-142">Programmets typnamn och typ programversion deklareras i den **ApplicationManifest.xml** -filen för programpaketet.</span><span class="sxs-lookup"><span data-stu-id="3df13-142">The application type name and application type version are declared in the **ApplicationManifest.xml** file of the application package.</span></span> <span data-ttu-id="3df13-143">Om alla standardtjänster definierades i programmanifestet av programmet måltypen är de som skapas just nu.</span><span class="sxs-lookup"><span data-stu-id="3df13-143">If any default services were defined in the application manifest of the target application type, then those are created at this time.</span></span>

```powershell
New-ServiceFabricApplication fabric:/WordCount WordCount 1.0.0
```

<span data-ttu-id="3df13-144">Den [Get-ServiceFabricApplication](/powershell/servicefabric/vlatest/get-servicefabricapplication) kommando visar alla programinstanser som har skapats, tillsammans med deras allmänna status.</span><span class="sxs-lookup"><span data-stu-id="3df13-144">The [Get-ServiceFabricApplication](/powershell/servicefabric/vlatest/get-servicefabricapplication) command lists all application instances that were successfully created, along with their overall status.</span></span> <span data-ttu-id="3df13-145">Den [Get-ServiceFabricService](/powershell/module/servicefabric/get-servicefabricservice?view=azureservicefabricps) kommando visar alla tjänstinstanser som har skapats i en given programinstansen.</span><span class="sxs-lookup"><span data-stu-id="3df13-145">The [Get-ServiceFabricService](/powershell/module/servicefabric/get-servicefabricservice?view=azureservicefabricps) command lists all of the service instances that were successfully created within a given application instance.</span></span> <span data-ttu-id="3df13-146">Standardtjänster (eventuella) visas.</span><span class="sxs-lookup"><span data-stu-id="3df13-146">Default services (if any) are listed.</span></span>

```powershell
Get-ServiceFabricApplication

Get-ServiceFabricApplication | Get-ServiceFabricService
```

## <a name="task-upgrade-a-service-fabric-application"></a><span data-ttu-id="3df13-147">Uppgift: Uppgradera ett Service Fabric-program</span><span class="sxs-lookup"><span data-stu-id="3df13-147">Task: Upgrade a Service Fabric application</span></span>
<span data-ttu-id="3df13-148">Du kan uppgradera en tidigare distribuerad Service Fabric-program med en uppdaterad programpaket.</span><span class="sxs-lookup"><span data-stu-id="3df13-148">You can upgrade a previously deployed Service Fabric application with an updated application package.</span></span> <span data-ttu-id="3df13-149">Den här uppgiften uppgraderar WordCount-program som har distribuerats i ”uppgiften: distribuera ett Service Fabric-program”.</span><span class="sxs-lookup"><span data-stu-id="3df13-149">This task upgrades the WordCount application that was deployed in "Task: Deploy a Service Fabric application."</span></span> <span data-ttu-id="3df13-150">Läs igenom [uppgradering av Service Fabric-programmet](service-fabric-application-upgrade.md) för mer information.</span><span class="sxs-lookup"><span data-stu-id="3df13-150">Read through [Service Fabric application upgrade](service-fabric-application-upgrade.md) for more information.</span></span>

<span data-ttu-id="3df13-151">Endast program versionsnummer har uppdaterats i WordCountV2 programpaket som skapats i förutsättningarna för att hålla saker enkel för det här exemplet.</span><span class="sxs-lookup"><span data-stu-id="3df13-151">To keep things simple for this example, only the application version number was updated in the WordCountV2 application package created in the prerequisites.</span></span> <span data-ttu-id="3df13-152">En mer realistisk scenariot skulle innebära uppdaterar din service-filer i koden, konfiguration och data och sedan återskapa och paketera program med uppdaterade versionsnummer.</span><span class="sxs-lookup"><span data-stu-id="3df13-152">A more realistic scenario would involve updating your service code, configuration, or data files and then rebuilding and packaging the application with updated version numbers.</span></span>  

### <a name="step-1-upload-the-updated-application-package"></a><span data-ttu-id="3df13-153">Steg 1: Ladda upp det uppdaterade programpaketet</span><span class="sxs-lookup"><span data-stu-id="3df13-153">Step 1: Upload the updated application package</span></span>
<span data-ttu-id="3df13-154">WordCount v1 programmet är redo att uppgraderas.</span><span class="sxs-lookup"><span data-stu-id="3df13-154">The WordCount v1 application is ready to be upgraded.</span></span> <span data-ttu-id="3df13-155">Om du öppnar ett PowerShell-fönster som administratör och skriv [ **Get-ServiceFabricApplication**](/powershell/module/servicefabric/get-servicefabricapplication?view=azureservicefabricps), du ser att version 1.0.0 av typen WordCount programmet distribueras.</span><span class="sxs-lookup"><span data-stu-id="3df13-155">If you open up a PowerShell window as administrator and type [**Get-ServiceFabricApplication**](/powershell/module/servicefabric/get-servicefabricapplication?view=azureservicefabricps), you see that version 1.0.0 of the WordCount application type is deployed.</span></span>  

<span data-ttu-id="3df13-156">Kopiera nu det uppdaterade programpaketet till Service Fabric image store (där programpaketen lagras av Service Fabric).</span><span class="sxs-lookup"><span data-stu-id="3df13-156">Now copy the updated application package to the Service Fabric image store (where the application packages are stored by Service Fabric).</span></span> <span data-ttu-id="3df13-157">Parametern **ApplicationPackagePathInImageStore** informerar Service Fabric där den kan hitta programpaketet.</span><span class="sxs-lookup"><span data-stu-id="3df13-157">The parameter **ApplicationPackagePathInImageStore** informs Service Fabric where it can find the application package.</span></span> <span data-ttu-id="3df13-158">I följande kopieras programpaket till **WordCountV2** i image store:</span><span class="sxs-lookup"><span data-stu-id="3df13-158">The following command copies the application package to **WordCountV2** in the image store:</span></span>  

```powershell
Copy-ServiceFabricApplicationPackage C:\Temp\WordCountV2\ -ImageStoreConnectionString file:C:\SfDevCluster\Data\ImageStoreShare -ApplicationPackagePathInImageStore WordCountV2

```
### <a name="step-2-register-the-updated-application-type"></a><span data-ttu-id="3df13-159">Steg 2: Registrera uppdaterade programtyp</span><span class="sxs-lookup"><span data-stu-id="3df13-159">Step 2: Register the updated application type</span></span>
<span data-ttu-id="3df13-160">Nästa steg är att registrera den nya versionen av programmet med Service Fabric som kan utföras med hjälp av den [registrera ServiceFabricApplicationType](/powershell/module/servicefabric/register-servicefabricapplicationtype?view=azureservicefabricps) cmdlet:</span><span class="sxs-lookup"><span data-stu-id="3df13-160">The next step is to register the new version of the application with Service Fabric, which can be performed by using the [Register-ServiceFabricApplicationType](/powershell/module/servicefabric/register-servicefabricapplicationtype?view=azureservicefabricps) cmdlet:</span></span>

```powershell
Register-ServiceFabricApplicationType WordCountV2
```

### <a name="step-3-start-the-upgrade"></a><span data-ttu-id="3df13-161">Steg 3: Starta uppgraderingen</span><span class="sxs-lookup"><span data-stu-id="3df13-161">Step 3: Start the upgrade</span></span>
<span data-ttu-id="3df13-162">Olika uppgradera parametrar, tidsgränser och hälsotillstånd villkor kan tillämpas på programuppgraderingar.</span><span class="sxs-lookup"><span data-stu-id="3df13-162">Various upgrade parameters, timeouts, and health criteria can be applied to application upgrades.</span></span> <span data-ttu-id="3df13-163">Läs igenom den [uppgradera applikationsparametrarna](service-fabric-application-upgrade-parameters.md) och [uppgraderingsprocessen](service-fabric-application-upgrade.md) dokument om du vill veta mer.</span><span class="sxs-lookup"><span data-stu-id="3df13-163">Read through the [application upgrade parameters](service-fabric-application-upgrade-parameters.md) and [upgrade process](service-fabric-application-upgrade.md) documents to learn more.</span></span> <span data-ttu-id="3df13-164">Alla tjänster och instanser måste vara *felfri* efter uppgraderingen.</span><span class="sxs-lookup"><span data-stu-id="3df13-164">All services and instances should be *healthy* after the upgrade.</span></span>  <span data-ttu-id="3df13-165">Ange den **HealthCheckStableDuration** till 60 sekunder (så att tjänsterna som är felfri för minst 20 sekunder innan uppgraderingen fortsätter till nästa uppgraderingsdomän).</span><span class="sxs-lookup"><span data-stu-id="3df13-165">Set the **HealthCheckStableDuration** to 60 seconds (so that the services are healthy for at least 20 seconds before the upgrade proceeds to the next upgrade domain).</span></span>  <span data-ttu-id="3df13-166">Du också ange den **UpgradeDomainTimeout** till 1200 sekunder och **UpgradeTimeout** till 3000 sekunder.</span><span class="sxs-lookup"><span data-stu-id="3df13-166">Also set the **UpgradeDomainTimeout** to 1200 seconds and the **UpgradeTimeout** to 3000 seconds.</span></span> <span data-ttu-id="3df13-167">Slutligen, ställ det **UpgradeFailureAction** till **återställning**, som begär att Service Fabric återställer programmet till föregående version om fel uppstår under uppgraderingen.</span><span class="sxs-lookup"><span data-stu-id="3df13-167">Finally, set the **UpgradeFailureAction** to **rollback**, which requests that Service Fabric rolls back the application to the previous version if failures are encountered during upgrade.</span></span>

<span data-ttu-id="3df13-168">Nu kan du starta uppgraderingen av program med hjälp av den [Start ServiceFabricApplicationUpgrade](/powershell/module/servicefabric/start-servicefabricapplicationupgrade?view=azureservicefabricps) cmdlet:</span><span class="sxs-lookup"><span data-stu-id="3df13-168">You can now start the application upgrade by using the [Start-ServiceFabricApplicationUpgrade](/powershell/module/servicefabric/start-servicefabricapplicationupgrade?view=azureservicefabricps) cmdlet:</span></span>

```powershell
Start-ServiceFabricApplicationUpgrade -ApplicationName fabric:/WordCount -ApplicationTypeVersion 2.0.0 -HealthCheckStableDurationSec 60 -UpgradeDomainTimeoutSec 1200 -UpgradeTimeout 3000  -FailureAction Rollback -Monitored
```

<span data-ttu-id="3df13-169">Observera att programmets namn är samma som namnet på det tidigare distribuerade v1.0.0 program (fabric: / WordCount).</span><span class="sxs-lookup"><span data-stu-id="3df13-169">Note that the application name is the same as the previously deployed v1.0.0 application name (fabric:/WordCount).</span></span> <span data-ttu-id="3df13-170">Service Fabric använder det här namnet för att identifiera vilket program komma uppgraderas.</span><span class="sxs-lookup"><span data-stu-id="3df13-170">Service Fabric uses this name to identify which application is getting upgraded.</span></span> <span data-ttu-id="3df13-171">Om du anger timeout vara för kort, kan det uppstå ett felmeddelande för timeout om problemet.</span><span class="sxs-lookup"><span data-stu-id="3df13-171">If you set the time-outs to be too short, you might encounter a time-out failure message that states the problem.</span></span> <span data-ttu-id="3df13-172">Referera till [felsöka programuppgraderingar](service-fabric-application-upgrade-troubleshooting.md), eller öka timeout-alternativen.</span><span class="sxs-lookup"><span data-stu-id="3df13-172">Refer to [Troubleshoot application upgrades](service-fabric-application-upgrade-troubleshooting.md), or increase the time-outs.</span></span>

### <a name="step-4-check-upgrade-progress"></a><span data-ttu-id="3df13-173">Steg 4: Kontrollera Uppgraderingsförlopp</span><span class="sxs-lookup"><span data-stu-id="3df13-173">Step 4: Check upgrade progress</span></span>
<span data-ttu-id="3df13-174">Du kan övervaka programmet Uppgraderingsförlopp med hjälp av [Service Fabric Explorer](service-fabric-visualizing-your-cluster.md), eller genom att använda den [Get-ServiceFabricApplicationUpgrade](/powershell/module/servicefabric/get-servicefabricapplicationupgrade?view=azureservicefabricps) cmdlet:</span><span class="sxs-lookup"><span data-stu-id="3df13-174">You can monitor application upgrade progress by using [Service Fabric Explorer](service-fabric-visualizing-your-cluster.md), or by using the [Get-ServiceFabricApplicationUpgrade](/powershell/module/servicefabric/get-servicefabricapplicationupgrade?view=azureservicefabricps) cmdlet:</span></span>

```powershell
Get-ServiceFabricApplicationUpgrade fabric:/WordCount
```

<span data-ttu-id="3df13-175">Om några minuter på [Get-ServiceFabricApplicationUpgrade](/powershell/module/servicefabric/get-servicefabricapplicationupgrade?view=azureservicefabricps) cmdlet visar att alla uppgraderingsdomäner har uppgraderats (slutförd).</span><span class="sxs-lookup"><span data-stu-id="3df13-175">In a few minutes, the [Get-ServiceFabricApplicationUpgrade](/powershell/module/servicefabric/get-servicefabricapplicationupgrade?view=azureservicefabricps) cmdlet shows that all upgrade domains were upgraded (completed).</span></span>

## <a name="task-test-a-service-fabric-application"></a><span data-ttu-id="3df13-176">Uppgift: Testa ett Service Fabric-program</span><span class="sxs-lookup"><span data-stu-id="3df13-176">Task: Test a Service Fabric application</span></span>
<span data-ttu-id="3df13-177">Om du vill skriva hög kvalitet services behöver utvecklare kan orsaka instabilt infrastruktur fel för att testa stabiliteten för sina tjänster.</span><span class="sxs-lookup"><span data-stu-id="3df13-177">To write high-quality services, developers need to be able to induce unreliable infrastructure faults to test the stability of their services.</span></span> <span data-ttu-id="3df13-178">Service Fabric ger utvecklare möjligheten att medföra fel åtgärder och testa tjänster med fel med testscenarier chaos och växling vid fel.</span><span class="sxs-lookup"><span data-stu-id="3df13-178">Service Fabric gives developers the ability to induce fault actions and test services in the presence of failures by using the chaos and failover test scenarios.</span></span>  <span data-ttu-id="3df13-179">Läs igenom [introduktion till fel Analysis Service](service-fabric-testability-overview.md) för ytterligare information.</span><span class="sxs-lookup"><span data-stu-id="3df13-179">Read through [Introduction to the Fault Analysis Service](service-fabric-testability-overview.md) for additional information.</span></span>

### <a name="step-1-run-the-chaos-test-scenario"></a><span data-ttu-id="3df13-180">Steg 1: Kör chaos Testscenario</span><span class="sxs-lookup"><span data-stu-id="3df13-180">Step 1: Run the chaos test scenario</span></span>
<span data-ttu-id="3df13-181">Testscenario chaos genererar fel över hela Service Fabric-kluster.</span><span class="sxs-lookup"><span data-stu-id="3df13-181">The chaos test scenario generates faults across the entire Service Fabric cluster.</span></span> <span data-ttu-id="3df13-182">Scenariot komprimerar fel som normalt sett över månader eller år till några timmar.</span><span class="sxs-lookup"><span data-stu-id="3df13-182">The scenario compresses faults generally seen over months or years to a few hours.</span></span> <span data-ttu-id="3df13-183">Kombinationen av överlagrad fel med hög feltolerans hittar specialfall som annars skulle missas.</span><span class="sxs-lookup"><span data-stu-id="3df13-183">The combination of interleaved faults with a high fault rate finds corner cases that would otherwise be missed.</span></span> <span data-ttu-id="3df13-184">Följande exempel kör test-scenario chaos i 60 minuter.</span><span class="sxs-lookup"><span data-stu-id="3df13-184">The following example runs the chaos test scenario for 60 minutes.</span></span>

```powershell
$timeToRun = 60
$maxStabilizationTimeSecs = 180
$concurrentFaults = 3
$waitTimeBetweenIterationsSec = 60

Invoke-ServiceFabricChaosTestScenario -TimeToRunMinute $timeToRun -MaxClusterStabilizationTimeoutSec $maxStabilizationTimeSecs -MaxConcurrentFaults $concurrentFaults -EnableMoveReplicaFaults -WaitTimeBetweenIterationsSec $waitTimeBetweenIterationsSec
```

### <a name="step-2-run-the-failover-test-scenario"></a><span data-ttu-id="3df13-185">Steg 2: Kör test-scenario växling vid fel</span><span class="sxs-lookup"><span data-stu-id="3df13-185">Step 2: Run the failover test scenario</span></span>
<span data-ttu-id="3df13-186">Redundans Testa scenariot riktad mot en specifik tjänst partition i stället för hela klustret och den lämnar andra tjänster påverkas inte.</span><span class="sxs-lookup"><span data-stu-id="3df13-186">The failover test scenario targets a specific service partition instead of the entire cluster, and it leaves other services unaffected.</span></span> <span data-ttu-id="3df13-187">Scenariot upprepas i en sekvens av simulerade fel i valideringen av tjänsten när affärslogik körs.</span><span class="sxs-lookup"><span data-stu-id="3df13-187">The scenario iterates through a sequence of simulated faults in service validation while your business logic runs.</span></span> <span data-ttu-id="3df13-188">Ett fel i tjänsten validering indikerar ett problem som kräver ytterligare undersökning.</span><span class="sxs-lookup"><span data-stu-id="3df13-188">A failure in service validation indicates an issue that needs further investigation.</span></span> <span data-ttu-id="3df13-189">Testet redundans startar bara ett fel i taget, till skillnad från chaos test-scenario som kan ge upphov till flera fel.</span><span class="sxs-lookup"><span data-stu-id="3df13-189">The failover test induces only one fault at a time, as opposed to the chaos test scenario, which can induce multiple faults.</span></span> <span data-ttu-id="3df13-190">Följande exempel kör redundanstest i 60 minuter mot i fabric: / WordCount/WordCountService-tjänsten.</span><span class="sxs-lookup"><span data-stu-id="3df13-190">The following example runs the failover test for 60 minutes against the fabric:/WordCount/WordCountService service.</span></span>

```powershell
$timeToRun = 60
$maxStabilizationTimeSecs = 180
$waitTimeBetweenFaultsSec = 10
$serviceName = "fabric:/WordCount/WordCountService"

Invoke-ServiceFabricFailoverTestScenario -TimeToRunMinute $timeToRun -MaxServiceStabilizationTimeoutSec $maxStabilizationTimeSecs -WaitTimeBetweenFaultsSec $waitTimeBetweenFaultsSec -ServiceName $serviceName -PartitionKindUniformInt64 -PartitionKey 1
```

## <a name="task-remove-a-service-fabric-application"></a><span data-ttu-id="3df13-191">Uppgift: Ta bort ett Service Fabric-program</span><span class="sxs-lookup"><span data-stu-id="3df13-191">Task: Remove a Service Fabric application</span></span>
<span data-ttu-id="3df13-192">Du kan ta bort en instans av ett distribuerat program, ta bort den etablerade programtypen från klustret och ta bort programpaketet från ImageStore.</span><span class="sxs-lookup"><span data-stu-id="3df13-192">You can delete an instance of a deployed application, remove the provisioned application type from the cluster, and remove the application package from the ImageStore.</span></span>

### <a name="step-1-remove-an-application-instance"></a><span data-ttu-id="3df13-193">Steg 1: Ta bort en instans av programmet</span><span class="sxs-lookup"><span data-stu-id="3df13-193">Step 1: Remove an application instance</span></span>
<span data-ttu-id="3df13-194">När en instans av programmet inte längre behövs, du permanent bort den med hjälp av den [ta bort ServiceFabricApplication](/powershell/module/servicefabric/remove-servicefabricapplication?view=azureservicefabricps) cmdlet.</span><span class="sxs-lookup"><span data-stu-id="3df13-194">When an application instance is no longer needed, you can permanently remove it by using the [Remove-ServiceFabricApplication](/powershell/module/servicefabric/remove-servicefabricapplication?view=azureservicefabricps) cmdlet.</span></span> <span data-ttu-id="3df13-195">Detta tar automatiskt bort alla tjänster som hör till programmet tar permanent bort alla tillstånd för tjänsten.</span><span class="sxs-lookup"><span data-stu-id="3df13-195">This also automatically removes all services belonging to the application, permanently removing all service state.</span></span> <span data-ttu-id="3df13-196">Den här åtgärden kan inte ångras och går inte att återställa programtillstånd.</span><span class="sxs-lookup"><span data-stu-id="3df13-196">This operation cannot be reversed and application state cannot be recovered.</span></span>

```powershell
Remove-ServiceFabricApplication fabric:/WordCount
```

### <a name="step-2-unregister-the-application-type"></a><span data-ttu-id="3df13-197">Steg 2: Avregistrera programtypen</span><span class="sxs-lookup"><span data-stu-id="3df13-197">Step 2: Unregister the application type</span></span>
<span data-ttu-id="3df13-198">När du inte längre behöver en viss version av en typ av program, avregistrera den med hjälp av den [Unregister-ServiceFabricApplicationType](/powershell/module/servicefabric/unregister-servicefabricapplicationtype?view=azureservicefabricps) cmdlet.</span><span class="sxs-lookup"><span data-stu-id="3df13-198">When you no longer need a particular version of an application type, unregister it by using the [Unregister-ServiceFabricApplicationType](/powershell/module/servicefabric/unregister-servicefabricapplicationtype?view=azureservicefabricps) cmdlet.</span></span> <span data-ttu-id="3df13-199">Avregistrera oanvända typer Frigör lagringsutrymme som används av programpaket i image store.</span><span class="sxs-lookup"><span data-stu-id="3df13-199">Unregistering unused types releases storage space used by the application package in the image store.</span></span> <span data-ttu-id="3df13-200">En typ av program kan avregistreras så länge det finns inga program instansierad mot den eller väntande programuppgraderingar som refererar till den.</span><span class="sxs-lookup"><span data-stu-id="3df13-200">An application type can be unregistered as long as there are no applications instantiated against it or pending application upgrades referencing it.</span></span>

```powershell
Unregister-ServiceFabricApplicationType WordCount 1.0.0
```

### <a name="step-3-remove-the-application-package"></a><span data-ttu-id="3df13-201">Steg 3: Ta bort programpaketet</span><span class="sxs-lookup"><span data-stu-id="3df13-201">Step 3: Remove the application package</span></span>
<span data-ttu-id="3df13-202">Efter att programtypen är avregistrera programpaketet kan tas bort från avbildningsarkivet med hjälp av den [ta bort ServiceFabricApplicationPackage](/powershell/module/servicefabric/remove-servicefabricapplicationpackage?view=azureservicefabricps) cmdlet.</span><span class="sxs-lookup"><span data-stu-id="3df13-202">After the application type is unregistered, the application package can be removed from the image store by using the [Remove-ServiceFabricApplicationPackage](/powershell/module/servicefabric/remove-servicefabricapplicationpackage?view=azureservicefabricps) cmdlet.</span></span>

```powershell
Remove-ServiceFabricApplicationPackage -ImageStoreConnectionString file:C:\SfDevCluster\Data\ImageStoreShare -ApplicationPackagePathInImageStore WordCount
```

## <a name="next-steps"></a><span data-ttu-id="3df13-203">Nästa steg</span><span class="sxs-lookup"><span data-stu-id="3df13-203">Next steps</span></span>
[<span data-ttu-id="3df13-204">Livscykel för Service Fabric-program</span><span class="sxs-lookup"><span data-stu-id="3df13-204">Service Fabric application lifecycle</span></span>](service-fabric-application-lifecycle.md)

[<span data-ttu-id="3df13-205">Distribuera ett program</span><span class="sxs-lookup"><span data-stu-id="3df13-205">Deploy an application</span></span>](service-fabric-deploy-remove-applications.md)

[<span data-ttu-id="3df13-206">Uppgradering av programmet</span><span class="sxs-lookup"><span data-stu-id="3df13-206">Application upgrade</span></span>](service-fabric-application-upgrade.md)

[<span data-ttu-id="3df13-207">Azure Service Fabric-cmdlets</span><span class="sxs-lookup"><span data-stu-id="3df13-207">Azure Service Fabric cmdlets</span></span>](/powershell/azure/overview?view=azureservicefabricps)

