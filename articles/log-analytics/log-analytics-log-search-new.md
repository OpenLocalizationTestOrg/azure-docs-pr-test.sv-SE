---
title: "Logga sökningar i OMS Log Analytics | Microsoft Docs"
description: "Du behöver en logg-sökning för att hämta data från logganalys.  Den här artikeln beskriver hur ny logg sökningar används i logganalys och innehåller begrepp som du behöver förstå innan du skapar en."
services: log-analytics
documentationcenter: 
author: bwren
manager: carmonm
editor: 
ms.service: log-analytics
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/25/2017
ms.author: bwren
ms.openlocfilehash: 0f27db7018e398f71a8d7bd0b86e643367b15875
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 08/29/2017
---
# <a name="understanding-log-searches-in-log-analytics"></a><span data-ttu-id="be83b-104">Förstå loggen söker i logganalys</span><span class="sxs-lookup"><span data-stu-id="be83b-104">Understanding log searches in Log Analytics</span></span>

> [!NOTE]
> <span data-ttu-id="be83b-105">Den här artikeln beskriver loggen söker i Azure Log Analytics med hjälp av det nya språket i fråga.</span><span class="sxs-lookup"><span data-stu-id="be83b-105">This article describes log searches in Azure Log Analytics using the new query language.</span></span>  <span data-ttu-id="be83b-106">Du lär dig mer om det nya språket och få proceduren för att uppgradera din arbetsyta på [uppgradera Azure logganalys-arbetsytan till ny logg sökning](log-analytics-log-search-upgrade.md).</span><span class="sxs-lookup"><span data-stu-id="be83b-106">You can learn more about the new language and get the procedure to upgrade your workspace at [Upgrade your Azure Log Analytics workspace to new log search](log-analytics-log-search-upgrade.md).</span></span>  
>
> <span data-ttu-id="be83b-107">Om ditt arbetsområde inte har uppgraderats till det nya språket i fråga, bör du gå till [söka efter data med hjälp av loggen sökningar i logganalys](log-analytics-log-searches.md).</span><span class="sxs-lookup"><span data-stu-id="be83b-107">If your workspace hasn't been upgraded to the new query language, you should refer to [Find data using log searches in Log Analytics](log-analytics-log-searches.md).</span></span>

<span data-ttu-id="be83b-108">Du behöver en logg-sökning för att hämta data från logganalys.</span><span class="sxs-lookup"><span data-stu-id="be83b-108">You require a log search to retrieve any data from Log Analytics.</span></span>  <span data-ttu-id="be83b-109">Om du analyserar data i portalen, vill konfigurera en aviseringsregel som ska meddelas om ett visst villkor eller hämta data med hjälp av API: et för Log Analytics du använda en logg sökning för att ange vilka data som du vill använda.</span><span class="sxs-lookup"><span data-stu-id="be83b-109">Whether you're analyzing data in the portal, configuring an alert rule to be notified of a particular condition, or retrieving data using the Log Analytics API, you will use a log search to specify the data you want.</span></span>  <span data-ttu-id="be83b-110">Den här artikeln beskriver hur du använder loggen sökningar i logganalys samt begrepp som du bör känna till innan du skapar en.</span><span class="sxs-lookup"><span data-stu-id="be83b-110">This article describes how log searches are used in Log Analytics and provides concepts that should understand before creating one.</span></span> <span data-ttu-id="be83b-111">Finns det [nästa steg](#next-steps) avsnittet för information om att skapa och redigera loggen sökningar och referenser på frågespråket.</span><span class="sxs-lookup"><span data-stu-id="be83b-111">See the [Next steps](#next-steps) section for details on creating and editing log searches and for references on the query language.</span></span>

## <a name="where-log-searches-are-used"></a><span data-ttu-id="be83b-112">Där loggen sökningar används</span><span class="sxs-lookup"><span data-stu-id="be83b-112">Where log searches are used</span></span>

<span data-ttu-id="be83b-113">Olika sätt som du ska använda loggen sökningar i logganalys inkluderar följande:</span><span class="sxs-lookup"><span data-stu-id="be83b-113">The different ways that you will use log searches in Log Analytics include the following:</span></span>

- <span data-ttu-id="be83b-114">**Portaler.**</span><span class="sxs-lookup"><span data-stu-id="be83b-114">**Portals.**</span></span> <span data-ttu-id="be83b-115">Du kan utföra interaktiv analys av data i databasen med de [loggen Sök portal](log-analytics-log-search-log-search-portal.md) eller [Advanced Analytics portal](https://go.microsoft.com/fwlink/?linkid=856587).</span><span class="sxs-lookup"><span data-stu-id="be83b-115">You can perform interactive analysis of data in the repository with the [Log Search portal](log-analytics-log-search-log-search-portal.md) or the [Advanced Analytics portal](https://go.microsoft.com/fwlink/?linkid=856587).</span></span>  <span data-ttu-id="be83b-116">På så sätt kan du redigera din fråga och analysera resultaten i en mängd olika format och visualiseringar.</span><span class="sxs-lookup"><span data-stu-id="be83b-116">This allows you to edit your query and analyze the results in a variety of formats and visualizations.</span></span>  <span data-ttu-id="be83b-117">De flesta frågor som du skapar kommer att starta i någon av portalerna och kopieras sedan när du kontrollera att den fungerar som förväntat.</span><span class="sxs-lookup"><span data-stu-id="be83b-117">Most queries that you create will start in one of the portals and then copied once you verify that it works as expected.</span></span>
- <span data-ttu-id="be83b-118">**Varningsregler.**</span><span class="sxs-lookup"><span data-stu-id="be83b-118">**Alert rules.**</span></span> <span data-ttu-id="be83b-119">[Varna regler](log-analytics-alerts.md) proaktivt identifiera problem utifrån data i din arbetsyta.</span><span class="sxs-lookup"><span data-stu-id="be83b-119">[Alert rules](log-analytics-alerts.md) proactively identify issues from data in your workspace.</span></span>  <span data-ttu-id="be83b-120">Varje regel för varning baseras på en logg sökning som körs automatiskt med jämna mellanrum.</span><span class="sxs-lookup"><span data-stu-id="be83b-120">Each alert rule is based on a log search that is automatically run at regular intervals.</span></span>  <span data-ttu-id="be83b-121">Resultatet är kontrolleras för att avgöra om en avisering ska skapas.</span><span class="sxs-lookup"><span data-stu-id="be83b-121">The results are inspected to determine if an alert should be created.</span></span>
- <span data-ttu-id="be83b-122">**Vyer.**</span><span class="sxs-lookup"><span data-stu-id="be83b-122">**Views.**</span></span>  <span data-ttu-id="be83b-123">Du kan skapa visualiseringar av data som ska inkluderas i instrumentpaneler för användare med [Vydesigner](log-analytics-view-designer.md).</span><span class="sxs-lookup"><span data-stu-id="be83b-123">You can create visualizations of data to be included in user dashboards with [View Designer](log-analytics-view-designer.md).</span></span>  <span data-ttu-id="be83b-124">Loggen sökningar tillhandahåller de data som används av [paneler](log-analytics-view-designer-tiles.md) och [visualiseringen delar](log-analytics-view-designer-parts.md) i varje vy.</span><span class="sxs-lookup"><span data-stu-id="be83b-124">Log searches provide the data used by [tiles](log-analytics-view-designer-tiles.md) and [visualization parts](log-analytics-view-designer-parts.md) in each view.</span></span>  <span data-ttu-id="be83b-125">Du kan öka detaljnivån från visualiseringen delar i loggen Sök-portalen för att utföra analyser på data.</span><span class="sxs-lookup"><span data-stu-id="be83b-125">You can drill down from visualization parts into the Log Search portal to perform further analysis on the data.</span></span>
- <span data-ttu-id="be83b-126">**Exportera.**</span><span class="sxs-lookup"><span data-stu-id="be83b-126">**Export.**</span></span>  <span data-ttu-id="be83b-127">När du exporterar data från logganalys-arbetsytan till Excel eller [Power BI](log-analytics-powerbi.md), du skapar en logg-sökning för att definiera data som ska exporteras.</span><span class="sxs-lookup"><span data-stu-id="be83b-127">When you export data from the Log Analytics workspace to Excel or [Power BI](log-analytics-powerbi.md), you create a log search to define the data to export.</span></span>
- <span data-ttu-id="be83b-128">**PowerShell.**</span><span class="sxs-lookup"><span data-stu-id="be83b-128">**PowerShell.**</span></span> <span data-ttu-id="be83b-129">Du kan köra ett PowerShell-skript från en kommandorad eller ett Azure Automation-runbook som använder [Get-AzureRmOperationalInsightsSearchResults](https://docs.microsoft.com/powershell/module/azurerm.operationalinsights/get-azurermoperationalinsightssearchresults?view=azurermps-4.0.0) att hämta data från logganalys.</span><span class="sxs-lookup"><span data-stu-id="be83b-129">You can run a PowerShell script from a command line or an Azure Automation runbook that uses [Get-AzureRmOperationalInsightsSearchResults](https://docs.microsoft.com/powershell/module/azurerm.operationalinsights/get-azurermoperationalinsightssearchresults?view=azurermps-4.0.0) to retrieve data from Log Analytics.</span></span>  <span data-ttu-id="be83b-130">Den här cmdleten kräver en fråga för att fastställa vilka data som ska hämtas.</span><span class="sxs-lookup"><span data-stu-id="be83b-130">This cmdlet requires a query to determine the data to retrieve.</span></span>
- <span data-ttu-id="be83b-131">**Log Analytics-API.**</span><span class="sxs-lookup"><span data-stu-id="be83b-131">**Log Analytics API.**</span></span>  <span data-ttu-id="be83b-132">Den [logganalys logga Sök API](log-analytics-log-search-api.md) tillåter alla REST API-klient att hämta data från arbetsytan.</span><span class="sxs-lookup"><span data-stu-id="be83b-132">The [Log Analytics log search API](log-analytics-log-search-api.md) allows any REST API client to retrieve data from the workspace.</span></span>  <span data-ttu-id="be83b-133">API-begäran innehåller en fråga som körs mot Log Analytics för att fastställa data som ska hämtas.</span><span class="sxs-lookup"><span data-stu-id="be83b-133">The API request includes a query that is run against Log Analytics to determine the data to retrieve.</span></span>

![Log-sökningar](media/log-analytics-log-search-new/log-search-overview.png)

## <a name="how-log-analytics-data-is-organized"></a><span data-ttu-id="be83b-135">Hur ordnas Log Analytics-data</span><span class="sxs-lookup"><span data-stu-id="be83b-135">How Log Analytics data is organized</span></span>
<span data-ttu-id="be83b-136">När du skapar en fråga kan starta du genom att bestämma vilka tabeller innehåller de data som du letar efter.</span><span class="sxs-lookup"><span data-stu-id="be83b-136">When you build a query, you start by determining which tables have the data that you're looking for.</span></span> <span data-ttu-id="be83b-137">Varje [datakällan](log-analytics-data-sources.md) och [lösning](../operations-management-suite/operations-management-suite-solutions.md) lagrar data i dedikerade tabeller i logganalys-arbetsytan.</span><span class="sxs-lookup"><span data-stu-id="be83b-137">Each [data source](log-analytics-data-sources.md) and [solution](../operations-management-suite/operations-management-suite-solutions.md) stores its data in dedicated tables in the Log Analytics workspace.</span></span>  <span data-ttu-id="be83b-138">Dokumentation för varje datakälla och lösningen innehåller namnet på den datatyp som skapas och en beskrivning av var och en av dess egenskaper.</span><span class="sxs-lookup"><span data-stu-id="be83b-138">Documentation for each data source and solution includes the name of the data type that it creates and a description of each of its properties.</span></span>     <span data-ttu-id="be83b-139">Många frågor kräver endast data från en enda tabeller, men andra kan använda en mängd olika alternativ för att ta med data från flera tabeller.</span><span class="sxs-lookup"><span data-stu-id="be83b-139">Many queries will only require data from a single tables, but others may use a variety of options to include data from multiple tables.</span></span>

![Tabeller](media/log-analytics-log-search-new/queries-tables.png)


## <a name="writing-a-query"></a><span data-ttu-id="be83b-141">Skriva en fråga</span><span class="sxs-lookup"><span data-stu-id="be83b-141">Writing a query</span></span>
<span data-ttu-id="be83b-142">Kärnan i loggen söker i logganalys är [ett omfattande frågespråket](https://docs.loganalytics.io/) som låter dig hämta och analysera data från databasen på en mängd olika sätt.</span><span class="sxs-lookup"><span data-stu-id="be83b-142">At the core of log searches in Log Analytics is [an extensive query language](https://docs.loganalytics.io/) that lets you retrieve and analyze data from the repository in a variety of ways.</span></span>  <span data-ttu-id="be83b-143">Samma fråga språk används för [Programinsikter](../application-insights/app-insights-analytics.md).</span><span class="sxs-lookup"><span data-stu-id="be83b-143">This same query language is used for [Application Insights](../application-insights/app-insights-analytics.md).</span></span>  <span data-ttu-id="be83b-144">Lär dig att skriva en fråga är viktigt att skapa loggfilen sökningar i logganalys.</span><span class="sxs-lookup"><span data-stu-id="be83b-144">Learning how to write a query is critical to creating log searches in Log Analytics.</span></span>  <span data-ttu-id="be83b-145">Du normalt börjar med grundläggande frågor och sedan gå vidare om du vill använda mer avancerade funktioner enligt dina krav blir mer komplexa.</span><span class="sxs-lookup"><span data-stu-id="be83b-145">You'll typically start with basic queries and then progress to use more advanced functions as your requirements become more complex.</span></span>

<span data-ttu-id="be83b-146">Den grundläggande strukturen i en fråga är en källtabell följt av en serie operatörer avgränsade med ett vertikalstreck `|`.</span><span class="sxs-lookup"><span data-stu-id="be83b-146">The basic structure of a query is a source table followed by a series of operators separated by a pipe character `|`.</span></span>  <span data-ttu-id="be83b-147">Du kan kedja samman flera operatorer för att begränsa data och utföra avancerade funktioner.</span><span class="sxs-lookup"><span data-stu-id="be83b-147">You can chain together multiple operators to refine the data and perform advanced functions.</span></span>

<span data-ttu-id="be83b-148">Anta exempelvis att du vill hitta de övre tio datorerna med de flesta felhändelser under den senaste dagen.</span><span class="sxs-lookup"><span data-stu-id="be83b-148">For example, suppose you wanted to find the top ten computers with the most error events over the past day.</span></span>

    Event
    | where (EventLevelName == "Error")
    | where (TimeGenerated > ago(1days))
    | summarize ErrorCount = count() by Computer
    | top 10 by ErrorCount desc

<span data-ttu-id="be83b-149">Eller så kanske du vill söka efter datorer som inte har haft ett pulsslag i den sista dagen.</span><span class="sxs-lookup"><span data-stu-id="be83b-149">Or maybe you want to find computers that haven't had a heartbeat in the last day.</span></span>

    Heartbeat
    | where TimeGenerated > ago(7d)
    | summarize max(TimeGenerated) by Computer
    | where max_TimeGenerated < ago(1d)  

<span data-ttu-id="be83b-150">Hur är det med linjediagram med processoranvändning för varje dator från förra veckan?</span><span class="sxs-lookup"><span data-stu-id="be83b-150">How about a line chart with the processor utilization for each computer from last week?</span></span>

    Perf
    | where ObjectName == "Processor" and CounterName == "% Processor Time"
    | where TimeGenerated  between (startofweek(ago(7d)) .. endofweek(ago(7d)) )
    | summarize avg(CounterValue) by Computer, bin(TimeGenerated, 5min)
    | render timechart    

<span data-ttu-id="be83b-151">Du kan se dessa snabb prover att oavsett vilken typ av data som du arbetar med strukturen i frågan är liknande.</span><span class="sxs-lookup"><span data-stu-id="be83b-151">You can see from these quick samples that regardless of the kind of data that you're working with, the structure of the query is similar.</span></span>  <span data-ttu-id="be83b-152">Du kan dela upp det i steg där den resulterande data från ett kommando skickas via pipeline till nästa kommando.</span><span class="sxs-lookup"><span data-stu-id="be83b-152">You can break it down into distinct steps where the resulting data from one command is sent through the pipeline to the next command.</span></span>

<span data-ttu-id="be83b-153">Fullständig dokumentation för Azure Log Analytics-frågespråket i inklusive självstudier och Språkreferens finns i [Azure logganalys fråga språk dokumentationen](https://docs.loganalytics.io/).</span><span class="sxs-lookup"><span data-stu-id="be83b-153">For complete documentation on the Azure Log Analytics query language including tutorials and language reference, see the [Azure Log Analytics query language documentation](https://docs.loganalytics.io/).</span></span>

## <a name="next-steps"></a><span data-ttu-id="be83b-154">Nästa steg</span><span class="sxs-lookup"><span data-stu-id="be83b-154">Next steps</span></span>

- <span data-ttu-id="be83b-155">Lär dig mer om den [portaler som används för att skapa och redigera logga sökningar](log-analytics-log-search-portals.md).</span><span class="sxs-lookup"><span data-stu-id="be83b-155">Learn about the [portals that you use to create and edit log searches](log-analytics-log-search-portals.md).</span></span>
- <span data-ttu-id="be83b-156">Checka ut en [självstudier om hur du skriver frågor](https://go.microsoft.com/fwlink/?linkid=856078) med det nya språket i fråga.</span><span class="sxs-lookup"><span data-stu-id="be83b-156">Check out a [tutorial on writing queries](https://go.microsoft.com/fwlink/?linkid=856078) using the new query language.</span></span>
