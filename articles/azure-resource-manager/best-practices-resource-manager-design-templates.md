---
title: "aaaDesign Azure mallar för sammansatta lösningar | Microsoft Docs"
description: "Visar bästa praxis för att utforma Azure Resource Manager-mallar för avancerade scenarier"
services: azure-resource-manager
documentationcenter: 
author: tfitzmac
manager: timlt
editor: tysonn
ms.assetid: ce1141d6-ece7-4976-acea-1db1f775409e
ms.service: azure-resource-manager
ms.workload: multiple
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 12/19/2016
ms.author: tomfitz
ms.openlocfilehash: aa45e9a46d79a6336b696cff8fd37f65fa449f11
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 10/06/2017
---
# <a name="design-patterns-for-azure-resource-manager-templates-when-deploying-complex-solutions"></a><span data-ttu-id="0e239-103">Designmönster för Azure Resource Manager-mallar när du distribuerar komplexa lösningar</span><span class="sxs-lookup"><span data-stu-id="0e239-103">Design patterns for Azure Resource Manager templates when deploying complex solutions</span></span>
<span data-ttu-id="0e239-104">Med ett flexibelt sätt baserat på Azure Resource Manager-mallar kan distribuera du komplexa topologier snabbt och konsekvent.</span><span class="sxs-lookup"><span data-stu-id="0e239-104">Using a flexible approach based on Azure Resource Manager templates, you can deploy complex topologies quickly and consistently.</span></span> <span data-ttu-id="0e239-105">Du kan anpassa dessa distributioner enkelt som core erbjudanden utvecklas eller tooaccommodate varianter för avvikare scenarier eller kunder.</span><span class="sxs-lookup"><span data-stu-id="0e239-105">You can adapt these deployments easily as core offerings evolve or tooaccommodate variants for outlier scenarios or customers.</span></span>

<span data-ttu-id="0e239-106">Det här avsnittet är en del av en större vitbok.</span><span class="sxs-lookup"><span data-stu-id="0e239-106">This topic is part of a larger whitepaper.</span></span> <span data-ttu-id="0e239-107">Hämta tooread hello fullständig papper [World klassen Azure Resource Manager-mallar överväganden och beprövade metoder](http://download.microsoft.com/download/8/E/1/8E1DBEFA-CECE-4DC9-A813-93520A5D7CFE/World Class ARM Templates - Considerations and Proven Practices.pdf).</span><span class="sxs-lookup"><span data-stu-id="0e239-107">tooread hello full paper, download [World Class Azure Resource Manager Templates Considerations and Proven Practices](http://download.microsoft.com/download/8/E/1/8E1DBEFA-CECE-4DC9-A813-93520A5D7CFE/World Class ARM Templates - Considerations and Proven Practices.pdf).</span></span>

<span data-ttu-id="0e239-108">Mallar kombinera hello fördelarna med hello underliggande Azure Resource Manager med hello förmåga och läsbarhet för JavaScript Object Notation (JSON).</span><span class="sxs-lookup"><span data-stu-id="0e239-108">Templates combine hello benefits of hello underlying Azure Resource Manager with hello adaptability and readability of JavaScript Object Notation (JSON).</span></span> <span data-ttu-id="0e239-109">Mallar kan du:</span><span class="sxs-lookup"><span data-stu-id="0e239-109">Using templates, you can:</span></span>

* <span data-ttu-id="0e239-110">Distribuera topologier och deras arbetsbelastning konsekvent.</span><span class="sxs-lookup"><span data-stu-id="0e239-110">Deploy topologies and their workloads consistently.</span></span>
* <span data-ttu-id="0e239-111">Hantera alla dina resurser i ett program tillsammans med resursgrupper.</span><span class="sxs-lookup"><span data-stu-id="0e239-111">Manage all your resources in an application together using resource groups.</span></span>
* <span data-ttu-id="0e239-112">Använda rollbaserad åtkomstkontroll (RBAC) toogrant åtkomstbehörighet toousers, grupper och tjänster.</span><span class="sxs-lookup"><span data-stu-id="0e239-112">Apply role-based access control (RBAC) toogrant appropriate access toousers, groups, and services.</span></span>
* <span data-ttu-id="0e239-113">Använd märkning kopplingarna toostreamline aktiviteter, till exempel fakturering Rollup-beräkningar.</span><span class="sxs-lookup"><span data-stu-id="0e239-113">Use tagging associations toostreamline tasks such as billing rollups.</span></span>

<span data-ttu-id="0e239-114">Den här artikeln innehåller information om förbrukningen scenarier, arkitektur och implementering mönster identifieras vid våra design sessioner och verkliga mallen implementeringar med Azure Customer Advisory Team (AzureCAT) kunder.</span><span class="sxs-lookup"><span data-stu-id="0e239-114">This article provides details on consumption scenarios, architecture, and implementation patterns identified during our design sessions and real-world template implementations with Azure Customer Advisory Team (AzureCAT) customers.</span></span> <span data-ttu-id="0e239-115">Dessa metoder är är långt från akademisk, beprövade metoder informera hello utvecklingen av mallar för 12 i hello upp Linux-baserade OSS tekniker, bland annat: Apache Kafka, Apache Spark, Cloudera, Couchbase, Hortonworks HDP, DataStax Enterprise drivs av Apache Cassandra, Elasticsearch, Jenkins, MongoDB, PostgreSQL, Redis och Nagios.</span><span class="sxs-lookup"><span data-stu-id="0e239-115">Far from academic, these approaches are proven practices informed by hello development of templates for 12 of hello top Linux-based OSS technologies, including: Apache Kafka, Apache Spark, Cloudera, Couchbase, Hortonworks HDP, DataStax Enterprise powered by Apache Cassandra, Elasticsearch, Jenkins, MongoDB, PostgreSQL, Redis, and Nagios.</span></span> 

<span data-ttu-id="0e239-116">Den här artikeln delar dessa beprövade metoder toohelp du skapa world klassen Azure Resource Manager-mallar.</span><span class="sxs-lookup"><span data-stu-id="0e239-116">This article shares these proven practices toohelp you architect world class Azure Resource Manager templates.</span></span>  

<span data-ttu-id="0e239-117">Vi har hittat flera förbrukning upplevelser för Resource Manager-mall i företag, System dietetisk (SI) s och CSV: er i vårt arbete med kunder.</span><span class="sxs-lookup"><span data-stu-id="0e239-117">In our work with customers, we have identified several Resource Manager template consumption experiences across enterprises, System Integrators (SI)s, and CSVs.</span></span> <span data-ttu-id="0e239-118">hello följande avsnitt innehåller en översikt över vanliga scenarier och mönster för annan kundtyper.</span><span class="sxs-lookup"><span data-stu-id="0e239-118">hello following sections provide a high-level overview of common scenarios and patterns for different customer types.</span></span>

## <a name="enterprises-and-system-integrators"></a><span data-ttu-id="0e239-119">Företag och systemintegrerare.</span><span class="sxs-lookup"><span data-stu-id="0e239-119">Enterprises and system integrators</span></span>
<span data-ttu-id="0e239-120">I stora organisationer ofta visas två konsumenter av Resource Manager-mallar: interna programvaran utvecklingsgrupper och företagets IT.</span><span class="sxs-lookup"><span data-stu-id="0e239-120">Within large organizations, we commonly see two consumers of Resource Manager templates: internal software development teams and corporate IT.</span></span> <span data-ttu-id="0e239-121">Vi har hittat som hello scenarier för hello SIs mappar toohello scenarier för företag, så hello samma beaktanden.</span><span class="sxs-lookup"><span data-stu-id="0e239-121">We've found that hello scenarios for hello SIs map toohello scenarios for Enterprises, so hello same considerations apply.</span></span>

### <a name="internal-software-development-teams"></a><span data-ttu-id="0e239-122">Interna programvaran utvecklingsgrupper</span><span class="sxs-lookup"><span data-stu-id="0e239-122">Internal software development teams</span></span>
<span data-ttu-id="0e239-123">Om din grupp utvecklar programvara toosupport ditt företag, tillhandahåller mallar ett enkelt sätt tooquickly distribuera teknik för företag-specifika lösningar.</span><span class="sxs-lookup"><span data-stu-id="0e239-123">If your team develops software toosupport your business, templates provide an easy way tooquickly deploy technologies for use in business-specific solutions.</span></span> <span data-ttu-id="0e239-124">Du kan också använda mallar toorapidly skapar utbildning miljöer som aktiverar team medlemmar toogain nödvändiga kunskaper.</span><span class="sxs-lookup"><span data-stu-id="0e239-124">You can also use templates toorapidly create training environments that enable team members toogain necessary skills.</span></span>

<span data-ttu-id="0e239-125">Du kan använda mallar som-är eller utöka eller skriva dem tooaccommodate dina behov.</span><span class="sxs-lookup"><span data-stu-id="0e239-125">You can use templates as-is or extend or compose them tooaccommodate your needs.</span></span> <span data-ttu-id="0e239-126">Med taggar inom mallar, kan du ange fakturering sammanfattning med olika vyer som team, projekt, individuella och utbildning.</span><span class="sxs-lookup"><span data-stu-id="0e239-126">Using tagging within templates, you can provide a billing summary with various views such as team, project, individual, and education.</span></span>

<span data-ttu-id="0e239-127">Företag vill ofta programvaruutveckling team toocreate en mall för konsekvent distribution av en lösning.</span><span class="sxs-lookup"><span data-stu-id="0e239-127">Businesses often want software development teams toocreate a template for consistent deployment of a solution.</span></span> <span data-ttu-id="0e239-128">hello mallen underlättar begränsningar så vissa objekt i den miljön som är fasta och inte kan åsidosättas.</span><span class="sxs-lookup"><span data-stu-id="0e239-128">hello template facilitates constraints so certain items within that environment remain fixed and can't be overridden.</span></span> <span data-ttu-id="0e239-129">En bank kan till exempel kräva en mall tooinclude RBAC så programmerare inte kan redigera en bank lösning toosend data tooa personliga storage-konto.</span><span class="sxs-lookup"><span data-stu-id="0e239-129">For example, a bank might require a template tooinclude RBAC so a programmer can’t revise a banking solution toosend data tooa personal storage account.</span></span>

### <a name="corporate-it"></a><span data-ttu-id="0e239-130">Företagets IT</span><span class="sxs-lookup"><span data-stu-id="0e239-130">Corporate IT</span></span>
<span data-ttu-id="0e239-131">Företagets IT-organisationer använder vanligtvis mallar för att leverera molnet kapaciteten och molnbaserade funktioner.</span><span class="sxs-lookup"><span data-stu-id="0e239-131">Corporate IT organizations typically use templates for delivering cloud capacity and cloud-hosted capabilities.</span></span>

#### <a name="cloud-capacity"></a><span data-ttu-id="0e239-132">Kapacitet</span><span class="sxs-lookup"><span data-stu-id="0e239-132">Cloud capacity</span></span>
<span data-ttu-id="0e239-133">Det är ett vanligt sätt för företagets IT grupper tooprovide med kapacitet för team med ”t-shirt storlekar”, som är standard erbjudande storlekar, till exempel små, medelstora och stora.</span><span class="sxs-lookup"><span data-stu-id="0e239-133">A common way for corporate IT groups tooprovide cloud capacity for teams is with "t-shirt sizes", which are standard offering sizes such as small, medium, and large.</span></span> <span data-ttu-id="0e239-134">hello t-shirt storlek erbjudanden kan blanda olika resurstyper och kvantiteter och ger en nivå av standardisering som gör det möjligt toouse mallar.</span><span class="sxs-lookup"><span data-stu-id="0e239-134">hello t-shirt sized offerings can mix different resource types and quantities while providing a level of standardization that makes it possible toouse templates.</span></span> <span data-ttu-id="0e239-135">hello mallar ge kapacitet på ett konsekvent sätt som tillämpar företagsprinciper och använder märkning tooprovide återbetalning tooconsuming organisationer.</span><span class="sxs-lookup"><span data-stu-id="0e239-135">hello templates deliver capacity in a consistent way that enforces corporate policies and uses tagging tooprovide chargeback tooconsuming organizations.</span></span>

<span data-ttu-id="0e239-136">Du kan till exempel måste tooprovide utvecklings-, test- eller produktionsmiljöer inom vilken hello programvara utvecklingsgrupper kan distribuera lösningar.</span><span class="sxs-lookup"><span data-stu-id="0e239-136">For example, you may need tooprovide development, test, or production environments within which hello software development teams can deploy their solutions.</span></span> <span data-ttu-id="0e239-137">hello miljön innehåller en fördefinierad nätverkstopologi och element som hello programvara utvecklingsgrupper kan inte ändra, till exempel regler för åtkomst toohello internet och paket allmänheten.</span><span class="sxs-lookup"><span data-stu-id="0e239-137">hello environment has a predefined network topology and elements that hello software development teams cannot change, such as rules governing access toohello public internet and packet inspection.</span></span> <span data-ttu-id="0e239-138">Du kan också ha organisation-specifika rollerna för dessa miljöer med distinkta åtkomstbehörigheter för hello-miljö.</span><span class="sxs-lookup"><span data-stu-id="0e239-138">You may also have organization-specific roles for these environments with distinct access rights for hello environment.</span></span>

#### <a name="cloud-hosted-capabilities"></a><span data-ttu-id="0e239-139">Molnbaserade funktioner</span><span class="sxs-lookup"><span data-stu-id="0e239-139">Cloud-hosted capabilities</span></span>
<span data-ttu-id="0e239-140">Du kan använda mallar toosupport molnbaserade funktioner, inklusive enskilda programvarupaket eller sammansatta erbjudanden som erbjuds toointernal raderna i företag.</span><span class="sxs-lookup"><span data-stu-id="0e239-140">You can use templates toosupport cloud-hosted capabilities, including individual software packages or composite offerings that are offered toointernal lines of business.</span></span> <span data-ttu-id="0e239-141">Ett exempel på ett erbjudande för sammansatta är analytics as a service – analytics, visualisering och andra tekniker, levereras i en optimerad, anslutna konfiguration på en fördefinierad nätverkstopologi.</span><span class="sxs-lookup"><span data-stu-id="0e239-141">An example of a composite offering would be analytics-as-a-service—analytics, visualization, and other technologies—delivered in an optimized, connected configuration on a predefined network topology.</span></span>

<span data-ttu-id="0e239-142">Molnbaserade funktioner som påverkas av hello säkerhets- och rollen överväganden som upprättas av hello kapacitet erbjuder på som de är inbyggt.</span><span class="sxs-lookup"><span data-stu-id="0e239-142">Cloud-hosted capabilities are affected by hello security and role considerations established by hello cloud capacity offering on which they’re built.</span></span> <span data-ttu-id="0e239-143">Dessa funktioner erbjuds som de är eller som en hanterad tjänst.</span><span class="sxs-lookup"><span data-stu-id="0e239-143">These capabilities are offered as is or as a managed service.</span></span> <span data-ttu-id="0e239-144">För hello senare, begränsad åtkomst krävs tooenable åtkomst till hello miljö för hantering.</span><span class="sxs-lookup"><span data-stu-id="0e239-144">For hello latter, access-constrained roles are required tooenable access into hello environment for management purposes.</span></span>

## <a name="cloud-service-vendors"></a><span data-ttu-id="0e239-145">Cloud service leverantörer</span><span class="sxs-lookup"><span data-stu-id="0e239-145">Cloud service vendors</span></span>
<span data-ttu-id="0e239-146">Vi identifierat pratar toomany CSV: er flera metoder som du kan använda toodeploy tjänster för kunder och associerade kraven.</span><span class="sxs-lookup"><span data-stu-id="0e239-146">After talking toomany CSVs, we identified multiple approaches you can take toodeploy services for your customers and associated requirements.</span></span>

### <a name="csv-hosted-offering"></a><span data-ttu-id="0e239-147">CSV-värdbaserad erbjudande</span><span class="sxs-lookup"><span data-stu-id="0e239-147">CSV-hosted offering</span></span>
<span data-ttu-id="0e239-148">Om du har ditt erbjudande i din egen Azure-prenumeration två värd sätt är vanliga: distribuera en distinkta distribution för alla kunder eller distribuera skalningsenheter som ligger till grund för en delad infrastruktur som används för alla kunder.</span><span class="sxs-lookup"><span data-stu-id="0e239-148">If you host your offering in your own Azure subscription, two hosting approaches are common: deploying a distinct deployment for every customer or deploying scale units that underpin a shared infrastructure used for all customers.</span></span>

* <span data-ttu-id="0e239-149">**Distinkta distributioner för varje kund.**</span><span class="sxs-lookup"><span data-stu-id="0e239-149">**Distinct deployments for each customer.**</span></span> <span data-ttu-id="0e239-150">Distinkta distributioner per kund kräver fast topologier för olika kända konfigurationer.</span><span class="sxs-lookup"><span data-stu-id="0e239-150">Distinct deployments per customer require fixed topologies of different known configurations.</span></span> <span data-ttu-id="0e239-151">Dessa distributioner kan ha storlekar för olika virtuella datorer (VM), varierande antal noder och olika mängder associerad lagring.</span><span class="sxs-lookup"><span data-stu-id="0e239-151">These deployments may have different virtual machine (VM) sizes, varying numbers of nodes, and different amounts of associated storage.</span></span> <span data-ttu-id="0e239-152">Taggning av distributioner används för sammanslagning fakturering för varje kund.</span><span class="sxs-lookup"><span data-stu-id="0e239-152">Tagging of deployments is used for roll-up billing of each customer.</span></span> <span data-ttu-id="0e239-153">RBAC kan vara aktiverad tooallow kunder åtkomst tooaspects av deras molnmiljö.</span><span class="sxs-lookup"><span data-stu-id="0e239-153">RBAC may be enabled tooallow customers access tooaspects of their cloud environment.</span></span>
* <span data-ttu-id="0e239-154">**Skalningsenheter i miljöer med delade flera innehavare.**</span><span class="sxs-lookup"><span data-stu-id="0e239-154">**Scale units in shared multi-tenant environments.**</span></span> <span data-ttu-id="0e239-155">En mall kan representera en skalningsenhet för miljöer med flera innehavare.</span><span class="sxs-lookup"><span data-stu-id="0e239-155">A template can represent a scale unit for multi-tenant environments.</span></span> <span data-ttu-id="0e239-156">I det här fallet hello samma infrastruktur är används toosupport alla kunder.</span><span class="sxs-lookup"><span data-stu-id="0e239-156">In this case, hello same infrastructure is used toosupport all customers.</span></span> <span data-ttu-id="0e239-157">hello distributioner representerar en grupp med resurser som levererar en nivå av kapacitet för hello finns erbjuder, till exempel antalet användare och antal transaktioner.</span><span class="sxs-lookup"><span data-stu-id="0e239-157">hello deployments represent a group of resources that deliver a level of capacity for hello hosted offering, such as number of users and number of transactions.</span></span> <span data-ttu-id="0e239-158">Dessa skalenheter ökas eller minskas begäran krävs.</span><span class="sxs-lookup"><span data-stu-id="0e239-158">These scale units are increased or decreased as demand requires.</span></span>

### <a name="csv-offering-injected-into-customer-subscription"></a><span data-ttu-id="0e239-159">CSV-erbjudande injekteras i kundprenumerationen</span><span class="sxs-lookup"><span data-stu-id="0e239-159">CSV offering injected into customer subscription</span></span>
<span data-ttu-id="0e239-160">Du kanske vill toodeploy programvaran till prenumerationer som ägs av slutanvändare och kunder.</span><span class="sxs-lookup"><span data-stu-id="0e239-160">You may want toodeploy your software into subscriptions owned by end customers.</span></span> <span data-ttu-id="0e239-161">Du kan använda mallar toodeploy distinkta distributioner i Azure-konto för en kund.</span><span class="sxs-lookup"><span data-stu-id="0e239-161">You can use templates toodeploy distinct deployments into a customer’s Azure account.</span></span>

<span data-ttu-id="0e239-162">Dessa distributioner använda RBAC så att du kan uppdatera och hantera hello distribution inom hello kundens konto.</span><span class="sxs-lookup"><span data-stu-id="0e239-162">These deployments use RBAC so you can update and manage hello deployment within hello customer’s account.</span></span>

### <a name="azure-marketplace"></a><span data-ttu-id="0e239-163">Azure Marketplace</span><span class="sxs-lookup"><span data-stu-id="0e239-163">Azure Marketplace</span></span>
<span data-ttu-id="0e239-164">tooadvertise och sälja dina erbjudanden via en marketplace, till exempel Azure Marketplace, kan du utveckla mallar toodeliver olika typer av distributioner som körs i Azure-konto för en kund.</span><span class="sxs-lookup"><span data-stu-id="0e239-164">tooadvertise and sell your offerings through a marketplace, such as Azure Marketplace, you can develop templates toodeliver distinct types of deployments that run in a customer’s Azure account.</span></span> <span data-ttu-id="0e239-165">Dessa distinkta distributioner kan beskrivas vanligtvis som en t-shirt storlek (liten, medel, stora), produkt/målgruppen typ (community, developer, enterprise) eller funktionstyp (grundläggande hög tillgänglighet).</span><span class="sxs-lookup"><span data-stu-id="0e239-165">These distinct deployments can be typically described as a t-shirt size (small, medium, large), product/audience type (community, developer, enterprise), or feature type (basic, high availability).</span></span>  <span data-ttu-id="0e239-166">I vissa fall kan dessa typer kan du toospecify vissa attribut för hello distribution, till exempel VM eller antal diskar.</span><span class="sxs-lookup"><span data-stu-id="0e239-166">In some cases, these types allow you toospecify certain attributes of hello deployment, such as VM type or number of disks.</span></span>

## <a name="oss-projects"></a><span data-ttu-id="0e239-167">OSS projekt</span><span class="sxs-lookup"><span data-stu-id="0e239-167">OSS projects</span></span>
<span data-ttu-id="0e239-168">I projekt med öppen källkod aktivera Resource Manager-mallar en community-toodeploy en lösning som snabbt med hjälp av beprövade metoder.</span><span class="sxs-lookup"><span data-stu-id="0e239-168">Within open source projects, Resource Manager templates enable a community toodeploy a solution quickly using proven practices.</span></span> <span data-ttu-id="0e239-169">Du kan lagra mallar i GitHub-lagringsplatsen så hello gemenskapen kan ändra dem i framtiden.</span><span class="sxs-lookup"><span data-stu-id="0e239-169">You can store templates in a GitHub repository so hello community can revise them over time.</span></span> <span data-ttu-id="0e239-170">Användare kan distribuera dessa mallar i sina egna Azure-prenumerationer.</span><span class="sxs-lookup"><span data-stu-id="0e239-170">Users deploy these templates in their own Azure subscriptions.</span></span>

<span data-ttu-id="0e239-171">hello visas följande avsnitt hello saker du måste tooconsider innan du utformar din lösning.</span><span class="sxs-lookup"><span data-stu-id="0e239-171">hello following sections identify hello things you need tooconsider before designing your solution.</span></span>

## <a name="identifying-what-is-outside-and-inside-a-vm"></a><span data-ttu-id="0e239-172">Identifiera vad är utanför och inuti en virtuell dator</span><span class="sxs-lookup"><span data-stu-id="0e239-172">Identifying what is outside and inside a VM</span></span>
<span data-ttu-id="0e239-173">När du utformar din mall är användbara toolook på hello krav enligt vad som är utanför och inom hello virtuella maskiner (VMs):</span><span class="sxs-lookup"><span data-stu-id="0e239-173">As you design your template, it’s helpful toolook at hello requirements in terms of what's outside and inside hello virtual machines (VMs):</span></span>

* <span data-ttu-id="0e239-174">Utanför innebär hello virtuella datorer och andra resurser för din distribution, till exempel hello nätverkets topologi, märkning referenser toohello certifikat/hemligheter och rollbaserad åtkomstkontroll.</span><span class="sxs-lookup"><span data-stu-id="0e239-174">Outside means hello VMs and other resources of your deployment, such as hello network topology, tagging, references toohello certs/secrets, and role-based access control.</span></span> <span data-ttu-id="0e239-175">Dessa resurser är en del av din mall.</span><span class="sxs-lookup"><span data-stu-id="0e239-175">All these resources are part of your template.</span></span>
* <span data-ttu-id="0e239-176">Inuti innebär hello installerad programvara och vill övergripande tillstånd konfiguration.</span><span class="sxs-lookup"><span data-stu-id="0e239-176">Inside means hello installed software and overall desired state configuration.</span></span> <span data-ttu-id="0e239-177">Andra mekanismer som VM-tillägg eller skript, används helt eller delvis.</span><span class="sxs-lookup"><span data-stu-id="0e239-177">Other mechanisms, such as VM extensions or scripts, are used in whole or in part.</span></span> <span data-ttu-id="0e239-178">Dessa mekanismer kan identifieras och körs av hello mallen men är inte i den.</span><span class="sxs-lookup"><span data-stu-id="0e239-178">These mechanisms may be identified and executed by hello template but aren’t in it.</span></span>

<span data-ttu-id="0e239-179">Vanliga exempel aktiviteter som du vill göra ”inuti hello box”-</span><span class="sxs-lookup"><span data-stu-id="0e239-179">Common examples of activities you would do “inside hello box” include -</span></span>  

* <span data-ttu-id="0e239-180">Installera eller ta bort serverroller och funktioner</span><span class="sxs-lookup"><span data-stu-id="0e239-180">Install or remove server roles and features</span></span>
* <span data-ttu-id="0e239-181">Installera och konfigurera programvara på hello nod eller kluster</span><span class="sxs-lookup"><span data-stu-id="0e239-181">Install and configure software at hello node or cluster level</span></span>
* <span data-ttu-id="0e239-182">Distribuera webbplatser på en webbserver</span><span class="sxs-lookup"><span data-stu-id="0e239-182">Deploy websites on a web server</span></span>
* <span data-ttu-id="0e239-183">Distribuera databasen scheman</span><span class="sxs-lookup"><span data-stu-id="0e239-183">Deploy database schemas</span></span>
* <span data-ttu-id="0e239-184">Hantera registret eller andra typer av konfigurationsinställningar</span><span class="sxs-lookup"><span data-stu-id="0e239-184">Manage registry or other types of configuration settings</span></span>
* <span data-ttu-id="0e239-185">Hantera filer och kataloger</span><span class="sxs-lookup"><span data-stu-id="0e239-185">Manage files and directories</span></span>
* <span data-ttu-id="0e239-186">Starta, stoppa och hantera processer och tjänster</span><span class="sxs-lookup"><span data-stu-id="0e239-186">Start, stop, and manage processes and services</span></span>
* <span data-ttu-id="0e239-187">Hantera lokala grupper och användarkonton</span><span class="sxs-lookup"><span data-stu-id="0e239-187">Manage local groups and user accounts</span></span>
* <span data-ttu-id="0e239-188">Installera och hantera paket (.msi, .exe, yum, etc.)</span><span class="sxs-lookup"><span data-stu-id="0e239-188">Install and manage packages (.msi, .exe, yum, etc.)</span></span>
* <span data-ttu-id="0e239-189">Hantera miljövariabler</span><span class="sxs-lookup"><span data-stu-id="0e239-189">Manage environment variables</span></span>
* <span data-ttu-id="0e239-190">Köra interna skript (Windows PowerShell, bash, osv.)</span><span class="sxs-lookup"><span data-stu-id="0e239-190">Run native scripts (Windows PowerShell, bash, etc.)</span></span>

### <a name="desired-state-configuration-dsc"></a><span data-ttu-id="0e239-191">Önskad tillståndskonfiguration DSC)</span><span class="sxs-lookup"><span data-stu-id="0e239-191">Desired state configuration (DSC)</span></span>
<span data-ttu-id="0e239-192">Tänker hello interna tillståndet för dina virtuella datorer efter distributionen, vill du toomake till den här distributionen inte ”driva” från hello-konfiguration som du har definierat och kontrolleras till källkontroll.</span><span class="sxs-lookup"><span data-stu-id="0e239-192">Thinking about hello internal state of your VMs beyond deployment, you want toomake sure this deployment doesn’t "drift" from hello configuration that you have defined and checked into source control.</span></span> <span data-ttu-id="0e239-193">Den här metoden gör utvecklarna eller driftspersonal gör inte ad hoc-ändringar tooan miljö som inte kontrollerat, testas eller som registrerats i källkontroll.</span><span class="sxs-lookup"><span data-stu-id="0e239-193">This approach ensures your developers or operations staff don’t make ad-hoc changes tooan environment that are not vetted, tested, or recorded in source control.</span></span> <span data-ttu-id="0e239-194">Den här kontrollen är viktig, eftersom hello manuella ändringar inte ingår i källkontroll.</span><span class="sxs-lookup"><span data-stu-id="0e239-194">This control is important, because hello manual changes are not in source control.</span></span> <span data-ttu-id="0e239-195">De också inte en del av hello standard distribution och påverkar framtida automatiserad distribution av hello programvara.</span><span class="sxs-lookup"><span data-stu-id="0e239-195">They are also not part of hello standard deployment and will impact future automated deployments of hello software.</span></span>

<span data-ttu-id="0e239-196">Önskad tillståndskonfiguration är också viktigt från ett säkerhetsperspektiv utöver din internt anställda.</span><span class="sxs-lookup"><span data-stu-id="0e239-196">Beyond your internal employees, desired state configuration is also important from a security perspective.</span></span> <span data-ttu-id="0e239-197">Hackare försöker regelbundet toocompromise och utnyttja programvarusystem.</span><span class="sxs-lookup"><span data-stu-id="0e239-197">Hackers are regularly trying toocompromise and exploit software systems.</span></span> <span data-ttu-id="0e239-198">När lyckas är vanliga tooinstall filer och ändra annars hello tillståndet för en komprometterad system.</span><span class="sxs-lookup"><span data-stu-id="0e239-198">When successful, it's common tooinstall files and otherwise change hello state of a compromised system.</span></span> <span data-ttu-id="0e239-199">Med önskad tillståndskonfiguration kan du identifiera går mellan hello önskad och aktuell status och återställa en känd konfiguration.</span><span class="sxs-lookup"><span data-stu-id="0e239-199">Using desired state configuration, you can identify deltas between hello desired and actual state and restore a known configuration.</span></span>

<span data-ttu-id="0e239-200">Det finns resurstillägg för hello populäraste mekanismer för DSC - PowerShell DSC, Chef och Puppet.</span><span class="sxs-lookup"><span data-stu-id="0e239-200">There are resource extensions for hello most popular mechanisms for DSC - PowerShell DSC, Chef, and Puppet.</span></span> <span data-ttu-id="0e239-201">Var och en av dessa tillägg kan distribuera hello ursprungligt tillstånd för den virtuella datorn och också används toomake att hello önskad tillstånd upprätthålls.</span><span class="sxs-lookup"><span data-stu-id="0e239-201">Each of these extensions can deploy hello initial state of your VM and also be used toomake sure hello desired state is maintained.</span></span>

## <a name="common-template-scopes"></a><span data-ttu-id="0e239-202">Vanliga mallen scope</span><span class="sxs-lookup"><span data-stu-id="0e239-202">Common template scopes</span></span>
<span data-ttu-id="0e239-203">Vi har sett tre viktiga lösning mallar scope framkommer i vår erfarenhet.</span><span class="sxs-lookup"><span data-stu-id="0e239-203">In our experience, we’ve seen three key solution templates scopes emerge.</span></span> <span data-ttu-id="0e239-204">Dessa tre scope – kapacitet, kapaciteten och slutpunkt till slutpunkt lösning – beskrivs i följande avsnitt hello.</span><span class="sxs-lookup"><span data-stu-id="0e239-204">These three scopes – capacity, capability, and end-to-end solution – are described in hello following sections.</span></span>

### <a name="capacity-scope"></a><span data-ttu-id="0e239-205">Kapacitet omfång</span><span class="sxs-lookup"><span data-stu-id="0e239-205">Capacity scope</span></span>
<span data-ttu-id="0e239-206">Ett omfång kapacitet ger en uppsättning resurser i en standard-topologi som är förkonfigurerad toobe efterlever principer och förordningar.</span><span class="sxs-lookup"><span data-stu-id="0e239-206">A capacity scope delivers a set of resources in a standard topology that is pre-configured toobe in compliance with regulations and policies.</span></span> <span data-ttu-id="0e239-207">hello vanligaste exempel distribuerar en standard utvecklingsmiljö i ett scenario med företagets IT- eller SI.</span><span class="sxs-lookup"><span data-stu-id="0e239-207">hello most common example is deploying a standard development environment in an Enterprise IT or SI scenario.</span></span>

### <a name="capability-scope"></a><span data-ttu-id="0e239-208">Funktionen omfång</span><span class="sxs-lookup"><span data-stu-id="0e239-208">Capability scope</span></span>
<span data-ttu-id="0e239-209">Ett omfång kapaciteten fokuserar på att distribuera och konfigurera en topologi för en viss teknik.</span><span class="sxs-lookup"><span data-stu-id="0e239-209">A capability scope is focused on deploying and configuring a topology for a given technology.</span></span> <span data-ttu-id="0e239-210">Vanliga scenarier inklusive tekniker, till exempel SQL Server, Cassandra, Hadoop.</span><span class="sxs-lookup"><span data-stu-id="0e239-210">Common scenarios including technologies such as SQL Server, Cassandra, Hadoop.</span></span>

### <a name="end-to-end-solution-scope"></a><span data-ttu-id="0e239-211">Slutpunkt till slutpunkt lösningen omfattning</span><span class="sxs-lookup"><span data-stu-id="0e239-211">End-to-end solution scope</span></span>
<span data-ttu-id="0e239-212">En slutpunkt till slutpunkt lösningen omfattning mål utöver en enskild funktion och i stället fokuserar på att leverera en end tooend-lösning som består av flera funktioner.</span><span class="sxs-lookup"><span data-stu-id="0e239-212">An End-to-End Solution Scope is targeted beyond a single capability, and instead focused on delivering an end tooend solution comprised of multiple capabilities.</span></span>  

<span data-ttu-id="0e239-213">En lösning som omfattar mallen ska omfatta visar sig som en uppsättning av en eller flera omfång kapaciteten mallar med lösningen-specifika resurser, logik och tillstånd.</span><span class="sxs-lookup"><span data-stu-id="0e239-213">A solution-scoped template scope manifests itself as a set of one or more capability-scoped templates with solution-specific resources, logic, and desired state.</span></span> <span data-ttu-id="0e239-214">Ett exempel på en lösning som omfattar mall är en end tooend data pipeline lösningsmall.</span><span class="sxs-lookup"><span data-stu-id="0e239-214">An example of a solution-scoped template is an end tooend data pipeline solution template.</span></span> <span data-ttu-id="0e239-215">hello mall kan blanda Lösningsspecifika topologi och tillstånd med flera omfång kapaciteten lösningsmallar som Kafka, Storm och Hadoop.</span><span class="sxs-lookup"><span data-stu-id="0e239-215">hello template might mix solution-specific topology and state with multiple capability-scoped solution templates such as Kafka, Storm, and Hadoop.</span></span>

## <a name="choosing-free-form-vs-known-configurations"></a><span data-ttu-id="0e239-216">Att välja Friform kontra kända konfigurationer</span><span class="sxs-lookup"><span data-stu-id="0e239-216">Choosing free-form vs. known configurations</span></span>
<span data-ttu-id="0e239-217">Du tror först en mall bör ge konsumenterna hello största flexibilitet, men många saker påverka hello välja om toouse Friform konfigurationer kontra kända konfigurationer.</span><span class="sxs-lookup"><span data-stu-id="0e239-217">You might initially think a template should give consumers hello utmost flexibility, but many considerations affect hello choice of whether toouse free-form configurations vs. known configurations.</span></span> <span data-ttu-id="0e239-218">Det här avsnittet identifierar hello viktig kund och tekniska överväganden som formats hello metoden delas i det här dokumentet.</span><span class="sxs-lookup"><span data-stu-id="0e239-218">This section identifies hello key customer requirements and technical considerations that shaped hello approach shared in this document.</span></span>

### <a name="free-form-configurations"></a><span data-ttu-id="0e239-219">Kostnadsfri-konfigurationer</span><span class="sxs-lookup"><span data-stu-id="0e239-219">Free-form configurations</span></span>
<span data-ttu-id="0e239-220">Hello yta ljud Friform konfigurationer perfekt.</span><span class="sxs-lookup"><span data-stu-id="0e239-220">On hello surface, free-form configurations sound ideal.</span></span> <span data-ttu-id="0e239-221">De kan du tooselect en VM-typ och innehåller ett godtyckligt antal noder och anslutna diskar för dessa noder, och göra det som parametrar tooa mall.</span><span class="sxs-lookup"><span data-stu-id="0e239-221">They allow you tooselect a VM type and provide an arbitrary number of nodes and attached disks for those nodes — and do so as parameters tooa template.</span></span> <span data-ttu-id="0e239-222">Den här metoden är inte idealiskt för vissa scenarier.</span><span class="sxs-lookup"><span data-stu-id="0e239-222">However, this approach is not ideal for some scenarios.</span></span>

<span data-ttu-id="0e239-223">I [storlekar för virtuella datorer](../virtual-machines/windows/sizes.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json)hello VM av olika typer och storlekar som kan identifieras och var och en av hello antal beständiga diskar (2, 4, 8, 16 eller 32) som kan bifogas.</span><span class="sxs-lookup"><span data-stu-id="0e239-223">In [Sizes for virtual machines](../virtual-machines/windows/sizes.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json), hello different VM types and available sizes are identified, and each of hello number of durable disks (2, 4, 8, 16, or 32) that can be attached.</span></span> <span data-ttu-id="0e239-224">Varje ansluten disk innehåller 500 IOPS och multiplar av dessa diskar kan vara pooler för en multiplikator som antalet IOPS.</span><span class="sxs-lookup"><span data-stu-id="0e239-224">Each attached disk provides 500 IOPS and multiples of these disks can be pooled for a multiplier of that number of IOPS.</span></span> <span data-ttu-id="0e239-225">Till exempel 16 diskar kan vara grupperade tooprovide 8 000 IOPS.</span><span class="sxs-lookup"><span data-stu-id="0e239-225">For example, 16 disks can be pooled tooprovide 8,000 IOPS.</span></span> <span data-ttu-id="0e239-226">Poolning är klar med konfigurationen i hello operativsystem, använder Microsoft Windows lagringsutrymmen eller redundant array of prisvärda diskar (RAID) i Linux.</span><span class="sxs-lookup"><span data-stu-id="0e239-226">Pooling is done with configuration in hello operating system, using Microsoft Windows Storage Spaces or redundant array of inexpensive disks (RAID) in Linux.</span></span>

<span data-ttu-id="0e239-227">En konfiguration kan hello markeringen flera VM-instanser olika VM typer och storlekar för dessa instanser olika diskar för hello VM-typ, och en eller flera skript tooconfigure hello VM innehållet.</span><span class="sxs-lookup"><span data-stu-id="0e239-227">A free-form configuration enables hello selection several VM instances, various VM types and sizes for those instances, various disks for hello VM type, and one or more scripts tooconfigure hello VM contents.</span></span>

<span data-ttu-id="0e239-228">Det är vanligt att en distribution kan ha flera typer av noder, till exempel master- och datanoder, så den här flexibiliteten ofta har angetts för varje nodtyp.</span><span class="sxs-lookup"><span data-stu-id="0e239-228">It is common that a deployment may have multiple types of nodes, such as master and data nodes, so this flexibility is often provided for every node type.</span></span>

<span data-ttu-id="0e239-229">När du börjar toodeploy kluster alla signifikanta börja toowork med dessa avancerade scenarier.</span><span class="sxs-lookup"><span data-stu-id="0e239-229">As you start toodeploy clusters of any significance, you begin toowork with these complex scenarios.</span></span> <span data-ttu-id="0e239-230">Om du distribuerar ett Hadoop-kluster, till exempel skulle med 8 överordnade noder 200 datanoder och pool 4 anslutna diskar på varje nod och grupperade 16 anslutna diskar per datanod du ha 208 virtuella datorer och 3,232 diskar toomanage.</span><span class="sxs-lookup"><span data-stu-id="0e239-230">If you were deploying a Hadoop cluster, for example, with 8 master nodes and 200 data nodes, and pooled 4 attached disks on each master node and pooled 16 attached disks per data node, you would have 208 VMs and 3,232 disks toomanage.</span></span>

<span data-ttu-id="0e239-231">Storage-konto kommer begränsning begäranden ovan dess identifierade 20 000 transaktioner per sekund begränsa, så du bör titta på lagring konto partitionering och beräkningar toodetermine hello lämpligt antal storage-konton tooaccommodate den här topologin.</span><span class="sxs-lookup"><span data-stu-id="0e239-231">A storage account will throttle requests above its identified 20,000 transactions/second limit, so you should look at storage account partitioning and use calculations toodetermine hello appropriate number of storage accounts tooaccommodate this topology.</span></span> <span data-ttu-id="0e239-232">Angivna hello mängden kombinationer som stöds av hello Friform metoden dynamiska beräkningar är obligatoriska toodetermine hello partitionering lämpliga.</span><span class="sxs-lookup"><span data-stu-id="0e239-232">Given hello multitude of combinations supported by hello free-form approach, dynamic calculations are required toodetermine hello appropriate partitioning.</span></span> <span data-ttu-id="0e239-233">hello Azure Resource Manager-mall språk tillhandahåller för närvarande inte matematiska funktioner, så du måste utföra dessa beräkningar i koden genereras en unik, hårdkodade mall med hello rätt information.</span><span class="sxs-lookup"><span data-stu-id="0e239-233">hello Azure Resource Manager Template Language does not presently provide mathematical functions, so you must perform these calculations in code, generating a unique, hard-coded template with hello appropriate details.</span></span>

<span data-ttu-id="0e239-234">I företagets IT och SI scenarier någon underhålla hello mallar och stöder hello distribueras topologier för en eller flera organisationer.</span><span class="sxs-lookup"><span data-stu-id="0e239-234">In enterprise IT and SI scenarios, someone must maintain hello templates and support hello deployed topologies for one or more organizations.</span></span> <span data-ttu-id="0e239-235">Den här ytterligare kostnader – olika konfigurationer och mallar för varje kund, är ett långt önskvärt.</span><span class="sxs-lookup"><span data-stu-id="0e239-235">This additional overhead — different configurations and templates for each customer — is far from desirable.</span></span>

<span data-ttu-id="0e239-236">Du kan använda dessa mallar toodeploy miljöer i kundens Azure-prenumeration, men både företagets IT-team och CSV: er vanligtvis distribuera dem till sina egna prenumerationer med hjälp av en återbetalning funktionen toobill sina kunder.</span><span class="sxs-lookup"><span data-stu-id="0e239-236">You can use these templates toodeploy environments in your customer’s Azure subscription, but both corporate IT teams and CSVs typically deploy them into their own subscriptions, using a chargeback function toobill their customers.</span></span> <span data-ttu-id="0e239-237">I dessa scenarier hello målet är toodeploy kapacitet för flera kunder i en pool av prenumerationer och Behåll distributioner tätt fyllts i hello prenumerationer toominimize prenumeration svällande – det vill säga flera prenumerationer toomanage.</span><span class="sxs-lookup"><span data-stu-id="0e239-237">In these scenarios, hello goal is toodeploy capacity for multiple customers across a pool of subscriptions and keep deployments densely populated into hello subscriptions toominimize subscription sprawl—that is, more subscriptions toomanage.</span></span> <span data-ttu-id="0e239-238">Med dynamisk verkligen distributionsstorlekarna kan uppnå den här typen av densitet krävs noggrann planering och ytterligare utveckling för scaffold-teknik för arbete uppdrag hello organisation.</span><span class="sxs-lookup"><span data-stu-id="0e239-238">With truly dynamic deployment sizes, achieving this type of density requires careful planning and additional development for scaffolding work on behalf of hello organization.</span></span>

<span data-ttu-id="0e239-239">Dessutom kan inte skapa prenumerationer via ett API-anrop men måste göra det manuellt via hello-portalen.</span><span class="sxs-lookup"><span data-stu-id="0e239-239">In addition, you can’t create subscriptions via an API call but must do so manually through hello portal.</span></span> <span data-ttu-id="0e239-240">När hello antalet prenumerationer ökar alla resulterande prenumeration svällande kräver mänsklig inblandning – kan automatiseras.</span><span class="sxs-lookup"><span data-stu-id="0e239-240">As hello number of subscriptions increases, any resulting subscription sprawl requires human intervention—it can’t be automated.</span></span> <span data-ttu-id="0e239-241">Med så mycket variationer i hello storlekar för distributioner av du skulle ha toopre etablera ett antal prenumerationer manuellt tooensure prenumerationer som är tillgängliga.</span><span class="sxs-lookup"><span data-stu-id="0e239-241">With so much variability in hello sizes of deployments, you would have toopre-provision a number of subscriptions manually tooensure subscriptions are available.</span></span>

<span data-ttu-id="0e239-242">Med tanke på sådana faktorer är en helt fritt format konfiguration mindre tilltalande än Min första tanke.</span><span class="sxs-lookup"><span data-stu-id="0e239-242">Considering all these factors, a truly free-form configuration is less appealing than at first blush.</span></span>

### <a name="known-configurations--hello-t-shirt-sizing-approach"></a><span data-ttu-id="0e239-243">Kända konfigurationer – hello t-shirt storlek metod</span><span class="sxs-lookup"><span data-stu-id="0e239-243">Known configurations — hello t-shirt sizing approach</span></span>
<span data-ttu-id="0e239-244">Snarare än erbjuder en mall som ger totalt flexibilitet och oräkneliga variationer i vår erfarenhet vanliga mönstret är tooprovide hello möjlighet tooselect kända konfigurationer – i praktiken standard t-shirt storlekar, till exempel sandbox små, medelstora och stora.</span><span class="sxs-lookup"><span data-stu-id="0e239-244">Rather than offer a template that provides total flexibility and countless variations, in our experience a common pattern is tooprovide hello ability tooselect known configurations — in effect, standard t-shirt sizes such as sandbox, small, medium, and large.</span></span> <span data-ttu-id="0e239-245">Andra exempel på t-shirt storlekar är produkterbjudanden, till exempel community edition eller enterprise edition.</span><span class="sxs-lookup"><span data-stu-id="0e239-245">Other examples of t-shirt sizes are product offerings, such as community edition or enterprise edition.</span></span>  <span data-ttu-id="0e239-246">I andra fall kan det vara belastningsspecifikt konfigurationer av en teknik – som kartan minska eller utan sql.</span><span class="sxs-lookup"><span data-stu-id="0e239-246">In other cases, it may be workload-specific configurations of a technology – such as map reduce or no sql.</span></span>

<span data-ttu-id="0e239-247">Många företagets IT organisationer, OSS leverantörer och SIs gör sina erbjudanden just nu på detta sätt i lokal virtualiserade miljöer (företag) eller programvara som en tjänst (SaaS)-erbjudanden (CSV: er och OSVs).</span><span class="sxs-lookup"><span data-stu-id="0e239-247">Many enterprise IT organizations, OSS vendors, and SIs make their offerings available today in this way in on-premises, virtualized environments (enterprises) or as software-as-a-service (SaaS) offerings (CSVs and OSVs).</span></span>

<span data-ttu-id="0e239-248">Den här metoden ger bra, kända konfigurationer i olika storlekar förkonfigurerade för kunder.</span><span class="sxs-lookup"><span data-stu-id="0e239-248">This approach provides good, known configurations of varying sizes that are preconfigured for customers.</span></span> <span data-ttu-id="0e239-249">Utan kända konfigurationer måste slutkunder fastställa klustret storlek på egen hand, factor plattform resurs begränsningar och gör matematiska tooidentify hello resulterande partitionering av lagringskonton och andra resurser (förfaller toocluster storlek och resurs begränsningar).</span><span class="sxs-lookup"><span data-stu-id="0e239-249">Without known configurations, end customers must determine cluster sizing on their own, factor in platform resource constraints, and do math tooidentify hello resulting partitioning of storage accounts and other resources (due toocluster size and resource constraints).</span></span> <span data-ttu-id="0e239-250">Kända konfigurationer aktivera kunder tooeasily väljer hello rätt t-shirt storlek – det vill säga en viss distribution.</span><span class="sxs-lookup"><span data-stu-id="0e239-250">Known configurations enable customers tooeasily select hello right t-shirt size—that is, a given deployment.</span></span> <span data-ttu-id="0e239-251">Dessutom toomaking en bättre upplevelse för hello kund ett litet antal kända konfigurationer är enklare toosupport och kan hjälpa dig att leverera en högre säkerhetsnivå för densitet.</span><span class="sxs-lookup"><span data-stu-id="0e239-251">In addition toomaking a better experience for hello customer, a small number of known configurations is easier toosupport and can help you deliver a higher level of density.</span></span>

<span data-ttu-id="0e239-252">En metod för kända konfiguration som fokuserar på t-shirt storlekar kan också ha olika antal noder i en storlek.</span><span class="sxs-lookup"><span data-stu-id="0e239-252">A known configuration approach focused on t-shirt sizes may also have varying number of nodes within a size.</span></span> <span data-ttu-id="0e239-253">Exempelvis kanske liten t-shirt mellan 3 och 10 noder.</span><span class="sxs-lookup"><span data-stu-id="0e239-253">For example, a small t-shirt size may be between 3 and 10 nodes.</span></span>  <span data-ttu-id="0e239-254">hello t-shirt storlek skulle vara utformad tooaccommodate in too10 noder och ger hello konsumenten hello möjlighet toomake Friform val in toohello maximala storlek.</span><span class="sxs-lookup"><span data-stu-id="0e239-254">hello t-shirt size would be designed tooaccommodate up too10 nodes and provide hello consumer hello ability toomake free form selections up toohello maximum size identified.</span></span>  

<span data-ttu-id="0e239-255">En t-shirt baserat på arbetsbelastning, kan vara mer Friform till sin natur vad gäller hello antalet noder som kan distribueras, men har distinkta nod arbetsbelastningsstorlek och konfigurationen av hello programvara på hello nod.</span><span class="sxs-lookup"><span data-stu-id="0e239-255">A t-shirt size based on workload type, may be more free form in nature in terms of hello number of nodes that can be deployed but will have workload distinct node size and configuration of hello software on hello node.</span></span>

<span data-ttu-id="0e239-256">T-shirt storlek baserat på produkterbjudanden, t.ex. community- eller Enterprise, kan ha olika resurstyper och maximalt antal noder som kan distribueras, knutna vanligtvis toolicensing överväganden eller funktionstillgänglighet över hello olika erbjudanden.</span><span class="sxs-lookup"><span data-stu-id="0e239-256">T-shirt sizes based on product offerings, such as community or Enterprise, may have distinct resource types and maximum number of nodes that can be deployed, typically tied toolicensing considerations or feature availability across hello different offerings.</span></span>

<span data-ttu-id="0e239-257">Du kan också anpassa kunder med unika varianter med hjälp av hello JSON-baserade mallar.</span><span class="sxs-lookup"><span data-stu-id="0e239-257">You can also accommodate customers with unique variants using hello JSON-based templates.</span></span> <span data-ttu-id="0e239-258">När du hanterar avvikare, kan du införliva hello lämplig planering och överväganden för utveckling, support och kostnadshantering.</span><span class="sxs-lookup"><span data-stu-id="0e239-258">When dealing with outliers, you can incorporate hello appropriate planning and considerations for development, support, and costing.</span></span>

<span data-ttu-id="0e239-259">Baserat på hello kunden mallen förbrukning scenarier och krav hello början av det här dokumentet kan identifiera vi ett mönster för mallen uppdelning.</span><span class="sxs-lookup"><span data-stu-id="0e239-259">Based on hello customer template consumption scenarios, and requirements identified at hello start of this document, we identified a pattern for template decomposition.</span></span>

## <a name="capacity-and-capability-scoped-solution-templates"></a><span data-ttu-id="0e239-260">Kapacitet och kapaciteten omfång lösningsmallar</span><span class="sxs-lookup"><span data-stu-id="0e239-260">Capacity and capability-scoped solution templates</span></span>
<span data-ttu-id="0e239-261">Uppdelning ger en modulär metod tootemplate utveckling som stöder återanvändning utökningsbarhet, testning och tooling.</span><span class="sxs-lookup"><span data-stu-id="0e239-261">Decomposition provides a modular approach tootemplate development that supports reuse, extensibility, testing, and tooling.</span></span> <span data-ttu-id="0e239-262">Det här avsnittet innehåller information om hur en uppdelning metod kan vara tillämpade tootemplates med en kapacitet omfattning.</span><span class="sxs-lookup"><span data-stu-id="0e239-262">This section provides detail on how a decomposition approach can be applied tootemplates with a Capacity or Capability scope.</span></span>

<span data-ttu-id="0e239-263">I den här metoden en Huvudmall tar emot parametervärden från en mall för konsument sedan länkar tooseveral typer av mallar och skript nedströms enligt nedan.</span><span class="sxs-lookup"><span data-stu-id="0e239-263">In this approach, a main template receives parameter values from a template consumer, then links tooseveral types of templates and scripts downstream as shown below.</span></span> <span data-ttu-id="0e239-264">Parametrar, statiska variabler och genererade variabler är används tooprovide värden till och från hello länkade mallar.</span><span class="sxs-lookup"><span data-stu-id="0e239-264">Parameters, static variables, and generated variables are used tooprovide values in and out of hello linked templates.</span></span>

![Mallparametrar](./media/best-practices-resource-manager-design-templates/template-parameters.png)

<span data-ttu-id="0e239-266">**Parametrar skickas tooa Huvudmall sedan toolinked mallar**</span><span class="sxs-lookup"><span data-stu-id="0e239-266">**Parameters are passed tooa main template then toolinked templates**</span></span>

<span data-ttu-id="0e239-267">följande avsnitt fokus på hello typer av mallar och skript som en mall delas i hello.</span><span class="sxs-lookup"><span data-stu-id="0e239-267">hello following sections focus on hello types of templates and scripts that a single template is decomposed into.</span></span> <span data-ttu-id="0e239-268">hello avsnitt beskrivs metoder för att skicka statusinformation mellan hello mallar.</span><span class="sxs-lookup"><span data-stu-id="0e239-268">hello sections present approaches for passing state information among hello templates.</span></span> <span data-ttu-id="0e239-269">Varje mall och hello skript typer hello bild beskrivs tillsammans med exempel.</span><span class="sxs-lookup"><span data-stu-id="0e239-269">Each template and hello script types in hello image are described along with examples.</span></span> <span data-ttu-id="0e239-270">Kontextuella exempel finns i ”sätta ihop: ett exempel på implementering” senare i det här dokumentet.</span><span class="sxs-lookup"><span data-stu-id="0e239-270">For a contextual example, see "Putting it together: a sample implementation" later in this document.</span></span>

### <a name="template-metadata"></a><span data-ttu-id="0e239-271">Mallens metadata</span><span class="sxs-lookup"><span data-stu-id="0e239-271">Template metadata</span></span>
<span data-ttu-id="0e239-272">Mallens metadata (hello metadata.json-fil) innehåller nyckel/värde-par som beskriver en mall i JSON som kan läsas av människor och programvarusystem.</span><span class="sxs-lookup"><span data-stu-id="0e239-272">Template metadata (hello metadata.json file) contains key/value pairs that describe a template in JSON, which can be read by humans and software systems.</span></span>

![Mallens metadata](./media/best-practices-resource-manager-design-templates/template-metadata.png)

<span data-ttu-id="0e239-274">**Mallens metadata beskrivs i hello metadata.json fil**</span><span class="sxs-lookup"><span data-stu-id="0e239-274">**Template metadata is described in hello metadata.json file**</span></span>

<span data-ttu-id="0e239-275">Programvaruagenter kan hämta hello metadata.json filen och publicera hello information och en länk toohello mall i en webbsida eller katalog.</span><span class="sxs-lookup"><span data-stu-id="0e239-275">Software agents can retrieve hello metadata.json file and publish hello information and a link toohello template in a web page or directory.</span></span> <span data-ttu-id="0e239-276">Delar är *itemDisplayName*, *beskrivning*, *sammanfattning*, *githubUsername*, och *dateUpdated*.</span><span class="sxs-lookup"><span data-stu-id="0e239-276">Elements include *itemDisplayName*, *description*, *summary*, *githubUsername*, and *dateUpdated*.</span></span>

<span data-ttu-id="0e239-277">Nedan visas en exempelfil i sin helhet.</span><span class="sxs-lookup"><span data-stu-id="0e239-277">An example file is shown below in its entirety.</span></span>

    {
        "itemDisplayName": "PostgreSQL 9.3 on Ubuntu VMs",
        "description": "This template creates a PostgreSQL streaming-replication between a master and one or more slave servers each with 2 striped data disks. hello database servers are deployed into a private-only subnet with one publicly accessible jumpbox VM in a DMZ subnet with public IP.",
        "summary": "PostgreSQL stream-replication with multiple slave servers and a publicly accessible jumpbox VM",
        "githubUsername": "arsenvlad",
        "dateUpdated": "2015-04-24"
    }

### <a name="main-template"></a><span data-ttu-id="0e239-278">Huvudmall</span><span class="sxs-lookup"><span data-stu-id="0e239-278">Main template</span></span>
<span data-ttu-id="0e239-279">hello Huvudmall tar emot parametrar från en användare använder denna information toopopulate komplexa objektvariabler och kör hello länkade mallar.</span><span class="sxs-lookup"><span data-stu-id="0e239-279">hello main template receives parameters from a user, uses that information toopopulate complex object variables, and executes hello linked templates.</span></span>

![Huvudmall](./media/best-practices-resource-manager-design-templates/main-template.png)

<span data-ttu-id="0e239-281">**hello Huvudmall tar emot parametrar från en användare**</span><span class="sxs-lookup"><span data-stu-id="0e239-281">**hello main template receives parameters from a user**</span></span>

<span data-ttu-id="0e239-282">En parameter som har angetts är en känd konfiguration kallas även hello t-shirt storleksparameter på grund av dess standardiserade värden, till exempel små, medel eller stor.</span><span class="sxs-lookup"><span data-stu-id="0e239-282">One parameter that is provided is a known configuration type also known as hello t-shirt size parameter because of its standardized values such as small, medium, or large.</span></span> <span data-ttu-id="0e239-283">Du kan använda den här parametern på flera olika sätt i praktiken.</span><span class="sxs-lookup"><span data-stu-id="0e239-283">In practice, you can use this parameter in multiple ways.</span></span> <span data-ttu-id="0e239-284">Mer information finns i ”kända configuration resurser mall” senare i det här dokumentet.</span><span class="sxs-lookup"><span data-stu-id="0e239-284">For details, see "Known configuration resources template" later in this document.</span></span>

<span data-ttu-id="0e239-285">Vissa resurser har distribuerats oavsett hello kända konfiguration som angetts av en användare-parameter.</span><span class="sxs-lookup"><span data-stu-id="0e239-285">Some resources are deployed regardless of hello known configuration specified by a user parameter.</span></span> <span data-ttu-id="0e239-286">Dessa resurser etableras med en enda delad resurs-mall och delas med andra mallar så hello delad resurs mallen körs första.</span><span class="sxs-lookup"><span data-stu-id="0e239-286">These resources are provisioned using a single shared resource template and are shared by other templates, so hello shared resource template is run first.</span></span>

<span data-ttu-id="0e239-287">Vissa resurser har distribuerats eventuellt oavsett hello angivna kända konfiguration.</span><span class="sxs-lookup"><span data-stu-id="0e239-287">Some resources are deployed optionally regardless of hello specified known configuration.</span></span>

### <a name="shared-resources-template"></a><span data-ttu-id="0e239-288">Mall för delade resurser</span><span class="sxs-lookup"><span data-stu-id="0e239-288">Shared resources template</span></span>
<span data-ttu-id="0e239-289">Den här mallen innehåller resurser som är gemensamma för alla kända konfigurationer.</span><span class="sxs-lookup"><span data-stu-id="0e239-289">This template delivers resources that are common across all known configurations.</span></span> <span data-ttu-id="0e239-290">Den innehåller hello virtuellt nätverk, tillgänglighetsuppsättningar och andra resurser som krävs oavsett hello kända konfigurationsmall som har distribuerats.</span><span class="sxs-lookup"><span data-stu-id="0e239-290">It contains hello virtual network, availability sets, and other resources that are required regardless of hello known configuration template that is deployed.</span></span>

![För Mallresurser](./media/best-practices-resource-manager-design-templates/template-resources.png)

<span data-ttu-id="0e239-292">**Mall för delade resurser**</span><span class="sxs-lookup"><span data-stu-id="0e239-292">**Shared resources template**</span></span>

<span data-ttu-id="0e239-293">Resursnamn, till exempel hello virtuella nätverksnamnet baseras på hello Huvudmall.</span><span class="sxs-lookup"><span data-stu-id="0e239-293">Resource names, such as hello virtual network name, are based on hello main template.</span></span> <span data-ttu-id="0e239-294">Du kan ange dem som en variabel i mallen eller tas emot som en parameter från hello användaren som krävs av din organisation.</span><span class="sxs-lookup"><span data-stu-id="0e239-294">You can specify them as a variable within that template or receive them as a parameter from hello user, as required by your organization.</span></span>

### <a name="optional-resources-template"></a><span data-ttu-id="0e239-295">Valfria resurser mall</span><span class="sxs-lookup"><span data-stu-id="0e239-295">Optional resources template</span></span>
<span data-ttu-id="0e239-296">mallen för hello valfria resurser innehåller resurser som distribueras via programmering baserat på hello-värdet för en parameter eller variabel.</span><span class="sxs-lookup"><span data-stu-id="0e239-296">hello optional resources template contains resources that are programmatically deployed based on hello value of a parameter or variable.</span></span>

![Valfria resurser](./media/best-practices-resource-manager-design-templates/optional-resources.png)

<span data-ttu-id="0e239-298">**Valfria resurser mall**</span><span class="sxs-lookup"><span data-stu-id="0e239-298">**Optional resources template**</span></span>

<span data-ttu-id="0e239-299">Du kan till exempel använda en valfri resurser mallen tooconfigure en jumpbox som möjliggör indirekt åtkomst tooa distribuerad miljö från hello offentliga Internet.</span><span class="sxs-lookup"><span data-stu-id="0e239-299">For example, you can use an optional resources template tooconfigure a jumpbox that enables indirect access tooa deployed environment from hello public Internet.</span></span> <span data-ttu-id="0e239-300">Du vill använda en parameter eller variabel tooidentify om hello jumpbox ska aktiveras och hello *concat* funktionsnamn toobuild hello mål för hello mall som *jumpbox_enabled.json*.</span><span class="sxs-lookup"><span data-stu-id="0e239-300">You would use a parameter or variable tooidentify whether hello jumpbox should be enabled and hello *concat* function toobuild hello target name for hello template, such as *jumpbox_enabled.json*.</span></span> <span data-ttu-id="0e239-301">Länka mallen använder hello resulterande variabeln tooinstall hello jumpbox.</span><span class="sxs-lookup"><span data-stu-id="0e239-301">Template linking would use hello resulting variable tooinstall hello jumpbox.</span></span>

<span data-ttu-id="0e239-302">Du kan länka hello valfria resurser mall från flera platser:</span><span class="sxs-lookup"><span data-stu-id="0e239-302">You can link hello optional resources template from multiple places:</span></span>

* <span data-ttu-id="0e239-303">När tillämpliga tooevery distribution, skapa en länk med parametern-driven hello delade resurser mallen.</span><span class="sxs-lookup"><span data-stu-id="0e239-303">When applicable tooevery deployment, create a parameter-driven link from hello shared resources template.</span></span>
* <span data-ttu-id="0e239-304">När tillämpliga tooselect kända konfigurationer, till exempel bara installera på stora distributioner – skapa en länk som drivs av parametern eller variabeln-driven från hello kända konfigurationsmall.</span><span class="sxs-lookup"><span data-stu-id="0e239-304">When applicable tooselect known configurations—for example, only install on large deployments—create a parameter-driven or variable-driven link from hello known configuration template.</span></span>

<span data-ttu-id="0e239-305">Om en viss resurs är valfria kan inte styrs av hello mallen konsument utan hello mall-providern.</span><span class="sxs-lookup"><span data-stu-id="0e239-305">Whether a given resource is optional may not be driven by hello template consumer but instead by hello template provider.</span></span> <span data-ttu-id="0e239-306">Du kanske till exempel måste toosatisfy krav för en viss produkt eller produkt-tillägg (common för CSV: er) eller tooenforce principer (common för SIs och företagets IT grupper).</span><span class="sxs-lookup"><span data-stu-id="0e239-306">For example, you may need toosatisfy a particular product requirement or product add-on (common for CSVs) or tooenforce policies (common for SIs and enterprise IT groups).</span></span> <span data-ttu-id="0e239-307">I dessa fall kan använda du variabeln tooidentify om hello resursen ska distribueras.</span><span class="sxs-lookup"><span data-stu-id="0e239-307">In these cases, you can use a variable tooidentify whether hello resource should be deployed.</span></span>

### <a name="known-configuration-resources-template"></a><span data-ttu-id="0e239-308">Konfigurationen för kända resurser mall</span><span class="sxs-lookup"><span data-stu-id="0e239-308">Known configuration resources template</span></span>
<span data-ttu-id="0e239-309">En parameter kan vara exponerade tooallow hello mallen konsumenten toospecify en önskad konfiguration för kända toodeploy i hello huvudsakliga mallen.</span><span class="sxs-lookup"><span data-stu-id="0e239-309">In hello main template, a parameter can be exposed tooallow hello template consumer toospecify a desired known configuration toodeploy.</span></span> <span data-ttu-id="0e239-310">Den här kända konfigurationen använder ofta en t-shirt storlek metod med en uppsättning fast configuration storlekar, till exempel sandbox, small, medium, och stora.</span><span class="sxs-lookup"><span data-stu-id="0e239-310">Often, this known configuration uses a t-shirt size approach with a set of fixed configuration sizes such as sandbox, small, medium, and large.</span></span>

![Konfigurationen för kända resurser](./media/best-practices-resource-manager-design-templates/known-config.png)

<span data-ttu-id="0e239-312">**Konfigurationen för kända resurser mall**</span><span class="sxs-lookup"><span data-stu-id="0e239-312">**Known configuration resources template**</span></span>

<span data-ttu-id="0e239-313">hello t-shirt storlek metod används ofta men hello parametrar kan representera en uppsättning kända konfigurationer.</span><span class="sxs-lookup"><span data-stu-id="0e239-313">hello t-shirt size approach is commonly used, but hello parameters can represent any set of known configurations.</span></span> <span data-ttu-id="0e239-314">Du kan till exempel ange en uppsättning miljöer för ett företagsprogram som utveckling, testa och produkt.</span><span class="sxs-lookup"><span data-stu-id="0e239-314">For example, you can specify a set of environments for an enterprise application such as Development, Test, and Product.</span></span> <span data-ttu-id="0e239-315">Du kan också använda den för en cloud service toorepresent olika skala enheter, produktversioner eller produktkonfigurationer, till exempel Community, Developer eller Enterprise.</span><span class="sxs-lookup"><span data-stu-id="0e239-315">Or you could use it for a cloud service toorepresent different scale units, product versions, or product configurations such as Community, Developer, or Enterprise.</span></span>

<span data-ttu-id="0e239-316">Precis som med hello delad resurs mallen skickas variabler toohello kända konfigurationer mallen från antingen:</span><span class="sxs-lookup"><span data-stu-id="0e239-316">As with hello shared resource template, variables are passed toohello known configurations template from either:</span></span>

* <span data-ttu-id="0e239-317">En användare – det vill säga hello parametrar skickas toohello Huvudmall.</span><span class="sxs-lookup"><span data-stu-id="0e239-317">An end user—that is, hello parameters sent toohello main template.</span></span>
* <span data-ttu-id="0e239-318">En organisation, det vill säga hello variabler i hello Huvudmall som representerar interna krav eller principer.</span><span class="sxs-lookup"><span data-stu-id="0e239-318">An organization—that is, hello variables in hello main template that represent internal requirements or policies.</span></span>

### <a name="member-resources-template"></a><span data-ttu-id="0e239-319">Medlemmen resurser mall</span><span class="sxs-lookup"><span data-stu-id="0e239-319">Member resources template</span></span>
<span data-ttu-id="0e239-320">I en konfiguration för kända ingår ofta en eller flera noder medlemstyper.</span><span class="sxs-lookup"><span data-stu-id="0e239-320">Within a known configuration, one or more member node types are often included.</span></span> <span data-ttu-id="0e239-321">Till exempel med Hadoop har du överordnade noder och datanoder.</span><span class="sxs-lookup"><span data-stu-id="0e239-321">For example, with Hadoop you have master nodes and data nodes.</span></span> <span data-ttu-id="0e239-322">Om du installerar MongoDB, har du datanoder och ett avgörandet.</span><span class="sxs-lookup"><span data-stu-id="0e239-322">If you are installing MongoDB, you have data nodes and an arbiter.</span></span> <span data-ttu-id="0e239-323">Om du distribuerar DataStax har datanoder och en virtuell dator med OpsCenter installerad.</span><span class="sxs-lookup"><span data-stu-id="0e239-323">If you are deploying DataStax, you have data nodes and a VM with OpsCenter installed.</span></span>

![Medlemmar resurser](./media/best-practices-resource-manager-design-templates/member-resources.png)

<span data-ttu-id="0e239-325">**Medlemmen resurser mall**</span><span class="sxs-lookup"><span data-stu-id="0e239-325">**Member resources template**</span></span>

<span data-ttu-id="0e239-326">Varje typ av noder kan ha olika storlekar för virtuella datorer, antal anslutna diskar, skript tooinstall och Ställ in hello noder, portkonfigurationer för hello virtuella datorer, antal instanser och annan information.</span><span class="sxs-lookup"><span data-stu-id="0e239-326">Each type of nodes can have different sizes of VMs, numbers of attached disks, scripts tooinstall and set up hello nodes, port configurations for hello VMs, number of instances, and other details.</span></span> <span data-ttu-id="0e239-327">Så att varje nodtyp hämtar sin egen information för att distribuera och konfigurera en infrastruktur som kör skript toodeploy medlem resurs mallen, som innehåller hello och konfigurera programvara inom hello VM.</span><span class="sxs-lookup"><span data-stu-id="0e239-327">So each node type gets its own member resource template, which contains hello details for deploying and configuring an infrastructure as well as executing scripts toodeploy and configure software within hello VM.</span></span>

<span data-ttu-id="0e239-328">För virtuella datorer, vanligtvis är två typer av skript används ofta återanvändbara och anpassade skript.</span><span class="sxs-lookup"><span data-stu-id="0e239-328">For VMs, typically two types of scripts are used, widely reusable and custom scripts.</span></span>

### <a name="widely-reusable-scripts"></a><span data-ttu-id="0e239-329">Allmänt återanvändbara skript</span><span class="sxs-lookup"><span data-stu-id="0e239-329">Widely reusable scripts</span></span>
<span data-ttu-id="0e239-330">Allmänt återanvändbara skript kan användas för flera typer av mallar.</span><span class="sxs-lookup"><span data-stu-id="0e239-330">Widely reusable scripts can be used across multiple types of templates.</span></span> <span data-ttu-id="0e239-331">En av hello bättre exempel på dessa ofta återanvändbara skript ställer in RAID på Linux toopool diskar och få ett större antal IOPS.</span><span class="sxs-lookup"><span data-stu-id="0e239-331">One of hello better examples of these widely reusable scripts sets up RAID on Linux toopool disks and gain a greater number of IOPS.</span></span> <span data-ttu-id="0e239-332">Oavsett hello programvara installeras i hello VM, ger det här skriptet återanvändning av beprövade metoder för vanliga scenarier.</span><span class="sxs-lookup"><span data-stu-id="0e239-332">Regardless of hello software being installed in hello VM, this script provides reuse of proven practices for common scenarios.</span></span>

![Återanvändbara skript](./media/best-practices-resource-manager-design-templates/reusable-scripts.png)

<span data-ttu-id="0e239-334">**Medlemmen resurser mallar kan anropa ofta återanvändbara skript**</span><span class="sxs-lookup"><span data-stu-id="0e239-334">**Member resources templates can call widely reusable scripts**</span></span>

### <a name="custom-scripts"></a><span data-ttu-id="0e239-335">Anpassade skript</span><span class="sxs-lookup"><span data-stu-id="0e239-335">Custom scripts</span></span>
<span data-ttu-id="0e239-336">Mallar anropa ofta en eller flera skript som installerar och konfigurerar programvara på virtuella datorer.</span><span class="sxs-lookup"><span data-stu-id="0e239-336">Templates commonly call one or more scripts that install and configure software within VMs.</span></span> <span data-ttu-id="0e239-337">Ett vanligt mönster visas med stora topologier där flera instanser av en eller flera medlemstyper har distribuerats.</span><span class="sxs-lookup"><span data-stu-id="0e239-337">A common pattern is seen with large topologies where multiple instances of one or more member types are deployed.</span></span> <span data-ttu-id="0e239-338">Ett installationsskript startas för varje virtuell dator som kan köras parallellt, följt av ett installationsskript som anropas efter att alla virtuella datorer (eller alla virtuella datorer i en given Medlemstyp) har distribuerats.</span><span class="sxs-lookup"><span data-stu-id="0e239-338">An installation script is initiated for every VM that can be run in parallel, followed by a setup script that is called after all VMs (or all VMs of a given member type) are deployed.</span></span>

![Anpassade skript](./media/best-practices-resource-manager-design-templates/custom-scripts.png)

<span data-ttu-id="0e239-340">**Medlemmen resurser mallar kan anropa skript för ett visst syfte, till exempel VM-konfiguration**</span><span class="sxs-lookup"><span data-stu-id="0e239-340">**Member resources templates can call scripts for a specific purpose such as VM configuration**</span></span>

## <a name="capability-scoped-solution-template-example---redis"></a><span data-ttu-id="0e239-341">Funktionen omfång lösning mallen exempel – Redis</span><span class="sxs-lookup"><span data-stu-id="0e239-341">Capability-scoped solution template example - Redis</span></span>
<span data-ttu-id="0e239-342">tooshow hur en implementering fungerar ska vi titta på ett praktiskt exempel för att skapa en mall som underlättar hello distributionen och konfigurationen av Redis i standard t-shirt storlekar.</span><span class="sxs-lookup"><span data-stu-id="0e239-342">tooshow how an implementation might work, let's look at a practical example of building a template that facilitates hello deployment and configuration of Redis in standard t-shirt sizes.</span></span>  

<span data-ttu-id="0e239-343">Hello-distribution finns det en uppsättning delade resurser (virtuella nätverk, storage-konto, tillgänglighetsuppsättningar) och en valfri resurs (jumpbox).</span><span class="sxs-lookup"><span data-stu-id="0e239-343">For hello deployment, there are a set of shared resources (virtual network, storage account, availability sets) and an optional resource (jumpbox).</span></span> <span data-ttu-id="0e239-344">Det finns flera kända konfigurationer som t-shirt storlekar (liten, medel, stora) men med en nod skriva.</span><span class="sxs-lookup"><span data-stu-id="0e239-344">There are multiple known configurations represented as t-shirt sizes (small, medium, large) but each with a single node type.</span></span> <span data-ttu-id="0e239-345">Det finns även två specifika ändamål skript (installation, konfiguration).</span><span class="sxs-lookup"><span data-stu-id="0e239-345">There are also two purpose-specific scripts (installation, configuration).</span></span>

### <a name="creating-hello-template-files"></a><span data-ttu-id="0e239-346">Skapa hello mallfilerna</span><span class="sxs-lookup"><span data-stu-id="0e239-346">Creating hello template files</span></span>
<span data-ttu-id="0e239-347">Du skapar en Main-mall med namnet azuredeploy.json.</span><span class="sxs-lookup"><span data-stu-id="0e239-347">You would create a Main Template named azuredeploy.json.</span></span>

<span data-ttu-id="0e239-348">Du skapar den delade resurser mallen med namnet delade resources.json</span><span class="sxs-lookup"><span data-stu-id="0e239-348">You create Shared Resources Template named shared-resources.json</span></span>

<span data-ttu-id="0e239-349">Du skapar en valfri resurs mallen tooenable hello distribution av en jumpbox med namnet jumpbox_enabled.json</span><span class="sxs-lookup"><span data-stu-id="0e239-349">You create an Optional Resource Template tooenable hello deployment of a jumpbox, named jumpbox_enabled.json</span></span>

<span data-ttu-id="0e239-350">Redis använder bara en enskild nodtyp, så du skapar en enda medlem resursmall med namnet nod resources.json.</span><span class="sxs-lookup"><span data-stu-id="0e239-350">Redis uses just a single node type, so you create a single Member Resource Template named node-resources.json.</span></span>

<span data-ttu-id="0e239-351">Du vill tooinstall varje enskild nod med Redis och sedan konfigurera hello kluster.</span><span class="sxs-lookup"><span data-stu-id="0e239-351">With Redis, you want tooinstall each individual node, and then set up hello cluster.</span></span>  <span data-ttu-id="0e239-352">Du har skript tooaccommodate hello installationen och konfigurera redis-kluster-install.sh och redis-kluster-setup.sh.</span><span class="sxs-lookup"><span data-stu-id="0e239-352">You have scripts tooaccommodate hello installation and set up, redis-cluster-install.sh and redis-cluster-setup.sh.</span></span>

### <a name="linking-hello-templates"></a><span data-ttu-id="0e239-353">Länka hello mallar</span><span class="sxs-lookup"><span data-stu-id="0e239-353">Linking hello templates</span></span>
<span data-ttu-id="0e239-354">Med hjälp av mallen länka hello Huvudmall som länkar ut toohello delade resurser mall som etablerar hello virtuellt nätverk.</span><span class="sxs-lookup"><span data-stu-id="0e239-354">Using template linking, hello main template links out toohello shared resources template, which establishes hello virtual network.</span></span>

<span data-ttu-id="0e239-355">Logik har lagts till i hello Huvudmall tooenable konsumenter av hello mallen toospecify om en jumpbox ska distribueras.</span><span class="sxs-lookup"><span data-stu-id="0e239-355">Logic is added within hello main template tooenable consumers of hello template toospecify whether a jumpbox should be deployed.</span></span> <span data-ttu-id="0e239-356">En *aktiverat* värde för hello *EnableJumpbox* parametern anger att hello kunden toodeploy en jumpbox.</span><span class="sxs-lookup"><span data-stu-id="0e239-356">An *enabled* value for hello *EnableJumpbox* parameter indicates that hello customer wants toodeploy a jumpbox.</span></span> <span data-ttu-id="0e239-357">Om det här värdet anges hello mall sammanfogar *_enabled* som suffix tooa grundläggande mallnamn hello jumpbox kapaciteten.</span><span class="sxs-lookup"><span data-stu-id="0e239-357">When this value is provided, hello template concatenates *_enabled* as a suffix tooa base template name for hello jumpbox capability.</span></span>

<span data-ttu-id="0e239-358">hello Huvudmall gäller hello *stora* parametern värdet som ett suffix tooa grundläggande mall-namn för t-shirt storlekar och använder sedan detta värde i en mall länk ut för*technology_on_os_large.json*.</span><span class="sxs-lookup"><span data-stu-id="0e239-358">hello main template applies hello *large* parameter value as a suffix tooa base template name for t-shirt sizes, and then uses that value in a template link out too*technology_on_os_large.json*.</span></span>

<span data-ttu-id="0e239-359">hello topologi liknar den här bilden.</span><span class="sxs-lookup"><span data-stu-id="0e239-359">hello topology would resemble this illustration.</span></span>

![Redis-mall](./media/best-practices-resource-manager-design-templates/redis-template.png)

<span data-ttu-id="0e239-361">**Mallstruktur för ett Redis-mall**</span><span class="sxs-lookup"><span data-stu-id="0e239-361">**Template structure for a Redis template**</span></span>

### <a name="configuring-state"></a><span data-ttu-id="0e239-362">Konfigurera tillstånd</span><span class="sxs-lookup"><span data-stu-id="0e239-362">Configuring state</span></span>
<span data-ttu-id="0e239-363">Det finns två steg tooconfiguring hello tillstånd för hello noder i klustret hello, både representeras av syfte specifika skript.</span><span class="sxs-lookup"><span data-stu-id="0e239-363">For hello nodes in hello cluster, there are two steps tooconfiguring hello state, both represented by Purpose Specific Scripts.</span></span>  <span data-ttu-id="0e239-364">Redis-installerar ”redis-kluster-install.sh” och ”redis-kluster-setup.sh” konfigurerar hello klustret.</span><span class="sxs-lookup"><span data-stu-id="0e239-364">"redis-cluster-install.sh" installs Redis and "redis-cluster-setup.sh" sets up hello cluster.</span></span>

### <a name="supporting-different-size-deployments"></a><span data-ttu-id="0e239-365">Stöder olika storlekar distributioner</span><span class="sxs-lookup"><span data-stu-id="0e239-365">Supporting Different Size Deployments</span></span>
<span data-ttu-id="0e239-366">Inuti variabler, hello t-shirt storlek mall anger hello antalet noder för varje typ av toodeploy för hello anges storleken (*stora*).</span><span class="sxs-lookup"><span data-stu-id="0e239-366">Inside variables, hello t-shirt size template specifies hello number of nodes of each type toodeploy for hello specified size (*large*).</span></span> <span data-ttu-id="0e239-367">Distribuerar sedan det antalet VM-instanser som använder resurs slingor, tillhandahåller tooresources unika namn genom att lägga till ett nodnamn med ett numeriskt sekvensnummer från *copyIndex()*.</span><span class="sxs-lookup"><span data-stu-id="0e239-367">It then deploys that number of VM instances using resource loops, providing unique names tooresources by appending a node name with a numeric sequence number from *copyIndex()*.</span></span> <span data-ttu-id="0e239-368">Den gör de här stegen för båda frekvent och Varm zonen virtuella datorer som definierats i mallen för hello t-shirt namn</span><span class="sxs-lookup"><span data-stu-id="0e239-368">It does these steps for both hot and warm zone VMs, as defined in hello t-shirt name template</span></span>

## <a name="decomposition-and-end-to-end-solution-scoped-templates"></a><span data-ttu-id="0e239-369">Lösning för slutpunkt till slutpunkt och uppdelning omfång mallar</span><span class="sxs-lookup"><span data-stu-id="0e239-369">Decomposition and end-to-end solution scoped templates</span></span>
<span data-ttu-id="0e239-370">En lösningsmall med en omfattning för slutpunkt till slutpunkt lösningen fokuserar på att leverera en slutpunkt till slutpunkt-lösning.</span><span class="sxs-lookup"><span data-stu-id="0e239-370">A solution template with an end-to-end solution scope is focused on delivering an end-to-end solution.</span></span>  <span data-ttu-id="0e239-371">Den här metoden är vanligtvis en sammansättning av flera omfång kapaciteten mallar med ytterligare resurser, logik och tillstånd.</span><span class="sxs-lookup"><span data-stu-id="0e239-371">This approach is typically a composition of multiple capability-scoped templates with additional resources, logic, and state.</span></span>

<span data-ttu-id="0e239-372">Som är markerade i hello bilden nedan, är hello samma modell som används för funktionen omfång mallar utökat för mallar med en omfattning för slutpunkt till slutpunkt-lösning.</span><span class="sxs-lookup"><span data-stu-id="0e239-372">As highlighted in hello image below, hello same model used for capability scoped templates is extended for templates with an End-to-End Solution Scope.</span></span>

<span data-ttu-id="0e239-373">En mall för delade resurser och valfria resurser mallar fungera hello samma funktion som hello kapacitet och kapaciteten omfång mallen metoder, men omfattas av hello end tooend-lösning.</span><span class="sxs-lookup"><span data-stu-id="0e239-373">A Shared Resources Template and Optional Resources Templates serve hello same function as in hello capacity and capability scoped template approaches, but are scoped for hello end tooend solution.</span></span>

<span data-ttu-id="0e239-374">End-lösning för tooend omfång mallar kan också vanligtvis ha t-shirt storlekar, hello fungerande konfiguration resurser mall visar vad som krävs för en viss kända konfiguration av hello lösning.</span><span class="sxs-lookup"><span data-stu-id="0e239-374">As end tooend solution scoped templates also can typically have t-shirt sizes, hello Known Configuration Resources template reflects what is required for a given known configuration of hello solution.</span></span>

<span data-ttu-id="0e239-375">hello fungerande konfiguration resurser mallen länkar tooone eller mer kapacitet omfattas lösningsmallar som är relevanta toohello end-lösning för tooend samt hello medlem resurs mallar som krävs för hello end tooend-lösning.</span><span class="sxs-lookup"><span data-stu-id="0e239-375">hello Known Configuration Resources Template links tooone or more capability scoped solution templates that are relevant toohello end tooend solution as well as hello Member Resource Templates that are required for hello end tooend solution.</span></span>

<span data-ttu-id="0e239-376">Eftersom hello t-shirt storleken på hello-lösning kan skilja sig hello enskilda kapaciteten omfång mallen, är variabler inom hello fungerande konfiguration resurser mallen används tooprovide hello lämpliga värden för underordnade kapaciteten omfång lösning mallar toodeploy hello lämplig t-shirt storlek.</span><span class="sxs-lookup"><span data-stu-id="0e239-376">As hello t-shirt size of hello solution may be different than hello individual capability-scoped template, variables within hello Known Configuration Resources Template are used tooprovide hello appropriate values for downstream capability scoped solution templates toodeploy hello appropriate t-shirt size.</span></span>

![Slutpunkt till slutpunkt](./media/best-practices-resource-manager-design-templates/end-to-end.png)

<span data-ttu-id="0e239-378">**hello modellen används för kapacitet eller kapaciteten omfång lösningsmallar lätt kan utökas för end tooend lösning mallen scope**</span><span class="sxs-lookup"><span data-stu-id="0e239-378">**hello model used for capacity or capability scoped solution templates can be readily extended for end tooend solution template scopes**</span></span>

## <a name="preparing-templates-for-hello-marketplace"></a><span data-ttu-id="0e239-379">Förbereda mallar för hello Marketplace</span><span class="sxs-lookup"><span data-stu-id="0e239-379">Preparing templates for hello Marketplace</span></span>
<span data-ttu-id="0e239-380">hello föregående metoden enkelt kan hantera scenarier där företag, SIs och CSV: er vill tooeither distribuera hello-mallarna eller aktivera sina kunder toodeploy på egen hand.</span><span class="sxs-lookup"><span data-stu-id="0e239-380">hello preceding approach readily accommodates scenarios where Enterprises, SIs, and CSVs want tooeither deploy hello templates themselves or enable their customers toodeploy on their own.</span></span>

<span data-ttu-id="0e239-381">Ett annat önskade scenario distribuerar en mall via hello marketplace.</span><span class="sxs-lookup"><span data-stu-id="0e239-381">Another desired scenario is deploying a template via hello marketplace.</span></span>  <span data-ttu-id="0e239-382">Den här uppdelning-metoden fungerar för hello marketplace, med några mindre ändringar.</span><span class="sxs-lookup"><span data-stu-id="0e239-382">This decomposition approach works for hello marketplace as well, with some minor changes.</span></span>

<span data-ttu-id="0e239-383">Som tidigare nämnts kan mallar vara används toooffer olika distributionstyper för försäljning i hello marketplace.</span><span class="sxs-lookup"><span data-stu-id="0e239-383">As mentioned previously, templates can be used toooffer distinct deployment types for sale in hello marketplace.</span></span> <span data-ttu-id="0e239-384">Distinkta distributionstyper kanske t-shirt storlekar (liten, medel, stora), produkt/målgruppen typ (community, developer, enterprise) eller funktionstyp (grundläggande hög tillgänglighet).</span><span class="sxs-lookup"><span data-stu-id="0e239-384">Distinct deployment types may be t-shirt sizes (small, medium, large), product/audience type (community, developer, enterprise), or feature type (basic, high availability).</span></span>

<span data-ttu-id="0e239-385">Värdsystemet toolist hello kända konfigurationerna i hello marketplace som visas nedan, hello befintliga slutet tooend lösning eller begränsade mallar kan vara lätt-funktioner.</span><span class="sxs-lookup"><span data-stu-id="0e239-385">As shown below, hello existing end tooend solution or capability scoped templates can be readily utilized toolist hello different known configurations in hello marketplace.</span></span>

<span data-ttu-id="0e239-386">hello parametrar toohello Huvudmall först ändras tooremove hello ingående parameter med namnet tshirtSize.</span><span class="sxs-lookup"><span data-stu-id="0e239-386">hello parameters toohello main template are first modified tooremove hello inbound parameter named tshirtSize.</span></span>

<span data-ttu-id="0e239-387">Medan hello distinkta distributionstyper mappas toohello fungerande konfiguration resurser mall, måste de också hello gemensamma resurser och konfiguration finns i hello delade resurser mallen och potentiellt dem i valfri resurs mallar.</span><span class="sxs-lookup"><span data-stu-id="0e239-387">While hello distinct deployment types map toohello Known Configuration Resources Template, they also need hello common resources and configuration found in hello Shared Resources Template and potentially those in Optional Resource Templates.</span></span>

<span data-ttu-id="0e239-388">Om du vill toopublish din mall toohello marketplace, upprätta olika kopior av mallen Main som ersätter hello tidigare tillgängliga inkommande parametern för tshirtSize tooa variabel som är inbäddad i hello mallen.</span><span class="sxs-lookup"><span data-stu-id="0e239-388">If you want toopublish your template toohello marketplace, you establish distinct copies of your Main template that replaces hello previously available inbound parameter of tshirtSize tooa variable embedded within hello template.</span></span>

![Marketplace](./media/best-practices-resource-manager-design-templates/marketplace.png)

<span data-ttu-id="0e239-390">**Anpassning av en lösning omfång mall för hello marketplace**</span><span class="sxs-lookup"><span data-stu-id="0e239-390">**Adapting a solution scoped template for hello marketplace**</span></span>

## <a name="next-steps"></a><span data-ttu-id="0e239-391">Nästa steg</span><span class="sxs-lookup"><span data-stu-id="0e239-391">Next steps</span></span>
* <span data-ttu-id="0e239-392">toolearn om att dela tillstånd till och från mallar, se [dela tillstånd i Azure Resource Manager-mallar](best-practices-resource-manager-state.md).</span><span class="sxs-lookup"><span data-stu-id="0e239-392">toolearn about sharing state into and out of templates, see [Sharing state in Azure Resource Manager templates](best-practices-resource-manager-state.md).</span></span>
* <span data-ttu-id="0e239-393">Anvisningar om hur företag kan använda Resource Manager tooeffectively hantera prenumerationer, se [kodskelett Azure enterprise - normativ prenumeration styrning](resource-manager-subscription-governance.md).</span><span class="sxs-lookup"><span data-stu-id="0e239-393">For guidance on how enterprises can use Resource Manager tooeffectively manage subscriptions, see [Azure enterprise scaffold - prescriptive subscription governance](resource-manager-subscription-governance.md).</span></span>

