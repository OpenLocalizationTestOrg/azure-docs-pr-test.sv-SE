---
title: "Skapa en anpassad avsökning - Azure Application Gateway - Azure-portalen | Microsoft Docs"
description: "Lär dig hur du skapar en anpassad avsökningsåtgärd för Programgateway med hjälp av portalen"
services: application-gateway
documentationcenter: na
author: georgewallace
manager: timlt
editor: 
tags: azure-resource-manager
ms.assetid: 33fd5564-43a7-4c54-a9ec-b1235f661f97
ms.service: application-gateway
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 04/26/2017
ms.author: gwallace
ms.openlocfilehash: 65e9bba4ce9ac41ae2a9a8c3fa7f661165fc1403
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 08/03/2017
---
# <a name="create-a-custom-probe-for-application-gateway-by-using-the-portal"></a><span data-ttu-id="92731-103">Skapa en anpassad avsökningsåtgärd för Programgateway med hjälp av portalen</span><span class="sxs-lookup"><span data-stu-id="92731-103">Create a custom probe for Application Gateway by using the portal</span></span>

> [!div class="op_single_selector"]
> * [<span data-ttu-id="92731-104">Azure Portal</span><span class="sxs-lookup"><span data-stu-id="92731-104">Azure portal</span></span>](application-gateway-create-probe-portal.md)
> * [<span data-ttu-id="92731-105">PowerShell och Azure Resource Manager</span><span class="sxs-lookup"><span data-stu-id="92731-105">Azure Resource Manager PowerShell</span></span>](application-gateway-create-probe-ps.md)
> * [<span data-ttu-id="92731-106">PowerShell och den klassiska Azure-portalen</span><span class="sxs-lookup"><span data-stu-id="92731-106">Azure Classic PowerShell</span></span>](application-gateway-create-probe-classic-ps.md)

<span data-ttu-id="92731-107">I den här artikeln, lägger du till en anpassad avsökning en befintlig Programgateway via Azure-portalen.</span><span class="sxs-lookup"><span data-stu-id="92731-107">In this article, you add a custom probe to an existing application gateway through the Azure portal.</span></span> <span data-ttu-id="92731-108">Anpassade avsökningar är användbara för program som har ett visst hälsotillstånd Kontrollera sidan eller för program som inte tillhandahåller ett lyckat svar på standardwebbprogrammet.</span><span class="sxs-lookup"><span data-stu-id="92731-108">Custom probes are useful for applications that have a specific health check page or for applications that do not provide a successful response on the default web application.</span></span>

## <a name="before-you-begin"></a><span data-ttu-id="92731-109">Innan du börjar</span><span class="sxs-lookup"><span data-stu-id="92731-109">Before you begin</span></span>

<span data-ttu-id="92731-110">Om du inte redan har en Programgateway finns [skapa en Programgateway](application-gateway-create-gateway-portal.md) att skapa en Programgateway att arbeta med.</span><span class="sxs-lookup"><span data-stu-id="92731-110">If you do not already have an application gateway, visit [Create an Application Gateway](application-gateway-create-gateway-portal.md) to create an application gateway to work with.</span></span>

## <span data-ttu-id="92731-111"><a name="createprobe"></a>Skapa avsökningen</span><span class="sxs-lookup"><span data-stu-id="92731-111"><a name="createprobe"></a>Create the probe</span></span>

<span data-ttu-id="92731-112">Avsökningar konfigureras i en tvåstegsprocess via portalen.</span><span class="sxs-lookup"><span data-stu-id="92731-112">Probes are configured in a two-step process through the portal.</span></span> <span data-ttu-id="92731-113">Det första steget är att skapa avsökningen.</span><span class="sxs-lookup"><span data-stu-id="92731-113">The first step is to create the probe.</span></span> <span data-ttu-id="92731-114">I det andra steget du lägger till avsökningen serverdelens http-inställningar för programgatewayen.</span><span class="sxs-lookup"><span data-stu-id="92731-114">In the second step, you add the probe to the backend http settings of the application gateway.</span></span>

1. <span data-ttu-id="92731-115">Logga in på [Azure-portalen](https://portal.azure.com).</span><span class="sxs-lookup"><span data-stu-id="92731-115">Log in to the [Azure portal](https://portal.azure.com).</span></span> <span data-ttu-id="92731-116">Om du inte redan har ett konto kan du registrera dig för en [kostnadsfri utvärderingsversion för en månad](https://azure.microsoft.com/free)</span><span class="sxs-lookup"><span data-stu-id="92731-116">If you don't already have an account, you can sign up for a [free one-month trial](https://azure.microsoft.com/free)</span></span>

1. <span data-ttu-id="92731-117">Klicka på alla resurser i Azure portal Favoriter fönstret.</span><span class="sxs-lookup"><span data-stu-id="92731-117">In the Azure portal Favorites pane, click All resources.</span></span> <span data-ttu-id="92731-118">Klicka på Programgateway i bladet för alla resurser.</span><span class="sxs-lookup"><span data-stu-id="92731-118">Click the application gateway in the All resources blade.</span></span> <span data-ttu-id="92731-119">Om den prenumeration som du har valt redan har flera resurser i den, kan du ange partners.contoso.net i filtret efter namn...</span><span class="sxs-lookup"><span data-stu-id="92731-119">If the subscription you selected already has several resources in it, you can enter partners.contoso.net in the Filter by name…</span></span> <span data-ttu-id="92731-120">för att enkelt få åtkomst till Application Gateway.</span><span class="sxs-lookup"><span data-stu-id="92731-120">box to easily access the application gateway.</span></span>

1. <span data-ttu-id="92731-121">Klicka på **avsökningar** och klicka på den **Lägg till** för att lägga till en avsökning.</span><span class="sxs-lookup"><span data-stu-id="92731-121">Click **Probes** and click the **Add** button to add a probe.</span></span>

  ![Lägg till avsökning blad med information som har fyllt i][1]

1. <span data-ttu-id="92731-123">På den **Lägg till hälsoavsökningen** bladet fyller i informationen som krävs för avsökningen och när du är klar klickar du på **OK**.</span><span class="sxs-lookup"><span data-stu-id="92731-123">On the **Add health probe** blade, fill out the required information for the probe, and when complete click **OK**.</span></span>

  |<span data-ttu-id="92731-124">**Inställning**</span><span class="sxs-lookup"><span data-stu-id="92731-124">**Setting**</span></span> | <span data-ttu-id="92731-125">**Värde**</span><span class="sxs-lookup"><span data-stu-id="92731-125">**Value**</span></span> | <span data-ttu-id="92731-126">**Detaljer**</span><span class="sxs-lookup"><span data-stu-id="92731-126">**Details**</span></span>|
  |---|---|---|
  |<span data-ttu-id="92731-127">**Namn**</span><span class="sxs-lookup"><span data-stu-id="92731-127">**Name**</span></span>|<span data-ttu-id="92731-128">customProbe</span><span class="sxs-lookup"><span data-stu-id="92731-128">customProbe</span></span>|<span data-ttu-id="92731-129">Det här värdet är ett eget namn som avsökningen som är tillgänglig i portalen.</span><span class="sxs-lookup"><span data-stu-id="92731-129">This value is a friendly name to the probe that is accessible in the portal.</span></span>|
  |<span data-ttu-id="92731-130">**Protokoll**</span><span class="sxs-lookup"><span data-stu-id="92731-130">**Protocol**</span></span>|<span data-ttu-id="92731-131">HTTP eller HTTPS</span><span class="sxs-lookup"><span data-stu-id="92731-131">HTTP or HTTPS</span></span> | <span data-ttu-id="92731-132">Det protokoll som använder hälsoavsökningen.</span><span class="sxs-lookup"><span data-stu-id="92731-132">The protocol that the health probe uses.</span></span>|
  |<span data-ttu-id="92731-133">**Värden**</span><span class="sxs-lookup"><span data-stu-id="92731-133">**Host**</span></span>|<span data-ttu-id="92731-134">engångsfaktorautentisering</span><span class="sxs-lookup"><span data-stu-id="92731-134">i.e</span></span> <span data-ttu-id="92731-135">contoso.com</span><span class="sxs-lookup"><span data-stu-id="92731-135">contoso.com</span></span>|<span data-ttu-id="92731-136">Det här värdet är värdnamnet som används för avsökningen.</span><span class="sxs-lookup"><span data-stu-id="92731-136">This value is the host name that is used for the probe.</span></span> <span data-ttu-id="92731-137">Gäller endast när flera platser har konfigurerats på Application Gateway, Använd annars ”127.0.0.1”.</span><span class="sxs-lookup"><span data-stu-id="92731-137">Applicable only when multi-site is configured on Application Gateway, otherwise use '127.0.0.1'.</span></span> <span data-ttu-id="92731-138">Det här värdet skiljer sig från virtuella datorns värdnamn.</span><span class="sxs-lookup"><span data-stu-id="92731-138">This value is different from the VM host name.</span></span>|
  |<span data-ttu-id="92731-139">**Sökväg**</span><span class="sxs-lookup"><span data-stu-id="92731-139">**Path**</span></span>|<span data-ttu-id="92731-140">/ eller en annan sökväg</span><span class="sxs-lookup"><span data-stu-id="92731-140">/ or another path</span></span>|<span data-ttu-id="92731-141">Resten av en fullständig url för den anpassade avsökningen.</span><span class="sxs-lookup"><span data-stu-id="92731-141">The remainder of the full url for the custom probe.</span></span> <span data-ttu-id="92731-142">En giltig sökväg börjar med '/'.</span><span class="sxs-lookup"><span data-stu-id="92731-142">A valid path starts with '/'.</span></span> <span data-ttu-id="92731-143">Sökvägen till http://contoso.com bara använda '/'</span><span class="sxs-lookup"><span data-stu-id="92731-143">For the default path of http://contoso.com just use '/'</span></span> |
  |<span data-ttu-id="92731-144">**Intervall (sek)**</span><span class="sxs-lookup"><span data-stu-id="92731-144">**Interval (secs)**</span></span>|<span data-ttu-id="92731-145">30</span><span class="sxs-lookup"><span data-stu-id="92731-145">30</span></span>|<span data-ttu-id="92731-146">Hur ofta avsökningen körs för att söka efter hälsotillstånd.</span><span class="sxs-lookup"><span data-stu-id="92731-146">How often the probe is run to check for health.</span></span> <span data-ttu-id="92731-147">Det rekommenderas inte att ange lägst än 30 sekunder.</span><span class="sxs-lookup"><span data-stu-id="92731-147">It is not recommended to set the lower than 30 seconds.</span></span>|
  |<span data-ttu-id="92731-148">**Timeout (sek)**</span><span class="sxs-lookup"><span data-stu-id="92731-148">**Timeout (secs)**</span></span>|<span data-ttu-id="92731-149">30</span><span class="sxs-lookup"><span data-stu-id="92731-149">30</span></span>|<span data-ttu-id="92731-150">Hur lång tid avsökningen timeout.</span><span class="sxs-lookup"><span data-stu-id="92731-150">The amount of time the probe waits before timing out.</span></span> <span data-ttu-id="92731-151">Timeout-intervall måste vara tillräckligt högt för att en http-anrop kan göras så sidan backend hälsotillstånd är tillgänglig.</span><span class="sxs-lookup"><span data-stu-id="92731-151">The timeout interval needs to be high enough that an http call can be made to ensure the backend health page is available.</span></span>|
  |<span data-ttu-id="92731-152">**Tröskelvärde för ohälsosamt värde**</span><span class="sxs-lookup"><span data-stu-id="92731-152">**Unhealthy threshold**</span></span>|<span data-ttu-id="92731-153">3</span><span class="sxs-lookup"><span data-stu-id="92731-153">3</span></span>|<span data-ttu-id="92731-154">Antal misslyckade försök att betraktas som ohälsosamt.</span><span class="sxs-lookup"><span data-stu-id="92731-154">Number of failed attempts to be considered unhealthy.</span></span> <span data-ttu-id="92731-155">Ett tröskelvärde 0 betyder som om en hälsokontroll misslyckas serverdel bestäms ohälsosamt omedelbart.</span><span class="sxs-lookup"><span data-stu-id="92731-155">A threshold of 0 means that if a health check fails the back-end is determined unhealthy immediately.</span></span>|

  > [!IMPORTANT]
  > <span data-ttu-id="92731-156">Värdnamnet är inte detsamma som servernamnet på.</span><span class="sxs-lookup"><span data-stu-id="92731-156">The host name is not the same as server name.</span></span> <span data-ttu-id="92731-157">Det här värdet är namnet på den virtuella värden som körs på programservern.</span><span class="sxs-lookup"><span data-stu-id="92731-157">This value is the name of the virtual host running on the application server.</span></span> <span data-ttu-id="92731-158">Avsökningen skickas till http://(host name):(port from httpsetting)/urlPath</span><span class="sxs-lookup"><span data-stu-id="92731-158">The probe is sent to http://(host name):(port from httpsetting)/urlPath</span></span>

## <a name="add-probe-to-the-gateway"></a><span data-ttu-id="92731-159">Lägga till avsökning till gatewayen</span><span class="sxs-lookup"><span data-stu-id="92731-159">Add probe to the gateway</span></span>

<span data-ttu-id="92731-160">Nu när avsökningen har skapats, är det dags att lägga till gatewayen.</span><span class="sxs-lookup"><span data-stu-id="92731-160">Now that the probe has been created, it is time to add it to the gateway.</span></span> <span data-ttu-id="92731-161">Avsökningen inställningar konfigureras för programgatewayen serverdelens http-inställningar.</span><span class="sxs-lookup"><span data-stu-id="92731-161">Probe settings are set on the backend http settings of the application gateway.</span></span>

1. <span data-ttu-id="92731-162">Klicka på **HTTP-inställningar** på Programgateway, så att konfigurationen bladet Klicka aktuella serverdelens http-inställningar visas i fönstret.</span><span class="sxs-lookup"><span data-stu-id="92731-162">Click **HTTP settings** on the application gateway, to bring up the configuration blade click the current backend http settings listed in the window.</span></span>

  ![fönster för HTTPS-inställningar][2]

1. <span data-ttu-id="92731-164">På den **appGatewayBackEndHttpSettings** inställningsbladet, kontrollera den **Använd anpassad avsökningsåtgärd** kryssrutan och välj avsökningen som skapats i den [skapa avsökningen](#createprobe) avsnitt på den **anpassad avsökningen** nedrullningsbara...</span><span class="sxs-lookup"><span data-stu-id="92731-164">On the **appGatewayBackEndHttpSettings** settings blade, check the **Use custom probe** checkbox and choose the probe created in the [Create the probe](#createprobe) section on the **Custom probe** drop-down..</span></span>
<span data-ttu-id="92731-165">När du är klar klickar du på **spara** och inställningarna som tillämpas.</span><span class="sxs-lookup"><span data-stu-id="92731-165">When complete, click **Save** and the settings are applied.</span></span>

<span data-ttu-id="92731-166">Standard-avsökning kontrollerar standardåtkomst till webbprogrammet.</span><span class="sxs-lookup"><span data-stu-id="92731-166">The default probe checks the default access to the web application.</span></span> <span data-ttu-id="92731-167">Nu när du har skapat en anpassad avsökning använder programgatewayen anpassad sökväg som definierats för att övervaka hälsan för backend-servrarna.</span><span class="sxs-lookup"><span data-stu-id="92731-167">Now that a custom probe has been created, the application gateway uses the custom path defined to monitor health for the backend servers.</span></span> <span data-ttu-id="92731-168">Programgatewayen kontrollerar baserat på kriterier som har definierats, den sökväg som anges i avsökningen.</span><span class="sxs-lookup"><span data-stu-id="92731-168">Based on the criteria that was defined, the application gateway checks the path specified in the probe.</span></span> <span data-ttu-id="92731-169">Om anropet till värdnamn: Port / sökvägen inte returnerar ett HTTP 200 399 Statussvaret, servern tas bort från rotationen efter ohälsosamt tröskelvärdet har uppnåtts.</span><span class="sxs-lookup"><span data-stu-id="92731-169">If the call to host:Port/path does not return an HTTP 200-399 status response, the server is taken out of rotation after the unhealthy threshold is reached.</span></span> <span data-ttu-id="92731-170">Avsökning av fortsätter på ohälsosamt instans att avgöra när det blir felfri igen.</span><span class="sxs-lookup"><span data-stu-id="92731-170">Probing continues on the unhealthy instance to determine when it becomes healthy again.</span></span> <span data-ttu-id="92731-171">När instansen läggs till felfritt serverpoolen trafiken börjar flöda till den igen och sökning till instansen fortsätter vid angivna intervall som användaren som vanligt.</span><span class="sxs-lookup"><span data-stu-id="92731-171">Once the instance is added back to healthy server pool, traffic begins flowing to it again and probing to the instance continues at user specified interval as normal.</span></span>

## <a name="next-steps"></a><span data-ttu-id="92731-172">Nästa steg</span><span class="sxs-lookup"><span data-stu-id="92731-172">Next steps</span></span>

<span data-ttu-id="92731-173">Information om hur du konfigurerar SSL-avlastning med Azure Programgateway finns [Konfigurera SSL-avlastning](application-gateway-ssl-portal.md)</span><span class="sxs-lookup"><span data-stu-id="92731-173">To learn how to configure SSL Offloading with Azure Application Gateway, see [Configure SSL Offload](application-gateway-ssl-portal.md)</span></span>

[1]: ./media/application-gateway-create-probe-portal/figure1.png
[2]: ./media/application-gateway-create-probe-portal/figure2.png

