---
title: "Översikt för hälsoövervakning för Azure Programgateway | Microsoft Docs"
description: "Lär dig mer om övervakningsfunktionerna i Azure Programgateway"
services: application-gateway
documentationcenter: na
author: georgewallace
manager: timlt
editor: 
tags: azure-resource-manager
ms.assetid: 7eeba328-bb2d-4d3e-bdac-7552e7900b7f
ms.service: application-gateway
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 12/14/2016
ms.author: gwallace
ms.openlocfilehash: 899115d213e626f17e58c2e5f01313f760f9e7f4
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 07/11/2017
---
# <a name="application-gateway-health-monitoring-overview"></a><span data-ttu-id="13e4e-103">Gateway hälsa övervakning Programöversikt</span><span class="sxs-lookup"><span data-stu-id="13e4e-103">Application Gateway health monitoring overview</span></span>

<span data-ttu-id="13e4e-104">Azure Application Gateway som standard övervakar tillståndet för alla resurser i dess backend-pool och tar automatiskt bort alla resurser som bedöms som dåligt från poolen.</span><span class="sxs-lookup"><span data-stu-id="13e4e-104">Azure Application Gateway by default monitors the health of all resources in its back-end pool and automatically removes any resource considered unhealthy from the pool.</span></span> <span data-ttu-id="13e4e-105">Programgateway fortsätter att övervaka ohälsosamt instanser och lägger till dem tillbaka till Felfri backend-poolen när de blir tillgängliga och svara på hälsoavsökningar.</span><span class="sxs-lookup"><span data-stu-id="13e4e-105">Application Gateway continues to monitor the unhealthy instances and adds them back to the healthy back-end pool once they become available and respond to health probes.</span></span> <span data-ttu-id="13e4e-106">Programgateway skickar hälsoavsökning med samma port som har definierats i backend-HTTP-inställningar.</span><span class="sxs-lookup"><span data-stu-id="13e4e-106">Application gateway sends the health probes with the same port that is defined in the back-end HTTP settings.</span></span> <span data-ttu-id="13e4e-107">Den här konfigurationen garanterar att sonden provar samma port som kunder använder skulle ansluta till serverdelen.</span><span class="sxs-lookup"><span data-stu-id="13e4e-107">This configuration ensures that the probe is testing the same port that customers would be using to connect to the backend.</span></span>

![exempel på gateway avsökning][1]

<span data-ttu-id="13e4e-109">Du kan också anpassa hälsoavsökningen så att de passar din programkrav förutom att använda standard hälsoövervakning för avsökning.</span><span class="sxs-lookup"><span data-stu-id="13e4e-109">In addition to using default health probe monitoring, you can also customize the health probe to suit your application's requirements.</span></span> <span data-ttu-id="13e4e-110">I den här artikeln omfattar både standard- och anpassade hälsoavsökningar.</span><span class="sxs-lookup"><span data-stu-id="13e4e-110">In this article, both default and custom health probes are covered.</span></span>

> [!NOTE]
> <span data-ttu-id="13e4e-111">Om det finns en NSG på Application Gateway-undernät, bör portintervall 65503 65534 öppnas i Application Gateway-undernät för inkommande trafik.</span><span class="sxs-lookup"><span data-stu-id="13e4e-111">If there is an NSG on Application Gateway subnet, port ranges 65503-65534 should be opened on the Application Gateway subnet for Inbound traffic.</span></span> <span data-ttu-id="13e4e-112">Dessa portar är obligatoriska för backend-hälsa API för att fungera.</span><span class="sxs-lookup"><span data-stu-id="13e4e-112">These ports are required for the backend health API to work.</span></span>

## <a name="default-health-probe"></a><span data-ttu-id="13e4e-113">Standard hälsoavsökningen</span><span class="sxs-lookup"><span data-stu-id="13e4e-113">Default health probe</span></span>

<span data-ttu-id="13e4e-114">En Programgateway konfigureras automatiskt en standard hälsoavsökningen när du inte konfigurera eventuella anpassade avsökningen konfiguration.</span><span class="sxs-lookup"><span data-stu-id="13e4e-114">An application gateway automatically configures a default health probe when you don't set up any custom probe configuration.</span></span> <span data-ttu-id="13e4e-115">Beteendet övervakning fungerar genom att göra en HTTP-begäran till IP-adresser som har konfigurerats för backend-poolen.</span><span class="sxs-lookup"><span data-stu-id="13e4e-115">The monitoring behavior works by making an HTTP request to the IP addresses configured for the back-end pool.</span></span> <span data-ttu-id="13e4e-116">För standard-avsökningar om serverdelens http-inställningar som är konfigurerade för HTTPS, använder avsökningen HTTPS samt för att kontrollera hälsotillståndet för serverdelar.</span><span class="sxs-lookup"><span data-stu-id="13e4e-116">For default probes if the backend http settings are configured for HTTPS, the probe uses HTTPS as well to test health of the backends.</span></span>

<span data-ttu-id="13e4e-117">Exempel: du konfigurerar din Programgateway att använda backend-servrar A, B och C som tar emot HTTP-nätverkstrafik på port 80.</span><span class="sxs-lookup"><span data-stu-id="13e4e-117">For example: You configure your application gateway to use back-end servers A, B, and C to receive HTTP network traffic on port 80.</span></span> <span data-ttu-id="13e4e-118">Standard-hälsoövervakning testar tre servrar med 30 sekunders mellanrum felfri HTTP-svar.</span><span class="sxs-lookup"><span data-stu-id="13e4e-118">The default health monitoring tests the three servers every 30 seconds for a healthy HTTP response.</span></span> <span data-ttu-id="13e4e-119">En felfri HTTP-svar har en [statuskod](https://msdn.microsoft.com/library/aa287675.aspx) mellan 200 och 399.</span><span class="sxs-lookup"><span data-stu-id="13e4e-119">A healthy HTTP response has a [status code](https://msdn.microsoft.com/library/aa287675.aspx) between 200 and 399.</span></span>

<span data-ttu-id="13e4e-120">Om standard avsökningen kontrollen misslyckas Server A programgatewayen tas den bort från dess backend-adresspool och nätverkstrafik slutar flöda till den här servern.</span><span class="sxs-lookup"><span data-stu-id="13e4e-120">If the default probe check fails for server A, the application gateway removes it from its back-end pool, and network traffic stops flowing to this server.</span></span> <span data-ttu-id="13e4e-121">Standard-avsökning fortsätter ändå att kontrollera för servern en var 30: e sekund.</span><span class="sxs-lookup"><span data-stu-id="13e4e-121">The default probe still continues to check for server A every 30 seconds.</span></span> <span data-ttu-id="13e4e-122">När server A svarar har en begäran från en standard hälsoavsökningen, läggs den tillbaka som felfri till backend-poolen och trafiken börjar flöda till servern igen.</span><span class="sxs-lookup"><span data-stu-id="13e4e-122">When server A responds successfully to one request from a default health probe, it is added back as healthy to the back-end pool, and traffic starts flowing to the server again.</span></span>

### <a name="default-health-probe-settings"></a><span data-ttu-id="13e4e-123">Standardinställningarna hälsa avsökning</span><span class="sxs-lookup"><span data-stu-id="13e4e-123">Default health probe settings</span></span>

| <span data-ttu-id="13e4e-124">Avsökningen egenskapen</span><span class="sxs-lookup"><span data-stu-id="13e4e-124">Probe property</span></span> | <span data-ttu-id="13e4e-125">Värde</span><span class="sxs-lookup"><span data-stu-id="13e4e-125">Value</span></span> | <span data-ttu-id="13e4e-126">Beskrivning</span><span class="sxs-lookup"><span data-stu-id="13e4e-126">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="13e4e-127">URL för webbavsökning</span><span class="sxs-lookup"><span data-stu-id="13e4e-127">Probe URL</span></span> |<span data-ttu-id="13e4e-128">http://127.0.0.1:\<port\>/</span><span class="sxs-lookup"><span data-stu-id="13e4e-128">http://127.0.0.1:\<port\>/</span></span> |<span data-ttu-id="13e4e-129">URL-sökväg</span><span class="sxs-lookup"><span data-stu-id="13e4e-129">URL path</span></span> |
| <span data-ttu-id="13e4e-130">intervall</span><span class="sxs-lookup"><span data-stu-id="13e4e-130">Interval</span></span> |<span data-ttu-id="13e4e-131">30</span><span class="sxs-lookup"><span data-stu-id="13e4e-131">30</span></span> |<span data-ttu-id="13e4e-132">Avsökningsintervall i sekunder</span><span class="sxs-lookup"><span data-stu-id="13e4e-132">Probe interval in seconds</span></span> |
| <span data-ttu-id="13e4e-133">Timeout</span><span class="sxs-lookup"><span data-stu-id="13e4e-133">Time-out</span></span> |<span data-ttu-id="13e4e-134">30</span><span class="sxs-lookup"><span data-stu-id="13e4e-134">30</span></span> |<span data-ttu-id="13e4e-135">Avsökningen tidsgräns i sekunder</span><span class="sxs-lookup"><span data-stu-id="13e4e-135">Probe time-out in seconds</span></span> |
| <span data-ttu-id="13e4e-136">Tröskelvärde för ohälsosamt värde</span><span class="sxs-lookup"><span data-stu-id="13e4e-136">Unhealthy threshold</span></span> |<span data-ttu-id="13e4e-137">3</span><span class="sxs-lookup"><span data-stu-id="13e4e-137">3</span></span> |<span data-ttu-id="13e4e-138">Avsökning för antal nya försök.</span><span class="sxs-lookup"><span data-stu-id="13e4e-138">Probe retry count.</span></span> <span data-ttu-id="13e4e-139">Backend-server markeras när efterföljande avsökningen Felberäkning når tröskelvärde för ohälsosamt värde.</span><span class="sxs-lookup"><span data-stu-id="13e4e-139">The back-end server is marked down after the consecutive probe failure count reaches the unhealthy threshold.</span></span> |

> [!NOTE]
> <span data-ttu-id="13e4e-140">Porten är samma port som backend-HTTP-inställningar.</span><span class="sxs-lookup"><span data-stu-id="13e4e-140">The port is the same port as the back-end HTTP settings.</span></span>

<span data-ttu-id="13e4e-141">Standard-avsökning kontrollerar endast http://127.0.0.1:\<port\> att fastställa hälsostatus.</span><span class="sxs-lookup"><span data-stu-id="13e4e-141">The default probe looks only at http://127.0.0.1:\<port\> to determine health status.</span></span> <span data-ttu-id="13e4e-142">Om du behöver konfigurera hälsoavsökningen för att gå till en anpassad URL eller ändra andra inställningar måste du använda anpassade avsökningar enligt beskrivningen i följande steg:</span><span class="sxs-lookup"><span data-stu-id="13e4e-142">If you need to configure the health probe to go to a custom URL or modify any other settings, you must use custom probes as described in the following steps:</span></span>

## <a name="custom-health-probe"></a><span data-ttu-id="13e4e-143">Anpassade hälsoavsökningen</span><span class="sxs-lookup"><span data-stu-id="13e4e-143">Custom health probe</span></span>

<span data-ttu-id="13e4e-144">Anpassade avsökningar kan du ha en mer detaljerad kontroll över övervakning av hälsotillstånd.</span><span class="sxs-lookup"><span data-stu-id="13e4e-144">Custom probes allow you to have a more granular control over the health monitoring.</span></span> <span data-ttu-id="13e4e-145">När du använder anpassade avsökningar, kan du konfigurera avsökningsintervall, URL: en och sökvägen för att testa och hur många misslyckade svar att godkänna innan du markerar backend-pool-instans som ohälsosamt.</span><span class="sxs-lookup"><span data-stu-id="13e4e-145">When using custom probes, you can configure the probe interval, the URL and path to test, and how many failed responses to accept before marking the back-end pool instance as unhealthy.</span></span>

### <a name="custom-health-probe-settings"></a><span data-ttu-id="13e4e-146">Inställningar för anpassade hälsotillstånd avsökning</span><span class="sxs-lookup"><span data-stu-id="13e4e-146">Custom health probe settings</span></span>

<span data-ttu-id="13e4e-147">Följande tabell innehåller definitioner för egenskaperna för en anpassad hälsoavsökningen.</span><span class="sxs-lookup"><span data-stu-id="13e4e-147">The following table provides definitions for the properties of a custom health probe.</span></span>

| <span data-ttu-id="13e4e-148">Avsökningen egenskapen</span><span class="sxs-lookup"><span data-stu-id="13e4e-148">Probe property</span></span> | <span data-ttu-id="13e4e-149">Beskrivning</span><span class="sxs-lookup"><span data-stu-id="13e4e-149">Description</span></span> |
| --- | --- |
| <span data-ttu-id="13e4e-150">Namn</span><span class="sxs-lookup"><span data-stu-id="13e4e-150">Name</span></span> |<span data-ttu-id="13e4e-151">Namnet på avsökningen.</span><span class="sxs-lookup"><span data-stu-id="13e4e-151">Name of the probe.</span></span> <span data-ttu-id="13e4e-152">Det här namnet används för att referera till avsökning i backend-HTTP-inställningar.</span><span class="sxs-lookup"><span data-stu-id="13e4e-152">This name is used to refer to the probe in back-end HTTP settings.</span></span> |
| <span data-ttu-id="13e4e-153">Protokoll</span><span class="sxs-lookup"><span data-stu-id="13e4e-153">Protocol</span></span> |<span data-ttu-id="13e4e-154">Protokoll som används för att skicka avsökningen.</span><span class="sxs-lookup"><span data-stu-id="13e4e-154">Protocol used to send the probe.</span></span> <span data-ttu-id="13e4e-155">Avsökningen används protokollet som definieras i backend-HTTP-inställningar</span><span class="sxs-lookup"><span data-stu-id="13e4e-155">The probe uses the protocol defined in the back-end HTTP settings</span></span> |
| <span data-ttu-id="13e4e-156">Värd</span><span class="sxs-lookup"><span data-stu-id="13e4e-156">Host</span></span> |<span data-ttu-id="13e4e-157">Värdnamn för att skicka avsökningen.</span><span class="sxs-lookup"><span data-stu-id="13e4e-157">Host name to send the probe.</span></span> <span data-ttu-id="13e4e-158">Gäller endast när flera platser har konfigurerats på Application Gateway, Använd annars ”127.0.0.1”.</span><span class="sxs-lookup"><span data-stu-id="13e4e-158">Applicable only when multi-site is configured on Application Gateway, otherwise use '127.0.0.1'.</span></span> <span data-ttu-id="13e4e-159">Det här värdet skiljer sig från den virtuella datorns värdnamn.</span><span class="sxs-lookup"><span data-stu-id="13e4e-159">This value is different from VM host name.</span></span> |
| <span data-ttu-id="13e4e-160">Sökväg</span><span class="sxs-lookup"><span data-stu-id="13e4e-160">Path</span></span> |<span data-ttu-id="13e4e-161">Avsökningen relativ sökväg.</span><span class="sxs-lookup"><span data-stu-id="13e4e-161">Relative path of the probe.</span></span> <span data-ttu-id="13e4e-162">Ogiltig sökväg startar från '/'.</span><span class="sxs-lookup"><span data-stu-id="13e4e-162">The valid path starts from '/'.</span></span> |
| <span data-ttu-id="13e4e-163">intervall</span><span class="sxs-lookup"><span data-stu-id="13e4e-163">Interval</span></span> |<span data-ttu-id="13e4e-164">Avsökning intervall i sekunder.</span><span class="sxs-lookup"><span data-stu-id="13e4e-164">Probe interval in seconds.</span></span> <span data-ttu-id="13e4e-165">Det här värdet är tidsintervallet mellan två på varandra följande avsökningar.</span><span class="sxs-lookup"><span data-stu-id="13e4e-165">This value is the time interval between two consecutive probes.</span></span> |
| <span data-ttu-id="13e4e-166">Timeout</span><span class="sxs-lookup"><span data-stu-id="13e4e-166">Time-out</span></span> |<span data-ttu-id="13e4e-167">Avsökning tidsgräns i sekunder.</span><span class="sxs-lookup"><span data-stu-id="13e4e-167">Probe time-out in seconds.</span></span> <span data-ttu-id="13e4e-168">Om ett giltigt svar inte emot inom denna tidsgräns, markeras avsökningen som misslyckad.</span><span class="sxs-lookup"><span data-stu-id="13e4e-168">If a valid response is not received within this time-out period, the probe is marked as failed.</span></span>  |
| <span data-ttu-id="13e4e-169">Tröskelvärde för ohälsosamt värde</span><span class="sxs-lookup"><span data-stu-id="13e4e-169">Unhealthy threshold</span></span> |<span data-ttu-id="13e4e-170">Avsökning för antal nya försök.</span><span class="sxs-lookup"><span data-stu-id="13e4e-170">Probe retry count.</span></span> <span data-ttu-id="13e4e-171">Backend-server markeras när efterföljande avsökningen Felberäkning når tröskelvärde för ohälsosamt värde.</span><span class="sxs-lookup"><span data-stu-id="13e4e-171">The back-end server is marked down after the consecutive probe failure count reaches the unhealthy threshold.</span></span> |

> [!IMPORTANT]
> <span data-ttu-id="13e4e-172">Om Application Gateway har konfigurerats för en viss plats, som standard värden ska namn anges som 127.0.0.1, såvida inte annat konfigurerade i anpassade avsökning.</span><span class="sxs-lookup"><span data-stu-id="13e4e-172">If Application Gateway is configured for a single site, by default the Host name should be specified as '127.0.0.1', unless otherwise configured in custom probe.</span></span>
> <span data-ttu-id="13e4e-173">För referens en anpassad avsökning skickas till \<protokollet\>://\<värden\>:\<port\>\<sökvägen\>.</span><span class="sxs-lookup"><span data-stu-id="13e4e-173">For reference a custom probe is sent to \<protocol\>://\<host\>:\<port\>\<path\>.</span></span> <span data-ttu-id="13e4e-174">Den port som används ska vara samma port som definierats i backend-HTTP-inställningar.</span><span class="sxs-lookup"><span data-stu-id="13e4e-174">The port used will be the same port as defined in the back-end HTTP settings.</span></span>

## <a name="next-steps"></a><span data-ttu-id="13e4e-175">Nästa steg</span><span class="sxs-lookup"><span data-stu-id="13e4e-175">Next steps</span></span>
<span data-ttu-id="13e4e-176">När du lära dig mer om övervakning av hälsotillstånd för Programgateway, kan du konfigurera en [anpassade hälsoavsökningen](application-gateway-create-probe-portal.md) i Azure-portalen eller en [anpassade hälsoavsökningen](application-gateway-create-probe-ps.md) med PowerShell och Azure Resource Manager distributionsmodell.</span><span class="sxs-lookup"><span data-stu-id="13e4e-176">After learning about Application Gateway health monitoring, you can configure a [custom health probe](application-gateway-create-probe-portal.md) in the Azure portal or a [custom health probe](application-gateway-create-probe-ps.md) using PowerShell and the Azure Resource Manager deployment model.</span></span>

[1]: ./media/application-gateway-probe-overview/appgatewayprobe.png
