---
title: "aaaDistributed transaktioner mellan databaser för molnet"
description: "Översikt över elastisk databastransaktioner med Azure SQL-databas"
services: sql-database
documentationcenter: 
author: torsteng
manager: jhubbard
editor: torsteng
ms.assetid: e14df7a3-7788-4cfb-bcd1-7ad6433ef1f9
ms.service: sql-database
ms.custom: scale out apps
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: sql-database
ms.date: 05/27/2016
ms.author: torsteng
ms.openlocfilehash: 9a18f2749108d337bf115b3dc21dd0c7828dd9c2
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 10/06/2017
---
# <a name="distributed-transactions-across-cloud-databases"></a><span data-ttu-id="acc4d-103">Distribuerade transaktioner över molndatabaser</span><span class="sxs-lookup"><span data-stu-id="acc4d-103">Distributed transactions across cloud databases</span></span>
<span data-ttu-id="acc4d-104">Elastisk databastransaktioner för Azure SQL Database (SQL DB) kan du toorun transaktioner som sträcker sig över flera databaser i SQL-databas.</span><span class="sxs-lookup"><span data-stu-id="acc4d-104">Elastic database transactions for Azure SQL Database (SQL DB) allow you toorun transactions that span several databases in SQL DB.</span></span> <span data-ttu-id="acc4d-105">Elastisk databastransaktioner för SQL-databas som är tillgängliga för .NET-program med hjälp av ADO .NET och integrera med hello bekant programmering med hello [System.Transaction](https://msdn.microsoft.com/library/system.transactions.aspx) klasser.</span><span class="sxs-lookup"><span data-stu-id="acc4d-105">Elastic database transactions for SQL DB are available for .NET applications using ADO .NET and integrate with hello familiar programming experience using hello [System.Transaction](https://msdn.microsoft.com/library/system.transactions.aspx) classes.</span></span> <span data-ttu-id="acc4d-106">tooget hello-biblioteket, se [.NET Framework 4.6.1 (Webbinstallationsprogram)](https://www.microsoft.com/download/details.aspx?id=49981).</span><span class="sxs-lookup"><span data-stu-id="acc4d-106">tooget hello library, see [.NET Framework 4.6.1 (Web Installer)](https://www.microsoft.com/download/details.aspx?id=49981).</span></span>

<span data-ttu-id="acc4d-107">Lokalt krävs ett sådant scenario vanligtvis kör Microsoft Distributed Transaction Coordinator (MSDTC).</span><span class="sxs-lookup"><span data-stu-id="acc4d-107">On premises, such a scenario usually required running Microsoft Distributed Transaction Coordinator (MSDTC).</span></span> <span data-ttu-id="acc4d-108">Eftersom MSDTC inte är tillgänglig för Platform as a Service program i Azure, hello möjlighet toocoordinate distribuerade transaktioner har nu direkt integrerats i SQL-databas.</span><span class="sxs-lookup"><span data-stu-id="acc4d-108">Since MSDTC is not available for Platform-as-a-Service application in Azure, hello ability toocoordinate distributed transactions has now been directly integrated into SQL DB.</span></span> <span data-ttu-id="acc4d-109">Program kan ansluta tooany SQL-databas toolaunch distribuerade transaktioner och hello databaserna kommer transparent samordna hello distribuerade transaktion som visas i följande bild hello.</span><span class="sxs-lookup"><span data-stu-id="acc4d-109">Applications can connect tooany SQL Database toolaunch distributed transactions, and one of hello databases will transparently coordinate hello distributed transaction, as shown in hello following figure.</span></span> 

  ![<span data-ttu-id="acc4d-110">Distribuerade transaktioner med Azure SQL Database med transaktioner för elastisk databas</span><span class="sxs-lookup"><span data-stu-id="acc4d-110">Distributed transactions with Azure SQL Database using elastic database transactions</span></span> ][1]

## <a name="common-scenarios"></a><span data-ttu-id="acc4d-111">Vanliga scenarier</span><span class="sxs-lookup"><span data-stu-id="acc4d-111">Common scenarios</span></span>
<span data-ttu-id="acc4d-112">Elastisk databastransaktioner för SQL DB Aktivera program toomake ändringar toodata lagras i flera olika SQL-databaser.</span><span class="sxs-lookup"><span data-stu-id="acc4d-112">Elastic database transactions for SQL DB enable applications toomake atomic changes toodata stored in several different SQL Databases.</span></span> <span data-ttu-id="acc4d-113">hello preview fokuserar på klientsidan development upplevelser i C# och .NET.</span><span class="sxs-lookup"><span data-stu-id="acc4d-113">hello preview focuses on client-side development experiences in C# and .NET.</span></span> <span data-ttu-id="acc4d-114">En serversidan upplevelse med T-SQL är planerad för ett senare tillfälle.</span><span class="sxs-lookup"><span data-stu-id="acc4d-114">A server-side experience using T-SQL is planned for a later time.</span></span>  
<span data-ttu-id="acc4d-115">Elastisk databas transaktioner mål hello följande scenarier:</span><span class="sxs-lookup"><span data-stu-id="acc4d-115">Elastic database transactions targets hello following scenarios:</span></span>

* <span data-ttu-id="acc4d-116">Flera databasprogram i Azure: med det här scenariot data är lodrätt partitionerad över flera databaser i SQL-databas så att olika typer av data som finns på olika databaser.</span><span class="sxs-lookup"><span data-stu-id="acc4d-116">Multi-database applications in Azure: With this scenario, data is vertically partitioned across several databases in SQL DB such that different kinds of data reside on different databases.</span></span> <span data-ttu-id="acc4d-117">Vissa åtgärder kräver ändringar toodata som är kvar i två eller flera databaser.</span><span class="sxs-lookup"><span data-stu-id="acc4d-117">Some operations require changes toodata which is kept in two or more databases.</span></span> <span data-ttu-id="acc4d-118">hello programmet använder elastisk transaktioner toocoordinate hello databasändringar i databaser och kontrollera odelbarhet.</span><span class="sxs-lookup"><span data-stu-id="acc4d-118">hello application uses elastic database transactions toocoordinate hello changes across databases and ensure atomicity.</span></span>
* <span data-ttu-id="acc4d-119">Delat databasprogram i Azure: med det här scenariot använder hello datanivå hello [klientbibliotek för elastisk databas](sql-database-elastic-database-client-library.md) eller self delning toohorizontally partition hello data över flera databaser i SQL-databas.</span><span class="sxs-lookup"><span data-stu-id="acc4d-119">Sharded database applications in Azure: With this scenario, hello data tier uses hello [Elastic Database client library](sql-database-elastic-database-client-library.md) or self-sharding toohorizontally partition hello data across many databases in SQL DB.</span></span> <span data-ttu-id="acc4d-120">Framträdande användningsfall är hello måste tooperform ändringar för ett delat program för flera innehavare när ändringar span innehavare.</span><span class="sxs-lookup"><span data-stu-id="acc4d-120">One prominent use case is hello need tooperform atomic changes for a sharded multi-tenant application when changes span tenants.</span></span> <span data-ttu-id="acc4d-121">Se exempelvis en överföring från en klient tooanother, både som finns på olika databaser.</span><span class="sxs-lookup"><span data-stu-id="acc4d-121">Think for instance of a transfer from one tenant tooanother, both residing on different databases.</span></span> <span data-ttu-id="acc4d-122">Andra fall är detaljerade horisontell partitionering tooaccommodate kapacitetsbehov för en stor klient som i sin tur vanligtvis innebär att vissa atomiska åtgärder måste toostretch över flera databaser som används för hello samma klient.</span><span class="sxs-lookup"><span data-stu-id="acc4d-122">A second case is fine-grained sharding tooaccommodate capacity needs for a large tenant which in turn typically implies that some atomic operations needs toostretch across several databases used for hello same tenant.</span></span> <span data-ttu-id="acc4d-123">Ett tredje fall är atomiska uppdateringar tooreference data som replikeras över databaser.</span><span class="sxs-lookup"><span data-stu-id="acc4d-123">A third case is atomic updates tooreference data that are replicated across databases.</span></span> <span data-ttu-id="acc4d-124">Atomic, överförda, operationer längs dessa rader kan nu koordineras över flera databaser med hjälp av hello preview.</span><span class="sxs-lookup"><span data-stu-id="acc4d-124">Atomic, transacted, operations along these lines can now be coordinated across several databases using hello preview.</span></span>
  <span data-ttu-id="acc4d-125">Elastisk databastransaktioner använder två faser tooensure transaktion odelbarhet över databaser.</span><span class="sxs-lookup"><span data-stu-id="acc4d-125">Elastic database transactions use two-phase commit tooensure transaction atomicity across databases.</span></span> <span data-ttu-id="acc4d-126">Det är passar bra för transaktioner som rör färre än 100 databaser samtidigt i en enda transaktion.</span><span class="sxs-lookup"><span data-stu-id="acc4d-126">It is a good fit for transactions that involve less than 100 databases at a time within a single transaction.</span></span> <span data-ttu-id="acc4d-127">Dessa begränsningar tillämpas inte, men en förvänta prestanda och slutförandefrekvenser för elastisk databas transaktioner toosuffer när överskrider gränserna.</span><span class="sxs-lookup"><span data-stu-id="acc4d-127">These limits are not enforced, but one should expect performance and success rates for elastic database transactions toosuffer when exceeding these limits.</span></span>

## <a name="installation-and-migration"></a><span data-ttu-id="acc4d-128">Installation och migrering</span><span class="sxs-lookup"><span data-stu-id="acc4d-128">Installation and migration</span></span>
<span data-ttu-id="acc4d-129">hello funktioner för elastisk databastransaktioner i SQL DB tillhandahålls via uppdateringar toohello .NET-biblioteken System.Data.dll och System.Transactions.dll.</span><span class="sxs-lookup"><span data-stu-id="acc4d-129">hello capabilities for elastic database transactions in SQL DB are provided through updates toohello .NET libraries System.Data.dll and System.Transactions.dll.</span></span> <span data-ttu-id="acc4d-130">hello DLL: er Se till att tvåfasincheckning används vid behov tooensure odelbarhet.</span><span class="sxs-lookup"><span data-stu-id="acc4d-130">hello DLLs ensure that two-phase commit is used where necessary tooensure atomicity.</span></span> <span data-ttu-id="acc4d-131">toostart utveckla program med elastiska databastransaktioner, installera [.NET Framework 4.6.1](https://www.microsoft.com/download/details.aspx?id=49981) eller en senare version.</span><span class="sxs-lookup"><span data-stu-id="acc4d-131">toostart developing applications using elastic database transactions, install [.NET Framework 4.6.1](https://www.microsoft.com/download/details.aspx?id=49981) or a later version.</span></span> <span data-ttu-id="acc4d-132">När du kör på en tidigare version av .NET framework hello transaktioner misslyckas toopromote tooa distribuerade transaktioner och ett undantag aktiveras.</span><span class="sxs-lookup"><span data-stu-id="acc4d-132">When running on an earlier version of hello .NET framework, transactions will fail toopromote tooa distributed transaction and an exception will be raised.</span></span>

<span data-ttu-id="acc4d-133">Efter installationen kan du använda hello distributed transaction API: er i System.Transactions med anslutningar tooSQL DB.</span><span class="sxs-lookup"><span data-stu-id="acc4d-133">After installation, you can use hello distributed transaction APIs in System.Transactions with connections tooSQL DB.</span></span> <span data-ttu-id="acc4d-134">Om du har befintliga MSDTC-program med hjälp av dessa API: er kan bara återskapa dina befintliga program för .NET 4.6 när du har installerat hello 4.6.1 Framework.</span><span class="sxs-lookup"><span data-stu-id="acc4d-134">If you have existing MSDTC applications using these APIs, simply rebuild your existing applications for .NET 4.6 after installing hello 4.6.1 Framework.</span></span> <span data-ttu-id="acc4d-135">Om dina projekt riktar .NET 4.6, används de automatiskt hello uppdateras DLL-filer från hello nya Framework-version och distribuerade transaktioner API-anrop i kombination med anslutningar tooSQL DB ska lyckas.</span><span class="sxs-lookup"><span data-stu-id="acc4d-135">If your projects target .NET 4.6, they will automatically use hello updated DLLs from hello new Framework version and distributed transaction API calls in combination with connections tooSQL DB will now succeed.</span></span>

<span data-ttu-id="acc4d-136">Kom ihåg att elastisk databastransaktioner inte behöver installera MSDTC.</span><span class="sxs-lookup"><span data-stu-id="acc4d-136">Remember that elastic database transactions do not require installing MSDTC.</span></span> <span data-ttu-id="acc4d-137">Elastisk databastransaktioner hanteras i stället direkt efter och inom SQL-databas.</span><span class="sxs-lookup"><span data-stu-id="acc4d-137">Instead, elastic database transactions are directly managed by and within SQL DB.</span></span> <span data-ttu-id="acc4d-138">Detta förenklar avsevärt scenarier för en distribution av MSDTC är inte nödvändigt toouse distribuerade transaktioner med SQL-databas.</span><span class="sxs-lookup"><span data-stu-id="acc4d-138">This significantly simplifies cloud scenarios since a deployment of MSDTC is not necessary toouse distributed transactions with SQL DB.</span></span> <span data-ttu-id="acc4d-139">Avsnitt 4 förklarar vi i detalj hur toodeploy elastisk databastransaktioner och hello krävs .NET framework tillsammans med dina molntjänster program tooAzure.</span><span class="sxs-lookup"><span data-stu-id="acc4d-139">Section 4 explains in more detail how toodeploy elastic database transactions and hello required .NET framework together with your cloud applications tooAzure.</span></span>

## <a name="development-experience"></a><span data-ttu-id="acc4d-140">Utvecklingsarbetet</span><span class="sxs-lookup"><span data-stu-id="acc4d-140">Development experience</span></span>
### <a name="multi-database-applications"></a><span data-ttu-id="acc4d-141">Flera databasprogram</span><span class="sxs-lookup"><span data-stu-id="acc4d-141">Multi-database applications</span></span>
<span data-ttu-id="acc4d-142">hello använder följande exempelkod hello bekant programmering med .NET System.Transactions.</span><span class="sxs-lookup"><span data-stu-id="acc4d-142">hello following sample code uses hello familiar programming experience with .NET System.Transactions.</span></span> <span data-ttu-id="acc4d-143">hello TransactionScope klassen upprättar en omgivande transaktion i .NET.</span><span class="sxs-lookup"><span data-stu-id="acc4d-143">hello TransactionScope class establishes an ambient transaction in .NET.</span></span> <span data-ttu-id="acc4d-144">(En ”omgivande transaktion” är ett som finns i den aktuella tråden för hello.) Alla anslutningar öppnas i hello TransactionScope delta i hello transaktioner.</span><span class="sxs-lookup"><span data-stu-id="acc4d-144">(An “ambient transaction” is one that lives in hello current thread.) All connections opened within hello TransactionScope participate in hello transaction.</span></span> <span data-ttu-id="acc4d-145">Om olika databaser delta är hello transaktionen automatiskt utökade tooa distribuerad transaktion.</span><span class="sxs-lookup"><span data-stu-id="acc4d-145">If different databases participate, hello transaction is automatically elevated tooa distributed transaction.</span></span> <span data-ttu-id="acc4d-146">hello resultatet av hello transaktionen styrs genom att ange hello scope toocomplete tooindicate ett genomförande.</span><span class="sxs-lookup"><span data-stu-id="acc4d-146">hello outcome of hello transaction is controlled by setting hello scope toocomplete tooindicate a commit.</span></span>

    using (var scope = new TransactionScope())
    {
        using (var conn1 = new SqlConnection(connStrDb1))
        {
            conn1.Open();
            SqlCommand cmd1 = conn1.CreateCommand();
            cmd1.CommandText = string.Format("insert into T1 values(1)");
            cmd1.ExecuteNonQuery();
        }

        using (var conn2 = new SqlConnection(connStrDb2))
        {
            conn2.Open();
            var cmd2 = conn2.CreateCommand();
            cmd2.CommandText = string.Format("insert into T2 values(2)");
            cmd2.ExecuteNonQuery();
        }

        scope.Complete();
    }

### <a name="sharded-database-applications"></a><span data-ttu-id="acc4d-147">Delat databasprogram</span><span class="sxs-lookup"><span data-stu-id="acc4d-147">Sharded database applications</span></span>
<span data-ttu-id="acc4d-148">Elastisk databastransaktioner för SQL DB stöder också koordinera distribuerade transaktioner där du använder hello OpenConnectionForKey metod för hello elastisk databas-biblioteket tooopen klientanslutningar för en skaländras ut nivån.</span><span class="sxs-lookup"><span data-stu-id="acc4d-148">Elastic database transactions for SQL DB also support coordinating distributed transactions where you use hello OpenConnectionForKey method of hello elastic database client library tooopen connections for a scaled out data tier.</span></span> <span data-ttu-id="acc4d-149">Överväg att fall där du behöver tooguarantee transaktionskonsekvens för ändringar i flera nyckelvärden för olika horisontell partitionering.</span><span class="sxs-lookup"><span data-stu-id="acc4d-149">Consider cases where you need tooguarantee transactional consistency for changes across several different sharding key values.</span></span> <span data-ttu-id="acc4d-150">Anslutningar toohello shards värd hello nyckelvärden för olika horisontell partitionering är asynkrona med OpenConnectionForKey.</span><span class="sxs-lookup"><span data-stu-id="acc4d-150">Connections toohello shards hosting hello different sharding key values are brokered using OpenConnectionForKey.</span></span> <span data-ttu-id="acc4d-151">I vanliga fall hello vara hello anslutningar toodifferent shards så att säkerställa transaktionella garantier kräver en distribuerad transaktion.</span><span class="sxs-lookup"><span data-stu-id="acc4d-151">In hello general case, hello connections can be toodifferent shards such that ensuring transactional guarantees requires a distributed transaction.</span></span> <span data-ttu-id="acc4d-152">hello följande kodexempel illustrerar den här metoden.</span><span class="sxs-lookup"><span data-stu-id="acc4d-152">hello following code sample illustrates this approach.</span></span> <span data-ttu-id="acc4d-153">Den förutsätter att en variabel med namnet shardmap används toorepresent en Fragmentera mappa från hello klientbibliotek för elastisk databas:</span><span class="sxs-lookup"><span data-stu-id="acc4d-153">It assumes that a variable called shardmap is used toorepresent a shard map from hello elastic database client library:</span></span>

    using (var scope = new TransactionScope())
    {
        using (var conn1 = shardmap.OpenConnectionForKey(tenantId1, credentialsStr))
        {
            conn1.Open();
            SqlCommand cmd1 = conn1.CreateCommand();
            cmd1.CommandText = string.Format("insert into T1 values(1)");
            cmd1.ExecuteNonQuery();
        }

        using (var conn2 = shardmap.OpenConnectionForKey(tenantId2, credentialsStr))
        {
            conn2.Open();
            var cmd2 = conn2.CreateCommand();
            cmd2.CommandText = string.Format("insert into T1 values(2)");
            cmd2.ExecuteNonQuery();
        }

        scope.Complete();
    }


## <a name="net-installation-for-azure-cloud-services"></a><span data-ttu-id="acc4d-154">Installation av .NET för Azure-molntjänster</span><span class="sxs-lookup"><span data-stu-id="acc4d-154">.NET installation for Azure Cloud Services</span></span>
<span data-ttu-id="acc4d-155">Azure tillhandahåller flera erbjudanden toohost .NET-program.</span><span class="sxs-lookup"><span data-stu-id="acc4d-155">Azure provides several offerings toohost .NET applications.</span></span> <span data-ttu-id="acc4d-156">En jämförelse av olika hello-erbjudanden som är tillgängliga i [jämförelse mellan Azure App Service, molntjänster och virtuella datorer](../app-service-web/choose-web-site-cloud-service-vm.md).</span><span class="sxs-lookup"><span data-stu-id="acc4d-156">A comparison of hello different offerings is available in [Azure App Service, Cloud Services, and Virtual Machines comparison](../app-service-web/choose-web-site-cloud-service-vm.md).</span></span> <span data-ttu-id="acc4d-157">Om hello gästoperativsystemet för hello erbjudande är mindre än .NET 4.6.1 som krävs för elastiska transaktioner, måste tooupgrade hello gäst OS too4.6.1.</span><span class="sxs-lookup"><span data-stu-id="acc4d-157">If hello guest OS of hello offering is smaller than .NET 4.6.1 required for elastic transactions, you need tooupgrade hello guest OS too4.6.1.</span></span> 

<span data-ttu-id="acc4d-158">För tjänster i Azure-App, uppgraderar du toohello gäst-OS inte stöds för närvarande.</span><span class="sxs-lookup"><span data-stu-id="acc4d-158">For Azure App Services, upgrades toohello guest OS are currently not supported.</span></span> <span data-ttu-id="acc4d-159">Azure virtuella datorer bara logga in hello VM och kör installationsprogrammet för hello hello senaste .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="acc4d-159">For Azure Virtual Machines, simply log into hello VM and run hello installer for hello latest .NET framework.</span></span> <span data-ttu-id="acc4d-160">För Azure Cloud Services behöver du tooinclude hello installation av en nyare version av .NET i hello Start uppgifter för din distribution.</span><span class="sxs-lookup"><span data-stu-id="acc4d-160">For Azure Cloud Services, you need tooinclude hello installation of a newer .NET version into hello startup tasks of your deployment.</span></span> <span data-ttu-id="acc4d-161">hello koncept och steg finns dokumenterade i [installera .NET på en rolltjänst för molnet](../cloud-services/cloud-services-dotnet-install-dotnet.md).</span><span class="sxs-lookup"><span data-stu-id="acc4d-161">hello concepts and steps are documented in [Install .NET on a Cloud Service Role](../cloud-services/cloud-services-dotnet-install-dotnet.md).</span></span>  

<span data-ttu-id="acc4d-162">Observera att hello installer för .NET 4.6.1 kan kräva mer tillfällig lagring under hello startprogram process på Azure-molntjänster än hello installationsprogram för .NET 4.6.</span><span class="sxs-lookup"><span data-stu-id="acc4d-162">Note that hello installer for .NET 4.6.1 may require more temporary storage during hello bootstrapping process on Azure cloud services than hello installer for .NET 4.6.</span></span> <span data-ttu-id="acc4d-163">tooensure en lyckad installation, du behöver tooincrease tillfällig lagring för din Azure-molntjänst i filen ServiceDefinition.csdef i hello LocalResources avsnitt och hello miljöinställningar av din startaktivitet enligt hello följande Exempel:</span><span class="sxs-lookup"><span data-stu-id="acc4d-163">tooensure a successful installation, you need tooincrease temporary storage for your Azure cloud service in your ServiceDefinition.csdef file in hello LocalResources section and hello environment settings of your startup task, as shown in hello following sample:</span></span>

    <LocalResources>
    ...
        <LocalStorage name="TEMP" sizeInMB="5000" cleanOnRoleRecycle="false" />
        <LocalStorage name="TMP" sizeInMB="5000" cleanOnRoleRecycle="false" />
    </LocalResources>
    <Startup>
        <Task commandLine="install.cmd" executionContext="elevated" taskType="simple">
            <Environment>
        ...
                <Variable name="TEMP">
                    <RoleInstanceValue xpath="/RoleEnvironment/CurrentInstance/LocalResources/LocalResource[@name='TEMP']/@path" />
                </Variable>
                <Variable name="TMP">
                    <RoleInstanceValue xpath="/RoleEnvironment/CurrentInstance/LocalResources/LocalResource[@name='TMP']/@path" />
                </Variable>
            </Environment>
        </Task>
    </Startup>

## <a name="transactions-across-multiple-servers"></a><span data-ttu-id="acc4d-164">Transaktioner över flera servrar</span><span class="sxs-lookup"><span data-stu-id="acc4d-164">Transactions across multiple servers</span></span>
<span data-ttu-id="acc4d-165">Elastisk databastransaktioner stöds mellan olika logiska servrar i Azure SQL Database.</span><span class="sxs-lookup"><span data-stu-id="acc4d-165">Elastic database transactions are supported across different logical servers in Azure SQL Database.</span></span> <span data-ttu-id="acc4d-166">När transaktioner mellan logisk server gränser, måste hello deltagande servrar först toobe som anges i en relation för ömsesidig kommunikation.</span><span class="sxs-lookup"><span data-stu-id="acc4d-166">When transactions cross logical server boundaries, hello participating servers first need toobe entered into a mutual communication relationship.</span></span> <span data-ttu-id="acc4d-167">När hello kommunikation relationen har upprättats hello någon databas i någon av hello två servrar som kan delta i elastisk transaktioner med databaser från andra servrar.</span><span class="sxs-lookup"><span data-stu-id="acc4d-167">Once hello communication relationship has been established, any database in any of hello two servers can participate in elastic transactions with databases from hello other server.</span></span> <span data-ttu-id="acc4d-168">Med transaktioner som sträcker sig över mer än två logiska servrar, behöver en relation för kommunikation toobe på plats för alla typer av logiska servrar.</span><span class="sxs-lookup"><span data-stu-id="acc4d-168">With transactions spanning more than two logical servers, a communication relationship needs toobe in place for any pair of logical servers.</span></span>

<span data-ttu-id="acc4d-169">Använd följande PowerShell-cmdlets toomanage kommunikation mellan servrar relationer för elastiska databastransaktioner hello:</span><span class="sxs-lookup"><span data-stu-id="acc4d-169">Use hello following PowerShell cmdlets toomanage cross-server communication relationships for elastic database transactions:</span></span>

* <span data-ttu-id="acc4d-170">**Nya AzureRmSqlServerCommunicationLink**: Använd den här cmdlet-toocreate en ny relation för kommunikation mellan två logiska servrar i Azure SQL DB.</span><span class="sxs-lookup"><span data-stu-id="acc4d-170">**New-AzureRmSqlServerCommunicationLink**: Use this cmdlet toocreate a new communication relationship between two logical servers in Azure SQL DB.</span></span> <span data-ttu-id="acc4d-171">hello relationen är symmetriska vilket innebär att båda servrarna kan initiera transaktioner med hello annan server.</span><span class="sxs-lookup"><span data-stu-id="acc4d-171">hello relationship is symmetric which means both servers can initiate transactions with hello other server.</span></span>
* <span data-ttu-id="acc4d-172">**Get-AzureRmSqlServerCommunicationLink**: Använd den här cmdlet tooretrieve befintlig kommunikation relationer och deras egenskaper.</span><span class="sxs-lookup"><span data-stu-id="acc4d-172">**Get-AzureRmSqlServerCommunicationLink**: Use this cmdlet tooretrieve existing communication relationships and their properties.</span></span>
* <span data-ttu-id="acc4d-173">**Ta bort AzureRmSqlServerCommunicationLink**: Använd den här cmdlet-tooremove en befintlig relation för kommunikation.</span><span class="sxs-lookup"><span data-stu-id="acc4d-173">**Remove-AzureRmSqlServerCommunicationLink**: Use this cmdlet tooremove an existing communication relationship.</span></span> 

## <a name="monitoring-transaction-status"></a><span data-ttu-id="acc4d-174">Övervaka status för transaktioner</span><span class="sxs-lookup"><span data-stu-id="acc4d-174">Monitoring transaction status</span></span>
<span data-ttu-id="acc4d-175">Använd dynamiska hanteringsvyer (av DMV: er) i SQL DB toomonitor status och förlopp för pågående elastisk databas-transaktioner.</span><span class="sxs-lookup"><span data-stu-id="acc4d-175">Use Dynamic Management Views (DMVs) in SQL DB toomonitor status and progress of your ongoing elastic database transactions.</span></span> <span data-ttu-id="acc4d-176">Alla av DMV: er relaterade tootransactions är relevanta för distribuerade transaktioner i SQL-databas.</span><span class="sxs-lookup"><span data-stu-id="acc4d-176">All DMVs related tootransactions are relevant for distributed transactions in SQL DB.</span></span> <span data-ttu-id="acc4d-177">Du kan hitta hello motsvarande lista över av DMV: er här: [transaktion relaterade dynamiska hanteringsvyer och funktioner (Transact-SQL)](https://msdn.microsoft.com/library/ms178621.aspx).</span><span class="sxs-lookup"><span data-stu-id="acc4d-177">You can find hello corresponding list of DMVs here: [Transaction Related Dynamic Management Views and Functions (Transact-SQL)](https://msdn.microsoft.com/library/ms178621.aspx).</span></span>

<span data-ttu-id="acc4d-178">Dessa av DMV: er är särskilt användbar:</span><span class="sxs-lookup"><span data-stu-id="acc4d-178">These DMVs are particularly useful:</span></span>

* <span data-ttu-id="acc4d-179">**sys.DM\_tran\_active\_transaktioner**: Visar aktiva transaktioner just nu och deras status.</span><span class="sxs-lookup"><span data-stu-id="acc4d-179">**sys.dm\_tran\_active\_transactions**: Lists currently active transactions and their status.</span></span> <span data-ttu-id="acc4d-180">hello UOW (arbetsenheten)-kolumn kan identifiera hello olika underordnade transaktioner som tillhör toohello samma distribuerade transaktionen.</span><span class="sxs-lookup"><span data-stu-id="acc4d-180">hello UOW (Unit Of Work) column can identify hello different child transactions that belong toohello same distributed transaction.</span></span> <span data-ttu-id="acc4d-181">Alla transaktioner inom samma distribuerade transaktioner utföra hello hello samma UOW värde.</span><span class="sxs-lookup"><span data-stu-id="acc4d-181">All transactions within hello same distributed transaction carry hello same UOW value.</span></span> <span data-ttu-id="acc4d-182">Se hello [DMV dokumentationen](https://msdn.microsoft.com/library/ms174302.aspx) för mer information.</span><span class="sxs-lookup"><span data-stu-id="acc4d-182">See hello [DMV documentation](https://msdn.microsoft.com/library/ms174302.aspx) for more details.</span></span>
* <span data-ttu-id="acc4d-183">**sys.DM\_tran\_databasen\_transaktioner**: tillhandahåller ytterligare information om transaktioner, till exempel placeringen av hello transaktion i hello-loggen.</span><span class="sxs-lookup"><span data-stu-id="acc4d-183">**sys.dm\_tran\_database\_transactions**: Provides additional information about transactions, such as placement of hello transaction in hello log.</span></span> <span data-ttu-id="acc4d-184">Se hello [DMV dokumentationen](https://msdn.microsoft.com/library/ms186957.aspx) för mer information.</span><span class="sxs-lookup"><span data-stu-id="acc4d-184">See hello [DMV documentation](https://msdn.microsoft.com/library/ms186957.aspx) for more details.</span></span>
* <span data-ttu-id="acc4d-185">**sys.DM\_tran\_Lås**: innehåller information om hello lås som för tillfället hålls av en pågående transaktioner.</span><span class="sxs-lookup"><span data-stu-id="acc4d-185">**sys.dm\_tran\_locks**: Provides information about hello locks that are currently held by ongoing transactions.</span></span> <span data-ttu-id="acc4d-186">Se hello [DMV dokumentationen](https://msdn.microsoft.com/library/ms190345.aspx) för mer information.</span><span class="sxs-lookup"><span data-stu-id="acc4d-186">See hello [DMV documentation](https://msdn.microsoft.com/library/ms190345.aspx) for more details.</span></span>

## <a name="limitations"></a><span data-ttu-id="acc4d-187">Begränsningar</span><span class="sxs-lookup"><span data-stu-id="acc4d-187">Limitations</span></span>
<span data-ttu-id="acc4d-188">hello som för närvarande följande begränsningar gäller tooelastic databastransaktioner i SQL-databas:</span><span class="sxs-lookup"><span data-stu-id="acc4d-188">hello following limitations currently apply tooelastic database transactions in SQL DB:</span></span>

* <span data-ttu-id="acc4d-189">Endast transaktioner mellan databaser i SQL-databas stöds.</span><span class="sxs-lookup"><span data-stu-id="acc4d-189">Only transactions across databases in SQL DB are supported.</span></span> <span data-ttu-id="acc4d-190">Andra [X / Open XA](https://en.wikipedia.org/wiki/X/Open_XA) resursproviders och databaser utanför SQL-databas kan inte ingå i elastisk databastransaktioner.</span><span class="sxs-lookup"><span data-stu-id="acc4d-190">Other [X/Open XA](https://en.wikipedia.org/wiki/X/Open_XA) resource providers and databases outside of SQL DB cannot participate in elastic database transactions.</span></span> <span data-ttu-id="acc4d-191">Det innebär att elastisk databastransaktioner inte sträcka ut över lokala SQL Server och Azure SQL-databaser.</span><span class="sxs-lookup"><span data-stu-id="acc4d-191">That means that elastic database transactions cannot stretch across on premises SQL Server and Azure SQL Databases.</span></span> <span data-ttu-id="acc4d-192">Fortsätt toouse MSDTC för distribuerade transaktioner lokalt.</span><span class="sxs-lookup"><span data-stu-id="acc4d-192">For distributed transactions on premises, continue toouse MSDTC.</span></span> 
* <span data-ttu-id="acc4d-193">Endast klienten koordineras transaktioner från ett .NET-program stöds.</span><span class="sxs-lookup"><span data-stu-id="acc4d-193">Only client-coordinated transactions from a .NET application are supported.</span></span> <span data-ttu-id="acc4d-194">Serversidan stöd för T-SQL, till exempel BÖRJA DISTRIBUTED TRANSACTION är planerade men ännu inte tillgänglig.</span><span class="sxs-lookup"><span data-stu-id="acc4d-194">Server-side support for T-SQL such as BEGIN DISTRIBUTED TRANSACTION is planned, but not yet available.</span></span> 
* <span data-ttu-id="acc4d-195">Transaktioner över WCF-tjänster stöds inte.</span><span class="sxs-lookup"><span data-stu-id="acc4d-195">Transactions across WCF services are not supported.</span></span> <span data-ttu-id="acc4d-196">Du har till exempel metod en WCF-tjänst som utför en transaktion.</span><span class="sxs-lookup"><span data-stu-id="acc4d-196">For example, you have a WCF service method that executes a transaction.</span></span> <span data-ttu-id="acc4d-197">Omslutande hello anrop inom ett transaktionsomfång misslyckas som en [System.ServiceModel.ProtocolException](https://msdn.microsoft.com/library/system.servicemodel.protocolexception).</span><span class="sxs-lookup"><span data-stu-id="acc4d-197">Enclosing hello call within a transaction scope will fail as a [System.ServiceModel.ProtocolException](https://msdn.microsoft.com/library/system.servicemodel.protocolexception).</span></span>

## <a name="next-steps"></a><span data-ttu-id="acc4d-198">Nästa steg</span><span class="sxs-lookup"><span data-stu-id="acc4d-198">Next steps</span></span>
<span data-ttu-id="acc4d-199">För frågor kan du nå toous på hello [SQL Database-forum](http://social.msdn.microsoft.com/forums/azure/home?forum=ssdsgetstarted) och för funktionsbegäranden, Lägg till dem toohello [SQL-databas Feedbackforum](https://feedback.azure.com/forums/217321-sql-database/).</span><span class="sxs-lookup"><span data-stu-id="acc4d-199">For questions, please reach out toous on hello [SQL Database forum](http://social.msdn.microsoft.com/forums/azure/home?forum=ssdsgetstarted) and for feature requests, please add them toohello [SQL Database feedback forum](https://feedback.azure.com/forums/217321-sql-database/).</span></span>

<!--Image references-->
[1]: ./media/sql-database-elastic-transactions-overview/distributed-transactions.png



