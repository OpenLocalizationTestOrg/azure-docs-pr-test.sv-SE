---
title: "aaaMonitor prestanda i många Azure SQL-databaser i en app för flera innehavare SaaS | Microsoft Docs"
description: "Övervaka och hantera prestanda för databaser och pooler i hello Azure SQL Database Wingtip SaaS-app"
keywords: sql database tutorial
services: sql-database
documentationcenter: 
author: stevestein
manager: craigg
editor: 
ms.assetid: 
ms.service: sql-database
ms.custom: scale out apps
ms.workload: data-management
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/26/2017
ms.author: sstein
ms.openlocfilehash: f0d7ba456c485b7de249a56abac3cf4be3857285
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 10/06/2017
---
# <a name="monitor-performance-of-hello-wingtip-saas-application"></a><span data-ttu-id="29d18-104">Övervaka prestanda för hello Wingtip SaaS-program</span><span class="sxs-lookup"><span data-stu-id="29d18-104">Monitor performance of hello Wingtip SaaS application</span></span>

<span data-ttu-id="29d18-105">I den här självstudiekursen beskrivs flera KPI hanteringsscenarier som används i SaaS-program.</span><span class="sxs-lookup"><span data-stu-id="29d18-105">In this tutorial, several key performance management scenarios used in SaaS applications are explored.</span></span> <span data-ttu-id="29d18-106">Med hjälp av en load generator toosimulate aktivitet mellan alla klient-databaser är hello inbyggd övervakning och aviseringar funktioner i SQL-databasen och elastiska pooler visas.</span><span class="sxs-lookup"><span data-stu-id="29d18-106">Using a load generator toosimulate activity across all tenant databases, hello built-in monitoring and alerting features of SQL Database and elastic pools are demonstrated.</span></span>

<span data-ttu-id="29d18-107">hello Wingtip SaaS appen använder en enskild klient datamodellen, där varje plats (klient) har sina egna databasen.</span><span class="sxs-lookup"><span data-stu-id="29d18-107">hello Wingtip SaaS app uses a single-tenant data model, where each venue (tenant) has their own database.</span></span> <span data-ttu-id="29d18-108">Liksom många SaaS-program förväntad hello klient arbetsbelastning mönstret är oförutsägbart och sporadiska.</span><span class="sxs-lookup"><span data-stu-id="29d18-108">Like many SaaS applications, hello anticipated tenant workload pattern is unpredictable and sporadic.</span></span> <span data-ttu-id="29d18-109">Biljettförsäljningar kan med andra ord ske när som helst.</span><span class="sxs-lookup"><span data-stu-id="29d18-109">In other words, ticket sales may occur at any time.</span></span> <span data-ttu-id="29d18-110">tootake nytta av den här databasen användningsmönstret klient databaser har distribuerats till elastiska databaspooler.</span><span class="sxs-lookup"><span data-stu-id="29d18-110">tootake advantage of this typical database usage pattern, tenant databases are deployed into elastic database pools.</span></span> <span data-ttu-id="29d18-111">Elastiska pooler optimera hello kostnaden för en lösning genom att dela resurser över flera databaser.</span><span class="sxs-lookup"><span data-stu-id="29d18-111">Elastic pools optimize hello cost of a solution by sharing resources across many databases.</span></span> <span data-ttu-id="29d18-112">Med den här typen av mönstret är det viktigt toomonitor databasen och pool resurs användning tooensure som läser in balanseras rimligen över pooler.</span><span class="sxs-lookup"><span data-stu-id="29d18-112">With this type of pattern, it's important toomonitor database and pool resource usage tooensure that loads are reasonably balanced across pools.</span></span> <span data-ttu-id="29d18-113">Du måste också tooensure att enskilda databaser har tillräckliga resurser och att pooler inte träffa sina [eDTU](sql-database-what-is-a-dtu.md) gränser.</span><span class="sxs-lookup"><span data-stu-id="29d18-113">You also need tooensure that individual databases have adequate resources, and that pools are not hitting their [eDTU](sql-database-what-is-a-dtu.md) limits.</span></span> <span data-ttu-id="29d18-114">Den här självstudiekursen utforskar sätt toomonitor och hantera databaser och pooler, och hur tootake korrigerande åtgärder i svaret toovariations i arbetsbelastning.</span><span class="sxs-lookup"><span data-stu-id="29d18-114">This tutorial explores ways toomonitor and manage databases and pools, and how tootake corrective action in response toovariations in workload.</span></span>

<span data-ttu-id="29d18-115">I den här självstudiekursen får du lära du dig att:</span><span class="sxs-lookup"><span data-stu-id="29d18-115">In this tutorial you learn how to:</span></span>

> [!div class="checklist"]

> * <span data-ttu-id="29d18-116">Simulera användning på hello klient databaser genom att köra ett angivet belastningen generator</span><span class="sxs-lookup"><span data-stu-id="29d18-116">Simulate usage on hello tenant databases by running a provided load generator</span></span>
> * <span data-ttu-id="29d18-117">Övervakaren hello klient databaser som de svara toohello ökad belastning</span><span class="sxs-lookup"><span data-stu-id="29d18-117">Monitor hello tenant databases as they respond toohello increase in load</span></span>
> * <span data-ttu-id="29d18-118">Skala upp hello elastiska poolen i svaret toohello ökad databasen belastning</span><span class="sxs-lookup"><span data-stu-id="29d18-118">Scale up hello Elastic pool in response toohello increased database load</span></span>
> * <span data-ttu-id="29d18-119">Etablera en andra Databasaktivitet elastisk pool tooload saldo</span><span class="sxs-lookup"><span data-stu-id="29d18-119">Provision a second Elastic pool tooload balance database activity</span></span>


<span data-ttu-id="29d18-120">den här självstudiekursen, se till att hello följande krav är slutförda toocomplete:</span><span class="sxs-lookup"><span data-stu-id="29d18-120">toocomplete this tutorial, make sure hello following prerequisites are completed:</span></span>

* <span data-ttu-id="29d18-121">hello Wingtip SaaS appen har distribuerats.</span><span class="sxs-lookup"><span data-stu-id="29d18-121">hello Wingtip SaaS app is deployed.</span></span> <span data-ttu-id="29d18-122">toodeploy på mindre än fem minuter finns [distribuera och utforska hello Wingtip SaaS-program](sql-database-saas-tutorial.md)</span><span class="sxs-lookup"><span data-stu-id="29d18-122">toodeploy in less than five minutes, see [Deploy and explore hello Wingtip SaaS application](sql-database-saas-tutorial.md)</span></span>
* <span data-ttu-id="29d18-123">Azure PowerShell ska ha installerats.</span><span class="sxs-lookup"><span data-stu-id="29d18-123">Azure PowerShell is installed.</span></span> <span data-ttu-id="29d18-124">Mer information finns i [Komma igång med Azure PowerShell](https://docs.microsoft.com/powershell/azure/get-started-azureps)</span><span class="sxs-lookup"><span data-stu-id="29d18-124">For details, see [Getting started with Azure PowerShell](https://docs.microsoft.com/powershell/azure/get-started-azureps)</span></span>

## <a name="introduction-toosaas-performance-management-patterns"></a><span data-ttu-id="29d18-125">Introduktion tooSaaS prestanda management mönster</span><span class="sxs-lookup"><span data-stu-id="29d18-125">Introduction tooSaaS performance management patterns</span></span>

<span data-ttu-id="29d18-126">Hantera databasprestanda består av sammanställa och analysera prestandadata och sedan reagerar toothis data genom att justera parametrarna toomaintain acceptabel svarstid för ditt program.</span><span class="sxs-lookup"><span data-stu-id="29d18-126">Managing database performance consists of compiling and analyzing performance data, and then reacting toothis data by adjusting parameters toomaintain an acceptable response time for your application.</span></span> <span data-ttu-id="29d18-127">När värd för flera innehavare, elastiska databaspooler är ett kostnadseffektivt sätt tooprovide och hantera resurser för en grupp databaser med oförutsägbart arbetsbelastningar.</span><span class="sxs-lookup"><span data-stu-id="29d18-127">When hosting multiple tenants, Elastic database pools are a cost-effective way tooprovide and manage resources for a group of databases with unpredictable workloads.</span></span> <span data-ttu-id="29d18-128">Med vissa arbetsbelastningmönster, kan så få som två S3-databaser dra nytta av att hanteras i en pool.</span><span class="sxs-lookup"><span data-stu-id="29d18-128">With certain workload patterns, as few as two S3 databases can benefit from being managed in a pool.</span></span>

![media](./media/sql-database-saas-tutorial-performance-monitoring/app-diagram.png)

<span data-ttu-id="29d18-130">Pooler och hello databaser i poolen, bör vara övervakade tooensure de förblir inom acceptabel prestanda.</span><span class="sxs-lookup"><span data-stu-id="29d18-130">Pools, and hello databases in pools, should be monitored tooensure they stay within acceptable ranges of performance.</span></span> <span data-ttu-id="29d18-131">Finjustera hello poolen configuration toomeet hello behov hello sammanställd arbetsbelastningen för alla databaser att säkerställa att hello pool-edtu: er är lämplig för hello övergripande arbetsbelastning.</span><span class="sxs-lookup"><span data-stu-id="29d18-131">Tune hello pool configuration toomeet hello needs of hello aggregate workload of all databases, ensuring that hello pool eDTUs are appropriate for hello overall workload.</span></span> <span data-ttu-id="29d18-132">Justera hello per databas min och per databas max eDTU värden tooappropriate värden för din specifika programkrav.</span><span class="sxs-lookup"><span data-stu-id="29d18-132">Adjust hello per-database min and per-database max eDTU values tooappropriate values for your specific application requirements.</span></span>

### <a name="performance-management-strategies"></a><span data-ttu-id="29d18-133">Strategier för prestandahantering</span><span class="sxs-lookup"><span data-stu-id="29d18-133">Performance management strategies</span></span>

* <span data-ttu-id="29d18-134">tooavoid med toomanually övervaka prestanda, det är bäst för**ställa in aviseringar som utlöses när databaser eller pooler avvika utanför normal adressintervall**.</span><span class="sxs-lookup"><span data-stu-id="29d18-134">tooavoid having toomanually monitor performance, it’s most effective too**set alerts that trigger when databases or pools stray out of normal ranges**.</span></span>
* <span data-ttu-id="29d18-135">toorespond tooshort termen variationer i hello sammanställd prestandanivå en adresspool hello **pool-eDTU nivå kan skalas upp eller ned**.</span><span class="sxs-lookup"><span data-stu-id="29d18-135">toorespond tooshort-term fluctuations in hello aggregate performance level of a pool, hello **pool eDTU level can be scaled up or down**.</span></span> <span data-ttu-id="29d18-136">Om den här variationerna inträffar på grundval regelbundna eller förutsägbar **skalning hello pool kan vara schemalagda toooccur automatiskt**.</span><span class="sxs-lookup"><span data-stu-id="29d18-136">If this fluctuation occurs on a regular or predictable basis, **scaling hello pool can be scheduled toooccur automatically**.</span></span> <span data-ttu-id="29d18-137">Du kan exempelvis skala ned när du vet att din arbetsbelastning är lätt, på nätter eller helger till exempel.</span><span class="sxs-lookup"><span data-stu-id="29d18-137">For example, scale down when you know your workload is light, maybe overnight, or during weekends.</span></span>
* <span data-ttu-id="29d18-138">toorespond toolonger termen variationer eller ändringar i hello antalet databaser, **enskilda databaser kan flyttas till andra pooler**.</span><span class="sxs-lookup"><span data-stu-id="29d18-138">toorespond toolonger-term fluctuations, or changes in hello number of databases, **individual databases can be moved into other pools**.</span></span>
* <span data-ttu-id="29d18-139">toorespond tooshort termen ökar i *enskilda* databasbelastningen **enskilda databaser kan tas bort från en pool och tilldelats en enskilda prestandanivå**.</span><span class="sxs-lookup"><span data-stu-id="29d18-139">toorespond tooshort term increases in *individual* database load **individual databases can be taken out of a pool and assigned an individual performance level**.</span></span> <span data-ttu-id="29d18-140">När hello belastningen minskar, kan hello databasen sedan returneras toohello pool.</span><span class="sxs-lookup"><span data-stu-id="29d18-140">Once hello load is reduced, hello database can then be returned toohello pool.</span></span> <span data-ttu-id="29d18-141">När det är känt i förväg, kan databaser flyttas pre-emptively tooensure hello databasen har alltid hello resurser som behövs och tooavoid inverkan på andra databaser i poolen hello.</span><span class="sxs-lookup"><span data-stu-id="29d18-141">When this is known in advance, databases can be moved pre-emptively tooensure hello database always has hello resources it needs, and tooavoid impact on other databases in hello pool.</span></span> <span data-ttu-id="29d18-142">Om det här kravet är förutsägbar, till exempel en plats som har en går lite för snabbt för Biljettförsäljning för en populär händelse, kan problemet management integreras i hello program.</span><span class="sxs-lookup"><span data-stu-id="29d18-142">If this requirement is predictable, such as a venue experiencing a rush of ticket sales for a popular event, then this management behavior can be integrated into hello application.</span></span>

<span data-ttu-id="29d18-143">Hej [Azure-portalen](https://portal.azure.com) innehåller inbyggd övervakning och avisering för de flesta resurser.</span><span class="sxs-lookup"><span data-stu-id="29d18-143">hello [Azure portal](https://portal.azure.com) provides built-in monitoring and alerting on most resources.</span></span> <span data-ttu-id="29d18-144">För SQL Database, finns övervakning och avisering tillgängligt för databaser och pooler.</span><span class="sxs-lookup"><span data-stu-id="29d18-144">For SQL Database, monitoring and alerting is available on databases and pools.</span></span> <span data-ttu-id="29d18-145">Den här inbyggda övervakning och avisering är resursspecifika, så det är praktiskt toouse för litet antal resurser, men är inte är användbart när du arbetar med många resurser.</span><span class="sxs-lookup"><span data-stu-id="29d18-145">This built-in monitoring and alerting is resource-specific, so it's convenient toouse for small numbers of resources, but is not very convenient when working with many resources.</span></span>

<span data-ttu-id="29d18-146">För omfattande scenarier där du arbetar med många reources [logganalys (OMS)](sql-database-saas-tutorial-log-analytics.md) kan användas.</span><span class="sxs-lookup"><span data-stu-id="29d18-146">For high-volume scenarios where you're working with many reources, [Log Analytics (OMS)](sql-database-saas-tutorial-log-analytics.md) can be used.</span></span> <span data-ttu-id="29d18-147">Detta är en separat Azure-tjänst som ger analytics över skickade diagnostikloggar och telemetri som samlats in i en log analytics-arbetsyta.</span><span class="sxs-lookup"><span data-stu-id="29d18-147">This is a separate Azure service that provides analytics over emitted diagnostic logs and telemetry gathered in a log analytics workspace.</span></span> <span data-ttu-id="29d18-148">Logganalys kan samla in telemetri från många tjänster och använda tooquery och Ställ in aviseringar.</span><span class="sxs-lookup"><span data-stu-id="29d18-148">Log Analytics can collect telemetry from many services and be used tooquery and set alerts.</span></span>

## <a name="get-hello-wingtip-application-source-code-and-scripts"></a><span data-ttu-id="29d18-149">Hämta hello Wingtip programmets källkod och skript</span><span class="sxs-lookup"><span data-stu-id="29d18-149">Get hello Wingtip application source code and scripts</span></span>

<span data-ttu-id="29d18-150">hello Wingtip SaaS-skript och programmets källkod är tillgängliga i hello [WingtipSaaS](https://github.com/Microsoft/WingtipSaaS) github-lagringsplatsen.</span><span class="sxs-lookup"><span data-stu-id="29d18-150">hello Wingtip SaaS scripts and application source code are available in hello [WingtipSaaS](https://github.com/Microsoft/WingtipSaaS) github repo.</span></span> <span data-ttu-id="29d18-151">[Steg toodownload hello Wingtip SaaS skript](sql-database-wtp-overview.md#download-and-unblock-the-wingtip-saas-scripts).</span><span class="sxs-lookup"><span data-stu-id="29d18-151">[Steps toodownload hello Wingtip SaaS scripts](sql-database-wtp-overview.md#download-and-unblock-the-wingtip-saas-scripts).</span></span>

## <a name="provision-additional-tenants"></a><span data-ttu-id="29d18-152">Etablera ytterligare klienter</span><span class="sxs-lookup"><span data-stu-id="29d18-152">Provision additional tenants</span></span>

<span data-ttu-id="29d18-153">Pooler kan vara kostnadseffektiva med två S3 databaser, hello flera databaser som är i hello poolen hello mer kostnadseffektivt hello medelvärdet effekten blir.</span><span class="sxs-lookup"><span data-stu-id="29d18-153">While pools can be cost-effective with just two S3 databases, hello more databases that are in hello pool hello more cost-effective hello averaging effect becomes.</span></span> <span data-ttu-id="29d18-154">För att få en bra förståelse för hur prestandaövervakning och hantering fungerar i stor skala, kräver den här kursen du har distribuerat minst 20 databaser.</span><span class="sxs-lookup"><span data-stu-id="29d18-154">For a good understanding of how performance monitoring and management works at scale, this tutorial requires you have at least 20 databases deployed.</span></span>

<span data-ttu-id="29d18-155">Om du redan har etablerats en grupp med klienter i en tidigare självstudierna kan du hoppa över toohello [simulera användning för alla databaser som klient](#simulate-usage-on-all-tenant-databases) avsnitt.</span><span class="sxs-lookup"><span data-stu-id="29d18-155">If you already provisioned a batch of tenants in a prior tutorial, skip toohello [Simulate usage on all tenant databases](#simulate-usage-on-all-tenant-databases) section.</span></span>

1. <span data-ttu-id="29d18-156">Öppna... \\Learning moduler\\prestandaövervakning och hantering av\\*Demo-PerformanceMonitoringAndManagement.ps1* i hello *PowerShell ISE*.</span><span class="sxs-lookup"><span data-stu-id="29d18-156">Open …\\Learning Modules\\Performance Monitoring and Management\\*Demo-PerformanceMonitoringAndManagement.ps1* in hello *PowerShell ISE*.</span></span> <span data-ttu-id="29d18-157">Ha det här skriptet öppet medan du kör scenarierna i den här guiden.</span><span class="sxs-lookup"><span data-stu-id="29d18-157">Keep this script open as you'll run several scenarios during this tutorial.</span></span>
1. <span data-ttu-id="29d18-158">Ställ in **$DemoScenario** = **1**, **etablera en batch med klienter**</span><span class="sxs-lookup"><span data-stu-id="29d18-158">Set **$DemoScenario** = **1**, **Provision a batch of tenants**</span></span>
1. <span data-ttu-id="29d18-159">Tryck på **F5** toorun hello skript.</span><span class="sxs-lookup"><span data-stu-id="29d18-159">Press **F5** toorun hello script.</span></span>

<span data-ttu-id="29d18-160">hello skript distribuerar 17 klienter på mindre än fem minuter.</span><span class="sxs-lookup"><span data-stu-id="29d18-160">hello script will deploy 17 tenants in less than five minutes.</span></span>

<span data-ttu-id="29d18-161">Hej *ny TenantBatch* skript som använder en kapslad eller länkade uppsättning [Resource Manager](../azure-resource-manager/index.md) mallar som skapar en grupp med klienter, vilket som standard kopierar hello databasen **basetenantdb** på hello katalog server toocreate hello ny klient databaser, registrerar sedan dessa i hello katalog och slutligen initierar dem med hello klient namn och plats.</span><span class="sxs-lookup"><span data-stu-id="29d18-161">hello *New-TenantBatch* script uses a nested or linked set of [Resource Manager](../azure-resource-manager/index.md) templates that create a batch of tenants, which by default copies hello database **basetenantdb** on hello catalog server toocreate hello new tenant databases, then registers these in hello catalog, and finally initializes them with hello tenant name and venue type.</span></span> <span data-ttu-id="29d18-162">Detta är förenligt med hello sätt hello app etablerar en ny klient.</span><span class="sxs-lookup"><span data-stu-id="29d18-162">This is consistent with hello way hello app provisions a new tenant.</span></span> <span data-ttu-id="29d18-163">Ändringar som görs för*basetenantdb* är tillämpade tooany nya klienter som etablerats därefter.</span><span class="sxs-lookup"><span data-stu-id="29d18-163">Any changes made too*basetenantdb* are applied tooany new tenants provisioned thereafter.</span></span> <span data-ttu-id="29d18-164">Se hello [schemat Management kursen](sql-database-saas-tutorial-schema-management.md) toosee hur toomake schemat ändras för*befintliga* klient databaser (inklusive hello *basetenantdb* databas).</span><span class="sxs-lookup"><span data-stu-id="29d18-164">See hello [Schema Management tutorial](sql-database-saas-tutorial-schema-management.md) toosee how toomake schema changes too*existing* tenant databases (including hello *basetenantdb* database).</span></span>

## <a name="simulate-usage-on-all-tenant-databases"></a><span data-ttu-id="29d18-165">Simulera användning på alla klientdatabaser</span><span class="sxs-lookup"><span data-stu-id="29d18-165">Simulate usage on all tenant databases</span></span>

<span data-ttu-id="29d18-166">Hej *Demo-PerformanceMonitoringAndManagement.ps1* skript har angetts som simulerar en arbetsbelastning som körs mot alla klient-databaser.</span><span class="sxs-lookup"><span data-stu-id="29d18-166">hello *Demo-PerformanceMonitoringAndManagement.ps1* script is provided that simulates a workload running against all tenant databases.</span></span> <span data-ttu-id="29d18-167">hello belastningen skapas med någon av hello tillgängliga belastningen scenarier:</span><span class="sxs-lookup"><span data-stu-id="29d18-167">hello load is generated using one of hello available load scenarios:</span></span>

| <span data-ttu-id="29d18-168">Demo</span><span class="sxs-lookup"><span data-stu-id="29d18-168">Demo</span></span> | <span data-ttu-id="29d18-169">Scenario</span><span class="sxs-lookup"><span data-stu-id="29d18-169">Scenario</span></span> |
|:--|:--|
| <span data-ttu-id="29d18-170">2</span><span class="sxs-lookup"><span data-stu-id="29d18-170">2</span></span> | <span data-ttu-id="29d18-171">Generera belastning av normal intensitet (ca 40 DTU)</span><span class="sxs-lookup"><span data-stu-id="29d18-171">Generate normal intensity load (approx. 40 DTU)</span></span> |
| <span data-ttu-id="29d18-172">3</span><span class="sxs-lookup"><span data-stu-id="29d18-172">3</span></span> | <span data-ttu-id="29d18-173">Generera belastning med längre och mer frekventa toppar per databas</span><span class="sxs-lookup"><span data-stu-id="29d18-173">Generate load with longer and more frequent bursts per database</span></span>|
| <span data-ttu-id="29d18-174">4</span><span class="sxs-lookup"><span data-stu-id="29d18-174">4</span></span> | <span data-ttu-id="29d18-175">Generera belastningar med högre DTU-toppar per databas (cirka 80 DTU)</span><span class="sxs-lookup"><span data-stu-id="29d18-175">Generate load with higher DTU bursts per database (approx. 80 DTU)</span></span>|
| <span data-ttu-id="29d18-176">5</span><span class="sxs-lookup"><span data-stu-id="29d18-176">5</span></span> | <span data-ttu-id="29d18-177">Generera en normal belastning plus en hög belastning på en enskild klient (cirka 95 DTU)</span><span class="sxs-lookup"><span data-stu-id="29d18-177">Generate a normal load plus a high load on a single tenant (approx. 95 DTU)</span></span>|
| <span data-ttu-id="29d18-178">6</span><span class="sxs-lookup"><span data-stu-id="29d18-178">6</span></span> | <span data-ttu-id="29d18-179">Generera obalanserad belastning över flera pooler</span><span class="sxs-lookup"><span data-stu-id="29d18-179">Generate unbalanced load across multiple pools</span></span>|

<span data-ttu-id="29d18-180">hello belastningen generator gäller en *syntetiska* endast CPU-belastningen tooevery klient-databasen.</span><span class="sxs-lookup"><span data-stu-id="29d18-180">hello load generator applies a *synthetic* CPU-only load tooevery tenant database.</span></span> <span data-ttu-id="29d18-181">hello generator startar ett jobb för varje klient-databasen, som anropar en lagrad procedur med jämna mellanrum som genererar hello belastningen.</span><span class="sxs-lookup"><span data-stu-id="29d18-181">hello generator starts a job for each tenant database, which calls a stored procedure periodically that generates hello load.</span></span> <span data-ttu-id="29d18-182">hello belastningsnivåer (i edtu: er), varaktighet och intervall varieras över alla databaser som simulerar oförutsägbart klient aktivitet.</span><span class="sxs-lookup"><span data-stu-id="29d18-182">hello load levels (in eDTUs), duration, and intervals are varied across all databases, simulating unpredictable tenant activity.</span></span>

1. <span data-ttu-id="29d18-183">Öppna... \\Learning moduler\\prestandaövervakning och hantering av\\*Demo-PerformanceMonitoringAndManagement.ps1* i hello *PowerShell ISE*.</span><span class="sxs-lookup"><span data-stu-id="29d18-183">Open …\\Learning Modules\\Performance Monitoring and Management\\*Demo-PerformanceMonitoringAndManagement.ps1* in hello *PowerShell ISE*.</span></span> <span data-ttu-id="29d18-184">Ha det här skriptet öppet medan du kör scenarierna i den här guiden.</span><span class="sxs-lookup"><span data-stu-id="29d18-184">Keep this script open as you'll run several scenarios during this tutorial.</span></span>
1. <span data-ttu-id="29d18-185">Ange **$DemoScenario** = **2**, *generera normal styrka belastningen*.</span><span class="sxs-lookup"><span data-stu-id="29d18-185">Set **$DemoScenario** = **2**, *Generate normal intensity load*.</span></span>
1. <span data-ttu-id="29d18-186">Tryck på **F5** tooapply en belastningen tooall klient-databaser.</span><span class="sxs-lookup"><span data-stu-id="29d18-186">Press **F5** tooapply a load tooall your tenant databases.</span></span>

<span data-ttu-id="29d18-187">Wingtip är en SaaS-app och hello verkliga belastningen på en SaaS-app är vanligtvis sporadiska och oförutsägbart.</span><span class="sxs-lookup"><span data-stu-id="29d18-187">Wingtip is a SaaS app, and hello real-world load on a SaaS app is typically sporadic and unpredictable.</span></span> <span data-ttu-id="29d18-188">toosimulate detta hello belastningen generator ger en slumpmässig belastning fördelad över alla klienter.</span><span class="sxs-lookup"><span data-stu-id="29d18-188">toosimulate this, hello load generator produces a randomized load distributed across all tenants.</span></span> <span data-ttu-id="29d18-189">Flera minuter krävs för hello belastningen mönster tooemerge, så kör hello belastningen generatorn för 3-5 minuter innan du försöker toomonitor hello belastningen i hello följande avsnitt.</span><span class="sxs-lookup"><span data-stu-id="29d18-189">Several minutes are needed for hello load pattern tooemerge, so run hello load generator for 3-5 minutes before attempting toomonitor hello load in hello following sections.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="29d18-190">hello belastningen generator körs som en serie av jobb i din lokala PowerShell-session.</span><span class="sxs-lookup"><span data-stu-id="29d18-190">hello load generator is running as a series of jobs in your local PowerShell session.</span></span> <span data-ttu-id="29d18-191">Behåll hello *Demo-PerformanceMonitoringAndManagement.ps1* flik!</span><span class="sxs-lookup"><span data-stu-id="29d18-191">Keep hello *Demo-PerformanceMonitoringAndManagement.ps1* tab open!</span></span> <span data-ttu-id="29d18-192">Om du stänger hello fliken eller pausa din dator, stoppar hello belastningen generator.</span><span class="sxs-lookup"><span data-stu-id="29d18-192">If you close hello tab, or suspend your machine, hello load generator stops.</span></span> <span data-ttu-id="29d18-193">hello belastningen generator finns kvar i en *jobbet anropar* tillstånd där den genererar belastningen på alla nya klienter som tillhandahålls när hello generator har startats.</span><span class="sxs-lookup"><span data-stu-id="29d18-193">hello load generator remains in a *job-invoking* state where it generates load on any new tenants that are provisioned after hello generator is started.</span></span> <span data-ttu-id="29d18-194">Använd *Ctrl-C* toostop anropar nya jobb och avsluta hello skript.</span><span class="sxs-lookup"><span data-stu-id="29d18-194">Use *Ctrl-C* toostop invoking new jobs and exit hello script.</span></span> <span data-ttu-id="29d18-195">hello belastningen generator fortsätter toorun, men endast på befintliga klienter.</span><span class="sxs-lookup"><span data-stu-id="29d18-195">hello load generator will continue toorun, but only on existing tenants.</span></span>

## <a name="monitor-resource-usage-using-hello-azure-portal"></a><span data-ttu-id="29d18-196">Övervaka Resursanvändning med hello Azure-portalen</span><span class="sxs-lookup"><span data-stu-id="29d18-196">Monitor resource usage using hello Azure portal</span></span>

<span data-ttu-id="29d18-197">toomonitor hello Resursanvändning som resultat från hello läser in tillämpas, öppna hello portal toohello pool som innehåller hello klient databaser:</span><span class="sxs-lookup"><span data-stu-id="29d18-197">toomonitor hello resource usage that results from hello load being applied, open hello portal toohello pool containing hello tenant databases:</span></span>

1. <span data-ttu-id="29d18-198">Öppna hello [Azure-portalen](https://portal.azure.com) och bläddra toohello *tenants1 -&lt;användare&gt;*  server.</span><span class="sxs-lookup"><span data-stu-id="29d18-198">Open hello [Azure portal](https://portal.azure.com) and browse toohello *tenants1-&lt;USER&gt;* server.</span></span>
1. <span data-ttu-id="29d18-199">Bläddra ned och hitta elastiska pooler och klicka på **Pool1**.</span><span class="sxs-lookup"><span data-stu-id="29d18-199">Scroll down and locate elastic pools and click **Pool1**.</span></span> <span data-ttu-id="29d18-200">Den här poolen innehåller alla hello klient databaser skapat hittills.</span><span class="sxs-lookup"><span data-stu-id="29d18-200">This pool contains all hello tenant databases created so far.</span></span>

<span data-ttu-id="29d18-201">Se hello **elastisk pool övervakning** och **elastisk databas övervakning** diagram.</span><span class="sxs-lookup"><span data-stu-id="29d18-201">Observe hello **Elastic pool monitoring** and **Elastic database monitoring** charts.</span></span>

<span data-ttu-id="29d18-202">hello är poolens resursutnyttjandet hello sammanställd databasen användning för alla databaser i hello pool.</span><span class="sxs-lookup"><span data-stu-id="29d18-202">hello pool's resource utilization is hello aggregate database utilization for all databases in hello pool.</span></span> <span data-ttu-id="29d18-203">hello databasen diagrammet visar hello fem senaste databaser:</span><span class="sxs-lookup"><span data-stu-id="29d18-203">hello database chart shows hello five hottest databases:</span></span>

![](./media/sql-database-saas-tutorial-performance-monitoring/pool1.png)

<span data-ttu-id="29d18-204">Eftersom det finns ytterligare databaser i poolen hello utöver Hej fem, hello poolen användning visar aktivitet som inte återspeglas i hello översta fem databaser diagram.</span><span class="sxs-lookup"><span data-stu-id="29d18-204">Because there are additional databases in hello pool beyond hello top five, hello pool utilization shows activity that is not reflected in hello top five databases chart.</span></span> <span data-ttu-id="29d18-205">Mer information klickar du på **databasen resursutnyttjande**:</span><span class="sxs-lookup"><span data-stu-id="29d18-205">For additional details, click **Database Resource Utilization**:</span></span>

![](./media/sql-database-saas-tutorial-performance-monitoring/database-utilization.png)


## <a name="set-performance-alerts-on-hello-pool"></a><span data-ttu-id="29d18-206">Ange prestandavarningar i hello-adresspool</span><span class="sxs-lookup"><span data-stu-id="29d18-206">Set performance alerts on hello pool</span></span>

<span data-ttu-id="29d18-207">Ange en avisering i hello-adresspool som utlösare på \>75% användning på följande sätt:</span><span class="sxs-lookup"><span data-stu-id="29d18-207">Set an alert on hello pool that triggers on \>75% utilization as follows:</span></span>

1. <span data-ttu-id="29d18-208">Öppna *Pool1* (på hello *tenants1 -\<användare\>*  server) i hello [Azure-portalen](https://portal.azure.com).</span><span class="sxs-lookup"><span data-stu-id="29d18-208">Open *Pool1* (on hello *tenants1-\<user\>* server) in hello [Azure portal](https://portal.azure.com).</span></span>
1. <span data-ttu-id="29d18-209">Klicka på **aviseringsregler** och därefter på **+ lägg till avisering**:</span><span class="sxs-lookup"><span data-stu-id="29d18-209">Click **Alert Rules**, and then click **+ Add alert**:</span></span>

   ![lägg till avisering](media/sql-database-saas-tutorial-performance-monitoring/add-alert.png)

1. <span data-ttu-id="29d18-211">Ange ett namn, exempelvis **hög DTU**,</span><span class="sxs-lookup"><span data-stu-id="29d18-211">Provide a name, such as **High DTU**,</span></span>
1. <span data-ttu-id="29d18-212">Ange hello följande värden:</span><span class="sxs-lookup"><span data-stu-id="29d18-212">Set hello following values:</span></span>
   * <span data-ttu-id="29d18-213">**Mått = eDTU procent**</span><span class="sxs-lookup"><span data-stu-id="29d18-213">**Metric = eDTU percentage**</span></span>
   * <span data-ttu-id="29d18-214">**Villkor = större än**.</span><span class="sxs-lookup"><span data-stu-id="29d18-214">**Condition = greater than**.</span></span>
   * <span data-ttu-id="29d18-215">**Tröskelvärdet = 75**.</span><span class="sxs-lookup"><span data-stu-id="29d18-215">**Threshold = 75**.</span></span>
   * <span data-ttu-id="29d18-216">**Tidsperiod = över hello senaste 30 minuterna**.</span><span class="sxs-lookup"><span data-stu-id="29d18-216">**Period = Over hello last 30 minutes**.</span></span>
1. <span data-ttu-id="29d18-217">Lägg till en e-postadress toohello *ytterligare administratören email(s)* och klicka på **OK**.</span><span class="sxs-lookup"><span data-stu-id="29d18-217">Add an email address toohello *Additional administrator email(s)* box and click **OK**.</span></span>

   ![ange varning](media/sql-database-saas-tutorial-performance-monitoring/alert-rule.png)


## <a name="scale-up-a-busy-pool"></a><span data-ttu-id="29d18-219">Skala upp en upptagen pool</span><span class="sxs-lookup"><span data-stu-id="29d18-219">Scale up a busy pool</span></span>

<span data-ttu-id="29d18-220">Om hello sammanställd Belastningsnivå ökar på en pool toohello som maximerar hello poolen och når 100% eDTU-användning, sedan påverkas enskilda databasens prestanda, potentiellt saktas frågan svarstider för alla databaser i hello pool.</span><span class="sxs-lookup"><span data-stu-id="29d18-220">If hello aggregate load level increases on a pool toohello point that it maxes out hello pool and reaches 100% eDTU usage, then individual database performance is affected, potentially slowing query response times for all databases in hello pool.</span></span>

<span data-ttu-id="29d18-221">**Kort sikt**, Överväg att skala upp hello tooprovide ytterligare resurser eller ta bort databaser från poolen hello (flyttas tooother pooler, eller från hello tooa fristående pooltjänstnivå).</span><span class="sxs-lookup"><span data-stu-id="29d18-221">**Short term**, consider scaling up hello pool tooprovide additional resources, or removing databases from hello pool (moving them tooother pools, or out of hello pool tooa stand-alone service tier).</span></span>

<span data-ttu-id="29d18-222">**Längre sikt**, optimera frågor eller index användning tooimprove databasens prestanda.</span><span class="sxs-lookup"><span data-stu-id="29d18-222">**Longer term**, consider optimizing queries or index usage tooimprove database performance.</span></span> <span data-ttu-id="29d18-223">Beroende på hello utfärdar programmets känslighet tooperformance dess bästa praxis tooscale poolen in innan den når 100% eDTU-användning.</span><span class="sxs-lookup"><span data-stu-id="29d18-223">Depending on hello application's sensitivity tooperformance issues its best practice tooscale a pool up before it reaches 100% eDTU usage.</span></span> <span data-ttu-id="29d18-224">Använd en avisering toowarn du i förväg.</span><span class="sxs-lookup"><span data-stu-id="29d18-224">Use an alert toowarn you in advance.</span></span>

<span data-ttu-id="29d18-225">Du kan simulera poolen upptagen av ökande hello belastning som produceras av hello generator.</span><span class="sxs-lookup"><span data-stu-id="29d18-225">You can simulate a busy pool by increasing hello load produced by hello generator.</span></span> <span data-ttu-id="29d18-226">Orsaka hello databaser tooburst oftare och för längre, stigande hello sammanställd i hello-pool utan att ändra hello krav hello enskilda databaser.</span><span class="sxs-lookup"><span data-stu-id="29d18-226">Causing hello databases tooburst more frequently, and for longer, increasing hello aggregate load on hello pool without changing hello requirements of hello individual databases.</span></span> <span data-ttu-id="29d18-227">Skala upp hello poolen görs enkelt i hello-portalen eller från PowerShell.</span><span class="sxs-lookup"><span data-stu-id="29d18-227">Scaling up hello pool is easily done in hello portal or from PowerShell.</span></span> <span data-ttu-id="29d18-228">Den här övningen använder hello-portalen.</span><span class="sxs-lookup"><span data-stu-id="29d18-228">This exercise uses hello portal.</span></span>

1. <span data-ttu-id="29d18-229">Ange *$DemoScenario* = **3**, _generera belastningen med längre och oftare belastning per databas_ tooincrease hello intensiteten hello sammanställd belastningen på hello-pool utan att ändra hello belastning som krävs för varje databas.</span><span class="sxs-lookup"><span data-stu-id="29d18-229">Set *$DemoScenario* = **3**, _Generate load with longer and more frequent bursts per database_ tooincrease hello intensity of hello aggregate load on hello pool without changing hello peak load required by each database.</span></span>
1. <span data-ttu-id="29d18-230">Tryck på **F5** tooapply en belastningen tooall klient-databaser.</span><span class="sxs-lookup"><span data-stu-id="29d18-230">Press **F5** tooapply a load tooall your tenant databases.</span></span>

1. <span data-ttu-id="29d18-231">Gå för**Pool1** i hello Azure-portalen.</span><span class="sxs-lookup"><span data-stu-id="29d18-231">Go too**Pool1** in hello Azure portal.</span></span>

<span data-ttu-id="29d18-232">Övervakaren hello ökade pool-eDTU-användning i hello övre diagram.</span><span class="sxs-lookup"><span data-stu-id="29d18-232">Monitor hello increased pool eDTU usage on hello upper chart.</span></span> <span data-ttu-id="29d18-233">Det tar några minuter för hello nya högre belastning tookick, men bör du snabbt se hello poolen starta toohit max användning och som hello belastningen steadies till hello nytt mönster, overloads snabbt hello poolen.</span><span class="sxs-lookup"><span data-stu-id="29d18-233">It takes a few minutes for hello new higher load tookick in, but you should quickly see hello pool start toohit max utilization, and as hello load steadies into hello new pattern, it rapidly overloads hello pool.</span></span>

1. <span data-ttu-id="29d18-234">tooscale in hello poolen, klickar du på **konfigurera pool** hello överst i hello **Pool1** sidan.</span><span class="sxs-lookup"><span data-stu-id="29d18-234">tooscale up hello pool, click **Configure pool** at hello top of hello **Pool1** page.</span></span>
1. <span data-ttu-id="29d18-235">Justera hello **Pool-eDTU** inställning för**100**.</span><span class="sxs-lookup"><span data-stu-id="29d18-235">Adjust hello **Pool eDTU** setting too**100**.</span></span> <span data-ttu-id="29d18-236">Hello pool-eDTU ändrar inte inställningar för hello per databas (vilket är fortfarande 50 eDTU max per databas).</span><span class="sxs-lookup"><span data-stu-id="29d18-236">Changing hello pool eDTU does not change hello per-database settings (which is still 50 eDTU max per database).</span></span> <span data-ttu-id="29d18-237">Du kan se hello per databas inställningar på hello höger sida av hello **konfigurera pool** sidan.</span><span class="sxs-lookup"><span data-stu-id="29d18-237">You can see hello per-database settings on hello right side of hello **Configure pool** page.</span></span>
1. <span data-ttu-id="29d18-238">Klicka på **spara** toosubmit hello begäran tooscale hello poolen.</span><span class="sxs-lookup"><span data-stu-id="29d18-238">Click **Save** toosubmit hello request tooscale hello pool.</span></span>

<span data-ttu-id="29d18-239">Gå tillbaka för**Pool1** > **översikt** tooview hello övervakning diagram.</span><span class="sxs-lookup"><span data-stu-id="29d18-239">Go back too**Pool1** > **Overview** tooview hello monitoring charts.</span></span> <span data-ttu-id="29d18-240">Övervaka hello effekten av att tillhandahålla hello-pool med mer resurser (men med några databaser och en slumpmässig belastning inte är det alltid enkelt toosee säkerhet förrän du kör under en viss tid).</span><span class="sxs-lookup"><span data-stu-id="29d18-240">Monitor hello effect of providing hello pool with more resources (although with few databases and a randomized load it’s not always easy toosee conclusively until you run for some time).</span></span> <span data-ttu-id="29d18-241">När du tittar på hello diagram försedda med i åtanke att 100% på hello övre diagram nu representerar 100 edtu: er, på hello lägre diagram 100% är fortfarande 50 edtu: er som hello per databas max är fortfarande 50 edtu: er.</span><span class="sxs-lookup"><span data-stu-id="29d18-241">While you are looking at hello charts bear in mind that 100% on hello upper chart now represents 100 eDTUs, while on hello lower chart 100% is still 50 eDTUs as hello per-database max is still 50 eDTUs.</span></span>

<span data-ttu-id="29d18-242">Databaser förblir online och fullständigt tillgängliga i hela hello-processen.</span><span class="sxs-lookup"><span data-stu-id="29d18-242">Databases remain online and fully available throughout hello process.</span></span> <span data-ttu-id="29d18-243">Vid hello bryts sista stund eftersom varje databas är klar toobe aktiverad med hello ny pool-eDTU alla aktiva anslutningar.</span><span class="sxs-lookup"><span data-stu-id="29d18-243">At hello last moment as each database is ready toobe enabled with hello new pool eDTU, any active connections are broken.</span></span> <span data-ttu-id="29d18-244">Programkod bör alltid skrivas tooretry bort anslutningar och så kommer återansluta toohello databasen i hello uppskalade pool.</span><span class="sxs-lookup"><span data-stu-id="29d18-244">Application code should always be written tooretry dropped connections, and so will reconnect toohello database in hello scaled-up pool.</span></span>

## <a name="load-balance-between-pools"></a><span data-ttu-id="29d18-245">Belastningsutjämna mellan pooler</span><span class="sxs-lookup"><span data-stu-id="29d18-245">Load balance between pools</span></span>

<span data-ttu-id="29d18-246">Som ett alternativ tooscaling in hello poolen, skapa en pool med andra och flytta databaser till den belastningen toobalance hello mellan hello två pooler.</span><span class="sxs-lookup"><span data-stu-id="29d18-246">As an alternative tooscaling up hello pool, create a second pool and move databases into it toobalance hello load between hello two pools.</span></span> <span data-ttu-id="29d18-247">den nya poolen hello måste skapas på toodo hello samma server som hello först.</span><span class="sxs-lookup"><span data-stu-id="29d18-247">toodo this hello new pool must be created on hello same server as hello first.</span></span>

1. <span data-ttu-id="29d18-248">I hello [Azure-portalen](https://portal.azure.com)öppnar hello **tenants1 -&lt;användare&gt;**  server.</span><span class="sxs-lookup"><span data-stu-id="29d18-248">In hello [Azure portal](https://portal.azure.com), open hello **tenants1-&lt;USER&gt;** server.</span></span>
1. <span data-ttu-id="29d18-249">Klicka på **+ ny pool** toocreate poolen på hello aktuella servern.</span><span class="sxs-lookup"><span data-stu-id="29d18-249">Click **+ New pool** toocreate a pool on hello current server.</span></span>
1. <span data-ttu-id="29d18-250">På hello **elastisk databaspool** mallen:</span><span class="sxs-lookup"><span data-stu-id="29d18-250">On hello **Elastic database pool** template:</span></span>

    1. <span data-ttu-id="29d18-251">Ange **namn** för*Pool2*.</span><span class="sxs-lookup"><span data-stu-id="29d18-251">Set **Name** too*Pool2*.</span></span>
    1. <span data-ttu-id="29d18-252">Lämna hello prisnivån som **Standardpool**.</span><span class="sxs-lookup"><span data-stu-id="29d18-252">Leave hello pricing tier as **Standard Pool**.</span></span>
    1. <span data-ttu-id="29d18-253">Klicka på **konfigurera poolen**,</span><span class="sxs-lookup"><span data-stu-id="29d18-253">Click **Configure pool**,</span></span>
    1. <span data-ttu-id="29d18-254">Ange **Pool-eDTU** för*50 eDTU*.</span><span class="sxs-lookup"><span data-stu-id="29d18-254">Set **Pool eDTU** too*50 eDTU*.</span></span>
    1. <span data-ttu-id="29d18-255">Klicka på **lägga till databaser** toosee en lista över databaser på hello-server som kan läggas till för*Pool2*.</span><span class="sxs-lookup"><span data-stu-id="29d18-255">Click **Add databases** toosee a list of databases on hello server that can be added too*Pool2*.</span></span>
    1. <span data-ttu-id="29d18-256">Välj alla 10 databaser toomove dessa toohello ny pool och klicka sedan på **Välj**.</span><span class="sxs-lookup"><span data-stu-id="29d18-256">Select any 10 databases toomove these toohello new pool, and then click **Select**.</span></span> <span data-ttu-id="29d18-257">Om du har kört hello belastningen generator, vet hello tjänsten redan att profilen prestanda kräver en pool som är större än hello standardstorlek 50 eDTU och rekommenderar att du börjar med en 100 eDTU-inställning.</span><span class="sxs-lookup"><span data-stu-id="29d18-257">If you've been running hello load generator, hello service already knows that your performance profile requires a larger pool than hello default 50 eDTU size and recommends starting with a 100 eDTU setting.</span></span>

    ![Rekommendation](media/sql-database-saas-tutorial-performance-monitoring/configure-pool.png)

    1. <span data-ttu-id="29d18-259">Lämna hello standardvärdet på 50 edtu: er för den här självstudien och klicka på **Välj** igen.</span><span class="sxs-lookup"><span data-stu-id="29d18-259">For this tutorial, leave hello default at 50 eDTUs, and click **Select** again.</span></span>
    1. <span data-ttu-id="29d18-260">Välj **OK** toocreate hello ny pool och toomove hello markerade databaser till den.</span><span class="sxs-lookup"><span data-stu-id="29d18-260">Select **OK** toocreate hello new pool and toomove hello selected databases into it.</span></span>

<span data-ttu-id="29d18-261">Skapa hello poolen och flytta hello databaser tar några minuter.</span><span class="sxs-lookup"><span data-stu-id="29d18-261">Creating hello pool and moving hello databases takes a few minutes.</span></span> <span data-ttu-id="29d18-262">När databaser flyttas de fortfarande är online och fullständigt tillgängliga förrän hello allra senaste tillfället, då alla öppna anslutningar stängs.</span><span class="sxs-lookup"><span data-stu-id="29d18-262">As databases are moved they remain online and fully accessible until hello very last moment, at which point any open connections are closed.</span></span> <span data-ttu-id="29d18-263">Så länge som du har några logik för omprövning, ansluter klienter sedan toohello databasen i hello ny pool.</span><span class="sxs-lookup"><span data-stu-id="29d18-263">As long as you have some retry logic, clients will then connect toohello database in hello new pool.</span></span>

<span data-ttu-id="29d18-264">Bläddra för**Pool2** (på hello *tenants1* server) tooopen hello poolen och övervaka dess prestanda.</span><span class="sxs-lookup"><span data-stu-id="29d18-264">Browse too**Pool2** (on hello *tenants1* server) tooopen hello pool and monitor its performance.</span></span> <span data-ttu-id="29d18-265">Om du inte ser det vänta etablering av hello ny pool toocomplete.</span><span class="sxs-lookup"><span data-stu-id="29d18-265">If you don't see it, wait for provisioning of hello new pool toocomplete.</span></span>

<span data-ttu-id="29d18-266">Du ser nu att resursanvändningen på *Pool1* har tagits bort och att *Pool2* läses nu på samma sätt.</span><span class="sxs-lookup"><span data-stu-id="29d18-266">You now see that resource usage on *Pool1* has dropped and that *Pool2* is now similarly loaded.</span></span>

## <a name="manage-performance-of-a-single-database"></a><span data-ttu-id="29d18-267">Hantera prestanda för en enskild databas</span><span class="sxs-lookup"><span data-stu-id="29d18-267">Manage performance of a single database</span></span>

<span data-ttu-id="29d18-268">Om en enskild databas i en pool påträffar en varaktigt hög belastning, beroende på hello poolen konfiguration kan den tenderar toodominate hello resurser i hello pool och påverkar andra databaser.</span><span class="sxs-lookup"><span data-stu-id="29d18-268">If a single database in a pool experiences a sustained high load, depending on hello pool configuration, it may tend toodominate hello resources in hello pool and impact other databases.</span></span> <span data-ttu-id="29d18-269">Om hello aktiviteten är sannolikt toocontinue under en viss tid, flyttas hello databas tillfälligt utanför hello poolen.</span><span class="sxs-lookup"><span data-stu-id="29d18-269">If hello activity is likely toocontinue for some time, hello database can be temporarily moved out of hello pool.</span></span> <span data-ttu-id="29d18-270">Detta gör hello databasen toohave hello extra resurser den behöver och isolerar från hello andra databaser.</span><span class="sxs-lookup"><span data-stu-id="29d18-270">This allows hello database toohave hello extra resources it needs, and isolates it from hello other databases.</span></span>

<span data-ttu-id="29d18-271">Den här övningen simulerar hello effekten av Contoso samklang Hall upplever en hög belastning när biljetter går till försäljning för populära samklang.</span><span class="sxs-lookup"><span data-stu-id="29d18-271">This exercise simulates hello effect of Contoso Concert Hall experiencing a high load when tickets go on sale for a popular concert.</span></span>

1. <span data-ttu-id="29d18-272">Öppna hello... \\ *Demo-PerformanceMonitoringAndManagement.ps1* skript.</span><span class="sxs-lookup"><span data-stu-id="29d18-272">Open hello …\\*Demo-PerformanceMonitoringAndManagement.ps1* script.</span></span>
1. <span data-ttu-id="29d18-273">Ställ in **$DemoScenario = 5, generera en normal belastning plus en hög belastning för en enskild klient (cirka 95 DTU).**</span><span class="sxs-lookup"><span data-stu-id="29d18-273">Set **$DemoScenario = 5, Generate a normal load plus a high load on a single tenant (approx. 95 DTU).**</span></span>
1. <span data-ttu-id="29d18-274">Ställ in **$SingleTenantDatabaseName = contosoconcerthall**</span><span class="sxs-lookup"><span data-stu-id="29d18-274">Set **$SingleTenantDatabaseName = contosoconcerthall**</span></span>
1. <span data-ttu-id="29d18-275">Köra hello skript med hjälp av **F5**.</span><span class="sxs-lookup"><span data-stu-id="29d18-275">Execute hello script using **F5**.</span></span>


1. <span data-ttu-id="29d18-276">I hello [Azure-portalen](https://portal.azure.com) öppna **Pool1**.</span><span class="sxs-lookup"><span data-stu-id="29d18-276">In hello [Azure portal](https://portal.azure.com) open **Pool1**.</span></span>
1. <span data-ttu-id="29d18-277">Inspektera hello **elastisk pool övervakning** diagram och leta efter hello ökade poolen eDTU-användning.</span><span class="sxs-lookup"><span data-stu-id="29d18-277">Inspect hello **Elastic pool monitoring** chart and look for hello increased pool eDTU usage.</span></span> <span data-ttu-id="29d18-278">Efter en minut eller två hello högre belastning ska starta tookick i och bör du snabbt se att hello poolen träffar 100% belastning.</span><span class="sxs-lookup"><span data-stu-id="29d18-278">After a minute or two, hello higher load should start tookick in, and you should quickly see that hello pool hits 100% utilization.</span></span>
1. <span data-ttu-id="29d18-279">Inspektera hello **elastisk databas övervakning** visas som visar hello senaste databaser i hello senaste timmen.</span><span class="sxs-lookup"><span data-stu-id="29d18-279">Inspect hello **Elastic database monitoring** display which shows hello hottest databases in hello past hour.</span></span> <span data-ttu-id="29d18-280">Hej *contosoconcerthall* databasen snart ska visas som en av hello fem senaste databaser.</span><span class="sxs-lookup"><span data-stu-id="29d18-280">hello *contosoconcerthall* database should soon appear as one of hello five hottest databases.</span></span>
1. <span data-ttu-id="29d18-281">**Klicka på övervakning av hello elastisk databas** **diagram** och öppnas hello **databasen resursutnyttjande** sida där du kan övervaka någon av hello databaserna.</span><span class="sxs-lookup"><span data-stu-id="29d18-281">**Click on hello Elastic database monitoring** **chart** and it opens hello **Database Resource Utilization** page where you can monitor any of hello databases.</span></span> <span data-ttu-id="29d18-282">På så sätt kan du isolera hello skärm för hello *contosoconcerthall* databas.</span><span class="sxs-lookup"><span data-stu-id="29d18-282">This lets you isolate hello display for hello *contosoconcerthall* database.</span></span>
1. <span data-ttu-id="29d18-283">Hello lista över databaser, klicka på **contosoconcerthall**.</span><span class="sxs-lookup"><span data-stu-id="29d18-283">From hello list of databases, click **contosoconcerthall**.</span></span>
1. <span data-ttu-id="29d18-284">Klicka på **prisnivån (skala dtu: er)** tooopen hello **konfigurera prestanda** sida där du kan ange en fristående prestandanivå för hello-databasen.</span><span class="sxs-lookup"><span data-stu-id="29d18-284">Click **Pricing Tier (scale DTUs)** tooopen hello **Configure performance** page where you can set a stand-alone performance level for hello database.</span></span>
1. <span data-ttu-id="29d18-285">Klicka på hello **Standard** fliken tooopen hello skalningsalternativ i hello standardnivån.</span><span class="sxs-lookup"><span data-stu-id="29d18-285">Click on hello **Standard** tab tooopen hello scale options in hello Standard tier.</span></span>
1. <span data-ttu-id="29d18-286">Dra hello **DTU skjutreglaget** tooright tooselect **100** dtu: er.</span><span class="sxs-lookup"><span data-stu-id="29d18-286">Slide hello **DTU slider** tooright tooselect **100** DTUs.</span></span> <span data-ttu-id="29d18-287">Obs detta motsvarar toohello tjänstmålet **S3**.</span><span class="sxs-lookup"><span data-stu-id="29d18-287">Note this corresponds toohello service objective, **S3**.</span></span>
1. <span data-ttu-id="29d18-288">Klicka på **tillämpa** toomove hello databasen utanför hello poolen och gör den ett *Standard S3* databas.</span><span class="sxs-lookup"><span data-stu-id="29d18-288">Click **Apply** toomove hello database out of hello pool and make it a *Standard S3* database.</span></span>
1. <span data-ttu-id="29d18-289">När skalning är Slutför, övervaka hello effekt på hello contosoconcerthall databasen och Pool1 på hello elastisk pool och databas-blad.</span><span class="sxs-lookup"><span data-stu-id="29d18-289">Once scaling is complete, monitor hello effect on hello contosoconcerthall database and Pool1 on hello elastic pool and database blades.</span></span>

<span data-ttu-id="29d18-290">När hello hög belastning på hello contosoconcerthall databasen subsides du returnera den toohello pool tooreduce kostnader.</span><span class="sxs-lookup"><span data-stu-id="29d18-290">Once hello high load on hello contosoconcerthall database subsides you should promptly return it toohello pool tooreduce its cost.</span></span> <span data-ttu-id="29d18-291">Om det är oklart om som sker du kan ange en avisering på hello databas som utlöses när dess DTU-användningen sjunker under hello per databas max i hello poolen.</span><span class="sxs-lookup"><span data-stu-id="29d18-291">If it’s unclear when that will happen you could set an alert on hello database that will trigger when its DTU usage drops below hello per-database max on hello pool.</span></span> <span data-ttu-id="29d18-292">Övrning 5 beskriver hur du flyttar en databas till en pool.</span><span class="sxs-lookup"><span data-stu-id="29d18-292">Moving a database into a pool is described in exercise 5.</span></span>

## <a name="other-performance-management-patterns"></a><span data-ttu-id="29d18-293">Övriga prestandahanteringsmönster</span><span class="sxs-lookup"><span data-stu-id="29d18-293">Other Performance Management Patterns</span></span>

<span data-ttu-id="29d18-294">**Pre-emptive skalning** i hello övningen ovan där utforskade du hur tooscale en isolerad databas du vet vilken databas toolook för.</span><span class="sxs-lookup"><span data-stu-id="29d18-294">**Pre-emptive scaling** In hello exercise above where you explored how tooscale an isolated database, you knew which database toolook for.</span></span> <span data-ttu-id="29d18-295">Om hello hantering av Contoso samklang Hall hade Wingtips hello nära förestående biljett försäljning, ha hello-databasen flyttats utanför hello poolen pre-emptively.</span><span class="sxs-lookup"><span data-stu-id="29d18-295">If hello management of Contoso Concert Hall had informed Wingtips of hello impending ticket sale, hello database could have been moved out of hello pool pre-emptively.</span></span> <span data-ttu-id="29d18-296">I annat fall skulle det förmodligen ha krävt en avisering på hello pool eller hello databasen toospot vad som händer.</span><span class="sxs-lookup"><span data-stu-id="29d18-296">Otherwise, it would likely have required an alert on hello pool or hello database toospot what was happening.</span></span> <span data-ttu-id="29d18-297">Du vill inte toolearn om detta från hello andra klienter i hello poolen klagande försämrade prestanda.</span><span class="sxs-lookup"><span data-stu-id="29d18-297">You wouldn’t want toolearn about this from hello other tenants in hello pool complaining of degraded performance.</span></span> <span data-ttu-id="29d18-298">Och om hello-klient kan förutsäga hur länge de behöver ytterligare resurser som du kan konfigurera en Azure Automation runbook toomove hello databas utanför hello poolen och sedan tillbaka i igen på ett definierat schema.</span><span class="sxs-lookup"><span data-stu-id="29d18-298">And if hello tenant can predict how long they will need additional resources you can set up an Azure Automation runbook toomove hello database out of hello pool and then back in again on a defined schedule.</span></span>

<span data-ttu-id="29d18-299">**Klient självbetjäning skalning** eftersom skalning är en aktivitet som kallas enkelt via hello hanterings-API, kan du enkelt skapa hello möjlighet tooscale klient databaser i klient-riktade programmet och erbjuda som en funktion i SaaS-tjänsten.</span><span class="sxs-lookup"><span data-stu-id="29d18-299">**Tenant self-service scaling** Because scaling is a task easily called via hello management API, you can easily build hello ability tooscale tenant databases into your tenant-facing application, and offer it as a feature of your SaaS service.</span></span> <span data-ttu-id="29d18-300">Exempelvis kan klienter self-administer skala upp och ner kanske länkade direkt tootheir fakturering!</span><span class="sxs-lookup"><span data-stu-id="29d18-300">For example, let tenants self-administer scaling up and down, perhaps linked directly tootheir billing!</span></span>

<span data-ttu-id="29d18-301">**Skala upp och ner poolen på ett schema toomatch användningsmönster**</span><span class="sxs-lookup"><span data-stu-id="29d18-301">**Scaling a pool up and down on a schedule toomatch usage patterns**</span></span>

<span data-ttu-id="29d18-302">Där sammanställd klientanvändning följer förutsägbar användningsmönster, kan du använda Azure Automation tooscale poolen uppåt och nedåt enligt ett schema.</span><span class="sxs-lookup"><span data-stu-id="29d18-302">Where aggregate tenant usage follows predictable usage patterns, you can use Azure Automation tooscale a pool up and down on a schedule.</span></span> <span data-ttu-id="29d18-303">Skala exempelvis ned en pool efter 18.00 och upp igen innan 06.00 på veckodagar, när du vet att kraven på resursanvändning går ned.</span><span class="sxs-lookup"><span data-stu-id="29d18-303">For example, scale a pool down after 6pm and up again before 6am on weekdays when you know there is a drop in resource requirements.</span></span>



## <a name="next-steps"></a><span data-ttu-id="29d18-304">Nästa steg</span><span class="sxs-lookup"><span data-stu-id="29d18-304">Next steps</span></span>

<span data-ttu-id="29d18-305">I den här självstudiekursen får du lära du dig att:</span><span class="sxs-lookup"><span data-stu-id="29d18-305">In this tutorial you learn how to:</span></span>

> [!div class="checklist"]
> * <span data-ttu-id="29d18-306">Simulera användning på hello klient databaser genom att köra ett angivet belastningen generator</span><span class="sxs-lookup"><span data-stu-id="29d18-306">Simulate usage on hello tenant databases by running a provided load generator</span></span>
> * <span data-ttu-id="29d18-307">Övervakaren hello klient databaser som de svara toohello ökad belastning</span><span class="sxs-lookup"><span data-stu-id="29d18-307">Monitor hello tenant databases as they respond toohello increase in load</span></span>
> * <span data-ttu-id="29d18-308">Skala upp hello elastiska poolen i svaret toohello ökad databasen belastning</span><span class="sxs-lookup"><span data-stu-id="29d18-308">Scale up hello Elastic pool in response toohello increased database load</span></span>
> * <span data-ttu-id="29d18-309">Etablera en andra elastisk pool tooload saldo hello databas-aktivitet</span><span class="sxs-lookup"><span data-stu-id="29d18-309">Provision a second Elastic pool tooload balance hello database activity</span></span>

[<span data-ttu-id="29d18-310">Guiden återställ en enskild klient</span><span class="sxs-lookup"><span data-stu-id="29d18-310">Restore a single tenant tutorial</span></span>](sql-database-saas-tutorial-restore-single-tenant.md)


## <a name="additional-resources"></a><span data-ttu-id="29d18-311">Ytterligare resurser</span><span class="sxs-lookup"><span data-stu-id="29d18-311">Additional resources</span></span>

* <span data-ttu-id="29d18-312">Ytterligare [självstudier som bygger på hello Wingtip SaaS-programdistribution](sql-database-wtp-overview.md#sql-database-wingtip-saas-tutorials)</span><span class="sxs-lookup"><span data-stu-id="29d18-312">Additional [tutorials that build upon hello Wingtip SaaS application deployment](sql-database-wtp-overview.md#sql-database-wingtip-saas-tutorials)</span></span>
* [<span data-ttu-id="29d18-313">Elastiska SQL-pooler</span><span class="sxs-lookup"><span data-stu-id="29d18-313">SQL Elastic pools</span></span>](sql-database-elastic-pool.md)
* [<span data-ttu-id="29d18-314">Azure Automation</span><span class="sxs-lookup"><span data-stu-id="29d18-314">Azure automation</span></span>](../automation/automation-intro.md)
* <span data-ttu-id="29d18-315">[Log Analytics](sql-database-saas-tutorial-log-analytics.md) - Guide för att konfigurera och använda Log Analytics</span><span class="sxs-lookup"><span data-stu-id="29d18-315">[Log Analytics](sql-database-saas-tutorial-log-analytics.md) - Setting up and using Log Analytics tutorial</span></span>
