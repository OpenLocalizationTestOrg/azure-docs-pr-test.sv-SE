---
title: aaaFailover grupper och aktiv geo-replikering - Azure SQL Database | Microsoft Docs
description: "Automatisk redundans grupper med aktiv geo-replikering kan du toosetup 4 repliker av din databas i någon av hello Azure-datacenter och autoomatically redundans i ett avbrott hello-händelse."
services: sql-database
documentationcenter: na
author: anosov1960
manager: jhubbard
editor: monicar
ms.assetid: 2a29f657-82fb-4283-9a83-e14a144bfd93
ms.service: sql-database
ms.custom: business continuity
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: NA
ms.date: 07/10/2017
ms.author: sashan
ms.openlocfilehash: 7a39af8505624c0f19c5abccff051af836b1f9bc
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 10/06/2017
---
# <a name="overview-failover-groups-and-active-geo-replication"></a><span data-ttu-id="496a9-103">Översikt: Redundans grupper och aktiv geo-replikering</span><span class="sxs-lookup"><span data-stu-id="496a9-103">Overview: Failover groups and active geo-replication</span></span>
<span data-ttu-id="496a9-104">Aktiv geo-replikering kan du tooconfigure in toofour läsbara sekundära databaser i hello samma eller olika Datacenter platser (regioner).</span><span class="sxs-lookup"><span data-stu-id="496a9-104">Active geo-replication enables you tooconfigure up toofour readable secondary databases in hello same or different data center locations (regions).</span></span> <span data-ttu-id="496a9-105">Sekundära databaser är tillgängliga för frågor och för redundans hello gäller en data center nätverksavbrott eller hello oförmåga tooconnect toohello primära databasen.</span><span class="sxs-lookup"><span data-stu-id="496a9-105">Secondary databases are available for querying and for failover in hello case of a data center outage or hello inability tooconnect toohello primary database.</span></span> <span data-ttu-id="496a9-106">hello växling vid fel måste initieras manuellt av hello tillämpningen av hello användare.</span><span class="sxs-lookup"><span data-stu-id="496a9-106">hello failover must be initiated manually by hello application of hello user.</span></span> <span data-ttu-id="496a9-107">Efter växling vid fel har hello nya primära en annan anslutning slutpunkt.</span><span class="sxs-lookup"><span data-stu-id="496a9-107">After failover, hello new primary has a different connection end-point.</span></span> 

> [!NOTE]
> <span data-ttu-id="496a9-108">Aktiv geo-replikering är tillgänglig för alla databaser i alla servicenivåer i alla regioner.</span><span class="sxs-lookup"><span data-stu-id="496a9-108">Active geo-replication is available for all databases in all service tiers in all regions.</span></span>
>  

<span data-ttu-id="496a9-109">Azure SQL Database automatisk redundans grupper (i förhandsversion) är en SQL-databas funktionen utformats tooautomatically hanterar geo-replikering relation-, anslutnings- och växling vid fel i större skala.</span><span class="sxs-lookup"><span data-stu-id="496a9-109">Azure SQL Database auto-failover groups (in-preview) is a SQL Database feature designed tooautomatically manage geo-replication relationship, connectivity, and failover at scale.</span></span> <span data-ttu-id="496a9-110">Återskapa hello kunder vinst hello möjlighet tooautomatically flera relaterade databaser i hello sekundär region efter oåterkalleligt regionala fel eller andra oplanerade händelser som ger fullständig eller partiell förlust av hello SQL Database-tjänsten tillgänglighet i hello primär region.</span><span class="sxs-lookup"><span data-stu-id="496a9-110">With it, hello customers gain hello ability tooautomatically recover multiple related databases in hello secondary region after catastrophic regional failures or other unplanned events that result in full or partial loss of hello SQL Database service’s availability in hello primary region.</span></span> <span data-ttu-id="496a9-111">Dessutom kan de använda hello läsbara sekundära databaser toooffload skrivskyddade arbetsbelastningar.</span><span class="sxs-lookup"><span data-stu-id="496a9-111">Additionally, they can use hello readable secondary databases toooffload read-only workloads.</span></span>  <span data-ttu-id="496a9-112">Eftersom automatisk redundans grupper inkluderar flera databaser måste de konfigureras på hello primära servern.</span><span class="sxs-lookup"><span data-stu-id="496a9-112">Because auto-failover groups involve multiple databases they must be configured on hello primary server.</span></span> <span data-ttu-id="496a9-113">Både primära och sekundära servrar måste finnas i hello samma prenumeration.</span><span class="sxs-lookup"><span data-stu-id="496a9-113">Both primary and secondary servers must be in hello same subscription.</span></span> <span data-ttu-id="496a9-114">Automatisk redundans grupper stöd för replikering av alla databaser i hello grupp tooonly en sekundär server i en annan region.</span><span class="sxs-lookup"><span data-stu-id="496a9-114">Auto-failover groups support replication of all databases in hello group tooonly one secondary server in a different region.</span></span> <span data-ttu-id="496a9-115">Aktiv geo-replikering, utan automatisk redundans grupper kan in too4 sekundärservrar i en region.</span><span class="sxs-lookup"><span data-stu-id="496a9-115">Active geo-replication, without auto-failover groups, allows up too4 secondaries in any region.</span></span>

<span data-ttu-id="496a9-116">Om du använder aktiv geo-replikering och för den primära databasen misslyckas orsak eller helt enkelt behov toobe tas offline, kan du initiera redundans tooany sekundära databaserna.</span><span class="sxs-lookup"><span data-stu-id="496a9-116">If you are using active geo-replication and for any reason your primary database fails, or simply needs toobe taken offline, you can initiate failover tooany of your secondary databases.</span></span> <span data-ttu-id="496a9-117">När redundansväxlingen är aktiverad tooone hello sekundära databaser kan alla sekundära är automatiskt länkade toohello nya primära.</span><span class="sxs-lookup"><span data-stu-id="496a9-117">When failover is activated tooone of hello secondary databases, all other secondaries are automatically linked toohello new primary.</span></span> <span data-ttu-id="496a9-118">Om du använder automatisk redundans grupper (i förhandsversion) toomanage databasåterställning och eventuella avbrott som påverkar en eller flera av hello databaser i hello gruppen ger automatisk redundans.</span><span class="sxs-lookup"><span data-stu-id="496a9-118">If you are using auto-failover groups (in-preview) toomanage database recovery and any outage that impacts one or several of hello databases in hello group results in automatic failover.</span></span> <span data-ttu-id="496a9-119">Du kan konfigurera hello automatisk redundans principen som bäst uppfyller behoven för ditt program eller du kan välja och använda manuell aktivering.</span><span class="sxs-lookup"><span data-stu-id="496a9-119">You can configure hello auto-failover policy that best meets your application needs, or you can opt out and use manual activation.</span></span> <span data-ttu-id="496a9-120">Dessutom automatisk redundans grupper (i förhandsversion) ger Läs-och skrivbehörighet och skrivskyddad lyssnare slutpunkter som förblir oförändrade under redundans.</span><span class="sxs-lookup"><span data-stu-id="496a9-120">In addition, auto-failover groups (in-preview) provide read-write and read-only listener end-points that remain unchanged during failovers.</span></span> <span data-ttu-id="496a9-121">Om du använder manuell eller automatisk redundans aktivering växlar redundans alla sekundära databaser i hello grupp tooprimary.</span><span class="sxs-lookup"><span data-stu-id="496a9-121">Whether you use manual or automatic failover activation, failover switches all secondary databases in hello group tooprimary.</span></span> <span data-ttu-id="496a9-122">När hello databasfel har slutförts är hello DNS-posten uppdateras automatiskt tooredirect hello slutpunkter toohello nya region.</span><span class="sxs-lookup"><span data-stu-id="496a9-122">After hello database failover is completed, hello DNS record is automatically updated tooredirect hello end-points toohello new region.</span></span>

<span data-ttu-id="496a9-123">Du kan hantera replikering och redundans för en individuell databas eller en uppsättning databaser på en server eller i en elastisk pool använder aktiv geo-replikering.</span><span class="sxs-lookup"><span data-stu-id="496a9-123">You can manage replication and failover of an individual database or a set of databases on a server or in an elastic pool using active geo-replication.</span></span> <span data-ttu-id="496a9-124">Du kan göra det med hello [Azure-portalen](sql-database-geo-replication-portal.md), [PowerShell](sql-database-geo-replication-powershell.md), [Transact-SQL](sql-database-geo-replication-transact-sql.md), eller hello [REST API](https://msdn.microsoft.com/library/azure/mt163685.aspx).</span><span class="sxs-lookup"><span data-stu-id="496a9-124">You can do that using hello [Azure portal](sql-database-geo-replication-portal.md), [PowerShell](sql-database-geo-replication-powershell.md), [Transact-SQL](sql-database-geo-replication-transact-sql.md), or hello [REST API](https://msdn.microsoft.com/library/azure/mt163685.aspx).</span></span> <span data-ttu-id="496a9-125">Kontrollera hello autentiseringskraven för servern och databasen har konfigurerats på hello nya primära efter redundans.</span><span class="sxs-lookup"><span data-stu-id="496a9-125">After failover, ensure hello authentication requirements for your server and database are configured on hello new primary.</span></span> <span data-ttu-id="496a9-126">Mer information finns i [SQL Database-säkerhet efter katastrofåterställning](sql-database-geo-replication-security-config.md).</span><span class="sxs-lookup"><span data-stu-id="496a9-126">For details, see [SQL Database security after disaster recovery](sql-database-geo-replication-security-config.md).</span></span> <span data-ttu-id="496a9-127">Detta gäller både tooactive geo-replikering och automatisk redundans grupper (i förhandsversion).</span><span class="sxs-lookup"><span data-stu-id="496a9-127">This applies both tooactive geo-replication and auto-failover groups (in-preview).</span></span>

<span data-ttu-id="496a9-128">Aktiv geo-replikering använder hello [alltid på](https://docs.microsoft.com/sql/database-engine/availability-groups/windows/overview-of-always-on-availability-groups-sql-server) teknik för SQL Server tooasynchronously replikerar genomförda transaktioner på hello primära tooa sekundära databasen med ögonblicksbild allokerad för läsning isolering (RCSI).</span><span class="sxs-lookup"><span data-stu-id="496a9-128">Active geo-replication leverages hello [Always On](https://docs.microsoft.com/sql/database-engine/availability-groups/windows/overview-of-always-on-availability-groups-sql-server) technology of SQL Server tooasynchronously replicate committed transactions on hello primary database tooa secondary database using read committed snapshot isolation (RCSI).</span></span> <span data-ttu-id="496a9-129">Automatisk redundans grupper ger hello grupp semantik ovanpå aktiv geo-replikering men hello samma asynkron replikering används.</span><span class="sxs-lookup"><span data-stu-id="496a9-129">Auto-failover groups provide hello group semantics on top of active geo-replication but hello same asynchronous replication mechanism is used.</span></span> <span data-ttu-id="496a9-130">När vid en viss, hello sekundära databasen kan vara något bakom hello primära databasen, hello sekundära data garanteras toonever har delvis transaktioner.</span><span class="sxs-lookup"><span data-stu-id="496a9-130">While at any given point, hello secondary database might be slightly behind hello primary database, hello secondary data is guaranteed toonever have partial transactions.</span></span> <span data-ttu-id="496a9-131">Cross-region redundans gör det möjligt för program tooquickly Återställ en förlust av ett helt datacenter eller delar av ett datacenter som orsakats av naturkatastrof, oåterkalleligt mänskliga fel eller skadliga åtgärder.</span><span class="sxs-lookup"><span data-stu-id="496a9-131">Cross-region redundancy enables applications tooquickly recover from a permanent loss of an entire datacenter or parts of a datacenter caused by natural disasters, catastrophic human errors, or malicious acts.</span></span> <span data-ttu-id="496a9-132">hello specifika Återställningspunktmål data finns på [översikt över verksamhetskontinuitet](sql-database-business-continuity.md).</span><span class="sxs-lookup"><span data-stu-id="496a9-132">hello specific RPO data can be found at [Overview of Business Continuity](sql-database-business-continuity.md).</span></span>

<span data-ttu-id="496a9-133">hello visar följande bild ett exempel på en aktiv geo-replikering konfigureras med en primär region för hello norra centrala USA och sekundära i hello södra centrala USA region.</span><span class="sxs-lookup"><span data-stu-id="496a9-133">hello following figure shows an example of active geo-replication configured with a primary in hello North Central US region and secondary in hello South Central US region.</span></span>

![GEO-replikering relation](./media/sql-database-active-geo-replication/geo-replication-relationship.png)

<span data-ttu-id="496a9-135">De kan vara används toooffload skrivskyddade arbetsbelastningar som rapportering jobb eftersom hello sekundära databaser är läsbar.</span><span class="sxs-lookup"><span data-stu-id="496a9-135">Because hello secondary databases are readable, they can be used toooffload read-only workloads such as reporting jobs.</span></span> <span data-ttu-id="496a9-136">Om du använder aktiv geo-replikering, det är möjligt toocreate hello sekundär databas i hello samma region med hello primära, men inte öka hello programmet återhämtning toocatastrophic fel.</span><span class="sxs-lookup"><span data-stu-id="496a9-136">If you are using active geo-replication, it is possible toocreate hello secondary database in hello same region with hello primary, but it does not increase hello application's resilience toocatastrophic failures.</span></span> <span data-ttu-id="496a9-137">Om du använder automatisk redundans grupper (i förhandsversion) skapas alltid din sekundära databas i en annan region.</span><span class="sxs-lookup"><span data-stu-id="496a9-137">If you are using auto-failover groups (in-preview), your secondary database is always created in a different region.</span></span>

<span data-ttu-id="496a9-138">Dessutom kan toodisaster recovery aktiv geo-replikering användas i hello följande scenarier:</span><span class="sxs-lookup"><span data-stu-id="496a9-138">In addition toodisaster recovery active geo-replication can be used in hello following scenarios:</span></span>

* <span data-ttu-id="496a9-139">**Databasen migrering**: du kan använda aktiv geo-replikering toomigrate en databas från en server tooanother online med minimal avbrottstid.</span><span class="sxs-lookup"><span data-stu-id="496a9-139">**Database migration**: You can use active geo-replication toomigrate a database from one server tooanother online with minimum downtime.</span></span>
* <span data-ttu-id="496a9-140">**Programuppgraderingar**: du kan skapa en extra sekundär som en bakre kopia misslyckas under programuppgraderingar.</span><span class="sxs-lookup"><span data-stu-id="496a9-140">**Application upgrades**: You can create an extra secondary as a fail back copy during application upgrades.</span></span>

<span data-ttu-id="496a9-141">tooachieve verkliga affärskontinuitet, lägger till databasredundans mellan Datacenter är bara en del av hello lösning.</span><span class="sxs-lookup"><span data-stu-id="496a9-141">tooachieve real business continuity, adding database redundancy between datacenters is only part of hello solution.</span></span> <span data-ttu-id="496a9-142">Återställa ett program (tjänsten) slutpunkt till slutpunkt efter återställning av alla komponenter som utgör hello-tjänsten och alla beroende tjänster kräver att ett oåterkalleligt fel.</span><span class="sxs-lookup"><span data-stu-id="496a9-142">Recovering an application (service) end-to-end after a catastrophic failure requires recovery of all components that constitute hello service and any dependent services.</span></span> <span data-ttu-id="496a9-143">Exempel på dessa komponenter är hello-klientprogrammet (till exempel en webbläsare med en anpassad JavaScript), frontwebbservrar, lagring och DNS.</span><span class="sxs-lookup"><span data-stu-id="496a9-143">Examples of these components include hello client software (for example, a browser with a custom JavaScript), web front ends, storage, and DNS.</span></span> <span data-ttu-id="496a9-144">Det är viktigt att alla komponenter är flexibel toohello samma fel och blir tillgängliga inom hello recovery tid mål för Återställningstid för programmet.</span><span class="sxs-lookup"><span data-stu-id="496a9-144">It is critical that all components are resilient toohello same failures and become available within hello recovery time objective (RTO) of your application.</span></span> <span data-ttu-id="496a9-145">Därför behöver tooidentify alla beroende tjänster och förstå hello garantier och funktioner som de tillhandahåller.</span><span class="sxs-lookup"><span data-stu-id="496a9-145">Therefore, you need tooidentify all dependent services and understand hello guarantees and capabilities they provide.</span></span> <span data-ttu-id="496a9-146">Sedan måste du vidta lämpliga åtgärder tooensure som din servicefunktioner under hello redundans hello-tjänster som den beroende.</span><span class="sxs-lookup"><span data-stu-id="496a9-146">Then, you must take adequate steps tooensure that your service functions during hello failover of hello services on which it depends.</span></span> <span data-ttu-id="496a9-147">Mer information om hur man designar lösningar för katastrofåterställning finns [designa Molnlösningar för Disaster Recovery använder aktiv geo-replikering](sql-database-designing-cloud-solutions-for-disaster-recovery.md).</span><span class="sxs-lookup"><span data-stu-id="496a9-147">For more information about designing solutions for disaster recovery, see [Designing Cloud Solutions for Disaster Recovery Using active geo-replication](sql-database-designing-cloud-solutions-for-disaster-recovery.md).</span></span>

## <a name="active-geo-replication-capabilities"></a><span data-ttu-id="496a9-148">Funktioner för aktiv geo-replikering</span><span class="sxs-lookup"><span data-stu-id="496a9-148">Active geo-replication capabilities</span></span>
<span data-ttu-id="496a9-149">hello aktiv geo-replikering funktionen ger hello följande grundläggande funktioner:</span><span class="sxs-lookup"><span data-stu-id="496a9-149">hello active geo-replication feature provides hello following essential capabilities:</span></span>
* <span data-ttu-id="496a9-150">**Automatisk asynkron replikering**: du kan bara skapa en sekundär databas genom att lägga till tooan befintlig databas.</span><span class="sxs-lookup"><span data-stu-id="496a9-150">**Automatic Asynchronous Replication**: You can only create a secondary database by adding tooan existing database.</span></span> <span data-ttu-id="496a9-151">hello sekundära kan skapas i en Azure SQL Database-server.</span><span class="sxs-lookup"><span data-stu-id="496a9-151">hello secondary can be created in any Azure SQL Database server.</span></span> <span data-ttu-id="496a9-152">När du skapat fylls hello sekundär databas med hello data som kopieras från hello primära databasen.</span><span class="sxs-lookup"><span data-stu-id="496a9-152">Once created, hello secondary database is populated with hello data copied from hello primary database.</span></span> <span data-ttu-id="496a9-153">Den här processen kallas seeding.</span><span class="sxs-lookup"><span data-stu-id="496a9-153">This process is known as seeding.</span></span> <span data-ttu-id="496a9-154">När sekundära databas har skapats och angetts, replikeras uppdateringar toohello primära databasen är asynkront toohello sekundära databasen automatiskt.</span><span class="sxs-lookup"><span data-stu-id="496a9-154">After secondary database has been created and seeded, updates toohello primary database are asynchronously replicated toohello secondary database automatically.</span></span> <span data-ttu-id="496a9-155">Asynkron replikering innebär att transaktionerna sparas på hello primära databasen innan de replikerade toohello sekundär databas.</span><span class="sxs-lookup"><span data-stu-id="496a9-155">Asynchronous replication means that transactions are committed on hello primary database before they are replicated toohello secondary database.</span></span> 
* <span data-ttu-id="496a9-156">**Läsbara sekundära databaser**: ett program kan komma åt en sekundär databas för skrivskyddade åtgärder med hjälp av hello samma eller olika säkerhetsobjekt som används för att komma åt hello primära databasen.</span><span class="sxs-lookup"><span data-stu-id="496a9-156">**Readable secondary databases**: An application can access a secondary database for read-only operations using hello same or different security principals used for accessing hello primary database.</span></span> <span data-ttu-id="496a9-157">hello sekundära databaser fungerar i ögonblicksbildisolering läge tooensure replikering av hello uppdateringar av hello primära (loggen replay) inte skjutas upp med frågor som körs på hello sekundär.</span><span class="sxs-lookup"><span data-stu-id="496a9-157">hello secondary databases operate in snapshot isolation mode tooensure replication of hello updates of hello primary (log replay) is not delayed by queries executed on hello secondary.</span></span>

   > [!NOTE]
   > <span data-ttu-id="496a9-158">hello loggen replay är försenad på hello sekundära databasen om det finns schemat uppdateras den tar emot från hello primära som kräver ett schemalås på hello sekundär databas.</span><span class="sxs-lookup"><span data-stu-id="496a9-158">hello log replay is delayed on hello secondary database if there are schema updates that it is receiving from hello Primary that require a schema lock on hello secondary database.</span></span> 
   > 

* <span data-ttu-id="496a9-159">**Flera läsbara sekundärservrar**: två eller flera sekundära databaser öka redundans och nivå av skydd för hello primära databasen och program.</span><span class="sxs-lookup"><span data-stu-id="496a9-159">**Multiple readable secondaries**: Two or more secondary databases increase redundancy and level of protection for hello primary database and application.</span></span> <span data-ttu-id="496a9-160">Om det finns flera sekundära databaser, förblir hello program skyddat även om en av hello sekundära databaser misslyckas.</span><span class="sxs-lookup"><span data-stu-id="496a9-160">If multiple secondary databases exist, hello application remains protected even if one of hello secondary databases fails.</span></span> <span data-ttu-id="496a9-161">Om det finns endast en sekundär databas och misslyckas, hello programmet exponeras toohigher risk förrän en ny sekundär databas har skapats.</span><span class="sxs-lookup"><span data-stu-id="496a9-161">If there is only one secondary database, and it fails, hello application is exposed toohigher risk until a new secondary database is created.</span></span>

   > [!NOTE]
   > <span data-ttu-id="496a9-162">Om du använder aktiv geo-replikering toobuild ett globalt distribuerat program och behöver tooprovide skrivskyddad åtkomst till toodata i mer än 4 regioner, kan du skapa sekundär för en sekundär (en process som kallas länkning).</span><span class="sxs-lookup"><span data-stu-id="496a9-162">If you are using active geo-replication toobuild a globally distributed application and need tooprovide read-only access toodata in more than 4 regions, you can create secondary of a secondary (a process known as chaining).</span></span> <span data-ttu-id="496a9-163">Det här sättet kan du uppnå praktiskt taget obegränsade skalan för databasreplikering.</span><span class="sxs-lookup"><span data-stu-id="496a9-163">This way you can achieve virtually unlimited scale of database replication.</span></span> <span data-ttu-id="496a9-164">Dessutom minskar länkning hello arbetet med att replikeringen från hello primära databasen.</span><span class="sxs-lookup"><span data-stu-id="496a9-164">In addition, chaining reduces hello overhead of replication from hello primary database.</span></span> <span data-ttu-id="496a9-165">hello kompromiss är hello ökad replikeringsfördröjning på hello löv mest sekundära databaser.</span><span class="sxs-lookup"><span data-stu-id="496a9-165">hello trade-off is hello increased replication lag on hello leaf-most secondary databases.</span></span> <span data-ttu-id="496a9-166">.</span><span class="sxs-lookup"><span data-stu-id="496a9-166">.</span></span> 
   >

* <span data-ttu-id="496a9-167">**Stöd för elastiska poolen databaser**: aktiv geo-replikering kan konfigureras för alla databaser i en elastisk pool.</span><span class="sxs-lookup"><span data-stu-id="496a9-167">**Support of elastic pool databases**: Active geo-replication can be configured for any database in any elastic pool.</span></span> <span data-ttu-id="496a9-168">hello sekundära databasen kan vara i en annan elastisk pool.</span><span class="sxs-lookup"><span data-stu-id="496a9-168">hello secondary database can be in another elastic pool.</span></span> <span data-ttu-id="496a9-169">För vanliga databaser kan hello sekundära en elastisk pool och vice versa så länge hello tjänstnivåer är hello samma.</span><span class="sxs-lookup"><span data-stu-id="496a9-169">For regular databases, hello secondary can be an elastic pool and vice versa as long as hello service tiers are hello same.</span></span> 
* <span data-ttu-id="496a9-170">**Konfigurerbara prestandanivå hello sekundära databasen**: en sekundär databas kan skapas med lägre prestandanivå än hello primär.</span><span class="sxs-lookup"><span data-stu-id="496a9-170">**Configurable performance level of hello secondary database**: A secondary database can be created with lower performance level than hello primary.</span></span> <span data-ttu-id="496a9-171">Både primära och sekundära databaser krävs toohave hello samma tjänstnivån.</span><span class="sxs-lookup"><span data-stu-id="496a9-171">Both primary and secondary databases are required toohave hello same service tier.</span></span> <span data-ttu-id="496a9-172">Det här alternativet rekommenderas inte för program med hög Databasaktivitet för skrivning eftersom hello ökad replikeringsfördröjning ökar hello risk för betydande dataförlust efter en växling vid fel.</span><span class="sxs-lookup"><span data-stu-id="496a9-172">This option is not recommended for applications with high database write activity because hello increased replication lag increases hello risk of substantial data loss after a failover.</span></span> <span data-ttu-id="496a9-173">Dessutom när redundans hello programmets prestanda påverkas förrän hello nya primära är uppgraderade tooa högre prestanda nivå.</span><span class="sxs-lookup"><span data-stu-id="496a9-173">In addition, after failover hello application’s performance is impacted until hello new primary is upgraded tooa higher performance level.</span></span> <span data-ttu-id="496a9-174">hello logg-i/o procentandel diagram på Azure-portalen innehåller ett bra sätt tooestimate hello minimal prestandanivå hello sekundära som är nödvändiga toosustain hello replikering belastningen.</span><span class="sxs-lookup"><span data-stu-id="496a9-174">hello log IO percentage chart on Azure portal provides a good way tooestimate hello minimal performance level of hello secondary that is required toosustain hello replication load.</span></span> <span data-ttu-id="496a9-175">Till exempel om den primära databasen är P6 (1000 DTU) och dess loggen IO-procent är 50% hello sekundära behöver toobe minst P4 (500 DTU).</span><span class="sxs-lookup"><span data-stu-id="496a9-175">For example, if your Primary database is P6 (1000 DTU) and its log IO percent is 50% hello secondary needs toobe at least P4 (500 DTU).</span></span> <span data-ttu-id="496a9-176">Du kan också hämta hello loggen IO data med hjälp av [sys.resource_stats](https://msdn.microsoft.com/library/dn269979.aspx) eller [sys.dm_db_resource_stats](https://msdn.microsoft.com/library/dn800981.aspx) databasen vyer.</span><span class="sxs-lookup"><span data-stu-id="496a9-176">You can also retrieve hello log IO data using [sys.resource_stats](https://msdn.microsoft.com/library/dn269979.aspx) or [sys.dm_db_resource_stats](https://msdn.microsoft.com/library/dn800981.aspx) database views.</span></span>  <span data-ttu-id="496a9-177">Mer information om hello prestandanivåer för SQL-databas finns [SQL Database-alternativ och prestanda](sql-database-service-tiers.md).</span><span class="sxs-lookup"><span data-stu-id="496a9-177">For more information on hello SQL Database performance levels, see [SQL Database options and performance](sql-database-service-tiers.md).</span></span> 
* <span data-ttu-id="496a9-178">**Användaren styrs redundans och återställning efter fel**: en sekundär databas explicit kan vara avstängda toohello primära rollen när som helst av programmet hello eller hello användare.</span><span class="sxs-lookup"><span data-stu-id="496a9-178">**User-controlled failover and failback**: A secondary database can explicitly be switched toohello primary role at any time by hello application or hello user.</span></span> <span data-ttu-id="496a9-179">Under en verklig avbrott hello ska ”oplanerad” alternativet användas som främjar omedelbart en sekundär toobe hello primär.</span><span class="sxs-lookup"><span data-stu-id="496a9-179">During a real outage hello “unplanned” option should be used, which immediately promotes a secondary toobe hello primary.</span></span> <span data-ttu-id="496a9-180">När hello misslyckade primära återställer och är tillgänglig igen, hello system märken hello återställas primära som en sekundär och automatiskt ta den uppdaterade med hello nya primära.</span><span class="sxs-lookup"><span data-stu-id="496a9-180">When hello failed primary recovers and is available again, hello system automatically marks hello recovered primary as a secondary and bring it up-to-date with hello new primary.</span></span> <span data-ttu-id="496a9-181">På grund av toohello asynkron uppbyggnad replikering, kan en liten mängd data gå förlorade under oplanerad redundans om en primär misslyckas innan de replikeras hello senaste ändringar toohello sekundär.</span><span class="sxs-lookup"><span data-stu-id="496a9-181">Due toohello asynchronous nature of replication, a small amount of data can be lost during unplanned failovers if a primary fails before it replicates hello most recent changes toohello secondary.</span></span> <span data-ttu-id="496a9-182">När en primärnyckel med flera sekundärservrar växlar hello system omkonfigureras automatiskt hello replikeringens relationer och länkar hello återstående sekundärservrar toohello nyligen upphöja primära utan användarens ingripande.</span><span class="sxs-lookup"><span data-stu-id="496a9-182">When a primary with multiple secondaries fails over, hello system automatically reconfigures hello replication relationships and links hello remaining secondaries toohello newly promoted primary without requiring any user intervention.</span></span> <span data-ttu-id="496a9-183">Det kan vara önskvärt tooreturn hello programmet toohello primär region när hello-avbrott som har orsakat hello redundans minskas.</span><span class="sxs-lookup"><span data-stu-id="496a9-183">After hello outage that caused hello failover is mitigated, it may be desirable tooreturn hello application toohello primary region.</span></span> <span data-ttu-id="496a9-184">toodo att hello redundanskommandot ska anropas med hello planerad ”” alternativet.</span><span class="sxs-lookup"><span data-stu-id="496a9-184">toodo that, hello failover command should be invoked with hello “planned” option.</span></span> 
* <span data-ttu-id="496a9-185">**Synkronisera autentiseringsuppgifter och brandväggsregler**: Vi rekommenderar att du använder [databasen brandväggsregler](sql-database-firewall-configure.md) för geo-replikerade databaser så att de här reglerna kan replikeras med hello databasen tooensure har alla sekundära databaser Hej samma brandväggsregler som hello primära.</span><span class="sxs-lookup"><span data-stu-id="496a9-185">**Keeping credentials and firewall rules in sync**: We recommend using [database firewall rules](sql-database-firewall-configure.md) for geo-replicated databases so these rules can be replicated with hello database tooensure all secondary databases have hello same firewall rules as hello primary.</span></span> <span data-ttu-id="496a9-186">Den här metoden gör att kunder toomanually konfigurerar och underhåller brandväggsregler på servrar som är värd för både hello primära och sekundära databaser hello behöver.</span><span class="sxs-lookup"><span data-stu-id="496a9-186">This approach eliminates hello need for customers toomanually configure and maintain firewall rules on servers hosting both hello primary and secondary databases.</span></span> <span data-ttu-id="496a9-187">På samma sätt med hjälp av [innehöll databasanvändare](sql-database-manage-logins.md) för data access ser du till både primära och sekundära databaser har alltid hello samma autentiseringsuppgifter så att det finns inga avbrott under växling vid fel, på grund av toomismatches med inloggningar och lösenord.</span><span class="sxs-lookup"><span data-stu-id="496a9-187">Similarly, using [contained database users](sql-database-manage-logins.md) for data access ensures both primary and secondary databases always have hello same user credentials so during a failover, there is no disruptions due toomismatches with logins and passwords.</span></span> <span data-ttu-id="496a9-188">Med hello [Azure Active Directory](../active-directory/active-directory-whatis.md)kunder kan hantera åtkomst tooboth primära och sekundära databaserna och eliminera hello behöver för att hantera autentiseringsuppgifter i databaser helt och hållet.</span><span class="sxs-lookup"><span data-stu-id="496a9-188">With hello addition of [Azure Active Directory](../active-directory/active-directory-whatis.md), customers can manage user access tooboth primary and secondary databases and eliminating hello need for managing credentials in databases altogether.</span></span>

## <a name="auto-failover-group-capabilities"></a><span data-ttu-id="496a9-189">Automatisk redundans grupp funktioner</span><span class="sxs-lookup"><span data-stu-id="496a9-189">Auto-failover group capabilities</span></span>

<span data-ttu-id="496a9-190">Automatisk redundans grupper funktion tillhandahåller en kraftfull abstraktion av aktiv geo-replikering genom att stödja grupp nivån replikering och automatisk redundans.</span><span class="sxs-lookup"><span data-stu-id="496a9-190">Auto-failover groups feature provides a powerful abstraction of active geo-replication by supporting group level replication and automatic failover.</span></span> <span data-ttu-id="496a9-191">Dessutom tas bort hello nödvändigt toochange hello SQL-anslutningssträng efter växling vid fel genom att tillhandahålla hello ytterligare lyssnare slutpunkter.</span><span class="sxs-lookup"><span data-stu-id="496a9-191">In addition, it removes hello necessity toochange hello SQL connection string after failover by providing hello additional listener end-points.</span></span> 

* <span data-ttu-id="496a9-192">**Redundansväxlingsgrupp**: en eller flera grupper för växling vid fel kan skapas mellan två servrar i olika regioner (primära och sekundära servrar).</span><span class="sxs-lookup"><span data-stu-id="496a9-192">**Failover group**: One or many failover groups can be created between two servers in different regions (primary and secondary servers).</span></span> <span data-ttu-id="496a9-193">Varje grupp kan innehålla en eller flera databaser som återställs som en enhet om alla eller vissa av de databaser som primär inaktiveras på grund av tooan avbrott i hello primära region.</span><span class="sxs-lookup"><span data-stu-id="496a9-193">Each group can include one or several databases that are recovered as a unit in case all or some primary databases become unavailable due tooan outage in hello primary region.</span></span>  
* <span data-ttu-id="496a9-194">**Primär server**: en server som är värd för hello primära databaser i gruppen för hello växling vid fel.</span><span class="sxs-lookup"><span data-stu-id="496a9-194">**Primary server**: A server that hosts hello primary databases in hello failover group.</span></span>
* <span data-ttu-id="496a9-195">**Sekundär server**: en server som är värd för hello sekundära databaser i gruppen för hello växling vid fel.</span><span class="sxs-lookup"><span data-stu-id="496a9-195">**Secondary server**: A server that hosts hello secondary databases in hello failover group.</span></span> <span data-ttu-id="496a9-196">hello sekundär server kan inte vara i hello samma region som hello primära servern.</span><span class="sxs-lookup"><span data-stu-id="496a9-196">hello secondary server cannot be in hello same region as hello primary server.</span></span>
* <span data-ttu-id="496a9-197">**Att lägga till databaser toofailover grupp**: du kan placera flera databaser i en server eller i en elastisk pool i hello samma grupp för växling vid fel.</span><span class="sxs-lookup"><span data-stu-id="496a9-197">**Adding databases toofailover group**: You can put several databases within a server or within an elastic pool into hello same failover group.</span></span> <span data-ttu-id="496a9-198">Om du lägger till en fristående databas toohello grupp skapas automatiskt en sekundär databas med hjälp av hello samma version och prestanda nivå.</span><span class="sxs-lookup"><span data-stu-id="496a9-198">If you add a standalone database toohello group, it automatically creates a secondary database using hello same edition and performance level.</span></span> <span data-ttu-id="496a9-199">Om hello primära databasen är i en elastisk pool, hello sekundära skapas automatiskt i hello elastisk pool med hello samma namn.</span><span class="sxs-lookup"><span data-stu-id="496a9-199">If hello primary database is in an elastic pool, hello secondary is automatically created in hello elastic pool with hello same name.</span></span> <span data-ttu-id="496a9-200">Om du lägger till en databas som redan har en sekundär databas i hello sekundär server ärvs som geo-replikering av hello grupp.</span><span class="sxs-lookup"><span data-stu-id="496a9-200">If you add a database that already has a secondary database in hello secondary server, that geo-replication is inherited by hello group.</span></span>

   > [!NOTE]
   > <span data-ttu-id="496a9-201">När du lägger till en databas som redan har en sekundär databas på en server som inte är en del av hello redundansväxlingsgrupp skapas en ny sekundär i hello sekundär server.</span><span class="sxs-lookup"><span data-stu-id="496a9-201">When adding a database that already has a secondary database in a server that is not part of hello failover group, a new secondary is created in hello secondary server.</span></span> 
   >

* <span data-ttu-id="496a9-202">**Redundans skrivskyddad lyssnare**: skapas från en DNS CNAME-post  **&lt;redundans gruppnamn&gt;. database.windows.net** som pekar toohello aktuella primära server-URL.</span><span class="sxs-lookup"><span data-stu-id="496a9-202">**Failover group read-write listener**: A DNS CNAME record formed as **&lt;failover-group-name&gt;.database.windows.net** that points toohello current primary server URL.</span></span> <span data-ttu-id="496a9-203">Tillåter hello skrivskyddad SQL program tootransparently återansluta toohello primära databasen när hello primära ändras efter växling vid fel.</span><span class="sxs-lookup"><span data-stu-id="496a9-203">It allows hello read-write SQL applications tootransparently reconnect toohello primary database when hello primary changes after failover.</span></span> 
* <span data-ttu-id="496a9-204">**Redundans skrivskyddad lyssnare**: skapas från en DNS CNAME-post  **&lt;redundans gruppnamn&gt;. secondary.database.windows.net** som pekar toohello sekundär server URL: en.</span><span class="sxs-lookup"><span data-stu-id="496a9-204">**Failover group read-only listener**: A DNS CNAME record formed as **&lt;failover-group-name&gt;.secondary.database.windows.net** that points toohello secondary server’s URL.</span></span> <span data-ttu-id="496a9-205">Tillåter hello skrivskyddad SQL program tootransparently ansluta toohello sekundär databas med hjälp av hello angivna regler för belastningsutjämning.</span><span class="sxs-lookup"><span data-stu-id="496a9-205">It allows hello read-only SQL applications tootransparently connect toohello secondary database using hello specified load-balancing rules.</span></span> <span data-ttu-id="496a9-206">Alternativt kan du ange om du vill hello skrivskyddad trafik toobe automatiskt omdirigeras toohello primära servern när hello sekundär server inte är tillgänglig.</span><span class="sxs-lookup"><span data-stu-id="496a9-206">Optionally you can specify if you want hello read-only traffic toobe automatically re-directed toohello primary server when hello secondary server is not available.</span></span>
* <span data-ttu-id="496a9-207">**Princip för automatisk redundans**: som standard hello redundansväxlingsgrupp har konfigurerats med en princip för automatisk redundans.</span><span class="sxs-lookup"><span data-stu-id="496a9-207">**Automatic failover policy**: By default, hello failover group is configured with an automatic failover policy.</span></span> <span data-ttu-id="496a9-208">hello systemet utlöser redundans så snart hello fel identifieras.</span><span class="sxs-lookup"><span data-stu-id="496a9-208">hello system triggers failover as soon as hello failure is detected.</span></span> <span data-ttu-id="496a9-209">Om du vill toocontrol hello redundans arbetsflödet från hello program kan inaktivera du automatisk redundans.</span><span class="sxs-lookup"><span data-stu-id="496a9-209">If you want toocontrol hello failover workflow from hello application, you can turn off automatic failover.</span></span> 
* <span data-ttu-id="496a9-210">**Manuell växling**: du kan initiera redundans manuellt när som helst oavsett hello automatisk redundans-konfigurationen.</span><span class="sxs-lookup"><span data-stu-id="496a9-210">**Manual failover**: You can initiate failover manually at any time regardless of hello automatic failover configuration.</span></span> <span data-ttu-id="496a9-211">Om automatisk redundansprincip inte är konfigurerade manuell växling är obligatoriska toorecover databaser i hello redundansväxlingsgrupp.</span><span class="sxs-lookup"><span data-stu-id="496a9-211">If automatic failover policy is not configured manual failover is required toorecover databases in hello failover group.</span></span> <span data-ttu-id="496a9-212">Du kan initiera framtvingad eller eget redundansväxling (med Fullständig datasynkronisering).</span><span class="sxs-lookup"><span data-stu-id="496a9-212">You can initiate forced or friendly failover (with full data synchronization).</span></span> <span data-ttu-id="496a9-213">hello senare kan använda toorelocate hello active server toohello primär region.</span><span class="sxs-lookup"><span data-stu-id="496a9-213">hello latter could be used toorelocate hello active server toohello primary region.</span></span> <span data-ttu-id="496a9-214">När redundansväxlingen är klar är hello DNS-poster uppdateras automatiskt tooensure anslutning toohello rätt server.</span><span class="sxs-lookup"><span data-stu-id="496a9-214">When failover is completed hello DNS records are automatically updated tooensure connectivity toohello correct server.</span></span>
* <span data-ttu-id="496a9-215">**Grace-period med dataförlust**: eftersom hello primära och sekundära databaser är synkroniserad med hjälp av asynkron replikering hello redundans kan resultera i förlust av data.</span><span class="sxs-lookup"><span data-stu-id="496a9-215">**Grace period with data loss**: Because hello primary and secondary databases are synchronized using asynchronous replication hello failover may result in data loss.</span></span> <span data-ttu-id="496a9-216">Du kan anpassa hello automatisk redundans princip tooreflect programmets tolerans toodata går förlorade.</span><span class="sxs-lookup"><span data-stu-id="496a9-216">You can customize hello automatic failover policy tooreflect your application’s tolerance toodata loss.</span></span> <span data-ttu-id="496a9-217">Genom att konfigurera **GracePeriodWithDataLossHours**, du kan styra hur länge hello systemet ska vänta innan du påbörjar hello växling vid fel som är sannolikt tooresult data går förlorade.</span><span class="sxs-lookup"><span data-stu-id="496a9-217">By configuring **GracePeriodWithDataLossHours**, you can control how long hello system waits before initiating hello failover that is likely tooresult data loss.</span></span> 

   > [!NOTE]
   > <span data-ttu-id="496a9-218">När systemet identifierar att hello i hello gruppen är online (exempelvis hello avbrott bara påverkas hello service control plan), aktiveras omedelbart hello redundans med Fullständig datasynkronisering (eget failover) oavsett hello värde Ange **GracePeriodWithDataLossHours**.</span><span class="sxs-lookup"><span data-stu-id="496a9-218">When system detects that hello databases in hello group are still online (for example, hello outage only impacted hello service control plane), it immediately activates hello failover with full data synchronization (friendly failover) regardless of hello value set by **GracePeriodWithDataLossHours**.</span></span> <span data-ttu-id="496a9-219">Det här beteendet garanteras att det finns inga data går förlorade under hello återställningen.</span><span class="sxs-lookup"><span data-stu-id="496a9-219">This behavior ensures that there is no data loss during hello recovery.</span></span> <span data-ttu-id="496a9-220">hello respitperioden gäller endast när ett eget failover inte är möjligt.</span><span class="sxs-lookup"><span data-stu-id="496a9-220">hello grace period takes effect only when a friendly failover is not possible.</span></span> <span data-ttu-id="496a9-221">Om hello avbrott minskas innan hello respitperioden upphör att gälla, aktiveras inte hello växling vid fel.</span><span class="sxs-lookup"><span data-stu-id="496a9-221">If hello outage is mitigated before hello grace period expires, hello failover is not activated.</span></span>
   >

* <span data-ttu-id="496a9-222">**Flera grupper för växling vid fel**: du kan konfigurera flera grupper för växling vid fel för hello samma par av servrar toocontrol hello skalan för växling vid fel.</span><span class="sxs-lookup"><span data-stu-id="496a9-222">**Multiple failover groups**: You can configure multiple failover groups for hello same pair of servers toocontrol hello scale of failovers.</span></span> <span data-ttu-id="496a9-223">Varje grupp flyttas över oberoende av varandra.</span><span class="sxs-lookup"><span data-stu-id="496a9-223">Each group fails over independently.</span></span> <span data-ttu-id="496a9-224">Om ditt program med flera innehavare använder elastiska pooler, kan du använda den här funktionen toomix primära och sekundära databaser i varje pool.</span><span class="sxs-lookup"><span data-stu-id="496a9-224">If your multi-tenant application uses elastic pools, you can use this capability toomix primary and secondary databases in each pool.</span></span> <span data-ttu-id="496a9-225">Det här sättet kan du minska hello effekten av ett avbrott tooonly hälften av hello innehavare.</span><span class="sxs-lookup"><span data-stu-id="496a9-225">This way you can reduce hello impact of an outage tooonly half of hello tenants.</span></span>

## <a name="best-practices-of-building-highly-available-service"></a><span data-ttu-id="496a9-226">Metodtips för att skapa tjänst med hög tillgänglighet</span><span class="sxs-lookup"><span data-stu-id="496a9-226">Best practices of building highly available service</span></span>

<span data-ttu-id="496a9-227">toobuild en tjänst med hög tillgänglighet som använder Azure SQL database hello kunder bör följa dessa riktlinjer:</span><span class="sxs-lookup"><span data-stu-id="496a9-227">toobuild a highly available service that uses Azure SQL database hello customers should follow these guidelines:</span></span>
- <span data-ttu-id="496a9-228">**Använd failover grupp**: en eller flera grupper för växling vid fel kan skapas mellan två servrar i olika regioner (primära och sekundära servrar).</span><span class="sxs-lookup"><span data-stu-id="496a9-228">**Use failover group**: One or many failover groups can be created between two servers in different regions (primary and secondary servers).</span></span> <span data-ttu-id="496a9-229">Varje grupp kan innehålla en eller flera databaser som återställs som en enhet om alla eller vissa av de databaser som primär inaktiveras på grund av tooan avbrott i hello primära region.</span><span class="sxs-lookup"><span data-stu-id="496a9-229">Each group can include one or several databases that are recovered as a unit in case all or some primary databases become unavailable due tooan outage in hello primary region.</span></span> <span data-ttu-id="496a9-230">hello redundansväxlingsgrupp skapar geo sekundär databas med hello samma tjänst mål som hello primära.</span><span class="sxs-lookup"><span data-stu-id="496a9-230">hello failover group creates geo-secondary database with hello same service objective as hello primary.</span></span> <span data-ttu-id="496a9-231">Om du lägger till en befintlig geo-replikering relationen toohello redundans grupp Se till att hello geo sekundära har konfigurerats med hello samma tjänst nivån mål som hello primära.</span><span class="sxs-lookup"><span data-stu-id="496a9-231">If you add an existing geo-replication relationship toohello failover group make sure hello geo-secondary is configured with hello same service level objective as hello primary.</span></span>
- <span data-ttu-id="496a9-232">**Använd läsa / skriva-lyssnare för OLTP-arbetsbelastning**: när du utför OLTP operations Använd  **&lt;redundans gruppnamn&gt;. database.windows.net** som hello-Serveradress och hello anslutningar kommer att automatiskt dirigerad toohello primära.</span><span class="sxs-lookup"><span data-stu-id="496a9-232">**Use read-write listener for OLTP workload**: When performing OLTP operations use **&lt;failover-group-name&gt;.database.windows.net** as hello server URL and hello connections will be automatically directed toohello primary.</span></span> <span data-ttu-id="496a9-233">URL: en ändras inte efter hello redundans.</span><span class="sxs-lookup"><span data-stu-id="496a9-233">This URL will not change after hello failover.</span></span>  
<span data-ttu-id="496a9-234">Obs hello redundans innebär att uppdatera hello DNS-posten så att hello klientanslutningar omdirigerade toohello nya primära endast efter hello klientens DNS-cachen har uppdaterats.</span><span class="sxs-lookup"><span data-stu-id="496a9-234">Note hello failover involves updating hello DNS record so hello client connections will be redirected toohello new primary only after hello client DNS cache is refreshed.</span></span>
- <span data-ttu-id="496a9-235">**Använd endast Läs-lyssnaren för skrivskyddad arbetsbelastning**: Om du har en logiskt isolerade skrivskyddad arbetsbelastning som är feltolerant toocertain föråldrad av data, du kan använda hello sekundär databas i hello program.</span><span class="sxs-lookup"><span data-stu-id="496a9-235">**Use read-only listener for read-only workload**: If you have a logically isolated read-only workload that is tolerant toocertain staleness of data, you can use hello secondary database in hello application.</span></span> <span data-ttu-id="496a9-236">För att använda skrivskyddad sessioner  **&lt;redundans gruppnamn&gt;. secondary.database.windows.net** som hello-Serveradress och hello anslutningen kommer att automatiskt dirigerad toohello sekundär.</span><span class="sxs-lookup"><span data-stu-id="496a9-236">For read-only sessions use **&lt;failover-group-name&gt;.secondary.database.windows.net** as hello server URL and hello connection will be automatically directed toohello secondary.</span></span> <span data-ttu-id="496a9-237">Vi rekommenderar också att du anger i anslutningssträngen läsa avsikten med hjälp av **ApplicationIntent ReadOnly =**.</span><span class="sxs-lookup"><span data-stu-id="496a9-237">It is also recommended that you indicate in connection string read intent by using **ApplicationIntent=ReadOnly**.</span></span> 
- <span data-ttu-id="496a9-238">**Förberedas för prestanda försämras**: SQL redundans beslut är oberoende av hello resten av programmet hello eller andra tjänster som används.</span><span class="sxs-lookup"><span data-stu-id="496a9-238">**Be prepared for perf degradation**: SQL failover decision is independent from hello rest of hello application or other services used.</span></span> <span data-ttu-id="496a9-239">programmet hello får ”blandas” med vissa komponenter i en region och en del i en annan.</span><span class="sxs-lookup"><span data-stu-id="496a9-239">hello application may be “mixed” with some components in one region and some in another.</span></span> <span data-ttu-id="496a9-240">tooavoid hello försämring Kontrollera hello redundant programdistribution i hello DR region och följ hello riktlinjerna i den här artikeln.</span><span class="sxs-lookup"><span data-stu-id="496a9-240">tooavoid hello degradation, ensure hello redundant application deployment in hello DR region and follow hello guidelines in this article.</span></span>  
<span data-ttu-id="496a9-241">Obs hello programmet hello DR region har inte toouse en annan anslutningssträng.</span><span class="sxs-lookup"><span data-stu-id="496a9-241">Note hello application in hello DR region does not have toouse a different connection string.</span></span>  
- <span data-ttu-id="496a9-242">**Förbereda för förlust av data**: om ett avbrott har upptäckts SQL automatiskt utlöser skrivskyddad växling vid fel om det finns inga data går förlorade toohello av vår knowledge bästa.</span><span class="sxs-lookup"><span data-stu-id="496a9-242">**Prepare for data loss**: If an outage is detected, SQL automatically triggers read-write failover if there is zero data loss toohello best of our knowledge.</span></span> <span data-ttu-id="496a9-243">I annat fall det väntar på hello period som du angett av **GracePeriodWithDataLossHours**.</span><span class="sxs-lookup"><span data-stu-id="496a9-243">Otherwise, it waits for hello period you specified by **GracePeriodWithDataLossHours**.</span></span> <span data-ttu-id="496a9-244">Om du har angett **GracePeriodWithDataLossHours**, att förbereda för förlust av data.</span><span class="sxs-lookup"><span data-stu-id="496a9-244">If you specified **GracePeriodWithDataLossHours**, be prepared for data loss.</span></span> <span data-ttu-id="496a9-245">I allmänhet prioriterar Azure under avbrott, tillgänglighet.</span><span class="sxs-lookup"><span data-stu-id="496a9-245">In general, during outages, Azure favors availability.</span></span> <span data-ttu-id="496a9-246">Om du inte har råd dataförlust, se till att tooset **GracePeriodWithDataLossHours** tooa tillräckligt många, till exempel 24 timmar.</span><span class="sxs-lookup"><span data-stu-id="496a9-246">If you cannot afford data loss, make sure tooset **GracePeriodWithDataLossHours** tooa sufficiently large number, such as 24 hours.</span></span> 


## <a name="upgrading-or-downgrading-a-primary-database"></a><span data-ttu-id="496a9-247">Uppgradera eller nedgradera en primär databas</span><span class="sxs-lookup"><span data-stu-id="496a9-247">Upgrading or downgrading a primary database</span></span>
<span data-ttu-id="496a9-248">Du kan uppgradera eller nedgradera primära databasen tooa olika prestandanivå (inom hello samma servicenivå) utan att koppla från alla sekundära databaser.</span><span class="sxs-lookup"><span data-stu-id="496a9-248">You can upgrade or downgrade a primary database tooa different performance level (within hello same service tier) without disconnecting any secondary databases.</span></span> <span data-ttu-id="496a9-249">När du uppgraderar, rekommenderar vi att du först uppgraderar hello sekundära databasen och sedan uppgradera hello primär.</span><span class="sxs-lookup"><span data-stu-id="496a9-249">When upgrading, we recommend that you upgrade hello secondary database first, and then upgrade hello primary.</span></span> <span data-ttu-id="496a9-250">När nedgradera, omvänd hello ordning: först nedgradera hello primära och nedgradera hello sekundär.</span><span class="sxs-lookup"><span data-stu-id="496a9-250">When downgrading, reverse hello order: downgrade hello primary first, and then downgrade hello secondary.</span></span> <span data-ttu-id="496a9-251">När du uppgraderar eller nedgradera hello databasnivå tooa olika tjänsten tillämpas denna rekommendation.</span><span class="sxs-lookup"><span data-stu-id="496a9-251">When you upgrade or downgrade hello database tooa different service tier this recommendation is enforced.</span></span> 

> [!NOTE]
> <span data-ttu-id="496a9-252">Om du har skapat sekundära databasen som en del av hello redundanskonfiguration grupp är den inte rekommenderade toodowngrade hello sekundär databas.</span><span class="sxs-lookup"><span data-stu-id="496a9-252">If you created secondary database as part of hello failover group configuration it is not recommended toodowngrade hello secondary database.</span></span> <span data-ttu-id="496a9-253">Detta är tooensure data-tier har tillräcklig kapacitet tooprocess din vanliga arbetsbelastning efter växling vid fel är aktiverat.</span><span class="sxs-lookup"><span data-stu-id="496a9-253">This is tooensure your data tier has sufficient capacity tooprocess your regular workload after failover is activated.</span></span> 
>

## <a name="preventing-hello-loss-of-critical-data"></a><span data-ttu-id="496a9-254">Hindrar hello förlust av viktiga data</span><span class="sxs-lookup"><span data-stu-id="496a9-254">Preventing hello loss of critical data</span></span>
<span data-ttu-id="496a9-255">På grund av toohello hög fördröjning av WAN-nätverk använder kontinuerlig kopiering en asynkron replikering.</span><span class="sxs-lookup"><span data-stu-id="496a9-255">Due toohello high latency of wide area networks, continuous copy uses an asynchronous replication mechanism.</span></span> <span data-ttu-id="496a9-256">Asynkron replikering kan data gå förlorade oundvikligt om ett fel inträffar.</span><span class="sxs-lookup"><span data-stu-id="496a9-256">Asynchronous replication makes some data loss unavoidable if a failure occurs.</span></span> <span data-ttu-id="496a9-257">Vissa program kan dock kräva att inga data går förlorade.</span><span class="sxs-lookup"><span data-stu-id="496a9-257">However, some applications may require no data loss.</span></span> <span data-ttu-id="496a9-258">tooprotect viktiga uppdateringar, programutvecklare kan anropa hello [sp_wait_for_database_copy_sync](https://msdn.microsoft.com/library/dn467644.aspx) system proceduren när du genomför hello transaktion.</span><span class="sxs-lookup"><span data-stu-id="496a9-258">tooprotect these critical updates, an application developer can call hello [sp_wait_for_database_copy_sync](https://msdn.microsoft.com/library/dn467644.aspx) system procedure immediately after committing hello transaction.</span></span> <span data-ttu-id="496a9-259">Anropar **sp_wait_for_database_copy_sync** block hello anropar tråd förrän hello senaste allokerad transaktion har överförts toohello sekundär databas.</span><span class="sxs-lookup"><span data-stu-id="496a9-259">Calling **sp_wait_for_database_copy_sync** blocks hello calling thread until hello last committed transaction has been transmitted toohello secondary database.</span></span> <span data-ttu-id="496a9-260">Men väntar den inte hello överförs transaktioner toobe spelas och verkställs på hello sekundär.</span><span class="sxs-lookup"><span data-stu-id="496a9-260">However, it does not wait for hello transmitted transactions toobe replayed and committed on hello secondary.</span></span> <span data-ttu-id="496a9-261">**sp_wait_for_database_copy_sync** är begränsade tooa specifika kontinuerlig kopiering länk.</span><span class="sxs-lookup"><span data-stu-id="496a9-261">**sp_wait_for_database_copy_sync** is scoped tooa specific continuous copy link.</span></span> <span data-ttu-id="496a9-262">Alla användare med hello anslutning rättigheter toohello primära databasen kan anropa den här proceduren.</span><span class="sxs-lookup"><span data-stu-id="496a9-262">Any user with hello connection rights toohello primary database can call this procedure.</span></span>

> [!NOTE]
> <span data-ttu-id="496a9-263">**sp_wait_for_database_copy_sync** kommer att förhindra förlust av data efter växling vid fel, men det inte garanterar fullständig synkronisering för läsåtkomst.</span><span class="sxs-lookup"><span data-stu-id="496a9-263">**sp_wait_for_database_copy_sync** will prevent data loss after failover, but it will not guarantee full synchronization for read access.</span></span> <span data-ttu-id="496a9-264">Hej försening som orsakas av en **sp_wait_for_database_copy_sync** proceduranropet kan vara betydande och beror på hello storleken på transaktionsloggen hello när hello hello-anrop.</span><span class="sxs-lookup"><span data-stu-id="496a9-264">hello delay caused by a **sp_wait_for_database_copy_sync** procedure call can be significant and depends on hello size of hello transaction log at hello time of hello call.</span></span> 
> 

## <a name="programmatically-managing-failover-groups-and-active-geo-replication"></a><span data-ttu-id="496a9-265">Programmässigt hantera redundans grupper och aktiv geo-replikering</span><span class="sxs-lookup"><span data-stu-id="496a9-265">Programmatically managing failover groups and active geo-replication</span></span>
<span data-ttu-id="496a9-266">Som beskrivits tidigare, automatisk redundans grupper (i förhandsversion) och aktiv geo-replikering kan också hanteras via programmering med hjälp av Azure PowerShell och hello REST API.</span><span class="sxs-lookup"><span data-stu-id="496a9-266">As discussed previously, auto-failover groups (in-preview) and active geo-replication can also be managed programmatically using Azure PowerShell and hello REST API.</span></span> <span data-ttu-id="496a9-267">hello följande tabeller beskrivs hello uppsättning kommandon som är tillgängliga.</span><span class="sxs-lookup"><span data-stu-id="496a9-267">hello following tables describe hello set of commands available.</span></span>

<span data-ttu-id="496a9-268">**Azure Resource Manager API och rollbaserad säkerhet**: aktiv geo-replikering innehåller en uppsättning API: er för Azure Resource Manager för hantering, inklusive hello [Azure SQL Database REST API](https://docs.microsoft.com/rest/api/sql/) och [Azure PowerShell-cmdlets](https://docs.microsoft.com/powershell/azure/overview).</span><span class="sxs-lookup"><span data-stu-id="496a9-268">**Azure Resource Manager API and role-based security**: Active geo-replication includes a set of Azure Resource Manager APIs for management, including hello [Azure SQL Database REST API](https://docs.microsoft.com/rest/api/sql/) and [Azure PowerShell cmdlets](https://docs.microsoft.com/powershell/azure/overview).</span></span> <span data-ttu-id="496a9-269">Dessa API: er kräver hello användning av resursgrupper och stöder rollbaserad säkerhet (RBAC).</span><span class="sxs-lookup"><span data-stu-id="496a9-269">These APIs require hello use of resource groups and support role-based security (RBAC).</span></span> <span data-ttu-id="496a9-270">Mer information om hur tooimplement åt roller finns [rollbaserad åtkomstkontroll i](../active-directory/role-based-access-control-what-is.md).</span><span class="sxs-lookup"><span data-stu-id="496a9-270">For more information on how tooimplement access roles, see [Azure Role-Based Access Control](../active-directory/role-based-access-control-what-is.md).</span></span>

> [!NOTE]
> <span data-ttu-id="496a9-271">Flera nya funktioner för aktiv geo-replikering stöds bara via [Azure Resource Manager](../azure-resource-manager/resource-group-overview.md) baserat [Azure SQL REST API](https://msdn.microsoft.com/library/azure/mt163571.aspx) och [Azure SQL Database PowerShell-cmdlets](https://msdn.microsoft.com/library/azure/mt574084.aspx).</span><span class="sxs-lookup"><span data-stu-id="496a9-271">Many new features of active geo-replication are only supported using [Azure Resource Manager](../azure-resource-manager/resource-group-overview.md) based [Azure SQL REST API](https://msdn.microsoft.com/library/azure/mt163571.aspx) and [Azure SQL Database PowerShell cmdlets](https://msdn.microsoft.com/library/azure/mt574084.aspx).</span></span> <span data-ttu-id="496a9-272">Hej [(klassiskt) REST API](https://msdn.microsoft.com/library/azure/dn505719.aspx) och [Azure SQL Database (klassisk) cmdlets](https://msdn.microsoft.com/library/azure/dn546723.aspx) stöds för bakåtkompatibilitet det med hjälp av hello Azure Resource Manager-baserade API: er rekommenderas.</span><span class="sxs-lookup"><span data-stu-id="496a9-272">hello [(classic) REST API](https://msdn.microsoft.com/library/azure/dn505719.aspx) and [Azure SQL Database (classic) cmdlets](https://msdn.microsoft.com/library/azure/dn546723.aspx) are supported for backward compatibility so using hello Azure Resource Manager-based APIs are recommended.</span></span> 
> 

## <a name="manage-sql-database-failover-using-using-transact-sql"></a><span data-ttu-id="496a9-273">Hantera SQL database växling vid fel med hjälp av Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="496a9-273">Manage SQL database failover using using Transact-SQL</span></span>

| <span data-ttu-id="496a9-274">Kommando</span><span class="sxs-lookup"><span data-stu-id="496a9-274">Command</span></span> | <span data-ttu-id="496a9-275">Beskrivning</span><span class="sxs-lookup"><span data-stu-id="496a9-275">Description</span></span> |
| --- | --- |
| [<span data-ttu-id="496a9-276">ALTER DATABASE (Azure SQL-databas)</span><span class="sxs-lookup"><span data-stu-id="496a9-276">ALTER DATABASE (Azure SQL Database)</span></span>](https://msdn.microsoft.com/library/mt574871.aspx) |<span data-ttu-id="496a9-277">Använd Lägg till ON SEKUNDÄRSERVER argumentet toocreate en sekundär databas för en befintlig databas och startar datareplikering</span><span class="sxs-lookup"><span data-stu-id="496a9-277">Use ADD SECONDARY ON SERVER argument toocreate a secondary database for an existing database and starts data replication</span></span> |
| [<span data-ttu-id="496a9-278">ALTER DATABASE (Azure SQL-databas)</span><span class="sxs-lookup"><span data-stu-id="496a9-278">ALTER DATABASE (Azure SQL Database)</span></span>](https://msdn.microsoft.com/library/mt574871.aspx) |<span data-ttu-id="496a9-279">Använd växling vid fel eller FORCE_FAILOVER_ALLOW_DATA_LOSS tooswitch en sekundär databas toobe primära tooinitiate redundans</span><span class="sxs-lookup"><span data-stu-id="496a9-279">Use FAILOVER or FORCE_FAILOVER_ALLOW_DATA_LOSS tooswitch a secondary database toobe primary tooinitiate failover</span></span> |
| [<span data-ttu-id="496a9-280">ALTER DATABASE (Azure SQL-databas)</span><span class="sxs-lookup"><span data-stu-id="496a9-280">ALTER DATABASE (Azure SQL Database)</span></span>](https://msdn.microsoft.com/library/mt574871.aspx) |<span data-ttu-id="496a9-281">Använd ta bort sekundära på servern tooterminate en datareplikering mellan en SQL-databas och hello angivna sekundära databasen.</span><span class="sxs-lookup"><span data-stu-id="496a9-281">Use REMOVE SECONDARY ON SERVER tooterminate a data replication between a SQL Database and hello specified secondary database.</span></span> |
| [<span data-ttu-id="496a9-282">sys.geo_replication_links (Azure SQL Database)</span><span class="sxs-lookup"><span data-stu-id="496a9-282">sys.geo_replication_links (Azure SQL Database)</span></span>](https://msdn.microsoft.com/library/mt575501.aspx) |<span data-ttu-id="496a9-283">Returnerar information om alla befintliga replikeringslänkar för varje databas på logisk hello Azure SQL Database-server.</span><span class="sxs-lookup"><span data-stu-id="496a9-283">Returns information about all existing replication links for each database on hello Azure SQL Database logical server.</span></span> |
| [<span data-ttu-id="496a9-284">sys.dm_geo_replication_link_status (Azure SQL Database)</span><span class="sxs-lookup"><span data-stu-id="496a9-284">sys.dm_geo_replication_link_status (Azure SQL Database)</span></span>](https://msdn.microsoft.com/library/mt575504.aspx) |<span data-ttu-id="496a9-285">Hämtar hello senast replikering, senaste replikeringsfördröjning och annan information om hello replikeringslänken för en angiven SQL-databas.</span><span class="sxs-lookup"><span data-stu-id="496a9-285">Gets hello last replication time, last replication lag, and other information about hello replication link for a given SQL database.</span></span> |
| [<span data-ttu-id="496a9-286">sys.dm_operation_status (Azure SQL Database)</span><span class="sxs-lookup"><span data-stu-id="496a9-286">sys.dm_operation_status (Azure SQL Database)</span></span>](https://msdn.microsoft.com/library/dn270022.aspx) |<span data-ttu-id="496a9-287">Visar hello statusen för alla databasåtgärder inklusive hello länkstatus hello replikering.</span><span class="sxs-lookup"><span data-stu-id="496a9-287">Shows hello status for all database operations including hello status of hello replication links.</span></span> |
| [<span data-ttu-id="496a9-288">sp_wait_for_database_copy_sync (Azure SQL Database)</span><span class="sxs-lookup"><span data-stu-id="496a9-288">sp_wait_for_database_copy_sync (Azure SQL Database)</span></span>](https://msdn.microsoft.com/library/dn467644.aspx) |<span data-ttu-id="496a9-289">Gör hello programmet toowait tills alla genomförda transaktioner replikeras och bekräftas av hello aktiva sekundära databasen.</span><span class="sxs-lookup"><span data-stu-id="496a9-289">causes hello application toowait until all committed transactions are replicated and acknowledged by hello active secondary database.</span></span> |
|  | |

## <a name="manage-sql-database-failover-using-using-powershell"></a><span data-ttu-id="496a9-290">Hantera SQL database växling vid fel med hjälp av PowerShell</span><span class="sxs-lookup"><span data-stu-id="496a9-290">Manage SQL database failover using using PowerShell</span></span>

| <span data-ttu-id="496a9-291">Cmdlet</span><span class="sxs-lookup"><span data-stu-id="496a9-291">Cmdlet</span></span> | <span data-ttu-id="496a9-292">Beskrivning</span><span class="sxs-lookup"><span data-stu-id="496a9-292">Description</span></span> |
| --- | --- |
| [<span data-ttu-id="496a9-293">Get-AzureRmSqlDatabase</span><span class="sxs-lookup"><span data-stu-id="496a9-293">Get-AzureRmSqlDatabase</span></span>](/powershell/module/azurerm.sql/get-azurermsqldatabase) |<span data-ttu-id="496a9-294">Hämtar en eller flera databaser.</span><span class="sxs-lookup"><span data-stu-id="496a9-294">Gets one or more databases.</span></span> |
| [<span data-ttu-id="496a9-295">Ny AzureRmSqlDatabaseSecondary</span><span class="sxs-lookup"><span data-stu-id="496a9-295">New-AzureRmSqlDatabaseSecondary</span></span>](/powershell/module/azurerm.sql/new-azurermsqldatabasesecondary) |<span data-ttu-id="496a9-296">Skapar en sekundär databas för en befintlig databas och startar datareplikeringen.</span><span class="sxs-lookup"><span data-stu-id="496a9-296">Creates a secondary database for an existing database and starts data replication.</span></span> |
| [<span data-ttu-id="496a9-297">Ange AzureRmSqlDatabaseSecondary</span><span class="sxs-lookup"><span data-stu-id="496a9-297">Set-AzureRmSqlDatabaseSecondary</span></span>](/powershell/module/azurerm.sql/set-azurermsqldatabasesecondary) |<span data-ttu-id="496a9-298">Växlar en sekundär databas toobe primära tooinitiate redundans.</span><span class="sxs-lookup"><span data-stu-id="496a9-298">Switches a secondary database toobe primary tooinitiate failover.</span></span> |
| [<span data-ttu-id="496a9-299">Ta bort AzureRmSqlDatabaseSecondary</span><span class="sxs-lookup"><span data-stu-id="496a9-299">Remove-AzureRmSqlDatabaseSecondary</span></span>](/powershell/module/azurerm.sql/remove-azurermsqldatabasesecondary) |<span data-ttu-id="496a9-300">Avbryter datareplikering mellan en SQL-databas och hello angivna sekundära databasen.</span><span class="sxs-lookup"><span data-stu-id="496a9-300">Terminates data replication between a SQL Database and hello specified secondary database.</span></span> |
| [<span data-ttu-id="496a9-301">Get-AzureRmSqlDatabaseReplicationLink</span><span class="sxs-lookup"><span data-stu-id="496a9-301">Get-AzureRmSqlDatabaseReplicationLink</span></span>](/powershell/module/azurerm.sql/get-azurermsqldatabasereplicationlink) |<span data-ttu-id="496a9-302">Hämtar hello geo-replikeringslänkar mellan en Azure SQL Database och en resursgrupp eller SQL Server.</span><span class="sxs-lookup"><span data-stu-id="496a9-302">Gets hello geo-replication links between an Azure SQL Database and a resource group or SQL Server.</span></span> |
| [<span data-ttu-id="496a9-303">Ny AzureRmSqlDatabaseFailoverGroup</span><span class="sxs-lookup"><span data-stu-id="496a9-303">New-AzureRmSqlDatabaseFailoverGroup</span></span>](/powershell/module/azurerm.sql/set-azurermsqldatabasefailovergroup) |   <span data-ttu-id="496a9-304">Det här kommandot skapar en redundansväxlingsgrupp och registrerar den på både primära och sekundära servrar</span><span class="sxs-lookup"><span data-stu-id="496a9-304">This command creates a failover group and registers it on both primary and secondary servers</span></span>|
| [<span data-ttu-id="496a9-305">Ta bort AzureRmSqlDatabaseFailoverGroup</span><span class="sxs-lookup"><span data-stu-id="496a9-305">Remove-AzureRmSqlDatabaseFailoverGroup</span></span>](/powershell/module/azurerm.sql/remove-azurermsqldatabasefailovergroup) | <span data-ttu-id="496a9-306">Tar bort hello redundansväxlingsgrupp från hello-servern och tar bort alla sekundära databaser ingår hello-grupp</span><span class="sxs-lookup"><span data-stu-id="496a9-306">Removes hello failover group from hello server and deletes all secondary databases included hello group</span></span> |
| [<span data-ttu-id="496a9-307">Get-AzureRmSqlDatabaseFailoverGroup</span><span class="sxs-lookup"><span data-stu-id="496a9-307">Get-AzureRmSqlDatabaseFailoverGroup</span></span>](/powershell/module/azurerm.sql/get-azurermsqldatabasefailovergroup) | <span data-ttu-id="496a9-308">Hämtar hello redundans-konfiguration</span><span class="sxs-lookup"><span data-stu-id="496a9-308">Retrieves hello failover group configuration</span></span> |
| [<span data-ttu-id="496a9-309">Ange AzureRmSqlDatabaseFailoverGroup</span><span class="sxs-lookup"><span data-stu-id="496a9-309">Set-AzureRmSqlDatabaseFailoverGroup</span></span>](/powershell/module/azurerm.sql/set-azurermsqldatabasefailovergroup) |   <span data-ttu-id="496a9-310">Ändrar hello konfigurationen av hello redundansväxlingsgrupp</span><span class="sxs-lookup"><span data-stu-id="496a9-310">Modifies hello configuration of hello failover group</span></span> |
| [<span data-ttu-id="496a9-311">Växeln-AzureRMSqlDatabaseFailoverGroup</span><span class="sxs-lookup"><span data-stu-id="496a9-311">Switch-AzureRMSqlDatabaseFailoverGroup</span></span>](/powershell/module/azurerm.sql/switch-azurermsqldatabasefailovergroup) | <span data-ttu-id="496a9-312">Utlösare redundans för hello redundans grupp toohello sekundär server</span><span class="sxs-lookup"><span data-stu-id="496a9-312">Triggers failover of hello failover group toohello secondary server</span></span> |
|  | |

> [!IMPORTANT]
> <span data-ttu-id="496a9-313">Exempel på skript, se [konfigurera och redundans en enskild databas som använder aktiv geo-replikering](scripts/sql-database-setup-geodr-and-failover-database-powershell.md), [konfigurera och redundans en delad databas som använder aktiv geo-replikering](scripts/sql-database-setup-geodr-and-failover-pool-powershell.md), och [konfigurera och redundans en redundansväxlingsgrupp för en enskild databas (förhandsgranskning)] (skript/sql-database-setup-geodr-failover-database-failover-group-powershell.md.</span><span class="sxs-lookup"><span data-stu-id="496a9-313">For sample scripts, see [Configure and failover a single database using active geo-replication](scripts/sql-database-setup-geodr-and-failover-database-powershell.md), [Configure and failover a pooled database using active geo-replication](scripts/sql-database-setup-geodr-and-failover-pool-powershell.md), and  [Configure and failover a failover group for a single database (preview)](scripts/sql-database-setup-geodr-failover-database-failover-group-powershell.md.</span></span>
>

## <a name="manage-sql-database-failover-using-hello-rest-api"></a><span data-ttu-id="496a9-314">Hantera SQL-databas redundans med hello REST API</span><span class="sxs-lookup"><span data-stu-id="496a9-314">Manage SQL database failover using hello REST API</span></span>
| <span data-ttu-id="496a9-315">API</span><span class="sxs-lookup"><span data-stu-id="496a9-315">API</span></span> | <span data-ttu-id="496a9-316">Beskrivning</span><span class="sxs-lookup"><span data-stu-id="496a9-316">Description</span></span> |
| --- | --- |
| [<span data-ttu-id="496a9-317">Skapa eller uppdatera databasen (createMode = återställer)</span><span class="sxs-lookup"><span data-stu-id="496a9-317">Create or Update Database (createMode=Restore)</span></span>](/rest/api/sql/Databases/CreateOrUpdate) |<span data-ttu-id="496a9-318">Skapar, uppdaterar eller återställer en primär eller sekundär databas.</span><span class="sxs-lookup"><span data-stu-id="496a9-318">Creates, updates, or restores a primary or a secondary database.</span></span> |
| [<span data-ttu-id="496a9-319">Hämta skapa eller uppdatera databasens Status</span><span class="sxs-lookup"><span data-stu-id="496a9-319">Get Create or Update Database Status</span></span>](/rest/api/sql/Databases/CreateOrUpdate) |<span data-ttu-id="496a9-320">Returnerar hello status under en Skapa-åtgärd.</span><span class="sxs-lookup"><span data-stu-id="496a9-320">Returns hello status during a create operation.</span></span> |
| [<span data-ttu-id="496a9-321">Ange Sekundär databasen som primär (planerad redundans)</span><span class="sxs-lookup"><span data-stu-id="496a9-321">Set Secondary Database as Primary (Planned Failover)</span></span>](https://docs.microsoft.com/rest/api/sql/replicationlinkss#ReplicationLinks_Failover) |<span data-ttu-id="496a9-322">Anger vilka replikdatabasen är primär av misslyckande från hello aktuella primära replikdatabasen.</span><span class="sxs-lookup"><span data-stu-id="496a9-322">Sets which replica database is primary by failing over from hello current primary replica database.</span></span> |
| [<span data-ttu-id="496a9-323">Ange Sekundär databasen som primär (oplanerad växling vid fel)</span><span class="sxs-lookup"><span data-stu-id="496a9-323">Set Secondary Database as Primary (Unplanned Failover)</span></span>](https://docs.microsoft.com/rest/api/sql/replicationlinks#ReplicationLinks_FailoverAllowDataLoss) |<span data-ttu-id="496a9-324">Anger vilka replikdatabasen är primär av misslyckande från hello aktuella primära replikdatabasen.</span><span class="sxs-lookup"><span data-stu-id="496a9-324">Sets which replica database is primary by failing over from hello current primary replica database.</span></span> <span data-ttu-id="496a9-325">Den här åtgärden kan resultera i förlust av data.</span><span class="sxs-lookup"><span data-stu-id="496a9-325">This operation might result in data loss.</span></span> |
| [<span data-ttu-id="496a9-326">Hämta replikeringslänk</span><span class="sxs-lookup"><span data-stu-id="496a9-326">Get Replication Link</span></span>](/rest/api/sql/replicationlinks/get) |<span data-ttu-id="496a9-327">Hämtar en specifik replikeringslänk för en angiven SQL-databas i ett partnerskap geo-replikering.</span><span class="sxs-lookup"><span data-stu-id="496a9-327">Gets a specific replication link for a given SQL database in a geo-replication partnership.</span></span> <span data-ttu-id="496a9-328">Den hämtar hello information visas i vyn för hello sys.geo_replication_links katalog.</span><span class="sxs-lookup"><span data-stu-id="496a9-328">It retrieves hello information visible in hello sys.geo_replication_links catalog view.</span></span> |
| [<span data-ttu-id="496a9-329">Replikeringslänkar - lista av databasen</span><span class="sxs-lookup"><span data-stu-id="496a9-329">Replication Links - List By Database</span></span>](/rest/api/sql/replicationlinks/listbydatabase) | <span data-ttu-id="496a9-330">Hämtar alla länkar för databasreplikering för en angiven SQL-databas i ett partnerskap geo-replikering.</span><span class="sxs-lookup"><span data-stu-id="496a9-330">Gets all replication links for a given SQL database in a geo-replication partnership.</span></span> <span data-ttu-id="496a9-331">Den hämtar hello information visas i vyn för hello sys.geo_replication_links katalog.</span><span class="sxs-lookup"><span data-stu-id="496a9-331">It retrieves hello information visible in hello sys.geo_replication_links catalog view.</span></span> |
| [<span data-ttu-id="496a9-332">Ta bort länk för Platsdatareplikering</span><span class="sxs-lookup"><span data-stu-id="496a9-332">Delete Replication Link</span></span>](/rest/api/sql/databases/delete) | <span data-ttu-id="496a9-333">Tar bort en databasreplikeringslänk.</span><span class="sxs-lookup"><span data-stu-id="496a9-333">Deletes a database replication link.</span></span> <span data-ttu-id="496a9-334">Kan inte utföras under växling vid fel.</span><span class="sxs-lookup"><span data-stu-id="496a9-334">Cannot be done during failover.</span></span> |
| <span data-ttu-id="496a9-335">[Skapa eller uppdatera redundans grupp] / rest/api/sql/failovergroups/createorupdate)</span><span class="sxs-lookup"><span data-stu-id="496a9-335">[Create or Update Failover Group]/rest/api/sql/failovergroups/createorupdate)</span></span> | <span data-ttu-id="496a9-336">Skapar eller uppdaterar en redundansväxlingsgrupp</span><span class="sxs-lookup"><span data-stu-id="496a9-336">Creates or updates a failover group</span></span> |
| [<span data-ttu-id="496a9-337">Ta bort redundans grupp</span><span class="sxs-lookup"><span data-stu-id="496a9-337">Delete Failover Group</span></span>](/rest/api/sql/failovergroups/delete) | <span data-ttu-id="496a9-338">Tar bort hello redundansväxlingsgrupp från hello-server</span><span class="sxs-lookup"><span data-stu-id="496a9-338">Removes hello failover group from hello server</span></span> |
| [<span data-ttu-id="496a9-339">Växling vid fel (planerad)</span><span class="sxs-lookup"><span data-stu-id="496a9-339">Failover (Planned)</span></span>](/rest/api/sql/failovergroups/failover) | <span data-ttu-id="496a9-340">Flyttas över från hello aktuella primära toothis server.</span><span class="sxs-lookup"><span data-stu-id="496a9-340">Fails over from hello current primary server toothis server.</span></span> |
| [<span data-ttu-id="496a9-341">Påtvingad redundans tillåta förlust av Data</span><span class="sxs-lookup"><span data-stu-id="496a9-341">Force Failover Allow Data Loss</span></span>](/rest/api/sql/failovergroups/forcefailoverallowdataloss) |<span data-ttu-id="496a9-342">ails över från hello aktuella primära toothis server.</span><span class="sxs-lookup"><span data-stu-id="496a9-342">ails over from hello current primary server toothis server.</span></span> <span data-ttu-id="496a9-343">Den här åtgärden kan resultera i förlust av data.</span><span class="sxs-lookup"><span data-stu-id="496a9-343">This operation might result in data loss.</span></span> |
| [<span data-ttu-id="496a9-344">Get redundans grupp</span><span class="sxs-lookup"><span data-stu-id="496a9-344">Get Failover Group</span></span>](/rest/api/sql/failovergroups/get) | <span data-ttu-id="496a9-345">Hämtar en redundansväxlingsgrupp.</span><span class="sxs-lookup"><span data-stu-id="496a9-345">Gets a failover group.</span></span> |
| [<span data-ttu-id="496a9-346">Lista redundans grupper av servern</span><span class="sxs-lookup"><span data-stu-id="496a9-346">List Failover Groups By Server</span></span>](/rest/api/sql/failovergroups/listbyserver) | <span data-ttu-id="496a9-347">Visar hello redundans grupper i en server.</span><span class="sxs-lookup"><span data-stu-id="496a9-347">Lists hello failover groups in a server.</span></span> |
| [<span data-ttu-id="496a9-348">Uppdatera grupp om växling vid fel</span><span class="sxs-lookup"><span data-stu-id="496a9-348">Update Failover Group</span></span>](/rest/api/sql/failovergroups/update) | <span data-ttu-id="496a9-349">Uppdaterar en redundansväxlingsgrupp.</span><span class="sxs-lookup"><span data-stu-id="496a9-349">Updates a failover group.</span></span> |
|  | |

## <a name="next-steps"></a><span data-ttu-id="496a9-350">Nästa steg</span><span class="sxs-lookup"><span data-stu-id="496a9-350">Next steps</span></span>
* <span data-ttu-id="496a9-351">För exempel på skript, se:</span><span class="sxs-lookup"><span data-stu-id="496a9-351">For sample scripts, see:</span></span>
   - [<span data-ttu-id="496a9-352">Konfigurera och redundans en enskild databas som använder aktiv geo-replikering</span><span class="sxs-lookup"><span data-stu-id="496a9-352">Configure and failover a single database using active geo-replication</span></span>](scripts/sql-database-setup-geodr-and-failover-database-powershell.md)
   - [<span data-ttu-id="496a9-353">Konfigurera och redundans en delad databas som använder aktiv geo-replikering</span><span class="sxs-lookup"><span data-stu-id="496a9-353">Configure and failover a pooled database using active geo-replication</span></span>](scripts/sql-database-setup-geodr-and-failover-pool-powershell.md)
   - [<span data-ttu-id="496a9-354">Konfigurera och redundans en växling vid fel grupp för en enskild databas (förhandsgranskning)</span><span class="sxs-lookup"><span data-stu-id="496a9-354">Configure and failover a failover group for a single database (preview)</span></span>](scripts/sql-database-setup-geodr-failover-database-failover-group-powershell.md)
* <span data-ttu-id="496a9-355">En översikt över verksamhetskontinuitet och scenarier finns [översikt över verksamhetskontinuitet](sql-database-business-continuity.md)</span><span class="sxs-lookup"><span data-stu-id="496a9-355">For a business continuity overview and scenarios, see [Business continuity overview](sql-database-business-continuity.md)</span></span>
* <span data-ttu-id="496a9-356">toolearn om Azure SQL Database automatisk säkerhetskopiering finns [SQL-databas automatisk säkerhetskopiering](sql-database-automated-backups.md).</span><span class="sxs-lookup"><span data-stu-id="496a9-356">toolearn about Azure SQL Database automated backups, see [SQL Database automated backups](sql-database-automated-backups.md).</span></span>
* <span data-ttu-id="496a9-357">toolearn om hur du använder automatisk säkerhetskopiering för återställning, se [återställa en databas från hello service-initierad säkerhetskopiering](sql-database-recovery-using-backups.md).</span><span class="sxs-lookup"><span data-stu-id="496a9-357">toolearn about using automated backups for recovery, see [Restore a database from hello service-initiated backups](sql-database-recovery-using-backups.md).</span></span>
* <span data-ttu-id="496a9-358">toolearn om autentiseringskraven för nya primära servern och databasen finns [SQL Database-säkerhet efter katastrofåterställning](sql-database-geo-replication-security-config.md).</span><span class="sxs-lookup"><span data-stu-id="496a9-358">toolearn about authentication requirements for a new primary server and database, see [SQL Database security after disaster recovery](sql-database-geo-replication-security-config.md).</span></span>

