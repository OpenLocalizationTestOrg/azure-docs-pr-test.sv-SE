---
title: "aaaCloud verksamhetskontinuitet - databasåterställning - SQL-databas | Microsoft Docs"
description: "Lär dig hur Azure SQL Database stöder databasåterställning och affärskontinuitet i molnet och hur du kan köra verksamhetskritiska molnprogram."
keywords: "affärskontinuitet, molnaffärskontinuitet, databashaveriberedskap, databasåterställning"
services: sql-database
documentationcenter: 
author: anosov1960
manager: jhubbard
editor: 
ms.assetid: 18e5d3f1-bfe5-4089-b6fd-76988ab29822
ms.service: sql-database
ms.custom: business continuity
ms.devlang: NA
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 05/15/2017
ms.author: sashan
ms.openlocfilehash: c9a6ff86fbbc04ce839a4fca79594b573b71644c
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 10/06/2017
---
# <a name="overview-of-business-continuity-with-azure-sql-database"></a><span data-ttu-id="ecca0-104">Översikt över affärskontinuitet med Azure SQL Database</span><span class="sxs-lookup"><span data-stu-id="ecca0-104">Overview of business continuity with Azure SQL Database</span></span>

<span data-ttu-id="ecca0-105">Den här översikten beskriver hello-funktioner som Azure SQL Database tillhandahåller för affärskontinuitet och haveriberedskap.</span><span class="sxs-lookup"><span data-stu-id="ecca0-105">This overview describes hello capabilities that Azure SQL Database provides for business continuity and disaster recovery.</span></span> <span data-ttu-id="ecca0-106">Läs mer om alternativen och rekommendationer självstudier för att återställa från avbrott som kan leda till dataförlust eller leda till din databas och programmet toobecome som är tillgänglig.</span><span class="sxs-lookup"><span data-stu-id="ecca0-106">Learn about options, recommendations, and tutorials for recovering from disruptive events that could cause data loss or cause your database and application toobecome unavailable.</span></span> <span data-ttu-id="ecca0-107">Lär dig vilka toodo när en användare eller ett program fel påverkar dataintegritet, en Azure-region har ett avbrott eller programmet kräver underhåll.</span><span class="sxs-lookup"><span data-stu-id="ecca0-107">Learn what toodo when a user or application error affects data integrity, an Azure region has an outage, or your application requires maintenance.</span></span>

## <a name="sql-database-features-that-you-can-use-tooprovide-business-continuity"></a><span data-ttu-id="ecca0-108">SQL Database-funktioner som du kan använda tooprovide affärskontinuitet</span><span class="sxs-lookup"><span data-stu-id="ecca0-108">SQL Database features that you can use tooprovide business continuity</span></span>

<span data-ttu-id="ecca0-109">SQL Database tillhandahåller flera funktioner för affärskontinuitet, inklusive automatiserade säkerhetskopieringar och valfri databasreplikering.</span><span class="sxs-lookup"><span data-stu-id="ecca0-109">SQL Database provides several business continuity features, including automated backups and optional database replication.</span></span> <span data-ttu-id="ecca0-110">Den uppskattade återställningstiden (ERT) och den potentiella dataförlusten för de senaste transaktionerna skiljer sig mellan de olika metoderna.</span><span class="sxs-lookup"><span data-stu-id="ecca0-110">Each has different characteristics for estimated recovery time (ERT) and potential data loss for recent transactions.</span></span> <span data-ttu-id="ecca0-111">Om du förstår de olika alternativen blir det enklare att välja mellan dem, och i de flesta fall kan du använda dem tillsammans för olika scenarier.</span><span class="sxs-lookup"><span data-stu-id="ecca0-111">Once you understand these options, you can choose among them - and, in most scenarios, use them together for different scenarios.</span></span> <span data-ttu-id="ecca0-112">När du utvecklar en kontinuitetsplan måste toounderstand hello maximal acceptabel tid innan programmet hello fullständigt återställer efter hello störning – det här är din recovery tid mål för Återställningstid.</span><span class="sxs-lookup"><span data-stu-id="ecca0-112">As you develop your business continuity plan, you need toounderstand hello maximum acceptable time before hello application fully recovers after hello disruptive event - this is your recovery time objective (RTO).</span></span> <span data-ttu-id="ecca0-113">Du måste också toounderstand hello maximal mängd senaste uppdateringar (tidsintervall) hello program kan tolerera förlora när du återställer efter hello störning – det här är ditt mål för återställningspunkt (RPO).</span><span class="sxs-lookup"><span data-stu-id="ecca0-113">You also need toounderstand hello maximum amount of recent data updates (time interval) hello application can tolerate losing when recovering after hello disruptive event - this is your recovery point objective (RPO).</span></span>

<span data-ttu-id="ecca0-114">följande tabell jämför hello hello infoga och Återställningspunktmål för hello tre vanligaste scenarierna.</span><span class="sxs-lookup"><span data-stu-id="ecca0-114">hello following table compares hello ERT and RPO for hello three most common scenarios.</span></span>

| <span data-ttu-id="ecca0-115">Funktion</span><span class="sxs-lookup"><span data-stu-id="ecca0-115">Capability</span></span> | <span data-ttu-id="ecca0-116">Basic-nivå</span><span class="sxs-lookup"><span data-stu-id="ecca0-116">Basic tier</span></span> | <span data-ttu-id="ecca0-117">Standard-nivå</span><span class="sxs-lookup"><span data-stu-id="ecca0-117">Standard tier</span></span> | <span data-ttu-id="ecca0-118">Premiumnivå</span><span class="sxs-lookup"><span data-stu-id="ecca0-118">Premium tier</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="ecca0-119">Återställning till tidpunkt från säkerhetskopia</span><span class="sxs-lookup"><span data-stu-id="ecca0-119">Point in Time Restore from backup</span></span> |<span data-ttu-id="ecca0-120">En återställningspunkt inom 7 dagar</span><span class="sxs-lookup"><span data-stu-id="ecca0-120">Any restore point within 7 days</span></span> |<span data-ttu-id="ecca0-121">En återställningspunkt inom 35 dagar</span><span class="sxs-lookup"><span data-stu-id="ecca0-121">Any restore point within 35 days</span></span> |<span data-ttu-id="ecca0-122">En återställningspunkt inom 35 dagar</span><span class="sxs-lookup"><span data-stu-id="ecca0-122">Any restore point within 35 days</span></span> |
| <span data-ttu-id="ecca0-123">GEO-återställning från säkerhetskopior georeplikerad</span><span class="sxs-lookup"><span data-stu-id="ecca0-123">Geo-restore from geo-replicated backups</span></span> |<span data-ttu-id="ecca0-124">ERT < 12 timme, RPO < 1 timme</span><span class="sxs-lookup"><span data-stu-id="ecca0-124">ERT < 12h, RPO < 1h</span></span> |<span data-ttu-id="ecca0-125">ERT < 12 timme, RPO < 1 timme</span><span class="sxs-lookup"><span data-stu-id="ecca0-125">ERT < 12h, RPO < 1h</span></span> |<span data-ttu-id="ecca0-126">ERT < 12 timme, RPO < 1 timme</span><span class="sxs-lookup"><span data-stu-id="ecca0-126">ERT < 12h, RPO < 1h</span></span> |
| <span data-ttu-id="ecca0-127">Återställning från Azure Backup Vault</span><span class="sxs-lookup"><span data-stu-id="ecca0-127">Restore from Azure Backup Vault</span></span> |<span data-ttu-id="ecca0-128">ERT < 12 timme, RPO < 1 vecka</span><span class="sxs-lookup"><span data-stu-id="ecca0-128">ERT < 12h, RPO < 1 wk</span></span> |<span data-ttu-id="ecca0-129">ERT < 12 timme, RPO < 1 vecka</span><span class="sxs-lookup"><span data-stu-id="ecca0-129">ERT < 12h, RPO < 1 wk</span></span> |<span data-ttu-id="ecca0-130">ERT < 12 timme, RPO < 1 vecka</span><span class="sxs-lookup"><span data-stu-id="ecca0-130">ERT < 12h, RPO < 1 wk</span></span> |
| <span data-ttu-id="ecca0-131">Aktiv geo-replikering</span><span class="sxs-lookup"><span data-stu-id="ecca0-131">Active geo-replication</span></span> |<span data-ttu-id="ecca0-132">ERT < 30 sekunder, RPO < 5 sekunder</span><span class="sxs-lookup"><span data-stu-id="ecca0-132">ERT < 30s, RPO < 5s</span></span> |<span data-ttu-id="ecca0-133">ERT < 30 sekunder, RPO < 5 sekunder</span><span class="sxs-lookup"><span data-stu-id="ecca0-133">ERT < 30s, RPO < 5s</span></span> |<span data-ttu-id="ecca0-134">ERT < 30 sekunder, RPO < 5 sekunder</span><span class="sxs-lookup"><span data-stu-id="ecca0-134">ERT < 30s, RPO < 5s</span></span> |

### <a name="use-database-backups-toorecover-a-database"></a><span data-ttu-id="ecca0-135">Använd databas säkerhetskopieringar toorecover en databas</span><span class="sxs-lookup"><span data-stu-id="ecca0-135">Use database backups toorecover a database</span></span>

<span data-ttu-id="ecca0-136">SQL-databas utförs automatiskt en kombination av fullständiga databassäkerhetskopieringar varje vecka, varje timme differentiella säkerhetskopieringar och transaktionen loggsäkerhetskopior var femte-tio minuter tooprotect din verksamhet från förlust av data.</span><span class="sxs-lookup"><span data-stu-id="ecca0-136">SQL Database automatically performs a combination of full database backups weekly, differential database backups hourly, and transaction log backups every five - ten minutes tooprotect your business from data loss.</span></span> <span data-ttu-id="ecca0-137">Dessa säkerhetskopior lagras i geo-redundant lagring för 35 dagar för databaser i hello Standard och Premium tjänstnivåer och 7 dagar för databaser i hello grundläggande tjänstnivån.</span><span class="sxs-lookup"><span data-stu-id="ecca0-137">These backups are stored in geo-redundant storage for 35 days for databases in hello Standard and Premium service tiers and 7 days for databases in hello Basic service tier.</span></span> <span data-ttu-id="ecca0-138">Mer information finns i [tjänstnivåer](sql-database-service-tiers.md).</span><span class="sxs-lookup"><span data-stu-id="ecca0-138">For more information, see [service tiers](sql-database-service-tiers.md).</span></span> <span data-ttu-id="ecca0-139">Om hello kvarhållningsperiod för din tjänstnivån inte uppfyller företagets krav, kan du öka hello kvarhållningsperiod av [ändra hello tjänstnivån](sql-database-service-tiers.md).</span><span class="sxs-lookup"><span data-stu-id="ecca0-139">If hello retention period for your service tier does not meet your business requirements, you can increase hello retention period by [changing hello service tier](sql-database-service-tiers.md).</span></span> <span data-ttu-id="ecca0-140">hello databas för fullständig och differentiell säkerhetskopiering är också replikerade tooa [parad Datacenter](../best-practices-availability-paired-regions.md) för skydd mot ett avbrott för data center.</span><span class="sxs-lookup"><span data-stu-id="ecca0-140">hello full and differential database backups are also replicated tooa [paired data center](../best-practices-availability-paired-regions.md) for protection against a data center outage.</span></span> <span data-ttu-id="ecca0-141">Mer information finns i [automatiska säkerhetskopieringar](sql-database-automated-backups.md).</span><span class="sxs-lookup"><span data-stu-id="ecca0-141">For more information, see [automatic database backups](sql-database-automated-backups.md).</span></span>

<span data-ttu-id="ecca0-142">Om hello inbyggda kvarhållningsperiod inte är tillräcklig för ditt program, kan du utöka den genom att konfigurera databasen långsiktiga bevarandeprincip.</span><span class="sxs-lookup"><span data-stu-id="ecca0-142">If hello built-in retention period is not sufficient for your application, you can extend it by configuring a database long-term retention policy.</span></span> <span data-ttu-id="ecca0-143">Mer information finns i [långsiktig kvarhållning](sql-database-long-term-retention.md).</span><span class="sxs-lookup"><span data-stu-id="ecca0-143">For more information, see [long-term retention](sql-database-long-term-retention.md).</span></span>

<span data-ttu-id="ecca0-144">Du kan använda dessa automatiska databasen säkerhetskopieringar toorecover en databas från olika störande händelser, både i ditt datacenter och tooanother datacenter.</span><span class="sxs-lookup"><span data-stu-id="ecca0-144">You can use these automatic database backups toorecover a database from various disruptive events, both within your data center and tooanother data center.</span></span> <span data-ttu-id="ecca0-145">Använda automatiska säkerhetskopieringar hello uppskattade tiden för återställning är beroende av flera faktorer, inklusive hello antalet databaser som återställer hello samma region på hello samma tidpunkt hello databasens storlek hello transaktion loggfilens storlek och nätverkets bandbredd.</span><span class="sxs-lookup"><span data-stu-id="ecca0-145">Using automatic database backups, hello estimated time of recovery depends on several factors including hello total number of databases recovering in hello same region at hello same time, hello database size, hello transaction log size, and network bandwidth.</span></span> <span data-ttu-id="ecca0-146">hello återställningstid är vanligtvis mindre än 12 timmar.</span><span class="sxs-lookup"><span data-stu-id="ecca0-146">hello recovery time is usually less than 12 hours.</span></span> <span data-ttu-id="ecca0-147">När du återställer tooanother dataområdet är hello potentiell dataförlust begränsad too1 timme av hello geo-redundant lagring av varje timme differentiella säkerhetskopieringar.</span><span class="sxs-lookup"><span data-stu-id="ecca0-147">When recovering tooanother data region, hello potential data loss is limited too1 hour by hello geo-redundant storage of hourly differential database backups.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="ecca0-148">toorecover med hjälp av automatisk säkerhetskopiering måste du vara medlem i hello SQL Server deltagarrollen eller hello prenumerationsägaren - Se [RBAC: inbyggda roller](../active-directory/role-based-access-built-in-roles.md).</span><span class="sxs-lookup"><span data-stu-id="ecca0-148">toorecover using automated backups, you must be a member of hello SQL Server Contributor role or hello subscription owner - see [RBAC: Built-in roles](../active-directory/role-based-access-built-in-roles.md).</span></span> <span data-ttu-id="ecca0-149">Du kan återställa med hello Azure-portalen, PowerShell eller hello REST API.</span><span class="sxs-lookup"><span data-stu-id="ecca0-149">You can recover using hello Azure portal, PowerShell, or hello REST API.</span></span> <span data-ttu-id="ecca0-150">Du kan inte använda Transact-SQL.</span><span class="sxs-lookup"><span data-stu-id="ecca0-150">You cannot use Transact-SQL.</span></span>
>

<span data-ttu-id="ecca0-151">Använd automatiska säkerhetskopieringar som din affärskontinuitets- och återställningsmetod om ditt program:</span><span class="sxs-lookup"><span data-stu-id="ecca0-151">Use automated backups as your business continuity and recovery mechanism if your application:</span></span>

* <span data-ttu-id="ecca0-152">Inte betraktas som verksamhetskritiskt.</span><span class="sxs-lookup"><span data-stu-id="ecca0-152">Is not considered mission critical.</span></span>
* <span data-ttu-id="ecca0-153">Har en bindning SLA - ett driftstopp på 24 timmar eller resulterar längre inte i finansiella ansvar.</span><span class="sxs-lookup"><span data-stu-id="ecca0-153">Doesn't have a binding SLA - a downtime of 24 hours or longer does not result in financial liability.</span></span>
* <span data-ttu-id="ecca0-154">Har ett lågt värde för data ändras (låg transaktioner per timme) och att förlora in tooan timmes ändringen är en godkänd dataförlust.</span><span class="sxs-lookup"><span data-stu-id="ecca0-154">Has a low rate of data change (low transactions per hour) and losing up tooan hour of change is an acceptable data loss.</span></span>
* <span data-ttu-id="ecca0-155">Är kostnadskänsligt.</span><span class="sxs-lookup"><span data-stu-id="ecca0-155">Is cost sensitive.</span></span>

<span data-ttu-id="ecca0-156">Om du behöver snabbare återställning använder [aktiv geo-replikering](sql-database-geo-replication-overview.md) (beskrivs nedan).</span><span class="sxs-lookup"><span data-stu-id="ecca0-156">If you need faster recovery, use [active geo-replication](sql-database-geo-replication-overview.md) (discussed next).</span></span> <span data-ttu-id="ecca0-157">Om du behöver toobe kan toorecover data från en period som är äldre än 35 dagar använda [långsiktig lagring av säkerhetskopior](sql-database-long-term-retention.md).</span><span class="sxs-lookup"><span data-stu-id="ecca0-157">If you need toobe able toorecover data from a period older than 35 days, use [long-term backup retention](sql-database-long-term-retention.md).</span></span> 

### <a name="use-active-geo-replication-and-auto-failover-groups-in-preview-tooreduce-recovery-time-and-limit-data-loss-associated-with-a-recovery"></a><span data-ttu-id="ecca0-158">Använd aktiv geo-replikering och automatisk redundans grupper (i förhandsversion) tooreduce recovery tid och gränsen förlust av data som är associerade med en återställning</span><span class="sxs-lookup"><span data-stu-id="ecca0-158">Use active geo-replication and auto-failover groups (in-preview) tooreduce recovery time and limit data loss associated with a recovery</span></span>

<span data-ttu-id="ecca0-159">Dessutom toousing säkerhetskopieringar för återställning av databas om ett företag avbrott inträffar kan du använda [aktiv geo-replikering](sql-database-geo-replication-overview.md) tooconfigure en databas toohave av toofour läsbara sekundära databaser i hello områden av din val av.</span><span class="sxs-lookup"><span data-stu-id="ecca0-159">In addition toousing database backups for database recovery if a business disruption occurs, you can use [active geo-replication](sql-database-geo-replication-overview.md) tooconfigure a database toohave up toofour readable secondary databases in hello regions of your choice.</span></span> <span data-ttu-id="ecca0-160">Dessa sekundära databaser hålls synkroniserade med hello primära databasen med hjälp av en mekanism för asynkron replikering.</span><span class="sxs-lookup"><span data-stu-id="ecca0-160">These secondary databases are kept synchronized with hello primary database using an asynchronous replication mechanism.</span></span> <span data-ttu-id="ecca0-161">Den här funktionen är används tooprotect mot avbrott i verksamheten om en data center strömavbrott eller under en uppgradering av programmet.</span><span class="sxs-lookup"><span data-stu-id="ecca0-161">This feature is used tooprotect against business disruption if a data center outage occurs or during an application upgrade.</span></span> <span data-ttu-id="ecca0-162">Aktiv geo-replikering kan också vara används tooprovide bättre frågeprestanda för skrivskyddade frågor toogeographically spridda användare.</span><span class="sxs-lookup"><span data-stu-id="ecca0-162">Active geo-replication can also be used tooprovide better query performance for read-only queries toogeographically dispersed users.</span></span>

<span data-ttu-id="ecca0-163">tooenable automatiskt och transparent redundans du organisera dina geo-replikerade databaser i grupper med hello [automatisk redundans grupp](sql-database-geo-replication-overview.md) funktion i SQL-databas (i förhandsversion).</span><span class="sxs-lookup"><span data-stu-id="ecca0-163">tooenable automated and transparent failover you should organize your geo-replicated databases into groups using hello [auto-failover group](sql-database-geo-replication-overview.md) feature of SQL Database (in-preview).</span></span>

<span data-ttu-id="ecca0-164">Om hello primära databasen försätts offline oväntat eller tootake måste det offline för underhållsaktiviteter du kan snabbt befordra en sekundär toobecome hello primär (kallas även en växling vid fel) och konfigurera program tooconnect toohello upphöja primär.</span><span class="sxs-lookup"><span data-stu-id="ecca0-164">If hello primary database goes offline unexpectedly or you need tootake it offline for maintenance activities, you can quickly promote a secondary toobecome hello primary (also called a failover) and configure applications tooconnect toohello promoted primary.</span></span> <span data-ttu-id="ecca0-165">Om programmet ansluter toohello databaser med hjälp av hello redundans lyssnare, behöver du inte toochange hello SQL-sträng anslutningskonfiguration efter växling vid fel.</span><span class="sxs-lookup"><span data-stu-id="ecca0-165">If your application is connecting toohello databases using hello failover group listener, you don’t need toochange hello SQL connection string configuration after failover.</span></span> <span data-ttu-id="ecca0-166">Vid en planerad redundansväxling förekommer ingen dataförlust.</span><span class="sxs-lookup"><span data-stu-id="ecca0-166">With a planned failover, there is no data loss.</span></span> <span data-ttu-id="ecca0-167">Med en oplanerad redundans kan det finnas en liten mängd dataförlust för mycket färsk transaktioner på grund av toohello karaktär av asynkron replikering.</span><span class="sxs-lookup"><span data-stu-id="ecca0-167">With an unplanned failover, there may be some small amount of data loss for very recent transactions due toohello nature of asynchronous replication.</span></span> <span data-ttu-id="ecca0-168">Med automatisk redundans grupper (i förhandsversion) kan anpassa du hello redundans princip toominimize hello potentiell dataförlust.</span><span class="sxs-lookup"><span data-stu-id="ecca0-168">Using auto-failover groups (in-preview), you can customize hello failover policy toominimize hello potential data loss.</span></span> <span data-ttu-id="ecca0-169">Efter en redundansväxling kan du senare återställa - bl.a tooa plan eller när hello Datacenter är online igen.</span><span class="sxs-lookup"><span data-stu-id="ecca0-169">After a failover, you can later failback - either according tooa plan or when hello data center comes back online.</span></span> <span data-ttu-id="ecca0-170">I samtliga fall måste användarna uppleva en liten mängd driftstopp och måste tooreconnect.</span><span class="sxs-lookup"><span data-stu-id="ecca0-170">In all cases, users experience a small amount of downtime and need tooreconnect.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="ecca0-171">toouse aktiv geo-replikering och automatisk redundans grupper (i förhandsversion), du måste antingen vara hello prenumerationsägaren eller har administrativ behörighet i SQL Server.</span><span class="sxs-lookup"><span data-stu-id="ecca0-171">toouse active geo-replication and auto-failover groups (in-preview), you must either be hello subscription owner or have administrative permissions in SQL Server.</span></span> <span data-ttu-id="ecca0-172">Du kan konfigurera och växla över med hello Azure-portalen PowerShell eller hello REST-API med hjälp av Azure-Prenumerationsbehörigheter eller Transact-SQL med SQL Server-behörighet.</span><span class="sxs-lookup"><span data-stu-id="ecca0-172">You can configure and fail over using hello Azure portal, PowerShell, or hello REST API using Azure subscription permissions or using Transact-SQL with SQL Server permissions.</span></span>
> 

<span data-ttu-id="ecca0-173">Använd aktiv geo-replikering och automatisk redundans grupper (under förhandsgranskning) om appen uppfyller någon av dessa villkor:</span><span class="sxs-lookup"><span data-stu-id="ecca0-173">Use active geo-replication and auto-failover groups (in preview) if your application meets any of these criteria:</span></span>

* <span data-ttu-id="ecca0-174">Är verksamhetskritiskt.</span><span class="sxs-lookup"><span data-stu-id="ecca0-174">Is mission critical.</span></span>
* <span data-ttu-id="ecca0-175">Har ett serviceavtal (SLA) som inte tillåter driftavbrott på 24 timmar eller mer.</span><span class="sxs-lookup"><span data-stu-id="ecca0-175">Has a service level agreement (SLA) that does not allow for 24 hours or more of downtime.</span></span>
* <span data-ttu-id="ecca0-176">Driftstopp kan resultera i finansiella ansvar.</span><span class="sxs-lookup"><span data-stu-id="ecca0-176">Downtime may result in financial liability.</span></span>
* <span data-ttu-id="ecca0-177">Har en hög frekvens av dataändringar och en timmes dataförlust är inte acceptabelt.</span><span class="sxs-lookup"><span data-stu-id="ecca0-177">Has a high rate of data change is high and losing an hour of data is not acceptable.</span></span>
* <span data-ttu-id="ecca0-178">hello extra kostnad för aktiv geo-replikering är lägre än hello potentiella ekonomiska ansvar och associerade förlust av affärsinformation.</span><span class="sxs-lookup"><span data-stu-id="ecca0-178">hello additional cost of active geo-replication is lower than hello potential financial liability and associated loss of business.</span></span>

>
> [!VIDEO https://channel9.msdn.com/Blogs/Azure/Azure-SQL-Database-protecting-important-DBs-from-regional-disasters-is-easy/player]
>

## <a name="recover-a-database-after-a-user-or-application-error"></a><span data-ttu-id="ecca0-179">Återställa en databas efter ett användar- eller programfel</span><span class="sxs-lookup"><span data-stu-id="ecca0-179">Recover a database after a user or application error</span></span>
<span data-ttu-id="ecca0-180">* Ingen är perfekt!</span><span class="sxs-lookup"><span data-stu-id="ecca0-180">*No one is perfect!</span></span> <span data-ttu-id="ecca0-181">En användare kan oavsiktligt ta bort vissa data eller av misstag radera en viktig tabell eller till och med en hel databas.</span><span class="sxs-lookup"><span data-stu-id="ecca0-181">A user might accidentally delete some data, inadvertently drop an important table, or even drop an entire database.</span></span> <span data-ttu-id="ecca0-182">Eller ett program av misstag kan skriva över bra data med felaktiga data på grund av fel i tooan program.</span><span class="sxs-lookup"><span data-stu-id="ecca0-182">Or, an application might accidentally overwrite good data with bad data due tooan application defect.</span></span>

<span data-ttu-id="ecca0-183">I det här scenariot har du följande återställningsalternativ.</span><span class="sxs-lookup"><span data-stu-id="ecca0-183">In this scenario, these are your recovery options.</span></span>

### <a name="perform-a-point-in-time-restore"></a><span data-ttu-id="ecca0-184">Utföra en återställning till en viss tidpunkt</span><span class="sxs-lookup"><span data-stu-id="ecca0-184">Perform a point-in-time restore</span></span>
<span data-ttu-id="ecca0-185">Du kan använda hello automatisk säkerhetskopiering toorecover en kopia av din databas tooa känd bra punkt i tiden, förutsatt att tiden är inom kvarhållningsperioden för hello databasen.</span><span class="sxs-lookup"><span data-stu-id="ecca0-185">You can use hello automated backups toorecover a copy of your database tooa known good point in time, provided that time is within hello database retention period.</span></span> <span data-ttu-id="ecca0-186">När hello databasen återställs kan du ersätta hello originaldatabasen med hello återställs databasen eller kopiera hello behövs data från hello återställa data till hello originaldatabasen.</span><span class="sxs-lookup"><span data-stu-id="ecca0-186">After hello database is restored, you can either replace hello original database with hello restored database or copy hello needed data from hello restored data into hello original database.</span></span> <span data-ttu-id="ecca0-187">Om hello databasen använder aktiv geo-replikering, rekommenderar vi kopiera hello krävs data från hello återställts kopierar till hello originaldatabasen.</span><span class="sxs-lookup"><span data-stu-id="ecca0-187">If hello database uses active geo-replication, we recommend copying hello required data from hello restored copy into hello original database.</span></span> <span data-ttu-id="ecca0-188">Om du ersätter hello originaldatabasen med hello återställs databasen behöver tooreconfigure och synkronisera om aktiv geo-replikering (vilket kan ta tid för en stor databas).</span><span class="sxs-lookup"><span data-stu-id="ecca0-188">If you replace hello original database with hello restored database, you need tooreconfigure and resynchronize active geo-replication (which can take quite some time for a large database).</span></span>

<span data-ttu-id="ecca0-189">Mer information och detaljerade anvisningar för att återställa en databas tooa punkt i gång med hjälp av hello Azure-portalen eller med hjälp av PowerShell, se [point-in-time-återställning](sql-database-recovery-using-backups.md#point-in-time-restore).</span><span class="sxs-lookup"><span data-stu-id="ecca0-189">For more information and for detailed steps for restoring a database tooa point in time using hello Azure portal or using PowerShell, see [point-in-time restore](sql-database-recovery-using-backups.md#point-in-time-restore).</span></span> <span data-ttu-id="ecca0-190">Du kan inte återställa med hjälp av Transact-SQL.</span><span class="sxs-lookup"><span data-stu-id="ecca0-190">You cannot recover using Transact-SQL.</span></span>

### <a name="restore-a-deleted-database"></a><span data-ttu-id="ecca0-191">Återställa en borttagen databas</span><span class="sxs-lookup"><span data-stu-id="ecca0-191">Restore a deleted database</span></span>
<span data-ttu-id="ecca0-192">Om hello databasen tas bort men hello logisk server inte har tagits bort, kan du återställa hello bort databasen toohello punkt då den togs bort.</span><span class="sxs-lookup"><span data-stu-id="ecca0-192">If hello database is deleted but hello logical server has not been deleted, you can restore hello deleted database toohello point at which it was deleted.</span></span> <span data-ttu-id="ecca0-193">Detta återställer en databas säkerhetskopiering toohello samma logiska SQLServer som den togs bort.</span><span class="sxs-lookup"><span data-stu-id="ecca0-193">This restores a database backup toohello same logical SQL server from which it was deleted.</span></span> <span data-ttu-id="ecca0-194">Du kan återställa den med hjälp av hello ursprungliga namnet eller ange ett nytt namn eller hello återställa databasen.</span><span class="sxs-lookup"><span data-stu-id="ecca0-194">You can restore it using hello original name or provide a new name or hello restored database.</span></span>

<span data-ttu-id="ecca0-195">Mer information och detaljerade anvisningar för att återställa en borttagen databas med hjälp av hello Azure-portalen eller med hjälp av PowerShell, se [återställa en borttagen databas](sql-database-recovery-using-backups.md#deleted-database-restore).</span><span class="sxs-lookup"><span data-stu-id="ecca0-195">For more information and for detailed steps for restoring a deleted database using hello Azure portal or using PowerShell, see [restore a deleted database](sql-database-recovery-using-backups.md#deleted-database-restore).</span></span> <span data-ttu-id="ecca0-196">Du kan inte återställa med hjälp av Transact-SQL.</span><span class="sxs-lookup"><span data-stu-id="ecca0-196">You cannot restore using Transact-SQL.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="ecca0-197">Du kan inte återställa en borttagen databas om hello logisk server tas bort.</span><span class="sxs-lookup"><span data-stu-id="ecca0-197">If hello logical server is deleted, you cannot recover a deleted database.</span></span>
>
>

### <a name="restore-from-azure-backup-vault"></a><span data-ttu-id="ecca0-198">Återställning från Azure Backup Vault</span><span class="sxs-lookup"><span data-stu-id="ecca0-198">Restore from Azure Backup Vault</span></span>
<span data-ttu-id="ecca0-199">Du kan återställa från en veckovis säkerhetskopiering i Azure-Säkerhetskopieringsvalvet tooa ny databas om hello dataförlust inträffat utanför hello aktuella kvarhållningsperiod för automatisk säkerhetskopiering och databasen har konfigurerats för långsiktig kvarhållning.</span><span class="sxs-lookup"><span data-stu-id="ecca0-199">If hello data loss occurred outside hello current retention period for automated backups and your database is configured for long-term retention, you can restore from a weekly backup in Azure Backup Vault tooa new database.</span></span> <span data-ttu-id="ecca0-200">Nu kan du antingen ersätta hello originaldatabasen med hello återställs databasen eller kopiera hello behövs data från hello återställs databasen till hello originaldatabasen.</span><span class="sxs-lookup"><span data-stu-id="ecca0-200">At this point, you can either replace hello original database with hello restored database or copy hello needed data from hello restored database into hello original database.</span></span> <span data-ttu-id="ecca0-201">Om du behöver tooretrieve en gammal version av databasen tidigare tooa större program uppgraderingen kan uppfylla en begäran från granskare eller en juridiska ordning du kan skapa en databas med en fullständig säkerhetskopia som sparats i hello Azure Backup-valvet.</span><span class="sxs-lookup"><span data-stu-id="ecca0-201">If you need tooretrieve an old version of your database prior tooa major application upgrade, satisfy a request from auditors or a legal order, you can create a database using a full backup saved in hello Azure Backup Vault.</span></span>  <span data-ttu-id="ecca0-202">Mer information finns i avsnittet om [långsiktig kvarhållning](sql-database-long-term-retention.md).</span><span class="sxs-lookup"><span data-stu-id="ecca0-202">For more information, see [Long-term retention](sql-database-long-term-retention.md).</span></span>

## <a name="recover-a-database-tooanother-region-from-an-azure-regional-data-center-outage"></a><span data-ttu-id="ecca0-203">Återställa en databas tooanother region från ett avbrott i Azure regionala data center</span><span class="sxs-lookup"><span data-stu-id="ecca0-203">Recover a database tooanother region from an Azure regional data center outage</span></span>
<!-- Explain this scenario -->

<span data-ttu-id="ecca0-204">Även om det är ovanligt finns risken för ett avbrott på ett Azure-datacenter.</span><span class="sxs-lookup"><span data-stu-id="ecca0-204">Although rare, an Azure data center can have an outage.</span></span> <span data-ttu-id="ecca0-205">När ett avbrott uppstår orsakar det ett verksamhetsavbrott som kan vara några få minuter eller flera timmar.</span><span class="sxs-lookup"><span data-stu-id="ecca0-205">When an outage occurs, it causes a business disruption that might only last a few minutes or might last for hours.</span></span>

* <span data-ttu-id="ecca0-206">Ett alternativ är toowait för din databas toocome online igen när hello data center avbrott är över.</span><span class="sxs-lookup"><span data-stu-id="ecca0-206">One option is toowait for your database toocome back online when hello data center outage is over.</span></span> <span data-ttu-id="ecca0-207">Detta fungerar för program som har råd toohave hello databasen i offlineläge.</span><span class="sxs-lookup"><span data-stu-id="ecca0-207">This works for applications that can afford toohave hello database offline.</span></span> <span data-ttu-id="ecca0-208">Till exempel en utvecklingsprojekt eller kostnadsfri utvärderingsversion behöver du inte toowork på hela tiden.</span><span class="sxs-lookup"><span data-stu-id="ecca0-208">For example, a development project or free trial you don't need toowork on constantly.</span></span> <span data-ttu-id="ecca0-209">När ett datacenter har ett avbrott, vet du inte hur länge kan det senaste hello avbrott, så det här alternativet fungerar bara om du inte behöver databasen för en stund.</span><span class="sxs-lookup"><span data-stu-id="ecca0-209">When a data center has an outage, you do not know how long hello outage might last, so this option only works if you don't need your database for a while.</span></span>
* <span data-ttu-id="ecca0-210">Ett annat alternativ är tooeither misslyckas över tooanother dataområdet om du använder aktiv geo-replikering eller hello återställer en databas med geo-redundant databassäkerhetskopieringar (geo-återställning).</span><span class="sxs-lookup"><span data-stu-id="ecca0-210">Another option is tooeither fail over tooanother data region if you are using active geo-replication or hello recover a database using geo-redundant database backups (geo-restore).</span></span> <span data-ttu-id="ecca0-211">Redundans tar endast några sekunder medan databasåterställning från säkerhetskopior tar timmar.</span><span class="sxs-lookup"><span data-stu-id="ecca0-211">Failover takes only a few seconds while database recovery from backups takes hours.</span></span>

<span data-ttu-id="ecca0-212">När du utför en åtgärd, hur lång tid det tar du toorecover och hur mycket du medföra dataförluster beror på hur du bestämmer dig för toouse de här funktionerna för verksamhetskontinuitet i ditt program.</span><span class="sxs-lookup"><span data-stu-id="ecca0-212">When you take action, how long it takes you toorecover, and how much data loss you incur depends upon how you decide toouse these business continuity features in your application.</span></span> <span data-ttu-id="ecca0-213">Faktiskt du toouse en kombination av säkerhetskopiorna av databasen och aktiv geo-replikering beroende på dina krav för programmet.</span><span class="sxs-lookup"><span data-stu-id="ecca0-213">Indeed, you may choose toouse a combination of database backups and active geo-replication depending upon your application requirements.</span></span> <span data-ttu-id="ecca0-214">Information om designöverväganden för fristående databaser och för elastiska pooler när dessa funktioner för affärskontinuitet används finns i [Design an application for cloud disaster recovery](sql-database-designing-cloud-solutions-for-disaster-recovery.md) (Utforma ett program för haveriberedskap i molnet) och [Elastic Pool disaster recovery strategies](sql-database-disaster-recovery-strategies-for-applications-with-elastic-pool.md) (Haveriberedskapsstrategier med en elastisk pool).</span><span class="sxs-lookup"><span data-stu-id="ecca0-214">For a discussion of application design considerations for stand-alone databases and for elastic pools using these business continuity features, see [Design an application for cloud disaster recovery](sql-database-designing-cloud-solutions-for-disaster-recovery.md) and [Elastic Pool disaster recovery strategies](sql-database-disaster-recovery-strategies-for-applications-with-elastic-pool.md).</span></span>

<span data-ttu-id="ecca0-215">hello innehåller följande avsnitt en översikt över hello steg toorecover med säkerhetskopiorna av databasen eller aktiv geo-replikering.</span><span class="sxs-lookup"><span data-stu-id="ecca0-215">hello following sections provide an overview of hello steps toorecover using either database backups or active geo-replication.</span></span> <span data-ttu-id="ecca0-216">Detaljerade anvisningar för planering krav och steg för återställning av post information om hur toosimulate ett avbrott tooperform en katastrofåterställning detaljgranska finns [återställa en SQL-databas från ett avbrott](sql-database-disaster-recovery.md).</span><span class="sxs-lookup"><span data-stu-id="ecca0-216">For detailed steps including planning requirements, post recovery steps, and information about how toosimulate an outage tooperform a disaster recovery drill, see [Recover a SQL Database from an outage](sql-database-disaster-recovery.md).</span></span>

### <a name="prepare-for-an-outage"></a><span data-ttu-id="ecca0-217">Förbereda för ett avbrott</span><span class="sxs-lookup"><span data-stu-id="ecca0-217">Prepare for an outage</span></span>
<span data-ttu-id="ecca0-218">Oavsett hello business continuity funktionen du använder måste du:</span><span class="sxs-lookup"><span data-stu-id="ecca0-218">Regardless of hello business continuity feature you use, you must:</span></span>

* <span data-ttu-id="ecca0-219">Identifiera och förbereda hello målservern, inklusive brandväggsregler på servernivå, inloggningar och behörigheter för master-databasen på.</span><span class="sxs-lookup"><span data-stu-id="ecca0-219">Identify and prepare hello target server, including server-level firewall rules, logins, and master database level permissions.</span></span>
* <span data-ttu-id="ecca0-220">Avgör hur tooredirect klienter och klienten program toohello ny server</span><span class="sxs-lookup"><span data-stu-id="ecca0-220">Determine how tooredirect clients and client applications toohello new server</span></span>
* <span data-ttu-id="ecca0-221">Dokumentera andra beroenden, till exempel granskningsinställningar och aviseringar.</span><span class="sxs-lookup"><span data-stu-id="ecca0-221">Document other dependencies, such as auditing settings and alerts</span></span>

<span data-ttu-id="ecca0-222">Om du inte framställer korrekt, att dina program online efter en växling vid fel eller en databasåterställning tar extra tid och kan också kräva felsökning i taget stress - en felaktig kombination.</span><span class="sxs-lookup"><span data-stu-id="ecca0-222">If you do not prepare properly, bringing your applications online after a failover or a database recovery takes additional time and likely also require troubleshooting at a time of stress - a bad combination.</span></span>

### <a name="fail-over-tooa-geo-replicated-secondary-database"></a><span data-ttu-id="ecca0-223">Växla över tooa georeplikerad sekundära databas</span><span class="sxs-lookup"><span data-stu-id="ecca0-223">Fail over tooa geo-replicated secondary database</span></span>
<span data-ttu-id="ecca0-224">Om du använder aktiv geo-replikering och automatisk redundans grupper (i förhandsversion) som återställningsmekanism för kan du konfigurera en princip för automatisk redundans eller använda [manuell växling](sql-database-disaster-recovery.md#fail-over-to-geo-replicated-secondary-database).</span><span class="sxs-lookup"><span data-stu-id="ecca0-224">If you are using active geo-replication and auto-failover groups (in-preview) as your recovery mechanism, you can configure an automatic failover policy or use [manual failover](sql-database-disaster-recovery.md#fail-over-to-geo-replicated-secondary-database).</span></span> <span data-ttu-id="ecca0-225">Efter hello redundans orsaker hello sekundära toobecome hello nya primära och redo toorecord nya transaktioner och svara tooqueries - med minimal dataförlust för hello data som inte har replikerats.</span><span class="sxs-lookup"><span data-stu-id="ecca0-225">Once initiated, hello failover causes hello secondary toobecome hello new primary and ready toorecord new transactions and respond tooqueries - with minimal data loss for hello data not yet replicated.</span></span> <span data-ttu-id="ecca0-226">Information om hur du utformar hello failover-processen finns [utforma ett program för katastrofåterställning i molnet](sql-database-designing-cloud-solutions-for-disaster-recovery.md).</span><span class="sxs-lookup"><span data-stu-id="ecca0-226">For information on designing hello failover process, see [Design an application for cloud disaster recovery](sql-database-designing-cloud-solutions-for-disaster-recovery.md).</span></span>

> [!NOTE]
> <span data-ttu-id="ecca0-227">När hello Datacenter är tillbaka online återansluta toohello nya primära hello gamla primärfärgerna automatiskt och blir sekundära databaser.</span><span class="sxs-lookup"><span data-stu-id="ecca0-227">When hello data center comes back online hello old primaries automatically reconnect toohello new primary and become secondary databases.</span></span> <span data-ttu-id="ecca0-228">Om du behöver toorelocate hello primära tillbaka toohello ursprungliga region, du kan starta en planerad redundans manuellt (återställning).</span><span class="sxs-lookup"><span data-stu-id="ecca0-228">If you need toorelocate hello primary back toohello original region, you can initiate a planned failover manually (failback).</span></span> 
> 

### <a name="perform-a-geo-restore"></a><span data-ttu-id="ecca0-229">Utför en geo-återställning</span><span class="sxs-lookup"><span data-stu-id="ecca0-229">Perform a geo-restore</span></span>
<span data-ttu-id="ecca0-230">Om du använder automatisk säkerhetskopiering med geo-redundant lagringsreplikering som återställningsmekanism för [initiera en databasåterställning med geo-återställning](sql-database-disaster-recovery.md#recover-using-geo-restore).</span><span class="sxs-lookup"><span data-stu-id="ecca0-230">If you are using automated backups with geo-redundant storage replication as your recovery mechanism, [initiate a database recovery using geo-restore](sql-database-disaster-recovery.md#recover-using-geo-restore).</span></span> <span data-ttu-id="ecca0-231">Återställning sker vanligtvis inom 12 timmar - med dataförlust för in tooone timme bestäms av när hello senaste timvis differentiell säkerhetskopiering med vidtas och replikeras.</span><span class="sxs-lookup"><span data-stu-id="ecca0-231">Recovery usually takes place within 12 hours - with data loss of up tooone hour determined by when hello last hourly differential backup with taken and replicated.</span></span> <span data-ttu-id="ecca0-232">Tills återställningen hello hello databasen är toorecord alla transaktioner eller också svarar tooany frågor.</span><span class="sxs-lookup"><span data-stu-id="ecca0-232">Until hello recovery completes, hello database is unable toorecord any transactions or respond tooany queries.</span></span> <span data-ttu-id="ecca0-233">När detta återställer en databas toohello senaste tillgängliga punkt i tiden, stöds återställa hello geo sekundär tooany punkt i tiden inte för närvarande.</span><span class="sxs-lookup"><span data-stu-id="ecca0-233">While this restores a database toohello last available point in time, restoring hello geo-secondary tooany point in time is not currently supported.</span></span>

> [!NOTE]
> <span data-ttu-id="ecca0-234">Om hello Datacenter är online igen innan du växlar ditt program via toohello återställda databasen, kan du avbryta hello återställning.</span><span class="sxs-lookup"><span data-stu-id="ecca0-234">If hello data center comes back online before you switch your application over toohello recovered database, you can cancel hello recovery.</span></span>  
>
>

### <a name="perform-post-failover--recovery-tasks"></a><span data-ttu-id="ecca0-235">Utföra åtgärder efter en redundansväxling eller återställning</span><span class="sxs-lookup"><span data-stu-id="ecca0-235">Perform post failover / recovery tasks</span></span>
<span data-ttu-id="ecca0-236">Du måste utföra hello följande ytterligare uppgifter för din användare och program säkerhetskopiera och körs efter återställningen från antingen funktion:</span><span class="sxs-lookup"><span data-stu-id="ecca0-236">After recovery from either recovery mechanism, you must perform hello following additional tasks before your users and applications are back up and running:</span></span>

* <span data-ttu-id="ecca0-237">Omdirigera klienter och klienten program toohello ny server och återställda databas</span><span class="sxs-lookup"><span data-stu-id="ecca0-237">Redirect clients and client applications toohello new server and restored database</span></span>
* <span data-ttu-id="ecca0-238">Se till att lämpliga servernivå brandväggsregler finns för användare tooconnect (eller använda [databasnivå brandväggar](sql-database-firewall-configure.md#creating-and-managing-firewall-rules))</span><span class="sxs-lookup"><span data-stu-id="ecca0-238">Ensure appropriate server-level firewall rules are in place for users tooconnect (or use [database-level firewalls](sql-database-firewall-configure.md#creating-and-managing-firewall-rules))</span></span>
* <span data-ttu-id="ecca0-239">Se till att rätt inloggningar och behörigheter på huvuddatabasnivå är på plats (eller använd [inneslutna användare](https://msdn.microsoft.com/library/ff929188.aspx))</span><span class="sxs-lookup"><span data-stu-id="ecca0-239">Ensure appropriate logins and master database level permissions are in place (or use [contained users](https://msdn.microsoft.com/library/ff929188.aspx))</span></span>
* <span data-ttu-id="ecca0-240">Konfigurera granskning efter behov</span><span class="sxs-lookup"><span data-stu-id="ecca0-240">Configure auditing, as appropriate</span></span>
* <span data-ttu-id="ecca0-241">Konfigurera aviseringar efter behov</span><span class="sxs-lookup"><span data-stu-id="ecca0-241">Configure alerts, as appropriate</span></span>

## <a name="upgrade-an-application-with-minimal-downtime"></a><span data-ttu-id="ecca0-242">Uppgradera ett program med minimal avbrottstid</span><span class="sxs-lookup"><span data-stu-id="ecca0-242">Upgrade an application with minimal downtime</span></span>
<span data-ttu-id="ecca0-243">Ibland måste ett program vara offline på grund av planerat underhåll, till exempel en uppgradering av programmet.</span><span class="sxs-lookup"><span data-stu-id="ecca0-243">Sometimes an application must be taken offline because of planned maintenance such as an application upgrade.</span></span> <span data-ttu-id="ecca0-244">[Hantera programuppgraderingar](sql-database-manage-application-rolling-upgrade.md) beskriver hur toouse aktiv geo-replikering tooenable rullande uppgraderingar molnet programmet toominimize driftstopp under uppgraderingar och ange en Återställningssökväg om något går fel.</span><span class="sxs-lookup"><span data-stu-id="ecca0-244">[Manage application upgrades](sql-database-manage-application-rolling-upgrade.md) describes how toouse active geo-replication tooenable rolling upgrades of your cloud application toominimize downtime during upgrades and provide a recovery path if something goes wrong.</span></span> 

## <a name="next-steps"></a><span data-ttu-id="ecca0-245">Nästa steg</span><span class="sxs-lookup"><span data-stu-id="ecca0-245">Next steps</span></span>
<span data-ttu-id="ecca0-246">En beskrivning av designöverväganden för fristående databaser och för elastiska pooler finns i [Design an application for cloud disaster recovery](sql-database-designing-cloud-solutions-for-disaster-recovery.md) (Utforma ett program för haveriberedskap i molnet) och [Elastic Pool disaster recovery strategies](sql-database-disaster-recovery-strategies-for-applications-with-elastic-pool.md) (Haveriberedskapsstrategier med en elastisk pool).</span><span class="sxs-lookup"><span data-stu-id="ecca0-246">For a discussion of application design considerations for stand-alone databases and for elastic pools, see [Design an application for cloud disaster recovery](sql-database-designing-cloud-solutions-for-disaster-recovery.md) and [Elastic Pool disaster recovery strategies](sql-database-disaster-recovery-strategies-for-applications-with-elastic-pool.md).</span></span>
