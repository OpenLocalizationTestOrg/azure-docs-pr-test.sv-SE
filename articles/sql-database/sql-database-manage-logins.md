---
title: "Azure SQL: inloggningar och användare | Microsoft Docs"
description: "Lär dig mer om SQL Database säkerhetshantering, särskilt hur du hanterar säkerheten för databasåtkomst och inloggning via huvudnamnkonto på servernivå."
keywords: "sql database-säkerhet, hantering av databassäkerhet, inloggningssäkerhet, databassäkerhet, databasåtkomst"
services: sql-database
documentationcenter: 
author: BYHAM
manager: jhubbard
editor: 
tags: 
ms.assetid: 0a65a93f-d5dc-424b-a774-7ed62d996f8c
ms.service: sql-database
ms.custom: security
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: data-management
ms.date: 01/23/2017
ms.author: rickbyh
ms.openlocfilehash: 51edd390c065dd7312ecc54694b5a95ecc11eab8
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 07/11/2017
---
# <a name="controlling-and-granting-database-access"></a><span data-ttu-id="9ae02-104">Kontrollera och att bevilja åtkomst till databasen</span><span class="sxs-lookup"><span data-stu-id="9ae02-104">Controlling and granting database access</span></span>

<span data-ttu-id="9ae02-105">När brandväggsregler har konfigurerats kan andra ansluta till en SQL-databas som ett av administratörskontona, som databasägaren eller som en databasanvändare i databasen.</span><span class="sxs-lookup"><span data-stu-id="9ae02-105">When firewall rules have been configured, people can connect to a SQL Database as one of the administrator accounts, as the database owner, or as a database user in the database.</span></span>  

>  [!NOTE]  
>  <span data-ttu-id="9ae02-106">Det här avsnittet gäller för Azure SQL-servern, och för både SQL Database- och SQL Data Warehouse-databaser som skapas på Azure SQL-servern.</span><span class="sxs-lookup"><span data-stu-id="9ae02-106">This topic applies to Azure SQL server, and to both SQL Database and SQL Data Warehouse databases that are created on the Azure SQL server.</span></span> <span data-ttu-id="9ae02-107">För enkelhetens skull används SQL Database när det gäller både SQL Database och SQL Data Warehouse.</span><span class="sxs-lookup"><span data-stu-id="9ae02-107">For simplicity, SQL Database is used when referring to both SQL Database and SQL Data Warehouse.</span></span> 
>

> [!TIP]
> <span data-ttu-id="9ae02-108">En självstudiekurs finns [skydda din Azure SQL Database](sql-database-security-tutorial.md).</span><span class="sxs-lookup"><span data-stu-id="9ae02-108">For a tutorial, see [Secure your Azure SQL Database](sql-database-security-tutorial.md).</span></span>
>


## <a name="unrestricted-administrative-accounts"></a><span data-ttu-id="9ae02-109">Obegränsade administrativa konton</span><span class="sxs-lookup"><span data-stu-id="9ae02-109">Unrestricted administrative accounts</span></span>
<span data-ttu-id="9ae02-110">Det finns två administrativa konton (**Serveradministratör** och **Active Directory-administratör**) som fungerar som administratörer.</span><span class="sxs-lookup"><span data-stu-id="9ae02-110">There are two administrative accounts (**Server admin** and **Active Directory admin**) that act as administrators.</span></span> <span data-ttu-id="9ae02-111">För att identifiera dessa administratörskonton för SQL-servern öppnar du Azure-portalen och går till egenskaperna för SQL-servern.</span><span class="sxs-lookup"><span data-stu-id="9ae02-111">To identify these administrator accounts for your SQL server, open the Azure portal, and navigate to the properties of your SQL server.</span></span>

![SQL-serveradministratörer](./media/sql-database-manage-logins/sql-admins.png)

- <span data-ttu-id="9ae02-113">**Serveradministratör** </span><span class="sxs-lookup"><span data-stu-id="9ae02-113">**Server admin** </span></span>  
<span data-ttu-id="9ae02-114">När du skapar en Azure SQL-server måste du ange en **Inloggning för serveradministratör**.</span><span class="sxs-lookup"><span data-stu-id="9ae02-114">When you create an Azure SQL server, you must designate a **Server admin login**.</span></span> <span data-ttu-id="9ae02-115">SQL Server skapar kontot som en inloggning i huvuddatabasen.</span><span class="sxs-lookup"><span data-stu-id="9ae02-115">SQL server creates that account as a login in the master database.</span></span> <span data-ttu-id="9ae02-116">Det här kontot ansluter med hjälp av SQL Server-autentisering (användarnamn och lösenord).</span><span class="sxs-lookup"><span data-stu-id="9ae02-116">This account connects using SQL Server authentication (user name and password).</span></span> <span data-ttu-id="9ae02-117">Endast ett av dessa konton kan finnas.</span><span class="sxs-lookup"><span data-stu-id="9ae02-117">Only one of these accounts can exist.</span></span>   
- <span data-ttu-id="9ae02-118">**Azure Active Directory-administratör** </span><span class="sxs-lookup"><span data-stu-id="9ae02-118">**Azure Active Directory admin** </span></span>  
<span data-ttu-id="9ae02-119">Ett Azure Active Directory-konto, antingen ett enskilt eller säkerhetsgruppkonto, kan också konfigureras som en administratör.</span><span class="sxs-lookup"><span data-stu-id="9ae02-119">One Azure Active Directory account, either an individual or security group account, can also be configured as an administrator.</span></span> <span data-ttu-id="9ae02-120">Det är valfritt att konfigurera en Azure AD-administratör, men en Azure AD-administratör måste konfigureras om du vill använda Azure AD-konton för att ansluta till SQL Database.</span><span class="sxs-lookup"><span data-stu-id="9ae02-120">It is optional to configure an Azure AD administrator, but an Azure AD administrator must be configured if you want to use Azure AD accounts to connect to SQL Database.</span></span> <span data-ttu-id="9ae02-121">Mer information om hur du konfigurerar åtkomst till Azure Active Directory finns i [Ansluta till SQL Database eller SQL Data Warehouse med Azure Active Directory-autentisering](sql-database-aad-authentication.md) och [SSMS-stöd för Azure AD MFA med SQL Database och SQL Data Warehouse](sql-database-ssms-mfa-authentication.md).</span><span class="sxs-lookup"><span data-stu-id="9ae02-121">For more information about configuring Azure Active Directory access, see [Connecting to SQL Database or SQL Data Warehouse By Using Azure Active Directory Authentication](sql-database-aad-authentication.md) and [SSMS support for Azure AD MFA with SQL Database and SQL Data Warehouse](sql-database-ssms-mfa-authentication.md).</span></span>
 

<span data-ttu-id="9ae02-122">Kontona **Serveradministratör** och **Azure AD-administratör** har följande egenskaper:</span><span class="sxs-lookup"><span data-stu-id="9ae02-122">The **Server admin** and **Azure AD admin** accounts has the following characteristics:</span></span>
- <span data-ttu-id="9ae02-123">De är de enda kontona som kan ansluta automatiskt till valfri SQL-databas på servern.</span><span class="sxs-lookup"><span data-stu-id="9ae02-123">These are the only accounts that can automatically connect to any SQL Database on the server.</span></span> <span data-ttu-id="9ae02-124">(För att kunna ansluta till en användardatabas måste andra konton antingen vara ägare till databasen eller ha ett användarkonto i databasen.)</span><span class="sxs-lookup"><span data-stu-id="9ae02-124">(To connect to a user database, other accounts must either be the owner of the database, or have a user account in the user database.)</span></span>
- <span data-ttu-id="9ae02-125">Dessa konton går in i användardatabaser som användaren `dbo` och de har alla behörigheter i användardatabaserna.</span><span class="sxs-lookup"><span data-stu-id="9ae02-125">These accounts enter user databases as the `dbo` user and they have all the permissions in the user databases.</span></span> <span data-ttu-id="9ae02-126">(Ägaren till en användardatabas går också in i databasen som användaren `dbo`.)</span><span class="sxs-lookup"><span data-stu-id="9ae02-126">(The owner of a user database also enters the database as the `dbo` user.)</span></span> 
- <span data-ttu-id="9ae02-127">Dessa konton går inte in i `master`-databasen som användaren `dbo` och de har begränsad behörighet i huvuddatabasen.</span><span class="sxs-lookup"><span data-stu-id="9ae02-127">These accounts do not enter the `master` database as the `dbo` user and they have limited permissions in master.</span></span> 
- <span data-ttu-id="9ae02-128">Dessa konton är inte medlemmar i den fasta serverrollen `sysadmin` i standard-SQL Server, som inte är tillgänglig i SQL Database.</span><span class="sxs-lookup"><span data-stu-id="9ae02-128">These accounts are not members of the standard SQL Server `sysadmin` fixed server role, which is not available in SQL database.</span></span>  
- <span data-ttu-id="9ae02-129">Dessa konton kan skapa, ändra och ta bort databaser, inloggningar, användare i huvuddatabasen och brandväggsregler på servernivå.</span><span class="sxs-lookup"><span data-stu-id="9ae02-129">These accounts can create, alter, and drop databases, logins, users in master, and server-level firewall rules.</span></span>
- <span data-ttu-id="9ae02-130">Dessa konton kan lägga till och ta bort medlemmar i rollerna `dbmanager` och `loginmanager`.</span><span class="sxs-lookup"><span data-stu-id="9ae02-130">These accounts can add and remove members to the `dbmanager` and `loginmanager` roles.</span></span>
- <span data-ttu-id="9ae02-131">Dessa konton kan visa systemtabellen `sys.sql_logins`.</span><span class="sxs-lookup"><span data-stu-id="9ae02-131">These accounts can view the `sys.sql_logins` system table.</span></span>

### <a name="configuring-the-firewall"></a><span data-ttu-id="9ae02-132">Konfigurering av brandväggen</span><span class="sxs-lookup"><span data-stu-id="9ae02-132">Configuring the firewall</span></span>
<span data-ttu-id="9ae02-133">När brandväggen på servernivå är konfigurerad för en enskild IP-adress eller ett intervall kan **SQL-serveradministratören** och **Azure Active Directory-administratören** ansluta till huvuddatabasen och alla användardatabaser.</span><span class="sxs-lookup"><span data-stu-id="9ae02-133">When the server-level firewall is configured for an individual IP address or range, the **SQL server admin** and the **Azure Active Directory admin** can connect to the master database and all the user databases.</span></span> <span data-ttu-id="9ae02-134">Den första brandväggen på servernivå kan konfigureras via [Azure-portalen](sql-database-get-started-portal.md)med hjälp av [PowerShell](sql-database-get-started-powershell.md) eller med [REST API:t](https://msdn.microsoft.com/library/azure/dn505712.aspx).</span><span class="sxs-lookup"><span data-stu-id="9ae02-134">The initial server-level firewall can be configured through the [Azure portal](sql-database-get-started-portal.md), using [PowerShell](sql-database-get-started-powershell.md) or using the [REST API](https://msdn.microsoft.com/library/azure/dn505712.aspx).</span></span> <span data-ttu-id="9ae02-135">När en anslutning upprättats, kan även ytterligare brandväggsregler på servernivå konfigureras med hjälp av [Transact-SQL](sql-database-configure-firewall-settings.md).</span><span class="sxs-lookup"><span data-stu-id="9ae02-135">Once a connection is made, additional server-level firewall rules can also be configured by using [Transact-SQL](sql-database-configure-firewall-settings.md).</span></span>

### <a name="administrator-access-path"></a><span data-ttu-id="9ae02-136">Åtkomstväg för administratör</span><span class="sxs-lookup"><span data-stu-id="9ae02-136">Administrator access path</span></span>
<span data-ttu-id="9ae02-137">När brandväggen på servernivå är korrekt konfigurerad kan **SQL-serveradministratören** och **Azure Active Directory-administratören** ansluta med hjälp av klientverktyg som SQL Server Management Studio eller SQL Server Data Tools.</span><span class="sxs-lookup"><span data-stu-id="9ae02-137">When the server-level firewall is properly configured, the **SQL server admin** and the **Azure Active Directory admin** can connect using client tools such as SQL Server Management Studio or SQL Server Data Tools.</span></span> <span data-ttu-id="9ae02-138">Endast de senaste verktygen innehåller alla funktioner och möjligheter.</span><span class="sxs-lookup"><span data-stu-id="9ae02-138">Only the latest tools provide all the features and capabilities.</span></span> <span data-ttu-id="9ae02-139">I följande diagram visas en typisk konfiguration för två administratörskonton.</span><span class="sxs-lookup"><span data-stu-id="9ae02-139">The following diagram shows a typical configuration for the two administrator accounts.</span></span>

![Åtkomstväg för administratör](./media/sql-database-manage-logins/1sql-db-administrator-access.png)

<span data-ttu-id="9ae02-141">Vid användning av en öppen port i brandväggen på servernivå kan administratörer ansluta till en SQL Database.</span><span class="sxs-lookup"><span data-stu-id="9ae02-141">When using an open port in the server-level firewall, administrators can connect to any SQL Database.</span></span>

### <a name="connecting-to-a-database-by-using-sql-server-management-studio"></a><span data-ttu-id="9ae02-142">Ansluta till en databas med hjälp av SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="9ae02-142">Connecting to a database by using SQL Server Management Studio</span></span>
<span data-ttu-id="9ae02-143">Om du behöver en genomgång av hur man skapar en databas, brandväggsregler på servernivå och hur man använder SQL Server Management Studio för att fråga en databas, finns det i [Kom igång med Azure SQL Database-servrar, databaser och brandväggsregler med hjälp av Azure-portalen och SQL Server Management Studio](sql-database-get-started-portal.md).</span><span class="sxs-lookup"><span data-stu-id="9ae02-143">For a walk-through of creating a server, a database, server-level firewall rules, and using SQL Server Management Studio to query a database, see [Get started with Azure SQL Database servers, databases, and firewall rules by using the Azure portal and SQL Server Management Studio](sql-database-get-started-portal.md).</span></span>

> [!IMPORTANT]
> <span data-ttu-id="9ae02-144">Det rekommenderas att du alltid använder den senaste versionen av Management Studio för att förbli synkroniserad med uppdateringar av Microsoft Azure och SQL Database.</span><span class="sxs-lookup"><span data-stu-id="9ae02-144">It is recommended that you always use the latest version of Management Studio to remain synchronized with updates to Microsoft Azure and SQL Database.</span></span> <span data-ttu-id="9ae02-145">[Uppdatera SQL Server Management Studio](https://msdn.microsoft.com/library/mt238290.aspx).</span><span class="sxs-lookup"><span data-stu-id="9ae02-145">[Update SQL Server Management Studio](https://msdn.microsoft.com/library/mt238290.aspx).</span></span>


## <a name="additional-server-level-administrative-roles"></a><span data-ttu-id="9ae02-146">Ytterligare administrativa roller på servernivå</span><span class="sxs-lookup"><span data-stu-id="9ae02-146">Additional server-level administrative roles</span></span>
<span data-ttu-id="9ae02-147">Förutom de administrativa roller på servernivå som diskuterats, erbjuder SQL Database två begränsade administrativa roller i huvuddatabasen där användarkonton kan läggas till som beviljar behörigheter att antingen skapa databaser eller hantera inloggningar.</span><span class="sxs-lookup"><span data-stu-id="9ae02-147">In addition to the server-level administrative roles discussed previously, SQL Database provides two restricted administrative roles in the master database to which user accounts can be added that grant permissions to either create databases or manage logins.</span></span>

### <a name="database-creators"></a><span data-ttu-id="9ae02-148">Databasskapare</span><span class="sxs-lookup"><span data-stu-id="9ae02-148">Database creators</span></span>
<span data-ttu-id="9ae02-149">En av dessa administrativa roller är **dbmanager**-rollen.</span><span class="sxs-lookup"><span data-stu-id="9ae02-149">One of these administrative roles is the **dbmanager** role.</span></span> <span data-ttu-id="9ae02-150">Medlemmar i den här rollen kan skapa nya databaser.</span><span class="sxs-lookup"><span data-stu-id="9ae02-150">Members of this role can create new databases.</span></span> <span data-ttu-id="9ae02-151">För att använda den här rollen skapar du en användare i `master`-databasen och lägger sedan till användaren i **dbmanager**-databasrollen.</span><span class="sxs-lookup"><span data-stu-id="9ae02-151">To use this role, you create a user in the `master` database and then add the user to the **dbmanager** database role.</span></span> <span data-ttu-id="9ae02-152">För att skapa en databas måste användaren vara en användare som är baserad på SQL Server-inloggning i huvuddatabasen eller en oberoende databasanvändare som är baserad på en Azure Active Directory-användare.</span><span class="sxs-lookup"><span data-stu-id="9ae02-152">To create a database, the user must be a user based on a SQL Server login in the master database or contained database user based on an Azure Active Directory user.</span></span>

1. <span data-ttu-id="9ae02-153">Anslut till huvuddatabasen med ett administratörskonto.</span><span class="sxs-lookup"><span data-stu-id="9ae02-153">Using an administrator account, connect to the master database.</span></span>
2. <span data-ttu-id="9ae02-154">Alternativt steg: Skapa en SQL Server-autentiseringsinloggning med hjälp av instruktionen [SKAPA INLOGGNING](https://msdn.microsoft.com/library/ms189751.aspx).</span><span class="sxs-lookup"><span data-stu-id="9ae02-154">Optional step: Create a SQL Server authentication login, using the [CREATE LOGIN](https://msdn.microsoft.com/library/ms189751.aspx) statement.</span></span> <span data-ttu-id="9ae02-155">Exempel på instruktion:</span><span class="sxs-lookup"><span data-stu-id="9ae02-155">Sample statement:</span></span>
   
   ```
   CREATE LOGIN Mary WITH PASSWORD = '<strong_password>';
   ```
   
   > [!NOTE]
   > <span data-ttu-id="9ae02-156">Använd ett starkt lösenord när du skapar en inloggning eller en oberoende databasanvändare.</span><span class="sxs-lookup"><span data-stu-id="9ae02-156">Use a strong password when creating a login or contained database user.</span></span> <span data-ttu-id="9ae02-157">Mer information finns i [Starka lösenord](https://msdn.microsoft.com/library/ms161962.aspx).</span><span class="sxs-lookup"><span data-stu-id="9ae02-157">For more information, see [Strong Passwords](https://msdn.microsoft.com/library/ms161962.aspx).</span></span>
    
   <span data-ttu-id="9ae02-158">För att förbättra prestandan cachelagras inloggningar (huvudnamn på servernivå) tillfälligt på databasnivån.</span><span class="sxs-lookup"><span data-stu-id="9ae02-158">To improve performance, logins (server-level principals) are temporarily cached at the database level.</span></span> <span data-ttu-id="9ae02-159">Information om hur du uppdaterar autentiseringscache finns i [DBCC FLUSHAUTHCACHE](https://msdn.microsoft.com/library/mt627793.aspx).</span><span class="sxs-lookup"><span data-stu-id="9ae02-159">To refresh the authentication cache, see [DBCC FLUSHAUTHCACHE](https://msdn.microsoft.com/library/mt627793.aspx).</span></span>

3. <span data-ttu-id="9ae02-160">Skapa en användare i huvuddatabasen med hjälp av instruktionen [SKAPA ANVÄNDARE](https://msdn.microsoft.com/library/ms173463.aspx).</span><span class="sxs-lookup"><span data-stu-id="9ae02-160">In the master database, create a user by using the [CREATE USER](https://msdn.microsoft.com/library/ms173463.aspx) statement.</span></span> <span data-ttu-id="9ae02-161">Användaren kan vara en Azure Active Directory-autentiserad oberoende databasanvändare (om du har konfigurerat din miljö för Azure AD-autentisering), eller en SQL Server-autentiserad oberoende databasanvändare, eller en SQL Server-autentiserad användare baserad på en SQL Server-autentiserad inloggning (skapad i föregående steg.) Exempel på instruktioner:</span><span class="sxs-lookup"><span data-stu-id="9ae02-161">The user can be an Azure Active Directory authentication contained database user (if you have configured your environment for Azure AD authentication), or a SQL Server authentication contained database user, or a SQL Server authentication user based on a SQL Server authentication login (created in the previous step.) Sample statements:</span></span>
   
   ```
   CREATE USER [mike@contoso.com] FROM EXTERNAL PROVIDER;
   CREATE USER Tran WITH PASSWORD = '<strong_password>';
   CREATE USER Mary FROM LOGIN Mary; 
   ```

4. <span data-ttu-id="9ae02-162">Lägg till den nya användaren till **dbmanager**-databasrollen med hjälp av instruktionen [ALTER ROLE](https://msdn.microsoft.com/library/ms189775.aspx).</span><span class="sxs-lookup"><span data-stu-id="9ae02-162">Add the new user, to the **dbmanager** database role by using the [ALTER ROLE](https://msdn.microsoft.com/library/ms189775.aspx) statement.</span></span> <span data-ttu-id="9ae02-163">Exempel på instruktioner:</span><span class="sxs-lookup"><span data-stu-id="9ae02-163">Sample statements:</span></span>
   
   ```
   ALTER ROLE dbmanager ADD MEMBER Mary; 
   ALTER ROLE dbmanager ADD MEMBER [mike@contoso.com];
   ```
   
   > [!NOTE]
   > <span data-ttu-id="9ae02-164">Dbmanager är en databasroll i en huvuddatabas, så du kan bara lägga till en databasanvändare i dbmanager-rollen.</span><span class="sxs-lookup"><span data-stu-id="9ae02-164">The dbmanager is a database role in master database so you can only add a database user to the dbmanager role.</span></span> <span data-ttu-id="9ae02-165">Du kan inte lägga till en inloggning på servernivå till databasnivårollen.</span><span class="sxs-lookup"><span data-stu-id="9ae02-165">You cannot add a server-level login to database-level role.</span></span>
    
5. <span data-ttu-id="9ae02-166">Vid behov konfigurerar du en brandväggsregel så att den nya användaren kan ansluta.</span><span class="sxs-lookup"><span data-stu-id="9ae02-166">If necessary, configure a firewall rule to allow the new user to connect.</span></span> <span data-ttu-id="9ae02-167">(Den nya användaren kan omfattas av en befintlig brandväggsregel.)</span><span class="sxs-lookup"><span data-stu-id="9ae02-167">(The new user might be covered by an existing firewall rule.)</span></span>

<span data-ttu-id="9ae02-168">Nu kan användaren ansluta till huvuddatabasen och kan skapa nya databaser.</span><span class="sxs-lookup"><span data-stu-id="9ae02-168">Now the user can connect to the master database and can create new databases.</span></span> <span data-ttu-id="9ae02-169">Det konto som skapar databasen blir ägare till databasen.</span><span class="sxs-lookup"><span data-stu-id="9ae02-169">The account creating the database becomes the owner of the database.</span></span>

### <a name="login-managers"></a><span data-ttu-id="9ae02-170">Inloggningshanterare</span><span class="sxs-lookup"><span data-stu-id="9ae02-170">Login managers</span></span>
<span data-ttu-id="9ae02-171">Den andra administrativa rollen är inloggningshanterare-rollen.</span><span class="sxs-lookup"><span data-stu-id="9ae02-171">The other administrative role is the login manager role.</span></span> <span data-ttu-id="9ae02-172">Medlemmar i den här rollen kan skapa nya inloggningar i huvuddatabasen.</span><span class="sxs-lookup"><span data-stu-id="9ae02-172">Members of this role can create new logins in the master database.</span></span> <span data-ttu-id="9ae02-173">Om du vill kan du slutföra samma steg (skapa en inloggning och användare och lägga till en användare i rollen **loginmanager**) så att en användare kan skapa nya inloggningar i huvuddatabasen.</span><span class="sxs-lookup"><span data-stu-id="9ae02-173">If you wish, you can complete the same steps (create a login and user, and add a user to the **loginmanager** role) to enable a user to create new logins in the master.</span></span> <span data-ttu-id="9ae02-174">Inloggningar är vanligtvis inte nödvändiga, eftersom Microsoft rekommenderar att du använder oberoende databasanvändare, som autentiseras på databasnivå istället för att använda användare baserat på inloggningar.</span><span class="sxs-lookup"><span data-stu-id="9ae02-174">Usually logins are not necessary as Microsoft recommends using contained database users, which authenticate at the database-level instead of using users based on logins.</span></span> <span data-ttu-id="9ae02-175">Mer information finns i [Oberoende databasanvändare – göra databasen portabel](https://msdn.microsoft.com/library/ff929188.aspx).</span><span class="sxs-lookup"><span data-stu-id="9ae02-175">For more information, see [Contained Database Users - Making Your Database Portable](https://msdn.microsoft.com/library/ff929188.aspx).</span></span>

## <a name="non-administrator-users"></a><span data-ttu-id="9ae02-176">Användare som är icke-administratörer</span><span class="sxs-lookup"><span data-stu-id="9ae02-176">Non-administrator users</span></span>
<span data-ttu-id="9ae02-177">Icke-administratörskonton behöver i allmänhet inte åtkomst till huvuddatabasen.</span><span class="sxs-lookup"><span data-stu-id="9ae02-177">Generally, non-administrator accounts do not need access to the master database.</span></span> <span data-ttu-id="9ae02-178">Skapa oberoende databasanvändare på databasnivå med hjälp av instruktionen [SKAPA ANVÄNDARE (Transact-SQL)](https://msdn.microsoft.com/library/ms173463.aspx).</span><span class="sxs-lookup"><span data-stu-id="9ae02-178">Create contained database users at the database level using the [CREATE USER (Transact-SQL)](https://msdn.microsoft.com/library/ms173463.aspx) statement.</span></span> <span data-ttu-id="9ae02-179">Användaren kan vara en Azure Active Directory-autentiserad oberoende databasanvändare (om du har konfigurerat din miljö för Azure AD-autentisering), eller en SQL Server-autentiserad oberoende databasanvändare, eller en SQL Server-autentiserad användare baserad på en SQL Server-autentiserad inloggning (skapad i föregående steg.) Mer information finns i [Oberoende databasanvändare – göra databasen portabel](https://msdn.microsoft.com/library/ff929188.aspx).</span><span class="sxs-lookup"><span data-stu-id="9ae02-179">The user can be an Azure Active Directory authentication contained database user (if you have configured your environment for Azure AD authentication), or a SQL Server authentication contained database user, or a SQL Server authentication user based on a SQL Server authentication login (created in the previous step.) For more information, see [Contained Database Users - Making Your Database Portable](https://msdn.microsoft.com/library/ff929188.aspx).</span></span> 

<span data-ttu-id="9ae02-180">För att skapa användare, anslut till databasen och köra instruktioner som liknar följande exempel:</span><span class="sxs-lookup"><span data-stu-id="9ae02-180">To create users, connect to the database, and execute statements similar to the following examples:</span></span>

```
CREATE USER Mary FROM LOGIN Mary; 
CREATE USER [mike@contoso.com] FROM EXTERNAL PROVIDER;
```

<span data-ttu-id="9ae02-181">Initialt kan endast en av administratörerna eller ägaren av databasen skapa användare.</span><span class="sxs-lookup"><span data-stu-id="9ae02-181">Initially, only one of the administrators or the owner of the database can create users.</span></span> <span data-ttu-id="9ae02-182">För att auktorisera ytterligare användare som ska kunna skapa nya användare: Ge den valda användaren `ALTER ANY USER`-behörighet genom att använda en instruktion som:</span><span class="sxs-lookup"><span data-stu-id="9ae02-182">To authorize additional users to create new users, grant that selected user the `ALTER ANY USER` permission, by using a statement such as:</span></span>

```
GRANT ALTER ANY USER TO Mary;
```

<span data-ttu-id="9ae02-183">Om du vill ge ytterligare användare fullständig behörighet till databasen, gör dem till medlemmar i den fasta databasrollen **db_owner** med hjälp av `ALTER ROLE`-instruktionen.</span><span class="sxs-lookup"><span data-stu-id="9ae02-183">To give additional users full control of the database, make them a member of the **db_owner** fixed database role using the `ALTER ROLE` statement.</span></span>

> [!NOTE]
> <span data-ttu-id="9ae02-184">Den vanligaste anledningen till att skapa databasanvändare baserat på inloggningar är när du har SQL Server-autentiserade användare som behöver åtkomst till flera databaser.</span><span class="sxs-lookup"><span data-stu-id="9ae02-184">The most common reason to create database users based on logins, is when you have SQL Server authentication users that need access to multiple databases.</span></span> <span data-ttu-id="9ae02-185">Användare baserade på inloggningar är knutna till inloggningen och endast ett lösenord för att logga in.</span><span class="sxs-lookup"><span data-stu-id="9ae02-185">Users based on logins are tied to the login, and only one password that is maintained for that login.</span></span> <span data-ttu-id="9ae02-186">Oberoende databasanvändare i individuella databaser är var och en individuella enheter och var och en underhåller ett eget lösenord.</span><span class="sxs-lookup"><span data-stu-id="9ae02-186">Contained database users in individual databases are each individual entities and each maintains its own password.</span></span> <span data-ttu-id="9ae02-187">Detta kan förvirra oberoende databasanvändare om de inte upprätthåller sina lösenord som identiska.</span><span class="sxs-lookup"><span data-stu-id="9ae02-187">This can confuse contained database users if they do not maintain their passwords as identical.</span></span>

### <a name="configuring-the-database-level-firewall"></a><span data-ttu-id="9ae02-188">Konfigurera brandvägg på databasnivå</span><span class="sxs-lookup"><span data-stu-id="9ae02-188">Configuring the database-level firewall</span></span>
<span data-ttu-id="9ae02-189">Bästa praxis är att icke-administratörer bara har åtkomst genom brandväggen till de databaser som de använder.</span><span class="sxs-lookup"><span data-stu-id="9ae02-189">As a best practice, non-administrator users should only have access through the firewall to the databases that they use.</span></span> <span data-ttu-id="9ae02-190">Istället för att auktorisera deras IP-adresser genom brandväggen på servernivå och ge dem åtkomst till alla databaser, använd instruktionen [sp_set_database_firewall_rule](https://msdn.microsoft.com/library/dn270010.aspx) för att konfigurera brandväggen på databasnivå.</span><span class="sxs-lookup"><span data-stu-id="9ae02-190">Instead of authorizing their IP addresses through the server-level firewall and giving them access to all databases, use the [sp_set_database_firewall_rule](https://msdn.microsoft.com/library/dn270010.aspx) statement to configure the database-level firewall.</span></span> <span data-ttu-id="9ae02-191">Brandväggen på databasnivå kan inte konfigureras via portalen.</span><span class="sxs-lookup"><span data-stu-id="9ae02-191">The database-level firewall cannot be configured by using the portal.</span></span>

### <a name="non-administrator-access-path"></a><span data-ttu-id="9ae02-192">Åtkomstväg för icke-administratör</span><span class="sxs-lookup"><span data-stu-id="9ae02-192">Non-administrator access path</span></span>
<span data-ttu-id="9ae02-193">När brandväggen på databasnivå är korrekt konfigurerad kan databasanvändare ansluta med klientverktyg som SQL Server Management Studio eller SQL Server Data Tools.</span><span class="sxs-lookup"><span data-stu-id="9ae02-193">When the database-level firewall is properly configured, the database users can connect using client tools such as SQL Server Management Studio or SQL Server Data Tools.</span></span> <span data-ttu-id="9ae02-194">Endast de senaste verktygen innehåller alla funktioner och möjligheter.</span><span class="sxs-lookup"><span data-stu-id="9ae02-194">Only the latest tools provide all the features and capabilities.</span></span> <span data-ttu-id="9ae02-195">I följande diagram visas en typisk åtkomstväg för en icke-administratör.</span><span class="sxs-lookup"><span data-stu-id="9ae02-195">The following diagram shows a typical non-administrator access path.</span></span>

![Åtkomstväg för icke-administratör](./media/sql-database-manage-logins/2sql-db-nonadmin-access.png)

## <a name="groups-and-roles"></a><span data-ttu-id="9ae02-197">Grupper och roller</span><span class="sxs-lookup"><span data-stu-id="9ae02-197">Groups and roles</span></span>
<span data-ttu-id="9ae02-198">Effektiv åtkomsthantering använder behörigheter tilldelade grupper och roller i stället för enskilda användare.</span><span class="sxs-lookup"><span data-stu-id="9ae02-198">Efficient access management uses permissions assigned to groups and roles instead of individual users.</span></span> 

- <span data-ttu-id="9ae02-199">När du använder Azure Active Directory-autentisering, lägger du Azure Active Directory-användare i en Azure Active Directory-grupp.</span><span class="sxs-lookup"><span data-stu-id="9ae02-199">When using Azure Active Directory authentication, put Azure Active Directory users into an Azure Active Directory group.</span></span> <span data-ttu-id="9ae02-200">Skapa en oberoende databasanvändare för gruppen.</span><span class="sxs-lookup"><span data-stu-id="9ae02-200">Create a contained database user for the group.</span></span> <span data-ttu-id="9ae02-201">Placera en eller flera användare i en [databasrollen](https://msdn.microsoft.com/library/ms189121) och tilldela sedan [behörigheter](https://msdn.microsoft.com/library/ms191291.aspx) till databasrollen.</span><span class="sxs-lookup"><span data-stu-id="9ae02-201">Place one or more database users into a [database role](https://msdn.microsoft.com/library/ms189121) and then assign [permissions](https://msdn.microsoft.com/library/ms191291.aspx) to the database role.</span></span>

- <span data-ttu-id="9ae02-202">När du använder SQL Server-autentisering kan du skapa inneslutna databasanvändare i databasen.</span><span class="sxs-lookup"><span data-stu-id="9ae02-202">When using SQL Server authentication, create contained database users in the database.</span></span> <span data-ttu-id="9ae02-203">Placera en eller flera användare i en [databasrollen](https://msdn.microsoft.com/library/ms189121) och tilldela sedan [behörigheter](https://msdn.microsoft.com/library/ms191291.aspx) till databasrollen.</span><span class="sxs-lookup"><span data-stu-id="9ae02-203">Place one or more database users into a [database role](https://msdn.microsoft.com/library/ms189121) and then assign [permissions](https://msdn.microsoft.com/library/ms191291.aspx) to the database role.</span></span>

<span data-ttu-id="9ae02-204">Databasrollerna kan vara de inbyggda rollerna, som **db_owner**, **db_ddladmin**, **db_datawriter**, **db_datareader**, **db_denydatawriter** och **db_denydatareader**.</span><span class="sxs-lookup"><span data-stu-id="9ae02-204">The database roles can be the built-in roles such as **db_owner**, **db_ddladmin**, **db_datawriter**, **db_datareader**, **db_denydatawriter**, and **db_denydatareader**.</span></span> <span data-ttu-id="9ae02-205">**db_owner** används ofta för att endast ge fullständig behörighet till några användare.</span><span class="sxs-lookup"><span data-stu-id="9ae02-205">**db_owner** is commonly used to grant full permission to only a few users.</span></span> <span data-ttu-id="9ae02-206">De andra fasta databasrollerna är användbara för att snabbt få en enkel databas i utveckling, men de rekommenderas inte för de flesta produktionsdatabaserna.</span><span class="sxs-lookup"><span data-stu-id="9ae02-206">The other fixed database roles are useful for getting a simple database in development quickly, but are not recommended for most production databases.</span></span> <span data-ttu-id="9ae02-207">Till exempel ger den fasta databasrollen **db_datareader** läsbehörighet till alla tabeller i databasen, vilket vanligtvis är mer än är absolut nödvändigt.</span><span class="sxs-lookup"><span data-stu-id="9ae02-207">For example, the **db_datareader** fixed database role grants read access to every table in the database, which is usually more than is strictly necessary.</span></span> <span data-ttu-id="9ae02-208">Det är mycket bättre att använda instruktionen [SKAPA ROLL](https://msdn.microsoft.com/library/ms187936.aspx) för att skapa dina egna anpassade databasroller och noggrant bevilja varje roll minsta möjliga behörighet som krävs för företagets behov.</span><span class="sxs-lookup"><span data-stu-id="9ae02-208">It is far better to use the [CREATE ROLE](https://msdn.microsoft.com/library/ms187936.aspx) statement to create your own user-defined database roles and carefully grant each role the least permissions necessary for the business need.</span></span> <span data-ttu-id="9ae02-209">När en användare är medlem i flera roller sammanställs behörigheterna för alla.</span><span class="sxs-lookup"><span data-stu-id="9ae02-209">When a user is a member of multiple roles, they aggregate the permissions of them all.</span></span>

## <a name="permissions"></a><span data-ttu-id="9ae02-210">Behörigheter</span><span class="sxs-lookup"><span data-stu-id="9ae02-210">Permissions</span></span>
<span data-ttu-id="9ae02-211">Det finns över 100 behörigheter som individuellt kan beviljas eller nekas i SQL Database.</span><span class="sxs-lookup"><span data-stu-id="9ae02-211">There are over 100 permissions that can be individually granted or denied in SQL Database.</span></span> <span data-ttu-id="9ae02-212">Många av de här behörigheterna är kapslade.</span><span class="sxs-lookup"><span data-stu-id="9ae02-212">Many of these permissions are nested.</span></span> <span data-ttu-id="9ae02-213">Till exempel inkluderar `UPDATE`-behörighet på ett schema `UPDATE`-behörighet för alla tabeller i schemat.</span><span class="sxs-lookup"><span data-stu-id="9ae02-213">For example, the `UPDATE` permission on a schema includes the `UPDATE` permission on each table within that schema.</span></span> <span data-ttu-id="9ae02-214">Som i de flesta andra behörighetssystem åsidosätter ett nekande av en behörighet en beviljad.</span><span class="sxs-lookup"><span data-stu-id="9ae02-214">As in most permission systems, the denial of a permission overrides a grant.</span></span> <span data-ttu-id="9ae02-215">På grund av den kapslade karaktären och antalet behörigheter kan det krävas noggranna studier för att designa ett behörighetssystem som korrekt skyddar databasen.</span><span class="sxs-lookup"><span data-stu-id="9ae02-215">Because of the nested nature and the number of permissions, it can take careful study to design an appropriate permission system to properly protect your database.</span></span> <span data-ttu-id="9ae02-216">Börja med listan över behörigheter på [Behörigheter (Databasmotor)](https://msdn.microsoft.com/library/ms191291.aspx) och granska den [stora bilden](http://go.microsoft.com/fwlink/?LinkId=229142) med behörigheter.</span><span class="sxs-lookup"><span data-stu-id="9ae02-216">Start with the list of permissions at [Permissions (Database Engine)](https://msdn.microsoft.com/library/ms191291.aspx) and review the [poster size graphic](http://go.microsoft.com/fwlink/?LinkId=229142) of the permissions.</span></span>


### <a name="considerations-and-restrictions"></a><span data-ttu-id="9ae02-217">Överväganden och begränsningar</span><span class="sxs-lookup"><span data-stu-id="9ae02-217">Considerations and restrictions</span></span>
<span data-ttu-id="9ae02-218">När du hanterar inloggningar och användare i SQL Database, bör du överväga följande:</span><span class="sxs-lookup"><span data-stu-id="9ae02-218">When managing logins and users in SQL Database, consider the following:</span></span>

* <span data-ttu-id="9ae02-219">Du måste vara ansluten till **huvud**databasen när du kör uttrycket `CREATE/ALTER/DROP DATABASE`.</span><span class="sxs-lookup"><span data-stu-id="9ae02-219">You must be connected to the **master** database when executing the `CREATE/ALTER/DROP DATABASE` statements.</span></span>   
* <span data-ttu-id="9ae02-220">Databasanvändaren som motsvarar inloggningen som **serveradministratör** kan inte ändras eller tas bort.</span><span class="sxs-lookup"><span data-stu-id="9ae02-220">The database user corresponding to the **Server admin** login cannot be altered or dropped.</span></span> 
* <span data-ttu-id="9ae02-221">Amerikansk engelska är standardspråket för inloggningen **Serveradministratör**.</span><span class="sxs-lookup"><span data-stu-id="9ae02-221">US-English is the default language of the **Server admin** login.</span></span>
* <span data-ttu-id="9ae02-222">Endast administratörer (inloggningen som **serveradministratör** eller Azure AD-administratör) och medlemmar i databasrollen **dbmanager** i **huvuddatabasen** har behörighet att köra `CREATE DATABASE`- och `DROP DATABASE`-uttrycken.</span><span class="sxs-lookup"><span data-stu-id="9ae02-222">Only the administrators (**Server admin** login or Azure AD administrator) and the members of the **dbmanager** database role in the **master** database have permission to execute the `CREATE DATABASE` and `DROP DATABASE` statements.</span></span>
* <span data-ttu-id="9ae02-223">Du måste vara ansluten till huvuddatabasen när du kör uttrycket `CREATE/ALTER/DROP LOGIN`.</span><span class="sxs-lookup"><span data-stu-id="9ae02-223">You must be connected to the master database when executing the `CREATE/ALTER/DROP LOGIN` statements.</span></span> <span data-ttu-id="9ae02-224">Att använda inloggningar rekommenderas inte.</span><span class="sxs-lookup"><span data-stu-id="9ae02-224">However using logins is discouraged.</span></span> <span data-ttu-id="9ae02-225">Använd i stället oberoende databasanvändare.</span><span class="sxs-lookup"><span data-stu-id="9ae02-225">Use contained database users instead.</span></span>
* <span data-ttu-id="9ae02-226">Du måste ange namnet på databasen i anslutningssträngen för att ansluta till en användardatabas.</span><span class="sxs-lookup"><span data-stu-id="9ae02-226">To connect to a user database, you must provide the name of the database in the connection string.</span></span>
* <span data-ttu-id="9ae02-227">Endast huvudsaklig inloggning på servernivå och medlemmarna i databasrollen **loginmanager** i **huvud**databasen har behörighet att köra uttryck `CREATE LOGIN`, `ALTER LOGIN` och `DROP LOGIN`.</span><span class="sxs-lookup"><span data-stu-id="9ae02-227">Only the server-level principal login and the members of the **loginmanager** database role in the **master** database have permission to execute the `CREATE LOGIN`, `ALTER LOGIN`, and `DROP LOGIN` statements.</span></span>
* <span data-ttu-id="9ae02-228">När du kör uttryck `CREATE/ALTER/DROP LOGIN` och `CREATE/ALTER/DROP DATABASE` i ett ADO.NET-program, är det inte tillåtet att använda parametriserade kommandon.</span><span class="sxs-lookup"><span data-stu-id="9ae02-228">When executing the `CREATE/ALTER/DROP LOGIN` and `CREATE/ALTER/DROP DATABASE` statements in an ADO.NET application, using parameterized commands is not allowed.</span></span> <span data-ttu-id="9ae02-229">Mer information finns i [Kommandon och parametrar](https://msdn.microsoft.com/library/ms254953.aspx).</span><span class="sxs-lookup"><span data-stu-id="9ae02-229">For more information, see [Commands and Parameters](https://msdn.microsoft.com/library/ms254953.aspx).</span></span>
* <span data-ttu-id="9ae02-230">När du kör uttrycket `CREATE/ALTER/DROP DATABASE` och `CREATE/ALTER/DROP LOGIN`, måste vart och ett av dessa uttryck vara den enda instruktionen i en Transact-SQL-batch.</span><span class="sxs-lookup"><span data-stu-id="9ae02-230">When executing the `CREATE/ALTER/DROP DATABASE` and `CREATE/ALTER/DROP LOGIN` statements, each of these statements must be the only statement in a Transact-SQL batch.</span></span> <span data-ttu-id="9ae02-231">Annars uppstår ett fel.</span><span class="sxs-lookup"><span data-stu-id="9ae02-231">Otherwise, an error occurs.</span></span> <span data-ttu-id="9ae02-232">Till exempel kontrollerar följande Transact-SQL huruvida databasen finns.</span><span class="sxs-lookup"><span data-stu-id="9ae02-232">For example, the following Transact-SQL checks whether the database exists.</span></span> <span data-ttu-id="9ae02-233">Om den finns anropas ett `DROP DATABASE`-uttryck för att ta bort databasen.</span><span class="sxs-lookup"><span data-stu-id="9ae02-233">If it exists, a `DROP DATABASE` statement is called to remove the database.</span></span> <span data-ttu-id="9ae02-234">Eftersom `DROP DATABASE`-uttrycket inte är det enda uttrycket i batchen, ger körning av följande Transact-SQL-uttryck ett fel.</span><span class="sxs-lookup"><span data-stu-id="9ae02-234">Because the `DROP DATABASE` statement is not the only statement in the batch, executing the following Transact-SQL statement results in an error.</span></span>

  ```
  IF EXISTS (SELECT [name]
           FROM   [sys].[databases]
           WHERE  [name] = N'database_name')
  DROP DATABASE [database_name];
  GO
  ```

* <span data-ttu-id="9ae02-235">När du kör uttryck `CREATE USER` med alternativ `FOR/FROM LOGIN`, måste det vara det enda uttrycket i en Transact-SQL-batch.</span><span class="sxs-lookup"><span data-stu-id="9ae02-235">When executing the `CREATE USER` statement with the `FOR/FROM LOGIN` option, it must be the only statement in a Transact-SQL batch.</span></span>
* <span data-ttu-id="9ae02-236">När du kör uttryck `ALTER USER` med alternativ `WITH LOGIN`, måste det vara det enda uttrycket i en Transact-SQL-batch.</span><span class="sxs-lookup"><span data-stu-id="9ae02-236">When executing the `ALTER USER` statement with the `WITH LOGIN` option, it must be the only statement in a Transact-SQL batch.</span></span>
* <span data-ttu-id="9ae02-237">För `CREATE/ALTER/DROP` behöver en användare behörighet `ALTER ANY USER` på databasen.</span><span class="sxs-lookup"><span data-stu-id="9ae02-237">To `CREATE/ALTER/DROP` a user requires the `ALTER ANY USER` permission on the database.</span></span>
* <span data-ttu-id="9ae02-238">När ägaren av en databasroll försöker lägga till eller ta bort en annan databasanvändare till eller från databasrollen uppstår följande fel: **Användarens eller rollens ”Namn” finns inte i den här databasen.**</span><span class="sxs-lookup"><span data-stu-id="9ae02-238">When the owner of a database role tries to add or remove another database user to or from that database role, the following error may occur: **User or role 'Name' does not exist in this database.**</span></span> <span data-ttu-id="9ae02-239">Det här felet beror på att användaren inte är synlig för ägaren.</span><span class="sxs-lookup"><span data-stu-id="9ae02-239">This error occurs because the user is not visible to the owner.</span></span> <span data-ttu-id="9ae02-240">Ge rollägare behörighet `VIEW DEFINITION` på användaren för att lösa problemet.</span><span class="sxs-lookup"><span data-stu-id="9ae02-240">To resolve this issue, grant the role owner the `VIEW DEFINITION` permission on the user.</span></span> 


## <a name="next-steps"></a><span data-ttu-id="9ae02-241">Nästa steg</span><span class="sxs-lookup"><span data-stu-id="9ae02-241">Next steps</span></span>

- <span data-ttu-id="9ae02-242">Om du vill veta mer om brandväggsregler, se [Azure SQL Database-brandväggen](sql-database-firewall-configure.md).</span><span class="sxs-lookup"><span data-stu-id="9ae02-242">To learn more about firewall rules, see [Azure SQL Database Firewall](sql-database-firewall-configure.md).</span></span>
- <span data-ttu-id="9ae02-243">En översikt över alla säkerhetsfunktioner i SQL Database finns i [SQL Säkerhetsöversikt](sql-database-security-overview.md).</span><span class="sxs-lookup"><span data-stu-id="9ae02-243">For an overview of all the SQL Database security features, see [SQL security overview](sql-database-security-overview.md).</span></span>
- <span data-ttu-id="9ae02-244">En självstudiekurs finns [skydda din Azure SQL Database](sql-database-security-tutorial.md).</span><span class="sxs-lookup"><span data-stu-id="9ae02-244">For a tutorial, see [Secure your Azure SQL Database](sql-database-security-tutorial.md).</span></span>
- <span data-ttu-id="9ae02-245">Information om vyer och lagrade procedurer finns i [Skapa vyer och lagrade procedurer](https://msdn.microsoft.com/library/ms365311.aspx)</span><span class="sxs-lookup"><span data-stu-id="9ae02-245">For information about views and stored procedures, see [Creating views and stored procedures](https://msdn.microsoft.com/library/ms365311.aspx)</span></span>
- <span data-ttu-id="9ae02-246">Information om hur du beviljar åtkomst till ett databasobjekt finns i [Bevilja åtkomst till ett databasobjekt](https://msdn.microsoft.com/library/ms365327.aspx)</span><span class="sxs-lookup"><span data-stu-id="9ae02-246">For information about granting access to a database object, see [Granting Access to a Database Object](https://msdn.microsoft.com/library/ms365327.aspx)</span></span>
