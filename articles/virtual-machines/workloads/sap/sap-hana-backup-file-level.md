---
title: "aaaSAP HANA Azure Backup på filnivå | Microsoft Docs"
description: "Det finns två huvudsakliga säkerhetskopiering möjligheter för SAP HANA på Azure virtual machines, den här artikeln beskriver SAP HANA Azure Backup på filnivå"
services: virtual-machines-linux
documentationcenter: 
author: hermanndms
manager: timlt
editor: 
ms.service: virtual-machines-linux
ms.devlang: NA
ms.topic: article
ums.tgt_pltfrm: vm-linux
ms.workload: infrastructure-services
ms.date: 3/13/2017
ms.author: rclaus
ms.openlocfilehash: d5a55de5634ac7724e7fd0fa3760c6c408c3db74
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 10/06/2017
---
# <a name="sap-hana-azure-backup-on-file-level"></a><span data-ttu-id="e4396-103">SAP HANA Azure Backup på filnivå</span><span class="sxs-lookup"><span data-stu-id="e4396-103">SAP HANA Azure Backup on file level</span></span>

## <a name="introduction"></a><span data-ttu-id="e4396-104">Introduktion</span><span class="sxs-lookup"><span data-stu-id="e4396-104">Introduction</span></span>

<span data-ttu-id="e4396-105">Detta är en del av en serie i tre delar av relaterade artiklar på SAP HANA-säkerhetskopia.</span><span class="sxs-lookup"><span data-stu-id="e4396-105">This is part of a three-part series of related articles on SAP HANA backup.</span></span> <span data-ttu-id="e4396-106">[Säkerhetskopiering guide för SAP HANA på Azure Virtual Machines](./sap-hana-backup-guide.md) innehåller en översikt och information om att komma igång och [SAP HANA säkerhetskopiering baserat på lagring ögonblicksbilder](./sap-hana-backup-storage-snapshots.md) omfattar hello snapshot-baserad säkerhetskopiering lagringsalternativ.</span><span class="sxs-lookup"><span data-stu-id="e4396-106">[Backup guide for SAP HANA on Azure Virtual Machines](./sap-hana-backup-guide.md) provides an overview and information on getting started, and [SAP HANA backup based on storage snapshots](./sap-hana-backup-storage-snapshots.md) covers hello storage snapshot-based backup option.</span></span>

<span data-ttu-id="e4396-107">Tittar på hello Azure VM-storlekar, kan en se att en GS5 tillåter 64 anslutna diskar.</span><span class="sxs-lookup"><span data-stu-id="e4396-107">Looking at hello Azure VM sizes, one can see that a GS5 allows 64 attached data disks.</span></span> <span data-ttu-id="e4396-108">För stora SAP HANA vidtagit ett stort antal diskar redan för data och loggfiler, eventuellt i kombination med programvarubaserad RAID för disken i/o-genomflöde.</span><span class="sxs-lookup"><span data-stu-id="e4396-108">For large SAP HANA systems, a significant number of disks might already be taken for data and log files, possibly in combination with software RAID for optimal disk IO throughput.</span></span> <span data-ttu-id="e4396-109">hello fråga sedan är där toostore SAP HANA säkerhetskopiera filer, vilket kan fylla hello kopplade data diskar över tid?</span><span class="sxs-lookup"><span data-stu-id="e4396-109">hello question then is where toostore SAP HANA backup files, which could fill up hello attached data disks over time?</span></span> <span data-ttu-id="e4396-110">Se [storlekar för virtuella Linux-datorer i Azure](../../linux/sizes.md) för hello Azure VM storlek tabeller.</span><span class="sxs-lookup"><span data-stu-id="e4396-110">See [Sizes for Linux virtual machines in Azure](../../linux/sizes.md) for hello Azure VM size tables.</span></span>

<span data-ttu-id="e4396-111">Det finns ingen säkerhetskopiering SAP HANA-integrering med Azure Backup-tjänsten just nu.</span><span class="sxs-lookup"><span data-stu-id="e4396-111">There is no SAP HANA backup integration available with Azure Backup service at this time.</span></span> <span data-ttu-id="e4396-112">hello standardmetoden toomanage säkerhetskopiering/återställning till hello filnivå är med en filbaserad säkerhetskopia via SAP HANA Studio eller via SAP HANA SQL-instruktioner.</span><span class="sxs-lookup"><span data-stu-id="e4396-112">hello standard way toomanage backup/restore at hello file level is with a file-based backup via SAP HANA Studio or via SAP HANA SQL statements.</span></span> <span data-ttu-id="e4396-113">Se [System vyer referens och SAP HANA SQL](https://help.sap.com/hana/SAP_HANA_SQL_and_System_Views_Reference_en.pdf) för mer information.</span><span class="sxs-lookup"><span data-stu-id="e4396-113">See [SAP HANA SQL and System Views Reference](https://help.sap.com/hana/SAP_HANA_SQL_and_System_Views_Reference_en.pdf) for more information.</span></span>

![Den här bilden visar hello dialogrutan för hello säkerhetskopiering menyalternativet i SAP HANA Studio](media/sap-hana-backup-file-level/image022.png)

<span data-ttu-id="e4396-115">Den här bilden visar hello dialogrutan för hello säkerhetskopiering menyalternativet i SAP HANA Studio.</span><span class="sxs-lookup"><span data-stu-id="e4396-115">This figure shows hello dialog of hello backup menu item in SAP HANA Studio.</span></span> <span data-ttu-id="e4396-116">När du väljer typen &quot;filen&quot; har toospecify en sökväg i filsystemet för hello där SAP HANA skriver hello säkerhetskopior.</span><span class="sxs-lookup"><span data-stu-id="e4396-116">When choosing type &quot;file,&quot; one has toospecify a path in hello file system where SAP HANA writes hello backup files.</span></span> <span data-ttu-id="e4396-117">Återställningen fungerar hello samma sätt.</span><span class="sxs-lookup"><span data-stu-id="e4396-117">Restore works hello same way.</span></span>

<span data-ttu-id="e4396-118">Det här alternativet låter enkel och direkt framåt, finns men det några överväganden.</span><span class="sxs-lookup"><span data-stu-id="e4396-118">While this choice sounds simple and straight forward, there are some considerations.</span></span> <span data-ttu-id="e4396-119">Som tidigare nämnts, har en begränsning av antalet datadiskar som kan bifogas en Azure VM.</span><span class="sxs-lookup"><span data-stu-id="e4396-119">As mentioned before, an Azure VM has a limitation of number of data disks that can be attached.</span></span> <span data-ttu-id="e4396-120">Det kanske inte kapacitet toostore SAP HANA-säkerhetskopior på hello filsystem för hello VM, beroende på hello storlek hello databas och disk genomströmning krav, som kan handla om programvara RAID med striping över flera diskar.</span><span class="sxs-lookup"><span data-stu-id="e4396-120">There might not be capacity toostore SAP HANA backup files on hello file systems of hello VM, depending on hello size of hello database and disk throughput requirements, which might involve software RAID using striping across multiple data disks.</span></span> <span data-ttu-id="e4396-121">Olika alternativ för att flytta dessa säkerhetskopior, och hantera filen storlek restriktioner och prestanda vid hantering av terabyte data, tillhandahålls nedan.</span><span class="sxs-lookup"><span data-stu-id="e4396-121">Various options for moving these backup files, and managing file size restrictions and performance when handling terabytes of data, are provided later in this article.</span></span>

<span data-ttu-id="e4396-122">Ett annat alternativ som ger större frihet om total kapacitet är Azure blob storage.</span><span class="sxs-lookup"><span data-stu-id="e4396-122">Another option, which offers more freedom regarding total capacity, is Azure blob storage.</span></span> <span data-ttu-id="e4396-123">En enda blob är också begränsad too1 TB, är hello total kapacitet för en enda blob-behållare för närvarande 500 TB.</span><span class="sxs-lookup"><span data-stu-id="e4396-123">While a single blob is also restricted too1 TB, hello total capacity of a single blob container is currently 500 TB.</span></span> <span data-ttu-id="e4396-124">Dessutom ger kunder hello choice tooselect s.k. &quot;kall&quot; blob-lagring, som har en kostnad.</span><span class="sxs-lookup"><span data-stu-id="e4396-124">Additionally, it gives customers hello choice tooselect so-called &quot;cool&quot; blob storage, which has a cost benefit.</span></span> <span data-ttu-id="e4396-125">Se [Azure Blob Storage: frekvent och kall lagringsnivåer](../../../storage/blobs/storage-blob-storage-tiers.md) för ytterligare information om kall blob-lagring.</span><span class="sxs-lookup"><span data-stu-id="e4396-125">See [Azure Blob Storage: Hot and cool storage tiers](../../../storage/blobs/storage-blob-storage-tiers.md) for details about cool blob storage.</span></span>

<span data-ttu-id="e4396-126">Använd en georeplikerad storage-konto toostore hello SAP HANA säkerhetskopieringar för ytterligare säkerhet.</span><span class="sxs-lookup"><span data-stu-id="e4396-126">For additional safety, use a geo-replicated storage account toostore hello SAP HANA backups.</span></span> <span data-ttu-id="e4396-127">Se [Azure Storage-replikering](../../../storage/common/storage-redundancy.md) mer information om replikering av lagringskonton.</span><span class="sxs-lookup"><span data-stu-id="e4396-127">See [Azure Storage replication](../../../storage/common/storage-redundancy.md) for details about storage account replication.</span></span>

<span data-ttu-id="e4396-128">En kunde placera dedikerade virtuella hårddiskar för SAP HANA säkerhetskopieringar i en dedikerad backup storage-konto som är georeplikerad.</span><span class="sxs-lookup"><span data-stu-id="e4396-128">One could place dedicated VHDs for SAP HANA backups in a dedicated backup storage account that is geo-replicated.</span></span> <span data-ttu-id="e4396-129">Annars en gick att kopiera hello virtuella hårddiskar som behåller hello SAP HANA säkerhetskopior tooa georeplikerad lagringskonto eller tooa storage-konto som tillhör en annan region.</span><span class="sxs-lookup"><span data-stu-id="e4396-129">Or else one could copy hello VHDs that keep hello SAP HANA backups tooa geo-replicated storage account, or tooa storage account that is in a different region.</span></span>

## <a name="azure-backup-agent"></a><span data-ttu-id="e4396-130">Azure backup-agenten</span><span class="sxs-lookup"><span data-stu-id="e4396-130">Azure backup agent</span></span>

<span data-ttu-id="e4396-131">Azure backup erbjuder hello alternativet toonot bara säkerhetskopiera fullständig virtuella datorer, men även filer och kataloger via hello säkerhetskopieringsagent som har toobe installerad på hello gästoperativsystemet.</span><span class="sxs-lookup"><span data-stu-id="e4396-131">Azure backup offers hello option toonot only back up complete VMs, but also files and directories via hello backup agent, which has toobe installed on hello guest OS.</span></span> <span data-ttu-id="e4396-132">Men från och med December 2016 agenten bara stöds på Windows (se [säkerhetskopiering av en Windows Server eller klient tooAzure med hello Resource Manager-distributionsmodellen](../../../backup/backup-configure-vault.md)).</span><span class="sxs-lookup"><span data-stu-id="e4396-132">But as of December 2016, this agent is only supported on Windows (see [Back up a Windows Server or client tooAzure using hello Resource Manager deployment model](../../../backup/backup-configure-vault.md)).</span></span>

<span data-ttu-id="e4396-133">En lösning är toofirst kopia SAP HANA säkerhetskopior tooa Windows VM i Azure (till exempel via SAMBA-resurs) och sedan använda hello Azure backup-agenten därifrån.</span><span class="sxs-lookup"><span data-stu-id="e4396-133">A workaround is toofirst copy SAP HANA backup files tooa Windows VM on Azure (for example, via SAMBA share) and then use hello Azure backup agent from there.</span></span> <span data-ttu-id="e4396-134">När det är tekniskt möjligt skulle den komplexiteten och långsammare hello säkerhetskopieringen eller återställningen ganska lite på grund av toohello kopiera mellan hello Linux och hello Windows VM.</span><span class="sxs-lookup"><span data-stu-id="e4396-134">While it is technically possible, it would add complexity and slow down hello backup or restore process quite a bit due toohello copy between hello Linux and hello Windows VM.</span></span> <span data-ttu-id="e4396-135">Det är inte rekommenderat toofollow den här metoden.</span><span class="sxs-lookup"><span data-stu-id="e4396-135">It is not recommended toofollow this approach.</span></span>

## <a name="azure-blobxfer-utility-details"></a><span data-ttu-id="e4396-136">Information om verktyget Azure blobxfer</span><span class="sxs-lookup"><span data-stu-id="e4396-136">Azure blobxfer utility details</span></span>

<span data-ttu-id="e4396-137">toostore kataloger och filer på Azure storage, en kan använda CLI eller PowerShell, eller utveckla ett verktyg med någon av hello [Azure SDK](https://azure.microsoft.com/downloads/).</span><span class="sxs-lookup"><span data-stu-id="e4396-137">toostore directories and files on Azure storage, one could use CLI or PowerShell, or develop a tool using one of hello [Azure SDKs](https://azure.microsoft.com/downloads/).</span></span> <span data-ttu-id="e4396-138">Det finns också en färdiga att använda verktyget AzCopy, för att kopiera tooAzure datalagring, men det är bara Windows (se [överföra data med hello AzCopy Command-Line verktyget](../../../storage/common/storage-use-azcopy.md)).</span><span class="sxs-lookup"><span data-stu-id="e4396-138">There is also a ready-to-use utility, AzCopy, for copying data tooAzure storage, but it is Windows only (see [Transfer data with hello AzCopy Command-Line Utility](../../../storage/common/storage-use-azcopy.md)).</span></span>

<span data-ttu-id="e4396-139">Därför användes blobxfer för att kopiera säkerhetskopieringsfilerna för SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="e4396-139">Therefore blobxfer was used for copying SAP HANA backup files.</span></span> <span data-ttu-id="e4396-140">Det är öppen källkod som används av många kunder i produktionsmiljöer och finns på [GitHub](https://github.com/Azure/blobxfer).</span><span class="sxs-lookup"><span data-stu-id="e4396-140">It is open source, used by many customers in production environments, and available on [GitHub](https://github.com/Azure/blobxfer).</span></span> <span data-ttu-id="e4396-141">Det här verktyget kan en toocopy data direkt tooeither Azure blob storage eller Azure-filresursen.</span><span class="sxs-lookup"><span data-stu-id="e4396-141">This tool allows one toocopy data directly tooeither Azure blob storage or Azure file share.</span></span> <span data-ttu-id="e4396-142">Den erbjuder också ett antal användbara funktioner, till exempel md5-hash eller automatisk parallellitet när du kopierar en katalog med flera filer.</span><span class="sxs-lookup"><span data-stu-id="e4396-142">It also offers a range of useful features, like md5 hash or automatic parallelism when copying a directory with multiple files.</span></span>

## <a name="sap-hana-backup-performance"></a><span data-ttu-id="e4396-143">SAP HANA säkerhetskopieringsprestanda</span><span class="sxs-lookup"><span data-stu-id="e4396-143">SAP HANA backup performance</span></span>

![Den här skärmbilden har hello SAP HANA säkerhetskopiering konsolen i SAP HANA Studio](media/sap-hana-backup-file-level/image023.png)

<span data-ttu-id="e4396-145">Den här skärmbilden har hello SAP HANA säkerhetskopiering konsolen i SAP HANA Studio.</span><span class="sxs-lookup"><span data-stu-id="e4396-145">This screenshot is of hello SAP HANA backup console in SAP HANA Studio.</span></span> <span data-ttu-id="e4396-146">Det tog ungefär 42 minuter toodo hello säkerhetskopiering av hello 230 GB på en enda Azure standardlagring disk ansluten toohello HANA VM XFS-filsystemet.</span><span class="sxs-lookup"><span data-stu-id="e4396-146">It took about 42 minutes toodo hello backup of hello 230 GB on a single Azure standard storage disk attached toohello HANA VM using XFS file system.</span></span>

![Den här skärmbilden har YaST på hello SAP HANA test VM](media/sap-hana-backup-file-level/image024.png)

<span data-ttu-id="e4396-148">Den här skärmbilden har YaST på hello SAP HANA test VM.</span><span class="sxs-lookup"><span data-stu-id="e4396-148">This screenshot is of YaST on hello SAP HANA test VM.</span></span> <span data-ttu-id="e4396-149">En kan se hello 1 TB enskild disk för SAP HANA-säkerhetskopiering som tidigare nämnts.</span><span class="sxs-lookup"><span data-stu-id="e4396-149">One can see hello 1-TB single disk for SAP HANA backup as mentioned before.</span></span> <span data-ttu-id="e4396-150">Det tog ungefär 42 minuter toobackup 230 GB.</span><span class="sxs-lookup"><span data-stu-id="e4396-150">It took about 42 minutes toobackup 230 GB.</span></span> <span data-ttu-id="e4396-151">Dessutom fem 200 GB diskar har anslutits och programvara RAID md0 skapats med striping ovanpå diskarna fem Azure data.</span><span class="sxs-lookup"><span data-stu-id="e4396-151">In addition, five 200-GB disks were attached and software RAID md0 created, with striping on top of these five Azure data disks.</span></span>

![Upprepa samma säkerhetskopiera på programvarubaserad RAID med striping över fem hello anslutna Azure standardlagring datadiskar](media/sap-hana-backup-file-level/image025.png)

<span data-ttu-id="e4396-153">Upprepande hello samma säkerhetskopiera på programvarubaserad RAID med striping över fem anslutna Azure standardlagring data diskar tas hello tid för säkerhetskopiering från 42 minuter ned too10 minuter.</span><span class="sxs-lookup"><span data-stu-id="e4396-153">Repeating hello same backup on software RAID with striping across five attached Azure standard storage data disks brought hello backup time from 42 minutes down too10 minutes.</span></span> <span data-ttu-id="e4396-154">hello diskar har anslutits utan att cachelagra toohello VM.</span><span class="sxs-lookup"><span data-stu-id="e4396-154">hello disks were attached without caching toohello VM.</span></span> <span data-ttu-id="e4396-155">Det är därför uppenbara hur viktigt disk genomströmning för skrivning avser hello tid för säkerhetskopiering.</span><span class="sxs-lookup"><span data-stu-id="e4396-155">So it is obvious how important disk write throughput is for hello backup time.</span></span> <span data-ttu-id="e4396-156">Något gick sedan växeln tooAzure premium storage toofurther påskynda hello process för optimala prestanda.</span><span class="sxs-lookup"><span data-stu-id="e4396-156">One could then switch tooAzure premium storage toofurther accelerate hello process for optimal performance.</span></span> <span data-ttu-id="e4396-157">I allmänhet ska Azure premium-lagring användas för produktionssystem.</span><span class="sxs-lookup"><span data-stu-id="e4396-157">In general, Azure premium storage should be used for production systems.</span></span>

## <a name="copy-sap-hana-backup-files-tooazure-blob-storage"></a><span data-ttu-id="e4396-158">Kopiera SAP HANA säkerhetskopior tooAzure blob-lagring</span><span class="sxs-lookup"><span data-stu-id="e4396-158">Copy SAP HANA backup files tooAzure blob storage</span></span>

<span data-ttu-id="e4396-159">December 2016 hello bästa alternativet tooquickly store SAP HANA säkerhetskopior är Azure-blobblagring.</span><span class="sxs-lookup"><span data-stu-id="e4396-159">As of December 2016, hello best option tooquickly store SAP HANA backup files is Azure blob storage.</span></span> <span data-ttu-id="e4396-160">En enda blob-behållare är begränsad till 500 TB tillräckligt för de flesta SAP HANA-system, körs i en GS5 virtuell dator på Azure, tookeep tillräckligt SAP HANA-säkerhetskopieringar.</span><span class="sxs-lookup"><span data-stu-id="e4396-160">One single blob container has a limit of 500 TB, enough for most SAP HANA systems, running in a GS5 VM on Azure, tookeep sufficient SAP HANA backups.</span></span> <span data-ttu-id="e4396-161">Kunder har hello val mellan &quot;varm&quot; och &quot;kalla&quot; blob-lagring (finns [Azure Blob Storage: frekvent och kall lagringsnivåer](../../../storage/blobs/storage-blob-storage-tiers.md)).</span><span class="sxs-lookup"><span data-stu-id="e4396-161">Customers have hello choice between &quot;hot&quot; and &quot;cold&quot; blob storage (see [Azure Blob Storage: Hot and cool storage tiers](../../../storage/blobs/storage-blob-storage-tiers.md)).</span></span>

<span data-ttu-id="e4396-162">Med hello blobxfer verktyget är det enkelt toocopy hello SAP HANA säkerhetskopierade filer direkt tooAzure blob storage.</span><span class="sxs-lookup"><span data-stu-id="e4396-162">With hello blobxfer tool, it is easy toocopy hello SAP HANA backup files directly tooAzure blob storage.</span></span>

![Här ser en hello filer av en fullständig säkerhetskopia för SAP HANA](media/sap-hana-backup-file-level/image026.png)

<span data-ttu-id="e4396-164">Här ser en hello filer av en fullständig säkerhetskopia för SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="e4396-164">Here one can see hello files of a full SAP HANA file backup.</span></span> <span data-ttu-id="e4396-165">Det finns fyra filer och hello största har ungefär 230 GB.</span><span class="sxs-lookup"><span data-stu-id="e4396-165">There are four files and hello biggest one has roughly 230 GB.</span></span>

![Det tog ungefär 3000 sekunder toocopy hello 230 GB tooan Azure standardlagring konto blob-behållare](media/sap-hana-backup-file-level/image027.png)

<span data-ttu-id="e4396-167">Inte använder md5-hash i hello inledande test, som det tog ungefär 3000 sekunder toocopy hello 230 GB tooan Azure standardlagring konto blob-behållare.</span><span class="sxs-lookup"><span data-stu-id="e4396-167">Not using md5 hash in hello initial test, it took roughly 3000 seconds toocopy hello 230 GB tooan Azure standard storage account blob container.</span></span>

![I den här skärmbilden kan en se hur den ser ut på hello Azure-portalen](media/sap-hana-backup-file-level/image028.png)

<span data-ttu-id="e4396-169">I den här skärmbilden kan en se hur den ser ut på hello Azure-portalen.</span><span class="sxs-lookup"><span data-stu-id="e4396-169">In this screenshot, one can see how it looks on hello Azure portal.</span></span> <span data-ttu-id="e4396-170">En blobbbehållare med namnet &quot;sap-hana-säkerhetskopior&quot; har skapats och innehåller hello fyra blobbar som representerar hello SAP HANA-säkerhetskopior.</span><span class="sxs-lookup"><span data-stu-id="e4396-170">A blob container named &quot;sap-hana-backups&quot; was created and includes hello four blobs, which represent hello SAP HANA backup files.</span></span> <span data-ttu-id="e4396-171">En av dem har en storlek på ungefär 230 GB.</span><span class="sxs-lookup"><span data-stu-id="e4396-171">One of them has a size of roughly 230 GB.</span></span>

<span data-ttu-id="e4396-172">hello HANA Studio säkerhetskopiering konsolen kan en toorestrict hello maximal filstorlek HANA säkerhetskopiering av filer.</span><span class="sxs-lookup"><span data-stu-id="e4396-172">hello HANA Studio backup console allows one toorestrict hello max file size of HANA backup files.</span></span> <span data-ttu-id="e4396-173">I hello exempel miljö bättre prestanda genom att göra det möjligt toohave flera mindre säkerhetskopieringsfilerna, i stället för en stor 230 GB-fil.</span><span class="sxs-lookup"><span data-stu-id="e4396-173">In hello sample environment, it improved performance by making it possible toohave multiple smaller backup files, instead of one large 230-GB file.</span></span>

![Ange storleksgränsen för hello säkerhetskopian på hello HANA på klientsidan & #39, t förbättra hello tid för säkerhetskopiering](media/sap-hana-backup-file-level/image029.png)

<span data-ttu-id="e4396-175">Ange storleksgränsen för hello säkerhetskopian på hello HANA på klientsidan &#39; t förbättra hello tid för säkerhetskopiering, eftersom hello skrivs i tur och ordning som visas i bilden.</span><span class="sxs-lookup"><span data-stu-id="e4396-175">Setting hello backup file size limit on hello HANA side doesn&#39;t improve hello backup time, because hello files are written sequentially as shown in this figure.</span></span> <span data-ttu-id="e4396-176">hello storleksbegränsningen angavs too60 GB, så hello säkerhetskopiering skapas fyra stora datafiler i stället för hello 230 GB med en fil.</span><span class="sxs-lookup"><span data-stu-id="e4396-176">hello file size limit was set too60 GB, so hello backup created four large data files instead of hello 230-GB single file.</span></span>

![tootest parallellitet hello blobxfer verktyget Hej max storlek för HANA säkerhetskopieringar angavs sedan too15 GB](media/sap-hana-backup-file-level/image030.png)

<span data-ttu-id="e4396-178">tootest parallellitet hello blobxfer verktyget Hej max storlek för HANA säkerhetskopieringar angavs sedan too15 GB, vilket resulterade i 19 säkerhetskopior.</span><span class="sxs-lookup"><span data-stu-id="e4396-178">tootest parallelism of hello blobxfer tool, hello max file size for HANA backups was then set too15 GB, which resulted in 19 backup files.</span></span> <span data-ttu-id="e4396-179">Den här konfigurationen tas hello tid för blobxfer toocopy hello 230 GB tooAzure blob storage från 3000 sekunder too875 sekunder.</span><span class="sxs-lookup"><span data-stu-id="e4396-179">This configuration brought hello time for blobxfer toocopy hello 230 GB tooAzure blob storage from 3000 seconds down too875 seconds.</span></span>

<span data-ttu-id="e4396-180">Det här resultatet är på grund av toohello högst 60 MB per sekund för att skriva en Azure blob.</span><span class="sxs-lookup"><span data-stu-id="e4396-180">This result is due toohello limit of 60 MB/sec for writing an Azure blob.</span></span> <span data-ttu-id="e4396-181">Parallellitet via flera BLOB löser hello flaskhals, men det finns en nackdelen: öka prestanda för hello blobxfer verktyget toocopy alla dessa HANA säkerhetskopior tooAzure blobblagring placerar belastningen på både hello HANA VM och hello nätverk.</span><span class="sxs-lookup"><span data-stu-id="e4396-181">Parallelism via multiple blobs solves hello bottleneck, but there is a downside: increasing performance of hello blobxfer tool toocopy all these HANA backup files tooAzure blob storage puts load on both hello HANA VM and hello network.</span></span> <span data-ttu-id="e4396-182">HANA systemet blir påverkas.</span><span class="sxs-lookup"><span data-stu-id="e4396-182">Operation of HANA system becomes impacted.</span></span>

## <a name="blob-copy-of-dedicated-azure-data-disks-in-backup-software-raid"></a><span data-ttu-id="e4396-183">BLOB-kopia av dedikerade Azure diskar i säkerhetskopieringsprogrammet RAID</span><span class="sxs-lookup"><span data-stu-id="e4396-183">Blob copy of dedicated Azure data disks in backup software RAID</span></span>

<span data-ttu-id="e4396-184">Till skillnad från hello manuell VM data disksäkerhetskopiering, i den här metoden en loggar säkerhetskopiera alla data hello-diskar på en VM toosave hello hela SAP-installation, inklusive HANA data HANA inte filer och konfigurationsfiler.</span><span class="sxs-lookup"><span data-stu-id="e4396-184">Unlike hello manual VM data disk backup, in this approach one does not back up all hello data disks on a VM toosave hello whole SAP installation, including HANA data, HANA log files, and config files.</span></span> <span data-ttu-id="e4396-185">I stället hello idé är toohave dedikerad programvarubaserad RAID med striping över flera Azure data virtuella hårddiskar för lagring av en fullständig säkerhetskopia för SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="e4396-185">Instead, hello idea is toohave dedicated software RAID with striping across multiple Azure data VHDs for storing a full SAP HANA file backup.</span></span> <span data-ttu-id="e4396-186">En kopieras endast de diskar som har hello SAP HANA-säkerhetskopia.</span><span class="sxs-lookup"><span data-stu-id="e4396-186">One copies only these disks, which have hello SAP HANA backup.</span></span> <span data-ttu-id="e4396-187">De enkelt ska lagras i ett dedikerat HANA backup storage-konto eller kopplade tooa dedikerade &quot;säkerhetskopiera management VM&quot; för vidare bearbetning.</span><span class="sxs-lookup"><span data-stu-id="e4396-187">They could easily be kept in a dedicated HANA backup storage account, or attached tooa dedicated &quot;backup management VM&quot; for further processing.</span></span>

![Alla virtuella hårddiskar som har kopierats med hello ** start-azurestorageblobcopy ** PowerShell-kommando](media/sap-hana-backup-file-level/image031.png)

<span data-ttu-id="e4396-189">När hello säkerhetskopiering toohello lokala programvarubaserad RAID har slutfört alla virtuella hårddiskar som kopierades med hello **start azurestorageblobcopy** PowerShell-kommando (se [Start AzureStorageBlobCopy](/powershell/module/azure.storage/start-azurestorageblobcopy)).</span><span class="sxs-lookup"><span data-stu-id="e4396-189">After hello backup toohello local software RAID was completed, all VHDs involved were copied using hello **start-azurestorageblobcopy** PowerShell command (see [Start-AzureStorageBlobCopy](/powershell/module/azure.storage/start-azurestorageblobcopy)).</span></span> <span data-ttu-id="e4396-190">Eftersom det påverkar endast hello dedikerad filsystemet för att hålla hello säkerhetskopior, finns det inga frågor om konsekvens för SAP HANA-data eller loggfil fil på disken hello.</span><span class="sxs-lookup"><span data-stu-id="e4396-190">As it only affects hello dedicated file system for keeping hello backup files, there are no concerns about SAP HANA data or log file consistency on hello disk.</span></span> <span data-ttu-id="e4396-191">En fördel med det här kommandot är att det fungerar samtidigt hello VM fortfarande är online.</span><span class="sxs-lookup"><span data-stu-id="e4396-191">A benefit of this command is that it works while hello VM stays online.</span></span> <span data-ttu-id="e4396-192">toobe vissa att det finns ingen process skrivs toohello säkerhetskopiering speglings vara säker på att toounmount den innan hello blob kopia och montera den igen efteråt.</span><span class="sxs-lookup"><span data-stu-id="e4396-192">toobe certain that no process writes toohello backup stripe set, be sure toounmount it before hello blob copy, and mount it again afterwards.</span></span> <span data-ttu-id="e4396-193">En kan också använda ett lämpligt sätt för&quot;låsa&quot; hello filsystem.</span><span class="sxs-lookup"><span data-stu-id="e4396-193">Or one could use an appropriate way too&quot;freeze&quot; hello file system.</span></span> <span data-ttu-id="e4396-194">Till exempel via xfs\_Lås för hello XFS filsystem.</span><span class="sxs-lookup"><span data-stu-id="e4396-194">For example, via xfs\_freeze for hello XFS file system.</span></span>

![Den här skärmbilden visar hello lista över blobbar i behållaren för hello virtuella hårddiskar på hello Azure-portalen](media/sap-hana-backup-file-level/image032.png)

<span data-ttu-id="e4396-196">Den här skärmbilden visar hello lista över blobbar på hello &quot;virtuella hårddiskar&quot; behållare på hello Azure-portalen.</span><span class="sxs-lookup"><span data-stu-id="e4396-196">This screenshot shows hello list of blobs in hello &quot;vhds&quot; container on hello Azure portal.</span></span> <span data-ttu-id="e4396-197">hello skärmbild som visar hello fem VHD som bifogades toohello SAP HANA server VM tooserve som hello programvara RAID tookeep SAP HANA säkerhetskopior.</span><span class="sxs-lookup"><span data-stu-id="e4396-197">hello screenshot shows hello five VHDs, which were attached toohello SAP HANA server VM tooserve as hello software RAID tookeep SAP HANA backup files.</span></span> <span data-ttu-id="e4396-198">Den visar även hello fem kopior som togs via hello blob kopieringskommandot.</span><span class="sxs-lookup"><span data-stu-id="e4396-198">It also shows hello five copies, which were taken via hello blob copy command.</span></span>

![I testsyfte kan var hello kopior av hello SAP HANA säkerhetskopieringsprogrammet RAID-diskar anslutna toohello applikationsserver VM](media/sap-hana-backup-file-level/image033.png)

<span data-ttu-id="e4396-200">För testning, kunde hello kopior av hello SAP HANA säkerhetskopieringsprogrammet RAID-diskar anslutna toohello app-servern VM.</span><span class="sxs-lookup"><span data-stu-id="e4396-200">For testing purposes, hello copies of hello SAP HANA backup software RAID disks were attached toohello app server VM.</span></span>

![hello app-servern VM stängdes tooattach hello diskkopior](media/sap-hana-backup-file-level/image034.png)

<span data-ttu-id="e4396-202">hello app-servern VM stängdes tooattach hello diskkopior.</span><span class="sxs-lookup"><span data-stu-id="e4396-202">hello app server VM was shut down tooattach hello disk copies.</span></span> <span data-ttu-id="e4396-203">När du har startat hello VM hello diskar och hello RAID har identifierats på rätt sätt (monterade via UUID).</span><span class="sxs-lookup"><span data-stu-id="e4396-203">After starting hello VM, hello disks and hello RAID were discovered correctly (mounted via UUID).</span></span> <span data-ttu-id="e4396-204">Endast hello monteringspunkt saknas, som har skapats via hello YaST partitioneraren.</span><span class="sxs-lookup"><span data-stu-id="e4396-204">Only hello mount point was missing, which was created via hello YaST partitioner.</span></span> <span data-ttu-id="e4396-205">Hello SAP HANA säkerhetskopian kopior blev därefter visas på OS-nivå.</span><span class="sxs-lookup"><span data-stu-id="e4396-205">Afterwards hello SAP HANA backup file copies became visible on OS level.</span></span>

## <a name="copy-sap-hana-backup-files-toonfs-share"></a><span data-ttu-id="e4396-206">Kopiera SAP HANA säkerhetskopieringsfiler tooNFS dela</span><span class="sxs-lookup"><span data-stu-id="e4396-206">Copy SAP HANA backup files tooNFS share</span></span>

<span data-ttu-id="e4396-207">toolessen hello inverkan på hello SAP HANA-system från ett prestandaproblem eller disk space perspektiv, ett kan du överväga att spara hello SAP HANA säkerhetskopierade filer på en NFS-resurs.</span><span class="sxs-lookup"><span data-stu-id="e4396-207">toolessen hello potential impact on hello SAP HANA system from a performance or disk space perspective, one might consider storing hello SAP HANA backup files on an NFS share.</span></span> <span data-ttu-id="e4396-208">Tekniskt sett fungerar, men innebär med andra Azure-VM som hello värden för hello NFS-resursens.</span><span class="sxs-lookup"><span data-stu-id="e4396-208">Technically it works, but it means using a second Azure VM as hello host of hello NFS share.</span></span> <span data-ttu-id="e4396-209">Det får inte vara en mindre VM-storlek på grund av toohello VM nätverkets bandbredd.</span><span class="sxs-lookup"><span data-stu-id="e4396-209">It should not be a small VM size, due toohello VM network bandwidth.</span></span> <span data-ttu-id="e4396-210">Det blir meningsfullt sedan tooshut ned detta &quot;säkerhetskopiera VM&quot; och bara ta dig köra hello SAP HANA-säkerhetskopiering.</span><span class="sxs-lookup"><span data-stu-id="e4396-210">It would make sense then tooshut down this &quot;backup VM&quot; and only bring it up for executing hello SAP HANA backup.</span></span> <span data-ttu-id="e4396-211">Skriva på en NFS resursen placerar belastningen på nätverket hello och påverkan hello SAP HANA-system, men bara hantera hello säkerhetskopior efteråt på hello &quot;säkerhetskopiera VM&quot; inte skulle påverka hello SAP HANA system alls.</span><span class="sxs-lookup"><span data-stu-id="e4396-211">Writing on an NFS share puts load on hello network and impacts hello SAP HANA system, but merely managing hello backup files afterwards on hello &quot;backup VM&quot; would not influence hello SAP HANA system at all.</span></span>

![En NFS-resurs från en annan Azure VM är monterade toohello SAP HANA server VM](media/sap-hana-backup-file-level/image035.png)

<span data-ttu-id="e4396-213">tooverify hello NFS användningsfall, en NFS-resurs från en annan Azure VM är monterade toohello SAP HANA server VM.</span><span class="sxs-lookup"><span data-stu-id="e4396-213">tooverify hello NFS use case, an NFS share from another Azure VM was mounted toohello SAP HANA server VM.</span></span> <span data-ttu-id="e4396-214">Det fanns ingen särskild NFS justera tillämpas.</span><span class="sxs-lookup"><span data-stu-id="e4396-214">There was no special NFS tuning applied.</span></span>

![Det tog 1 timme och 46 minuter toodo hello säkerhetskopiering direkt](media/sap-hana-backup-file-level/image036.png)

<span data-ttu-id="e4396-216">hello NFS-resurs har en snabb stripe-uppsättning som hello en på hello SAP HANA-servern.</span><span class="sxs-lookup"><span data-stu-id="e4396-216">hello NFS share was a fast stripe set, like hello one on hello SAP HANA server.</span></span> <span data-ttu-id="e4396-217">Dock tog det 1 timme och 46 minuter toodo hello säkerhetskopiering direkt på hello NFS-resurs i stället för tio minuter när du skriver tooa lokala stripe-uppsättning.</span><span class="sxs-lookup"><span data-stu-id="e4396-217">Nevertheless, it took 1 hour and 46 minutes toodo hello backup directly on hello NFS share instead of 10 minutes, when writing tooa local stripe set.</span></span>

![hello alternativ inte mycket snabbare på 1 timme och 43 minuter](media/sap-hana-backup-file-level/image037.png)

<span data-ttu-id="e4396-219">hello alternativ för att göra en säkerhetskopiering tooa lokala stripe-uppsättning och kopiera toohello NFS-resursens på OS-nivå (en enkel **cp - avr** kommando) inte mycket snabbare.</span><span class="sxs-lookup"><span data-stu-id="e4396-219">hello alternative of doing a backup tooa local stripe set and copying toohello NFS share on OS level (a simple **cp -avr** command) wasn't much quicker.</span></span> <span data-ttu-id="e4396-220">Det tog 1 timme och 43 minuter.</span><span class="sxs-lookup"><span data-stu-id="e4396-220">It took 1 hour and 43 minutes.</span></span>

<span data-ttu-id="e4396-221">Så här fungerar det, men prestanda inte bra för hello 230 GB säkerhetskopiering test.</span><span class="sxs-lookup"><span data-stu-id="e4396-221">So it works, but performance wasn't good for hello 230-GB backup test.</span></span> <span data-ttu-id="e4396-222">Det ser ut ännu större för flera terabyte.</span><span class="sxs-lookup"><span data-stu-id="e4396-222">It would look even worse for multi terabytes.</span></span>

## <a name="copy-sap-hana-backup-files-tooazure-file-service"></a><span data-ttu-id="e4396-223">Kopiera SAP HANA säkerhetskopior tooAzure filtjänst</span><span class="sxs-lookup"><span data-stu-id="e4396-223">Copy SAP HANA backup files tooAzure file service</span></span>

<span data-ttu-id="e4396-224">Det är möjligt toomount en Azure-filresurs i en Azure Linux-dator.</span><span class="sxs-lookup"><span data-stu-id="e4396-224">It is possible toomount an Azure file share inside an Azure Linux VM.</span></span> <span data-ttu-id="e4396-225">hello artikel [hur toouse Azure File storage med Linux](../../../storage/files/storage-how-to-use-files-linux.md) innehåller information om hur toodo den.</span><span class="sxs-lookup"><span data-stu-id="e4396-225">hello article [How toouse Azure File storage with Linux](../../../storage/files/storage-how-to-use-files-linux.md) provides details on how toodo it.</span></span> <span data-ttu-id="e4396-226">Tänk på att det finns för närvarande en 5 TB kvotgräns för en Azure-filresursen och begränsningar för filstorleken på 1 TB per fil.</span><span class="sxs-lookup"><span data-stu-id="e4396-226">Keep in mind that there is currently a 5-TB quota limit of one Azure file share, and a file size limit of 1 TB per file.</span></span> <span data-ttu-id="e4396-227">Se [Azure Storage skalbarhets- och prestandamål](../../../storage/common/storage-scalability-targets.md) information om Lagringsgränser.</span><span class="sxs-lookup"><span data-stu-id="e4396-227">See [Azure Storage Scalability and Performance Targets](../../../storage/common/storage-scalability-targets.md) for information on storage limits.</span></span>

<span data-ttu-id="e4396-228">Testerna har visas dock som SAP HANA säkerhetskopiering inte &#39; t just nu arbetar direkt med den här typen av CIFS monteringspunkt.</span><span class="sxs-lookup"><span data-stu-id="e4396-228">Tests have shown, however, that SAP HANA backup doesn&#39;t currently work directly with this kind of CIFS mount.</span></span> <span data-ttu-id="e4396-229">Anges också i [SAP Obs 1820529](https://launchpad.support.sap.com/#/notes/1820529) som CIFS rekommenderas inte.</span><span class="sxs-lookup"><span data-stu-id="e4396-229">It is also stated in [SAP Note 1820529](https://launchpad.support.sap.com/#/notes/1820529) that CIFS is not recommended.</span></span>

![Den här bilden visar ett fel i hello säkerhetskopiering i SAP HANA Studio](media/sap-hana-backup-file-level/image038.png)

<span data-ttu-id="e4396-231">Den här bilden visar ett fel i hello säkerhetskopiering i SAP HANA Studio vid tooback upp direkt tooa CIFS monterade Azure-filresursen.</span><span class="sxs-lookup"><span data-stu-id="e4396-231">This figure shows an error in hello backup dialog in SAP HANA Studio, when trying tooback up directly tooa CIFS-mounted Azure file share.</span></span> <span data-ttu-id="e4396-232">Så att en har toodo en standard säkerhetskopiering för SAP HANA i ett VM-filsystem först och sedan kopiera hello säkerhetskopieringsfilerna från tooAzure filtjänst.</span><span class="sxs-lookup"><span data-stu-id="e4396-232">So one has toodo a standard SAP HANA backup into a VM file system first, and then copy hello backup files from there tooAzure file service.</span></span>

![Den här bilden visar att det tog om 929 sekunder toocopy 19 SAP HANA-säkerhetskopior](media/sap-hana-backup-file-level/image039.png)

<span data-ttu-id="e4396-234">Den här bilden visar att det tog om 929 sekunder toocopy 19 SAP HANA säkerhetskopieringsfiler med en total storlek på ungefär 230 GB toohello Azure-filresursen.</span><span class="sxs-lookup"><span data-stu-id="e4396-234">This figure shows that it took about 929 seconds toocopy 19 SAP HANA backup files with a total size of roughly 230 GB toohello Azure file share.</span></span>

![hello källa katalogstrukturen på hello SAP HANA VM har kopierade toohello Azure-filresursen](media/sap-hana-backup-file-level/image040.png)

<span data-ttu-id="e4396-236">I den här skärmbilden kan en se var kopierade toohello Azure-filresursen genom att hello källa katalogstrukturen på hello SAP HANA VM: en katalog (hana\_säkerhetskopiering\_fsl\_15 gb) och 19 enskilda säkerhetskopior.</span><span class="sxs-lookup"><span data-stu-id="e4396-236">In this screenshot, one can see that hello source directory structure on hello SAP HANA VM was copied toohello Azure file share: one directory (hana\_backup\_fsl\_15gb) and 19 individual backup files.</span></span>

<span data-ttu-id="e4396-237">Lagra säkerhetskopior för SAP HANA på Azure-filer kan vara ett intressanta alternativ i hello framtida när säkerhetskopiorna för SAP HANA stöder direkt.</span><span class="sxs-lookup"><span data-stu-id="e4396-237">Storing SAP HANA backup files on Azure files could be an interesting option in hello future when SAP HANA file backups support it directly.</span></span> <span data-ttu-id="e4396-238">Eller när den blir möjligt toomount Azure filer via NFS och hello största kvot är avsevärt högre än 5 TB.</span><span class="sxs-lookup"><span data-stu-id="e4396-238">Or when it becomes possible toomount Azure files via NFS and hello maximum quota limit is considerably higher than 5 TB.</span></span>

## <a name="next-steps"></a><span data-ttu-id="e4396-239">Nästa steg</span><span class="sxs-lookup"><span data-stu-id="e4396-239">Next steps</span></span>
* <span data-ttu-id="e4396-240">[Säkerhetskopiering guide för SAP HANA på Azure Virtual Machines](sap-hana-backup-guide.md) ger en översikt och information om att komma igång.</span><span class="sxs-lookup"><span data-stu-id="e4396-240">[Backup guide for SAP HANA on Azure Virtual Machines](sap-hana-backup-guide.md) gives an overview and information on getting started.</span></span>
* <span data-ttu-id="e4396-241">[SAP HANA säkerhetskopiering baserat på lagring ögonblicksbilder](sap-hana-backup-storage-snapshots.md) beskriver hello snapshot-baserad säkerhetskopiering lagringsalternativ.</span><span class="sxs-lookup"><span data-stu-id="e4396-241">[SAP HANA backup based on storage snapshots](sap-hana-backup-storage-snapshots.md) describes hello storage snapshot-based backup option.</span></span>
* <span data-ttu-id="e4396-242">hur tooestablish hög tillgänglighet och planera för katastrofåterställning för SAP HANA i Azure (stora instanser), se toolearn [SAP HANA (stora instanser) hög tillgänglighet och katastrofåterställning recovery på Azure](hana-overview-high-availability-disaster-recovery.md).</span><span class="sxs-lookup"><span data-stu-id="e4396-242">toolearn how tooestablish high availability and plan for disaster recovery of SAP HANA on Azure (large instances), see [SAP HANA (large instances) high availability and disaster recovery on Azure](hana-overview-high-availability-disaster-recovery.md).</span></span>
