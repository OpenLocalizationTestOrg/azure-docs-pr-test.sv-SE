---
title: "Säkerhetskopiering guide för SAP HANA på Azure Virtual Machines | Microsoft Docs"
description: "Säkerhetskopiering guiden för SAP HANA innehåller två huvudsakliga säkerhetskopiering möjligheter för SAP HANA på Azure virtual machines"
services: virtual-machines-linux
documentationcenter: 
author: hermanndms
manager: timlt
editor: 
ms.service: virtual-machines-linux
ms.devlang: NA
ms.topic: article
ums.tgt_pltfrm: vm-linux
ms.workload: infrastructure-services
ms.date: 3/13/2017
ms.author: rclaus
ms.openlocfilehash: 9e5b124643b753f404ba6012d3df998f567be59a
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 08/29/2017
---
# <a name="backup-guide-for-sap-hana-on-azure-virtual-machines"></a><span data-ttu-id="fdc09-103">Säkerhetskopieringsguide för SAP HANA på Azure Virtual Machines</span><span class="sxs-lookup"><span data-stu-id="fdc09-103">Backup guide for SAP HANA on Azure Virtual Machines</span></span>

## <a name="getting-started"></a><span data-ttu-id="fdc09-104">Komma igång</span><span class="sxs-lookup"><span data-stu-id="fdc09-104">Getting Started</span></span>

<span data-ttu-id="fdc09-105">Guiden Säkerhetskopiering för SAP HANA körs på Azure virtual Machines beskriver endast Azure-specifik information.</span><span class="sxs-lookup"><span data-stu-id="fdc09-105">The backup guide for SAP HANA running on Azure virtual Machines will only describe Azure-specific topics.</span></span> <span data-ttu-id="fdc09-106">Allmän SAP HANA säkerhetskopiering relaterade objekt, dokumentationen om SAP HANA (se _SAP HANA säkerhetskopiering dokumentationen_ senare i den här artikeln).</span><span class="sxs-lookup"><span data-stu-id="fdc09-106">For general SAP HANA backup related items, check the SAP HANA documentation (see _SAP HANA backup documentation_ later in this article).</span></span>

<span data-ttu-id="fdc09-107">Den här artikeln fokuserar på två huvudsakliga säkerhetskopiering möjligheter för SAP HANA på virtuella Azure-datorer:</span><span class="sxs-lookup"><span data-stu-id="fdc09-107">The focus of this article is on two major backup possibilities for SAP HANA on Azure virtual machines:</span></span>

- <span data-ttu-id="fdc09-108">HANA säkerhetskopiering till filsystemet i en Azure Linux-dator (se [SAP HANA Azure Backup på filnivå](sap-hana-backup-file-level.md))</span><span class="sxs-lookup"><span data-stu-id="fdc09-108">HANA backup to the file system in an Azure Linux Virtual Machine (see [SAP HANA Azure Backup on file level](sap-hana-backup-file-level.md))</span></span>
- <span data-ttu-id="fdc09-109">HANA säkerhetskopiering baserat på lagring ögonblicksbilder med hjälp av funktionen Azure storage blob ögonblicksbild manuellt eller Azure Backup Service (se [SAP HANA säkerhetskopiering baserat på lagring ögonblicksbilder](sap-hana-backup-storage-snapshots.md))</span><span class="sxs-lookup"><span data-stu-id="fdc09-109">HANA backup based on storage snapshots using the Azure storage blob snapshot feature manually or Azure Backup Service (see [SAP HANA backup based on storage snapshots](sap-hana-backup-storage-snapshots.md))</span></span>

<span data-ttu-id="fdc09-110">SAP HANA erbjuder en säkerhetskopia API, vilket gör att tredje parts säkerhetskopieringsverktyg integreras direkt med SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="fdc09-110">SAP HANA offers a backup API, which allows third-party backup tools to integrate directly with SAP HANA.</span></span> <span data-ttu-id="fdc09-111">(Som är inte inom omfånget för den här handboken.) Det finns ingen direkt SAP HANA med Azure Backup-tjänsten tillgänglig höger nu baserat på den här API-integrering.</span><span class="sxs-lookup"><span data-stu-id="fdc09-111">(That is not within the scope of this guide.) There is no direct integration of SAP HANA with Azure Backup service available right now based on this API.</span></span>

<span data-ttu-id="fdc09-112">SAP HANA stöds officiellt på Azure VM typ GS5 som instans med en ytterligare begränsning för OLAP-arbetsbelastningar (se [hitta certifierade IaaS-plattformar](https://global.sap.com/community/ebook/2014-09-02-hana-hardware/enEN/iaas.html) på webbplatsen SAP).</span><span class="sxs-lookup"><span data-stu-id="fdc09-112">SAP HANA is officially supported on Azure VM type GS5 as single instance with an additional restriction to OLAP workloads (see [Find Certified IaaS Platforms](https://global.sap.com/community/ebook/2014-09-02-hana-hardware/enEN/iaas.html) on the SAP website).</span></span> <span data-ttu-id="fdc09-113">Den här artikeln kommer att uppdateras som nya erbjudanden för SAP HANA på Azure som blir tillgängliga.</span><span class="sxs-lookup"><span data-stu-id="fdc09-113">This article will be updated as new offerings for SAP HANA on Azure become available.</span></span>

<span data-ttu-id="fdc09-114">Det finns också en SAP HANA-hybridlösning på Azure, där SAP HANA körs icke-virtualiserade på fysiska servrar.</span><span class="sxs-lookup"><span data-stu-id="fdc09-114">There is also an SAP HANA hybrid solution available on Azure, where SAP HANA runs non-virtualized on physical servers.</span></span> <span data-ttu-id="fdc09-115">Men den här säkerhetskopiering SAP HANA Azure-handboken innehåller en ren Azure-miljön där SAP HANA körs i en Azure VM inte SAP HANA körs på &quot;stora instanser.&quot; Se [SAP HANA (stora instanser) översikt och arkitektur för Azure](hana-overview-architecture.md) för mer information om denna lösning för säkerhetskopiering på &quot;stora instanser&quot; baserat på lagring ögonblicksbilder.</span><span class="sxs-lookup"><span data-stu-id="fdc09-115">However, this SAP HANA Azure backup guide covers a pure Azure environment where SAP HANA runs in an Azure VM, not SAP HANA running on &quot;large instances.&quot; See [SAP HANA (large instances) overview and architecture on Azure](hana-overview-architecture.md) for more information about this backup solution on &quot;large instances&quot; based on storage snapshots.</span></span>

<span data-ttu-id="fdc09-116">Allmän information om SAP-produkter som stöds i Azure finns i [SAP Obs 1928533](https://launchpad.support.sap.com/#/notes/1928533).</span><span class="sxs-lookup"><span data-stu-id="fdc09-116">General information about SAP products supported on Azure can be found in [SAP Note 1928533](https://launchpad.support.sap.com/#/notes/1928533).</span></span>

<span data-ttu-id="fdc09-117">Följande tre siffror ger en översikt över säkerhetskopieringsalternativ för SAP HANA som för närvarande använder inbyggda funktioner i Azure och visar också tre möjliga scenarier för framtida säkerhetskopiering.</span><span class="sxs-lookup"><span data-stu-id="fdc09-117">The following three figures give an overview of the SAP HANA backup options using native Azure capabilities currently, and also show three potential future backup scenarios.</span></span> <span data-ttu-id="fdc09-118">Relaterade artiklar [SAP HANA Azure Backup på filnivå](sap-hana-backup-file-level.md) och [SAP HANA säkerhetskopiering baserat på lagring ögonblicksbilder](sap-hana-backup-storage-snapshots.md) beskrivs de olika alternativen i detalj, inklusive storlek och prestandaöverväganden för SAP HANA-säkerhetskopior som är flera terabyte i storlek.</span><span class="sxs-lookup"><span data-stu-id="fdc09-118">The related articles [SAP HANA Azure Backup on file level](sap-hana-backup-file-level.md) and [SAP HANA backup based on storage snapshots](sap-hana-backup-storage-snapshots.md) describe these options in more detail, including size and performance considerations for SAP HANA backups that are multi-terabytes in size.</span></span>

![Den här bilden visar två möjligheter för att spara det aktuella tillståndet för virtuell dator](media/sap-hana-backup-guide/image001.png)

<span data-ttu-id="fdc09-120">Den här bilden visar möjligheten att spara det aktuella tillståndet för virtuell dator, antingen via Azure Backup-tjänsten eller manuell ögonblicksbilder av Virtuella diskar.</span><span class="sxs-lookup"><span data-stu-id="fdc09-120">This figure shows the possibility of saving the current VM state, either via Azure Backup service or manual snapshot of VM disks.</span></span> <span data-ttu-id="fdc09-121">Med den här metoden, ett & #39, måste hantera säkerhetskopior för SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="fdc09-121">With this approach, one doesn&#39;t have to manage SAP HANA backups.</span></span> <span data-ttu-id="fdc09-122">Anrop av disk ögonblicksbild scenariot är filsystemkonsekvens och tillståndet programkonsekventa disk.</span><span class="sxs-lookup"><span data-stu-id="fdc09-122">The challenge of the disk snapshot scenario is file system consistency, and an application-consistent disk state.</span></span> <span data-ttu-id="fdc09-123">Konsekvenskontroll avsnittet beskrivs i avsnittet _SAP HANA datakonsekvens när du tar lagring ögonblicksbilder_ senare i den här artikeln.</span><span class="sxs-lookup"><span data-stu-id="fdc09-123">The consistency topic is discussed in the section _SAP HANA data consistency when taking storage snapshots_ later in this article.</span></span> <span data-ttu-id="fdc09-124">Funktioner och begränsningar för Azure Backup-tjänsten som är relaterade till SAP HANA säkerhetskopior också beskrivs senare i den här artikeln.</span><span class="sxs-lookup"><span data-stu-id="fdc09-124">Capabilities and restrictions of Azure Backup service related to SAP HANA backups are also discussed later in this article.</span></span>

![Den här bilden visar alternativ för att ta en SAP HANA filsäkerhetskopia inuti den virtuella datorn](media/sap-hana-backup-guide/image002.png)

<span data-ttu-id="fdc09-126">Den här bilden visar alternativ för tar en SAP HANA säkerhetskopiering inuti den virtuella datorn och sedan lagra den HANA säkerhetskopior någon annan använder olika verktyg.</span><span class="sxs-lookup"><span data-stu-id="fdc09-126">This figure shows options for taking an SAP HANA file backup inside the VM, and then storing it HANA backup files somewhere else using different tools.</span></span> <span data-ttu-id="fdc09-127">Ta en säkerhetskopia HANA tar längre tid än en ögonblicksbild-baserad lösning för säkerhetskopiering, men den har fördelar om integritet och konsekvens.</span><span class="sxs-lookup"><span data-stu-id="fdc09-127">Taking a HANA backup requires more time than a snapshot-based backup solution, but it has advantages regarding integrity and consistency.</span></span> <span data-ttu-id="fdc09-128">Mer information finns nedan.</span><span class="sxs-lookup"><span data-stu-id="fdc09-128">More details are provided later in this article.</span></span>

![Den här bilden visar eventuella framtida SAP HANA säkerhetskopiering scenario](media/sap-hana-backup-guide/image003.png)

<span data-ttu-id="fdc09-130">Den här bilden illustrerar ett potentiella framtida SAP HANA säkerhetskopiering scenario.</span><span class="sxs-lookup"><span data-stu-id="fdc09-130">This figure shows a potential future SAP HANA backup scenario.</span></span> <span data-ttu-id="fdc09-131">Om du SAP HANA säkerhetskopiering från en sekundär replikering, det lägger till ytterligare alternativ för säkerhetskopieringsstrategier.</span><span class="sxs-lookup"><span data-stu-id="fdc09-131">If SAP HANA allowed taking backups from a replication secondary, it would add additional options for backup strategies.</span></span> <span data-ttu-id="fdc09-132">För närvarande kan inte enligt ett inlägg i SAP HANA-Wiki:</span><span class="sxs-lookup"><span data-stu-id="fdc09-132">Currently it isn't possible according to a post in the SAP HANA Wiki:</span></span>

<span data-ttu-id="fdc09-133">_&quot;Är det möjligt att göra säkerhetskopior på den sekundära sidan?_</span><span class="sxs-lookup"><span data-stu-id="fdc09-133">_&quot;Is it possible to take backups on the secondary side?_</span></span>

<span data-ttu-id="fdc09-134">_Nej, för närvarande kan endast ta data och loggsäkerhetskopior på den primära sidan. Om automatisk säkerhetskopiering är aktiverad när övertag till sekundär sida skrivs automatiskt säkerhetskopiorna av det.&quot;_</span><span class="sxs-lookup"><span data-stu-id="fdc09-134">_No, currently you can only take data and log backups on the primary side. If automatic log backup is enabled, after takeover to the secondary side, the log backups will automatically be written there.&quot;_</span></span>

## <a name="sap-resources-for-hana-backup"></a><span data-ttu-id="fdc09-135">SAP-resurser för HANA säkerhetskopiering</span><span class="sxs-lookup"><span data-stu-id="fdc09-135">SAP resources for HANA backup</span></span>

### <a name="sap-hana-backup-documentation"></a><span data-ttu-id="fdc09-136">Säkerhetskopiering SAP HANA-dokumentation</span><span class="sxs-lookup"><span data-stu-id="fdc09-136">SAP HANA backup documentation</span></span>

- [<span data-ttu-id="fdc09-137">Introduktion till SAP HANA-Administration</span><span class="sxs-lookup"><span data-stu-id="fdc09-137">Introduction to SAP HANA Administration</span></span>](https://help.sap.com/viewer/6b94445c94ae495c83a19646e7c3fd56/2.0.00/en-US)
- [<span data-ttu-id="fdc09-138">Planera säkerhetskopiering och återställning strategi</span><span class="sxs-lookup"><span data-stu-id="fdc09-138">Planning Your Backup and Recovery Strategy</span></span>](https://help.sap.com/saphelp_hanaplatform/helpdata/en/ef/085cd5949c40b788bba8fd3c65743e/content.htm)
- [<span data-ttu-id="fdc09-139">Schemalägga HANA säkerhetskopia med ABAP DBACOCKPIT</span><span class="sxs-lookup"><span data-stu-id="fdc09-139">Schedule HANA Backup using ABAP DBACOCKPIT</span></span>](http://www.hanatutorials.com/p/schedule-hana-backup-using-abap.html)
- [<span data-ttu-id="fdc09-140">Schema för säkerhetskopiering av Data (SAP HANA Cockpit)</span><span class="sxs-lookup"><span data-stu-id="fdc09-140">Schedule Data Backups (SAP HANA Cockpit)</span></span>](http://help.sap.com/saphelp_hanaplatform/helpdata/en/6d/385fa14ef64a6bab2c97a3d3e40292/frameset.htm)
- <span data-ttu-id="fdc09-141">Vanliga frågor om SAP HANA-säkerhetskopiering på [SAP Obs 1642148](https://launchpad.support.sap.com/#/notes/1642148)</span><span class="sxs-lookup"><span data-stu-id="fdc09-141">FAQ about SAP HANA backup in [SAP Note 1642148](https://launchpad.support.sap.com/#/notes/1642148)</span></span>
- <span data-ttu-id="fdc09-142">Vanliga frågor och svar om ögonblicksbilder för SAP HANA-databasen och lagring i [SAP Obs 2039883](https://launchpad.support.sap.com/#/notes/2039883)</span><span class="sxs-lookup"><span data-stu-id="fdc09-142">FAQ about SAP HANA database and storage snapshots in [SAP Note 2039883](https://launchpad.support.sap.com/#/notes/2039883)</span></span>
- <span data-ttu-id="fdc09-143">Olämpliga nätverket filsystem för säkerhetskopiering och återställning i [SAP Obs 1820529](https://launchpad.support.sap.com/#/notes/1820529)</span><span class="sxs-lookup"><span data-stu-id="fdc09-143">Unsuitable network file systems for backup and recovery in [SAP Note 1820529](https://launchpad.support.sap.com/#/notes/1820529)</span></span>

### <a name="why-sap-hana-backup"></a><span data-ttu-id="fdc09-144">Varför SAP HANA-säkerhetskopiering?</span><span class="sxs-lookup"><span data-stu-id="fdc09-144">Why SAP HANA backup?</span></span>

<span data-ttu-id="fdc09-145">Azure storage erbjuder tillgänglighet och tillförlitlighet ur lådan (se [introduktion till Microsoft Azure Storage](../../../storage/common/storage-introduction.md) mer information om Azure storage).</span><span class="sxs-lookup"><span data-stu-id="fdc09-145">Azure storage offers availability and reliability out of the box (see [Introduction to Microsoft Azure Storage](../../../storage/common/storage-introduction.md) for more information about Azure storage).</span></span>

<span data-ttu-id="fdc09-146">Minimum för &quot;säkerhetskopiering&quot; är att lita på Azure SLA: er, hålla SAP HANA data och loggfilen filerna på Azure virtuella hårddiskar anslutna till SAP HANA-servern VM.</span><span class="sxs-lookup"><span data-stu-id="fdc09-146">The minimum for &quot;backup&quot; is to rely on the Azure SLAs, keeping the SAP HANA data and log files on Azure VHDs attached to the SAP HANA server VM.</span></span> <span data-ttu-id="fdc09-147">Den här metoden omfattar VM fel, men inte eventuella skador till SAP HANA-data och loggfiler eller logiska fel som tar bort data eller filer av misstag.</span><span class="sxs-lookup"><span data-stu-id="fdc09-147">This approach covers VM failures, but not potential damage to the SAP HANA data and log files, or logical errors like deleting data or files by accident.</span></span> <span data-ttu-id="fdc09-148">Säkerhetskopieringar krävs för efterlevnad eller juridiska skäl.</span><span class="sxs-lookup"><span data-stu-id="fdc09-148">Backups are also required for compliance or legal reasons.</span></span> <span data-ttu-id="fdc09-149">Kort sagt: det behövs alltid en SAP HANA-säkerhetskopieringar.</span><span class="sxs-lookup"><span data-stu-id="fdc09-149">In short, there is always a need for SAP HANA backups.</span></span>

### <a name="how-to-verify-correctness-of-sap-hana-backup"></a><span data-ttu-id="fdc09-150">Så här kontrollerar du är korrekt SAP HANA-säkerhetskopiering</span><span class="sxs-lookup"><span data-stu-id="fdc09-150">How to verify correctness of SAP HANA backup</span></span>
<span data-ttu-id="fdc09-151">När du använder lagring ögonblicksbilder, bör köra en test-återställning på en annan dator.</span><span class="sxs-lookup"><span data-stu-id="fdc09-151">When using storage snapshots, running a test restore on a different system is recommended.</span></span> <span data-ttu-id="fdc09-152">Den här metoden ger ett sätt att kontrollera att en säkerhetskopia är rätt och interna processer för säkerhetskopiering och återställning fungerar som förväntat.</span><span class="sxs-lookup"><span data-stu-id="fdc09-152">This approach provides a way to ensure that a backup is correct, and internal processes for backup and restore work as expected.</span></span> <span data-ttu-id="fdc09-153">Även om detta är en betydande överskrida lokalt, är det mycket enklare att utföra i molnet genom att tillhandahålla nödvändiga resurser tillfälligt för detta ändamål.</span><span class="sxs-lookup"><span data-stu-id="fdc09-153">While this is a significant hurdle on-premises, it is much easier to accomplish in the cloud by providing necessary resources temporarily for this purpose.</span></span>

<span data-ttu-id="fdc09-154">Behåll i åtanke som gör en enkel återställning och kontrollera om HANA är igång och körs är inte tillräckligt.</span><span class="sxs-lookup"><span data-stu-id="fdc09-154">Keep in mind that doing a simple restore and checking if HANA is up and running is not sufficient.</span></span> <span data-ttu-id="fdc09-155">Vi rekommenderar bör en köra en konsekvenskontroll för tabellen för att kontrollera att den återställda databasen är bra.</span><span class="sxs-lookup"><span data-stu-id="fdc09-155">Ideally, one should run a table consistency check to be sure that the restored database is fine.</span></span> <span data-ttu-id="fdc09-156">SAP HANA erbjuder flera typer av konsekvenskontroller som beskrivs i [SAP Obs 1977584](https://launchpad.support.sap.com/#/notes/1977584).</span><span class="sxs-lookup"><span data-stu-id="fdc09-156">SAP HANA offers several kinds of consistency checks described in [SAP Note 1977584](https://launchpad.support.sap.com/#/notes/1977584).</span></span>

<span data-ttu-id="fdc09-157">Information om konsekvenskontrollen tabellen finns också på SAP-webbplats på [tabell och katalogen konsekvenskontroller](http://help.sap.com/saphelp_hanaplatform/helpdata/en/25/84ec2e324d44529edc8221956359ea/content.htm#loio9357bf52c7324bee9567dca417ad9f8b).</span><span class="sxs-lookup"><span data-stu-id="fdc09-157">Information about the table consistency check can also be found on the SAP website at [Table and Catalog Consistency Checks](http://help.sap.com/saphelp_hanaplatform/helpdata/en/25/84ec2e324d44529edc8221956359ea/content.htm#loio9357bf52c7324bee9567dca417ad9f8b).</span></span>

<span data-ttu-id="fdc09-158">En test-återställning är inte nödvändigt för vanliga filsäkerhetskopieringsverktyg.</span><span class="sxs-lookup"><span data-stu-id="fdc09-158">For standard file backups, a test restore is not necessary.</span></span> <span data-ttu-id="fdc09-159">Det finns två SAP HANA-verktyg som hjälper till att kontrollera vilka säkerhetskopian kan användas för återställning: hdbbackupdiag och hdbbackupcheck.</span><span class="sxs-lookup"><span data-stu-id="fdc09-159">There are two SAP HANA tools that help to check which backup can be used for restore: hdbbackupdiag and hdbbackupcheck.</span></span> <span data-ttu-id="fdc09-160">Se [manuellt kontrollerar om en återställning är möjligt](https://help.sap.com/saphelp_hanaplatform/helpdata/en/77/522ef1e3cb4d799bab33e0aeb9c93b/content.htm) för mer information om dessa verktyg.</span><span class="sxs-lookup"><span data-stu-id="fdc09-160">See [Manually Checking Whether a Recovery is Possible](https://help.sap.com/saphelp_hanaplatform/helpdata/en/77/522ef1e3cb4d799bab33e0aeb9c93b/content.htm) for more information about these tools.</span></span>

### <a name="pros-and-cons-of-hana-backup-versus-storage-snapshot"></a><span data-ttu-id="fdc09-161">För- och nackdelar HANA säkerhetskopiering jämfört med lagring ögonblicksbild</span><span class="sxs-lookup"><span data-stu-id="fdc09-161">Pros and cons of HANA backup versus storage snapshot</span></span>

<span data-ttu-id="fdc09-162">SAP &#39; t ge inställning till antingen HANA säkerhetskopiering jämfört med lagring ögonblicksbild.</span><span class="sxs-lookup"><span data-stu-id="fdc09-162">SAP doesn&#39;t give preference to either HANA backup versus storage snapshot.</span></span> <span data-ttu-id="fdc09-163">Visas en lista med sina för- och nackdelar, så en kan fastställa som ska användas, beroende på situation och tillgängliga lagringsteknik (se [planera din säkerhetskopiering och återställning strategi](https://help.sap.com/saphelp_hanaplatform/helpdata/en/ef/085cd5949c40b788bba8fd3c65743e/content.htm)).</span><span class="sxs-lookup"><span data-stu-id="fdc09-163">It lists their pros and cons, so one can determine which to use depending on the situation and available storage technology (see [Planning Your Backup and Recovery Strategy](https://help.sap.com/saphelp_hanaplatform/helpdata/en/ef/085cd5949c40b788bba8fd3c65743e/content.htm)).</span></span>

<span data-ttu-id="fdc09-164">På Azure, Tänk på att det faktum att Azure-blobben ögonblicksbild funktionen &#39; t garantera filsystemkonsekvens (se [Using blob-ögonblicksbilder med PowerShell](https://blogs.msdn.microsoft.com/cie/2016/05/17/using-blob-snapshots-with-powershell/)).</span><span class="sxs-lookup"><span data-stu-id="fdc09-164">On Azure, be aware of the fact that the Azure blob snapshot feature doesn&#39;t guarantee file system consistency (see [Using blob snapshots with PowerShell](https://blogs.msdn.microsoft.com/cie/2016/05/17/using-blob-snapshots-with-powershell/)).</span></span> <span data-ttu-id="fdc09-165">I nästa avsnitt, _SAP HANA datakonsekvens när du tar lagring ögonblicksbilder_, beskriver vissa överväganden om den här funktionen.</span><span class="sxs-lookup"><span data-stu-id="fdc09-165">The next section, _SAP HANA data consistency when taking storage snapshots_, discusses some considerations regarding this feature.</span></span>

<span data-ttu-id="fdc09-166">Dessutom har att förstå fakturering effekter när du arbetar ofta med blob ögonblicksbilder som beskrivs i den här artikeln: [förstå hur ögonblicksbilder påförs kostnader](/rest/api/storageservices/understanding-how-snapshots-accrue-charges)– den inte är &#39; t som uppenbara som att använda Azure virtuella diskar.</span><span class="sxs-lookup"><span data-stu-id="fdc09-166">In addition, one has to understand the billing implications when working frequently with blob snapshots as described in this article: [Understanding How Snapshots Accrue Charges](/rest/api/storageservices/understanding-how-snapshots-accrue-charges)—it isn&#39;t as obvious as using Azure virtual disks.</span></span>

### <a name="sap-hana-data-consistency-when-taking-storage-snapshots"></a><span data-ttu-id="fdc09-167">SAP HANA datakonsekvens när du tar ögonblicksbilder för lagring</span><span class="sxs-lookup"><span data-stu-id="fdc09-167">SAP HANA data consistency when taking storage snapshots</span></span>

<span data-ttu-id="fdc09-168">System- och konsekvens i filen är ett komplicerat problem när du tar ögonblicksbilder för lagring.</span><span class="sxs-lookup"><span data-stu-id="fdc09-168">File system and application consistency is a complex issue when taking storage snapshots.</span></span> <span data-ttu-id="fdc09-169">Det enklaste sättet att undvika problem att stänga av SAP HANA eller kanske även hela virtuella datorn.</span><span class="sxs-lookup"><span data-stu-id="fdc09-169">The easiest way to avoid problems would be to shut down SAP HANA, or maybe even the whole virtual machine.</span></span> <span data-ttu-id="fdc09-170">En avstängning kanske doable med en demonstration eller prototyp eller även utvecklingssystemet, men det är inte ett alternativ för ett produktionssystem.</span><span class="sxs-lookup"><span data-stu-id="fdc09-170">A shutdown might be doable with a demo or prototype, or even a development system, but it is not an option for a production system.</span></span>

<span data-ttu-id="fdc09-171">På Azure, har du bör tänka på att Azure-blobben ögonblicksbild funktionen & #39, t garanti filsystemkonsekvens.</span><span class="sxs-lookup"><span data-stu-id="fdc09-171">On Azure, one has to keep in mind that the Azure blob snapshot feature doesn&#39;t guarantee file system consistency.</span></span> <span data-ttu-id="fdc09-172">Den fungerar dock ögonblicksbild SAP HANA med hjälp av funktionen, så länge det finns bara en virtuell disk som ingår.</span><span class="sxs-lookup"><span data-stu-id="fdc09-172">It works fine however by using the SAP HANA snapshot feature, as long as there is only a single virtual disk involved.</span></span> <span data-ttu-id="fdc09-173">Men även med en enskild disk ytterligare objekt som ska kontrolleras.</span><span class="sxs-lookup"><span data-stu-id="fdc09-173">But even with a single disk, additional items have to be checked.</span></span> <span data-ttu-id="fdc09-174">[SAP Obs 2039883](https://launchpad.support.sap.com/#/notes/2039883) har viktig information om SAP HANA säkerhetskopieringar via storage snapshots.</span><span class="sxs-lookup"><span data-stu-id="fdc09-174">[SAP Note 2039883](https://launchpad.support.sap.com/#/notes/2039883) has important information about SAP HANA backups via storage snapshots.</span></span> <span data-ttu-id="fdc09-175">Exempelvis nämns att med filsystemet XFS är det nödvändigt att köra **xfs\_låsa** innan du startar en ögonblicksbild av lagring för att garantera konsekvens (se [xfs\_freeze(8) - Linux man sidan](https://linux.die.net/man/8/xfs_freeze) information om **xfs\_låsa**).</span><span class="sxs-lookup"><span data-stu-id="fdc09-175">For example, it mentions that, with the XFS file system, it is necessary to run **xfs\_freeze** before starting a storage snapshot to guarantee consistency (see [xfs\_freeze(8) - Linux man page](https://linux.die.net/man/8/xfs_freeze) for details on **xfs\_freeze**).</span></span>

<span data-ttu-id="fdc09-176">Avsnittet konsekvens blir ännu mer utmanande i fall där en enda filsystemet sträcker sig över flera diskar/volymer.</span><span class="sxs-lookup"><span data-stu-id="fdc09-176">The topic of consistency becomes even more challenging in a case where a single file system spans multiple disks/volumes.</span></span> <span data-ttu-id="fdc09-177">Till exempel med hjälp av mdadm eller LVM och striping.</span><span class="sxs-lookup"><span data-stu-id="fdc09-177">For example, by using mdadm or LVM and striping.</span></span> <span data-ttu-id="fdc09-178">SAP-kommentar som nämns ovan tillstånd:</span><span class="sxs-lookup"><span data-stu-id="fdc09-178">The SAP Note mentioned above states:</span></span>

<span data-ttu-id="fdc09-179">_&quot;Men kom ihåg att lagringssystemet måste garantera konsekvens för i/o när du skapar en ögonblicksbild av lagring per volym för SAP HANA-data, t.ex. ögonblicksbilder för en SAP HANA tjänstspecifika datavolymen måste vara en atomisk åtgärd.&quot;_</span><span class="sxs-lookup"><span data-stu-id="fdc09-179">_&quot;But keep in mind that the storage system has to guarantee I/O consistency while creating a storage snapshot per SAP HANA data volume, i.e. snapshotting of an SAP HANA service-specific data volume must be an atomic operation.&quot;_</span></span>

<span data-ttu-id="fdc09-180">Följande steg ange under förutsättning att det finns ett XFS filsystem utsträckning fyra Azure virtuella diskar, en programkonsekvent ögonblicksbild som representerar HANA dataområdet:</span><span class="sxs-lookup"><span data-stu-id="fdc09-180">Assuming there is an XFS file system spanning four Azure virtual disks, the following steps provide a consistent snapshot that represents the HANA data area:</span></span>

- <span data-ttu-id="fdc09-181">Förbereda HANA ögonblicksbild</span><span class="sxs-lookup"><span data-stu-id="fdc09-181">HANA snapshot prepare</span></span>
- <span data-ttu-id="fdc09-182">Låsa filsystemet (till exempel använda **xfs\_låsa**)</span><span class="sxs-lookup"><span data-stu-id="fdc09-182">Freeze the file system (for example, use **xfs\_freeze**)</span></span>
- <span data-ttu-id="fdc09-183">Skapa alla nödvändiga blob-ögonblicksbilder på Azure</span><span class="sxs-lookup"><span data-stu-id="fdc09-183">Create all necessary blob snapshots on Azure</span></span>
- <span data-ttu-id="fdc09-184">Lås upp filsystemet</span><span class="sxs-lookup"><span data-stu-id="fdc09-184">Unfreeze the file system</span></span>
- <span data-ttu-id="fdc09-185">Bekräfta HANA ögonblicksbild</span><span class="sxs-lookup"><span data-stu-id="fdc09-185">Confirm the HANA snapshot</span></span>

<span data-ttu-id="fdc09-186">Rekommendation är att använda proceduren ovan i samtliga fall för att vara på den säkra sidan, oavsett vilket filsystem.</span><span class="sxs-lookup"><span data-stu-id="fdc09-186">Recommendation is to use the procedure above in all cases to be on the safe side, no matter which file system.</span></span> <span data-ttu-id="fdc09-187">Eller om det är en enskild disk eller striping via mdadm eller LVM över flera diskar.</span><span class="sxs-lookup"><span data-stu-id="fdc09-187">Or if it is a single disk or striping, via mdadm or LVM across multiple disks.</span></span>

<span data-ttu-id="fdc09-188">Det är viktigt att bekräfta HANA ögonblicksbilden.</span><span class="sxs-lookup"><span data-stu-id="fdc09-188">It is important to confirm the HANA snapshot.</span></span> <span data-ttu-id="fdc09-189">På grund av att den &quot;kopiering vid skrivning,&quot; SAP HANA kanske inte kräver ytterligare diskutrymme i detta förbereda läge ögonblicksbild.</span><span class="sxs-lookup"><span data-stu-id="fdc09-189">Due to the &quot;Copy-on-Write,&quot; SAP HANA might not require additional disk space while in this snapshot-prepare mode.</span></span> <span data-ttu-id="fdc09-190">Den &#39; också inte går att starta nya säkerhetskopior förrän SAP HANA ögonblicksbilden har bekräftats.</span><span class="sxs-lookup"><span data-stu-id="fdc09-190">It&#39;s also not possible to start new backups until the SAP HANA snapshot is confirmed.</span></span>

<span data-ttu-id="fdc09-191">Azure Backup-tjänsten använder Azure VM-tillägg för att ta hand om filsystemkonsekvens.</span><span class="sxs-lookup"><span data-stu-id="fdc09-191">Azure Backup service uses Azure VM extensions to take care of the file system consistency.</span></span> <span data-ttu-id="fdc09-192">Dessa VM-tillägg är inte tillgängliga för fristående användning.</span><span class="sxs-lookup"><span data-stu-id="fdc09-192">These VM extensions are not available for standalone usage.</span></span> <span data-ttu-id="fdc09-193">Ett måste hantera SAP HANA-konsekvenskontroll.</span><span class="sxs-lookup"><span data-stu-id="fdc09-193">One still has to manage SAP HANA consistency.</span></span> <span data-ttu-id="fdc09-194">Se relaterade artikel [SAP HANA Azure Backup på filnivå](sap-hana-backup-file-level.md) för mer information.</span><span class="sxs-lookup"><span data-stu-id="fdc09-194">See the related article [SAP HANA Azure Backup on file level](sap-hana-backup-file-level.md) for more information.</span></span>

### <a name="sap-hana-backup-scheduling-strategy"></a><span data-ttu-id="fdc09-195">SAP HANA schemaläggning säkerhetskopieringsstrategi</span><span class="sxs-lookup"><span data-stu-id="fdc09-195">SAP HANA backup scheduling strategy</span></span>

<span data-ttu-id="fdc09-196">SAP HANA-artikel [planera din säkerhetskopiering och återställning strategi](https://help.sap.com/saphelp_hanaplatform/helpdata/en/ef/085cd5949c40b788bba8fd3c65743e/content.htm) anger en grundläggande åtgärdsplan säkerhetskopiera:</span><span class="sxs-lookup"><span data-stu-id="fdc09-196">The SAP HANA article [Planning Your Backup and Recovery Strategy](https://help.sap.com/saphelp_hanaplatform/helpdata/en/ef/085cd5949c40b788bba8fd3c65743e/content.htm) states a basic plan to do backups:</span></span>

- <span data-ttu-id="fdc09-197">Lagring ögonblicksbild (varje dag)</span><span class="sxs-lookup"><span data-stu-id="fdc09-197">Storage snapshot (daily)</span></span>
- <span data-ttu-id="fdc09-198">Fullständig säkerhetskopiering med hjälp av filen eller bacint format (en gång i veckan)</span><span class="sxs-lookup"><span data-stu-id="fdc09-198">Complete data backup using file or bacint format (once a week)</span></span>
- <span data-ttu-id="fdc09-199">Automatisk loggsäkerhetskopior</span><span class="sxs-lookup"><span data-stu-id="fdc09-199">Automatic log backups</span></span>

<span data-ttu-id="fdc09-200">Du kan också kan en gå helt utan ögonblicksbilder av lagring de kan ersättas av HANA delta säkerhetskopieringar som inkrementella eller differentiella säkerhetskopieringar (se [Delta säkerhetskopieringar](https://help.sap.com/saphelp_hanaplatform/helpdata/en/c3/bb7e33bb571014a03eeabba4e37541/content.htm)).</span><span class="sxs-lookup"><span data-stu-id="fdc09-200">Optionally, one could go completely without storage snapshots; they could be replaced by HANA delta backups, like incremental or differential backups (see [Delta Backups](https://help.sap.com/saphelp_hanaplatform/helpdata/en/c3/bb7e33bb571014a03eeabba4e37541/content.htm)).</span></span>

<span data-ttu-id="fdc09-201">HANA Administrationsguide innehåller en exempel-lista.</span><span class="sxs-lookup"><span data-stu-id="fdc09-201">The HANA Administration guide provides an example list.</span></span> <span data-ttu-id="fdc09-202">Det tyder på att en återställa SAP HANA till en specifik tidpunkt med hjälp av följande sekvens av säkerhetskopiering:</span><span class="sxs-lookup"><span data-stu-id="fdc09-202">It suggests that one recover SAP HANA to a specific point in time using the following sequence of backups:</span></span>

1. <span data-ttu-id="fdc09-203">Fullständig säkerhetskopiering</span><span class="sxs-lookup"><span data-stu-id="fdc09-203">Full data backup</span></span>
2. <span data-ttu-id="fdc09-204">Differentiell säkerhetskopiering</span><span class="sxs-lookup"><span data-stu-id="fdc09-204">Differential backup</span></span>
3. <span data-ttu-id="fdc09-205">Inkrementell säkerhetskopiering 1</span><span class="sxs-lookup"><span data-stu-id="fdc09-205">Incremental backup 1</span></span>
4. <span data-ttu-id="fdc09-206">Inkrementell säkerhetskopiering 2</span><span class="sxs-lookup"><span data-stu-id="fdc09-206">Incremental backup 2</span></span>
5. <span data-ttu-id="fdc09-207">Loggsäkerhetskopior</span><span class="sxs-lookup"><span data-stu-id="fdc09-207">Log backups</span></span>

<span data-ttu-id="fdc09-208">Om ett exakt schema för när och hur ofta en viss typ av säkerhetskopiering ska hända, det går inte att ge allmänt – det är för kundspecifika och beror på hur många data ändras i systemet.</span><span class="sxs-lookup"><span data-stu-id="fdc09-208">Regarding an exact schedule as to when and how often a specific backup type should happen, it is not possible to give a general guideline—it is too customer-specific, and depends on how many data changes occur in the system.</span></span> <span data-ttu-id="fdc09-209">En grundläggande rekommendation från SAP-sida, vilket kan ses som en allmän vägledning är att se en fullständig HANA säkerhetskopiering en gång i veckan.</span><span class="sxs-lookup"><span data-stu-id="fdc09-209">One basic recommendation from SAP side, which can be seen as general guidance, is to make one full HANA backup once a week.</span></span>
<span data-ttu-id="fdc09-210">Om säkerhetskopior, finns i dokumentationen för SAP HANA [Loggsäkerhetskopior](https://help.sap.com/saphelp_hanaplatform/helpdata/en/c3/bb7e33bb571014a03eeabba4e37541/content.htm).</span><span class="sxs-lookup"><span data-stu-id="fdc09-210">Regarding log backups, see the SAP HANA documentation [Log Backups](https://help.sap.com/saphelp_hanaplatform/helpdata/en/c3/bb7e33bb571014a03eeabba4e37541/content.htm).</span></span>

<span data-ttu-id="fdc09-211">SAP rekommenderar även göra vissa underhåll av säkerhetskopiering katalogen så att den blir oändligt (se [Housekeeping för säkerhetskopieringskatalogen och Säkerhetskopieringslagring](http://help.sap.com/saphelp_hanaplatform/helpdata/en/ca/c903c28b0e4301b39814ef41dbf568/content.htm)).</span><span class="sxs-lookup"><span data-stu-id="fdc09-211">SAP also recommends doing some housekeeping of the backup catalog to keep it from growing infinitely (see [Housekeeping for Backup Catalog and Backup Storage](http://help.sap.com/saphelp_hanaplatform/helpdata/en/ca/c903c28b0e4301b39814ef41dbf568/content.htm)).</span></span>

### <a name="sap-hana-configuration-files"></a><span data-ttu-id="fdc09-212">Konfigurationsfiler för SAP HANA</span><span class="sxs-lookup"><span data-stu-id="fdc09-212">SAP HANA configuration files</span></span>

<span data-ttu-id="fdc09-213">Enligt informationen i vanliga frågor i [SAP Obs 1642148](https://launchpad.support.sap.com/#/notes/1642148), SAP HANA-konfigurationsfilerna inte är en del av en standard säkerhetskopiering HANA.</span><span class="sxs-lookup"><span data-stu-id="fdc09-213">As stated in the FAQ in [SAP Note 1642148](https://launchpad.support.sap.com/#/notes/1642148), the SAP HANA configuration files are not part of a standard HANA backup.</span></span> <span data-ttu-id="fdc09-214">De är inte nödvändigt att återställa ett system.</span><span class="sxs-lookup"><span data-stu-id="fdc09-214">They are not essential to restore a system.</span></span> <span data-ttu-id="fdc09-215">HANA konfigurationen kan ändras manuellt efter återställningen.</span><span class="sxs-lookup"><span data-stu-id="fdc09-215">The HANA configuration could be changed manually after the restore.</span></span> <span data-ttu-id="fdc09-216">Det är nödvändigt att säkerhetskopiera konfigurationsfiler HANA separat om någon vill ha samma anpassad konfiguration under återställningsprocessen.</span><span class="sxs-lookup"><span data-stu-id="fdc09-216">In case one would like to get the same custom configuration during the restore process, it is necessary to back up the HANA configuration files separately.</span></span>

<span data-ttu-id="fdc09-217">Om vanlig HANA säkerhetskopiering ska en dedikerad HANA säkerhetskopian system, en kan också kopiera konfigurationsfilerna till samma säkerhetskopiering filsystemet och sedan kopiera allt tillsammans till den slutliga lagringsplats som lågfrekvent blob storage.</span><span class="sxs-lookup"><span data-stu-id="fdc09-217">If standard HANA backups are going to a dedicated HANA backup file system, one could also copy the configuration files to the same backup filesystem, and then copy everything together to the final storage destination like cool blob storage.</span></span>

### <a name="sap-hana-cockpit"></a><span data-ttu-id="fdc09-218">SAP HANA Cockpit</span><span class="sxs-lookup"><span data-stu-id="fdc09-218">SAP HANA Cockpit</span></span>

<span data-ttu-id="fdc09-219">SAP HANA Cockpit erbjuder möjligheten att övervaka och hantera SAP HANA via en webbläsare.</span><span class="sxs-lookup"><span data-stu-id="fdc09-219">SAP HANA Cockpit offers the possibility of monitoring and managing SAP HANA via a browser.</span></span> <span data-ttu-id="fdc09-220">Det kan också hantering av SAP HANA-säkerhetskopiering och kan därför användas som ett alternativ till SAP HANA Studio och ABAP DBACOCKPIT (se [SAP HANA Cockpit](https://help.sap.com/saphelp_hanaplatform/helpdata/en/73/c37822444344f3973e0e976b77958e/content.htm) mer information).</span><span class="sxs-lookup"><span data-stu-id="fdc09-220">It also allows handling of SAP HANA backups, and therefore can be used as an alternative to SAP HANA Studio and ABAP DBACOCKPIT (see [SAP HANA Cockpit](https://help.sap.com/saphelp_hanaplatform/helpdata/en/73/c37822444344f3973e0e976b77958e/content.htm) for more information).</span></span>

![Den här bilden visar skärmen SAP HANA Cockpit databasen Administration](media/sap-hana-backup-guide/image004.png)

<span data-ttu-id="fdc09-222">Den här bilden visar skärmen SAP HANA Cockpit databasen Administration och panelen säkerhetskopiering till vänster.</span><span class="sxs-lookup"><span data-stu-id="fdc09-222">This figure shows the SAP HANA Cockpit Database Administration Screen, and the backup tile on the left.</span></span> <span data-ttu-id="fdc09-223">Se panelen backup kräver lämpliga användarbehörigheter för inloggningskontot.</span><span class="sxs-lookup"><span data-stu-id="fdc09-223">Seeing the backup tile requires appropriate user permissions for login account.</span></span>

![Säkerhetskopieringar kan övervakas i SAP HANA Cockpit medan de är pågående](media/sap-hana-backup-guide/image005.png)

<span data-ttu-id="fdc09-225">Säkerhetskopieringar kan övervakas i SAP HANA Cockpit medan de är pågående, och när den är klar, säkerhetskopiering allt är tillgängliga.</span><span class="sxs-lookup"><span data-stu-id="fdc09-225">Backups can be monitored in SAP HANA Cockpit while they are ongoing and, once it is finished, all the backup details are available.</span></span>

![Ett exempel på en Azure SLES 12 VM med gör väldigt lätt desktop Firefox](media/sap-hana-backup-guide/image006.png)

<span data-ttu-id="fdc09-227">De föregående skärmbilderna har gjorts från en Windows Azure-VM.</span><span class="sxs-lookup"><span data-stu-id="fdc09-227">The previous screenshots were made from an Azure Windows VM.</span></span> <span data-ttu-id="fdc09-228">Det här är ett exempel på en Azure SLES 12 VM med gör väldigt lätt desktop Firefox.</span><span class="sxs-lookup"><span data-stu-id="fdc09-228">This one is an example using Firefox on an Azure SLES 12 VM with Gnome desktop.</span></span> <span data-ttu-id="fdc09-229">Möjlighet att definiera scheman för SAP HANA-säkerhetskopiering i SAP HANA Cockpit visas.</span><span class="sxs-lookup"><span data-stu-id="fdc09-229">It shows the option to define SAP HANA backup schedules in SAP HANA Cockpit.</span></span> <span data-ttu-id="fdc09-230">Som en kan också se föreslår datum/tid som ett prefix för säkerhetskopiorna.</span><span class="sxs-lookup"><span data-stu-id="fdc09-230">As one can also see, it suggests date/time as a prefix for the backup files.</span></span> <span data-ttu-id="fdc09-231">SAP HANA Studio är standard prefixet &quot;Slutför\_DATA\_säkerhetskopiering&quot; när du gör en fullständig säkerhetskopia.</span><span class="sxs-lookup"><span data-stu-id="fdc09-231">In SAP HANA Studio, the default prefix is &quot;COMPLETE\_DATA\_BACKUP&quot; when doing a full file backup.</span></span> <span data-ttu-id="fdc09-232">Du bör använda ett unikt prefix.</span><span class="sxs-lookup"><span data-stu-id="fdc09-232">Using a unique prefix is recommended.</span></span>

### <a name="sap-hana-backup-encryption"></a><span data-ttu-id="fdc09-233">SAP HANA säkerhetskopia av krypteringsnyckeln</span><span class="sxs-lookup"><span data-stu-id="fdc09-233">SAP HANA backup encryption</span></span>

<span data-ttu-id="fdc09-234">SAP HANA erbjuder kryptering av data och loggfilen.</span><span class="sxs-lookup"><span data-stu-id="fdc09-234">SAP HANA offers encryption of data and log.</span></span> <span data-ttu-id="fdc09-235">Om SAP HANA-data och loggfilen inte krypteras kan sedan krypteras säkerhetskopieringarna också inte.</span><span class="sxs-lookup"><span data-stu-id="fdc09-235">If SAP HANA data and log are not encrypted, then the backups are also not encrypted.</span></span> <span data-ttu-id="fdc09-236">Det är att använda någon form av lösning från tredje part för att kryptera säkerhetskopiorna för SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="fdc09-236">It is up to the customer to use some form of third-party solution to encrypt the SAP HANA backups.</span></span> <span data-ttu-id="fdc09-237">Se [Data och loggfilen volymkryptering](https://help.sap.com/saphelp_hanaplatform/helpdata/en/dc/01f36fbb5710148b668201a6e95cf2/content.htm) vill veta mer om SAP HANA-kryptering.</span><span class="sxs-lookup"><span data-stu-id="fdc09-237">See [Data and Log Volume Encryption](https://help.sap.com/saphelp_hanaplatform/helpdata/en/dc/01f36fbb5710148b668201a6e95cf2/content.htm) to find out more about SAP HANA encryption.</span></span>

<span data-ttu-id="fdc09-238">En kund kan använda funktionen IaaS VM kryptering för att kryptera i Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="fdc09-238">On Microsoft Azure, a customer could use the IaaS VM encryption feature to encrypt.</span></span> <span data-ttu-id="fdc09-239">Exempelvis kan en använda dedicerade datadiskar som är anslutna till den virtuella datorn som används för att lagra säkerhetskopior för SAP HANA och sedan göra kopior av dessa diskar.</span><span class="sxs-lookup"><span data-stu-id="fdc09-239">For example, one could use dedicated data disks attached to the VM, which are used to store SAP HANA backups, then make copies of these disks.</span></span>

<span data-ttu-id="fdc09-240">Azure Backup-tjänsten kan hantera krypterade VMs-diskar (se [säkerhetskopiera och återställa krypterade virtuella datorer med Azure Backup](../../../backup/backup-azure-vms-encryption.md)).</span><span class="sxs-lookup"><span data-stu-id="fdc09-240">Azure Backup service can handle encrypted VMs/disks (see [How to back up and restore encrypted virtual machines with Azure Backup](../../../backup/backup-azure-vms-encryption.md)).</span></span>

<span data-ttu-id="fdc09-241">Ett annat alternativ är att upprätthålla SAP HANA-VM och dess diskar utan kryptering och lagra säkerhetskopiorna för SAP HANA i ett lagringskonto som kryptering aktiverades (se [Azure Storage Service-kryptering för Data i vila](../../../storage/common/storage-service-encryption.md)).</span><span class="sxs-lookup"><span data-stu-id="fdc09-241">Another option would be to maintain the SAP HANA VM and its disks without encryption, and store the SAP HANA backup files in a storage account for which encryption was enabled (see [Azure Storage Service Encryption for Data at Rest](../../../storage/common/storage-service-encryption.md)).</span></span>

## <a name="test-setup"></a><span data-ttu-id="fdc09-242">Testa installationen</span><span class="sxs-lookup"><span data-stu-id="fdc09-242">Test setup</span></span>

### <a name="test-virtual-machine-on-azure"></a><span data-ttu-id="fdc09-243">Testa virtuell dator på Azure</span><span class="sxs-lookup"><span data-stu-id="fdc09-243">Test Virtual Machine on Azure</span></span>

<span data-ttu-id="fdc09-244">En SAP HANA-installation i en Azure GS5 VM användes för följande säkerhetskopiering/återställning tester.</span><span class="sxs-lookup"><span data-stu-id="fdc09-244">An SAP HANA installation in an Azure GS5 VM was used for the following backup/restore tests.</span></span>

![Den här bilden visar en del av Azure portal översikten för testet HANA VM](media/sap-hana-backup-guide/image007.png)

<span data-ttu-id="fdc09-246">Den här bilden visar en del av Azure portal översikt för den Virtuella testdatorn i HANA.</span><span class="sxs-lookup"><span data-stu-id="fdc09-246">This figure shows part of the Azure portal overview for the HANA test VM.</span></span>

### <a name="test-backup-size"></a><span data-ttu-id="fdc09-247">Testa säkerhetskopieringsstorlek</span><span class="sxs-lookup"><span data-stu-id="fdc09-247">Test backup size</span></span>

![Den här bilden har kopplats från konsolen säkerhetskopiering i HANA Studio och visar säkerhetskopian storleken på 229 GB för HANA indexserver](media/sap-hana-backup-guide/image008.png)

<span data-ttu-id="fdc09-249">En dummy tabell fylldes med data som ska hämtas en säkerhetskopiering storlek totala data över 200 GB att härleda realistiska prestandadata.</span><span class="sxs-lookup"><span data-stu-id="fdc09-249">A dummy table was filled up with data to get a total data backup size of over 200 GB to derive realistic performance data.</span></span> <span data-ttu-id="fdc09-250">Bilden har kopplats från konsolen säkerhetskopiering i HANA Studio och visar säkerhetskopian storleken på 229 GB för HANA indexserver.</span><span class="sxs-lookup"><span data-stu-id="fdc09-250">The figure was taken from the backup console in HANA Studio and shows the backup file size of 229 GB for the HANA index server.</span></span> <span data-ttu-id="fdc09-251">För tester användes säkerhetskopiering standardprefix ”COMPLETE_DATA_BACKUP” i SAP HANA Studio.</span><span class="sxs-lookup"><span data-stu-id="fdc09-251">For the tests, the default backup prefix "COMPLETE_DATA_BACKUP" in SAP HANA Studio was used.</span></span> <span data-ttu-id="fdc09-252">Ett mer användbar prefix ska vara definierat i verklig produktionssystem.</span><span class="sxs-lookup"><span data-stu-id="fdc09-252">In real production systems, a more useful prefix should be defined.</span></span> <span data-ttu-id="fdc09-253">SAP HANA Cockpit föreslår datum/tid.</span><span class="sxs-lookup"><span data-stu-id="fdc09-253">SAP HANA Cockpit suggests date/time.</span></span>

### <a name="test-tool-to-copy-files-directly-to-azure-storage"></a><span data-ttu-id="fdc09-254">Testa verktyg för att kopiera filer direkt till Azure storage</span><span class="sxs-lookup"><span data-stu-id="fdc09-254">Test tool to copy files directly to Azure storage</span></span>

<span data-ttu-id="fdc09-255">Verktyget blobxfer användes för att överföra SAP HANA säkerhetskopierade filer direkt till Azure blob storage eller Azure-filresurser, eftersom den stöder båda mål och enkelt kan integreras i automatiseringsskript på grund av dess kommandoradsgränssnitt.</span><span class="sxs-lookup"><span data-stu-id="fdc09-255">To transfer SAP HANA backup files directly to Azure blob storage, or Azure file shares, the blobxfer tool was used because it supports both targets and it can be easily integrated into automation scripts due to its command-line interface.</span></span> <span data-ttu-id="fdc09-256">Blobxfer-verktyget är tillgängligt på [GitHub](https://github.com/Azure/blobxfer).</span><span class="sxs-lookup"><span data-stu-id="fdc09-256">The blobxfer tool is available on [GitHub](https://github.com/Azure/blobxfer).</span></span>

### <a name="test-backup-size-estimation"></a><span data-ttu-id="fdc09-257">Testa säkerhetskopieringsstorlek uppskattning</span><span class="sxs-lookup"><span data-stu-id="fdc09-257">Test backup size estimation</span></span>

<span data-ttu-id="fdc09-258">Det är viktigt att beräkna storleken på säkerhetskopian SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="fdc09-258">It is important to estimate the backup size of SAP HANA.</span></span> <span data-ttu-id="fdc09-259">Denna uppskattning hjälper oss för att förbättra prestanda genom att definiera den högsta säkerhetskopia storleken för ett antal säkerhetskopior på grund av parallellitet under en filkopia.</span><span class="sxs-lookup"><span data-stu-id="fdc09-259">This estimate helps to improve performance by defining the max backup file size for a number of backup files, due to parallelism during a file copy.</span></span> <span data-ttu-id="fdc09-260">(Dessa uppgifter beskrivs senare i den här artikeln.) En måste också bestämma om du vill göra en fullständig säkerhetskopia eller en delta-säkerhetskopiering (inkrementell eller differentiell).</span><span class="sxs-lookup"><span data-stu-id="fdc09-260">(Those details are explained later in this article.) One must also decide whether to do a full backup or a delta backup (incremental or differential).</span></span>

<span data-ttu-id="fdc09-261">Lyckligtvis finns en enkel SQL-instruktion som beräknar storleken på de säkerhetskopiera filerna: **Välj \* från M\_säkerhetskopiering\_storlek\_UPPSKATTNINGAR** (se [beräkna utrymmet som krävs i filsystemet för en säkerhetskopiering Data](https://help.sap.com/saphelp_hanaplatform/helpdata/en/7d/46337b7a9c4c708d965b65bc0f343c/content.htm)).</span><span class="sxs-lookup"><span data-stu-id="fdc09-261">Fortunately, there is a simple SQL statement that estimates the size of the backup files: **select \* from M\_BACKUP\_SIZE\_ESTIMATIONS** (see [Estimate the Space Needed in the File System for a Data Backup](https://help.sap.com/saphelp_hanaplatform/helpdata/en/7d/46337b7a9c4c708d965b65bc0f343c/content.htm)).</span></span>

![Utdata från den här SQL-instruktionen matchar nästan exakt den verkliga storleken på fullständig säkerhetskopiering på disk](media/sap-hana-backup-guide/image009.png)

<span data-ttu-id="fdc09-263">Utdata från den här SQL-instruktionen matchar för testsystemet nästan exakt den verkliga storleken på fullständig säkerhetskopiering på disk.</span><span class="sxs-lookup"><span data-stu-id="fdc09-263">For the test system, the output of this SQL statement matches almost exactly the real size of the full data backup on disk.</span></span>

### <a name="test-hana-backup-file-size"></a><span data-ttu-id="fdc09-264">Testa HANA säkerhetskopians storlek</span><span class="sxs-lookup"><span data-stu-id="fdc09-264">Test HANA backup file size</span></span>

![Konsolen HANA Studio backup går det att begränsa den maximala filstorleken på HANA säkerhetskopior](media/sap-hana-backup-guide/image010.png)

<span data-ttu-id="fdc09-266">Konsolen HANA Studio backup går det att begränsa den maximala filstorleken på HANA säkerhetskopior.</span><span class="sxs-lookup"><span data-stu-id="fdc09-266">The HANA Studio backup console allows one to restrict the max file size of HANA backup files.</span></span> <span data-ttu-id="fdc09-267">I exempel-miljö som funktionen gör det möjligt att få flera mindre säkerhetskopierade filer i stället för en 230 GB säkerhetskopian.</span><span class="sxs-lookup"><span data-stu-id="fdc09-267">In the sample environment, that feature makes it possible to get multiple smaller backup files instead of one 230-GB backup file.</span></span> <span data-ttu-id="fdc09-268">Mindre filstorlek har en betydande inverkan på prestanda (se relaterade artikel [SAP HANA Azure Backup på filnivå](sap-hana-backup-file-level.md)).</span><span class="sxs-lookup"><span data-stu-id="fdc09-268">Smaller file size has a significant impact on performance (see the related article [SAP HANA Azure Backup on file level](sap-hana-backup-file-level.md)).</span></span>

## <a name="summary"></a><span data-ttu-id="fdc09-269">Sammanfattning</span><span class="sxs-lookup"><span data-stu-id="fdc09-269">Summary</span></span>

<span data-ttu-id="fdc09-270">Baserat på resultaten i följande tabeller visas- och nackdelar med lösningar för att säkerhetskopiera en SAP HANA-databas som körs på virtuella Azure-datorer.</span><span class="sxs-lookup"><span data-stu-id="fdc09-270">Based on the test results the following tables show pros and cons of solutions to back up an SAP HANA database running on Azure virtual machines.</span></span>

<span data-ttu-id="fdc09-271">**Säkerhetskopiera SAP HANA till filsystemet och därefter kopiera säkerhetskopieringsfilerna till slutdestinationen för säkerhetskopiering**</span><span class="sxs-lookup"><span data-stu-id="fdc09-271">**Back up SAP HANA to the file system and copy backup files afterwards to the final backup destination**</span></span>

|<span data-ttu-id="fdc09-272">Lösning</span><span class="sxs-lookup"><span data-stu-id="fdc09-272">Solution</span></span>                                           |<span data-ttu-id="fdc09-273">Tekniker</span><span class="sxs-lookup"><span data-stu-id="fdc09-273">Pros</span></span>                                 |<span data-ttu-id="fdc09-274">Nackdelar</span><span class="sxs-lookup"><span data-stu-id="fdc09-274">Cons</span></span>                                  |
|---------------------------------------------------|-------------------------------------|--------------------------------------|
|<span data-ttu-id="fdc09-275">Behåll HANA säkerhetskopior på Virtuella diskar</span><span class="sxs-lookup"><span data-stu-id="fdc09-275">Keep HANA backups on VM disks</span></span>                      |<span data-ttu-id="fdc09-276">Inget ytterligare arbete</span><span class="sxs-lookup"><span data-stu-id="fdc09-276">No additional management efforts</span></span>     |<span data-ttu-id="fdc09-277">Eats lokala VM diskutrymme</span><span class="sxs-lookup"><span data-stu-id="fdc09-277">Eats up local VM disk space</span></span>           |
|<span data-ttu-id="fdc09-278">Blobxfer för att kopiera säkerhetskopieringsfilerna till blob storage</span><span class="sxs-lookup"><span data-stu-id="fdc09-278">Blobxfer tool to copy backup files to blob storage</span></span> |<span data-ttu-id="fdc09-279">Parallellitet kopiera flera filer, möjlighet att använda kall blob storage</span><span class="sxs-lookup"><span data-stu-id="fdc09-279">Parallelism to copy multiple files, choice to use cool blob storage</span></span> | <span data-ttu-id="fdc09-280">Ytterligare verktyget underhåll och anpassade skript</span><span class="sxs-lookup"><span data-stu-id="fdc09-280">Additional tool maintenance and custom scripting</span></span> | 
|<span data-ttu-id="fdc09-281">BLOB-kopiering via Powershell eller CLI</span><span class="sxs-lookup"><span data-stu-id="fdc09-281">Blob copy via Powershell or CLI</span></span>                    |<span data-ttu-id="fdc09-282">Inget ytterligare verktyg som behövs, kan utföras via Azure Powershell eller CLI</span><span class="sxs-lookup"><span data-stu-id="fdc09-282">No additional tool necessary, can be accomplished via Azure Powershell or CLI</span></span> |<span data-ttu-id="fdc09-283">manuell process kunden måste ta hand om skript och hantering av kopierade BLOB för återställning</span><span class="sxs-lookup"><span data-stu-id="fdc09-283">manual process, customer has to take care of scripting and management of copied blobs for restore</span></span>|
|<span data-ttu-id="fdc09-284">Kopiera till NFS-resurs</span><span class="sxs-lookup"><span data-stu-id="fdc09-284">Copy to NFS share</span></span>                                  |<span data-ttu-id="fdc09-285">Efter bearbetning av säkerhetskopior på andra Virtuella utan påverkan på HANA-server</span><span class="sxs-lookup"><span data-stu-id="fdc09-285">Post-processing of backup files on other VM without impact on the HANA server</span></span>|<span data-ttu-id="fdc09-286">Långsam kopieringsprocessen</span><span class="sxs-lookup"><span data-stu-id="fdc09-286">Slow copy process</span></span>|
|<span data-ttu-id="fdc09-287">Kopiera Blobxfer till Azures Filtjänst</span><span class="sxs-lookup"><span data-stu-id="fdc09-287">Blobxfer copy to Azure File Service</span></span>                |<span data-ttu-id="fdc09-288">Inte äta utrymme på den lokala Virtuella diskar</span><span class="sxs-lookup"><span data-stu-id="fdc09-288">Doesn't eat up space on local VM disks</span></span>|<span data-ttu-id="fdc09-289">Ingen direkt skriva stöd av HANA säkerhetskopiering, storleksbegränsningen på filresursen för närvarande på 5 TB</span><span class="sxs-lookup"><span data-stu-id="fdc09-289">No direct write support by HANA backup, size restriction of file share currently at 5 TB</span></span>|
|<span data-ttu-id="fdc09-290">Azure Backup-agenten</span><span class="sxs-lookup"><span data-stu-id="fdc09-290">Azure Backup Agent</span></span>                                 | <span data-ttu-id="fdc09-291">Är en bättre lösning</span><span class="sxs-lookup"><span data-stu-id="fdc09-291">Would be preferred solution</span></span>         | <span data-ttu-id="fdc09-292">För närvarande inte tillgänglig på Linux</span><span class="sxs-lookup"><span data-stu-id="fdc09-292">Currently not available on Linux</span></span>    |



<span data-ttu-id="fdc09-293">**Säkerhetskopiering SAP HANA baserat på lagring ögonblicksbilder**</span><span class="sxs-lookup"><span data-stu-id="fdc09-293">**Backup SAP HANA based on storage snapshots**</span></span>

|<span data-ttu-id="fdc09-294">Lösning</span><span class="sxs-lookup"><span data-stu-id="fdc09-294">Solution</span></span>                                           |<span data-ttu-id="fdc09-295">Tekniker</span><span class="sxs-lookup"><span data-stu-id="fdc09-295">Pros</span></span>                                 |<span data-ttu-id="fdc09-296">Nackdelar</span><span class="sxs-lookup"><span data-stu-id="fdc09-296">Cons</span></span>                                  |
|---------------------------------------------------|-------------------------------------|--------------------------------------|
|<span data-ttu-id="fdc09-297">Azure Backup-tjänsten</span><span class="sxs-lookup"><span data-stu-id="fdc09-297">Azure Backup Service</span></span>                               | <span data-ttu-id="fdc09-298">Kan säkerhetskopiering baserat på blob ögonblicksbilder</span><span class="sxs-lookup"><span data-stu-id="fdc09-298">Allows VM backup based on blob snapshots</span></span> | <span data-ttu-id="fdc09-299">När du använder inte filen nivån återställning, krävs skapas en ny virtuell dator för återställningen, vilket innebär behovet av en ny nyckel för SAP HANA-licens</span><span class="sxs-lookup"><span data-stu-id="fdc09-299">When not using file level restore, it requires the creation of a new VM for the restore process, which then implies the need of a new SAP HANA license key</span></span>|
|<span data-ttu-id="fdc09-300">Manuell blob ögonblicksbilder</span><span class="sxs-lookup"><span data-stu-id="fdc09-300">Manual blob snapshots</span></span>                              | <span data-ttu-id="fdc09-301">Möjlighet att skapa och återställa specifika Virtuella diskar utan att ändra unikt ID för VM</span><span class="sxs-lookup"><span data-stu-id="fdc09-301">Flexibility to create and restore specific VM disks without changing the unique VM ID</span></span>|<span data-ttu-id="fdc09-302">Alla manuellt arbete som måste göras av kunden</span><span class="sxs-lookup"><span data-stu-id="fdc09-302">All manual work, which has to be done by the customer</span></span>|

## <a name="next-steps"></a><span data-ttu-id="fdc09-303">Nästa steg</span><span class="sxs-lookup"><span data-stu-id="fdc09-303">Next steps</span></span>
* <span data-ttu-id="fdc09-304">[SAP HANA Azure Backup på filnivå](sap-hana-backup-file-level.md) beskriver av filbaserade säkerhetskopieringen.</span><span class="sxs-lookup"><span data-stu-id="fdc09-304">[SAP HANA Azure Backup on file level](sap-hana-backup-file-level.md) describes the file-based backup option.</span></span>
* <span data-ttu-id="fdc09-305">[SAP HANA säkerhetskopiering baserat på lagring ögonblicksbilder](sap-hana-backup-storage-snapshots.md) beskriver det ögonblicksbild-baserad säkerhetskopiering lagringsalternativet.</span><span class="sxs-lookup"><span data-stu-id="fdc09-305">[SAP HANA backup based on storage snapshots](sap-hana-backup-storage-snapshots.md) describes the storage snapshot-based backup option.</span></span>
* <span data-ttu-id="fdc09-306">Information om hur du upprättar och planera för katastrofåterställning för SAP HANA i Azure (stora instanser) med hög tillgänglighet finns [SAP HANA (stora instanser) hög tillgänglighet och katastrofåterställning recovery på Azure](hana-overview-high-availability-disaster-recovery.md).</span><span class="sxs-lookup"><span data-stu-id="fdc09-306">To learn how to establish high availability and plan for disaster recovery of SAP HANA on Azure (large instances), see [SAP HANA (large instances) high availability and disaster recovery on Azure](hana-overview-high-availability-disaster-recovery.md).</span></span>
