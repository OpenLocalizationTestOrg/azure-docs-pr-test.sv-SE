---
title: "aaaDNS namnmatchningsalternativ för Linux virtuella datorer i Azure"
description: "Namnet upplösning scenarier för Linux virtuella datorer i Azure IaaS, inklusive tillhandahålls DNS-tjänster, hybrid externa DNS- och ta med din egen DNS-server."
services: virtual-machines
documentationcenter: na
author: RicksterCDN
manager: timlt
editor: tysonn
ms.assetid: 787a1e04-cebf-4122-a1b4-1fcf0a2bbf5f
ms.service: virtual-machines-linux
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 10/19/2016
ms.author: rclaus
ms.openlocfilehash: 7df2320b6f6b42b479bf4070ea60fe5770a78a41
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 10/06/2017
---
# <a name="dns-name-resolution-options-for-linux-virtual-machines-in-azure"></a><span data-ttu-id="4618c-103">Alternativ för DNS-namnmatchningen för Linux virtuella datorer i Azure</span><span class="sxs-lookup"><span data-stu-id="4618c-103">DNS Name Resolution options for Linux virtual machines in Azure</span></span>
<span data-ttu-id="4618c-104">Azure tillhandahåller DNS-namnmatchning som standard för alla virtuella datorer som är i ett enda virtuellt nätverk.</span><span class="sxs-lookup"><span data-stu-id="4618c-104">Azure provides DNS name resolution by default for all virtual machines that are in a single virtual network.</span></span> <span data-ttu-id="4618c-105">Du kan implementera din egen lösning för DNS-namnet lösning genom att konfigurera dina egna DNS-tjänster på dina virtuella datorer som är värd för Azure.</span><span class="sxs-lookup"><span data-stu-id="4618c-105">You can implement your own DNS name resolution solution by configuring your own DNS services on your virtual machines that Azure hosts.</span></span> <span data-ttu-id="4618c-106">hello bör följande scenarier hjälpa dig att välja hello som passar din situation.</span><span class="sxs-lookup"><span data-stu-id="4618c-106">hello following scenarios should help you choose hello one that works for your situation.</span></span>

* [<span data-ttu-id="4618c-107">Namnmatchning som Azure tillhandahåller</span><span class="sxs-lookup"><span data-stu-id="4618c-107">Name resolution that Azure provides</span></span>](#azure-provided-name-resolution)
* [<span data-ttu-id="4618c-108">Namnmatchning med hjälp av DNS-servern</span><span class="sxs-lookup"><span data-stu-id="4618c-108">Name resolution using your own DNS server</span></span>](#name-resolution-using-your-own-dns-server)

<span data-ttu-id="4618c-109">hello typ av namnmatchning som du använder beror på hur dina virtuella datorer och rollinstanser måste toocommunicate med varandra.</span><span class="sxs-lookup"><span data-stu-id="4618c-109">hello type of name resolution that you use depends on how your virtual machines and role instances need toocommunicate with each other.</span></span>

<span data-ttu-id="4618c-110">hello visar följande tabell scenarier och motsvarande name resolution lösningar:</span><span class="sxs-lookup"><span data-stu-id="4618c-110">hello following table illustrates scenarios and corresponding name resolution solutions:</span></span>

| <span data-ttu-id="4618c-111">**Scenario**</span><span class="sxs-lookup"><span data-stu-id="4618c-111">**Scenario**</span></span> | <span data-ttu-id="4618c-112">**Lösning**</span><span class="sxs-lookup"><span data-stu-id="4618c-112">**Solution**</span></span> | <span data-ttu-id="4618c-113">**Suffix**</span><span class="sxs-lookup"><span data-stu-id="4618c-113">**Suffix**</span></span> |
| --- | --- | --- |
| <span data-ttu-id="4618c-114">Namnmatchning mellan rollinstanser eller virtuella datorer i hello samma virtuella nätverk</span><span class="sxs-lookup"><span data-stu-id="4618c-114">Name resolution between role instances or virtual machines in hello same virtual network</span></span> |[<span data-ttu-id="4618c-115">Namnmatchning som Azure tillhandahåller</span><span class="sxs-lookup"><span data-stu-id="4618c-115">Name resolution that Azure provides</span></span>](#azure-provided-name-resolution) |<span data-ttu-id="4618c-116">värdnamn eller fullständigt kvalificerat domännamn (FQDN)</span><span class="sxs-lookup"><span data-stu-id="4618c-116">hostname or fully-qualified domain name (FQDN)</span></span> |
| <span data-ttu-id="4618c-117">Namnmatchning mellan rollinstanser eller virtuella datorer i olika virtuella nätverk</span><span class="sxs-lookup"><span data-stu-id="4618c-117">Name resolution between role instances or virtual machines in different virtual networks</span></span> |<span data-ttu-id="4618c-118">Kundhanterad DNS-servrar som vidarebefordrar frågor mellan virtuella nätverk för matchning av Azure (DNS-proxy).</span><span class="sxs-lookup"><span data-stu-id="4618c-118">Customer-managed DNS servers that forward queries between virtual networks for resolution by Azure (DNS proxy).</span></span> <span data-ttu-id="4618c-119">Se [namnmatchning med hjälp av DNS-servern](#name-resolution-using-your-own-dns-server).</span><span class="sxs-lookup"><span data-stu-id="4618c-119">See [Name resolution using your own DNS server](#name-resolution-using-your-own-dns-server).</span></span> |<span data-ttu-id="4618c-120">Endast FQDN</span><span class="sxs-lookup"><span data-stu-id="4618c-120">FQDN only</span></span> |
| <span data-ttu-id="4618c-121">Matchning av lokala datorer och tjänstnamn från rollinstanser eller virtuella datorer i Azure</span><span class="sxs-lookup"><span data-stu-id="4618c-121">Resolution of on-premises computers and service names from role instances or virtual machines in Azure</span></span> |<span data-ttu-id="4618c-122">Kundhanterad DNS-servrar (till exempel lokala domänkontrollant, lokala skrivskyddade domänkontrollanten eller en sekundär DNS synkroniseras med hjälp av zonöverföringar).</span><span class="sxs-lookup"><span data-stu-id="4618c-122">Customer-managed DNS servers (for example, on-premises domain controller, local read-only domain controller, or a DNS secondary synced by using zone transfers).</span></span> <span data-ttu-id="4618c-123">Se [namnmatchning med hjälp av DNS-servern](#name-resolution-using-your-own-dns-server).</span><span class="sxs-lookup"><span data-stu-id="4618c-123">See [Name resolution using your own DNS server](#name-resolution-using-your-own-dns-server).</span></span> |<span data-ttu-id="4618c-124">Endast FQDN</span><span class="sxs-lookup"><span data-stu-id="4618c-124">FQDN only</span></span> |
| <span data-ttu-id="4618c-125">Lösning med Azure värdnamn från lokala datorer</span><span class="sxs-lookup"><span data-stu-id="4618c-125">Resolution of Azure hostnames from on-premises computers</span></span> |<span data-ttu-id="4618c-126">Vidarebefordra frågor tooa kundhanterad DNS-proxyserver i hello motsvarande virtuella nätverk.</span><span class="sxs-lookup"><span data-stu-id="4618c-126">Forward queries tooa customer-managed DNS proxy server in hello corresponding virtual network.</span></span> <span data-ttu-id="4618c-127">hello proxyserver vidarebefordrar frågor tooAzure för matchning.</span><span class="sxs-lookup"><span data-stu-id="4618c-127">hello proxy server forwards queries tooAzure for resolution.</span></span> <span data-ttu-id="4618c-128">Se [namnmatchning med hjälp av DNS-servern](#name-resolution-using-your-own-dns-server).</span><span class="sxs-lookup"><span data-stu-id="4618c-128">See [Name resolution using your own DNS server](#name-resolution-using-your-own-dns-server).</span></span> |<span data-ttu-id="4618c-129">Endast FQDN</span><span class="sxs-lookup"><span data-stu-id="4618c-129">FQDN only</span></span> |
| <span data-ttu-id="4618c-130">Omvänd DNS för interna IP-adresser</span><span class="sxs-lookup"><span data-stu-id="4618c-130">Reverse DNS for internal IPs</span></span> |[<span data-ttu-id="4618c-131">Namnmatchning med hjälp av DNS-servern</span><span class="sxs-lookup"><span data-stu-id="4618c-131">Name resolution using your own DNS server</span></span>](#name-resolution-using-your-own-dns-server) |<span data-ttu-id="4618c-132">Saknas</span><span class="sxs-lookup"><span data-stu-id="4618c-132">n/a</span></span> |

## <a name="name-resolution-that-azure-provides"></a><span data-ttu-id="4618c-133">Namnmatchning som Azure tillhandahåller</span><span class="sxs-lookup"><span data-stu-id="4618c-133">Name resolution that Azure provides</span></span>
<span data-ttu-id="4618c-134">Azure erbjuder intern namnmatchning för virtuella datorer och rollinstanser som finns i hello samma virtuella nätverk tillsammans med matchning av offentliga DNS-namn.</span><span class="sxs-lookup"><span data-stu-id="4618c-134">Along with resolution of public DNS names, Azure provides internal name resolution for virtual machines and role instances that are in hello same virtual network.</span></span> <span data-ttu-id="4618c-135">I virtuella nätverk som baseras på Azure Resource Manager är hello DNS-suffix konsekvent på hello virtuella nätverk. hello FQDN behövs inte.</span><span class="sxs-lookup"><span data-stu-id="4618c-135">In virtual networks that are based on Azure Resource Manager, hello DNS suffix is consistent across hello virtual network; hello FQDN is not needed.</span></span> <span data-ttu-id="4618c-136">DNS-namn kan tilldelas tooboth nätverkskort (NIC) och virtuella datorer.</span><span class="sxs-lookup"><span data-stu-id="4618c-136">DNS names can be assigned tooboth network interface cards (NICs) and virtual machines.</span></span> <span data-ttu-id="4618c-137">Även om hello namnmatchning som Azure tillhandahåller inte kräver någon konfiguration, är det inte hello valet för alla distributionsscenarier som det visas på hello föregående tabell.</span><span class="sxs-lookup"><span data-stu-id="4618c-137">Although hello name resolution that Azure provides does not require any configuration, it is not hello appropriate choice for all deployment scenarios, as seen on hello preceding table.</span></span>

### <a name="features-and-considerations"></a><span data-ttu-id="4618c-138">Funktioner och överväganden</span><span class="sxs-lookup"><span data-stu-id="4618c-138">Features and considerations</span></span>
<span data-ttu-id="4618c-139">**Funktioner:**</span><span class="sxs-lookup"><span data-stu-id="4618c-139">**Features:**</span></span>

* <span data-ttu-id="4618c-140">Ingen konfiguration är obligatoriska toouse namnmatchning som Azure tillhandahåller.</span><span class="sxs-lookup"><span data-stu-id="4618c-140">No configuration is required toouse name resolution that Azure provides.</span></span>
* <span data-ttu-id="4618c-141">hello namnmatchningstjänst som Azure tillhandahåller har hög tillgänglighet.</span><span class="sxs-lookup"><span data-stu-id="4618c-141">hello name resolution service that Azure provides is highly available.</span></span> <span data-ttu-id="4618c-142">Du inte behöver toocreate och hantera kluster för DNS-servrar.</span><span class="sxs-lookup"><span data-stu-id="4618c-142">You don't need toocreate and manage clusters of your own DNS servers.</span></span>
* <span data-ttu-id="4618c-143">hello namnmatchningstjänst som Azure tillhandahåller kan användas tillsammans med dina egna DNS-servrar tooresolve både lokalt och Azure värdnamn.</span><span class="sxs-lookup"><span data-stu-id="4618c-143">hello name resolution service that Azure provides can be used along with your own DNS servers tooresolve both on-premises and Azure hostnames.</span></span>
* <span data-ttu-id="4618c-144">Namnmatchning tillhandahålls mellan virtuella datorer i virtuella nätverk utan behov av hello FQDN.</span><span class="sxs-lookup"><span data-stu-id="4618c-144">Name resolution is provided between virtual machines in virtual networks without need for hello FQDN.</span></span>
* <span data-ttu-id="4618c-145">Du kan använda värdnamn som bäst beskriver dina distributioner i stället för att arbeta med automatiskt genererat namn.</span><span class="sxs-lookup"><span data-stu-id="4618c-145">You can use hostnames that best describe your deployments rather than working with auto-generated names.</span></span>

<span data-ttu-id="4618c-146">**Att tänka på:**</span><span class="sxs-lookup"><span data-stu-id="4618c-146">**Considerations:**</span></span>

* <span data-ttu-id="4618c-147">hello DNS-suffix som Azure skapar ändras inte.</span><span class="sxs-lookup"><span data-stu-id="4618c-147">hello DNS suffix that Azure creates cannot be modified.</span></span>
* <span data-ttu-id="4618c-148">Du kan registrera dina egna poster manuellt.</span><span class="sxs-lookup"><span data-stu-id="4618c-148">You cannot manually register your own records.</span></span>
* <span data-ttu-id="4618c-149">WINS och NetBIOS stöds inte.</span><span class="sxs-lookup"><span data-stu-id="4618c-149">WINS and NetBIOS are not supported.</span></span>
* <span data-ttu-id="4618c-150">Värdnamn måste vara kompatibel med DNS.</span><span class="sxs-lookup"><span data-stu-id="4618c-150">Hostnames must be DNS-compatible.</span></span>
    <span data-ttu-id="4618c-151">Namn måste använda endast 0-9, a-z och '-', och de får inte inledas eller avslutas med en '-'.</span><span class="sxs-lookup"><span data-stu-id="4618c-151">Names must use only 0-9, a-z, and '-', and they cannot start or end with a '-'.</span></span> <span data-ttu-id="4618c-152">Avsnittet RFC 3696 2.</span><span class="sxs-lookup"><span data-stu-id="4618c-152">See RFC 3696 Section 2.</span></span>
* <span data-ttu-id="4618c-153">DNS-frågorna begränsas för varje virtuell dator.</span><span class="sxs-lookup"><span data-stu-id="4618c-153">DNS query traffic is throttled for each virtual machine.</span></span> <span data-ttu-id="4618c-154">Begränsning bör inte påverka de flesta program.</span><span class="sxs-lookup"><span data-stu-id="4618c-154">Throttling shouldn't impact most applications.</span></span>  <span data-ttu-id="4618c-155">Om begäran begränsning observeras, kontrollerar du att cachelagring på klientsidan är aktiverad.</span><span class="sxs-lookup"><span data-stu-id="4618c-155">If request throttling is observed, ensure that client-side caching is enabled.</span></span>  <span data-ttu-id="4618c-156">Mer information finns i [komma hello de flesta av namnmatchning som Azure tillhandahåller](#getting-the-most-from-name-resolution-that-azure-provides).</span><span class="sxs-lookup"><span data-stu-id="4618c-156">For more information, see [Getting hello most from name resolution that Azure provides](#getting-the-most-from-name-resolution-that-azure-provides).</span></span>

### <a name="getting-hello-most-from-name-resolution-that-azure-provides"></a><span data-ttu-id="4618c-157">Hämta hello de flesta av namnmatchning som Azure tillhandahåller</span><span class="sxs-lookup"><span data-stu-id="4618c-157">Getting hello most from name resolution that Azure provides</span></span>
<span data-ttu-id="4618c-158">**Klientcachelagring:**</span><span class="sxs-lookup"><span data-stu-id="4618c-158">**Client-side caching:**</span></span>

<span data-ttu-id="4618c-159">Några DNS-frågor skickas inte över hello nätverk.</span><span class="sxs-lookup"><span data-stu-id="4618c-159">Some DNS queries are not sent across hello network.</span></span> <span data-ttu-id="4618c-160">Klientcachelagring hjälper minskar svarstider och förbättrar återhämtning toonetwork inkonsekvenser genom att lösa återkommande DNS-frågor från en lokal cache.</span><span class="sxs-lookup"><span data-stu-id="4618c-160">Client-side caching helps reduce latency and improve resilience toonetwork inconsistencies by resolving recurring DNS queries from a local cache.</span></span> <span data-ttu-id="4618c-161">DNS-poster innehåller en Time-To-Live (TTL), vilket gör att hello toostore hello cacheposten så länge som möjligt utan att påverka poster dokumentens.</span><span class="sxs-lookup"><span data-stu-id="4618c-161">DNS records contain a Time-To-Live (TTL), which enables hello cache toostore hello record for as long as possible without impacting record freshness.</span></span> <span data-ttu-id="4618c-162">Därför lämpar klientcachelagring sig för de flesta situationer.</span><span class="sxs-lookup"><span data-stu-id="4618c-162">As a result, client-side caching is suitable for most situations.</span></span>

<span data-ttu-id="4618c-163">Vissa Linux-distributioner som innehåller inte cachelagring som standard.</span><span class="sxs-lookup"><span data-stu-id="4618c-163">Some Linux distributions do not include caching by default.</span></span> <span data-ttu-id="4618c-164">Vi rekommenderar att du lägger till en cache tooeach Linux-dator när du har kontrollerat att det inte är ett lokalt cacheminne redan.</span><span class="sxs-lookup"><span data-stu-id="4618c-164">We recommend that you add a cache tooeach Linux virtual machine after you check that there isn't a local cache already.</span></span>

<span data-ttu-id="4618c-165">Det finns flera olika DNS cachelagring paket, till exempel dnsmasq.</span><span class="sxs-lookup"><span data-stu-id="4618c-165">Several different DNS caching packages, such as dnsmasq, are available.</span></span> <span data-ttu-id="4618c-166">Här följer hello steg tooinstall dnsmasq på de vanligaste hello-distributioner:</span><span class="sxs-lookup"><span data-stu-id="4618c-166">Here are hello steps tooinstall dnsmasq on hello most common distributions:</span></span>

<span data-ttu-id="4618c-167">**Ubuntu (använder resolvconf)**</span><span class="sxs-lookup"><span data-stu-id="4618c-167">**Ubuntu (uses resolvconf)**</span></span>
  * <span data-ttu-id="4618c-168">Installera hello dnsmasq paketet (”sudo lgh get installera dnsmasq”).</span><span class="sxs-lookup"><span data-stu-id="4618c-168">Install hello dnsmasq package (“sudo apt-get install dnsmasq”).</span></span>

<span data-ttu-id="4618c-169">**SUSE (använder netconf)**:</span><span class="sxs-lookup"><span data-stu-id="4618c-169">**SUSE (uses netconf)**:</span></span>
1. <span data-ttu-id="4618c-170">Installera hello dnsmasq paketet (”sudo zypper installera dnsmasq”).</span><span class="sxs-lookup"><span data-stu-id="4618c-170">Install hello dnsmasq package (“sudo zypper install dnsmasq”).</span></span>
2. <span data-ttu-id="4618c-171">Aktivera hello dnsmasq service (”systemctl aktivera dnsmasq.service”).</span><span class="sxs-lookup"><span data-stu-id="4618c-171">Enable hello dnsmasq service (“systemctl enable dnsmasq.service”).</span></span>
3. <span data-ttu-id="4618c-172">Starta hello dnsmasq (”systemctl start dnsmasq.service”).</span><span class="sxs-lookup"><span data-stu-id="4618c-172">Start hello dnsmasq service (“systemctl start dnsmasq.service”).</span></span>
4. <span data-ttu-id="4618c-173">Redigera ”/ etc/sysconfig/nätverk/config” och ändra NETCONFIG_DNS_FORWARDER = ”” för ”dnsmasq”.</span><span class="sxs-lookup"><span data-stu-id="4618c-173">Edit “/etc/sysconfig/network/config”, and change NETCONFIG_DNS_FORWARDER="" too”dnsmasq”.</span></span>
5. <span data-ttu-id="4618c-174">Uppdatera resolv.conf (”netconfig update”) tooset hello-cachen som hello lokala DNS-matchning.</span><span class="sxs-lookup"><span data-stu-id="4618c-174">Update resolv.conf ("netconfig update") tooset hello cache as hello local DNS resolver.</span></span>

<span data-ttu-id="4618c-175">**CentOS av falska Wave programvara (tidigare OpenLogic; använder NetworkManager)**</span><span class="sxs-lookup"><span data-stu-id="4618c-175">**CentOS by Rogue Wave Software (formerly OpenLogic; uses NetworkManager)**</span></span>
1. <span data-ttu-id="4618c-176">Installera hello dnsmasq paketet (”sudo yum installera dnsmasq”).</span><span class="sxs-lookup"><span data-stu-id="4618c-176">Install hello dnsmasq package (“sudo yum install dnsmasq”).</span></span>
2. <span data-ttu-id="4618c-177">Aktivera hello dnsmasq service (”systemctl aktivera dnsmasq.service”).</span><span class="sxs-lookup"><span data-stu-id="4618c-177">Enable hello dnsmasq service (“systemctl enable dnsmasq.service”).</span></span>
3. <span data-ttu-id="4618c-178">Starta hello dnsmasq (”systemctl start dnsmasq.service”).</span><span class="sxs-lookup"><span data-stu-id="4618c-178">Start hello dnsmasq service (“systemctl start dnsmasq.service”).</span></span>
4. <span data-ttu-id="4618c-179">Lägg till ”lägga domän-namnservrar 127.0.0.1”; too"/etc/dhclient-eth0.conf”.</span><span class="sxs-lookup"><span data-stu-id="4618c-179">Add “prepend domain-name-servers 127.0.0.1;” too“/etc/dhclient-eth0.conf”.</span></span>
5. <span data-ttu-id="4618c-180">Starta om hello network service (”tjänsten network omstart”) tooset hello cache vid hello lokala DNS-matchning</span><span class="sxs-lookup"><span data-stu-id="4618c-180">Restart hello network service (“service network restart”) tooset hello cache as hello local DNS resolver</span></span>

> [!NOTE]
> <span data-ttu-id="4618c-181">: hello 'dnsmasq' paketet är endast ett av många DNS cachelagrar hello som är tillgängliga för Linux.</span><span class="sxs-lookup"><span data-stu-id="4618c-181">: hello 'dnsmasq' package is only one of hello many DNS caches that are available for Linux.</span></span> <span data-ttu-id="4618c-182">Innan du använder det. Kontrollera dess lämplighet för dina behov och att ingen annan cache är installerad.</span><span class="sxs-lookup"><span data-stu-id="4618c-182">Before you use it, check its suitability for your needs and that no other cache is installed.</span></span>
>
>

<span data-ttu-id="4618c-183">**Klientsidans återförsök**</span><span class="sxs-lookup"><span data-stu-id="4618c-183">**Client-side retries**</span></span>

<span data-ttu-id="4618c-184">DNS är främst ett UDP-protokoll.</span><span class="sxs-lookup"><span data-stu-id="4618c-184">DNS is primarily a UDP protocol.</span></span> <span data-ttu-id="4618c-185">Eftersom hello UDP-protokollet inte garantera meddelandeleverans, hanterar hello själva DNS-protokollet logik.</span><span class="sxs-lookup"><span data-stu-id="4618c-185">Because hello UDP protocol doesn't guarantee message delivery, hello DNS protocol itself handles retry logic.</span></span> <span data-ttu-id="4618c-186">Varje DNS-klient (operativsystemet) kan ha olika logik beroende på hello creator inställningar:</span><span class="sxs-lookup"><span data-stu-id="4618c-186">Each DNS client (operating system) can exhibit different retry logic depending on hello creator's preference:</span></span>

* <span data-ttu-id="4618c-187">Windows-operativsystem försök igen efter att en andra och sedan igen efter en annan två, fyra och ett annat fyra sekunder.</span><span class="sxs-lookup"><span data-stu-id="4618c-187">Windows operating systems retry after one second and then again after another two, four, and another four seconds.</span></span>
* <span data-ttu-id="4618c-188">hello standard Linux installationsprogrammet återförsök efter fem sekunder.</span><span class="sxs-lookup"><span data-stu-id="4618c-188">hello default Linux setup retries after five seconds.</span></span>  <span data-ttu-id="4618c-189">Du bör ändra den här tooretry fem gånger på en sekunds intervall.</span><span class="sxs-lookup"><span data-stu-id="4618c-189">You should change this tooretry five times at one-second intervals.</span></span>  

<span data-ttu-id="4618c-190">toocheck hello aktuella inställningarna på en virtuell Linux-dator, 'cat /etc/resolv.conf' och titta på hello ”alternativ” rad, till exempel:</span><span class="sxs-lookup"><span data-stu-id="4618c-190">toocheck hello current settings on a Linux virtual machine, 'cat /etc/resolv.conf', and look at hello 'options' line, for example:</span></span>

    options timeout:1 attempts:5

<span data-ttu-id="4618c-191">Hej resolv.conf filen genereras automatiskt och bör inte redigeras.</span><span class="sxs-lookup"><span data-stu-id="4618c-191">hello resolv.conf file is auto-generated and should not be edited.</span></span> <span data-ttu-id="4618c-192">Hej särskilda åtgärder som lägger till hello ”alternativ” rad varierar beroende på distributionsplatser:</span><span class="sxs-lookup"><span data-stu-id="4618c-192">hello specific steps that add hello 'options' line vary by distribution:</span></span>

<span data-ttu-id="4618c-193">**Ubuntu** (använder resolvconf)</span><span class="sxs-lookup"><span data-stu-id="4618c-193">**Ubuntu** (uses resolvconf)</span></span>
1. <span data-ttu-id="4618c-194">Lägg till hello alternativ rad too'/etc/resolveconf/resolv.conf.d/head'.</span><span class="sxs-lookup"><span data-stu-id="4618c-194">Add hello options line too'/etc/resolveconf/resolv.conf.d/head'.</span></span>
2. <span data-ttu-id="4618c-195">Kör resolvconf -u tooupdate.</span><span class="sxs-lookup"><span data-stu-id="4618c-195">Run 'resolvconf -u' tooupdate.</span></span>

<span data-ttu-id="4618c-196">**SUSE** (använder netconf)</span><span class="sxs-lookup"><span data-stu-id="4618c-196">**SUSE** (uses netconf)</span></span>
1. <span data-ttu-id="4618c-197">Lägg till 'timeout:1 försök: 5' toohello NETCONFIG_DNS_RESOLVER_OPTIONS = ”” parametern i ”/ etc/sysconfig/nätverk/config”.</span><span class="sxs-lookup"><span data-stu-id="4618c-197">Add 'timeout:1 attempts:5' toohello NETCONFIG_DNS_RESOLVER_OPTIONS="" parameter in '/etc/sysconfig/network/config'.</span></span>
2. <span data-ttu-id="4618c-198">Kör tooupdate netconfig-uppdateringen.</span><span class="sxs-lookup"><span data-stu-id="4618c-198">Run 'netconfig update' tooupdate.</span></span>

<span data-ttu-id="4618c-199">**CentOS av falska Wave-programvara (tidigare OpenLogic)** (använder NetworkManager)</span><span class="sxs-lookup"><span data-stu-id="4618c-199">**CentOS by Rogue Wave Software (formerly OpenLogic)** (uses NetworkManager)</span></span>
1. <span data-ttu-id="4618c-200">Lägg till 'echo ”alternativ timeout:1 försök: 5”' too'/etc/NetworkManager/dispatcher.d/11-dhclient'.</span><span class="sxs-lookup"><span data-stu-id="4618c-200">Add 'echo "options timeout:1 attempts:5"' too'/etc/NetworkManager/dispatcher.d/11-dhclient'.</span></span>
2. <span data-ttu-id="4618c-201">Kör 'service nätverket restart' tooupdate.</span><span class="sxs-lookup"><span data-stu-id="4618c-201">Run 'service network restart' tooupdate.</span></span>

## <a name="name-resolution-using-your-own-dns-server"></a><span data-ttu-id="4618c-202">Namnmatchning med hjälp av DNS-servern</span><span class="sxs-lookup"><span data-stu-id="4618c-202">Name resolution using your own DNS server</span></span>
<span data-ttu-id="4618c-203">Din namnmatchningen kan utöver hello-funktioner som Azure tillhandahåller.</span><span class="sxs-lookup"><span data-stu-id="4618c-203">Your name resolution needs may go beyond hello features that Azure provides.</span></span> <span data-ttu-id="4618c-204">Du kan till exempel kräva DNS-matchning mellan virtuella nätverk.</span><span class="sxs-lookup"><span data-stu-id="4618c-204">For example, you might require DNS resolution between virtual networks.</span></span> <span data-ttu-id="4618c-205">toocover i det här scenariot kan du använda DNS-servrar.</span><span class="sxs-lookup"><span data-stu-id="4618c-205">toocover this scenario, you can use your own DNS servers.</span></span>  

<span data-ttu-id="4618c-206">DNS-servrar i ett virtuellt nätverk kan vidarebefordra DNS-frågor toorecursive matchare Azure tooresolve värdnamn som finns i hello samma virtuella nätverk.</span><span class="sxs-lookup"><span data-stu-id="4618c-206">DNS servers within a virtual network can forward DNS queries toorecursive resolvers of Azure tooresolve hostnames that are in hello same virtual network.</span></span> <span data-ttu-id="4618c-207">En DNS-server som körs i Azure kan till exempel svara tooDNS frågor för sin egen DNS-zonen filer och vidarebefordra alla frågor tooAzure.</span><span class="sxs-lookup"><span data-stu-id="4618c-207">For example, a DNS server that runs in Azure can respond tooDNS queries for its own DNS zone files and forward all other queries tooAzure.</span></span> <span data-ttu-id="4618c-208">Den här funktionen möjliggör toosee för virtuella datorer både din poster i zonen filer och värdnamn som Azure tillhandahåller (via hello vidarebefordrare).</span><span class="sxs-lookup"><span data-stu-id="4618c-208">This functionality enables virtual machines toosee both your entries in your zone files and hostnames that Azure provides (via hello forwarder).</span></span> <span data-ttu-id="4618c-209">Åtkomst toohello rekursiv matchare Azure tillhandahålls via hello virtuella IP-Adressen 168.63.129.16.</span><span class="sxs-lookup"><span data-stu-id="4618c-209">Access toohello recursive resolvers of Azure is provided via hello virtual IP 168.63.129.16.</span></span>

<span data-ttu-id="4618c-210">DNS-vidarebefordran också aktiverar DNS-matchning mellan virtuella nätverk och gör att dina lokala datorer tooresolve värdnamn som Azure tillhandahåller.</span><span class="sxs-lookup"><span data-stu-id="4618c-210">DNS forwarding also enables DNS resolution between virtual networks and enables your on-premises machines tooresolve hostnames that Azure provides.</span></span> <span data-ttu-id="4618c-211">tooresolve värdnamn för en virtuell dator, virtuell dator med hello DNS-server måste finnas i hello samma virtuella nätverk och vara konfigurerade tooforward hostname frågor tooAzure.</span><span class="sxs-lookup"><span data-stu-id="4618c-211">tooresolve a virtual machine's hostname, hello DNS server virtual machine must reside in hello same virtual network and be configured tooforward hostname queries tooAzure.</span></span> <span data-ttu-id="4618c-212">Eftersom hello DNS-suffix skiljer sig åt i varje virtuellt nätverk, kan du använda villkorlig vidarebefordran regler toosend DNS-frågor toohello korrigera virtuellt nätverk för matchning.</span><span class="sxs-lookup"><span data-stu-id="4618c-212">Because hello DNS suffix is different in each virtual network, you can use conditional forwarding rules toosend DNS queries toohello correct virtual network for resolution.</span></span> <span data-ttu-id="4618c-213">hello följande bild visar två virtuella nätverk och ett lokalt nätverk som gör att DNS-matchning mellan virtuella nätverk med hjälp av den här metoden:</span><span class="sxs-lookup"><span data-stu-id="4618c-213">hello following image shows two virtual networks and an on-premises network doing DNS resolution between virtual networks by using this method:</span></span>

![DNS-matchning mellan virtuella nätverk](./media/azure-dns/inter-vnet-dns.png)

<span data-ttu-id="4618c-215">När du använder namnmatchning som Azure tillhandahåller som hello interna DNS-suffix tooeach virtuell dator med hjälp av DHCP.</span><span class="sxs-lookup"><span data-stu-id="4618c-215">When you use name resolution that Azure provides, hello internal DNS suffix is provided tooeach virtual machine by using DHCP.</span></span> <span data-ttu-id="4618c-216">När du använder din egen lösning för name resolution är detta suffix inte angiven toovirtual datorer eftersom hello suffix stör andra DNS-arkitekturer.</span><span class="sxs-lookup"><span data-stu-id="4618c-216">When you use your own name resolution solution, this suffix is not supplied toovirtual machines because hello suffix interferes with other DNS architectures.</span></span> <span data-ttu-id="4618c-217">toorefer toomachines av FQDN eller tooconfigure hello-suffix på virtuella datorer, kan du använda PowerShell eller hello API toodetermine hello-suffix:</span><span class="sxs-lookup"><span data-stu-id="4618c-217">toorefer toomachines by FQDN or tooconfigure hello suffix on your virtual machines, you can use PowerShell or hello API toodetermine hello suffix:</span></span>

* <span data-ttu-id="4618c-218">För virtuella nätverk som hanteras av Azure Resource Manager hello-suffix som är tillgängliga via hello [nätverkskort](https://msdn.microsoft.com/library/azure/mt163668.aspx) resurs.</span><span class="sxs-lookup"><span data-stu-id="4618c-218">For virtual networks that are managed by Azure Resource Manager, hello suffix is available via hello [network interface card](https://msdn.microsoft.com/library/azure/mt163668.aspx) resource.</span></span> <span data-ttu-id="4618c-219">Du kan också köra hello `azure network public-ip show <resource group> <pip name>` kommandot toodisplay hello information om offentlig IP, vilket innefattar hello FQDN för hello NIC.</span><span class="sxs-lookup"><span data-stu-id="4618c-219">You can also run hello `azure network public-ip show <resource group> <pip name>` command toodisplay hello details of your public IP, which includes hello FQDN of hello NIC.</span></span>

<span data-ttu-id="4618c-220">Om vidarebefordran av frågor tooAzure inte passar dina behov, måste tooprovide DNS-lösningen.</span><span class="sxs-lookup"><span data-stu-id="4618c-220">If forwarding queries tooAzure doesn't suit your needs, you need tooprovide your own DNS solution.</span></span>  <span data-ttu-id="4618c-221">DNS-lösningen behöver:</span><span class="sxs-lookup"><span data-stu-id="4618c-221">Your DNS solution needs to:</span></span>

* <span data-ttu-id="4618c-222">Ange lämpliga värdnamnsmatchning, till exempel [DDNS](../../virtual-network/virtual-networks-name-resolution-ddns.md).</span><span class="sxs-lookup"><span data-stu-id="4618c-222">Provide appropriate hostname resolution, for example via [DDNS](../../virtual-network/virtual-networks-name-resolution-ddns.md).</span></span> <span data-ttu-id="4618c-223">Om du använder DDNS kan behöva du toodisable DNS-posten rensning.</span><span class="sxs-lookup"><span data-stu-id="4618c-223">If you use DDNS, you might need toodisable DNS record scavenging.</span></span> <span data-ttu-id="4618c-224">DHCP-lån för Azure är mycket långa och rensning kan ta bort DNS-poster för tidigt.</span><span class="sxs-lookup"><span data-stu-id="4618c-224">DHCP leases of Azure are very long and scavenging may remove DNS records prematurely.</span></span>
* <span data-ttu-id="4618c-225">Ange lämpliga rekursiv namnmatchning tooallow matchning av extern domännamn.</span><span class="sxs-lookup"><span data-stu-id="4618c-225">Provide appropriate recursive resolution tooallow resolution of external domain names.</span></span>
* <span data-ttu-id="4618c-226">Tillgänglig (TCP och UDP-port 53) från hello klienter den fungerar och kan tooaccess hello Internet.</span><span class="sxs-lookup"><span data-stu-id="4618c-226">Be accessible (TCP and UDP on port 53) from hello clients it serves and be able tooaccess hello Internet.</span></span>
* <span data-ttu-id="4618c-227">Skyddas mot åtkomst från hello Internet toomitigate hot med externa agenter.</span><span class="sxs-lookup"><span data-stu-id="4618c-227">Be secured against access from hello Internet toomitigate threats posed by external agents.</span></span>

> [!NOTE]
> <span data-ttu-id="4618c-228">För bästa prestanda när du använder virtuella datorer i Azure DNS-servrar, inaktivera IPv6 och tilldela en [offentlig IP på instansnivå](../../virtual-network/virtual-networks-instance-level-public-ip.md) tooeach DNS-server-datorn.</span><span class="sxs-lookup"><span data-stu-id="4618c-228">For best performance, when you use virtual machines in Azure DNS servers, disable IPv6 and assign an [Instance-Level Public IP](../../virtual-network/virtual-networks-instance-level-public-ip.md) tooeach DNS server virtual machine.</span></span>  
>
>
