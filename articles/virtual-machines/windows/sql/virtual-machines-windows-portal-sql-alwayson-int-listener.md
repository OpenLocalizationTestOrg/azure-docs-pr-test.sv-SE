---
title: "aaaCreate en tillgänglighetsgruppslyssnare för SQL Server på virtuella Azure-datorer | Microsoft Docs"
description: "Stegvisa instruktioner för att skapa en lyssnare för en Always On-tillgänglighetsgrupp för SQL Server på virtuella Azure-datorer"
services: virtual-machines
documentationcenter: na
author: MikeRayMSFT
manager: jhubbard
editor: monicar
ms.assetid: d1f291e9-9af2-41ba-9d29-9541e3adcfcf
ms.service: virtual-machines-sql
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: vm-windows-sql-server
ms.workload: iaas-sql-server
ms.date: 05/01/2017
ms.author: mikeray
ms.openlocfilehash: c6a44dc5c7c18b572c2bf5772b4651b7210aacbd
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 10/06/2017
---
# <a name="configure-a-load-balancer-for-an-always-on-availability-group-in-azure"></a><span data-ttu-id="0d400-103">Konfigurera en belastningsutjämnare för en tillgänglighetsgrupp alltid på i Azure</span><span class="sxs-lookup"><span data-stu-id="0d400-103">Configure a load balancer for an Always On availability group in Azure</span></span>
<span data-ttu-id="0d400-104">Den här artikeln förklarar hur toocreate belastningsutjämning för en SQL Server Always On-tillgänglighetsgrupp i Azure virtuella datorer som körs med Azure Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="0d400-104">This article explains how toocreate a load balancer for a SQL Server Always On availability group in Azure virtual machines that are running with Azure Resource Manager.</span></span> <span data-ttu-id="0d400-105">En tillgänglighetsgrupp kräver en belastningsutjämnare när hello SQL Server-instanser finns på virtuella Azure-datorer.</span><span class="sxs-lookup"><span data-stu-id="0d400-105">An availability group requires a load balancer when hello SQL Server instances are on Azure virtual machines.</span></span> <span data-ttu-id="0d400-106">hello belastningsutjämnaren lagrar hello IP-adress för hello tillgänglighetsgruppens lyssnare.</span><span class="sxs-lookup"><span data-stu-id="0d400-106">hello load balancer stores hello IP address for hello availability group listener.</span></span> <span data-ttu-id="0d400-107">Om en tillgänglighetsgrupp sträcker sig över flera regioner, måste en belastningsutjämnare i varje region.</span><span class="sxs-lookup"><span data-stu-id="0d400-107">If an availability group spans multiple regions, each region needs a load balancer.</span></span>

<span data-ttu-id="0d400-108">toocomplete den här uppgiften måste toohave en tillgänglighetsgrupp för SQL Server distribueras på virtuella Azure-datorer som körs med Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="0d400-108">toocomplete this task, you need toohave a SQL Server availability group deployed on Azure virtual machines that are running with Resource Manager.</span></span> <span data-ttu-id="0d400-109">Både SQL Server-datorer måste tillhöra toohello samma tillgänglighetsuppsättning.</span><span class="sxs-lookup"><span data-stu-id="0d400-109">Both SQL Server virtual machines must belong toohello same availability set.</span></span> <span data-ttu-id="0d400-110">Du kan använda hello [Microsoft mall](virtual-machines-windows-portal-sql-alwayson-availability-groups.md) tooautomatically skapa hello tillgänglighetsgruppen i Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="0d400-110">You can use hello [Microsoft template](virtual-machines-windows-portal-sql-alwayson-availability-groups.md) tooautomatically create hello availability group in Resource Manager.</span></span> <span data-ttu-id="0d400-111">Den här mallen skapas automatiskt en intern belastningsutjämnare.</span><span class="sxs-lookup"><span data-stu-id="0d400-111">This template automatically creates an internal load balancer for you.</span></span> 

<span data-ttu-id="0d400-112">Om du vill kan du [manuellt konfigurera en tillgänglighetsgrupp](virtual-machines-windows-portal-sql-alwayson-availability-groups-manual.md).</span><span class="sxs-lookup"><span data-stu-id="0d400-112">If you prefer, you can [manually configure an availability group](virtual-machines-windows-portal-sql-alwayson-availability-groups-manual.md).</span></span>

<span data-ttu-id="0d400-113">Den här artikeln kräver att din Tillgänglighetsgrupper har redan konfigurerats.</span><span class="sxs-lookup"><span data-stu-id="0d400-113">This article requires that your availability groups are already configured.</span></span>  

<span data-ttu-id="0d400-114">Närliggande ämnen innefattar:</span><span class="sxs-lookup"><span data-stu-id="0d400-114">Related topics include:</span></span>

* [<span data-ttu-id="0d400-115">Konfigurera alltid på Tillgänglighetsgrupper i Azure VM (GUI)</span><span class="sxs-lookup"><span data-stu-id="0d400-115">Configure Always On availability groups in Azure VM (GUI)</span></span>](virtual-machines-windows-portal-sql-alwayson-availability-groups-manual.md)   
* [<span data-ttu-id="0d400-116">Konfigurera en VNet-till-VNet-anslutning med hjälp av Azure Resource Manager och PowerShell</span><span class="sxs-lookup"><span data-stu-id="0d400-116">Configure a VNet-to-VNet connection by using Azure Resource Manager and PowerShell</span></span>](../../../vpn-gateway/vpn-gateway-vnet-vnet-rm-ps.md)

<span data-ttu-id="0d400-117">Gå igenom den här artikeln, skapa och konfigurera en belastningsutjämnare i hello Azure-portalen.</span><span class="sxs-lookup"><span data-stu-id="0d400-117">By walking through this article, you create and configure a load balancer in hello Azure portal.</span></span> <span data-ttu-id="0d400-118">När hello processen är klar kan du konfigurera hello toouse hello IP-klusteradress från hello belastningsutjämnaren för hello tillgänglighetsgruppens lyssnare.</span><span class="sxs-lookup"><span data-stu-id="0d400-118">After hello process is complete, you configure hello cluster toouse hello IP address from hello load balancer for hello availability group listener.</span></span>

## <a name="create-and-configure-hello-load-balancer-in-hello-azure-portal"></a><span data-ttu-id="0d400-119">Skapa och konfigurera hello belastningsutjämnare i hello Azure-portalen</span><span class="sxs-lookup"><span data-stu-id="0d400-119">Create and configure hello load balancer in hello Azure portal</span></span>
<span data-ttu-id="0d400-120">I den här delen av hello uppgiften hello följande:</span><span class="sxs-lookup"><span data-stu-id="0d400-120">In this portion of hello task, do hello following:</span></span>

1. <span data-ttu-id="0d400-121">Skapa hello belastningsutjämnaren hello Azure-portalen och konfigurera hello IP-adress.</span><span class="sxs-lookup"><span data-stu-id="0d400-121">In hello Azure portal, create hello load balancer and configure hello IP address.</span></span>
2. <span data-ttu-id="0d400-122">Konfigurera hello backend-adresspool.</span><span class="sxs-lookup"><span data-stu-id="0d400-122">Configure hello back-end pool.</span></span>
3. <span data-ttu-id="0d400-123">Skapa hello avsökningen.</span><span class="sxs-lookup"><span data-stu-id="0d400-123">Create hello probe.</span></span> 
4. <span data-ttu-id="0d400-124">Ange hello regler för belastningsutjämning.</span><span class="sxs-lookup"><span data-stu-id="0d400-124">Set hello load balancing rules.</span></span>

> [!NOTE]
> <span data-ttu-id="0d400-125">Om hello SQL Server-instanser i flera resursgrupper och regioner, utför varje steg två gånger, en gång i varje resursgrupp.</span><span class="sxs-lookup"><span data-stu-id="0d400-125">If hello SQL Server instances are in multiple resource groups and regions, perform each step twice, once in each resource group.</span></span>
> 
> 

### <a name="step-1-create-hello-load-balancer-and-configure-hello-ip-address"></a><span data-ttu-id="0d400-126">Steg 1: Skapa hello belastningsutjämnare och konfigurera hello IP-adress</span><span class="sxs-lookup"><span data-stu-id="0d400-126">Step 1: Create hello load balancer and configure hello IP address</span></span>
<span data-ttu-id="0d400-127">Först skapa hello belastningsutjämnaren.</span><span class="sxs-lookup"><span data-stu-id="0d400-127">First, create hello load balancer.</span></span> 

1. <span data-ttu-id="0d400-128">Öppna hello resursgruppen som innehåller hello SQL Server-datorer i hello Azure-portalen.</span><span class="sxs-lookup"><span data-stu-id="0d400-128">In hello Azure portal, open hello resource group that contains hello SQL Server virtual machines.</span></span> 

2. <span data-ttu-id="0d400-129">I hello resursgrupp, klickar du på **Lägg till**.</span><span class="sxs-lookup"><span data-stu-id="0d400-129">In hello resource group, click **Add**.</span></span>

3. <span data-ttu-id="0d400-130">Sök efter **belastningsutjämnare** och markera i hello sökresultat **belastningsutjämnare**, som publiceras av **Microsoft**.</span><span class="sxs-lookup"><span data-stu-id="0d400-130">Search for **load balancer** and then, in hello search results, select **Load Balancer**, which is published by **Microsoft**.</span></span>

4. <span data-ttu-id="0d400-131">På hello **belastningsutjämnaren** bladet, klickar du på **skapa**.</span><span class="sxs-lookup"><span data-stu-id="0d400-131">On hello **Load Balancer** blade, click **Create**.</span></span>

5. <span data-ttu-id="0d400-132">I hello **skapa belastningsutjämnaren** dialogrutan Konfigurera hello belastningsutjämnaren på följande sätt:</span><span class="sxs-lookup"><span data-stu-id="0d400-132">In hello **Create load balancer** dialog box, configure hello load balancer as follows:</span></span>

   | <span data-ttu-id="0d400-133">Inställning</span><span class="sxs-lookup"><span data-stu-id="0d400-133">Setting</span></span> | <span data-ttu-id="0d400-134">Värde</span><span class="sxs-lookup"><span data-stu-id="0d400-134">Value</span></span> |
   | --- | --- |
   | <span data-ttu-id="0d400-135">**Namn**</span><span class="sxs-lookup"><span data-stu-id="0d400-135">**Name**</span></span> |<span data-ttu-id="0d400-136">Ett namn som representerar hello belastningsutjämnaren.</span><span class="sxs-lookup"><span data-stu-id="0d400-136">A text name representing hello load balancer.</span></span> <span data-ttu-id="0d400-137">Till exempel **sqlLB**.</span><span class="sxs-lookup"><span data-stu-id="0d400-137">For example, **sqlLB**.</span></span> |
   | <span data-ttu-id="0d400-138">**Typ**</span><span class="sxs-lookup"><span data-stu-id="0d400-138">**Type**</span></span> |<span data-ttu-id="0d400-139">**Internt**: använda en intern belastningsutjämnare, vilket gör att program inom hello för de flesta implementeringar av samma virtuella nätverk tooconnect toohello tillgänglighetsgruppen.</span><span class="sxs-lookup"><span data-stu-id="0d400-139">**Internal**: Most implementations use an internal load balancer, which allows applications within hello same virtual network tooconnect toohello availability group.</span></span>  </br> <span data-ttu-id="0d400-140">**Externa**: gör att program tooconnect toohello tillgänglighetsgruppen via en offentlig Internetanslutning.</span><span class="sxs-lookup"><span data-stu-id="0d400-140">**External**: Allows applications tooconnect toohello availability group through a public Internet connection.</span></span> |
   | <span data-ttu-id="0d400-141">**Virtuellt nätverk**</span><span class="sxs-lookup"><span data-stu-id="0d400-141">**Virtual network**</span></span> |<span data-ttu-id="0d400-142">Välj hello virtuella nätverk som hello intances för SQL Server finns i.</span><span class="sxs-lookup"><span data-stu-id="0d400-142">Select hello virtual network that hello SQL Server intances are in.</span></span> |
   | <span data-ttu-id="0d400-143">**Undernät**</span><span class="sxs-lookup"><span data-stu-id="0d400-143">**Subnet**</span></span> |<span data-ttu-id="0d400-144">Välj hello undernät som hello SQL Server-instanser.</span><span class="sxs-lookup"><span data-stu-id="0d400-144">Select hello subnet that hello SQL Server instances are in.</span></span> |
   | <span data-ttu-id="0d400-145">**IP-adresstilldelning**</span><span class="sxs-lookup"><span data-stu-id="0d400-145">**IP address assignment**</span></span> |<span data-ttu-id="0d400-146">**Statisk**</span><span class="sxs-lookup"><span data-stu-id="0d400-146">**Static**</span></span> |
   | <span data-ttu-id="0d400-147">**Privat IP-adress**</span><span class="sxs-lookup"><span data-stu-id="0d400-147">**Private IP address**</span></span> |<span data-ttu-id="0d400-148">Ange en tillgänglig IP-adress från hello undernät.</span><span class="sxs-lookup"><span data-stu-id="0d400-148">Specify an available IP address from hello subnet.</span></span> <span data-ttu-id="0d400-149">Använd följande IP-adress när du skapar en lyssnare på hello klustret.</span><span class="sxs-lookup"><span data-stu-id="0d400-149">Use this IP address when you create a listener on hello cluster.</span></span> <span data-ttu-id="0d400-150">Använd den här adressen i ett PowerShell.skript, senare i den här artikeln för hello `$ILBIP` variabeln.</span><span class="sxs-lookup"><span data-stu-id="0d400-150">In a PowerShell script, later in this article, use this address for hello `$ILBIP` variable.</span></span> |
   | <span data-ttu-id="0d400-151">**Prenumeration**</span><span class="sxs-lookup"><span data-stu-id="0d400-151">**Subscription**</span></span> |<span data-ttu-id="0d400-152">Om du har flera prenumerationer, visas det här fältet.</span><span class="sxs-lookup"><span data-stu-id="0d400-152">If you have multiple subscriptions, this field might appear.</span></span> <span data-ttu-id="0d400-153">Välj hello prenumeration som du vill tooassociate med den här resursen.</span><span class="sxs-lookup"><span data-stu-id="0d400-153">Select hello subscription that you want tooassociate with this resource.</span></span> <span data-ttu-id="0d400-154">Det är normalt hello samma prenumeration som alla hello resurser för hello-tillgänglighetsgruppen.</span><span class="sxs-lookup"><span data-stu-id="0d400-154">It is normally hello same subscription as all hello resources for hello availability group.</span></span> |
   | <span data-ttu-id="0d400-155">**Resursgrupp**</span><span class="sxs-lookup"><span data-stu-id="0d400-155">**Resource group**</span></span> |<span data-ttu-id="0d400-156">Välj hello resursgrupp som hello SQL Server-instanser.</span><span class="sxs-lookup"><span data-stu-id="0d400-156">Select hello resource group that hello SQL Server instances are in.</span></span> |
   | <span data-ttu-id="0d400-157">**Plats**</span><span class="sxs-lookup"><span data-stu-id="0d400-157">**Location**</span></span> |<span data-ttu-id="0d400-158">Välj hello Azure-plats som hello SQL Server-instanser.</span><span class="sxs-lookup"><span data-stu-id="0d400-158">Select hello Azure location that hello SQL Server instances are in.</span></span> |

6. <span data-ttu-id="0d400-159">Klicka på **Skapa**.</span><span class="sxs-lookup"><span data-stu-id="0d400-159">Click **Create**.</span></span> 

<span data-ttu-id="0d400-160">Azure skapar hello belastningsutjämnaren.</span><span class="sxs-lookup"><span data-stu-id="0d400-160">Azure creates hello load balancer.</span></span> <span data-ttu-id="0d400-161">hello belastningsutjämnaren tillhör tooa nätverk, undernät, resursgrupp och plats.</span><span class="sxs-lookup"><span data-stu-id="0d400-161">hello load balancer belongs tooa specific network, subnet, resource group, and location.</span></span> <span data-ttu-id="0d400-162">När Azure har slutförts hello aktiviteten Kontrollera hello inställningarna för belastningsutjämnaren i Azure.</span><span class="sxs-lookup"><span data-stu-id="0d400-162">After Azure completes hello task, verify hello load balancer settings in Azure.</span></span> 

### <a name="step-2-configure-hello-back-end-pool"></a><span data-ttu-id="0d400-163">Steg 2: Konfigurera hello backend-adresspool</span><span class="sxs-lookup"><span data-stu-id="0d400-163">Step 2: Configure hello back-end pool</span></span>
<span data-ttu-id="0d400-164">Azure anrop hello backend-adresspool *serverdelspool*.</span><span class="sxs-lookup"><span data-stu-id="0d400-164">Azure calls hello back-end address pool *backend pool*.</span></span> <span data-ttu-id="0d400-165">I det här fallet är hello backend-adresspool hello-adresserna för hello två SQL Server-instanser i tillgänglighetsgruppen.</span><span class="sxs-lookup"><span data-stu-id="0d400-165">In this case, hello back-end pool is hello addresses of hello two SQL Server instances in your availability group.</span></span> 

1. <span data-ttu-id="0d400-166">Klicka på hello belastningsutjämnare som du skapat i din resursgrupp.</span><span class="sxs-lookup"><span data-stu-id="0d400-166">In your resource group, click hello load balancer that you created.</span></span> 

2. <span data-ttu-id="0d400-167">På **inställningar**, klickar du på **serverdelspooler**.</span><span class="sxs-lookup"><span data-stu-id="0d400-167">On **Settings**, click **Backend pools**.</span></span>

3. <span data-ttu-id="0d400-168">På **serverdelspooler**, klickar du på **Lägg till** toocreate en backend-adresspool.</span><span class="sxs-lookup"><span data-stu-id="0d400-168">On **Backend pools**, click **Add** toocreate a back-end address pool.</span></span> 

4. <span data-ttu-id="0d400-169">På **lägga till serverdelspoolen**under **namn**, Skriv ett namn för hello backend-adresspool.</span><span class="sxs-lookup"><span data-stu-id="0d400-169">On **Add backend pool**, under **Name**, type a name for hello back-end pool.</span></span>

5. <span data-ttu-id="0d400-170">Under **virtuella datorer**, klickar du på **lägga till en virtuell dator**.</span><span class="sxs-lookup"><span data-stu-id="0d400-170">Under **Virtual machines**, click **Add a virtual machine**.</span></span> 

6. <span data-ttu-id="0d400-171">Under **Välj virtuella datorer**, klickar du på **Välj en tillgänglighetsuppsättning**, och sedan ange hello tillgänglighetsuppsättning att hello SQL Server-datorer som tillhör.</span><span class="sxs-lookup"><span data-stu-id="0d400-171">Under **Choose virtual machines**, click **Choose an availability set**, and then specify hello availability set that hello SQL Server virtual machines belong to.</span></span>

7. <span data-ttu-id="0d400-172">När du har valt hello tillgänglighetsuppsättning klickar du på **Välj hello virtuella datorerna**, Välj hello två virtuella datorer som hello SQL Server-instanser i hello tillgänglighetsgruppen, och klicka sedan på **Välj**.</span><span class="sxs-lookup"><span data-stu-id="0d400-172">After you have chosen hello availability set, click **Choose hello virtual machines**, select hello two virtual machines that host hello SQL Server instances in hello availability group, and then click **Select**.</span></span> 

8. <span data-ttu-id="0d400-173">Klicka på **OK** tooclose hello blad för **Välj virtuella datorer**, och **lägga till serverdelspoolen**.</span><span class="sxs-lookup"><span data-stu-id="0d400-173">Click **OK** tooclose hello blades for **Choose virtual machines**, and **Add backend pool**.</span></span> 

<span data-ttu-id="0d400-174">Azure uppdaterar hello inställningar för hello backend-adresspool.</span><span class="sxs-lookup"><span data-stu-id="0d400-174">Azure updates hello settings for hello back-end address pool.</span></span> <span data-ttu-id="0d400-175">Din tillgänglighetsuppsättning har nu en pool med två SQL Server-instanser.</span><span class="sxs-lookup"><span data-stu-id="0d400-175">Now your availability set has a pool of two SQL Server instances.</span></span>

### <a name="step-3-create-a-probe"></a><span data-ttu-id="0d400-176">Steg 3: Skapa en avsökning</span><span class="sxs-lookup"><span data-stu-id="0d400-176">Step 3: Create a probe</span></span>
<span data-ttu-id="0d400-177">hello avsökningen definierar hur Azure verifierar som hello SQL Server-instanser för närvarande äger hello tillgänglighetsgruppens lyssnare.</span><span class="sxs-lookup"><span data-stu-id="0d400-177">hello probe defines how Azure verifies which of hello SQL Server instances currently owns hello availability group listener.</span></span> <span data-ttu-id="0d400-178">Azure-avsökningar hello tjänsten baserat på hello IP-adress på en port som du anger när du skapar hello avsökning.</span><span class="sxs-lookup"><span data-stu-id="0d400-178">Azure probes hello service based on hello IP address on a port that you define when you create hello probe.</span></span>

1. <span data-ttu-id="0d400-179">På hello belastningsutjämnare **inställningar** bladet, klickar du på **hälsoavsökning**.</span><span class="sxs-lookup"><span data-stu-id="0d400-179">On hello load balancer **Settings** blade, click **Health probes**.</span></span> 

2. <span data-ttu-id="0d400-180">På hello **hälsoavsökning** bladet, klickar du på **Lägg till**.</span><span class="sxs-lookup"><span data-stu-id="0d400-180">On hello **Health probes** blade, click **Add**.</span></span>

3. <span data-ttu-id="0d400-181">Konfigurera hello avsökning på hello **Lägg till avsökning** bladet.</span><span class="sxs-lookup"><span data-stu-id="0d400-181">Configure hello probe on hello **Add probe** blade.</span></span> <span data-ttu-id="0d400-182">Använd hello följande värden tooconfigure hello avsökning:</span><span class="sxs-lookup"><span data-stu-id="0d400-182">Use hello following values tooconfigure hello probe:</span></span>

   | <span data-ttu-id="0d400-183">Inställning</span><span class="sxs-lookup"><span data-stu-id="0d400-183">Setting</span></span> | <span data-ttu-id="0d400-184">Värde</span><span class="sxs-lookup"><span data-stu-id="0d400-184">Value</span></span> |
   | --- | --- |
   | <span data-ttu-id="0d400-185">**Namn**</span><span class="sxs-lookup"><span data-stu-id="0d400-185">**Name**</span></span> |<span data-ttu-id="0d400-186">Ett namn som representerar hello avsökning.</span><span class="sxs-lookup"><span data-stu-id="0d400-186">A text name representing hello probe.</span></span> <span data-ttu-id="0d400-187">Till exempel **SQLAlwaysOnEndPointProbe**.</span><span class="sxs-lookup"><span data-stu-id="0d400-187">For example, **SQLAlwaysOnEndPointProbe**.</span></span> |
   | <span data-ttu-id="0d400-188">**Protokoll**</span><span class="sxs-lookup"><span data-stu-id="0d400-188">**Protocol**</span></span> |<span data-ttu-id="0d400-189">**TCP**</span><span class="sxs-lookup"><span data-stu-id="0d400-189">**TCP**</span></span> |
   | <span data-ttu-id="0d400-190">**Port**</span><span class="sxs-lookup"><span data-stu-id="0d400-190">**Port**</span></span> |<span data-ttu-id="0d400-191">Du kan använda alla tillgängliga portar.</span><span class="sxs-lookup"><span data-stu-id="0d400-191">You can use any available port.</span></span> <span data-ttu-id="0d400-192">Till exempel *59999*.</span><span class="sxs-lookup"><span data-stu-id="0d400-192">For example, *59999*.</span></span> |
   | <span data-ttu-id="0d400-193">**Intervall**</span><span class="sxs-lookup"><span data-stu-id="0d400-193">**Interval**</span></span> |<span data-ttu-id="0d400-194">*5*</span><span class="sxs-lookup"><span data-stu-id="0d400-194">*5*</span></span> |
   | <span data-ttu-id="0d400-195">**Tröskelvärde för ohälsosamt värde**</span><span class="sxs-lookup"><span data-stu-id="0d400-195">**Unhealthy threshold**</span></span> |<span data-ttu-id="0d400-196">*2*</span><span class="sxs-lookup"><span data-stu-id="0d400-196">*2*</span></span> |

4.  <span data-ttu-id="0d400-197">Klicka på **OK**.</span><span class="sxs-lookup"><span data-stu-id="0d400-197">Click **OK**.</span></span> 

> [!NOTE]
> <span data-ttu-id="0d400-198">Kontrollera att hello-port som du anger är öppen hello-brandväggen för både SQL Server-instanser.</span><span class="sxs-lookup"><span data-stu-id="0d400-198">Make sure that hello port you specify is open on hello firewall of both SQL Server instances.</span></span> <span data-ttu-id="0d400-199">Båda instanser kräver en inkommande regel för hello TCP-port som du använder.</span><span class="sxs-lookup"><span data-stu-id="0d400-199">Both instances require an inbound rule for hello TCP port that you use.</span></span> <span data-ttu-id="0d400-200">Mer information finns i [Lägg till eller redigera brandväggsregel](http://technet.microsoft.com/library/cc753558.aspx).</span><span class="sxs-lookup"><span data-stu-id="0d400-200">For more information, see [Add or Edit Firewall Rule](http://technet.microsoft.com/library/cc753558.aspx).</span></span> 
> 
> 

<span data-ttu-id="0d400-201">Azure skapar hello avsökning och använder sedan vilka SQL Server-instansen har hello-lyssnare för hello tillgänglighetsgruppen tootest.</span><span class="sxs-lookup"><span data-stu-id="0d400-201">Azure creates hello probe and then uses it tootest which SQL Server instance has hello listener for hello availability group.</span></span>

### <a name="step-4-set-hello-load-balancing-rules"></a><span data-ttu-id="0d400-202">Steg 4: Ange hello regler för belastningsutjämning</span><span class="sxs-lookup"><span data-stu-id="0d400-202">Step 4: Set hello load balancing rules</span></span>
<span data-ttu-id="0d400-203">Hej belastningsutjämningsregler konfigurera hur hello belastningsutjämnaren dirigerar trafik toohello SQL Server-instanser.</span><span class="sxs-lookup"><span data-stu-id="0d400-203">hello load balancing rules configure how hello load balancer routes traffic toohello SQL Server instances.</span></span> <span data-ttu-id="0d400-204">För den här belastningsutjämnaren aktivera direkt serverreturnering eftersom endast en av hello två SQL Server-instanser äger hello lyssnare tillgänglighetsgruppsresursen i taget.</span><span class="sxs-lookup"><span data-stu-id="0d400-204">For this load balancer, you enable direct server return because only one of hello two SQL Server instances owns hello availability group listener resource at a time.</span></span>

1. <span data-ttu-id="0d400-205">På hello belastningsutjämnare **inställningar** bladet, klickar du på **belastningsutjämningsregler**.</span><span class="sxs-lookup"><span data-stu-id="0d400-205">On hello load balancer **Settings** blade, click **Load balancing rules**.</span></span> 

2. <span data-ttu-id="0d400-206">På hello **belastningsutjämningsregler** bladet, klickar du på **Lägg till**.</span><span class="sxs-lookup"><span data-stu-id="0d400-206">On hello **Load balancing rules** blade, click **Add**.</span></span>

3. <span data-ttu-id="0d400-207">På hello **Lägg till regler för belastningsutjämning** bladet konfigurera hello regeln för belastningsutjämning.</span><span class="sxs-lookup"><span data-stu-id="0d400-207">On hello **Add load balancing rules** blade, configure hello load balancing rule.</span></span> <span data-ttu-id="0d400-208">Använd hello följande inställningar:</span><span class="sxs-lookup"><span data-stu-id="0d400-208">Use hello following settings:</span></span> 

   | <span data-ttu-id="0d400-209">Inställning</span><span class="sxs-lookup"><span data-stu-id="0d400-209">Setting</span></span> | <span data-ttu-id="0d400-210">Värde</span><span class="sxs-lookup"><span data-stu-id="0d400-210">Value</span></span> |
   | --- | --- |
   | <span data-ttu-id="0d400-211">**Namn**</span><span class="sxs-lookup"><span data-stu-id="0d400-211">**Name**</span></span> |<span data-ttu-id="0d400-212">Ett namn som representerar hello regler för belastningsutjämning.</span><span class="sxs-lookup"><span data-stu-id="0d400-212">A text name representing hello load balancing rules.</span></span> <span data-ttu-id="0d400-213">Till exempel **SQLAlwaysOnEndPointListener**.</span><span class="sxs-lookup"><span data-stu-id="0d400-213">For example, **SQLAlwaysOnEndPointListener**.</span></span> |
   | <span data-ttu-id="0d400-214">**Protokoll**</span><span class="sxs-lookup"><span data-stu-id="0d400-214">**Protocol**</span></span> |<span data-ttu-id="0d400-215">**TCP**</span><span class="sxs-lookup"><span data-stu-id="0d400-215">**TCP**</span></span> |
   | <span data-ttu-id="0d400-216">**Port**</span><span class="sxs-lookup"><span data-stu-id="0d400-216">**Port**</span></span> |<span data-ttu-id="0d400-217">*1433*</span><span class="sxs-lookup"><span data-stu-id="0d400-217">*1433*</span></span> |
   | <span data-ttu-id="0d400-218">**Backend-Port**</span><span class="sxs-lookup"><span data-stu-id="0d400-218">**Backend Port**</span></span> |<span data-ttu-id="0d400-219">*1433*. Det här värdet ignoreras eftersom den här regeln använder **flytande IP (direkt serverreturnering)**.</span><span class="sxs-lookup"><span data-stu-id="0d400-219">*1433*. This value is ignored because this rule uses **Floating IP (direct server return)**.</span></span> |
   | <span data-ttu-id="0d400-220">**Avsökningen**</span><span class="sxs-lookup"><span data-stu-id="0d400-220">**Probe**</span></span> |<span data-ttu-id="0d400-221">Använda hello namnet på hello-avsökningen som du skapade för denna belastningsutjämning.</span><span class="sxs-lookup"><span data-stu-id="0d400-221">Use hello name of hello probe that you created for this load balancer.</span></span> |
   | <span data-ttu-id="0d400-222">**Persistence för session**</span><span class="sxs-lookup"><span data-stu-id="0d400-222">**Session persistence**</span></span> |<span data-ttu-id="0d400-223">**Ingen**</span><span class="sxs-lookup"><span data-stu-id="0d400-223">**None**</span></span> |
   | <span data-ttu-id="0d400-224">**Tidsgränsen för inaktivitet (minuter)**</span><span class="sxs-lookup"><span data-stu-id="0d400-224">**Idle timeout (minutes)**</span></span> |<span data-ttu-id="0d400-225">*4*</span><span class="sxs-lookup"><span data-stu-id="0d400-225">*4*</span></span> |
   | <span data-ttu-id="0d400-226">**Flytande IP (direkt serverreturnering)**</span><span class="sxs-lookup"><span data-stu-id="0d400-226">**Floating IP (direct server return)**</span></span> |<span data-ttu-id="0d400-227">**Aktiverad**</span><span class="sxs-lookup"><span data-stu-id="0d400-227">**Enabled**</span></span> |

   > [!NOTE]
   > <span data-ttu-id="0d400-228">Du kanske tooscroll ned hello bladet tooview alla hello-inställningar.</span><span class="sxs-lookup"><span data-stu-id="0d400-228">You might have tooscroll down hello blade tooview all hello settings.</span></span>
   > 

4. <span data-ttu-id="0d400-229">Klicka på **OK**.</span><span class="sxs-lookup"><span data-stu-id="0d400-229">Click **OK**.</span></span> 
5. <span data-ttu-id="0d400-230">Azure konfigurerar hello regel för belastningsutjämning.</span><span class="sxs-lookup"><span data-stu-id="0d400-230">Azure configures hello load balancing rule.</span></span> <span data-ttu-id="0d400-231">Hello belastningsutjämning är nu konfigurerad tooroute trafik toohello SQL Server-instans som är värd för hello-lyssnare för hello-tillgänglighetsgruppen.</span><span class="sxs-lookup"><span data-stu-id="0d400-231">Now hello load balancer is configured tooroute traffic toohello SQL Server instance that hosts hello listener for hello availability group.</span></span> 

<span data-ttu-id="0d400-232">Hello resursgruppen har nu en belastningsutjämnare som ansluter tooboth SQL Server-datorer.</span><span class="sxs-lookup"><span data-stu-id="0d400-232">At this point, hello resource group has a load balancer that connects tooboth SQL Server machines.</span></span> <span data-ttu-id="0d400-233">hello belastningsutjämnaren innehåller också en IP-adress för hello SQL Server alltid på tillgänglighetsgruppens lyssnare, så att antingen datorn kan svara toorequests för hello Tillgänglighetsgrupper.</span><span class="sxs-lookup"><span data-stu-id="0d400-233">hello load balancer also contains an IP address for hello SQL Server Always On availability group listener, so that either machine can respond toorequests for hello availability groups.</span></span>

> [!NOTE]
> <span data-ttu-id="0d400-234">Om SQL Server-instanser i två olika områden, upprepa hello stegen i hello annan region.</span><span class="sxs-lookup"><span data-stu-id="0d400-234">If your SQL Server instances are in two separate regions, repeat hello steps in hello other region.</span></span> <span data-ttu-id="0d400-235">Varje region kräver en belastningsutjämnare.</span><span class="sxs-lookup"><span data-stu-id="0d400-235">Each region requires a load balancer.</span></span> 
> 
> 

## <a name="configure-hello-cluster-toouse-hello-load-balancer-ip-address"></a><span data-ttu-id="0d400-236">Konfigurera hello klustret toouse hello IP-adressen för belastningsutjämnaren</span><span class="sxs-lookup"><span data-stu-id="0d400-236">Configure hello cluster toouse hello load balancer IP address</span></span>
<span data-ttu-id="0d400-237">Nästa steg i hello tooconfigure hello lyssnare på hello klustret och ta hello-lyssnare.</span><span class="sxs-lookup"><span data-stu-id="0d400-237">hello next step is tooconfigure hello listener on hello cluster, and bring hello listener online.</span></span> <span data-ttu-id="0d400-238">Hej du följande:</span><span class="sxs-lookup"><span data-stu-id="0d400-238">Do hello following:</span></span> 

1. <span data-ttu-id="0d400-239">Skapa hello tillgänglighetsgruppens lyssnare på hello failover-kluster.</span><span class="sxs-lookup"><span data-stu-id="0d400-239">Create hello availability group listener on hello failover cluster.</span></span> 

2. <span data-ttu-id="0d400-240">Sätta hello-lyssnaren.</span><span class="sxs-lookup"><span data-stu-id="0d400-240">Bring hello listener online.</span></span>

### <a name="step-5-create-hello-availability-group-listener-on-hello-failover-cluster"></a><span data-ttu-id="0d400-241">Steg 5: Skapa hello tillgänglighetsgruppens lyssnare på hello failover-kluster</span><span class="sxs-lookup"><span data-stu-id="0d400-241">Step 5: Create hello availability group listener on hello failover cluster</span></span>
<span data-ttu-id="0d400-242">I det här steget kan skapa du manuellt hello tillgänglighetsgruppens lyssnare i hanteraren för redundanskluster och SQL Server Management Studio.</span><span class="sxs-lookup"><span data-stu-id="0d400-242">In this step, you manually create hello availability group listener in Failover Cluster Manager and SQL Server Management Studio.</span></span>

[!INCLUDE [ag-listener-configure](../../../../includes/virtual-machines-ag-listener-configure.md)]

### <a name="verify-hello-configuration-of-hello-listener"></a><span data-ttu-id="0d400-243">Verifiera konfigurationen av hello på hello-lyssnare</span><span class="sxs-lookup"><span data-stu-id="0d400-243">Verify hello configuration of hello listener</span></span>

<span data-ttu-id="0d400-244">Om beroenden och hello klusterresurser är korrekt konfigurerade ska kunna tooview hello lyssnare i SQL Server Management Studio.</span><span class="sxs-lookup"><span data-stu-id="0d400-244">If hello cluster resources and dependencies are correctly configured, you should be able tooview hello listener in SQL Server Management Studio.</span></span> <span data-ttu-id="0d400-245">tooset Hej lyssningsport, hello följande:</span><span class="sxs-lookup"><span data-stu-id="0d400-245">tooset hello listener port, do hello following:</span></span>

1. <span data-ttu-id="0d400-246">Starta SQL Server Management Studio och Anslut toohello primära repliken.</span><span class="sxs-lookup"><span data-stu-id="0d400-246">Start SQL Server Management Studio, and then connect toohello primary replica.</span></span>

2. <span data-ttu-id="0d400-247">Gå för**AlwaysOn hög tillgänglighet** > **Tillgänglighetsgrupper** > **tillgänglighet Tillgänglighetsgruppslyssnarnas**.</span><span class="sxs-lookup"><span data-stu-id="0d400-247">Go too**AlwaysOn High Availability** > **Availability Groups** > **Availability Group Listeners**.</span></span>  
    <span data-ttu-id="0d400-248">Du bör nu se hello grupplyssnarens namn som du skapade i hanteraren för redundanskluster.</span><span class="sxs-lookup"><span data-stu-id="0d400-248">You should now see hello listener name that you created in Failover Cluster Manager.</span></span> 

3. <span data-ttu-id="0d400-249">Högerklicka på hello grupplyssnarens namn och klicka sedan på **egenskaper**.</span><span class="sxs-lookup"><span data-stu-id="0d400-249">Right-click hello listener name, and then click **Properties**.</span></span>

4. <span data-ttu-id="0d400-250">I hello **Port** ange hello portnummer för hello tillgänglighetsgruppens lyssnare med hjälp av hello $EndpointPort du använde tidigare (1433 var hello standard), och klicka sedan på **OK**.</span><span class="sxs-lookup"><span data-stu-id="0d400-250">In hello **Port** box, specify hello port number for hello availability group listener by using hello $EndpointPort you used earlier (1433 was hello default), and then click **OK**.</span></span>

<span data-ttu-id="0d400-251">Nu har du en tillgänglighetsgrupp i Azure virtuella datorer som körs i läget Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="0d400-251">You now have an availability group in Azure virtual machines running in Resource Manager mode.</span></span> 

## <a name="test-hello-connection-toohello-listener"></a><span data-ttu-id="0d400-252">Testa hello anslutning toohello lyssnare</span><span class="sxs-lookup"><span data-stu-id="0d400-252">Test hello connection toohello listener</span></span>
<span data-ttu-id="0d400-253">Testa hello anslutning hello följande:</span><span class="sxs-lookup"><span data-stu-id="0d400-253">Test hello connection by doing hello following:</span></span>

1. <span data-ttu-id="0d400-254">RDP tooa SQL Server-instans som är i hello samma virtuella nätverk, men inte egna hello replik.</span><span class="sxs-lookup"><span data-stu-id="0d400-254">RDP tooa SQL Server instance that is in hello same virtual network, but does not own hello replica.</span></span> <span data-ttu-id="0d400-255">Den här servern kan hello andra SQLServer-instansen i hello kluster.</span><span class="sxs-lookup"><span data-stu-id="0d400-255">This server can be hello other SQL Server instance in hello cluster.</span></span>

2. <span data-ttu-id="0d400-256">Använd **sqlcmd** verktyget tootest hello anslutning.</span><span class="sxs-lookup"><span data-stu-id="0d400-256">Use **sqlcmd** utility tootest hello connection.</span></span> <span data-ttu-id="0d400-257">Till exempel följande skript hello upprättar en **sqlcmd** anslutning toohello primära repliken via hello lyssnare med Windows-autentisering:</span><span class="sxs-lookup"><span data-stu-id="0d400-257">For example, hello following script establishes a **sqlcmd** connection toohello primary replica through hello listener with Windows authentication:</span></span>
   
        sqlcmd -S <listenerName> -E

<span data-ttu-id="0d400-258">hello SQLCMD anslutning ansluter automatiskt toohello SQL Server-instans som är värd för hello primära repliken.</span><span class="sxs-lookup"><span data-stu-id="0d400-258">hello SQLCMD connection automatically connects toohello SQL Server instance that hosts hello primary replica.</span></span> 

## <a name="create-an-ip-address-for-an-additional-availability-group"></a><span data-ttu-id="0d400-259">Skapa en IP-adress för en ytterligare tillgänglighetsgrupp</span><span class="sxs-lookup"><span data-stu-id="0d400-259">Create an IP address for an additional availability group</span></span>

<span data-ttu-id="0d400-260">Varje tillgänglighetsgruppen använder en separat lyssnare.</span><span class="sxs-lookup"><span data-stu-id="0d400-260">Each availability group uses a separate listener.</span></span> <span data-ttu-id="0d400-261">Varje lyssnare har sin egen IP-adress.</span><span class="sxs-lookup"><span data-stu-id="0d400-261">Each listener has its own IP address.</span></span> <span data-ttu-id="0d400-262">Använd hello samma IP-adressen för belastningsutjämnaren toohold hello att läsa in för ytterligare lyssnare.</span><span class="sxs-lookup"><span data-stu-id="0d400-262">Use hello same load balancer toohold hello IP address for additional listeners.</span></span> <span data-ttu-id="0d400-263">När du har skapat en tillgänglighetsgrupp lägga till hello IP-adress toohello belastningsutjämnare och sedan konfigurera hello-lyssnare.</span><span class="sxs-lookup"><span data-stu-id="0d400-263">After you create an availability group, add hello IP address toohello load balancer, and then configure hello listener.</span></span>

<span data-ttu-id="0d400-264">tooadd en IP-adress tooa belastningsutjämnare med hello Azure-portalen hello följande:</span><span class="sxs-lookup"><span data-stu-id="0d400-264">tooadd an IP address tooa load balancer with hello Azure portal, do hello following:</span></span>

1. <span data-ttu-id="0d400-265">Öppna hello resursgruppen som innehåller hello belastningsutjämnare i hello Azure-portalen, och klicka på hello belastningsutjämnaren.</span><span class="sxs-lookup"><span data-stu-id="0d400-265">In hello Azure portal, open hello resource group that contains hello load balancer, and then click hello load balancer.</span></span> 

2. <span data-ttu-id="0d400-266">Under **inställningar**, klickar du på **Frontend IP-pool**, och klicka sedan på **Lägg till**.</span><span class="sxs-lookup"><span data-stu-id="0d400-266">Under **SETTINGS**, click **Frontend IP pool**, and then click **Add**.</span></span> 

3. <span data-ttu-id="0d400-267">Under **lägga till IP-adress för klientdel**, tilldela ett namn för hello klientdelen.</span><span class="sxs-lookup"><span data-stu-id="0d400-267">Under **Add frontend IP address**, assign a name for hello front end.</span></span> 

4. <span data-ttu-id="0d400-268">Kontrollera att hello **för virtuella nätverk** och hello **undernät** är hello samma som hello SQL Server-instanser.</span><span class="sxs-lookup"><span data-stu-id="0d400-268">Verify that hello **Virtual network** and hello **Subnet** are hello same as hello SQL Server instances.</span></span>

5. <span data-ttu-id="0d400-269">Ange hello IP-adress för hello-lyssnaren.</span><span class="sxs-lookup"><span data-stu-id="0d400-269">Set hello IP address for hello listener.</span></span> 
   
   >[!TIP]
   ><span data-ttu-id="0d400-270">Du kan ange hello IP-adress toostatic och ange en adress som inte används för närvarande i hello undernät.</span><span class="sxs-lookup"><span data-stu-id="0d400-270">You can set hello IP address toostatic and type an address that is not currently used in hello subnet.</span></span> <span data-ttu-id="0d400-271">Du kan också ange hello IP-adress toodynamic och spara hello nya frontend IP-adresspool.</span><span class="sxs-lookup"><span data-stu-id="0d400-271">Alternatively, you can set hello IP address toodynamic and save hello new front-end IP pool.</span></span> <span data-ttu-id="0d400-272">När du gör det tilldelas en tillgänglig IP-toohello adresspool automatiskt hello Azure-portalen.</span><span class="sxs-lookup"><span data-stu-id="0d400-272">When you do so, hello Azure portal automatically assigns an available IP address toohello pool.</span></span> <span data-ttu-id="0d400-273">Du kan sedan öppna hello frontend IP-adresspool och ändra hello tilldelning toostatic.</span><span class="sxs-lookup"><span data-stu-id="0d400-273">You can then reopen hello front-end IP pool and change hello assignment toostatic.</span></span> 

6. <span data-ttu-id="0d400-274">Spara hello IP-adress för hello-lyssnaren.</span><span class="sxs-lookup"><span data-stu-id="0d400-274">Save hello IP address for hello listener.</span></span> 

7. <span data-ttu-id="0d400-275">Lägg till en hälsoavsökningen med hello följande inställningar:</span><span class="sxs-lookup"><span data-stu-id="0d400-275">Add a health probe by using hello following settings:</span></span>

   |<span data-ttu-id="0d400-276">Inställning</span><span class="sxs-lookup"><span data-stu-id="0d400-276">Setting</span></span> |<span data-ttu-id="0d400-277">Värde</span><span class="sxs-lookup"><span data-stu-id="0d400-277">Value</span></span>
   |:-----|:----
   |<span data-ttu-id="0d400-278">**Namn**</span><span class="sxs-lookup"><span data-stu-id="0d400-278">**Name**</span></span> |<span data-ttu-id="0d400-279">Namnet tooidentify hello avsökning.</span><span class="sxs-lookup"><span data-stu-id="0d400-279">A name tooidentify hello probe.</span></span>
   |<span data-ttu-id="0d400-280">**Protokoll**</span><span class="sxs-lookup"><span data-stu-id="0d400-280">**Protocol**</span></span> |<span data-ttu-id="0d400-281">TCP</span><span class="sxs-lookup"><span data-stu-id="0d400-281">TCP</span></span>
   |<span data-ttu-id="0d400-282">**Port**</span><span class="sxs-lookup"><span data-stu-id="0d400-282">**Port**</span></span> |<span data-ttu-id="0d400-283">En inte används TCP-port som måste finnas tillgängligt på alla virtuella datorer.</span><span class="sxs-lookup"><span data-stu-id="0d400-283">An unused TCP port, which must be available on all virtual machines.</span></span> <span data-ttu-id="0d400-284">Den kan inte användas för andra ändamål.</span><span class="sxs-lookup"><span data-stu-id="0d400-284">It cannot be used for any other purpose.</span></span> <span data-ttu-id="0d400-285">Inga två lyssnare kan använda hello samma avsökning port.</span><span class="sxs-lookup"><span data-stu-id="0d400-285">No two listeners can use hello same probe port.</span></span> 
   |<span data-ttu-id="0d400-286">**Intervall**</span><span class="sxs-lookup"><span data-stu-id="0d400-286">**Interval**</span></span> |<span data-ttu-id="0d400-287">hello tidslängd mellan avsökningen försöker.</span><span class="sxs-lookup"><span data-stu-id="0d400-287">hello amount of time between probe attempts.</span></span> <span data-ttu-id="0d400-288">Använd hello standard (5).</span><span class="sxs-lookup"><span data-stu-id="0d400-288">Use hello default (5).</span></span>
   |<span data-ttu-id="0d400-289">**Tröskelvärde för ohälsosamt värde**</span><span class="sxs-lookup"><span data-stu-id="0d400-289">**Unhealthy threshold**</span></span> |<span data-ttu-id="0d400-290">hello antal på varandra följande tröskelvärden som får misslyckas innan en virtuell dator anses vara felaktig.</span><span class="sxs-lookup"><span data-stu-id="0d400-290">hello number of consecutive thresholds that should fail before a virtual machine is considered unhealthy.</span></span>

8. <span data-ttu-id="0d400-291">Klicka på **OK** toosave hello avsökning.</span><span class="sxs-lookup"><span data-stu-id="0d400-291">Click **OK** toosave hello probe.</span></span> 

9. <span data-ttu-id="0d400-292">Skapa en regel för belastningsutjämning.</span><span class="sxs-lookup"><span data-stu-id="0d400-292">Create a load balancing rule.</span></span> <span data-ttu-id="0d400-293">Klicka på **belastningsutjämningsregler**, och klicka sedan på **Lägg till**.</span><span class="sxs-lookup"><span data-stu-id="0d400-293">Click **Load balancing rules**, and then click **Add**.</span></span>

10. <span data-ttu-id="0d400-294">Konfigurera hello ny regel för belastningsutjämning med hjälp av hello följande inställningar:</span><span class="sxs-lookup"><span data-stu-id="0d400-294">Configure hello new load balancing rule by using hello following settings:</span></span>

   |<span data-ttu-id="0d400-295">Inställning</span><span class="sxs-lookup"><span data-stu-id="0d400-295">Setting</span></span> |<span data-ttu-id="0d400-296">Värde</span><span class="sxs-lookup"><span data-stu-id="0d400-296">Value</span></span>
   |:-----|:----
   |<span data-ttu-id="0d400-297">**Namn**</span><span class="sxs-lookup"><span data-stu-id="0d400-297">**Name**</span></span> |<span data-ttu-id="0d400-298">En namn tooidentify hello att läsa in belastningsutjämning regeln.</span><span class="sxs-lookup"><span data-stu-id="0d400-298">A name tooidentify hello load balancing rule.</span></span> 
   |<span data-ttu-id="0d400-299">**Frontend-IP-adress**</span><span class="sxs-lookup"><span data-stu-id="0d400-299">**Frontend IP address**</span></span> |<span data-ttu-id="0d400-300">Välj hello IP-adress som du skapade.</span><span class="sxs-lookup"><span data-stu-id="0d400-300">Select hello IP address you created.</span></span> 
   |<span data-ttu-id="0d400-301">**Protokoll**</span><span class="sxs-lookup"><span data-stu-id="0d400-301">**Protocol**</span></span> |<span data-ttu-id="0d400-302">TCP</span><span class="sxs-lookup"><span data-stu-id="0d400-302">TCP</span></span>
   |<span data-ttu-id="0d400-303">**Port**</span><span class="sxs-lookup"><span data-stu-id="0d400-303">**Port**</span></span> |<span data-ttu-id="0d400-304">Använda hello-port som använder hello SQL Server-instanser.</span><span class="sxs-lookup"><span data-stu-id="0d400-304">Use hello port that hello SQL Server instances are using.</span></span> <span data-ttu-id="0d400-305">En standardinstans använder port 1433, om du har ändrat den.</span><span class="sxs-lookup"><span data-stu-id="0d400-305">A default instance uses port 1433, unless you changed it.</span></span> 
   |<span data-ttu-id="0d400-306">**Backend-port**</span><span class="sxs-lookup"><span data-stu-id="0d400-306">**Backend port**</span></span> |<span data-ttu-id="0d400-307">Använd hello samma värde som **Port**.</span><span class="sxs-lookup"><span data-stu-id="0d400-307">Use hello same value as **Port**.</span></span>
   |<span data-ttu-id="0d400-308">**Serverdelspool**</span><span class="sxs-lookup"><span data-stu-id="0d400-308">**Backend pool**</span></span> |<span data-ttu-id="0d400-309">hello-pool som innehåller hello virtuella datorer med hello SQL Server-instanser.</span><span class="sxs-lookup"><span data-stu-id="0d400-309">hello pool that contains hello virtual machines with hello SQL Server instances.</span></span> 
   |<span data-ttu-id="0d400-310">**Hälsoavsökningen**</span><span class="sxs-lookup"><span data-stu-id="0d400-310">**Health probe**</span></span> |<span data-ttu-id="0d400-311">Välj hello-avsökningen som du skapade.</span><span class="sxs-lookup"><span data-stu-id="0d400-311">Choose hello probe you created.</span></span>
   |<span data-ttu-id="0d400-312">**Persistence för session**</span><span class="sxs-lookup"><span data-stu-id="0d400-312">**Session persistence**</span></span> |<span data-ttu-id="0d400-313">Ingen</span><span class="sxs-lookup"><span data-stu-id="0d400-313">None</span></span>
   |<span data-ttu-id="0d400-314">**Tidsgränsen för inaktivitet (minuter)**</span><span class="sxs-lookup"><span data-stu-id="0d400-314">**Idle timeout (minutes)**</span></span> |<span data-ttu-id="0d400-315">Standard (4)</span><span class="sxs-lookup"><span data-stu-id="0d400-315">Default (4)</span></span>
   |<span data-ttu-id="0d400-316">**Flytande IP (direkt serverreturnering)**</span><span class="sxs-lookup"><span data-stu-id="0d400-316">**Floating IP (direct server return)**</span></span> | <span data-ttu-id="0d400-317">Enabled</span><span class="sxs-lookup"><span data-stu-id="0d400-317">Enabled</span></span>

### <a name="configure-hello-availability-group-toouse-hello-new-ip-address"></a><span data-ttu-id="0d400-318">Konfigurera hello tillgänglighet grupp toouse hello nya IP-adress</span><span class="sxs-lookup"><span data-stu-id="0d400-318">Configure hello availability group toouse hello new IP address</span></span>

<span data-ttu-id="0d400-319">toofinish konfigurerar hello kluster, upprepa hello steg som du har följt när du har gjort hello första tillgänglighetsgruppen.</span><span class="sxs-lookup"><span data-stu-id="0d400-319">toofinish configuring hello cluster, repeat hello steps that you followed when you made hello first availability group.</span></span> <span data-ttu-id="0d400-320">Det vill säga konfigurerar hello [kluster toouse hello nya IP-adressen](#configure-the-cluster-to-use-the-load-balancer-ip-address).</span><span class="sxs-lookup"><span data-stu-id="0d400-320">That is, configure hello [cluster toouse hello new IP address](#configure-the-cluster-to-use-the-load-balancer-ip-address).</span></span> 

<span data-ttu-id="0d400-321">När du har lagt till en IP-adress för hello lyssnare konfigurera hello ytterligare tillgänglighetsgruppen hello följande:</span><span class="sxs-lookup"><span data-stu-id="0d400-321">After you have added an IP address for hello listener, configure hello additional availability group by doing hello following:</span></span> 

1. <span data-ttu-id="0d400-322">Kontrollera att hello avsökningsport för hello nya IP-adressen är öppen på både SQL Server-datorer.</span><span class="sxs-lookup"><span data-stu-id="0d400-322">Verify that hello probe port for hello new IP address is open on both SQL Server virtual machines.</span></span> 

2. <span data-ttu-id="0d400-323">[I Klusterhanteraren, lägga till hello klientåtkomstpunkt](#addcap).</span><span class="sxs-lookup"><span data-stu-id="0d400-323">[In Cluster Manager, add hello client access point](#addcap).</span></span>

3. <span data-ttu-id="0d400-324">[Konfigurera hello IP-resurs för hello tillgänglighetsgruppen](#congroup).</span><span class="sxs-lookup"><span data-stu-id="0d400-324">[Configure hello IP resource for hello availability group](#congroup).</span></span>

   >[!IMPORTANT]
   ><span data-ttu-id="0d400-325">När du skapar hello IP-adress, använder du hello IP-adress som du lagt till toohello belastningsutjämnaren.</span><span class="sxs-lookup"><span data-stu-id="0d400-325">When you create hello IP address, use hello IP address that you added toohello load balancer.</span></span>  

4. <span data-ttu-id="0d400-326">[Gör hello SQL Server tillgänglighetsgruppsresursen beroende hello klientåtkomstpunkt](#dependencyGroup).</span><span class="sxs-lookup"><span data-stu-id="0d400-326">[Make hello SQL Server availability group resource dependent on hello client access point](#dependencyGroup).</span></span>

5. <span data-ttu-id="0d400-327">[Se hello klientåtkomst peka resurs som är beroende av hello IP-adress](#listname).</span><span class="sxs-lookup"><span data-stu-id="0d400-327">[Make hello client access point resource dependent on hello IP address](#listname).</span></span>
 
6. <span data-ttu-id="0d400-328">[Ange hello Klusterparametrar i PowerShell](#setparam).</span><span class="sxs-lookup"><span data-stu-id="0d400-328">[Set hello cluster parameters in PowerShell](#setparam).</span></span>

<span data-ttu-id="0d400-329">När du har konfigurerat hello tillgänglighet grupp toouse hello nya IP-adresser, konfigurera hello anslutning toohello lyssnare.</span><span class="sxs-lookup"><span data-stu-id="0d400-329">After you configure hello availability group toouse hello new IP address, configure hello connection toohello listener.</span></span> 

## <a name="next-steps"></a><span data-ttu-id="0d400-330">Nästa steg</span><span class="sxs-lookup"><span data-stu-id="0d400-330">Next steps</span></span>

- [<span data-ttu-id="0d400-331">Konfigurera en SQL Server Always On availability group på virtuella Azure-datorer i olika regioner</span><span class="sxs-lookup"><span data-stu-id="0d400-331">Configure a SQL Server Always On availability group on Azure virtual machines in different regions</span></span>](virtual-machines-windows-portal-sql-availability-group-dr.md)
