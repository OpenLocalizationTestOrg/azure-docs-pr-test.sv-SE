---
title: "Hög tillgänglighet och Haveriberedskap för SQLServer | Microsoft Docs"
description: "En beskrivning av de olika typerna av HADR strategier för SQL Server som körs i Azure Virtual Machines."
services: virtual-machines-windows
documentationcenter: na
author: MikeRayMSFT
manager: jhubbard
editor: 
tags: azure-service-management
ms.assetid: 53981f7e-8370-4979-b26a-93a5988d905f
ms.service: virtual-machines-sql
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: vm-windows-sql-server
ms.workload: iaas-sql-server
ms.date: 06/27/2017
ms.author: mikeray
ms.openlocfilehash: 27d05c1681f7d7b3090fc7abd4a6b15d1c030e2c
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 07/11/2017
---
# <a name="high-availability-and-disaster-recovery-for-sql-server-in-azure-virtual-machines"></a><span data-ttu-id="8442d-103">Hög tillgänglighet och haveriberedskap för SQL Server på Azure Virtual Machines</span><span class="sxs-lookup"><span data-stu-id="8442d-103">High availability and disaster recovery for SQL Server in Azure Virtual Machines</span></span>

<span data-ttu-id="8442d-104">Microsoft Azure-datorer (VM) med SQL Server kan sänka kostnaden för en hög tillgänglighet och haveriberedskap (HADR) databasen återställningslösning.</span><span class="sxs-lookup"><span data-stu-id="8442d-104">Microsoft Azure virtual machines (VMs) with SQL Server can help lower the cost of a high availability and disaster recovery (HADR) database solution.</span></span> <span data-ttu-id="8442d-105">De flesta lösningar för SQL Server HADR stöds i Azure-datorer, både som endast Azure och som hybridlösningar.</span><span class="sxs-lookup"><span data-stu-id="8442d-105">Most SQL Server HADR solutions are supported in Azure virtual machines, both as Azure-only and as hybrid solutions.</span></span> <span data-ttu-id="8442d-106">I en endast Azure-lösning kan körs hela HADR systemet i Azure.</span><span class="sxs-lookup"><span data-stu-id="8442d-106">In an Azure-only solution, the entire HADR system runs in Azure.</span></span> <span data-ttu-id="8442d-107">I en hybrid-konfiguration körs en del av lösningen i Azure och andra delen körs lokalt i din organisation.</span><span class="sxs-lookup"><span data-stu-id="8442d-107">In a hybrid configuration, part of the solution runs in Azure and the other part runs on-premises in your organization.</span></span> <span data-ttu-id="8442d-108">Möjlighet att Azure-miljön kan du flytta helt eller delvis till Azure för att uppfylla budget och HADR kraven i din SQL Server-databassystem.</span><span class="sxs-lookup"><span data-stu-id="8442d-108">The flexibility of the Azure environment enables you to move partially or completely to Azure to satisfy the budget and HADR requirements of your SQL Server database systems.</span></span>

[!INCLUDE [learn-about-deployment-models](../../../../includes/learn-about-deployment-models-both-include.md)]

## <a name="understanding-the-need-for-an-hadr-solution"></a><span data-ttu-id="8442d-109">Förstå behovet av en HADR-lösning</span><span class="sxs-lookup"><span data-stu-id="8442d-109">Understanding the need for an HADR solution</span></span>
<span data-ttu-id="8442d-110">Det är att säkerställa att Databassystemet har HADR-funktioner som kräver servicenivåavtal (SLA).</span><span class="sxs-lookup"><span data-stu-id="8442d-110">It is up to you to ensure that your database system possesses the HADR capabilities that the service-level agreement (SLA) requires.</span></span> <span data-ttu-id="8442d-111">Det faktum som Azure tillhandahåller mekanismer för hög tillgänglighet, såsom tjänsten återställning för molntjänster och återställning av felidentifiering för virtuella datorer garanterar inte själv kan du uppfylla SERVICENIVÅAVTALET för önskad.</span><span class="sxs-lookup"><span data-stu-id="8442d-111">The fact that Azure provides high availability mechanisms, such as service healing for cloud services and failure recovery detection for Virtual Machines, does not itself guarantee you can meet the desired SLA.</span></span> <span data-ttu-id="8442d-112">Dessa mekanismer skydda hög tillgänglighet för de virtuella datorerna, men inte hög tillgänglighet för SQL Server som körs i de virtuella datorerna.</span><span class="sxs-lookup"><span data-stu-id="8442d-112">These mechanisms protect the high availability of the VMs but not the high availability of SQL Server running inside the VMs.</span></span> <span data-ttu-id="8442d-113">Det är möjligt för SQL Server-instansen misslyckas medan den virtuella datorn är ansluten och fungerar.</span><span class="sxs-lookup"><span data-stu-id="8442d-113">It is possible for the SQL Server instance to fail while the VM is online and healthy.</span></span> <span data-ttu-id="8442d-114">Dessutom med hög tillgänglighet metoder som tillhandahålls av Azure tillåta driftstopp på de virtuella datorerna på grund av händelser, t.ex återställning från programvara eller maskinvarufel och uppgradering av operativsystemet.</span><span class="sxs-lookup"><span data-stu-id="8442d-114">Moreover, even the high availability mechanisms provided by Azure allow for downtime of the VMs due to events such as recovery from software or hardware failures and operating system upgrades.</span></span>

<span data-ttu-id="8442d-115">Dessutom kanske inte Geo-Redundant lagring (GRS) i Azure som implementeras med en funktion som kallas geo-replikering, en lösning för tillräcklig katastrofåterställning för dina databaser.</span><span class="sxs-lookup"><span data-stu-id="8442d-115">In addition, Geo Redundant Storage (GRS) in Azure, which is implemented with a feature called geo-replication, may not be an adequate disaster recovery solution for your databases.</span></span> <span data-ttu-id="8442d-116">Eftersom geo-replikering skickar data asynkront, förloras de senaste uppdateringarna vid katastrofåterställning.</span><span class="sxs-lookup"><span data-stu-id="8442d-116">Because geo-replication sends data asynchronously, recent updates can be lost in the event of disaster.</span></span> <span data-ttu-id="8442d-117">Mer information om begränsningar för geo-replikering beskrivs i den [georeplikering stöds inte för data och loggfiler på separata diskar](#geo-replication-support) avsnitt.</span><span class="sxs-lookup"><span data-stu-id="8442d-117">More information regarding geo-replication limitations are covered in the [Geo-replication not supported for data and log files on separate disks](#geo-replication-support) section.</span></span>

## <a name="hadr-deployment-architectures"></a><span data-ttu-id="8442d-118">HADR distribution arkitekturer</span><span class="sxs-lookup"><span data-stu-id="8442d-118">HADR deployment architectures</span></span>
<span data-ttu-id="8442d-119">SQL Server HADR tekniker som stöds i Azure är:</span><span class="sxs-lookup"><span data-stu-id="8442d-119">SQL Server HADR technologies that are supported in Azure include:</span></span>

* [<span data-ttu-id="8442d-120">Always On-Tillgänglighetsgrupper</span><span class="sxs-lookup"><span data-stu-id="8442d-120">Always On Availability Groups</span></span>](https://technet.microsoft.com/library/hh510230.aspx)
* [<span data-ttu-id="8442d-121">Alltid på instanser för redundanskluster</span><span class="sxs-lookup"><span data-stu-id="8442d-121">Always On Failover Cluster Instances</span></span>](https://technet.microsoft.com/library/ms189134.aspx)
* [<span data-ttu-id="8442d-122">Loggöverföring</span><span class="sxs-lookup"><span data-stu-id="8442d-122">Log Shipping</span></span>](https://technet.microsoft.com/library/ms187103.aspx)
* [<span data-ttu-id="8442d-123">SQL Server-säkerhetskopiering och återställning med Azure Blob Storage-tjänst</span><span class="sxs-lookup"><span data-stu-id="8442d-123">SQL Server Backup and Restore with Azure Blob Storage Service</span></span>](https://msdn.microsoft.com/library/jj919148.aspx)
* <span data-ttu-id="8442d-124">[Databasspegling](https://technet.microsoft.com/library/ms189852.aspx) – inte längre stöds i SQLServer 2016</span><span class="sxs-lookup"><span data-stu-id="8442d-124">[Database Mirroring](https://technet.microsoft.com/library/ms189852.aspx) - Deprecated in SQL Server 2016</span></span>

<span data-ttu-id="8442d-125">Det är möjligt att kombinera tekniker tillsammans för att implementera en lösning för SQL Server som har funktioner för katastrofåterställning och hög tillgänglighet.</span><span class="sxs-lookup"><span data-stu-id="8442d-125">It is possible to combine the technologies together to implement a SQL Server solution that has both high availability and disaster recovery capabilities.</span></span> <span data-ttu-id="8442d-126">Beroende på vilken teknik som du använder, kan en hybriddistribution kräver en VPN-tunnel med virtuella Azure-nätverket.</span><span class="sxs-lookup"><span data-stu-id="8442d-126">Depending on the technology you use, a hybrid deployment may require a VPN tunnel with the Azure virtual network.</span></span> <span data-ttu-id="8442d-127">I avsnitten nedan visar några exempel distributionen arkitekturerna.</span><span class="sxs-lookup"><span data-stu-id="8442d-127">The sections below show you some of the example deployment architectures.</span></span>

## <a name="azure-only-high-availability-solutions"></a><span data-ttu-id="8442d-128">Endast Azure-: lösningar för hög tillgänglighet</span><span class="sxs-lookup"><span data-stu-id="8442d-128">Azure-only: High availability solutions</span></span>

<span data-ttu-id="8442d-129">Du kan ha en lösning för hög tillgänglighet för SQL Server på en databasnivå med alltid på Tillgänglighetsgrupper - kallas Tillgänglighetsgrupper.</span><span class="sxs-lookup"><span data-stu-id="8442d-129">You can have a high availability solution for SQL Server at a database level with Always On Availability Groups - called availability groups.</span></span> <span data-ttu-id="8442d-130">Du kan också skapa en lösning för hög tillgänglighet på en instansnivå med alltid på Redundansklusterinstanser - redundans-instanser.</span><span class="sxs-lookup"><span data-stu-id="8442d-130">You can also create a high availability solution at an instance level with Always On Failover Cluster Instances - failover cluster instances.</span></span> <span data-ttu-id="8442d-131">För ytterligare redundans skapar du redundans på båda nivåerna genom att skapa Tillgänglighetsgrupper på redundans-instanser.</span><span class="sxs-lookup"><span data-stu-id="8442d-131">For additional redundancy, you can create redundancy at both levels by creating availability groups on failover cluster instances.</span></span> 

| <span data-ttu-id="8442d-132">Teknologi</span><span class="sxs-lookup"><span data-stu-id="8442d-132">Technology</span></span> | <span data-ttu-id="8442d-133">Exempel arkitekturer</span><span class="sxs-lookup"><span data-stu-id="8442d-133">Example Architectures</span></span> |
| --- | --- |
| <span data-ttu-id="8442d-134">**Tillgänglighetsgrupper**</span><span class="sxs-lookup"><span data-stu-id="8442d-134">**Availability groups**</span></span> |<span data-ttu-id="8442d-135">Tillgänglighetsrepliker som körs i virtuella Azure-datorer i samma region ger hög tillgänglighet.</span><span class="sxs-lookup"><span data-stu-id="8442d-135">Availability replicas running in Azure VMs in the same region provide high availability.</span></span> <span data-ttu-id="8442d-136">Du måste konfigurera en domänkontrollant VM, eftersom Windows-redundanskluster kräver en Active Directory-domän.</span><span class="sxs-lookup"><span data-stu-id="8442d-136">You need to configure a domain controller VM, because Windows failover clustering requires an Active Directory domain.</span></span><br/> <span data-ttu-id="8442d-137">![Tillgänglighetsgrupper](./media/virtual-machines-windows-sql-high-availability-dr/azure_only_ha_always_on.gif)</span><span class="sxs-lookup"><span data-stu-id="8442d-137">![Availability Groups](./media/virtual-machines-windows-sql-high-availability-dr/azure_only_ha_always_on.gif)</span></span><br/><span data-ttu-id="8442d-138">Mer information finns i [konfigurera Tillgänglighetsgrupper i Azure (GUI)](virtual-machines-windows-portal-sql-alwayson-availability-groups.md).</span><span class="sxs-lookup"><span data-stu-id="8442d-138">For more information, see [Configure Availability Groups in Azure (GUI)](virtual-machines-windows-portal-sql-alwayson-availability-groups.md).</span></span> |
| <span data-ttu-id="8442d-139">**-Instanser för redundanskluster**</span><span class="sxs-lookup"><span data-stu-id="8442d-139">**Failover cluster instances**</span></span> |<span data-ttu-id="8442d-140">Failover Cluster instanser (FCI), som kräver delad lagring, kan skapas på 3 olika sätt.</span><span class="sxs-lookup"><span data-stu-id="8442d-140">Failover Cluster Instances (FCI), which require shared storage, can be created in 3 different ways.</span></span><br/><br/><span data-ttu-id="8442d-141">1. En tvånods-kluster som kör Azure-dator med direktansluten lagring med hjälp av [Windows Server 2016 Storage Spaces Direct \(S2D\) ](virtual-machines-windows-portal-sql-create-failover-cluster.md) att tillhandahålla en programvarubaserad virtuellt SAN-nätverk.</span><span class="sxs-lookup"><span data-stu-id="8442d-141">1. A two-node failover cluster running in Azure VMs with attached storage using [Windows Server 2016 Storage Spaces Direct \(S2D\)](virtual-machines-windows-portal-sql-create-failover-cluster.md) to provide a software-based virtual SAN.</span></span><br/><br/><span data-ttu-id="8442d-142">2. Ett redundanskluster med två noder, körs i virtuella Azure-datorer med lagring som stöds av en tredje parts klusterlösningen.</span><span class="sxs-lookup"><span data-stu-id="8442d-142">2. A two-node failover cluster running in Azure VMs with storage supported by a third-party clustering solution.</span></span> <span data-ttu-id="8442d-143">Ett exempel som använder SIOS DataKeeper, se [hög tillgänglighet för en filresurs med hjälp av redundanskluster och 3 tillverkare SIOS DataKeeper](https://azure.microsoft.com/blog/high-availability-for-a-file-share-using-wsfc-ilb-and-3rd-party-software-sios-datakeeper/).</span><span class="sxs-lookup"><span data-stu-id="8442d-143">For a specific example that uses SIOS DataKeeper, see [High availability for a file share using failover clustering and 3rd party software SIOS DataKeeper](https://azure.microsoft.com/blog/high-availability-for-a-file-share-using-wsfc-ilb-and-3rd-party-software-sios-datakeeper/).</span></span><br/><br/><span data-ttu-id="8442d-144">3. Ett redundanskluster med två noder, körs i virtuella Azure-datorer med fjärr-iSCSI-mål som delad blocklagring via ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="8442d-144">3. A two-node failover cluster running in Azure VMs with remote iSCSI Target shared block storage via ExpressRoute.</span></span> <span data-ttu-id="8442d-145">NetApp privat lagring (NPS) visar till exempel ett iSCSI-mål via ExpressRoute med Equinix till virtuella Azure-datorer.</span><span class="sxs-lookup"><span data-stu-id="8442d-145">For example, NetApp Private Storage (NPS) exposes an iSCSI target via ExpressRoute with Equinix to Azure VMs.</span></span><br/><br/><span data-ttu-id="8442d-146">För tredje parts delad lagring och lösningar för replikering, bör du kontakta leverantören för problem relaterade till åtkomst av data på växling vid fel.</span><span class="sxs-lookup"><span data-stu-id="8442d-146">For third-party shared storage and data replication solutions, you should contact the vendor for any issues related to accessing data on failover.</span></span><br/><br/><span data-ttu-id="8442d-147">Observera att med hjälp av FCI ovanpå [Azure File storage](https://azure.microsoft.com/services/storage/files/) stöds inte ännu, eftersom den här lösningen inte att använda Premium-lagring.</span><span class="sxs-lookup"><span data-stu-id="8442d-147">Note that using FCI on top of [Azure File storage](https://azure.microsoft.com/services/storage/files/) is not supported yet, because this solution does not utilize Premium Storage.</span></span> <span data-ttu-id="8442d-148">Vi arbetar för att stödja detta snart.</span><span class="sxs-lookup"><span data-stu-id="8442d-148">We are working to support this soon.</span></span> |

## <a name="azure-only-disaster-recovery-solutions"></a><span data-ttu-id="8442d-149">Endast Azure-: lösningar för katastrofåterställning</span><span class="sxs-lookup"><span data-stu-id="8442d-149">Azure-only: Disaster recovery solutions</span></span>
<span data-ttu-id="8442d-150">Du kan ha en lösning för katastrofåterställning för SQL Server-databaser i Azure med hjälp av Tillgänglighetsgrupper, databasspegling eller säkerhetskopia och återställa med storage-blobbar.</span><span class="sxs-lookup"><span data-stu-id="8442d-150">You can have a disaster recovery solution for your SQL Server databases in Azure using availability groups, database mirroring, or backup and restore with storage blobs.</span></span>

| <span data-ttu-id="8442d-151">Teknologi</span><span class="sxs-lookup"><span data-stu-id="8442d-151">Technology</span></span> | <span data-ttu-id="8442d-152">Exempel arkitekturer</span><span class="sxs-lookup"><span data-stu-id="8442d-152">Example Architectures</span></span> |
| --- | --- |
| <span data-ttu-id="8442d-153">**Tillgänglighetsgrupper**</span><span class="sxs-lookup"><span data-stu-id="8442d-153">**Availability Groups**</span></span> |<span data-ttu-id="8442d-154">Tillgänglighetsrepliker som körs i flera datacenter i virtuella Azure-datorer för katastrofåterställning.</span><span class="sxs-lookup"><span data-stu-id="8442d-154">Availability replicas running across multiple datacenters in Azure VMs for disaster recovery.</span></span> <span data-ttu-id="8442d-155">Den här lösningen mellan region skyddar mot fullständig webbplats avbrott.</span><span class="sxs-lookup"><span data-stu-id="8442d-155">This cross-region solution protects against complete site outage.</span></span> <br/> <span data-ttu-id="8442d-156">![Tillgänglighetsgrupper](./media/virtual-machines-windows-sql-high-availability-dr/azure_only_dr_alwayson.png)</span><span class="sxs-lookup"><span data-stu-id="8442d-156">![Availability Groups](./media/virtual-machines-windows-sql-high-availability-dr/azure_only_dr_alwayson.png)</span></span><br/><span data-ttu-id="8442d-157">Alla repliker ska vara i samma molntjänst och samma virtuella nätverk i en region.</span><span class="sxs-lookup"><span data-stu-id="8442d-157">Within a region, all replicas should be within the same cloud service and the same VNet.</span></span> <span data-ttu-id="8442d-158">Eftersom varje region har ett separat virtuellt nätverk, kräver dessa lösningar VNet till VNet-anslutning.</span><span class="sxs-lookup"><span data-stu-id="8442d-158">Because each region will have a separate VNet, these solutions require VNet to VNet connectivity.</span></span> <span data-ttu-id="8442d-159">Mer information finns i [konfigurerar du en VNet-till-VNet-anslutning med hjälp av Azure portal](../../../vpn-gateway/vpn-gateway-howto-vnet-vnet-resource-manager-portal.md).</span><span class="sxs-lookup"><span data-stu-id="8442d-159">For more information, see [Configure a VNet-to-VNet connection using the Azure portal](../../../vpn-gateway/vpn-gateway-howto-vnet-vnet-resource-manager-portal.md).</span></span> <span data-ttu-id="8442d-160">Detaljerade instruktioner finns [och konfigurera en SQL Server-tillgänglighetsgrupp på Azure-datorer i olika regioner](virtual-machines-windows-portal-sql-availability-group-dr.md).</span><span class="sxs-lookup"><span data-stu-id="8442d-160">For detailed instructions, see [Configure a SQL Server Availability Group on Azure Virtual Machines in Different Regions](virtual-machines-windows-portal-sql-availability-group-dr.md).</span></span>|
| <span data-ttu-id="8442d-161">**Databasspegling**</span><span class="sxs-lookup"><span data-stu-id="8442d-161">**Database Mirroring**</span></span> |<span data-ttu-id="8442d-162">Huvudnamn och spegling och servrar som körs i olika Datacenter för katastrofåterställning.</span><span class="sxs-lookup"><span data-stu-id="8442d-162">Principal and mirror and servers running in different datacenters for disaster recovery.</span></span> <span data-ttu-id="8442d-163">Du måste distribuera med servercertifikat eftersom en active directory-domän kan sträcka sig över flera datacenter.</span><span class="sxs-lookup"><span data-stu-id="8442d-163">You must deploy using server certificates because an active directory domain cannot span multiple datacenters.</span></span><br/>![Databasspegling](./media/virtual-machines-windows-sql-high-availability-dr/azure_only_dr_dbmirroring.gif) |
| <span data-ttu-id="8442d-165">**Säkerhetskopiering och återställning med Azure Blob Storage-tjänst**</span><span class="sxs-lookup"><span data-stu-id="8442d-165">**Backup and Restore with Azure Blob Storage Service**</span></span> |<span data-ttu-id="8442d-166">Produktionsdatabaserna som säkerhetskopierats direkt till blob storage i olika datacenter för katastrofåterställning.</span><span class="sxs-lookup"><span data-stu-id="8442d-166">Production databases backed up directly to blob storage in a different datacenter for disaster recovery.</span></span><br/><span data-ttu-id="8442d-167">![Säkerhetskopiering och återställning](./media/virtual-machines-windows-sql-high-availability-dr/azure_only_dr_backup_restore.gif)</span><span class="sxs-lookup"><span data-stu-id="8442d-167">![Backup and Restore](./media/virtual-machines-windows-sql-high-availability-dr/azure_only_dr_backup_restore.gif)</span></span><br/><span data-ttu-id="8442d-168">Mer information finns i [säkerhetskopiering och återställning av SQL Server i Azure Virtual Machines](virtual-machines-windows-sql-backup-recovery.md).</span><span class="sxs-lookup"><span data-stu-id="8442d-168">For more information, see [Backup and Restore for SQL Server in Azure Virtual Machines](virtual-machines-windows-sql-backup-recovery.md).</span></span> |

## <a name="hybrid-it-disaster-recovery-solutions"></a><span data-ttu-id="8442d-169">Hybrid-IT: Lösningar för katastrofåterställning</span><span class="sxs-lookup"><span data-stu-id="8442d-169">Hybrid IT: Disaster recovery solutions</span></span>
<span data-ttu-id="8442d-170">Du kan ha en lösning för katastrofåterställning för SQL Server-databaser i en hybrid-IT-miljö med hjälp av Tillgänglighetsgrupper, databasspegling, loggöverföring och säkerhetskopiering och återställning med Azure blogg lagring.</span><span class="sxs-lookup"><span data-stu-id="8442d-170">You can have a disaster recovery solution for your SQL Server databases in a hybrid-IT environment using availability groups, database mirroring, log shipping, and backup and restore with Azure blog storage.</span></span>

| <span data-ttu-id="8442d-171">Teknologi</span><span class="sxs-lookup"><span data-stu-id="8442d-171">Technology</span></span> | <span data-ttu-id="8442d-172">Exempel arkitekturer</span><span class="sxs-lookup"><span data-stu-id="8442d-172">Example Architectures</span></span> |
| --- | --- |
| <span data-ttu-id="8442d-173">**Tillgänglighetsgrupper**</span><span class="sxs-lookup"><span data-stu-id="8442d-173">**Availability Groups**</span></span> |<span data-ttu-id="8442d-174">Vissa tillgänglighetsrepliker som körs i virtuella Azure-datorer och andra repliker som körs lokalt för katastrofåterställning för webbplatser.</span><span class="sxs-lookup"><span data-stu-id="8442d-174">Some availability replicas running in Azure VMs and other replicas running on-premises for cross-site disaster recovery.</span></span> <span data-ttu-id="8442d-175">Produktionsplatsen kan vara antingen lokalt eller i ett Azure-datacenter.</span><span class="sxs-lookup"><span data-stu-id="8442d-175">The production site can be either on-premises or in an Azure datacenter.</span></span><br/>![Tillgänglighetsgrupper](./media/virtual-machines-windows-sql-high-availability-dr/hybrid_dr_alwayson.gif)<br/><span data-ttu-id="8442d-177">Eftersom alla tillgänglighetsrepliker måste vara i samma kluster för växling vid fel måste i klustret omfatta båda nätverken (ett flera undernät failover-kluster).</span><span class="sxs-lookup"><span data-stu-id="8442d-177">Because all availability replicas must be in the same failover cluster, the cluster must span both networks (a multi-subnet failover cluster).</span></span> <span data-ttu-id="8442d-178">Den här konfigurationen kräver en VPN-anslutning mellan Azure och det lokala nätverket.</span><span class="sxs-lookup"><span data-stu-id="8442d-178">This configuration requires a VPN connection between Azure and the on-premises network.</span></span><br/><br/><span data-ttu-id="8442d-179">För lyckad katastrofåterställning för dina databaser, bör du också installera en replika-domänkontroller på disaster recovery-plats.</span><span class="sxs-lookup"><span data-stu-id="8442d-179">For successful disaster recovery of your databases, you should also install a replica domain controller at the disaster recovery site.</span></span><br/><br/><span data-ttu-id="8442d-180">Det är möjligt att använda guiden Lägg till replik i SSMS att lägga till en Azure replik till en befintlig alltid på tillgänglighetsgrupp.</span><span class="sxs-lookup"><span data-stu-id="8442d-180">It is possible to use the Add Replica Wizard in SSMS to add an Azure replica to an existing Always On Availability Group.</span></span> <span data-ttu-id="8442d-181">Mer information finns i självstudiekursen: utöka alltid på Tillgänglighetsgruppen till Azure.</span><span class="sxs-lookup"><span data-stu-id="8442d-181">For more information, see Tutorial: Extend your Always On Availability Group to Azure.</span></span> |
| <span data-ttu-id="8442d-182">**Databasspegling**</span><span class="sxs-lookup"><span data-stu-id="8442d-182">**Database Mirroring**</span></span> |<span data-ttu-id="8442d-183">En partner som körs i en virtuell dator i Azure och den andra körs lokalt för katastrofåterställning för webbplatser som använder servercertifikat.</span><span class="sxs-lookup"><span data-stu-id="8442d-183">One partner running in an Azure VM and the other running on-premises for cross-site disaster recovery using server certificates.</span></span> <span data-ttu-id="8442d-184">Partners behöver inte finnas i samma Active Directory-domän och någon VPN-anslutning krävs.</span><span class="sxs-lookup"><span data-stu-id="8442d-184">Partners do not need to be in the same Active Directory domain, and no VPN connection is required.</span></span><br/><span data-ttu-id="8442d-185">![Databasspegling](./media/virtual-machines-windows-sql-high-availability-dr/hybrid_dr_dbmirroring.gif)</span><span class="sxs-lookup"><span data-stu-id="8442d-185">![Database Mirroring](./media/virtual-machines-windows-sql-high-availability-dr/hybrid_dr_dbmirroring.gif)</span></span><br/><span data-ttu-id="8442d-186">Ett annat scenario för databasspegling innebär en partner som körs i en virtuell dator i Azure och den andra körs lokalt i samma Active Directory-domän för katastrofåterställning för webbplatser.</span><span class="sxs-lookup"><span data-stu-id="8442d-186">Another database mirroring scenario involves one partner running in an Azure VM and the other running on-premises in the same Active Directory domain for cross-site disaster recovery.</span></span> <span data-ttu-id="8442d-187">En [VPN-anslutning mellan Azure-nätverket och det lokala nätverket](../../../vpn-gateway/vpn-gateway-site-to-site-create.md) krävs.</span><span class="sxs-lookup"><span data-stu-id="8442d-187">A [VPN connection between the Azure virtual network and the on-premises network](../../../vpn-gateway/vpn-gateway-site-to-site-create.md) is required.</span></span><br/><br/><span data-ttu-id="8442d-188">För lyckad katastrofåterställning för dina databaser, bör du också installera en replika-domänkontroller på disaster recovery-plats.</span><span class="sxs-lookup"><span data-stu-id="8442d-188">For successful disaster recovery of your databases, you should also install a replica domain controller at the disaster recovery site.</span></span> |
| <span data-ttu-id="8442d-189">**Loggöverföring**</span><span class="sxs-lookup"><span data-stu-id="8442d-189">**Log Shipping**</span></span> |<span data-ttu-id="8442d-190">En server som körs i en virtuell dator i Azure och den andra körs lokalt för katastrofåterställning för webbplatser.</span><span class="sxs-lookup"><span data-stu-id="8442d-190">One server running in an Azure VM and the other running on-premises for cross-site disaster recovery.</span></span> <span data-ttu-id="8442d-191">Loggöverföring beror på Windows fildelning, så krävs en VPN-anslutning mellan Azure-nätverket och det lokala nätverket.</span><span class="sxs-lookup"><span data-stu-id="8442d-191">Log shipping depends on Windows file sharing, so a VPN connection between the Azure virtual network and the on-premises network is required.</span></span><br/>![Loggöverföring](./media/virtual-machines-windows-sql-high-availability-dr/hybrid_dr_log_shipping.gif)<br/><span data-ttu-id="8442d-193">För lyckad katastrofåterställning för dina databaser, bör du också installera en replika-domänkontroller på disaster recovery-plats.</span><span class="sxs-lookup"><span data-stu-id="8442d-193">For successful disaster recovery of your databases, you should also install a replica domain controller at the disaster recovery site.</span></span> |
| <span data-ttu-id="8442d-194">**Säkerhetskopiering och återställning med Azure Blob Storage-tjänst**</span><span class="sxs-lookup"><span data-stu-id="8442d-194">**Backup and Restore with Azure Blob Storage Service**</span></span> |<span data-ttu-id="8442d-195">Lokalt produktionsdatabaserna säkerhetskopieras direkt till Azure blob storage för katastrofåterställning.</span><span class="sxs-lookup"><span data-stu-id="8442d-195">On-premises production databases backed up directly to Azure blob storage for disaster recovery.</span></span><br/><span data-ttu-id="8442d-196">![Säkerhetskopiering och återställning](./media/virtual-machines-windows-sql-high-availability-dr/hybrid_dr_backup_restore.gif)</span><span class="sxs-lookup"><span data-stu-id="8442d-196">![Backup and Restore](./media/virtual-machines-windows-sql-high-availability-dr/hybrid_dr_backup_restore.gif)</span></span><br/><span data-ttu-id="8442d-197">Mer information finns i [säkerhetskopiering och återställning av SQL Server i Azure Virtual Machines](virtual-machines-windows-sql-backup-recovery.md).</span><span class="sxs-lookup"><span data-stu-id="8442d-197">For more information, see [Backup and Restore for SQL Server in Azure Virtual Machines](virtual-machines-windows-sql-backup-recovery.md).</span></span> |

## <a name="important-considerations-for-sql-server-hadr-in-azure"></a><span data-ttu-id="8442d-198">Viktiga överväganden för SQL Server HADR i Azure</span><span class="sxs-lookup"><span data-stu-id="8442d-198">Important considerations for SQL Server HADR in Azure</span></span>
<span data-ttu-id="8442d-199">Azure virtuella datorer, lagring och nätverk har olika operativa egenskaper än en lokal, icke-virtualiserade IT-infrastruktur.</span><span class="sxs-lookup"><span data-stu-id="8442d-199">Azure VMs, storage, and networking have different operational characteristics than an on-premises, non-virtualized IT infrastructure.</span></span> <span data-ttu-id="8442d-200">En lyckad implementering av en HADR SQL Server-lösning i Azure måste du förstå dessa skillnader och utforma din lösning anpassas till dem..</span><span class="sxs-lookup"><span data-stu-id="8442d-200">A successful implementation of a HADR SQL Server solution in Azure requires that you understand these differences and design your solution to accommodate them.</span></span>

### <a name="high-availability-nodes-in-an-availability-set"></a><span data-ttu-id="8442d-201">Hög tillgänglighet noder i en tillgänglighetsuppsättning</span><span class="sxs-lookup"><span data-stu-id="8442d-201">High availability nodes in an availability set</span></span>
<span data-ttu-id="8442d-202">Tillgänglighetsuppsättningar i Azure kan du placera noder för hög tillgänglighet i separata Feldomäner (FDs) och uppdatera domäner (UDs).</span><span class="sxs-lookup"><span data-stu-id="8442d-202">Availability sets in Azure enable you to place the high availability nodes into separate Fault Domains (FDs) and Update Domains (UDs).</span></span> <span data-ttu-id="8442d-203">Du måste distribuera dem i samma molntjänst för virtuella Azure-datorer ska placeras i samma tillgänglighetsuppsättning.</span><span class="sxs-lookup"><span data-stu-id="8442d-203">For Azure VMs to be placed in the same availability set, you must deploy them in the same cloud service.</span></span> <span data-ttu-id="8442d-204">Endast noder i samma molntjänst kan delta i samma tillgänglighetsuppsättning.</span><span class="sxs-lookup"><span data-stu-id="8442d-204">Only nodes in the same cloud service can participate in the same availability set.</span></span> <span data-ttu-id="8442d-205">Mer information finns i [Hantera tillgängligheten för Virtual Machines](../manage-availability.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).</span><span class="sxs-lookup"><span data-stu-id="8442d-205">For more information, see [Manage the Availability of Virtual Machines](../manage-availability.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).</span></span>

### <a name="failover-cluster-behavior-in-azure-networking"></a><span data-ttu-id="8442d-206">Failover cluster beteende i Azure-nätverk</span><span class="sxs-lookup"><span data-stu-id="8442d-206">Failover cluster behavior in Azure networking</span></span>
<span data-ttu-id="8442d-207">Icke-RFC-kompatibel DHCP-tjänsten i Azure kan orsaka att skapa vissa redundans klusterkonfigurationer misslyckas på grund av klustrets nätverksnamn tilldelas en duplicerad IP-adress som samma IP-adressen som en av klusternoderna.</span><span class="sxs-lookup"><span data-stu-id="8442d-207">The non-RFC-compliant DHCP service in Azure can cause the creation of certain failover cluster configurations to fail, due to the cluster network name being assigned a duplicate IP address, such as the same IP address as one of the cluster nodes.</span></span> <span data-ttu-id="8442d-208">Detta är ett problem när du implementerar Tillgänglighetsgrupper, som beror på funktionen Windows kluster för växling vid fel.</span><span class="sxs-lookup"><span data-stu-id="8442d-208">This is an issue when you implement Availability Groups, which depends on the Windows failover cluster feature.</span></span>

<span data-ttu-id="8442d-209">Föreställ dig när ett tvånods kluster skapas och tas online:</span><span class="sxs-lookup"><span data-stu-id="8442d-209">Consider the scenario when a two-node cluster is created and brought online:</span></span>

1. <span data-ttu-id="8442d-210">Klustret är online och sedan Nod1 begär en dynamiskt tilldelad IP-adress för klustrets nätverksnamn.</span><span class="sxs-lookup"><span data-stu-id="8442d-210">The cluster comes online, then NODE1 requests a dynamically assigned IP address for the cluster network name.</span></span>
2. <span data-ttu-id="8442d-211">Ingen IP-adress än Nod1 's egna IP-adress ges av DHCP-tjänsten, eftersom DHCP-tjänsten känner av att begäran kommer från Nod1 sig själv.</span><span class="sxs-lookup"><span data-stu-id="8442d-211">No IP address other than NODE1’s own IP address is given by the DHCP service, since the DHCP service recognizes that the request comes from NODE1 itself.</span></span>
3. <span data-ttu-id="8442d-212">Windows upptäcker att en dubblett-adress har tilldelats både Nod1 och Klusternätverksnamnet för växling vid fel och klustergrupp standard inte anslutas.</span><span class="sxs-lookup"><span data-stu-id="8442d-212">Windows detects that a duplicate address is assigned both to NODE1 and to the failover cluster network name, and the default cluster group fails to come online.</span></span>
4. <span data-ttu-id="8442d-213">Standard-klustergrupp flyttar till nod2, behandlas Nod1 's IP-adress som IP-adress för klustret och tar klustret standardgruppen online.</span><span class="sxs-lookup"><span data-stu-id="8442d-213">The default cluster group moves to NODE2, which treats NODE1’s IP address as the cluster IP address and brings the default cluster group online.</span></span>
5. <span data-ttu-id="8442d-214">När nod2 försöker upprätta en anslutning med Nod1, lämna paket riktat mot Nod1 aldrig nod2 eftersom det löser Nod1 's IP-adress till sig själv.</span><span class="sxs-lookup"><span data-stu-id="8442d-214">When NODE2 attempts to establish connectivity with NODE1, packets directed at NODE1 never leave NODE2 because it resolves NODE1’s IP address to itself.</span></span> <span data-ttu-id="8442d-215">Nod 2 kan inte upprätta en anslutning med Nod1 sedan förlorar kvorum och stängs av klustret.</span><span class="sxs-lookup"><span data-stu-id="8442d-215">NODE2 cannot establish connectivity with NODE1, then loses quorum and shuts down the cluster.</span></span>
6. <span data-ttu-id="8442d-216">Under tiden Nod1 kan skicka paket till nod2, men nod2 kan inte svara.</span><span class="sxs-lookup"><span data-stu-id="8442d-216">In the meantime, NODE1 can send packets to NODE2, but NODE2 cannot reply.</span></span> <span data-ttu-id="8442d-217">Nod1 förlorar kvorum och stängs av klustret.</span><span class="sxs-lookup"><span data-stu-id="8442d-217">NODE1 loses quorum and shuts down the cluster.</span></span>

<span data-ttu-id="8442d-218">Det här scenariot kan undvikas genom att tilldela en oanvända statiska IP-adress, till exempel en länklokal IP-adress som 169.254.1.1, klustrets nätverksnamn för att hämta klustrets nätverksnamn online.</span><span class="sxs-lookup"><span data-stu-id="8442d-218">This scenario can be avoided by assigning an unused static IP address, such as a link-local IP address like 169.254.1.1, to the cluster network name in order to bring the cluster network name online.</span></span> <span data-ttu-id="8442d-219">För att förenkla den här processen, se [konfigurera Windows-redundanskluster i Azure för Tillgänglighetsgrupper](http://social.technet.microsoft.com/wiki/contents/articles/14776.configuring-windows-failover-cluster-in-windows-azure-for-alwayson-availability-groups.aspx).</span><span class="sxs-lookup"><span data-stu-id="8442d-219">To simplify this process, see [Configuring Windows failover cluster in Azure for availability groups](http://social.technet.microsoft.com/wiki/contents/articles/14776.configuring-windows-failover-cluster-in-windows-azure-for-alwayson-availability-groups.aspx).</span></span>

<span data-ttu-id="8442d-220">Mer information finns i [och konfigurera Tillgänglighetsgrupper i Azure (GUI)](virtual-machines-windows-portal-sql-alwayson-availability-groups.md).</span><span class="sxs-lookup"><span data-stu-id="8442d-220">For more information, see [Configure availability groups in Azure (GUI)](virtual-machines-windows-portal-sql-alwayson-availability-groups.md).</span></span>

### <a name="availability-group-listener-support"></a><span data-ttu-id="8442d-221">Stöd för tillgänglighet lyssnare</span><span class="sxs-lookup"><span data-stu-id="8442d-221">Availability group listener support</span></span>
<span data-ttu-id="8442d-222">Tillgänglighet tillgänglighetsgruppslyssnarnas stöds på Azure virtuella datorer som kör Windows Server 2008 R2, Windows Server 2012, Windows Server 2012 R2 och Windows Server 2016.</span><span class="sxs-lookup"><span data-stu-id="8442d-222">Availability group listeners are supported on Azure VMs running Windows Server 2008 R2, Windows Server 2012, Windows Server 2012 R2, and Windows Server 2016.</span></span> <span data-ttu-id="8442d-223">Detta stöd är möjligt med hjälp av belastningsutjämnade slutpunkter aktiverat på den virtuella Azure-datorer som är tillgänglighet gruppnoder.</span><span class="sxs-lookup"><span data-stu-id="8442d-223">This support is made possible by the use of load-balanced endpoints enabled on the Azure VMs that are availability group nodes.</span></span> <span data-ttu-id="8442d-224">Du måste följa särskilda konfigurationssteg för lyssnare ska fungera för båda klientprogram som körs i Azure som körs lokalt.</span><span class="sxs-lookup"><span data-stu-id="8442d-224">You must follow special configuration steps for the listeners to work for both client applications that are running in Azure as well as those running on-premises.</span></span>

<span data-ttu-id="8442d-225">Det finns två huvudsakliga alternativ för att konfigurera din lyssnare: externa (offentliga) eller intern.</span><span class="sxs-lookup"><span data-stu-id="8442d-225">There are two main options for setting up your listener: external (public) or internal.</span></span> <span data-ttu-id="8442d-226">Externa (offentliga) lyssnaren använder en internetuppkopplad belastningsutjämnare och associeras med en public Virtual IP (VIP) som är tillgänglig via internet.</span><span class="sxs-lookup"><span data-stu-id="8442d-226">The external (public) listener uses an internet facing load balancer and is associated with a public Virtual IP (VIP) that is accessible over the internet.</span></span> <span data-ttu-id="8442d-227">En intern lyssnare använder en intern belastningsutjämnare och har endast stöd för klienter i samma virtuella nätverk.</span><span class="sxs-lookup"><span data-stu-id="8442d-227">An internal listener uses an internal load balancer and only supports clients within the same Virtual Network.</span></span> <span data-ttu-id="8442d-228">För att läsa in typen belastningsutjämnare, måste du aktivera direkt Serverreturnering.</span><span class="sxs-lookup"><span data-stu-id="8442d-228">For either load balancer type, you must enable Direct Server Return.</span></span> 

<span data-ttu-id="8442d-229">Om Tillgänglighetsgruppen sträcker sig över flera Azure-undernät (till exempel en distribution som passerar Azure-regioner), klient-anslutningssträngen måste innehålla ”**MultisubnetFailover = True**”.</span><span class="sxs-lookup"><span data-stu-id="8442d-229">If the Availability Group spans multiple Azure subnets (such as a deployment that crosses Azure regions), the client connection string must include "**MultisubnetFailover=True**".</span></span> <span data-ttu-id="8442d-230">Detta resulterar i parallella anslutningsförsök till replikerna i olika undernät.</span><span class="sxs-lookup"><span data-stu-id="8442d-230">This results in parallel connection attempts to the replicas in the different subnets.</span></span> <span data-ttu-id="8442d-231">Anvisningar om hur du skapar en lyssnare finns</span><span class="sxs-lookup"><span data-stu-id="8442d-231">For instructions on setting up a listener, see</span></span>

* <span data-ttu-id="8442d-232">[Konfigurera en ILB-lyssnare för Tillgänglighetsgrupper i Azure](virtual-machines-windows-portal-sql-ps-alwayson-int-listener.md).</span><span class="sxs-lookup"><span data-stu-id="8442d-232">[Configure an ILB listener for availability groups in Azure](virtual-machines-windows-portal-sql-ps-alwayson-int-listener.md).</span></span>
* <span data-ttu-id="8442d-233">[Konfigurera en extern lyssnare för Tillgänglighetsgrupper i Azure](../classic/ps-sql-ext-listener.md).</span><span class="sxs-lookup"><span data-stu-id="8442d-233">[Configure an external listener for availability groups in Azure](../classic/ps-sql-ext-listener.md).</span></span>

<span data-ttu-id="8442d-234">Du kan fortfarande ansluta till varje tillgänglighetsreplik separat för genom att ansluta direkt till tjänstinstansen.</span><span class="sxs-lookup"><span data-stu-id="8442d-234">You can still connect to each availability replica separately by connecting directly to the service instance.</span></span> <span data-ttu-id="8442d-235">Dessutom eftersom Tillgänglighetsgrupper är bakåtkompatibel med klienter för databasspegling, kan du ansluta till tillgänglighetsrepliker som databasspegling partners så länge replikerna konfigureras liknar databasspegling:</span><span class="sxs-lookup"><span data-stu-id="8442d-235">Also, since availability groups are backward compatible with database mirroring clients, you can connect to the availability replicas like database mirroring partners as long as the replicas are configured similar to database mirroring:</span></span>

* <span data-ttu-id="8442d-236">En primär replik och en sekundär replik</span><span class="sxs-lookup"><span data-stu-id="8442d-236">One primary replica and one secondary replica</span></span>
* <span data-ttu-id="8442d-237">Den sekundära repliken är konfigurerad som inte kan läsas (**läsbara sekundära** alternativet **nr**)</span><span class="sxs-lookup"><span data-stu-id="8442d-237">The secondary replica is configured as non-readable (**Readable Secondary** option set to **No**)</span></span>

<span data-ttu-id="8442d-238">Ett exempel klient-anslutningssträngen som motsvarar den här databasen spegling liknande konfigurationen med hjälp av ADO.NET eller SQL Server Native Client är nedan:</span><span class="sxs-lookup"><span data-stu-id="8442d-238">An example client connection string that corresponds to this database mirroring-like configuration using ADO.NET or SQL Server Native Client is below:</span></span>

    Data Source=ReplicaServer1;Failover Partner=ReplicaServer2;Initial Catalog=AvailabilityDatabase;

<span data-ttu-id="8442d-239">Mer information om klientanslutning finns:</span><span class="sxs-lookup"><span data-stu-id="8442d-239">For more information on client connectivity, see:</span></span>

* [<span data-ttu-id="8442d-240">Nyckelord för anslutningssträngar med SQL Server Native Client</span><span class="sxs-lookup"><span data-stu-id="8442d-240">Using Connection String Keywords with SQL Server Native Client</span></span>](https://msdn.microsoft.com/library/ms130822.aspx)
* [<span data-ttu-id="8442d-241">Ansluta klienter till en Databasspeglingssession (SQLServer)</span><span class="sxs-lookup"><span data-stu-id="8442d-241">Connect Clients to a Database Mirroring Session (SQL Server)</span></span>](https://technet.microsoft.com/library/ms175484.aspx)
* [<span data-ttu-id="8442d-242">Ansluter till Availability Group Listener i Hybrid IT</span><span class="sxs-lookup"><span data-stu-id="8442d-242">Connecting to Availability Group Listener in Hybrid IT</span></span>](http://blogs.msdn.com/b/sqlalwayson/archive/2013/02/14/connecting-to-availability-group-listener-in-hybrid-it.aspx)
* [<span data-ttu-id="8442d-243">Tillgänglighetsgruppens lyssnare och klientanslutning programmet växling vid fel (SQLServer)</span><span class="sxs-lookup"><span data-stu-id="8442d-243">Availability Group Listeners, Client Connectivity, and Application Failover (SQL Server)</span></span>](https://technet.microsoft.com/library/hh213417.aspx)
* [<span data-ttu-id="8442d-244">Använda databasspegling anslutningssträngar med Tillgänglighetsgrupper</span><span class="sxs-lookup"><span data-stu-id="8442d-244">Using Database-Mirroring Connection Strings with Availability Groups</span></span>](https://technet.microsoft.com/library/hh213417.aspx)

### <a name="network-latency-in-hybrid-it"></a><span data-ttu-id="8442d-245">Nätverksfördröjningen i hybrid IT</span><span class="sxs-lookup"><span data-stu-id="8442d-245">Network latency in hybrid IT</span></span>
<span data-ttu-id="8442d-246">Du ska distribuera lösningen HADR med antagandet att det kan finnas perioder med hög Nätverksfördröjningen mellan ditt lokala nätverk och Azure.</span><span class="sxs-lookup"><span data-stu-id="8442d-246">You should deploy your HADR solution with the assumption that there may be periods of time with high network latency between your on-premises network and Azure.</span></span> <span data-ttu-id="8442d-247">När du distribuerar repliker till Azure, bör du använda asynkront genomförande i stället för synkront genomförande för Synkroniseringsläge.</span><span class="sxs-lookup"><span data-stu-id="8442d-247">When deploying replicas to Azure, you should use asynchronous commit instead of synchronous commit for the synchronization mode.</span></span> <span data-ttu-id="8442d-248">När distribuera servrar för databasspegling både lokalt och i Azure, använder du högpresterande läget i stället för läget för hög säkerhet.</span><span class="sxs-lookup"><span data-stu-id="8442d-248">When deploying database mirroring servers both on-premises and in Azure, use the high-performance mode instead of the high-safety mode.</span></span>

### <a name="geo-replication-support"></a><span data-ttu-id="8442d-249">Stöd för GEO-replikering</span><span class="sxs-lookup"><span data-stu-id="8442d-249">Geo-replication support</span></span>
<span data-ttu-id="8442d-250">GEO-replikering i Azure-diskar som stöder inte datafilen och loggfilen av samma databas som ska lagras på separata diskar.</span><span class="sxs-lookup"><span data-stu-id="8442d-250">Geo-replication in Azure disks does not support the data file and log file of the same database to be stored on separate disks.</span></span> <span data-ttu-id="8442d-251">GRS replikeras ändringar på varje disk oberoende av varandra och asynkront.</span><span class="sxs-lookup"><span data-stu-id="8442d-251">GRS replicates changes on each disk independently and asynchronously.</span></span> <span data-ttu-id="8442d-252">Den här mekanismen garanterar att skriva ordning inom en enskild disk på Kopiera georeplikerad, men inte över geo-replikerade kopior av flera diskar.</span><span class="sxs-lookup"><span data-stu-id="8442d-252">This mechanism guarantees the write order within a single disk on the geo-replicated copy, but not across geo-replicated copies of multiple disks.</span></span> <span data-ttu-id="8442d-253">Om du konfigurerar en databas för att lagra dess datafilen och loggfilen på separata diskar kan återställda diskar efter en katastrof innehålla en uppdaterad kopia av filen än loggfilen som bryter write-ahead loggen i SQL Server och transa ACID-egenskaper ctions.</span><span class="sxs-lookup"><span data-stu-id="8442d-253">If you configure a database to store its data file and its log file on separate disks, the recovered disks after a disaster may contain a more up-to-date copy of the data file than the log file, which breaks the write-ahead log in SQL Server and the ACID properties of transactions.</span></span> <span data-ttu-id="8442d-254">Om du inte har alternativet att inaktivera geo-replikering för storage-konto bör du behålla alla data och loggfilen filer för en viss databas på samma disk.</span><span class="sxs-lookup"><span data-stu-id="8442d-254">If you do not have the option to disable geo-replication on the storage account, you should keep all data and log files for a given database on the same disk.</span></span> <span data-ttu-id="8442d-255">Om du måste använda mer än en disk på grund av storleken på databasen, måste du distribuera en katastrofåterställning ovan för att dataredundans.</span><span class="sxs-lookup"><span data-stu-id="8442d-255">If you must use more than one disk due to the size of the database, you need to deploy one of the disaster recovery solutions listed above to ensure data redundancy.</span></span>

## <a name="next-steps"></a><span data-ttu-id="8442d-256">Nästa steg</span><span class="sxs-lookup"><span data-stu-id="8442d-256">Next steps</span></span>
<span data-ttu-id="8442d-257">Om du behöver skapa en virtuell Azure-dator med SQL Server finns [etablering av en SQL Server-dator på Azure](virtual-machines-windows-portal-sql-server-provision.md).</span><span class="sxs-lookup"><span data-stu-id="8442d-257">If you need to create an Azure virtual machine with SQL Server, see [Provisioning a SQL Server Virtual Machine on Azure](virtual-machines-windows-portal-sql-server-provision.md).</span></span>

<span data-ttu-id="8442d-258">För att få bästa möjliga prestanda från SQL Server körs på en virtuell dator i Azure finns i [prestandarelaterade Metodtips för SQL Server i Azure Virtual Machines](virtual-machines-windows-sql-performance.md).</span><span class="sxs-lookup"><span data-stu-id="8442d-258">To get the best performance from SQL Server running on an Azure VM, see the guidance in [Performance Best Practices for SQL Server in Azure Virtual Machines](virtual-machines-windows-sql-performance.md).</span></span>

<span data-ttu-id="8442d-259">Andra avsnitt relaterade till SQL Server som körs i virtuella Azure-datorer, se [SQL Server på Azure Virtual Machines](virtual-machines-windows-sql-server-iaas-overview.md).</span><span class="sxs-lookup"><span data-stu-id="8442d-259">For other topics related to running SQL Server in Azure VMs, see [SQL Server on Azure Virtual Machines](virtual-machines-windows-sql-server-iaas-overview.md).</span></span>

### <a name="other-resources"></a><span data-ttu-id="8442d-260">Andra resurser</span><span class="sxs-lookup"><span data-stu-id="8442d-260">Other resources</span></span>
* [<span data-ttu-id="8442d-261">Installera en ny Active Directory-skog i Azure</span><span class="sxs-lookup"><span data-stu-id="8442d-261">Install a new Active Directory forest in Azure</span></span>](../../../active-directory/active-directory-new-forest-virtual-machine.md)
* [<span data-ttu-id="8442d-262">Skapa Failover-kluster för Tillgänglighetsgrupper i Azure VM</span><span class="sxs-lookup"><span data-stu-id="8442d-262">Create Failover Cluster for availability groups in Azure VM</span></span>](http://gallery.technet.microsoft.com/scriptcenter/Create-WSFC-Cluster-for-7c207d3a)

