---
title: "aaaSQL servertillgänglighet grupper - virtuella datorer i Azure - förutsättningar för | Microsoft Docs"
description: "Den här kursen visar hur tooconfigure hello förutsättningar för att skapa en SQL Server alltid aktiverad tillgänglighet gruppen på Azure Virtual Machines."
services: virtual-machines
documentationCenter: na
authors: MikeRayMSFT
manager: jhubbard
editor: monicar
tags: azure-service-management
ms.assetid: c492db4c-3faa-4645-849f-5a1a663be55a
ms.service: virtual-machines-sql
ms.devlang: na
ms.custom: na
ms.topic: article
ms.tgt_pltfrm: vm-windows-sql-server
ms.workload: iaas-sql-server
ms.date: 05/09/2017
ms.author: mikeray
ms.openlocfilehash: eed0729ead25c7793bb17a04cd7fd996c7dc8c9d
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 10/06/2017
---
# <a name="complete-hello-prerequisites-for-creating-always-on-availability-groups-on-azure-virtual-machines"></a><span data-ttu-id="e1703-103">Slutföra hello förutsättningar för att skapa Always On-Tillgänglighetsgrupper på Azure virtual machines</span><span class="sxs-lookup"><span data-stu-id="e1703-103">Complete hello prerequisites for creating Always On availability groups on Azure virtual machines</span></span>

<span data-ttu-id="e1703-104">Den här kursen visar hur toocomplete hello förutsättningar för att skapa en [SQL Server Always On-tillgänglighetsgruppen på virtuella Azure-datorer (VM)](virtual-machines-windows-portal-sql-availability-group-tutorial.md).</span><span class="sxs-lookup"><span data-stu-id="e1703-104">This tutorial shows how toocomplete hello prerequisites for creating a [SQL Server Always On availability group on Azure virtual machines (VMs)](virtual-machines-windows-portal-sql-availability-group-tutorial.md).</span></span> <span data-ttu-id="e1703-105">När du är klar hello krav har en domänkontrollant, två virtuella SQL Server-datorer och ett vittnesserver i en enskild resursgrupp.</span><span class="sxs-lookup"><span data-stu-id="e1703-105">When you've finished hello prerequisites, you have a domain controller, two SQL Server VMs, and a witness server in a single resource group.</span></span>

<span data-ttu-id="e1703-106">**Tid uppskattning**: Det kan ta ett par timmar toocomplete hello krav.</span><span class="sxs-lookup"><span data-stu-id="e1703-106">**Time estimate**: It might take a couple of hours toocomplete hello prerequisites.</span></span> <span data-ttu-id="e1703-107">Mycket av den här tiden går åt för att skapa virtuella datorer.</span><span class="sxs-lookup"><span data-stu-id="e1703-107">Much of this time is spent creating virtual machines.</span></span>

<span data-ttu-id="e1703-108">hello följande diagram visar vad du bygga hello kursen.</span><span class="sxs-lookup"><span data-stu-id="e1703-108">hello following diagram illustrates what you build in hello tutorial.</span></span>

![Tillgänglighetsgruppen](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/00-EndstateSampleNoELB.png)

## <a name="review-availability-group-documentation"></a><span data-ttu-id="e1703-110">Läs dokumentationen om tillgänglighet</span><span class="sxs-lookup"><span data-stu-id="e1703-110">Review availability group documentation</span></span>

<span data-ttu-id="e1703-111">Den här kursen förutsätter att du har en grundläggande förståelse för SQL Server Always On-Tillgänglighetsgrupper.</span><span class="sxs-lookup"><span data-stu-id="e1703-111">This tutorial assumes that you have a basic understanding of SQL Server Always On availability groups.</span></span> <span data-ttu-id="e1703-112">Om du inte är bekant med den här tekniken finns [översikt över alltid på Tillgänglighetsgrupper (SQL Server)](http://msdn.microsoft.com/library/ff877884.aspx).</span><span class="sxs-lookup"><span data-stu-id="e1703-112">If you're not familiar with this technology, see [Overview of Always On Availability Groups (SQL Server)](http://msdn.microsoft.com/library/ff877884.aspx).</span></span>


## <a name="create-an-azure-account"></a><span data-ttu-id="e1703-113">Skapa ett Azure-konto</span><span class="sxs-lookup"><span data-stu-id="e1703-113">Create an Azure account</span></span>
<span data-ttu-id="e1703-114">Du behöver ett Azure-konto.</span><span class="sxs-lookup"><span data-stu-id="e1703-114">You need an Azure account.</span></span> <span data-ttu-id="e1703-115">Du kan [öppna ett kostnadsfritt Azure-konto](/pricing/free-trial/?WT.mc_id=A261C142F) eller [aktivera Visual Studio-prenumerantförmåner](/pricing/member-offers/msdn-benefits-details/?WT.mc_id=A261C142F).</span><span class="sxs-lookup"><span data-stu-id="e1703-115">You can [open a free Azure account](/pricing/free-trial/?WT.mc_id=A261C142F) or [activate Visual Studio subscriber benefits](/pricing/member-offers/msdn-benefits-details/?WT.mc_id=A261C142F).</span></span>

## <a name="create-a-resource-group"></a><span data-ttu-id="e1703-116">Skapa en resursgrupp</span><span class="sxs-lookup"><span data-stu-id="e1703-116">Create a resource group</span></span>
1. <span data-ttu-id="e1703-117">Logga in toohello [Azure-portalen](http://portal.azure.com).</span><span class="sxs-lookup"><span data-stu-id="e1703-117">Sign in toohello [Azure portal](http://portal.azure.com).</span></span>
2. <span data-ttu-id="e1703-118">Klicka på  **+**  toocreate ett nytt objekt i hello-portalen.</span><span class="sxs-lookup"><span data-stu-id="e1703-118">Click **+** toocreate a new object in hello portal.</span></span>

   ![Nytt objekt](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/01-portalplus.png)

3. <span data-ttu-id="e1703-120">Typen **resursgruppen** i hello **Marketplace** sökfönstret.</span><span class="sxs-lookup"><span data-stu-id="e1703-120">Type **resource group** in hello **Marketplace** search window.</span></span>

   ![Resursgrupp](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/01-resourcegroupsymbol.png)
4. <span data-ttu-id="e1703-122">Klicka på **resursgruppen**.</span><span class="sxs-lookup"><span data-stu-id="e1703-122">Click **Resource group**.</span></span>
5. <span data-ttu-id="e1703-123">Klicka på **Skapa**.</span><span class="sxs-lookup"><span data-stu-id="e1703-123">Click **Create**.</span></span>
6. <span data-ttu-id="e1703-124">På hello **resursgruppen** bladet under **resursgruppens namn**, Skriv ett namn för hello resursgruppen.</span><span class="sxs-lookup"><span data-stu-id="e1703-124">On hello **Resource group** blade, under **Resource group name**, type a name for hello resource group.</span></span> <span data-ttu-id="e1703-125">Skriv till exempel **sql-hög tillgänglighet-rg**.</span><span class="sxs-lookup"><span data-stu-id="e1703-125">For example, type **sql-ha-rg**.</span></span>
7. <span data-ttu-id="e1703-126">Om du har flera Azure-prenumerationer måste du kontrollera att hello prenumeration är hello Azure-prenumeration som du vill ha toocreate hello-tillgänglighetsgruppen.</span><span class="sxs-lookup"><span data-stu-id="e1703-126">If you have multiple Azure subscriptions, verify that hello subscription is hello Azure subscription that you want toocreate hello availability group in.</span></span>
8. <span data-ttu-id="e1703-127">Välj en plats.</span><span class="sxs-lookup"><span data-stu-id="e1703-127">Select a location.</span></span> <span data-ttu-id="e1703-128">hello platsen är hello Azure-region där du vill att toocreate hello-tillgänglighetsgruppen.</span><span class="sxs-lookup"><span data-stu-id="e1703-128">hello location is hello Azure region where you want toocreate hello availability group.</span></span> <span data-ttu-id="e1703-129">Den här självstudiekursen kommer vi toobuild alla resurser i en Azure-plats.</span><span class="sxs-lookup"><span data-stu-id="e1703-129">For this tutorial, we're going toobuild all resources in one Azure location.</span></span>
9. <span data-ttu-id="e1703-130">Kontrollera att **PIN-kod toodashboard** är markerad.</span><span class="sxs-lookup"><span data-stu-id="e1703-130">Verify that **Pin toodashboard** is checked.</span></span> <span data-ttu-id="e1703-131">Den här valfria inställningen placerar en genväg för hello resursgrupp på hello Azure portalens instrumentpanel.</span><span class="sxs-lookup"><span data-stu-id="e1703-131">This optional setting places a shortcut for hello resource group on hello Azure portal dashboard.</span></span>

   ![Resursgrupp](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/01-resourcegroup.png)

10. <span data-ttu-id="e1703-133">Klicka på **skapa** toocreate hello resursgruppen.</span><span class="sxs-lookup"><span data-stu-id="e1703-133">Click **Create** toocreate hello resource group.</span></span>

<span data-ttu-id="e1703-134">Azure skapar hello resursgrupp och PIN-koder som en genväg toohello resursgrupp hello-portalen.</span><span class="sxs-lookup"><span data-stu-id="e1703-134">Azure creates hello resource group and pins a shortcut toohello resource group in hello portal.</span></span>

## <a name="create-hello-network-and-subnets"></a><span data-ttu-id="e1703-135">Skapa hello nätverk och undernät</span><span class="sxs-lookup"><span data-stu-id="e1703-135">Create hello network and subnets</span></span>
<span data-ttu-id="e1703-136">hello nästa steg är toocreate hello nätverk och undernät i hello Azure-resursgrupp.</span><span class="sxs-lookup"><span data-stu-id="e1703-136">hello next step is toocreate hello networks and subnets in hello Azure resource group.</span></span>

<span data-ttu-id="e1703-137">hello lösningen använder ett virtuellt nätverk med två undernät.</span><span class="sxs-lookup"><span data-stu-id="e1703-137">hello solution uses one virtual network with two subnets.</span></span> <span data-ttu-id="e1703-138">Hej [översikt över virtuella nätverk](../../../virtual-network/virtual-networks-overview.md) innehåller mer information om nätverk i Azure.</span><span class="sxs-lookup"><span data-stu-id="e1703-138">hello [Virtual network overview](../../../virtual-network/virtual-networks-overview.md) provides more information about networks in Azure.</span></span>

<span data-ttu-id="e1703-139">toocreate hello virtuellt nätverk:</span><span class="sxs-lookup"><span data-stu-id="e1703-139">toocreate hello virtual network:</span></span>

1. <span data-ttu-id="e1703-140">Klicka på hello Azure-portalen i resursgruppen, **+ Lägg till**.</span><span class="sxs-lookup"><span data-stu-id="e1703-140">In hello Azure portal, in your resource group, click **+ Add**.</span></span> <span data-ttu-id="e1703-141">Azure öppnas hello **allt** bladet.</span><span class="sxs-lookup"><span data-stu-id="e1703-141">Azure opens hello **Everything** blade.</span></span>

   ![Nytt objekt](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/02-newiteminrg.png)
2. <span data-ttu-id="e1703-143">Sök efter **virtuellt nätverk**.</span><span class="sxs-lookup"><span data-stu-id="e1703-143">Search for **virtual network**.</span></span>

     ![Sökningen virtuellt nätverk](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/04-findvirtualnetwork.png)
3. <span data-ttu-id="e1703-145">Klicka på **för virtuella nätverk**.</span><span class="sxs-lookup"><span data-stu-id="e1703-145">Click **Virtual network**.</span></span>
4. <span data-ttu-id="e1703-146">På hello **för virtuella nätverk** bladet, klickar du på hello **Resource Manager** distributionsmodell och klicka sedan på **skapa**.</span><span class="sxs-lookup"><span data-stu-id="e1703-146">On hello **Virtual network** blade, click hello **Resource Manager** deployment model, and then click **Create**.</span></span>

    <span data-ttu-id="e1703-147">hello visar följande tabell hello inställningarna för hello-nätverket:</span><span class="sxs-lookup"><span data-stu-id="e1703-147">hello following table shows hello settings for hello virtual network:</span></span>

   | <span data-ttu-id="e1703-148">**Fält**</span><span class="sxs-lookup"><span data-stu-id="e1703-148">**Field**</span></span> | <span data-ttu-id="e1703-149">Värde</span><span class="sxs-lookup"><span data-stu-id="e1703-149">Value</span></span> |
   | --- | --- |
   | <span data-ttu-id="e1703-150">**Namn**</span><span class="sxs-lookup"><span data-stu-id="e1703-150">**Name**</span></span> |<span data-ttu-id="e1703-151">autoHAVNET</span><span class="sxs-lookup"><span data-stu-id="e1703-151">autoHAVNET</span></span> |
   | <span data-ttu-id="e1703-152">**Adressutrymme**</span><span class="sxs-lookup"><span data-stu-id="e1703-152">**Address space**</span></span> |<span data-ttu-id="e1703-153">10.33.0.0/24</span><span class="sxs-lookup"><span data-stu-id="e1703-153">10.33.0.0/24</span></span> |
   | <span data-ttu-id="e1703-154">**Namn på undernät**</span><span class="sxs-lookup"><span data-stu-id="e1703-154">**Subnet name**</span></span> |<span data-ttu-id="e1703-155">Admin</span><span class="sxs-lookup"><span data-stu-id="e1703-155">Admin</span></span> |
   | <span data-ttu-id="e1703-156">**Adressintervall för undernätet**</span><span class="sxs-lookup"><span data-stu-id="e1703-156">**Subnet address range**</span></span> |<span data-ttu-id="e1703-157">10.33.0.0/29</span><span class="sxs-lookup"><span data-stu-id="e1703-157">10.33.0.0/29</span></span> |
   | <span data-ttu-id="e1703-158">**Prenumeration**</span><span class="sxs-lookup"><span data-stu-id="e1703-158">**Subscription**</span></span> |<span data-ttu-id="e1703-159">Ange hello-prenumeration som du avser toouse.</span><span class="sxs-lookup"><span data-stu-id="e1703-159">Specify hello subscription that you intend toouse.</span></span> <span data-ttu-id="e1703-160">**Prenumerationen** är tom om du bara har en prenumeration.</span><span class="sxs-lookup"><span data-stu-id="e1703-160">**Subscription** is blank if you only have one subscription.</span></span> |
   | <span data-ttu-id="e1703-161">**Resursgrupp**</span><span class="sxs-lookup"><span data-stu-id="e1703-161">**Resource group**</span></span> |<span data-ttu-id="e1703-162">Välj **använda befintliga** och välj hello namnet på hello resursgrupp.</span><span class="sxs-lookup"><span data-stu-id="e1703-162">Choose **Use existing** and pick hello name of hello resource group.</span></span> |
   | <span data-ttu-id="e1703-163">**Plats**</span><span class="sxs-lookup"><span data-stu-id="e1703-163">**Location**</span></span> |<span data-ttu-id="e1703-164">Ange hello Azure-plats.</span><span class="sxs-lookup"><span data-stu-id="e1703-164">Specify hello Azure location.</span></span> |

   <span data-ttu-id="e1703-165">Adress adressutrymmet och undernätsegenskaperna adressintervallet kan skilja sig från hello tabell.</span><span class="sxs-lookup"><span data-stu-id="e1703-165">Your address space and subnet address range might be different from hello table.</span></span> <span data-ttu-id="e1703-166">Beroende på din prenumeration föreslår hello portal en tillgängliga adressutrymmet och motsvarande adressintervallet i undernätet.</span><span class="sxs-lookup"><span data-stu-id="e1703-166">Depending on your subscription, hello portal suggests an available address space and corresponding subnet address range.</span></span> <span data-ttu-id="e1703-167">Om det finns inte tillräckligt med adressutrymme Använd en annan prenumeration.</span><span class="sxs-lookup"><span data-stu-id="e1703-167">If no sufficient address space is available, use a different subscription.</span></span>

   <span data-ttu-id="e1703-168">hello-exempel som använder hello undernätsnamn **Admin**. Det här undernätet är hello-domänkontrollanter.</span><span class="sxs-lookup"><span data-stu-id="e1703-168">hello example uses hello subnet name **Admin**. This subnet is for hello domain controllers.</span></span>

5. <span data-ttu-id="e1703-169">Klicka på **Skapa**.</span><span class="sxs-lookup"><span data-stu-id="e1703-169">Click **Create**.</span></span>

   ![Konfigurera hello virtuellt nätverk](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/06-configurevirtualnetwork.png)

<span data-ttu-id="e1703-171">Azure returnerar toohello portalens instrumentpanel och meddelar dig när hello nytt nätverk skapas.</span><span class="sxs-lookup"><span data-stu-id="e1703-171">Azure returns you toohello portal dashboard and notifies you when hello new network is created.</span></span>

### <a name="create-a-second-subnet"></a><span data-ttu-id="e1703-172">Skapa ett andra undernät</span><span class="sxs-lookup"><span data-stu-id="e1703-172">Create a second subnet</span></span>
<span data-ttu-id="e1703-173">hello nytt virtuellt nätverk har ett undernät, med namnet **Admin**. hello domänkontrollanter använder det här undernätet.</span><span class="sxs-lookup"><span data-stu-id="e1703-173">hello new virtual network has one subnet, named **Admin**. hello domain controllers use this subnet.</span></span> <span data-ttu-id="e1703-174">hello virtuella SQL Server-datorer använder ett andra undernät med namnet **SQL**.</span><span class="sxs-lookup"><span data-stu-id="e1703-174">hello SQL Server VMs use a second subnet named **SQL**.</span></span> <span data-ttu-id="e1703-175">tooconfigure undernätet:</span><span class="sxs-lookup"><span data-stu-id="e1703-175">tooconfigure this subnet:</span></span>

1. <span data-ttu-id="e1703-176">Klicka på din instrumentpanel hello resursgrupp som du skapade **SQL-hög tillgänglighet-RG**.</span><span class="sxs-lookup"><span data-stu-id="e1703-176">On your dashboard, click hello resource group that you created, **SQL-HA-RG**.</span></span> <span data-ttu-id="e1703-177">Hitta hello nätverk i hello resursgruppen under **resurser**.</span><span class="sxs-lookup"><span data-stu-id="e1703-177">Locate hello network in hello resource group under **Resources**.</span></span>

    <span data-ttu-id="e1703-178">Om **SQL-hög tillgänglighet-RG** inte visas, hitta genom att klicka på **resursgrupper** och filtrering av hello resursgruppens namn.</span><span class="sxs-lookup"><span data-stu-id="e1703-178">If **SQL-HA-RG** isn't visible, find it by clicking **Resource Groups** and filtering by hello resource group name.</span></span>
2. <span data-ttu-id="e1703-179">Klicka på **autoHAVNET** hello listan över resurser.</span><span class="sxs-lookup"><span data-stu-id="e1703-179">Click **autoHAVNET** on hello list of resources.</span></span> <span data-ttu-id="e1703-180">Azure öppnas hello nätverksblad konfiguration.</span><span class="sxs-lookup"><span data-stu-id="e1703-180">Azure opens hello network configuration blade.</span></span>
3. <span data-ttu-id="e1703-181">På hello **autoHAVNET** virtuellt nätverksblad under **inställningar** , klickar du på **undernät**.</span><span class="sxs-lookup"><span data-stu-id="e1703-181">On hello **autoHAVNET** virtual network blade, under **Settings** , click **Subnets**.</span></span>

    <span data-ttu-id="e1703-182">Observera hello undernät som du redan skapat.</span><span class="sxs-lookup"><span data-stu-id="e1703-182">Note hello subnet that you already created.</span></span>

   ![Konfigurera hello virtuellt nätverk](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/07-addsubnet.png)
5. <span data-ttu-id="e1703-184">Skapa en andra undernät.</span><span class="sxs-lookup"><span data-stu-id="e1703-184">Create a second subnet.</span></span> <span data-ttu-id="e1703-185">Klicka på **+ undernät**.</span><span class="sxs-lookup"><span data-stu-id="e1703-185">Click **+ Subnet**.</span></span>
6. <span data-ttu-id="e1703-186">På hello **Lägg till undernät** bladet konfigurera hello-undernät genom att skriva **sqlsubnet** under **namn**.</span><span class="sxs-lookup"><span data-stu-id="e1703-186">On hello **Add subnet** blade, configure hello subnet by typing **sqlsubnet** under **Name**.</span></span> <span data-ttu-id="e1703-187">Azure automatiskt anger en giltig **adressintervall**.</span><span class="sxs-lookup"><span data-stu-id="e1703-187">Azure automatically specifies a valid **Address range**.</span></span> <span data-ttu-id="e1703-188">Kontrollera att detta adressintervall har minst 10 adresser i den.</span><span class="sxs-lookup"><span data-stu-id="e1703-188">Verify that this address range has at least 10 addresses in it.</span></span> <span data-ttu-id="e1703-189">Du kan behöva flera adresser i en produktionsmiljö.</span><span class="sxs-lookup"><span data-stu-id="e1703-189">In a production environment, you might require more addresses.</span></span>
7. <span data-ttu-id="e1703-190">Klicka på **OK**.</span><span class="sxs-lookup"><span data-stu-id="e1703-190">Click **OK**.</span></span>

    ![Konfigurera hello virtuellt nätverk](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/08-configuresubnet.png)

<span data-ttu-id="e1703-192">hello följande tabell sammanfattas hello nätverksinställningar för konfiguration:</span><span class="sxs-lookup"><span data-stu-id="e1703-192">hello following table summarizes hello network configuration settings:</span></span>

| <span data-ttu-id="e1703-193">**Fält**</span><span class="sxs-lookup"><span data-stu-id="e1703-193">**Field**</span></span> | <span data-ttu-id="e1703-194">Värde</span><span class="sxs-lookup"><span data-stu-id="e1703-194">Value</span></span> |
| --- | --- |
| <span data-ttu-id="e1703-195">**Namn**</span><span class="sxs-lookup"><span data-stu-id="e1703-195">**Name**</span></span> |<span data-ttu-id="e1703-196">**autoHAVNET**</span><span class="sxs-lookup"><span data-stu-id="e1703-196">**autoHAVNET**</span></span> |
| <span data-ttu-id="e1703-197">**Adressutrymme**</span><span class="sxs-lookup"><span data-stu-id="e1703-197">**Address space**</span></span> |<span data-ttu-id="e1703-198">Det här värdet är beroende av hello tillgängliga adressutrymmen i din prenumeration.</span><span class="sxs-lookup"><span data-stu-id="e1703-198">This value depends on hello available address spaces in your subscription.</span></span> <span data-ttu-id="e1703-199">Ett vanligt värde är 10.0.0.0/16.</span><span class="sxs-lookup"><span data-stu-id="e1703-199">A typical value is 10.0.0.0/16.</span></span> |
| <span data-ttu-id="e1703-200">**Namn på undernät**</span><span class="sxs-lookup"><span data-stu-id="e1703-200">**Subnet name**</span></span> |<span data-ttu-id="e1703-201">**Admin**</span><span class="sxs-lookup"><span data-stu-id="e1703-201">**admin**</span></span> |
| <span data-ttu-id="e1703-202">**Adressintervall för undernätet**</span><span class="sxs-lookup"><span data-stu-id="e1703-202">**Subnet address range**</span></span> |<span data-ttu-id="e1703-203">Det här värdet är beroende av hello tillgängliga adressintervall i din prenumeration.</span><span class="sxs-lookup"><span data-stu-id="e1703-203">This value depends on hello available address ranges in your subscription.</span></span> <span data-ttu-id="e1703-204">Ett vanligt värde är 10.0.0.0/24.</span><span class="sxs-lookup"><span data-stu-id="e1703-204">A typical value is 10.0.0.0/24.</span></span> |
| <span data-ttu-id="e1703-205">**Namn på undernät**</span><span class="sxs-lookup"><span data-stu-id="e1703-205">**Subnet name**</span></span> |<span data-ttu-id="e1703-206">**sqlsubnet**</span><span class="sxs-lookup"><span data-stu-id="e1703-206">**sqlsubnet**</span></span> |
| <span data-ttu-id="e1703-207">**Adressintervall för undernätet**</span><span class="sxs-lookup"><span data-stu-id="e1703-207">**Subnet address range**</span></span> |<span data-ttu-id="e1703-208">Det här värdet är beroende av hello tillgängliga adressintervall i din prenumeration.</span><span class="sxs-lookup"><span data-stu-id="e1703-208">This value depends on hello available address ranges in your subscription.</span></span> <span data-ttu-id="e1703-209">Ett vanligt värde är 10.0.1.0/24.</span><span class="sxs-lookup"><span data-stu-id="e1703-209">A typical value is 10.0.1.0/24.</span></span> |
| <span data-ttu-id="e1703-210">**Prenumeration**</span><span class="sxs-lookup"><span data-stu-id="e1703-210">**Subscription**</span></span> |<span data-ttu-id="e1703-211">Ange hello-prenumeration som du avser toouse.</span><span class="sxs-lookup"><span data-stu-id="e1703-211">Specify hello subscription that you intend toouse.</span></span> |
| <span data-ttu-id="e1703-212">**Resursgrupp**</span><span class="sxs-lookup"><span data-stu-id="e1703-212">**Resource Group**</span></span> |<span data-ttu-id="e1703-213">**SQL-HÖG TILLGÄNGLIGHET-RG**</span><span class="sxs-lookup"><span data-stu-id="e1703-213">**SQL-HA-RG**</span></span> |
| <span data-ttu-id="e1703-214">**Plats**</span><span class="sxs-lookup"><span data-stu-id="e1703-214">**Location**</span></span> |<span data-ttu-id="e1703-215">Ange hello samma plats som du valde för hello resursgruppen.</span><span class="sxs-lookup"><span data-stu-id="e1703-215">Specify hello same location that you chose for hello resource group.</span></span> |

## <a name="create-availability-sets"></a><span data-ttu-id="e1703-216">Skapa tillgänglighetsuppsättningar</span><span class="sxs-lookup"><span data-stu-id="e1703-216">Create availability sets</span></span>

<span data-ttu-id="e1703-217">Innan du skapar virtuella datorer måste toocreate tillgänglighetsuppsättningar.</span><span class="sxs-lookup"><span data-stu-id="e1703-217">Before you create virtual machines, you need toocreate availability sets.</span></span> <span data-ttu-id="e1703-218">Tillgänglighetsuppsättningar minska hello driftstopp för planerat eller oplanerat underhållshändelser.</span><span class="sxs-lookup"><span data-stu-id="e1703-218">Availability sets reduce hello downtime for planned or unplanned maintenance events.</span></span> <span data-ttu-id="e1703-219">En Azure tillgänglighetsuppsättning är en logisk grupp med resurser som Azure placerar fysiska feldomäner och update-domäner.</span><span class="sxs-lookup"><span data-stu-id="e1703-219">An Azure availability set is a logical group of resources that Azure places on physical fault domains and update domains.</span></span> <span data-ttu-id="e1703-220">En feldomän garanterar att hello medlemmar i hello tillgänglighetsuppsättning har separata power och nätverksresurser.</span><span class="sxs-lookup"><span data-stu-id="e1703-220">A fault domain ensures that hello members of hello availability set have separate power and network resources.</span></span> <span data-ttu-id="e1703-221">En uppdateringsdomän garanterar att medlemmar i hello tillgänglighetsuppsättning inte återspeglas för underhåll på hello samma tid.</span><span class="sxs-lookup"><span data-stu-id="e1703-221">An update domain ensures that members of hello availability set aren't brought down for maintenance at hello same time.</span></span> <span data-ttu-id="e1703-222">Mer information finns i [hantera hello tillgängligheten för virtuella datorer](../manage-availability.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).</span><span class="sxs-lookup"><span data-stu-id="e1703-222">For more information, see [Manage hello availability of virtual machines](../manage-availability.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).</span></span>

<span data-ttu-id="e1703-223">Du behöver två tillgänglighetsuppsättningar.</span><span class="sxs-lookup"><span data-stu-id="e1703-223">You need two availability sets.</span></span> <span data-ttu-id="e1703-224">En är hello-domänkontrollanter.</span><span class="sxs-lookup"><span data-stu-id="e1703-224">One is for hello domain controllers.</span></span> <span data-ttu-id="e1703-225">hello gäller andra hello SQL Server-datorer.</span><span class="sxs-lookup"><span data-stu-id="e1703-225">hello second is for hello SQL Server VMs.</span></span>

<span data-ttu-id="e1703-226">toocreate tillgänglighet ange går toohello resursgrupp och klicka på **Lägg till**.</span><span class="sxs-lookup"><span data-stu-id="e1703-226">toocreate an availability set, go toohello resource group and click **Add**.</span></span> <span data-ttu-id="e1703-227">Filtrera hello resultat genom att skriva **tillgänglighetsuppsättning**.</span><span class="sxs-lookup"><span data-stu-id="e1703-227">Filter hello results by typing **availability set**.</span></span> <span data-ttu-id="e1703-228">Klicka på **Tillgänglighetsuppsättning** i hello resultaten och klickar sedan på **skapa**.</span><span class="sxs-lookup"><span data-stu-id="e1703-228">Click **Availability Set** in hello results, and then click **Create**.</span></span>

<span data-ttu-id="e1703-229">Konfigurera två tillgänglighetsuppsättningar enligt toohello parametrar i den följande tabellen hello:</span><span class="sxs-lookup"><span data-stu-id="e1703-229">Configure two availability sets according toohello parameters in hello following table:</span></span>

| <span data-ttu-id="e1703-230">**Fält**</span><span class="sxs-lookup"><span data-stu-id="e1703-230">**Field**</span></span> | <span data-ttu-id="e1703-231">Domain controller tillgänglighetsuppsättning</span><span class="sxs-lookup"><span data-stu-id="e1703-231">Domain controller availability set</span></span> | <span data-ttu-id="e1703-232">Tillgänglighetsuppsättningen för SQL Server</span><span class="sxs-lookup"><span data-stu-id="e1703-232">SQL Server availability set</span></span> |
| --- | --- | --- |
| <span data-ttu-id="e1703-233">**Namn**</span><span class="sxs-lookup"><span data-stu-id="e1703-233">**Name**</span></span> |<span data-ttu-id="e1703-234">adavailabilityset</span><span class="sxs-lookup"><span data-stu-id="e1703-234">adavailabilityset</span></span> |<span data-ttu-id="e1703-235">sqlavailabilityset</span><span class="sxs-lookup"><span data-stu-id="e1703-235">sqlavailabilityset</span></span> |
| <span data-ttu-id="e1703-236">**Resursgrupp**</span><span class="sxs-lookup"><span data-stu-id="e1703-236">**Resource group**</span></span> |<span data-ttu-id="e1703-237">SQL-HÖG TILLGÄNGLIGHET-RG</span><span class="sxs-lookup"><span data-stu-id="e1703-237">SQL-HA-RG</span></span> |<span data-ttu-id="e1703-238">SQL-HÖG TILLGÄNGLIGHET-RG</span><span class="sxs-lookup"><span data-stu-id="e1703-238">SQL-HA-RG</span></span> |
| <span data-ttu-id="e1703-239">**Feldomäner**</span><span class="sxs-lookup"><span data-stu-id="e1703-239">**Fault domains**</span></span> |<span data-ttu-id="e1703-240">3</span><span class="sxs-lookup"><span data-stu-id="e1703-240">3</span></span> |<span data-ttu-id="e1703-241">3</span><span class="sxs-lookup"><span data-stu-id="e1703-241">3</span></span> |
| <span data-ttu-id="e1703-242">**Uppdatera domäner**</span><span class="sxs-lookup"><span data-stu-id="e1703-242">**Update domains**</span></span> |<span data-ttu-id="e1703-243">5</span><span class="sxs-lookup"><span data-stu-id="e1703-243">5</span></span> |<span data-ttu-id="e1703-244">3</span><span class="sxs-lookup"><span data-stu-id="e1703-244">3</span></span> |

<span data-ttu-id="e1703-245">När du har skapat hello tillgänglighetsuppsättningar returnera toohello resursgrupp i hello Azure-portalen.</span><span class="sxs-lookup"><span data-stu-id="e1703-245">After you create hello availability sets, return toohello resource group in hello Azure portal.</span></span>

## <a name="create-domain-controllers"></a><span data-ttu-id="e1703-246">Skapa domänkontrollanter</span><span class="sxs-lookup"><span data-stu-id="e1703-246">Create domain controllers</span></span>
<span data-ttu-id="e1703-247">När du har skapat hello nätverk, undernät, tillgänglighetsuppsättningar och en Internetriktade belastningsutjämnare, är du redo toocreate hello virtuella datorer för hello-domänkontrollanter.</span><span class="sxs-lookup"><span data-stu-id="e1703-247">After you've created hello network, subnets, availability sets, and an Internet-facing load balancer, you're ready toocreate hello virtual machines for hello domain controllers.</span></span>

### <a name="create-virtual-machines-for-hello-domain-controllers"></a><span data-ttu-id="e1703-248">Skapa virtuella datorer för hello-domänkontrollanter</span><span class="sxs-lookup"><span data-stu-id="e1703-248">Create virtual machines for hello domain controllers</span></span>
<span data-ttu-id="e1703-249">toocreate och konfigurera hello domänkontrollanter, returnera toohello **SQL-hög tillgänglighet-RG** resursgruppen.</span><span class="sxs-lookup"><span data-stu-id="e1703-249">toocreate and configure hello domain controllers, return toohello **SQL-HA-RG** resource group.</span></span>

1. <span data-ttu-id="e1703-250">Klicka på **Lägg till**.</span><span class="sxs-lookup"><span data-stu-id="e1703-250">Click **Add**.</span></span> <span data-ttu-id="e1703-251">Hej **allt** blad öppnas.</span><span class="sxs-lookup"><span data-stu-id="e1703-251">hello **Everything** blade opens.</span></span>
2. <span data-ttu-id="e1703-252">Typen **Windows Server 2016 Datacenter**.</span><span class="sxs-lookup"><span data-stu-id="e1703-252">Type **Windows Server 2016 Datacenter**.</span></span>
3. <span data-ttu-id="e1703-253">Klicka på **Windows Server 2016 Datacenter**.</span><span class="sxs-lookup"><span data-stu-id="e1703-253">Click **Windows Server 2016 Datacenter**.</span></span> <span data-ttu-id="e1703-254">I hello **Windows Server 2016 Datacenter** bladet, kontrollera att hello distributionsmodell är **Resource Manager**, och klicka sedan på **skapa**.</span><span class="sxs-lookup"><span data-stu-id="e1703-254">In hello **Windows Server 2016 Datacenter** blade, verify that hello deployment model is **Resource Manager**, and then click **Create**.</span></span> <span data-ttu-id="e1703-255">Azure öppnas hello **Skapa virtuell dator** bladet.</span><span class="sxs-lookup"><span data-stu-id="e1703-255">Azure opens hello **Create virtual machine** blade.</span></span>

<span data-ttu-id="e1703-256">Upprepa föregående steg toocreate två virtuella datorer hello.</span><span class="sxs-lookup"><span data-stu-id="e1703-256">Repeat hello preceding steps toocreate two virtual machines.</span></span> <span data-ttu-id="e1703-257">Namn hello två virtuella datorer:</span><span class="sxs-lookup"><span data-stu-id="e1703-257">Name hello two virtual machines:</span></span>

* <span data-ttu-id="e1703-258">AD-primära-dc</span><span class="sxs-lookup"><span data-stu-id="e1703-258">ad-primary-dc</span></span>
* <span data-ttu-id="e1703-259">AD-sekundär-dc</span><span class="sxs-lookup"><span data-stu-id="e1703-259">ad-secondary-dc</span></span>

  > [!NOTE]
  > <span data-ttu-id="e1703-260">Hej **ad-sekundär-dc** virtuella datorn är valfritt, tooprovide hög tillgänglighet för Active Directory Domain Services.</span><span class="sxs-lookup"><span data-stu-id="e1703-260">hello **ad-secondary-dc** virtual machine is optional, tooprovide high availability for Active Directory Domain Services.</span></span>
  >
  >

<span data-ttu-id="e1703-261">hello visar följande tabell hello inställningarna för dessa två datorer:</span><span class="sxs-lookup"><span data-stu-id="e1703-261">hello following table shows hello settings for these two machines:</span></span>

| <span data-ttu-id="e1703-262">**Fält**</span><span class="sxs-lookup"><span data-stu-id="e1703-262">**Field**</span></span> | <span data-ttu-id="e1703-263">Värde</span><span class="sxs-lookup"><span data-stu-id="e1703-263">Value</span></span> |
| --- | --- |
| <span data-ttu-id="e1703-264">**Namn**</span><span class="sxs-lookup"><span data-stu-id="e1703-264">**Name**</span></span> |<span data-ttu-id="e1703-265">Första domänkontrollant: *ad primär domänkontrollant*.</span><span class="sxs-lookup"><span data-stu-id="e1703-265">First domain controller: *ad-primary-dc*.</span></span></br><span data-ttu-id="e1703-266">Andra domänkontrollanten *ad-sekundär-dc*.</span><span class="sxs-lookup"><span data-stu-id="e1703-266">Second domain controller *ad-secondary-dc*.</span></span> |
| <span data-ttu-id="e1703-267">**Typ av virtuell datordisk**</span><span class="sxs-lookup"><span data-stu-id="e1703-267">**VM disk type**</span></span> |<span data-ttu-id="e1703-268">SSD</span><span class="sxs-lookup"><span data-stu-id="e1703-268">SSD</span></span> |
| <span data-ttu-id="e1703-269">**Användarnamn**</span><span class="sxs-lookup"><span data-stu-id="e1703-269">**User name**</span></span> |<span data-ttu-id="e1703-270">DomainAdmin</span><span class="sxs-lookup"><span data-stu-id="e1703-270">DomainAdmin</span></span> |
| <span data-ttu-id="e1703-271">**Lösenord**</span><span class="sxs-lookup"><span data-stu-id="e1703-271">**Password**</span></span> |<span data-ttu-id="e1703-272">Contoso! 0000</span><span class="sxs-lookup"><span data-stu-id="e1703-272">Contoso!0000</span></span> |
| <span data-ttu-id="e1703-273">**Prenumeration**</span><span class="sxs-lookup"><span data-stu-id="e1703-273">**Subscription**</span></span> |<span data-ttu-id="e1703-274">*Din prenumeration*</span><span class="sxs-lookup"><span data-stu-id="e1703-274">*Your subscription*</span></span> |
| <span data-ttu-id="e1703-275">**Resursgrupp**</span><span class="sxs-lookup"><span data-stu-id="e1703-275">**Resource group**</span></span> |<span data-ttu-id="e1703-276">SQL-HÖG TILLGÄNGLIGHET-RG</span><span class="sxs-lookup"><span data-stu-id="e1703-276">SQL-HA-RG</span></span> |
| <span data-ttu-id="e1703-277">**Plats**</span><span class="sxs-lookup"><span data-stu-id="e1703-277">**Location**</span></span> |<span data-ttu-id="e1703-278">*Din plats*</span><span class="sxs-lookup"><span data-stu-id="e1703-278">*Your location*</span></span> |
| <span data-ttu-id="e1703-279">**Storlek**</span><span class="sxs-lookup"><span data-stu-id="e1703-279">**Size**</span></span> |<span data-ttu-id="e1703-280">DS1_V2</span><span class="sxs-lookup"><span data-stu-id="e1703-280">DS1_V2</span></span> |
| <span data-ttu-id="e1703-281">**Storage**</span><span class="sxs-lookup"><span data-stu-id="e1703-281">**Storage**</span></span> | <span data-ttu-id="e1703-282">**Använda hanterade diskar** - **Ja**</span><span class="sxs-lookup"><span data-stu-id="e1703-282">**Use managed disks** - **Yes**</span></span> |
| <span data-ttu-id="e1703-283">**Virtuellt nätverk**</span><span class="sxs-lookup"><span data-stu-id="e1703-283">**Virtual network**</span></span> |<span data-ttu-id="e1703-284">autoHAVNET</span><span class="sxs-lookup"><span data-stu-id="e1703-284">autoHAVNET</span></span> |
| <span data-ttu-id="e1703-285">**Undernät**</span><span class="sxs-lookup"><span data-stu-id="e1703-285">**Subnet**</span></span> |<span data-ttu-id="e1703-286">Admin</span><span class="sxs-lookup"><span data-stu-id="e1703-286">admin</span></span> |
| <span data-ttu-id="e1703-287">**Offentlig IP-adress**</span><span class="sxs-lookup"><span data-stu-id="e1703-287">**Public IP address**</span></span> |<span data-ttu-id="e1703-288">*Samma namn som hello VM*</span><span class="sxs-lookup"><span data-stu-id="e1703-288">*Same name as hello VM*</span></span> |
| <span data-ttu-id="e1703-289">**Nätverkssäkerhetsgrupp**</span><span class="sxs-lookup"><span data-stu-id="e1703-289">**Network security group**</span></span> |<span data-ttu-id="e1703-290">*Samma namn som hello VM*</span><span class="sxs-lookup"><span data-stu-id="e1703-290">*Same name as hello VM*</span></span> |
| <span data-ttu-id="e1703-291">**Tillgänglighetsuppsättning**</span><span class="sxs-lookup"><span data-stu-id="e1703-291">**Availability set**</span></span> |<span data-ttu-id="e1703-292">adavailabilityset</span><span class="sxs-lookup"><span data-stu-id="e1703-292">adavailabilityset</span></span> </br><span data-ttu-id="e1703-293">**Fault domäner**: 2</span><span class="sxs-lookup"><span data-stu-id="e1703-293">**Fault domains**:2</span></span></br><span data-ttu-id="e1703-294">**Uppdatera domäner**: 2</span><span class="sxs-lookup"><span data-stu-id="e1703-294">**Update domains**:2</span></span>|
| <span data-ttu-id="e1703-295">**Diagnostik**</span><span class="sxs-lookup"><span data-stu-id="e1703-295">**Diagnostics**</span></span> |<span data-ttu-id="e1703-296">Enabled</span><span class="sxs-lookup"><span data-stu-id="e1703-296">Enabled</span></span> |
| <span data-ttu-id="e1703-297">**Diagnostiklagringskonto**</span><span class="sxs-lookup"><span data-stu-id="e1703-297">**Diagnostics storage account**</span></span> |<span data-ttu-id="e1703-298">*Skapas automatiskt*</span><span class="sxs-lookup"><span data-stu-id="e1703-298">*Automatically created*</span></span> |

   >[!IMPORTANT]
   ><span data-ttu-id="e1703-299">Du kan bara placera en virtuell dator i en tillgänglighetsuppsättning när du skapar den.</span><span class="sxs-lookup"><span data-stu-id="e1703-299">You can only place a VM in an availability set when you create it.</span></span> <span data-ttu-id="e1703-300">Du kan inte ändra hello tillgänglighetsuppsättning när en virtuell dator skapas.</span><span class="sxs-lookup"><span data-stu-id="e1703-300">You can't change hello availability set after a VM is created.</span></span> <span data-ttu-id="e1703-301">Se [hantera hello tillgängligheten för virtuella datorer](../manage-availability.md).</span><span class="sxs-lookup"><span data-stu-id="e1703-301">See [Manage hello availability of virtual machines](../manage-availability.md).</span></span>

<span data-ttu-id="e1703-302">Azure skapar hello virtuella datorer.</span><span class="sxs-lookup"><span data-stu-id="e1703-302">Azure creates hello virtual machines.</span></span>

<span data-ttu-id="e1703-303">När hello virtuella datorer har skapats kan du konfigurera hello domänkontrollant.</span><span class="sxs-lookup"><span data-stu-id="e1703-303">After hello virtual machines are created, configure hello domain controller.</span></span>

### <a name="configure-hello-domain-controller"></a><span data-ttu-id="e1703-304">Konfigurera hello-domänkontrollant</span><span class="sxs-lookup"><span data-stu-id="e1703-304">Configure hello domain controller</span></span>
<span data-ttu-id="e1703-305">Följande steg, konfigurera hello hello **ad primär domänkontrollant** maskin som en domänkontrollant för corp.contoso.com.</span><span class="sxs-lookup"><span data-stu-id="e1703-305">In hello following steps, configure hello **ad-primary-dc** machine as a domain controller for corp.contoso.com.</span></span>

1. <span data-ttu-id="e1703-306">Öppna hello i hello portal **SQL-hög tillgänglighet-RG** resursgrupp och välj hello **ad primär domänkontrollant** datorn.</span><span class="sxs-lookup"><span data-stu-id="e1703-306">In hello portal, open hello **SQL-HA-RG** resource group and select hello **ad-primary-dc** machine.</span></span> <span data-ttu-id="e1703-307">På hello **ad primär domänkontrollant** bladet, klickar du på **Anslut** tooopen en RDP-filen för fjärråtkomst till skrivbordet.</span><span class="sxs-lookup"><span data-stu-id="e1703-307">On hello **ad-primary-dc** blade, click **Connect** tooopen an RDP file for remote desktop access.</span></span>

    ![Ansluta tooa virtuell dator](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/20-connectrdp.png)
2. <span data-ttu-id="e1703-309">Logga in med ditt konfigurerade administratörskonto (**\DomainAdmin**) och lösenord (**Contoso! 0000**).</span><span class="sxs-lookup"><span data-stu-id="e1703-309">Sign in with your configured administrator account (**\DomainAdmin**) and password (**Contoso!0000**).</span></span>
3. <span data-ttu-id="e1703-310">Som standard hello **Serverhanteraren** instrumentpanelen ska visas.</span><span class="sxs-lookup"><span data-stu-id="e1703-310">By default, hello **Server Manager** dashboard should be displayed.</span></span>
4. <span data-ttu-id="e1703-311">Klicka på hello **Lägg till roller och funktioner** länk på hello instrumentpanelen.</span><span class="sxs-lookup"><span data-stu-id="e1703-311">Click hello **Add roles and features** link on hello dashboard.</span></span>

    ![Server Manager - Lägg till roller](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/22-addfeatures.png)
5. <span data-ttu-id="e1703-313">Välj **nästa** tills toohello **serverroller** avsnitt.</span><span class="sxs-lookup"><span data-stu-id="e1703-313">Select **Next** until you get toohello **Server Roles** section.</span></span>
6. <span data-ttu-id="e1703-314">Välj hello **Active Directory Domain Services** och **DNS-Server** roller.</span><span class="sxs-lookup"><span data-stu-id="e1703-314">Select hello **Active Directory Domain Services** and **DNS Server** roles.</span></span> <span data-ttu-id="e1703-315">När du uppmanas att lägga till eventuella ytterligare funktioner som krävs av rollerna.</span><span class="sxs-lookup"><span data-stu-id="e1703-315">When you're prompted, add any additional features that are required by these roles.</span></span>

   > [!NOTE]
   > <span data-ttu-id="e1703-316">Windows varnar dig om att det finns ingen statisk IP-adress.</span><span class="sxs-lookup"><span data-stu-id="e1703-316">Windows warns you that there is no static IP address.</span></span> <span data-ttu-id="e1703-317">Om du testar hello-konfiguration klickar du på **Fortsätt**.</span><span class="sxs-lookup"><span data-stu-id="e1703-317">If you're testing hello configuration, click **Continue**.</span></span> <span data-ttu-id="e1703-318">Ange hello IP-adress toostatic för produktion scenarier i hello Azure-portalen eller [PowerShell tooset hello statisk IP-adress för hello domain controller datorn](../../../virtual-network/virtual-networks-reserved-private-ip.md).</span><span class="sxs-lookup"><span data-stu-id="e1703-318">For production scenarios, set hello IP address toostatic in hello Azure portal, or [use PowerShell tooset hello static IP address of hello domain controller machine](../../../virtual-network/virtual-networks-reserved-private-ip.md).</span></span>
   >
   >

    ![Lägg till roller dialogrutan](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/23-addroles.png)
7. <span data-ttu-id="e1703-320">Klicka på **nästa** tills du når hello **bekräftelse** avsnitt.</span><span class="sxs-lookup"><span data-stu-id="e1703-320">Click **Next** until you reach hello **Confirmation** section.</span></span> <span data-ttu-id="e1703-321">Välj hello **omstart hello-målservern automatiskt om det behövs** kryssrutan.</span><span class="sxs-lookup"><span data-stu-id="e1703-321">Select hello **Restart hello destination server automatically if required** check box.</span></span>
8. <span data-ttu-id="e1703-322">Klicka på **Installera**.</span><span class="sxs-lookup"><span data-stu-id="e1703-322">Click **Install**.</span></span>
9. <span data-ttu-id="e1703-323">När hello funktioner Slutför installation, returnerar toohello **Serverhanteraren** instrumentpanelen.</span><span class="sxs-lookup"><span data-stu-id="e1703-323">After hello features finish installing, return toohello **Server Manager** dashboard.</span></span>
10. <span data-ttu-id="e1703-324">Välj ny hello **AD DS** alternativet på hello vänstra fönstret.</span><span class="sxs-lookup"><span data-stu-id="e1703-324">Select hello new **AD DS** option on hello left-hand pane.</span></span>
11. <span data-ttu-id="e1703-325">Klicka på hello **mer** länk hello gul varning-fältet.</span><span class="sxs-lookup"><span data-stu-id="e1703-325">Click hello **More** link on hello yellow warning bar.</span></span>

    ![AD DS-dialogen för hello DNS Server VM](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/24-addsmore.png)
12. <span data-ttu-id="e1703-327">I hello **åtgärd** kolumn i hello **alla Server aktivitetsinformation** dialogrutan klickar du på **befordra den här servern tooa domänkontrollanten**.</span><span class="sxs-lookup"><span data-stu-id="e1703-327">In hello **Action** column of hello **All Server Task Details** dialog, click **Promote this server tooa domain controller**.</span></span>
13. <span data-ttu-id="e1703-328">I hello **konfigurationsguiden Active Directory Domain Services**, använda hello följande värden:</span><span class="sxs-lookup"><span data-stu-id="e1703-328">In hello **Active Directory Domain Services Configuration Wizard**, use hello following values:</span></span>

    | <span data-ttu-id="e1703-329">**Sidan**</span><span class="sxs-lookup"><span data-stu-id="e1703-329">**Page**</span></span> | <span data-ttu-id="e1703-330">Inställning</span><span class="sxs-lookup"><span data-stu-id="e1703-330">Setting</span></span> |
    | --- | --- |
    | <span data-ttu-id="e1703-331">**Distributionskonfiguration**</span><span class="sxs-lookup"><span data-stu-id="e1703-331">**Deployment Configuration**</span></span> |<span data-ttu-id="e1703-332">**Lägg till en ny skog**</span><span class="sxs-lookup"><span data-stu-id="e1703-332">**Add a new forest**</span></span><br/> <span data-ttu-id="e1703-333">**Rotdomännamn** = corp.contoso.com</span><span class="sxs-lookup"><span data-stu-id="e1703-333">**Root domain name** = corp.contoso.com</span></span> |
    | <span data-ttu-id="e1703-334">**Alternativ för domänkontrollant**</span><span class="sxs-lookup"><span data-stu-id="e1703-334">**Domain Controller Options**</span></span> |<span data-ttu-id="e1703-335">**DSRM-lösenordet** = Contoso! 0000</span><span class="sxs-lookup"><span data-stu-id="e1703-335">**DSRM Password** = Contoso!0000</span></span><br/><span data-ttu-id="e1703-336">**Bekräfta lösenord** = Contoso! 0000</span><span class="sxs-lookup"><span data-stu-id="e1703-336">**Confirm Password** = Contoso!0000</span></span> |
14. <span data-ttu-id="e1703-337">Klicka på **nästa** toogo via hello andra sidor i guiden hello.</span><span class="sxs-lookup"><span data-stu-id="e1703-337">Click **Next** toogo through hello other pages in hello wizard.</span></span> <span data-ttu-id="e1703-338">På hello **Kravkontroll** kontrollerar du att du ser följande meddelande hello: **alla kravkontroller har lyckats**.</span><span class="sxs-lookup"><span data-stu-id="e1703-338">On hello **Prerequisites Check** page, verify that you see hello following message: **All prerequisite checks passed successfully**.</span></span> <span data-ttu-id="e1703-339">Du kan granska alla meddelanden, men det är möjligt toocontinue med hello-installation.</span><span class="sxs-lookup"><span data-stu-id="e1703-339">You can review any applicable warning messages, but it's possible toocontinue with hello installation.</span></span>
15. <span data-ttu-id="e1703-340">Klicka på **Installera**.</span><span class="sxs-lookup"><span data-stu-id="e1703-340">Click **Install**.</span></span> <span data-ttu-id="e1703-341">Hej **ad primär domänkontrollant** virtuella datorn startar om automatiskt.</span><span class="sxs-lookup"><span data-stu-id="e1703-341">hello **ad-primary-dc** virtual machine automatically reboots.</span></span>

### <a name="note-hello-ip-address-of-hello-primary-domain-controller"></a><span data-ttu-id="e1703-342">Observera hello IP-adressen för primär domänkontrollant för hello</span><span class="sxs-lookup"><span data-stu-id="e1703-342">Note hello IP address of hello primary domain controller</span></span>

<span data-ttu-id="e1703-343">Använd hello primära domänkontrollanten för DNS.</span><span class="sxs-lookup"><span data-stu-id="e1703-343">Use hello primary domain controller for DNS.</span></span> <span data-ttu-id="e1703-344">Observera hello primär domän controller IP-adress.</span><span class="sxs-lookup"><span data-stu-id="e1703-344">Note hello primary domain controller IP address.</span></span>

<span data-ttu-id="e1703-345">Enkelriktade tooget hello primär domän controller IP-adress är via hello Azure-portalen.</span><span class="sxs-lookup"><span data-stu-id="e1703-345">One way tooget hello primary domain controller IP address is through hello Azure portal.</span></span>

1. <span data-ttu-id="e1703-346">Öppna hello resursgruppen på hello Azure-portalen.</span><span class="sxs-lookup"><span data-stu-id="e1703-346">On hello Azure portal, open hello resource group.</span></span>

2. <span data-ttu-id="e1703-347">Klicka på hello primär domänkontrollant.</span><span class="sxs-lookup"><span data-stu-id="e1703-347">Click hello primary domain controller.</span></span>

3. <span data-ttu-id="e1703-348">Klicka på hello primär domän controller bladet **nätverksgränssnitt**.</span><span class="sxs-lookup"><span data-stu-id="e1703-348">On hello primary domain controller blade, click **Network interfaces**.</span></span>

![Nätverksgränssnitt](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/25-primarydcip.png)

<span data-ttu-id="e1703-350">Observera hello privata IP-adressen för den här servern.</span><span class="sxs-lookup"><span data-stu-id="e1703-350">Note hello private IP address for this server.</span></span>

### <a name="configure-hello-virtual-network-dns"></a><span data-ttu-id="e1703-351">Konfigurera hello virtuellt nätverk DNS</span><span class="sxs-lookup"><span data-stu-id="e1703-351">Configure hello virtual network DNS</span></span>
<span data-ttu-id="e1703-352">När du skapar hello första domänkontrollanten och aktivera DNS på hello första servern kan du konfigurera hello virtuellt nätverk toouse servern för DNS.</span><span class="sxs-lookup"><span data-stu-id="e1703-352">After you create hello first domain controller and enable DNS on hello first server, configure hello virtual network toouse this server for DNS.</span></span>

1. <span data-ttu-id="e1703-353">Klicka på hello virtuellt nätverk i hello Azure-portalen.</span><span class="sxs-lookup"><span data-stu-id="e1703-353">In hello Azure portal, click on hello virtual network.</span></span>

2. <span data-ttu-id="e1703-354">Under **inställningar**, klickar du på **DNS-Server**.</span><span class="sxs-lookup"><span data-stu-id="e1703-354">Under **Settings**, click **DNS Server**.</span></span>

3. <span data-ttu-id="e1703-355">Klicka på **anpassade**, och Skriv hello privata IP-adressen för hello primära domänkontrollanten.</span><span class="sxs-lookup"><span data-stu-id="e1703-355">Click **Custom**, and type hello private IP address of hello primary domain controller.</span></span>

4. <span data-ttu-id="e1703-356">Klicka på **Spara**.</span><span class="sxs-lookup"><span data-stu-id="e1703-356">Click **Save**.</span></span>

### <a name="configure-hello-second-domain-controller"></a><span data-ttu-id="e1703-357">Konfigurera hello andra domänkontrollanter</span><span class="sxs-lookup"><span data-stu-id="e1703-357">Configure hello second domain controller</span></span>
<span data-ttu-id="e1703-358">När hello primära domänkontrollanten startar om, kan du konfigurera hello andra domänkontrollanten.</span><span class="sxs-lookup"><span data-stu-id="e1703-358">After hello primary domain controller reboots, you can configure hello second domain controller.</span></span> <span data-ttu-id="e1703-359">Det här valfria steget är för hög tillgänglighet.</span><span class="sxs-lookup"><span data-stu-id="e1703-359">This optional step is for high availability.</span></span> <span data-ttu-id="e1703-360">Följ dessa steg tooconfigure hello andra domänkontrollanten:</span><span class="sxs-lookup"><span data-stu-id="e1703-360">Follow these steps tooconfigure hello second domain controller:</span></span>

1. <span data-ttu-id="e1703-361">Öppna hello i hello portal **SQL-hög tillgänglighet-RG** resursgrupp och välj hello **ad-sekundär-dc** datorn.</span><span class="sxs-lookup"><span data-stu-id="e1703-361">In hello portal, open hello **SQL-HA-RG** resource group and select hello **ad-secondary-dc** machine.</span></span> <span data-ttu-id="e1703-362">På hello **ad-sekundär-dc** bladet, klickar du på **Anslut** tooopen en RDP-filen för fjärråtkomst till skrivbordet.</span><span class="sxs-lookup"><span data-stu-id="e1703-362">On hello **ad-secondary-dc** blade, click **Connect** tooopen an RDP file for remote desktop access.</span></span>
2. <span data-ttu-id="e1703-363">Logga in toohello VM med dina konfigurerade administratörskonto (**BUILTIN\DomainAdmin**) och lösenord (**Contoso! 0000**).</span><span class="sxs-lookup"><span data-stu-id="e1703-363">Sign in toohello VM by using your configured administrator account (**BUILTIN\DomainAdmin**) and password (**Contoso!0000**).</span></span>
3. <span data-ttu-id="e1703-364">Ändra hello önskad DNS-adress toohello serveradress för hello-domänkontrollant.</span><span class="sxs-lookup"><span data-stu-id="e1703-364">Change hello preferred DNS server address toohello address of hello domain controller.</span></span>
4. <span data-ttu-id="e1703-365">I **nätverks- och delningscenter**, klicka på hello nätverksgränssnitt.</span><span class="sxs-lookup"><span data-stu-id="e1703-365">In **Network and Sharing Center**, click hello network interface.</span></span>
   <span data-ttu-id="e1703-366">![Nätverksgränssnitt](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/26-networkinterface.png)</span><span class="sxs-lookup"><span data-stu-id="e1703-366">![Network interface](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/26-networkinterface.png)</span></span>

5. <span data-ttu-id="e1703-367">Klicka på **Egenskaper**.</span><span class="sxs-lookup"><span data-stu-id="e1703-367">Click **Properties**.</span></span>
6. <span data-ttu-id="e1703-368">Välj **Internet Protocol Version 4 (TCP/IPv4)** och på **egenskaper**.</span><span class="sxs-lookup"><span data-stu-id="e1703-368">Select **Internet Protocol Version 4 (TCP/IPv4)** and click **Properties**.</span></span>
7. <span data-ttu-id="e1703-369">Välj **Använd hello följande DNS-serveradresser** och ange hello-adressen för hello primära domänkontrollanten i **önskad DNS-server**.</span><span class="sxs-lookup"><span data-stu-id="e1703-369">Select **Use hello following DNS server addresses** and specify hello address of hello primary domain controller in **Preferred DNS server**.</span></span>
8. <span data-ttu-id="e1703-370">Klicka på **OK**, och sedan **Stäng** toocommit hello ändringar.</span><span class="sxs-lookup"><span data-stu-id="e1703-370">Click **OK**, and then **Close** toocommit hello changes.</span></span> <span data-ttu-id="e1703-371">Du är nu kan toojoin hello VM för**corp.contoso.com**.</span><span class="sxs-lookup"><span data-stu-id="e1703-371">You are now able toojoin hello VM too**corp.contoso.com**.</span></span>

   >[!IMPORTANT]
   ><span data-ttu-id="e1703-372">Om du förlorar anslutningen hello tooyour Fjärrskrivbord när du har ändrat hello DNS-inställningen går toohello virtuella Azure-portalen och starta om hello-datorn.</span><span class="sxs-lookup"><span data-stu-id="e1703-372">If you lose hello connection tooyour remote desktop after changing hello DNS setting, go toohello Azure portal and restart hello virtual machine.</span></span>

9. <span data-ttu-id="e1703-373">Hello remote desktop toohello sekundär domänkontrollant, öppna **instrumentpanelen Serverhanteraren**.</span><span class="sxs-lookup"><span data-stu-id="e1703-373">From hello remote desktop toohello secondary domain controller, open **Server Manager Dashboard**.</span></span>
10. <span data-ttu-id="e1703-374">Klicka på hello **Lägg till roller och funktioner** länk på hello instrumentpanelen.</span><span class="sxs-lookup"><span data-stu-id="e1703-374">Click hello **Add roles and features** link on hello dashboard.</span></span>

    ![Server Manager - Lägg till roller](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/22-addfeatures.png)
11. <span data-ttu-id="e1703-376">Välj **nästa** tills toohello **serverroller** avsnitt.</span><span class="sxs-lookup"><span data-stu-id="e1703-376">Select **Next** until you get toohello **Server Roles** section.</span></span>
12. <span data-ttu-id="e1703-377">Välj hello **Active Directory Domain Services** och **DNS-Server** roller.</span><span class="sxs-lookup"><span data-stu-id="e1703-377">Select hello **Active Directory Domain Services** and **DNS Server** roles.</span></span> <span data-ttu-id="e1703-378">När du uppmanas att lägga till eventuella ytterligare funktioner som krävs av rollerna.</span><span class="sxs-lookup"><span data-stu-id="e1703-378">When you're prompted, add any additional features that are required by these roles.</span></span>
13. <span data-ttu-id="e1703-379">När hello funktioner Slutför installation, returnerar toohello **Serverhanteraren** instrumentpanelen.</span><span class="sxs-lookup"><span data-stu-id="e1703-379">After hello features finish installing, return toohello **Server Manager** dashboard.</span></span>
14. <span data-ttu-id="e1703-380">Välj ny hello **AD DS** alternativet på hello vänstra fönstret.</span><span class="sxs-lookup"><span data-stu-id="e1703-380">Select hello new **AD DS** option on hello left-hand pane.</span></span>
15. <span data-ttu-id="e1703-381">Klicka på hello **mer** länk hello gul varning-fältet.</span><span class="sxs-lookup"><span data-stu-id="e1703-381">Click hello **More** link on hello yellow warning bar.</span></span>
16. <span data-ttu-id="e1703-382">I hello **åtgärd** kolumn i hello **alla Server aktivitetsinformation** dialogrutan klickar du på **befordra den här servern tooa domänkontrollanten**.</span><span class="sxs-lookup"><span data-stu-id="e1703-382">In hello **Action** column of hello **All Server Task Details** dialog, click **Promote this server tooa domain controller**.</span></span>
17. <span data-ttu-id="e1703-383">Under **distributionskonfigurationen**väljer **lägga till en befintlig domän för domain controller tooan**.</span><span class="sxs-lookup"><span data-stu-id="e1703-383">Under **Deployment Configuration**, select **Add a domain controller tooan existing domain**.</span></span>
   <span data-ttu-id="e1703-384">![Distributionskonfiguration](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/28-deploymentconfig.png)</span><span class="sxs-lookup"><span data-stu-id="e1703-384">![Deployment configuration](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/28-deploymentconfig.png)</span></span>
18. <span data-ttu-id="e1703-385">Klicka på **Välj**.</span><span class="sxs-lookup"><span data-stu-id="e1703-385">Click **Select**.</span></span>
19. <span data-ttu-id="e1703-386">Ansluta med hjälp av hello administratörskonto (**CORP. Contoso.COM\domainadmin**) och lösenord (**Contoso! 0000**).</span><span class="sxs-lookup"><span data-stu-id="e1703-386">Connect by using hello administrator account (**CORP.CONTOSO.COM\domainadmin**) and password (**Contoso!0000**).</span></span>
20. <span data-ttu-id="e1703-387">I **Välj en domän från hello skog**, klickar du på din domän och klicka sedan på **OK**.</span><span class="sxs-lookup"><span data-stu-id="e1703-387">In **Select a domain from hello forest**, click your domain, and then click **OK**.</span></span>
21. <span data-ttu-id="e1703-388">I **alternativ för domänkontrollant**, använda hello standardvärden och ange DSRM-lösenordet.</span><span class="sxs-lookup"><span data-stu-id="e1703-388">In **Domain Controller Options**, use hello default values and set a DSRM password.</span></span>

   >[!NOTE]
   ><span data-ttu-id="e1703-389">Hej **DNS-alternativ** sida kan varna dig att det inte går att skapa en delegering för den här DNS-servern.</span><span class="sxs-lookup"><span data-stu-id="e1703-389">hello **DNS Options** page might warn you that a delegation for this DNS server can't be created.</span></span> <span data-ttu-id="e1703-390">Du kan ignorera den här varningen i icke-produktionsmiljöer.</span><span class="sxs-lookup"><span data-stu-id="e1703-390">You can ignore this warning in non-production environments.</span></span>
22. <span data-ttu-id="e1703-391">Klicka på **nästa** tills hello dialogrutan hello **krav** kontrollera.</span><span class="sxs-lookup"><span data-stu-id="e1703-391">Click **Next** until hello dialog reaches hello **Prerequisites** check.</span></span> <span data-ttu-id="e1703-392">Klicka på **Installera**.</span><span class="sxs-lookup"><span data-stu-id="e1703-392">Then click **Install**.</span></span>

<span data-ttu-id="e1703-393">Starta om hello server när hello server har slutförts hello konfigurationsändringar.</span><span class="sxs-lookup"><span data-stu-id="e1703-393">After hello server finishes hello configuration changes, restart hello server.</span></span>

### <a name="add-hello-private-ip-address-toohello-second-domain-controller-toohello-vpn-dns-server"></a><span data-ttu-id="e1703-394">Lägg till hello privata IP-adressen toohello andra domain controller toohello VPN-DNS-Server</span><span class="sxs-lookup"><span data-stu-id="e1703-394">Add hello Private IP Address toohello second domain controller toohello VPN DNS Server</span></span>

<span data-ttu-id="e1703-395">Ändra hello DNS-Server tooinclude hello IP-adressen för hello sekundär domänkontrollant i hello Azure-portalen under virtuellt nätverk.</span><span class="sxs-lookup"><span data-stu-id="e1703-395">In hello Azure portal, under virtual network, change hello DNS Server tooinclude hello IP address of hello secondary domain controller.</span></span> <span data-ttu-id="e1703-396">Detta gör att hello DNS-tjänsten redundans.</span><span class="sxs-lookup"><span data-stu-id="e1703-396">This allows hello DNS service redundancy.</span></span>

### <span data-ttu-id="e1703-397"><a name=DomainAccounts></a>Konfigurera hello domänkonton</span><span class="sxs-lookup"><span data-stu-id="e1703-397"><a name=DomainAccounts></a> Configure hello domain accounts</span></span>

<span data-ttu-id="e1703-398">I nästa steg för hello konfigurerar du hello Active Directory-konton.</span><span class="sxs-lookup"><span data-stu-id="e1703-398">In hello next steps, you configure hello Active Directory accounts.</span></span> <span data-ttu-id="e1703-399">hello visar följande tabell hello konton:</span><span class="sxs-lookup"><span data-stu-id="e1703-399">hello following table shows hello accounts:</span></span>

| |<span data-ttu-id="e1703-400">Kontot för installation</span><span class="sxs-lookup"><span data-stu-id="e1703-400">Installation account</span></span><br/> |<span data-ttu-id="e1703-401">SQLServer-0</span><span class="sxs-lookup"><span data-stu-id="e1703-401">sqlserver-0</span></span> <br/><span data-ttu-id="e1703-402">Konto för SQL Server och SQL Agent-tjänsten</span><span class="sxs-lookup"><span data-stu-id="e1703-402">SQL Server and SQL Agent Service account</span></span> |<span data-ttu-id="e1703-403">SQLServer-1</span><span class="sxs-lookup"><span data-stu-id="e1703-403">sqlserver-1</span></span><br/><span data-ttu-id="e1703-404">Konto för SQL Server och SQL Agent-tjänsten</span><span class="sxs-lookup"><span data-stu-id="e1703-404">SQL Server and SQL Agent Service account</span></span>
| --- | --- | --- | ---
|<span data-ttu-id="e1703-405">**Förnamn**</span><span class="sxs-lookup"><span data-stu-id="e1703-405">**First Name**</span></span> |<span data-ttu-id="e1703-406">Installera</span><span class="sxs-lookup"><span data-stu-id="e1703-406">Install</span></span> |<span data-ttu-id="e1703-407">SQLSvc1</span><span class="sxs-lookup"><span data-stu-id="e1703-407">SQLSvc1</span></span> | <span data-ttu-id="e1703-408">SQLSvc2</span><span class="sxs-lookup"><span data-stu-id="e1703-408">SQLSvc2</span></span>
|<span data-ttu-id="e1703-409">**Användare SamAccountName**</span><span class="sxs-lookup"><span data-stu-id="e1703-409">**User SamAccountName**</span></span> |<span data-ttu-id="e1703-410">Installera</span><span class="sxs-lookup"><span data-stu-id="e1703-410">Install</span></span> |<span data-ttu-id="e1703-411">SQLSvc1</span><span class="sxs-lookup"><span data-stu-id="e1703-411">SQLSvc1</span></span> | <span data-ttu-id="e1703-412">SQLSvc2</span><span class="sxs-lookup"><span data-stu-id="e1703-412">SQLSvc2</span></span>

<span data-ttu-id="e1703-413">Använd följande steg toocreate hello varje konto.</span><span class="sxs-lookup"><span data-stu-id="e1703-413">Use hello following steps toocreate each account.</span></span>

1. <span data-ttu-id="e1703-414">Logga in toohello **ad primär domänkontrollant** datorn.</span><span class="sxs-lookup"><span data-stu-id="e1703-414">Sign in toohello **ad-primary-dc** machine.</span></span>
2. <span data-ttu-id="e1703-415">I **Serverhanteraren**väljer **verktyg**, och klicka sedan på **Active Directory Administrationscenter**.</span><span class="sxs-lookup"><span data-stu-id="e1703-415">In **Server Manager**, select **Tools**, and then click **Active Directory Administrative Center**.</span></span>   
3. <span data-ttu-id="e1703-416">Välj **corp (lokal)** från hello till vänster.</span><span class="sxs-lookup"><span data-stu-id="e1703-416">Select **corp (local)** from hello left pane.</span></span>
4. <span data-ttu-id="e1703-417">På hello rätt **uppgifter** väljer **ny**, och klicka sedan på **användaren**.</span><span class="sxs-lookup"><span data-stu-id="e1703-417">On hello right **Tasks** pane, select **New**, and then click **User**.</span></span>
   <span data-ttu-id="e1703-418">![Active Directory Administrationscenter](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/29-addcnewuser.png)</span><span class="sxs-lookup"><span data-stu-id="e1703-418">![Active Directory Administrative Center](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/29-addcnewuser.png)</span></span>

   >[!TIP]
   ><span data-ttu-id="e1703-419">Ange ett komplext lösenord för varje konto.</span><span class="sxs-lookup"><span data-stu-id="e1703-419">Set a complex password for each account.</span></span><br/> <span data-ttu-id="e1703-420">För icke-produktionsmiljöer, ange hello användarens konto toonever upphöra att gälla.</span><span class="sxs-lookup"><span data-stu-id="e1703-420">For non-production environments, set hello user account toonever expire.</span></span>

5. <span data-ttu-id="e1703-421">Klicka på **OK** toocreate hello användare.</span><span class="sxs-lookup"><span data-stu-id="e1703-421">Click **OK** toocreate hello user.</span></span>
6. <span data-ttu-id="e1703-422">Upprepa föregående steg för varje hello tre konton hello.</span><span class="sxs-lookup"><span data-stu-id="e1703-422">Repeat hello preceding steps for each of hello three accounts.</span></span>

### <a name="grant-hello-required-permissions-toohello-installation-account"></a><span data-ttu-id="e1703-423">Ge hello krävs behörigheter toohello installationskonto</span><span class="sxs-lookup"><span data-stu-id="e1703-423">Grant hello required permissions toohello installation account</span></span>
1. <span data-ttu-id="e1703-424">I hello **Active Directory Administrationscenter**väljer **corp (lokal)** hello vänster.</span><span class="sxs-lookup"><span data-stu-id="e1703-424">In hello **Active Directory Administrative Center**, select **corp (local)** in hello left pane.</span></span> <span data-ttu-id="e1703-425">I högra hello **uppgifter** rutan klickar du på **egenskaper**.</span><span class="sxs-lookup"><span data-stu-id="e1703-425">Then in hello right-hand **Tasks** pane, click **Properties**.</span></span>

    ![Egenskaper för CORP-användare](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/31-addcproperties.png)
2. <span data-ttu-id="e1703-427">Välj **tillägg**, och klicka sedan på hello **Avancerat** hello-knappen **säkerhet** fliken.</span><span class="sxs-lookup"><span data-stu-id="e1703-427">Select **Extensions**, and then click hello **Advanced** button on hello **Security** tab.</span></span>
3. <span data-ttu-id="e1703-428">I hello **avancerade säkerhetsinställningar för corp** dialogrutan klickar du på **Lägg till**.</span><span class="sxs-lookup"><span data-stu-id="e1703-428">In hello **Advanced Security Settings for corp** dialog, click **Add**.</span></span>
4. <span data-ttu-id="e1703-429">Klicka på **Välj en huvudansvarig**, söka efter **CORP\Install**, och klicka sedan på **OK**.</span><span class="sxs-lookup"><span data-stu-id="e1703-429">Click **Select a principal**, search for **CORP\Install**, and then click **OK**.</span></span>
5. <span data-ttu-id="e1703-430">Välj hello **läsa alla egenskaper** kryssrutan.</span><span class="sxs-lookup"><span data-stu-id="e1703-430">Select hello **Read all properties** check box.</span></span>

6. <span data-ttu-id="e1703-431">Välj hello **skapa datorobjekt** kryssrutan.</span><span class="sxs-lookup"><span data-stu-id="e1703-431">Select hello **Create Computer objects** check box.</span></span>

     ![Corp användarbehörighet](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/33-addpermissions.png)
7. <span data-ttu-id="e1703-433">Klicka på **OK**, och klicka sedan på **OK** igen.</span><span class="sxs-lookup"><span data-stu-id="e1703-433">Click **OK**, and then click **OK** again.</span></span> <span data-ttu-id="e1703-434">Stäng hello **corp** egenskapsfönstret.</span><span class="sxs-lookup"><span data-stu-id="e1703-434">Close hello **corp** properties window.</span></span>

<span data-ttu-id="e1703-435">Nu när du har konfigurerat Active Directory och hello användarobjekt, skapa två virtuella SQL Server-datorer och en vittnesserver som VM.</span><span class="sxs-lookup"><span data-stu-id="e1703-435">Now that you've finished configuring Active Directory and hello user objects, create two SQL Server VMs and a witness server VM.</span></span> <span data-ttu-id="e1703-436">Ansluta alla tre toohello-domänen.</span><span class="sxs-lookup"><span data-stu-id="e1703-436">Then join all three toohello domain.</span></span>

## <a name="create-sql-server-vms"></a><span data-ttu-id="e1703-437">Skapa virtuella SQL Server-datorer</span><span class="sxs-lookup"><span data-stu-id="e1703-437">Create SQL Server VMs</span></span>

<span data-ttu-id="e1703-438">Skapa tre ytterligare virtuella datorer.</span><span class="sxs-lookup"><span data-stu-id="e1703-438">Create three additional virtual machines.</span></span> <span data-ttu-id="e1703-439">hello lösning kräver två virtuella datorer med SQL Server-instanser.</span><span class="sxs-lookup"><span data-stu-id="e1703-439">hello solution requires two virtual machines with SQL Server instances.</span></span> <span data-ttu-id="e1703-440">En tredje virtuell dator fungerar som ett vittne.</span><span class="sxs-lookup"><span data-stu-id="e1703-440">A third virtual machine will function as a witness.</span></span> <span data-ttu-id="e1703-441">Windows Server 2016 kan använda en [molnet vittne](http://docs.microsoft.com/windows-server/failover-clustering/deploy-cloud-witness), men adressöverensstämmelse tidigare operativsystem för det här dokumentet använder en virtuell dator för ett vittne.</span><span class="sxs-lookup"><span data-stu-id="e1703-441">Windows Server 2016 can use a [cloud witness](http://docs.microsoft.com/windows-server/failover-clustering/deploy-cloud-witness), however for consistency with previous operating systems this document uses a virtual machine for a witness.</span></span>  

<span data-ttu-id="e1703-442">Överväg följande beslut deisign hello innan du fortsätter.</span><span class="sxs-lookup"><span data-stu-id="e1703-442">Before you proceed consider hello following deisign decisions.</span></span>

* <span data-ttu-id="e1703-443">**Lagring – Azure hanterade diskar**</span><span class="sxs-lookup"><span data-stu-id="e1703-443">**Storage - Azure Managed Disks**</span></span>

   <span data-ttu-id="e1703-444">Använd Azure hanterade diskar för hello den virtuella datorns lagringsutrymme.</span><span class="sxs-lookup"><span data-stu-id="e1703-444">For hello virtual machine storage, use Azure Managed Disks.</span></span> <span data-ttu-id="e1703-445">Microsoft rekommenderar hanterade diskar för virtuella datorer för SQL Server.</span><span class="sxs-lookup"><span data-stu-id="e1703-445">Microsoft recommends Managed Disks for SQL Server virtual machines.</span></span> <span data-ttu-id="e1703-446">Hanterade diskar handtag lagring hello bakgrunden.</span><span class="sxs-lookup"><span data-stu-id="e1703-446">Managed Disks handles storage behind hello scenes.</span></span> <span data-ttu-id="e1703-447">Dessutom när virtuella datorer med hanterade diskar är i hello samma tillgänglighetsuppsättning, Azure distribuerar hello lagring resurser tooprovide lämplig redundans.</span><span class="sxs-lookup"><span data-stu-id="e1703-447">In addition, when virtual machines with Managed Disks are in hello same availability set, Azure distributes hello storage resources tooprovide appropriate redundancy.</span></span> <span data-ttu-id="e1703-448">Mer information finns i [Översikt över Azure Managed Disks](../managed-disks-overview.md).</span><span class="sxs-lookup"><span data-stu-id="e1703-448">For additional information, see [Azure Managed Disks Overview](../managed-disks-overview.md).</span></span> <span data-ttu-id="e1703-449">Närmare information om hanterade diskar i en tillgänglighetsuppsättning, se [använda hanterade diskar för virtuella datorer i en tillgänglighetsuppsättning](../manage-availability.md#use-managed-disks-for-vms-in-an-availability-set).</span><span class="sxs-lookup"><span data-stu-id="e1703-449">For specifics about managed disks in an availability set, see [Use Managed Disks for VMs in an availability set](../manage-availability.md#use-managed-disks-for-vms-in-an-availability-set).</span></span>

* <span data-ttu-id="e1703-450">**Nätverk - privata IP-adresser i produktion**</span><span class="sxs-lookup"><span data-stu-id="e1703-450">**Network - Private IP addresses in production**</span></span>

   <span data-ttu-id="e1703-451">Den här kursen använder offentliga IP-adresser för hello virtuella datorer.</span><span class="sxs-lookup"><span data-stu-id="e1703-451">For hello virtual machines, this tutorial uses public IP addresses.</span></span> <span data-ttu-id="e1703-452">Detta gör att fjärranslutning direkt toohello virtuella datorn via hello internet - det underlättar konfigurationssteg.</span><span class="sxs-lookup"><span data-stu-id="e1703-452">This enables remote connection directly toohello virtual machine over hello internet - it makes configuration steps easier.</span></span> <span data-ttu-id="e1703-453">I produktionsmiljöer rekommenderas endast privata IP-adresser i ordning tooreduce hello sårbarhet av hello SQL Server-instansen Virtuella datorresursen.</span><span class="sxs-lookup"><span data-stu-id="e1703-453">In production environments, Microsoft recommends only private IP addresses in order tooreduce hello vulnerability footprint of hello SQL Server instance VM resource.</span></span>

### <a name="create-and-configure-hello-sql-server-vms"></a><span data-ttu-id="e1703-454">Skapa och konfigurera hello SQL Server-datorer</span><span class="sxs-lookup"><span data-stu-id="e1703-454">Create and configure hello SQL Server VMs</span></span>
<span data-ttu-id="e1703-455">Skapa därefter tre virtuella datorer – två virtuella SQL Server-datorer och en virtuell dator för en ny klusternod.</span><span class="sxs-lookup"><span data-stu-id="e1703-455">Next, create three VMs--two SQL Server VMs and a VM for an additional cluster node.</span></span> <span data-ttu-id="e1703-456">toocreate hello virtuella datorer, gå tillbaka toohello **SQL-hög tillgänglighet-RG** resursgrupp, klickar du på **Lägg till**, söka efter hello lämpliga galleriobjektet, klickar du på **virtuella**, och sedan Klicka på **från galleriet**.</span><span class="sxs-lookup"><span data-stu-id="e1703-456">toocreate each of hello VMs, go back toohello **SQL-HA-RG** resource group, click **Add**, search for hello appropriate gallery item, click **Virtual Machine**, and then click **From Gallery**.</span></span> <span data-ttu-id="e1703-457">Använd hello information i följande tabell toohelp som du skapar virtuella datorer hello hello:</span><span class="sxs-lookup"><span data-stu-id="e1703-457">Use hello information in hello following table toohelp you create hello VMs:</span></span>


| <span data-ttu-id="e1703-458">Sidan</span><span class="sxs-lookup"><span data-stu-id="e1703-458">Page</span></span> | <span data-ttu-id="e1703-459">VM1</span><span class="sxs-lookup"><span data-stu-id="e1703-459">VM1</span></span> | <span data-ttu-id="e1703-460">VM2</span><span class="sxs-lookup"><span data-stu-id="e1703-460">VM2</span></span> | <span data-ttu-id="e1703-461">VM3</span><span class="sxs-lookup"><span data-stu-id="e1703-461">VM3</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="e1703-462">Välj hello lämpliga galleriobjektet</span><span class="sxs-lookup"><span data-stu-id="e1703-462">Select hello appropriate gallery item</span></span> |<span data-ttu-id="e1703-463">**Windows Server 2016 Datacenter**</span><span class="sxs-lookup"><span data-stu-id="e1703-463">**Windows Server 2016 Datacenter**</span></span> |<span data-ttu-id="e1703-464">**SQL Server 2016 SP1 Enterprise på Windows Server 2016**</span><span class="sxs-lookup"><span data-stu-id="e1703-464">**SQL Server 2016 SP1 Enterprise on Windows Server 2016**</span></span> |<span data-ttu-id="e1703-465">**SQL Server 2016 SP1 Enterprise på Windows Server 2016**</span><span class="sxs-lookup"><span data-stu-id="e1703-465">**SQL Server 2016 SP1 Enterprise on Windows Server 2016**</span></span> |
| <span data-ttu-id="e1703-466">Konfiguration av virtuell dator **grunderna**</span><span class="sxs-lookup"><span data-stu-id="e1703-466">Virtual machine configuration **Basics**</span></span> |<span data-ttu-id="e1703-467">**Namnet** = klustret fsw</span><span class="sxs-lookup"><span data-stu-id="e1703-467">**Name** = cluster-fsw</span></span><br/><span data-ttu-id="e1703-468">**Användarnamnet** = DomainAdmin</span><span class="sxs-lookup"><span data-stu-id="e1703-468">**User Name** = DomainAdmin</span></span><br/><span data-ttu-id="e1703-469">**Lösenordet** = Contoso! 0000</span><span class="sxs-lookup"><span data-stu-id="e1703-469">**Password** = Contoso!0000</span></span><br/><span data-ttu-id="e1703-470">**Prenumerationen** = din prenumeration</span><span class="sxs-lookup"><span data-stu-id="e1703-470">**Subscription** = Your subscription</span></span><br/><span data-ttu-id="e1703-471">**Resursgruppen** = SQL-hög tillgänglighet-RG</span><span class="sxs-lookup"><span data-stu-id="e1703-471">**Resource group** = SQL-HA-RG</span></span><br/><span data-ttu-id="e1703-472">**Plats** = azure-plats</span><span class="sxs-lookup"><span data-stu-id="e1703-472">**Location** = Your azure location</span></span> |<span data-ttu-id="e1703-473">**Namnet** = sqlserver-0</span><span class="sxs-lookup"><span data-stu-id="e1703-473">**Name** = sqlserver-0</span></span><br/><span data-ttu-id="e1703-474">**Användarnamnet** = DomainAdmin</span><span class="sxs-lookup"><span data-stu-id="e1703-474">**User Name** = DomainAdmin</span></span><br/><span data-ttu-id="e1703-475">**Lösenordet** = Contoso! 0000</span><span class="sxs-lookup"><span data-stu-id="e1703-475">**Password** = Contoso!0000</span></span><br/><span data-ttu-id="e1703-476">**Prenumerationen** = din prenumeration</span><span class="sxs-lookup"><span data-stu-id="e1703-476">**Subscription** = Your subscription</span></span><br/><span data-ttu-id="e1703-477">**Resursgruppen** = SQL-hög tillgänglighet-RG</span><span class="sxs-lookup"><span data-stu-id="e1703-477">**Resource group** = SQL-HA-RG</span></span><br/><span data-ttu-id="e1703-478">**Plats** = azure-plats</span><span class="sxs-lookup"><span data-stu-id="e1703-478">**Location** = Your azure location</span></span> |<span data-ttu-id="e1703-479">**Namnet** = sqlserver-1</span><span class="sxs-lookup"><span data-stu-id="e1703-479">**Name** = sqlserver-1</span></span><br/><span data-ttu-id="e1703-480">**Användarnamnet** = DomainAdmin</span><span class="sxs-lookup"><span data-stu-id="e1703-480">**User Name** = DomainAdmin</span></span><br/><span data-ttu-id="e1703-481">**Lösenordet** = Contoso! 0000</span><span class="sxs-lookup"><span data-stu-id="e1703-481">**Password** = Contoso!0000</span></span><br/><span data-ttu-id="e1703-482">**Prenumerationen** = din prenumeration</span><span class="sxs-lookup"><span data-stu-id="e1703-482">**Subscription** = Your subscription</span></span><br/><span data-ttu-id="e1703-483">**Resursgruppen** = SQL-hög tillgänglighet-RG</span><span class="sxs-lookup"><span data-stu-id="e1703-483">**Resource group** = SQL-HA-RG</span></span><br/><span data-ttu-id="e1703-484">**Plats** = azure-plats</span><span class="sxs-lookup"><span data-stu-id="e1703-484">**Location** = Your azure location</span></span> |
| <span data-ttu-id="e1703-485">Konfiguration av virtuell dator **storlek**</span><span class="sxs-lookup"><span data-stu-id="e1703-485">Virtual machine configuration **Size**</span></span> |<span data-ttu-id="e1703-486">**STORLEK** = DS1\_V2 (1 kärna, 3.5 GB)</span><span class="sxs-lookup"><span data-stu-id="e1703-486">**SIZE** = DS1\_V2 (1 core, 3.5 GB)</span></span> |<span data-ttu-id="e1703-487">**STORLEK** = DS2\_V2 (2 kärnor, 7 GB)</span><span class="sxs-lookup"><span data-stu-id="e1703-487">**SIZE** = DS2\_V2 (2 cores, 7 GB)</span></span></br><span data-ttu-id="e1703-488">hello storlek måste ha stöd för SSD-lagring (stöd för Premium-diskar.</span><span class="sxs-lookup"><span data-stu-id="e1703-488">hello size must support SSD storage (Premium disk support.</span></span> <span data-ttu-id="e1703-489">))</span><span class="sxs-lookup"><span data-stu-id="e1703-489">))</span></span> |<span data-ttu-id="e1703-490">**STORLEK** = DS2\_V2 (2 kärnor, 7 GB)</span><span class="sxs-lookup"><span data-stu-id="e1703-490">**SIZE** = DS2\_V2 (2 cores, 7 GB)</span></span> |
| <span data-ttu-id="e1703-491">Konfiguration av virtuell dator **inställningar**</span><span class="sxs-lookup"><span data-stu-id="e1703-491">Virtual machine configuration **Settings**</span></span> |<span data-ttu-id="e1703-492">**Lagring**: Använd hanterade diskar.</span><span class="sxs-lookup"><span data-stu-id="e1703-492">**Storage**: Use managed disks.</span></span><br/><span data-ttu-id="e1703-493">**Virtuellt nätverk** = autoHAVNET</span><span class="sxs-lookup"><span data-stu-id="e1703-493">**Virtual network** = autoHAVNET</span></span><br/><span data-ttu-id="e1703-494">**Undernät** = sqlsubnet(10.1.1.0/24)</span><span class="sxs-lookup"><span data-stu-id="e1703-494">**Subnet** = sqlsubnet(10.1.1.0/24)</span></span><br/><span data-ttu-id="e1703-495">**Offentliga IP-adressen** skapas automatiskt.</span><span class="sxs-lookup"><span data-stu-id="e1703-495">**Public IP address** automatically generated.</span></span><br/><span data-ttu-id="e1703-496">**Nätverkssäkerhetsgruppen** = None</span><span class="sxs-lookup"><span data-stu-id="e1703-496">**Network security group** = None</span></span><br/><span data-ttu-id="e1703-497">**Övervaka diagnostik** = aktiverat</span><span class="sxs-lookup"><span data-stu-id="e1703-497">**Monitoring Diagnostics** = Enabled</span></span><br/><span data-ttu-id="e1703-498">**Diagnostiklagringskonto** = Använd en automatiskt genererad storage-konto</span><span class="sxs-lookup"><span data-stu-id="e1703-498">**Diagnostics storage account** = Use an automatically generated storage account</span></span><br/><span data-ttu-id="e1703-499">**Tillgänglighetsuppsättningen** = sqlAvailabilitySet</span><span class="sxs-lookup"><span data-stu-id="e1703-499">**Availability set** = sqlAvailabilitySet</span></span><br/> |<span data-ttu-id="e1703-500">**Lagring**: Använd hanterade diskar.</span><span class="sxs-lookup"><span data-stu-id="e1703-500">**Storage**: Use managed disks.</span></span><br/><span data-ttu-id="e1703-501">**Virtuellt nätverk** = autoHAVNET</span><span class="sxs-lookup"><span data-stu-id="e1703-501">**Virtual network** = autoHAVNET</span></span><br/><span data-ttu-id="e1703-502">**Undernät** = sqlsubnet(10.1.1.0/24)</span><span class="sxs-lookup"><span data-stu-id="e1703-502">**Subnet** = sqlsubnet(10.1.1.0/24)</span></span><br/><span data-ttu-id="e1703-503">**Offentliga IP-adressen** skapas automatiskt.</span><span class="sxs-lookup"><span data-stu-id="e1703-503">**Public IP address** automatically generated.</span></span><br/><span data-ttu-id="e1703-504">**Nätverkssäkerhetsgruppen** = None</span><span class="sxs-lookup"><span data-stu-id="e1703-504">**Network security group** = None</span></span><br/><span data-ttu-id="e1703-505">**Övervaka diagnostik** = aktiverat</span><span class="sxs-lookup"><span data-stu-id="e1703-505">**Monitoring Diagnostics** = Enabled</span></span><br/><span data-ttu-id="e1703-506">**Diagnostiklagringskonto** = Använd en automatiskt genererad storage-konto</span><span class="sxs-lookup"><span data-stu-id="e1703-506">**Diagnostics storage account** = Use an automatically generated storage account</span></span><br/><span data-ttu-id="e1703-507">**Tillgänglighetsuppsättningen** = sqlAvailabilitySet</span><span class="sxs-lookup"><span data-stu-id="e1703-507">**Availability set** = sqlAvailabilitySet</span></span><br/> |<span data-ttu-id="e1703-508">**Lagring**: Använd hanterade diskar.</span><span class="sxs-lookup"><span data-stu-id="e1703-508">**Storage**: Use managed disks.</span></span><br/><span data-ttu-id="e1703-509">**Virtuellt nätverk** = autoHAVNET</span><span class="sxs-lookup"><span data-stu-id="e1703-509">**Virtual network** = autoHAVNET</span></span><br/><span data-ttu-id="e1703-510">**Undernät** = sqlsubnet(10.1.1.0/24)</span><span class="sxs-lookup"><span data-stu-id="e1703-510">**Subnet** = sqlsubnet(10.1.1.0/24)</span></span><br/><span data-ttu-id="e1703-511">**Offentliga IP-adressen** skapas automatiskt.</span><span class="sxs-lookup"><span data-stu-id="e1703-511">**Public IP address** automatically generated.</span></span><br/><span data-ttu-id="e1703-512">**Nätverkssäkerhetsgruppen** = None</span><span class="sxs-lookup"><span data-stu-id="e1703-512">**Network security group** = None</span></span><br/><span data-ttu-id="e1703-513">**Övervaka diagnostik** = aktiverat</span><span class="sxs-lookup"><span data-stu-id="e1703-513">**Monitoring Diagnostics** = Enabled</span></span><br/><span data-ttu-id="e1703-514">**Diagnostiklagringskonto** = Använd en automatiskt genererad storage-konto</span><span class="sxs-lookup"><span data-stu-id="e1703-514">**Diagnostics storage account** = Use an automatically generated storage account</span></span><br/><span data-ttu-id="e1703-515">**Tillgänglighetsuppsättningen** = sqlAvailabilitySet</span><span class="sxs-lookup"><span data-stu-id="e1703-515">**Availability set** = sqlAvailabilitySet</span></span><br/> |
| <span data-ttu-id="e1703-516">Konfiguration av virtuell dator **SQL Server-inställningar**</span><span class="sxs-lookup"><span data-stu-id="e1703-516">Virtual machine configuration **SQL Server settings**</span></span> |<span data-ttu-id="e1703-517">Inte tillämpligt</span><span class="sxs-lookup"><span data-stu-id="e1703-517">Not applicable</span></span> |<span data-ttu-id="e1703-518">**SQL-anslutningen** = privat (inom Virtual Network)</span><span class="sxs-lookup"><span data-stu-id="e1703-518">**SQL connectivity** = Private (within Virtual Network)</span></span><br/><span data-ttu-id="e1703-519">**Port** = 1433</span><span class="sxs-lookup"><span data-stu-id="e1703-519">**Port** = 1433</span></span><br/><span data-ttu-id="e1703-520">**SQL-autentisering** = inaktivera</span><span class="sxs-lookup"><span data-stu-id="e1703-520">**SQL Authentication** = Disable</span></span><br/><span data-ttu-id="e1703-521">**Lagringskonfigurationen** = Allmänt</span><span class="sxs-lookup"><span data-stu-id="e1703-521">**Storage configuration** = General</span></span><br/><span data-ttu-id="e1703-522">**Automatisk uppdatering** = söndag 2:00</span><span class="sxs-lookup"><span data-stu-id="e1703-522">**Automated patching** = Sunday at 2:00</span></span><br/><span data-ttu-id="e1703-523">**Automatisk säkerhetskopiering** = inaktiverad</span><span class="sxs-lookup"><span data-stu-id="e1703-523">**Automated backup** = Disabled</span></span></br><span data-ttu-id="e1703-524">**Azure Key Vault-integrering** = inaktiverad</span><span class="sxs-lookup"><span data-stu-id="e1703-524">**Azure Key Vault integration** = Disabled</span></span> |<span data-ttu-id="e1703-525">**SQL-anslutningen** = privat (inom Virtual Network)</span><span class="sxs-lookup"><span data-stu-id="e1703-525">**SQL connectivity** = Private (within Virtual Network)</span></span><br/><span data-ttu-id="e1703-526">**Port** = 1433</span><span class="sxs-lookup"><span data-stu-id="e1703-526">**Port** = 1433</span></span><br/><span data-ttu-id="e1703-527">**SQL-autentisering** = inaktivera</span><span class="sxs-lookup"><span data-stu-id="e1703-527">**SQL Authentication** = Disable</span></span><br/><span data-ttu-id="e1703-528">**Lagringskonfigurationen** = Allmänt</span><span class="sxs-lookup"><span data-stu-id="e1703-528">**Storage configuration** = General</span></span><br/><span data-ttu-id="e1703-529">**Automatisk uppdatering** = söndag 2:00</span><span class="sxs-lookup"><span data-stu-id="e1703-529">**Automated patching** = Sunday at 2:00</span></span><br/><span data-ttu-id="e1703-530">**Automatisk säkerhetskopiering** = inaktiverad</span><span class="sxs-lookup"><span data-stu-id="e1703-530">**Automated backup** = Disabled</span></span></br><span data-ttu-id="e1703-531">**Azure Key Vault-integrering** = inaktiverad</span><span class="sxs-lookup"><span data-stu-id="e1703-531">**Azure Key Vault integration** = Disabled</span></span> |

<br/>

> [!NOTE]
> <span data-ttu-id="e1703-532">Hej datorstorlekar föreslås här är avsedda för att testa Tillgänglighetsgrupper i virtuella Azure-datorer.</span><span class="sxs-lookup"><span data-stu-id="e1703-532">hello machine sizes suggested here are meant for testing availability groups in Azure VMs.</span></span> <span data-ttu-id="e1703-533">Hello bästa prestanda på produktionsarbetsbelastningar finns hello rekommendationer för SQL Server-datorstorlekar och konfigurationen i [prestandarelaterade Metodtips för SQL Server på virtuella Azure-datorer](virtual-machines-windows-sql-performance.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).</span><span class="sxs-lookup"><span data-stu-id="e1703-533">For hello best performance on production workloads, see hello recommendations for SQL Server machine sizes and configuration in [Performance best practices for SQL Server in Azure virtual machines](virtual-machines-windows-sql-performance.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).</span></span>
>
>

<span data-ttu-id="e1703-534">När hello tre virtuella datorer är helt etablerad, måste toojoin dem toohello **corp.contoso.com** domän och bevilja CORP\Install administratörsbehörighet toohello datorer.</span><span class="sxs-lookup"><span data-stu-id="e1703-534">After hello three VMs are fully provisioned, you need toojoin them toohello **corp.contoso.com** domain and grant CORP\Install administrative rights toohello machines.</span></span>

### <span data-ttu-id="e1703-535"><a name="joinDomain"></a>Anslut till hello servrar toohello domän</span><span class="sxs-lookup"><span data-stu-id="e1703-535"><a name="joinDomain"></a>Join hello servers toohello domain</span></span>

<span data-ttu-id="e1703-536">Du är nu kan toojoin hello virtuella datorer för**corp.contoso.com**. Delar hello följande för både hello SQL Server-datorer och hello vittnesserver:</span><span class="sxs-lookup"><span data-stu-id="e1703-536">You're now able toojoin hello VMs too**corp.contoso.com**. Do hello following for both hello SQL Server VMs and hello file share witness server:</span></span>

1. <span data-ttu-id="e1703-537">Fjärransluta toohello virtuell dator med **BUILTIN\DomainAdmin**.</span><span class="sxs-lookup"><span data-stu-id="e1703-537">Remotely connect toohello virtual machine with **BUILTIN\DomainAdmin**.</span></span>
2. <span data-ttu-id="e1703-538">I **Serverhanteraren**, klickar du på **lokal Server**.</span><span class="sxs-lookup"><span data-stu-id="e1703-538">In **Server Manager**, click **Local Server**.</span></span>
3. <span data-ttu-id="e1703-539">Klicka på hello **arbetsgrupp** länk.</span><span class="sxs-lookup"><span data-stu-id="e1703-539">Click hello **WORKGROUP** link.</span></span>
4. <span data-ttu-id="e1703-540">I hello **datornamn** klickar du på **ändra**.</span><span class="sxs-lookup"><span data-stu-id="e1703-540">In hello **Computer Name** section, click **Change**.</span></span>
5. <span data-ttu-id="e1703-541">Välj hello **domän** kryssrutan och ange **corp.contoso.com** i hello textruta.</span><span class="sxs-lookup"><span data-stu-id="e1703-541">Select hello **Domain** check box and type **corp.contoso.com** in hello text box.</span></span> <span data-ttu-id="e1703-542">Klicka på **OK**.</span><span class="sxs-lookup"><span data-stu-id="e1703-542">Click **OK**.</span></span>
6. <span data-ttu-id="e1703-543">I hello **Windows-säkerhet** popup dialogrutan Ange hello autentiseringsuppgifter för hello standard domänadministratörskonto (**CORP\DomainAdmin**) och hello lösenord (**Contoso! 0000**).</span><span class="sxs-lookup"><span data-stu-id="e1703-543">In hello **Windows Security** popup dialog, specify hello credentials for hello default domain administrator account (**CORP\DomainAdmin**) and hello password (**Contoso!0000**).</span></span>
7. <span data-ttu-id="e1703-544">När du ser ”Välkommen toohello corp.contoso.com domänen” hello-meddelande, klickar du på **OK**.</span><span class="sxs-lookup"><span data-stu-id="e1703-544">When you see hello "Welcome toohello corp.contoso.com domain" message, click **OK**.</span></span>
8. <span data-ttu-id="e1703-545">Klicka på **Stäng**, och klicka sedan på **starta om nu** i dialogrutan för hello popup-fönster.</span><span class="sxs-lookup"><span data-stu-id="e1703-545">Click **Close**, and then click **Restart Now** in hello popup dialog.</span></span>

### <a name="add-hello-corpinstall-user-as-an-administrator-on-each-cluster-vm"></a><span data-ttu-id="e1703-546">Lägg till hello Corp\Install användaren som administratör på varje kluster VM</span><span class="sxs-lookup"><span data-stu-id="e1703-546">Add hello Corp\Install user as an administrator on each cluster VM</span></span>

<span data-ttu-id="e1703-547">Varje virtuell dator startar om som en medlem i hello domän och lägga till **CORP\Install** som medlem i gruppen lokala administratörer för hello.</span><span class="sxs-lookup"><span data-stu-id="e1703-547">After each virtual machine restarts as a member of hello domain, add **CORP\Install** as a member of hello local administrators group.</span></span>

1. <span data-ttu-id="e1703-548">Vänta tills hello VM har startats om och sedan starta hello RDP-filen igen från hello primär domän controller toosign i för**sqlserver-0** med hjälp av hello **CORP\DomainAdmin** konto.</span><span class="sxs-lookup"><span data-stu-id="e1703-548">Wait until hello VM is restarted, then launch hello RDP file again from hello primary domain controller toosign in too**sqlserver-0** by using hello **CORP\DomainAdmin** account.</span></span>
   >[!TIP]
   ><span data-ttu-id="e1703-549">Kontrollera att du loggar in med hello domänadministratörskonto.</span><span class="sxs-lookup"><span data-stu-id="e1703-549">Make sure that you sign in with hello domain administrator account.</span></span> <span data-ttu-id="e1703-550">I föregående steg hello använde hello i inbyggda administratörskontot.</span><span class="sxs-lookup"><span data-stu-id="e1703-550">In hello previous steps, you were using hello BUILT IN administrator account.</span></span> <span data-ttu-id="e1703-551">Nu hello servern finns i hello domän, använda hello domänkonto.</span><span class="sxs-lookup"><span data-stu-id="e1703-551">Now that hello server is in hello domain, use hello domain account.</span></span> <span data-ttu-id="e1703-552">Ange i RDP-session *domän*\\*användarnamn*.</span><span class="sxs-lookup"><span data-stu-id="e1703-552">In your RDP session, specify *DOMAIN*\\*username*.</span></span>

2. <span data-ttu-id="e1703-553">I **Serverhanteraren**väljer **verktyg**, och klicka sedan på **Datorhantering**.</span><span class="sxs-lookup"><span data-stu-id="e1703-553">In **Server Manager**, select **Tools**, and then click **Computer Management**.</span></span>
3. <span data-ttu-id="e1703-554">I hello **Datorhantering** fönstret expanderar **lokala användare och grupper**, och välj sedan **grupper**.</span><span class="sxs-lookup"><span data-stu-id="e1703-554">In hello **Computer Management** window, expand **Local Users and Groups**, and then select **Groups**.</span></span>
4. <span data-ttu-id="e1703-555">Dubbelklicka på hello **administratörer** grupp.</span><span class="sxs-lookup"><span data-stu-id="e1703-555">Double-click hello **Administrators** group.</span></span>
5. <span data-ttu-id="e1703-556">I hello **egenskaper för administratörer** dialogrutan klickar du på hello **Lägg till** knappen.</span><span class="sxs-lookup"><span data-stu-id="e1703-556">In hello **Administrators Properties** dialog, click hello **Add** button.</span></span>
6. <span data-ttu-id="e1703-557">Ange hello användare **CORP\Install**, och klicka sedan på **OK**.</span><span class="sxs-lookup"><span data-stu-id="e1703-557">Enter hello user **CORP\Install**, and then click **OK**.</span></span>
7. <span data-ttu-id="e1703-558">Klicka på **OK** tooclose hello **Administratörsegenskaper** dialogrutan.</span><span class="sxs-lookup"><span data-stu-id="e1703-558">Click **OK** tooclose hello **Administrator Properties** dialog.</span></span>
8. <span data-ttu-id="e1703-559">Upprepa föregående steg för hello på **sqlserver-1** och **klustret fsw**.</span><span class="sxs-lookup"><span data-stu-id="e1703-559">Repeat hello previous steps on **sqlserver-1** and **cluster-fsw**.</span></span>

### <span data-ttu-id="e1703-560"><a name="setServiceAccount"></a>Ange hello SQL Server-tjänstkonton</span><span class="sxs-lookup"><span data-stu-id="e1703-560"><a name="setServiceAccount"></a>Set hello SQL Server service accounts</span></span>

<span data-ttu-id="e1703-561">Ange hello SQL Server-tjänstkontot på varje SQL Server-VM.</span><span class="sxs-lookup"><span data-stu-id="e1703-561">On each SQL Server VM, set hello SQL Server service account.</span></span> <span data-ttu-id="e1703-562">Använd hello konton som du skapade när du [konfigurerats hello domänkonton](#DomainAccounts).</span><span class="sxs-lookup"><span data-stu-id="e1703-562">Use hello accounts that you created when you [configured hello domain accounts](#DomainAccounts).</span></span>

1. <span data-ttu-id="e1703-563">Öppna **SQL Server Configuration Manager**.</span><span class="sxs-lookup"><span data-stu-id="e1703-563">Open **SQL Server Configuration Manager**.</span></span>
2. <span data-ttu-id="e1703-564">Högerklicka på hello SQL Server-tjänsten och klicka sedan på **egenskaper**.</span><span class="sxs-lookup"><span data-stu-id="e1703-564">Right-click hello SQL Server service, and then click **Properties**.</span></span>
3. <span data-ttu-id="e1703-565">Ange hello konto och lösenord.</span><span class="sxs-lookup"><span data-stu-id="e1703-565">Set hello account and password.</span></span>
4. <span data-ttu-id="e1703-566">Upprepa dessa steg på hello andra SQL Server-VM.</span><span class="sxs-lookup"><span data-stu-id="e1703-566">Repeat these steps on hello other SQL Server VM.</span></span>  

<span data-ttu-id="e1703-567">För SQL Server-Tillgänglighetsgrupper måste varje SQL Server-VM toorun som ett domänkonto.</span><span class="sxs-lookup"><span data-stu-id="e1703-567">For SQL Server availability groups, each SQL Server VM needs toorun as a domain account.</span></span>

### <a name="create-a-sign-in-on-each-sql-server-vm-for-hello-installation-account"></a><span data-ttu-id="e1703-568">Skapa en inloggning på varje SQL Server-VM för kontot för installation av hello</span><span class="sxs-lookup"><span data-stu-id="e1703-568">Create a sign-in on each SQL Server VM for hello installation account</span></span>

<span data-ttu-id="e1703-569">Använd hello installationen konto (CORP\install) tooconfigure hello-tillgänglighetsgruppen.</span><span class="sxs-lookup"><span data-stu-id="e1703-569">Use hello installation account (CORP\install) tooconfigure hello availability group.</span></span> <span data-ttu-id="e1703-570">Det här kontot måste toobe medlem i hello **sysadmin** fasta serverrollen på varje SQL Server-VM.</span><span class="sxs-lookup"><span data-stu-id="e1703-570">This account needs toobe a member of hello **sysadmin** fixed server role on each SQL Server VM.</span></span> <span data-ttu-id="e1703-571">hello följande steg skapar en inloggning för hello installationskonto:</span><span class="sxs-lookup"><span data-stu-id="e1703-571">hello following steps create a sign-in for hello installation account:</span></span>

1. <span data-ttu-id="e1703-572">Ansluta toohello server via hello Remote Desktop Protocol (RDP) med hjälp av hello  *\<MachineName\>\DomainAdmin* konto.</span><span class="sxs-lookup"><span data-stu-id="e1703-572">Connect toohello server through hello Remote Desktop Protocol (RDP) by using hello *\<MachineName\>\DomainAdmin* account.</span></span>

1. <span data-ttu-id="e1703-573">Öppna SQL Server Management Studio och Anslut toohello lokal instans av SQL Server.</span><span class="sxs-lookup"><span data-stu-id="e1703-573">Open SQL Server Management Studio and connect toohello local instance of SQL Server.</span></span>

1. <span data-ttu-id="e1703-574">I **Object Explorer**, klickar du på **säkerhet**.</span><span class="sxs-lookup"><span data-stu-id="e1703-574">In **Object Explorer**, click **Security**.</span></span>

1. <span data-ttu-id="e1703-575">Högerklicka på **inloggningar**.</span><span class="sxs-lookup"><span data-stu-id="e1703-575">Right-click **Logins**.</span></span> <span data-ttu-id="e1703-576">Klicka på **ny inloggning**.</span><span class="sxs-lookup"><span data-stu-id="e1703-576">Click **New Login**.</span></span>

1. <span data-ttu-id="e1703-577">I **inloggning - ny**, klickar du på **Sök**.</span><span class="sxs-lookup"><span data-stu-id="e1703-577">In **Login - New**, click **Search**.</span></span>

1. <span data-ttu-id="e1703-578">Klicka på **platser**.</span><span class="sxs-lookup"><span data-stu-id="e1703-578">Click **Locations**.</span></span>

1. <span data-ttu-id="e1703-579">Ange hello autentiseringsuppgifter som domänadministratör nätverk.</span><span class="sxs-lookup"><span data-stu-id="e1703-579">Enter hello domain administrator network credentials.</span></span>

1. <span data-ttu-id="e1703-580">Använd hello kontot för installation.</span><span class="sxs-lookup"><span data-stu-id="e1703-580">Use hello installation account.</span></span>

1. <span data-ttu-id="e1703-581">Ange hello inloggning toobe medlem i hello **sysadmin** fasta serverrollen.</span><span class="sxs-lookup"><span data-stu-id="e1703-581">Set hello sign-in toobe a member of hello **sysadmin** fixed server role.</span></span>

1. <span data-ttu-id="e1703-582">Klicka på **OK**.</span><span class="sxs-lookup"><span data-stu-id="e1703-582">Click **OK**.</span></span>

<span data-ttu-id="e1703-583">Upprepa föregående steg på hello andra SQL Server-VM hello.</span><span class="sxs-lookup"><span data-stu-id="e1703-583">Repeat hello preceding steps on hello other SQL Server VM.</span></span>

## <a name="add-failover-clustering-features-tooboth-sql-server-vms"></a><span data-ttu-id="e1703-584">Lägg till redundanskluster funktioner tooboth virtuella SQL Server-datorer</span><span class="sxs-lookup"><span data-stu-id="e1703-584">Add Failover Clustering features tooboth SQL Server VMs</span></span>

<span data-ttu-id="e1703-585">funktioner för tooadd redundanskluster, hello följa på både SQL Server-datorer:</span><span class="sxs-lookup"><span data-stu-id="e1703-585">tooadd Failover Clustering features, do hello following on both SQL Server VMs:</span></span>

1. <span data-ttu-id="e1703-586">Ansluta toohello SQL Server-dator via hello Remote Desktop Protocol (RDP) med hjälp av hello *CORP\install* konto.</span><span class="sxs-lookup"><span data-stu-id="e1703-586">Connect toohello SQL Server virtual machine through hello Remote Desktop Protocol (RDP) by using hello *CORP\install* account.</span></span> <span data-ttu-id="e1703-587">Öppna **instrumentpanelen Serverhanteraren**.</span><span class="sxs-lookup"><span data-stu-id="e1703-587">Open **Server Manager Dashboard**.</span></span>
2. <span data-ttu-id="e1703-588">Klicka på hello **Lägg till roller och funktioner** länk på hello instrumentpanelen.</span><span class="sxs-lookup"><span data-stu-id="e1703-588">Click hello **Add roles and features** link on hello dashboard.</span></span>

    ![Server Manager - Lägg till roller](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/22-addfeatures.png)
3. <span data-ttu-id="e1703-590">Välj **nästa** tills toohello **serverfunktioner** avsnitt.</span><span class="sxs-lookup"><span data-stu-id="e1703-590">Select **Next** until you get toohello **Server Features** section.</span></span>
4. <span data-ttu-id="e1703-591">I **funktioner**väljer **redundanskluster**.</span><span class="sxs-lookup"><span data-stu-id="e1703-591">In **Features**, select **Failover Clustering**.</span></span>
5. <span data-ttu-id="e1703-592">Lägg till eventuella ytterligare funktioner som krävs.</span><span class="sxs-lookup"><span data-stu-id="e1703-592">Add any additional required features.</span></span>
6. <span data-ttu-id="e1703-593">Klicka på **installera** tooadd hello funktioner.</span><span class="sxs-lookup"><span data-stu-id="e1703-593">Click **Install** tooadd hello features.</span></span>

<span data-ttu-id="e1703-594">Upprepa hello steg på hello andra SQL Server-VM.</span><span class="sxs-lookup"><span data-stu-id="e1703-594">Repeat hello steps on hello other SQL Server VM.</span></span>

## <a name="a-nameendpoint-firewall-configure-hello-firewall-on-each-sql-server-vm"></a><span data-ttu-id="e1703-595"><a name="endpoint-firewall">Konfigurera hello-brandväggen på varje virtuell dator med SQL Server</span><span class="sxs-lookup"><span data-stu-id="e1703-595"><a name="endpoint-firewall"> Configure hello firewall on each SQL Server VM</span></span>

<span data-ttu-id="e1703-596">hello lösning kräver hello följande TCP-portar toobe öppna i hello brandväggen:</span><span class="sxs-lookup"><span data-stu-id="e1703-596">hello solution requires hello following TCP ports toobe open in hello firewall:</span></span>

- <span data-ttu-id="e1703-597">**SQLServer VM**:</span><span class="sxs-lookup"><span data-stu-id="e1703-597">**SQL Server VM**:</span></span><br/>
   <span data-ttu-id="e1703-598">Port 1433 för en standardinstans av SQL Server.</span><span class="sxs-lookup"><span data-stu-id="e1703-598">Port 1433 for a default instance of SQL Server.</span></span>
- <span data-ttu-id="e1703-599">**Azure belastningsutjämningsavsökning:**</span><span class="sxs-lookup"><span data-stu-id="e1703-599">**Azure load balancer probe:**</span></span><br/>
   <span data-ttu-id="e1703-600">Alla tillgängliga portar.</span><span class="sxs-lookup"><span data-stu-id="e1703-600">Any available port.</span></span> <span data-ttu-id="e1703-601">Exemplen använder ofta 59999.</span><span class="sxs-lookup"><span data-stu-id="e1703-601">Examples frequently use 59999.</span></span>
- <span data-ttu-id="e1703-602">**Slutpunkten för databasspegling:**</span><span class="sxs-lookup"><span data-stu-id="e1703-602">**Database mirroring endpoint:**</span></span> <br/>
   <span data-ttu-id="e1703-603">Alla tillgängliga portar.</span><span class="sxs-lookup"><span data-stu-id="e1703-603">Any available port.</span></span> <span data-ttu-id="e1703-604">Exemplen använder ofta 5022.</span><span class="sxs-lookup"><span data-stu-id="e1703-604">Examples frequently use 5022.</span></span>

<span data-ttu-id="e1703-605">hello brandväggen portar måste toobe öppen på både SQL Server-datorer.</span><span class="sxs-lookup"><span data-stu-id="e1703-605">hello firewall ports need toobe open on both SQL Server VMs.</span></span>

<span data-ttu-id="e1703-606">hello metod för att öppna portar hello beror på hello brandvägg som du använder.</span><span class="sxs-lookup"><span data-stu-id="e1703-606">hello method of opening hello ports depends on hello firewall solution that you use.</span></span> <span data-ttu-id="e1703-607">hello nästa avsnitt beskrivs hur tooopen hello portar i Windows-brandväggen.</span><span class="sxs-lookup"><span data-stu-id="e1703-607">hello next section explains how tooopen hello ports in Windows Firewall.</span></span> <span data-ttu-id="e1703-608">Öppna portar hello krävs på alla virtuella din SQL Server-datorer.</span><span class="sxs-lookup"><span data-stu-id="e1703-608">Open hello required ports on each of your SQL Server VMs.</span></span>

### <a name="open-a-tcp-port-in-hello-firewall"></a><span data-ttu-id="e1703-609">Öppna en TCP-port i brandväggen för hello</span><span class="sxs-lookup"><span data-stu-id="e1703-609">Open a TCP port in hello firewall</span></span>

1. <span data-ttu-id="e1703-610">Hej första SQL Server på **starta** skärmen, starta **Windows-brandväggen med avancerad säkerhet**.</span><span class="sxs-lookup"><span data-stu-id="e1703-610">On hello first SQL Server **Start** screen, launch **Windows Firewall with Advanced Security**.</span></span>
2. <span data-ttu-id="e1703-611">Hello vänster, Välj **regler för inkommande trafik**.</span><span class="sxs-lookup"><span data-stu-id="e1703-611">On hello left pane, select **Inbound Rules**.</span></span> <span data-ttu-id="e1703-612">Hello högra rutan, klicka på **ny regel**.</span><span class="sxs-lookup"><span data-stu-id="e1703-612">On hello right pane, click **New Rule**.</span></span>
3. <span data-ttu-id="e1703-613">För **regeltyp**, Välj **Port**.</span><span class="sxs-lookup"><span data-stu-id="e1703-613">For **Rule Type**, choose **Port**.</span></span>
4. <span data-ttu-id="e1703-614">Hello-port, ange **TCP** och typen hello lämpliga portnummer.</span><span class="sxs-lookup"><span data-stu-id="e1703-614">For hello port, specify **TCP** and type hello appropriate port numbers.</span></span> <span data-ttu-id="e1703-615">Se följande exempel hello:</span><span class="sxs-lookup"><span data-stu-id="e1703-615">See hello following example:</span></span>

   ![SQL-brandvägg](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/35-tcpports.png)

5. <span data-ttu-id="e1703-617">Klicka på **Nästa**.</span><span class="sxs-lookup"><span data-stu-id="e1703-617">Click **Next**.</span></span>
6. <span data-ttu-id="e1703-618">På hello **åtgärd** behåller **Tillåt hello anslutning** markerad och klicka sedan på **nästa**.</span><span class="sxs-lookup"><span data-stu-id="e1703-618">On hello **Action** page, keep **Allow hello connection** selected, and then click **Next**.</span></span>
7. <span data-ttu-id="e1703-619">På hello **profil** , acceptera hello standardinställningar, och klickar sedan på **nästa**.</span><span class="sxs-lookup"><span data-stu-id="e1703-619">On hello **Profile** page, accept hello default settings, and then click **Next**.</span></span>
8. <span data-ttu-id="e1703-620">På hello **namn** anger du ett namn för regeln (exempelvis **Azure LB avsökning**) i hello **namn** textrutan och klicka sedan på **Slutför**.</span><span class="sxs-lookup"><span data-stu-id="e1703-620">On hello **Name** page, specify a rule name (such as **Azure LB Probe**) in hello **Name** text box, and then click **Finish**.</span></span>

<span data-ttu-id="e1703-621">Upprepa dessa steg på hello andra SQL Server-VM.</span><span class="sxs-lookup"><span data-stu-id="e1703-621">Repeat these steps on hello second SQL Server VM.</span></span>

## <a name="next-steps"></a><span data-ttu-id="e1703-622">Nästa steg</span><span class="sxs-lookup"><span data-stu-id="e1703-622">Next steps</span></span>

* [<span data-ttu-id="e1703-623">Skapa en SQL Server Always On availability group på virtuella Azure-datorer</span><span class="sxs-lookup"><span data-stu-id="e1703-623">Create a SQL Server Always On availability group on Azure virtual machines</span></span>](virtual-machines-windows-portal-sql-availability-group-tutorial.md)
