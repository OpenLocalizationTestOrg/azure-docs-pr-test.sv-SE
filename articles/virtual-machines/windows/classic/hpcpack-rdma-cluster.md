---
title: aaaSet in en Windows RDMA klustret toorun MPI program | Microsoft Docs
description: "Lär dig hur toocreate Windows HPC Pack kluster med storlek H16r H16mr, A8 eller A9 VMs toouse hello Azure RDMA nätverk toorun MPI appar."
services: virtual-machines-windows
documentationcenter: 
author: dlepow
manager: timlt
editor: 
tags: azure-service-management,hpc-pack
ms.assetid: 7d9f5bc8-012f-48dd-b290-db81c7592215
ms.service: virtual-machines-windows
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: vm-windows
ms.workload: big-compute
ms.date: 06/01/2017
ms.author: danlep
ms.openlocfilehash: 23bc8740dbd05a7c7ab3f998489a41d0df4520a2
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 10/06/2017
---
# <a name="set-up-a-windows-rdma-cluster-with-hpc-pack-toorun-mpi-applications"></a><span data-ttu-id="65617-103">Konfigurera ett RDMA för Windows-kluster med HPC Pack toorun MPI program</span><span class="sxs-lookup"><span data-stu-id="65617-103">Set up a Windows RDMA cluster with HPC Pack toorun MPI applications</span></span>
<span data-ttu-id="65617-104">Konfigurera ett RDMA för Windows-kluster i Azure med [Microsoft HPC Pack](https://technet.microsoft.com/library/cc514029) och [högpresterande compute VM-storlekar](../sizes-hpc.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json) toorun parallella Message Passing Interface (MPI) program.</span><span class="sxs-lookup"><span data-stu-id="65617-104">Set up a Windows RDMA cluster in Azure with [Microsoft HPC Pack](https://technet.microsoft.com/library/cc514029) and [High performance compute VM sizes](../sizes-hpc.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json) toorun parallel Message Passing Interface (MPI) applications.</span></span> <span data-ttu-id="65617-105">När du ställer in RDMA-kompatibla, Windows Server-baserade noder i ett kluster med HPC Pack kommunikation MPI program effektiv via en låg latens, hög genomströmning nätverk i Azure som är baserad på remote direct memory access (RDMA)-teknik.</span><span class="sxs-lookup"><span data-stu-id="65617-105">When you set up RDMA-capable, Windows Server-based nodes in an HPC Pack cluster, MPI applications communicate efficiently over a low latency, high throughput network in Azure that is based on remote direct memory access (RDMA) technology.</span></span>

<span data-ttu-id="65617-106">Om du vill toorun MPI arbetsbelastningar på virtuella Linux-datorer åtkomst hello Azure RDMA nätverket finns [ställa in en Linux RDMA klustret toorun MPI program](../../linux/classic/rdma-cluster.md).</span><span class="sxs-lookup"><span data-stu-id="65617-106">If you want toorun MPI workloads on Linux VMs that access hello Azure RDMA network, see [Set up a Linux RDMA cluster toorun MPI applications](../../linux/classic/rdma-cluster.md).</span></span>

## <a name="hpc-pack-cluster-deployment-options"></a><span data-ttu-id="65617-107">HPC Pack distributionsalternativ för kluster</span><span class="sxs-lookup"><span data-stu-id="65617-107">HPC Pack cluster deployment options</span></span>
<span data-ttu-id="65617-108">Microsoft HPC Pack är ett verktyg på utan extra kostnad toocreate HPC-kluster lokalt eller i Azure toorun Windows eller Linux-HPC-program.</span><span class="sxs-lookup"><span data-stu-id="65617-108">Microsoft HPC Pack is a tool provided at no additional cost toocreate HPC clusters on-premises or in Azure toorun Windows or Linux HPC applications.</span></span> <span data-ttu-id="65617-109">HPC Pack innehåller en körningsmiljö för hello Microsofts implementering av hello-meddelande skickas gränssnitt för Windows (MS-MPI).</span><span class="sxs-lookup"><span data-stu-id="65617-109">HPC Pack includes a runtime environment for hello Microsoft implementation of hello Message Passing Interface for Windows (MS-MPI).</span></span> <span data-ttu-id="65617-110">När det används med RDMA-kompatibla instanser med en Windows Server operativsystem, tillhandahåller HPC Pack en effektiv alternativet toorun Windows MPI åtkomst hello Azure RDMA nätverket.</span><span class="sxs-lookup"><span data-stu-id="65617-110">When used with RDMA-capable instances running a supported Windows Server operating system, HPC Pack provides an efficient option toorun Windows MPI applications that access hello Azure RDMA network.</span></span> 

<span data-ttu-id="65617-111">Den här artikeln introducerar två scenarier och länkar toodetailed vägledning tooset in ett RDMA-Windows-kluster med Microsoft HPC Pack.</span><span class="sxs-lookup"><span data-stu-id="65617-111">This article introduces two scenarios and links toodetailed guidance tooset up a Windows RDMA cluster with Microsoft HPC Pack.</span></span> 

* <span data-ttu-id="65617-112">Scenario 1.</span><span class="sxs-lookup"><span data-stu-id="65617-112">Scenario 1.</span></span> <span data-ttu-id="65617-113">Distribuera beräkningsintensiva worker rollinstanser (PaaS)</span><span class="sxs-lookup"><span data-stu-id="65617-113">Deploy compute-intensive worker role instances (PaaS)</span></span>
* <span data-ttu-id="65617-114">Scenario 2.</span><span class="sxs-lookup"><span data-stu-id="65617-114">Scenario 2.</span></span> <span data-ttu-id="65617-115">Distribuera beräkningsnoder i beräkningsintensiva virtuella datorer (IaaS)</span><span class="sxs-lookup"><span data-stu-id="65617-115">Deploy compute nodes in compute-intensive VMs (IaaS)</span></span>

<span data-ttu-id="65617-116">Allmänna krav toouse beräkningsintensiva instanser med Windows, se [högpresterande compute VM-storlekar](../sizes-hpc.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).</span><span class="sxs-lookup"><span data-stu-id="65617-116">For general prerequisites toouse compute-intensive instances with Windows, see [High performance compute VM sizes](../sizes-hpc.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).</span></span>

## <a name="scenario-1-deploy-compute-intensive-worker-role-instances-paas"></a><span data-ttu-id="65617-117">Scenario 1: Distribuera beräkningsintensiva worker rollinstanser (PaaS)</span><span class="sxs-lookup"><span data-stu-id="65617-117">Scenario 1: Deploy compute-intensive worker role instances (PaaS)</span></span>
<span data-ttu-id="65617-118">Lägga till extra beräkningsresurser i Azure worker rollinstanser (Azure noder) körs i en molntjänst (PaaS) från ett befintligt paket för HPC-kluster.</span><span class="sxs-lookup"><span data-stu-id="65617-118">From an existing HPC Pack cluster, add extra compute resources in Azure worker role instances (Azure nodes) running in a cloud service (PaaS).</span></span> <span data-ttu-id="65617-119">Den här funktionen kallas även ”burst tooAzure” HPC Pack stöder flera olika storlekar för hello arbetarinstanser roll.</span><span class="sxs-lookup"><span data-stu-id="65617-119">This feature, also called “burst tooAzure” from HPC Pack, supports a range of sizes for hello worker role instances.</span></span> <span data-ttu-id="65617-120">När du lägger till hello Azure-noder, ange ett av RDMA-kompatibla hello storlekar.</span><span class="sxs-lookup"><span data-stu-id="65617-120">When adding hello Azure nodes, specify one of hello RDMA-capable sizes.</span></span>

<span data-ttu-id="65617-121">Nedan visas information och anvisningar för tooburst tooRDMA-kompatibla Azure-instanser från en befintlig (vanligtvis lokalt) klustret.</span><span class="sxs-lookup"><span data-stu-id="65617-121">Following are considerations and steps tooburst tooRDMA-capable Azure instances from an existing (typically on-premises) cluster.</span></span> <span data-ttu-id="65617-122">Använd liknande procedurer tooadd worker-rollen instanser tooan HPC Pack huvudnod som distribueras i en Azure VM.</span><span class="sxs-lookup"><span data-stu-id="65617-122">Use similar procedures tooadd worker role instances tooan HPC Pack head node that is deployed in an Azure VM.</span></span>

> [!NOTE]
> <span data-ttu-id="65617-123">En självstudiekurs tooburst tooAzure med HPC Pack finns [ställer in en hybrid-kluster med HPC Pack](../../../cloud-services/cloud-services-setup-hybrid-hpcpack-cluster.md).</span><span class="sxs-lookup"><span data-stu-id="65617-123">For a tutorial tooburst tooAzure with HPC Pack, see [Set up a hybrid cluster with HPC Pack](../../../cloud-services/cloud-services-setup-hybrid-hpcpack-cluster.md).</span></span> <span data-ttu-id="65617-124">Observera hello överväganden i hello följande som gäller specifikt tooRDMA-kompatibla Azure-noder.</span><span class="sxs-lookup"><span data-stu-id="65617-124">Note hello considerations in hello following steps that apply specifically tooRDMA-capable Azure nodes.</span></span>
> 
> 

![Burst tooAzure][burst]

### <a name="steps"></a><span data-ttu-id="65617-126">Steg</span><span class="sxs-lookup"><span data-stu-id="65617-126">Steps</span></span>
1. <span data-ttu-id="65617-127">**Distribuera och konfigurera en huvudnod i HPC Pack 2012 R2**</span><span class="sxs-lookup"><span data-stu-id="65617-127">**Deploy and configure an HPC Pack 2012 R2 head node**</span></span>
   
    <span data-ttu-id="65617-128">Hämta installationspaketet för hello senaste HPC Pack från hello [Microsoft Download Center](https://www.microsoft.com/download/details.aspx?id=49922).</span><span class="sxs-lookup"><span data-stu-id="65617-128">Download hello latest HPC Pack installation package from hello [Microsoft Download Center](https://www.microsoft.com/download/details.aspx?id=49922).</span></span> <span data-ttu-id="65617-129">Krav och instruktioner tooprepare ett Azure burst-distribution, se [Burst tooAzure Worker-instanser med Microsoft HPC Pack](https://technet.microsoft.com/library/gg481749.aspx).</span><span class="sxs-lookup"><span data-stu-id="65617-129">For requirements and instructions tooprepare for an Azure burst deployment, see [Burst tooAzure Worker Instances with Microsoft HPC Pack](https://technet.microsoft.com/library/gg481749.aspx).</span></span>
2. <span data-ttu-id="65617-130">**Konfigurera ett certifikat i hello Azure-prenumeration**</span><span class="sxs-lookup"><span data-stu-id="65617-130">**Configure a management certificate in hello Azure subscription**</span></span>
   
    <span data-ttu-id="65617-131">Konfigurera certifikat toosecure hello anslutning mellan hello huvudnod och Azure.</span><span class="sxs-lookup"><span data-stu-id="65617-131">Configure a certificate toosecure hello connection between hello head node and Azure.</span></span> <span data-ttu-id="65617-132">Alternativ och procedurer finns [scenarier tooConfigure hello Azure-Hanteringscertifikat för HPC Pack](http://technet.microsoft.com/library/gg481759.aspx).</span><span class="sxs-lookup"><span data-stu-id="65617-132">For options and procedures, see [Scenarios tooConfigure hello Azure Management Certificate for HPC Pack](http://technet.microsoft.com/library/gg481759.aspx).</span></span> <span data-ttu-id="65617-133">HPC Pack installeras testdistributioner kan en standard Microsoft HPC Azure-Hanteringscertifikatet kan du snabbt överföra tooyour Azure-prenumeration.</span><span class="sxs-lookup"><span data-stu-id="65617-133">For test deployments, HPC Pack installs a Default Microsoft HPC Azure Management Certificate you can quickly upload tooyour Azure subscription.</span></span>
3. <span data-ttu-id="65617-134">**Skapa en ny molntjänst och ett lagringskonto**</span><span class="sxs-lookup"><span data-stu-id="65617-134">**Create a new cloud service and a storage account**</span></span>
   
    <span data-ttu-id="65617-135">Använd hello Azure portal toocreate en tjänst i molnet och ett lagringskonto för hello distribution i en region där hello RDMA-kompatibla instanserna är tillgängliga.</span><span class="sxs-lookup"><span data-stu-id="65617-135">Use hello Azure portal toocreate a cloud service and a storage account for hello deployment in a region where hello RDMA-capable instances are available.</span></span>
4. <span data-ttu-id="65617-136">**Skapa en mall för Azure nod**</span><span class="sxs-lookup"><span data-stu-id="65617-136">**Create an Azure node template**</span></span>
   
    <span data-ttu-id="65617-137">Använd hello skapa nod Mallguiden i HPC Cluster Manager.</span><span class="sxs-lookup"><span data-stu-id="65617-137">Use hello Create Node Template Wizard in HPC Cluster Manager.</span></span> <span data-ttu-id="65617-138">Anvisningar finns [skapar en mall för Azure noden](http://technet.microsoft.com/library/gg481758.aspx#BKMK_Templ) i ”steg tooDeploy Azure noder med Microsoft HPC Pack”.</span><span class="sxs-lookup"><span data-stu-id="65617-138">For steps, see [Create an Azure node template](http://technet.microsoft.com/library/gg481758.aspx#BKMK_Templ) in “Steps tooDeploy Azure Nodes with Microsoft HPC Pack”.</span></span>
   
    <span data-ttu-id="65617-139">Första testerna föreslår vi konfigurerar en princip för manuell tillgänglighet i hello mallen.</span><span class="sxs-lookup"><span data-stu-id="65617-139">For initial tests, we suggest configuring a manual availability policy in hello template.</span></span>
5. <span data-ttu-id="65617-140">**Lägga till noder toohello kluster**</span><span class="sxs-lookup"><span data-stu-id="65617-140">**Add nodes toohello cluster**</span></span>
   
    <span data-ttu-id="65617-141">Använd hello guiden för Lägg till nod i HPC Cluster Manager.</span><span class="sxs-lookup"><span data-stu-id="65617-141">Use hello Add Node Wizard in HPC Cluster Manager.</span></span> <span data-ttu-id="65617-142">Mer information finns i [Lägg till Azure-noder toohello Windows HPC-kluster](http://technet.microsoft.com/library/gg481758.aspx#BKMK_Add).</span><span class="sxs-lookup"><span data-stu-id="65617-142">For more information, see [Add Azure Nodes toohello Windows HPC Cluster](http://technet.microsoft.com/library/gg481758.aspx#BKMK_Add).</span></span>
   
    <span data-ttu-id="65617-143">När du anger hello storleken på hello noder, Välj en av hello RDMA-kompatibla instans storlekar.</span><span class="sxs-lookup"><span data-stu-id="65617-143">When specifying hello size of hello nodes, select one of hello RDMA-capable instance sizes.</span></span>
   
   > [!NOTE]
   > <span data-ttu-id="65617-144">HPC Pack distribuerar automatiskt minst två RDMA-kompatibla instanser (till exempel A8) som proxy-noder i varje burst tooAzure distribution med hello beräkningsintensiva instanser, dessutom toohello Azure rollen arbetarinstanser som du anger.</span><span class="sxs-lookup"><span data-stu-id="65617-144">In each burst tooAzure deployment with hello compute-intensive instances, HPC Pack automatically deploys a minimum of two RDMA-capable instances (such as A8) as proxy nodes, in addition toohello Azure worker role instances you specify.</span></span> <span data-ttu-id="65617-145">hello proxy noder använder kärnor som tilldelas toohello prenumeration och avgifter tillsammans med rollinstanser för hello Azure worker.</span><span class="sxs-lookup"><span data-stu-id="65617-145">hello proxy nodes use cores that are allocated toohello subscription and incur charges along with hello Azure worker role instances.</span></span>
   > 
   > 
6. <span data-ttu-id="65617-146">**Starta (tillhandahålla) hello noder och anpassa dem online toorun jobb**</span><span class="sxs-lookup"><span data-stu-id="65617-146">**Start (provision) hello nodes and bring them online toorun jobs**</span></span>
   
    <span data-ttu-id="65617-147">Välj hello noder och använda hello **starta** åtgärd i HPC Cluster Manager.</span><span class="sxs-lookup"><span data-stu-id="65617-147">Select hello nodes and use hello **Start** action in HPC Cluster Manager.</span></span> <span data-ttu-id="65617-148">När etableringen är klar, Välj hello noder och använda hello **Anslut** åtgärd i HPC Cluster Manager.</span><span class="sxs-lookup"><span data-stu-id="65617-148">When provisioning is complete, select hello nodes and use hello **Bring Online** action in HPC Cluster Manager.</span></span> <span data-ttu-id="65617-149">hello-noderna är klar toorun jobb.</span><span class="sxs-lookup"><span data-stu-id="65617-149">hello nodes are ready toorun jobs.</span></span>
7. <span data-ttu-id="65617-150">**Skicka jobb toohello kluster**</span><span class="sxs-lookup"><span data-stu-id="65617-150">**Submit jobs toohello cluster**</span></span>
   
   <span data-ttu-id="65617-151">Använd HPC Pack jobbet skicka verktyg toorun kluster-jobb.</span><span class="sxs-lookup"><span data-stu-id="65617-151">Use HPC Pack job submission tools toorun cluster jobs.</span></span> <span data-ttu-id="65617-152">Se [Microsoft HPC Pack: jobbhantering](http://technet.microsoft.com/library/jj899585.aspx).</span><span class="sxs-lookup"><span data-stu-id="65617-152">See [Microsoft HPC Pack: Job Management](http://technet.microsoft.com/library/jj899585.aspx).</span></span>
8. <span data-ttu-id="65617-153">**Stoppa (avetablering) hello noder**</span><span class="sxs-lookup"><span data-stu-id="65617-153">**Stop (deprovision) hello nodes**</span></span>
   
   <span data-ttu-id="65617-154">När du är klar jobb som körs, hello noder offline och använda hello **stoppa** åtgärd i HPC Cluster Manager.</span><span class="sxs-lookup"><span data-stu-id="65617-154">When you are done running jobs, take hello nodes offline and use hello **Stop** action in HPC Cluster Manager.</span></span>

## <a name="scenario-2-deploy-compute-nodes-in-compute-intensive-vms-iaas"></a><span data-ttu-id="65617-155">Scenario 2: Distribuera datornoder i beräkningsintensiva virtuella datorer (IaaS)</span><span class="sxs-lookup"><span data-stu-id="65617-155">Scenario 2: Deploy compute nodes in compute-intensive VMs (IaaS)</span></span>
<span data-ttu-id="65617-156">I det här scenariot distribuera hello HPC Pack huvudnod och beräkning klusternoder på virtuella datorer i Azure-nätverk.</span><span class="sxs-lookup"><span data-stu-id="65617-156">In this scenario, you deploy hello HPC Pack head node and cluster compute nodes on VMs in an Azure virtual network.</span></span> <span data-ttu-id="65617-157">HPC Pack innehåller flera [distributionsalternativ i Azure Virtual Machines](../../linux/hpcpack-cluster-options.md), inklusive skript för automatisk distribution och Azure quickstart mallar.</span><span class="sxs-lookup"><span data-stu-id="65617-157">HPC Pack provides several [deployment options in Azure VMs](../../linux/hpcpack-cluster-options.md), including automated deployment scripts and Azure quickstart templates.</span></span> <span data-ttu-id="65617-158">Exempelvis hello följande överväganden och steg vägleder dig toouse hello [HPC Pack IaaS distributionsskriptet](hpcpack-cluster-powershell-script.md) att automatisera hello distributionen av ett HPC Pack 2012 R2-kluster i Azure.</span><span class="sxs-lookup"><span data-stu-id="65617-158">As an example, hello following considerations and steps guide you toouse hello [HPC Pack IaaS deployment script](hpcpack-cluster-powershell-script.md) to automate hello deployment of an HPC Pack 2012 R2 cluster in Azure.</span></span>

![Klustret i virtuella Azure-datorer][iaas]

### <a name="steps"></a><span data-ttu-id="65617-160">Steg</span><span class="sxs-lookup"><span data-stu-id="65617-160">Steps</span></span>
1. <span data-ttu-id="65617-161">**Skapa en klustrets huvudnod och compute-nod virtuella datorer genom att köra hello HPC Pack IaaS-skriptet på en klientdator**</span><span class="sxs-lookup"><span data-stu-id="65617-161">**Create a cluster head node and compute node VMs by running hello HPC Pack IaaS deployment script on a client computer**</span></span>
   
    <span data-ttu-id="65617-162">Hämta hello HPC Pack IaaS-distributionsskriptet paketet från hello [Microsoft Download Center](https://www.microsoft.com/download/details.aspx?id=49922).</span><span class="sxs-lookup"><span data-stu-id="65617-162">Download hello HPC Pack IaaS Deployment Script package from hello [Microsoft Download Center](https://www.microsoft.com/download/details.aspx?id=49922).</span></span>
   
    <span data-ttu-id="65617-163">tooprepare hello klientdatorn, skapa hello-konfigurationsfilen och kör hello skript, se [skapa ett HPC-kluster med hello HPC Pack IaaS distributionsskriptet](hpcpack-cluster-powershell-script.md).</span><span class="sxs-lookup"><span data-stu-id="65617-163">tooprepare hello client computer, create hello script configuration file, and run hello script, see [Create an HPC Cluster with hello HPC Pack IaaS deployment script](hpcpack-cluster-powershell-script.md).</span></span> 
   
    <span data-ttu-id="65617-164">toodeploy RDMA-kompatibla compute-noder, Observera hello följande ytterligare överväganden:</span><span class="sxs-lookup"><span data-stu-id="65617-164">toodeploy RDMA-capable compute nodes, note hello following additional considerations:</span></span>
   
   * <span data-ttu-id="65617-165">**Virtuellt nätverk**: Ange ett nytt virtuellt nätverk i en region i vilken hello RDMA-kompatibla instansstorleken du toouse är tillgänglig.</span><span class="sxs-lookup"><span data-stu-id="65617-165">**Virtual network**: Specify a new virtual network in a region in which hello RDMA-capable instance size you want toouse is available.</span></span>
   * <span data-ttu-id="65617-166">**Operativsystemet Windows Server**: toosupport RDMA-anslutning, ange ett Windows Server 2012 R2 eller Windows Server 2012-operativsystem för hello beräkningsnod virtuella datorer.</span><span class="sxs-lookup"><span data-stu-id="65617-166">**Windows Server operating system**: toosupport RDMA connectivity, specify a Windows Server 2012 R2 or Windows Server 2012 operating system for hello compute node VMs.</span></span>
   * <span data-ttu-id="65617-167">**Molntjänster**: Vi rekommenderar att distribuera din huvudnod i en molntjänst och dina compute-noder i en annan molntjänst.</span><span class="sxs-lookup"><span data-stu-id="65617-167">**Cloud services**: We recommend deploying your head node in one cloud service and your compute nodes in a different cloud service.</span></span>
   * <span data-ttu-id="65617-168">**Gå nodstorlek**: det här scenariot bör du en storlek på minst A4 (Extra stor) för hello huvudnod.</span><span class="sxs-lookup"><span data-stu-id="65617-168">**Head node size**: For this scenario, consider a size of at least A4 (Extra Large) for hello head node.</span></span>
   * <span data-ttu-id="65617-169">**HpcVmDrivers tillägget**: hello distributionsskriptet installerar hello Azure VM-agenten och hello HpcVmDrivers tillägg automatiskt när du distribuerar storlek A8 eller A9 compute-noder med en Windows Server-operativsystem.</span><span class="sxs-lookup"><span data-stu-id="65617-169">**HpcVmDrivers extension**: hello deployment script installs hello Azure VM Agent and hello HpcVmDrivers extension automatically when you deploy size A8 or A9 compute nodes with a Windows Server operating system.</span></span> <span data-ttu-id="65617-170">HpcVmDrivers installerar drivrutiner på hello beräkningsnod virtuella datorer så att de kan ansluta toohello RDMA nätverk.</span><span class="sxs-lookup"><span data-stu-id="65617-170">HpcVmDrivers installs drivers on hello compute node VMs so they can connect toohello RDMA network.</span></span> <span data-ttu-id="65617-171">På RDMA-kompatibla H-serien virtuella datorer, måste du manuellt installera hello HpcVmDrivers tillägg.</span><span class="sxs-lookup"><span data-stu-id="65617-171">On RDMA-capable H-series VMs, you must manually install hello HpcVmDrivers extension.</span></span> <span data-ttu-id="65617-172">Se [högpresterande compute VM-storlekar](../sizes-hpc.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).</span><span class="sxs-lookup"><span data-stu-id="65617-172">See [High performance compute VM sizes](../sizes-hpc.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).</span></span>
   * <span data-ttu-id="65617-173">**Klusternätverkskonfigurationen**: hello distributionsskriptet konfigurerar automatiskt hello HPC Pack klustret i topologin 5 (alla noder på hello företagsnätverk).</span><span class="sxs-lookup"><span data-stu-id="65617-173">**Cluster network configuration**: hello deployment script automatically sets up hello HPC Pack cluster in Topology 5 (all nodes on hello Enterprise network).</span></span> <span data-ttu-id="65617-174">Den här topologin krävs för alla HPC Pack klustret distributioner i virtuella datorer.</span><span class="sxs-lookup"><span data-stu-id="65617-174">This topology is required for all HPC Pack cluster deployments in VMs.</span></span> <span data-ttu-id="65617-175">Ändra inte hello klustret nätverkets topologi senare.</span><span class="sxs-lookup"><span data-stu-id="65617-175">Do not change hello cluster network topology later.</span></span>
2. <span data-ttu-id="65617-176">**Ta hello datornoderna online toorun jobb**</span><span class="sxs-lookup"><span data-stu-id="65617-176">**Bring hello compute nodes online toorun jobs**</span></span>
   
    <span data-ttu-id="65617-177">Välj hello noder och använda hello **Anslut** åtgärd i HPC Cluster Manager.</span><span class="sxs-lookup"><span data-stu-id="65617-177">Select hello nodes and use hello **Bring Online** action in HPC Cluster Manager.</span></span> <span data-ttu-id="65617-178">hello-noderna är klar toorun jobb.</span><span class="sxs-lookup"><span data-stu-id="65617-178">hello nodes are ready toorun jobs.</span></span>
3. <span data-ttu-id="65617-179">**Skicka jobb toohello kluster**</span><span class="sxs-lookup"><span data-stu-id="65617-179">**Submit jobs toohello cluster**</span></span>
   
    <span data-ttu-id="65617-180">Anslut toohello huvudnod toosubmit jobb eller konfigurera en lokal dator toodo detta.</span><span class="sxs-lookup"><span data-stu-id="65617-180">Connect toohello head node toosubmit jobs, or set up an on-premises computer toodo this.</span></span> <span data-ttu-id="65617-181">Mer information finns i [skicka jobb tooan HPC-kluster i Azure](../../virtual-machines-windows-hpcpack-cluster-submit-jobs.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).</span><span class="sxs-lookup"><span data-stu-id="65617-181">For information, see [Submit Jobs tooan HPC cluster in Azure](../../virtual-machines-windows-hpcpack-cluster-submit-jobs.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).</span></span>
4. <span data-ttu-id="65617-182">**Vidta hello noder offline och stoppa frigöra () dem.**</span><span class="sxs-lookup"><span data-stu-id="65617-182">**Take hello nodes offline and stop (deallocate) them**</span></span>
   
    <span data-ttu-id="65617-183">När du är klar jobb som körs, och ta offline hello-noder i HPC Cluster Manager.</span><span class="sxs-lookup"><span data-stu-id="65617-183">When you are done running jobs, take hello nodes offline in HPC Cluster Manager.</span></span> <span data-ttu-id="65617-184">Använd sedan Azure management tools tooshut dem ned.</span><span class="sxs-lookup"><span data-stu-id="65617-184">Then, use Azure management tools tooshut them down.</span></span>

## <a name="run-mpi-applications-on-hello-cluster"></a><span data-ttu-id="65617-185">Kör MPI-program på hello kluster</span><span class="sxs-lookup"><span data-stu-id="65617-185">Run MPI applications on hello cluster</span></span>
### <a name="example-run-mpipingpong-on-an-hpc-pack-cluster"></a><span data-ttu-id="65617-186">Exempel: Kör mpipingpong i ett HPC Pack-kluster</span><span class="sxs-lookup"><span data-stu-id="65617-186">Example: Run mpipingpong on an HPC Pack cluster</span></span>
<span data-ttu-id="65617-187">tooverify ett HPC Pack distribution av RDMA-kompatibla hello instanser, kör hello HPC Pack **mpipingpong** på hello klustret.</span><span class="sxs-lookup"><span data-stu-id="65617-187">tooverify an HPC Pack deployment of hello RDMA-capable instances, run hello HPC Pack **mpipingpong** command on hello cluster.</span></span> <span data-ttu-id="65617-188">**mpipingpong** skickar datapaket mellan parad noder upprepade gånger toocalculate svarstid och genomströmning mått och statistik för hello RDMA-aktiverade program nätverket.</span><span class="sxs-lookup"><span data-stu-id="65617-188">**mpipingpong** sends packets of data between paired nodes repeatedly toocalculate latency and throughput measurements and statistics for hello RDMA-enabled application network.</span></span> <span data-ttu-id="65617-189">Det här exemplet illustrerar ett typiskt mönster för att köra ett MPI-jobb (i det här fallet **mpipingpong**) genom att använda hello kluster **mpiexec** kommando.</span><span class="sxs-lookup"><span data-stu-id="65617-189">This example shows a typical pattern for running an MPI job (in this case, **mpipingpong**) by using hello cluster **mpiexec** command.</span></span>

<span data-ttu-id="65617-190">Det här exemplet förutsätter att du har lagt till Azure-noder i en konfiguration för ”burst tooAzure” ([Scenario 1](#scenario-1.-deploy-compute-intensive-worker-role-instances-\(PaaS\) in this article).</span><span class="sxs-lookup"><span data-stu-id="65617-190">This example assumes you added Azure nodes in a “burst tooAzure” configuration ([Scenario 1](#scenario-1.-deploy-compute-intensive-worker-role-instances-\(PaaS\) in this article).</span></span> <span data-ttu-id="65617-191">Om du har distribuerat HPC Pack på ett kluster med virtuella Azure-datorer, du behöver toomodify hello kommandot syntax toospecify en annan nodgrupp och ange ytterligare variabler toodirect nätverk trafik toohello RDMA nätverk.</span><span class="sxs-lookup"><span data-stu-id="65617-191">If you deployed HPC Pack on a cluster of Azure VMs, you’ll need toomodify hello command syntax toospecify a different node group and set additional environment variables toodirect network traffic toohello RDMA network.</span></span>

<span data-ttu-id="65617-192">toorun mpipingpong på hello klustret:</span><span class="sxs-lookup"><span data-stu-id="65617-192">toorun mpipingpong on hello cluster:</span></span>

1. <span data-ttu-id="65617-193">Öppna en kommandotolk på hello huvudnod eller på en korrekt konfigurerad klientdator.</span><span class="sxs-lookup"><span data-stu-id="65617-193">On hello head node or on a properly configured client computer, open a Command Prompt.</span></span>
2. <span data-ttu-id="65617-194">tooestimate fördröjning mellan två noder i en Azure burst-distribution med fyra noder typen hello efter kommandot toosubmit ett jobb toorun mpipingpong med en liten paketstorlek och många iterationer:</span><span class="sxs-lookup"><span data-stu-id="65617-194">tooestimate latency between pairs of nodes in an Azure burst deployment of four nodes, type hello following command toosubmit a job toorun mpipingpong with a small packet size and many iterations:</span></span>
   
    ```Command
    job submit /nodegroup:azurenodes /numnodes:4 mpiexec -c 1 -affinity mpipingpong -p 1:100000 -op -s nul
    ```
   
    <span data-ttu-id="65617-195">hello kommandot returnerar hello-ID för hello jobb som har skickats.</span><span class="sxs-lookup"><span data-stu-id="65617-195">hello command returns hello ID of hello job that is submitted.</span></span>
   
    <span data-ttu-id="65617-196">Om du har distribuerat hello HPC Pack klustret distribueras på Azure Virtual Machines, ange en nodgrupp som innehåller compute-nod virtuella datorer som distribueras i en enda molntjänst och ändra hello **mpiexec** kommandot på följande sätt:</span><span class="sxs-lookup"><span data-stu-id="65617-196">If you deployed hello HPC Pack cluster deployed on Azure VMs, specify a node group that contains compute node VMs deployed in a single cloud service, and modify hello **mpiexec** command as follows:</span></span>
   
    ```Command
    job submit /nodegroup:vmcomputenodes /numnodes:4 mpiexec -c 1 -affinity -env MSMPI_DISABLE_SOCK 1 -env MSMPI_PRECONNECT all -env MPICH_NETMASK 172.16.0.0/255.255.0.0 mpipingpong -p 1:100000 -op -s nul
    ```
3. <span data-ttu-id="65617-197">När hello jobbet är slutfört, utdata tooview hello (i det här fallet hello utdata för uppgift 1 för hello jobb), typen hello efter</span><span class="sxs-lookup"><span data-stu-id="65617-197">When hello job completes, tooview hello output (in this case, hello output of task 1 of hello job), type hello following</span></span>
   
    ```Command
    task view <JobID>.1
    ```
   
    <span data-ttu-id="65617-198">där &lt; *JobID* &gt; är hello-ID för hello jobb som har skickats.</span><span class="sxs-lookup"><span data-stu-id="65617-198">where &lt;*JobID*&gt; is hello ID of hello job that was submitted.</span></span>
   
    <span data-ttu-id="65617-199">hello utdata innehåller latens resultat liknande toohello följande.</span><span class="sxs-lookup"><span data-stu-id="65617-199">hello output includes latency results similar toohello following.</span></span>
   
    ![Svarstid för ping-pong][pingpong1]
4. <span data-ttu-id="65617-201">tooestimate dataflödet mellan två Azure burst noder, typen hello följande kommando toosubmit ett jobb toorun **mpipingpong** med ett stort paket, storlek och några iterationer:</span><span class="sxs-lookup"><span data-stu-id="65617-201">tooestimate throughput between pairs of Azure burst nodes, type hello following command toosubmit a job toorun **mpipingpong** with a large packet size and a few iterations:</span></span>
   
    ```Command
    job submit /nodegroup:azurenodes /numnodes:4 mpiexec -c 1 -affinity mpipingpong -p 4000000:1000 -op -s nul
    ```
   
    <span data-ttu-id="65617-202">hello kommandot returnerar hello-ID för hello jobb som har skickats.</span><span class="sxs-lookup"><span data-stu-id="65617-202">hello command returns hello ID of hello job that is submitted.</span></span>
   
    <span data-ttu-id="65617-203">Ändra hello kommandot som du antecknade i steg 2 i ett HPC Pack-kluster som distribueras på virtuella Azure-datorer.</span><span class="sxs-lookup"><span data-stu-id="65617-203">On an HPC Pack cluster deployed on Azure VMs, modify hello command as noted in step 2.</span></span>
5. <span data-ttu-id="65617-204">När hello jobbet är slutfört, utdata tooview hello (i det här fallet hello utdata för uppgift 1 för hello jobb), typen hello följande:</span><span class="sxs-lookup"><span data-stu-id="65617-204">When hello job completes, tooview hello output (in this case, hello output of task 1 of hello job), type hello following:</span></span>
   
    ```Command
    task view <JobID>.1
    ```
   
   <span data-ttu-id="65617-205">hello utdata innehåller genomströmning resultat liknande toohello följande.</span><span class="sxs-lookup"><span data-stu-id="65617-205">hello output includes throughput results similar toohello following.</span></span>
   
   ![Ping pong genomflöde][pingpong2]

### <a name="mpi-application-considerations"></a><span data-ttu-id="65617-207">Överväganden för MPI-program</span><span class="sxs-lookup"><span data-stu-id="65617-207">MPI application considerations</span></span>
<span data-ttu-id="65617-208">Följande är överväganden för MPI program som körs med HPC Pack i Azure.</span><span class="sxs-lookup"><span data-stu-id="65617-208">Following are considerations for running MPI applications with HPC Pack in Azure.</span></span> <span data-ttu-id="65617-209">Vissa gäller endast toodeployments av Azure-noder (rollen arbetarinstanser som ska läggas till i en konfiguration för ”burst tooAzure”).</span><span class="sxs-lookup"><span data-stu-id="65617-209">Some apply only toodeployments of Azure nodes (worker role instances added in a “burst tooAzure” configuration).</span></span>

* <span data-ttu-id="65617-210">Worker-rollinstanser i en molntjänst är regelbundet etableras utan föregående meddelande av Azure (till exempel för Systemunderhåll eller om en instans misslyckas).</span><span class="sxs-lookup"><span data-stu-id="65617-210">Worker role instances in a cloud service are periodically reprovisioned without notice by Azure (for example, for system maintenance, or in case an instance fails).</span></span> <span data-ttu-id="65617-211">Om en instans är etableras medan den körs ett MPI-jobb, hello instans förlorar data och returnerar toohello tillstånd när det först distribuerades, vilket kan orsaka hello MPI jobbet toofail.</span><span class="sxs-lookup"><span data-stu-id="65617-211">If an instance is reprovisioned while it is running an MPI job, hello instance loses its data and returns toohello state when it was first deployed, which can cause hello MPI job toofail.</span></span> <span data-ttu-id="65617-212">hello fler noder som du använder för en enstaka MPI-jobb och hello längre hello körs jobbet, hello mer troligt att en hello instanser etableras medan ett jobb körs.</span><span class="sxs-lookup"><span data-stu-id="65617-212">hello more nodes that you use for a single MPI job, and hello longer hello job runs, hello more likely that one of hello instances is reprovisioned while a job is running.</span></span> <span data-ttu-id="65617-213">Överväg också att detta om du anger en enskild nod i hello distribution som en filserver.</span><span class="sxs-lookup"><span data-stu-id="65617-213">Also consider this if you designate a single node in hello deployment as a file server.</span></span>
* <span data-ttu-id="65617-214">toorun MPI-jobb i Azure, du har inte toouse hello RDMA-kompatibla instanser.</span><span class="sxs-lookup"><span data-stu-id="65617-214">toorun MPI jobs in Azure, you don't have toouse hello RDMA-capable instances.</span></span> <span data-ttu-id="65617-215">Du kan använda valfri instans storlek som stöds av HPC Pack.</span><span class="sxs-lookup"><span data-stu-id="65617-215">You can use any instance size that is supported by HPC Pack.</span></span> <span data-ttu-id="65617-216">Hej RDMA-kompatibla instanser bör dock för att köra relativt stora MPI-jobb som är känsliga toohello svarstid och hello bandbredden för hello-nätverk som ansluter hello noder.</span><span class="sxs-lookup"><span data-stu-id="65617-216">However, hello RDMA-capable instances are recommended for running relatively large-scale MPI jobs that are sensitive toohello latency and hello bandwidth of hello network that connects hello nodes.</span></span> <span data-ttu-id="65617-217">Om du använder andra storlekar toorun och bandbredd-känslig för fördröjningar MPI-jobb, rekommenderar vi kör små jobb, där en enskild aktivitet körs på bara några noder.</span><span class="sxs-lookup"><span data-stu-id="65617-217">If you use other sizes toorun latency- and bandwidth-sensitive MPI jobs, we recommend running small jobs, in which a single task runs on only a few nodes.</span></span>
* <span data-ttu-id="65617-218">Program som har distribuerats tooAzure instanserna är ämne toohello kopplad till programmet hello licensvillkoren.</span><span class="sxs-lookup"><span data-stu-id="65617-218">Applications deployed tooAzure instances are subject toohello licensing terms associated with hello application.</span></span> <span data-ttu-id="65617-219">Kontrollera med hello leverantören av alla kommersiella program för licensiering eller andra begränsningar för att köra i hello molnet.</span><span class="sxs-lookup"><span data-stu-id="65617-219">Check with hello vendor of any commercial application for licensing or other restrictions for running in hello cloud.</span></span> <span data-ttu-id="65617-220">Alla leverantörer erbjuder inte licensiering enligt modellen Betala per användning.</span><span class="sxs-lookup"><span data-stu-id="65617-220">Not all vendors offer pay-as-you-go licensing.</span></span>
* <span data-ttu-id="65617-221">Azure-instanser behöver ytterligare konfigurera tooaccess lokala noder, resurser och servrar för fjärrskrivbordslicenser.</span><span class="sxs-lookup"><span data-stu-id="65617-221">Azure instances need further setup tooaccess on-premises nodes, shares, and license servers.</span></span> <span data-ttu-id="65617-222">Du kan konfigurera en Azure-nätverk för plats-till-plats till exempel tooenable hello Azure-noder tooaccess ett lokalt licensservern.</span><span class="sxs-lookup"><span data-stu-id="65617-222">For example, tooenable hello Azure nodes tooaccess an on-premises license server, you can configure a site-to-site Azure virtual network.</span></span>
* <span data-ttu-id="65617-223">toorun MPI program på Azure-instanser, registrera varje MPI-program med Windows-brandväggen på hello instanser genom att köra hello **hpcfwutil** kommando.</span><span class="sxs-lookup"><span data-stu-id="65617-223">toorun MPI applications on Azure instances, register each MPI application with Windows Firewall on hello instances by running hello **hpcfwutil** command.</span></span> <span data-ttu-id="65617-224">Detta gör att MPI kommunikation tootake plats på en port som tilldelas dynamiskt av hello brandvägg.</span><span class="sxs-lookup"><span data-stu-id="65617-224">This allows MPI communications tootake place on a port that is assigned dynamically by hello firewall.</span></span>
  
  > [!NOTE]
  > <span data-ttu-id="65617-225">För burst tooAzure distributioner, kan du också konfigurera en brandvägg undantag kommandot toorun automatiskt på alla nya Azure noder som har lagts till tooyour klustret.</span><span class="sxs-lookup"><span data-stu-id="65617-225">For burst tooAzure deployments, you can also configure a firewall exception command toorun automatically on all new Azure nodes that are added tooyour cluster.</span></span> <span data-ttu-id="65617-226">När du har kört hello **hpcfwutil** och kontrollera att dina program fungerar lägger till kommandot hello tooa startskript för din Azure-noder.</span><span class="sxs-lookup"><span data-stu-id="65617-226">After you run hello **hpcfwutil** command and verify that your application works, add hello command tooa startup script for your Azure nodes.</span></span> <span data-ttu-id="65617-227">Mer information finns i [använder ett startskript för Azure-noder](https://technet.microsoft.com/library/jj899632.aspx).</span><span class="sxs-lookup"><span data-stu-id="65617-227">For more information, see [Use a Startup Script for Azure Nodes](https://technet.microsoft.com/library/jj899632.aspx).</span></span>
  > 
  > 
* <span data-ttu-id="65617-228">HPC Pack använder hello CCP_MPI_NETMASK klustret miljö variabeln toospecify godkända ett adressintervall för MPI-kommunikation.</span><span class="sxs-lookup"><span data-stu-id="65617-228">HPC Pack uses hello CCP_MPI_NETMASK cluster environment variable toospecify a range of acceptable addresses for MPI communication.</span></span> <span data-ttu-id="65617-229">Från och med HPC Pack 2012 R2, hello CCP_MPI_NETMASK klustret miljövariabeln påverkar endast MPI kommunikationen mellan noder domänanslutna beräkning (antingen lokalt eller i virtuella Azure-datorer).</span><span class="sxs-lookup"><span data-stu-id="65617-229">Starting in HPC Pack 2012 R2, hello CCP_MPI_NETMASK cluster environment variable only affects MPI communication between domain-joined cluster compute nodes (either on-premises or in Azure VMs).</span></span> <span data-ttu-id="65617-230">hello variabeln ignoreras av noderna läggas till i en burst tooAzure konfiguration.</span><span class="sxs-lookup"><span data-stu-id="65617-230">hello variable is ignored by nodes added in a burst tooAzure configuration.</span></span>
* <span data-ttu-id="65617-231">MPI-jobb kan inte köras i Azure-instanser som har distribuerats i annat moln services (till exempel burst tooAzure distributioner med olika noden mallar eller Azure VM datornoderna distribueras i flera molntjänster).</span><span class="sxs-lookup"><span data-stu-id="65617-231">MPI jobs can't run across Azure instances that are deployed in different cloud services (for example, in burst tooAzure deployments with different node templates, or Azure VM compute nodes deployed in multiple cloud services).</span></span> <span data-ttu-id="65617-232">Om du har flera Azure noden distributioner som startas med olika noden mallar måste hello MPI-jobb köras på en enda uppsättning Azure-noder.</span><span class="sxs-lookup"><span data-stu-id="65617-232">If you have multiple Azure node deployments that are started with different node templates, hello MPI job must run on only one set of Azure nodes.</span></span>
* <span data-ttu-id="65617-233">När du lägger till Azure-noder tooyour klustret och tar dem online, hello HPC tjänsten för Rapportjobbschemaläggning omedelbart försöker toostart jobb på hello noder.</span><span class="sxs-lookup"><span data-stu-id="65617-233">When you add Azure nodes tooyour cluster and bring them online, hello HPC Job Scheduler Service immediately tries toostart jobs on hello nodes.</span></span> <span data-ttu-id="65617-234">Om bara en del av din arbetsbelastning kan köra på Azure, kontrollera att du uppdaterar eller skapar jobbet mallar toodefine vilka typer som kan köras på Azure.</span><span class="sxs-lookup"><span data-stu-id="65617-234">If only a portion of your workload can run on Azure, ensure that you update or create job templates toodefine what job types can run on Azure.</span></span> <span data-ttu-id="65617-235">Till exempel krävs tooensure att jobb som skickats med en jobbmall bara köras på Azure-noder, Lägg till hello noden grupper egenskapen toohello jobbmall och välj AzureNodes som hello värde.</span><span class="sxs-lookup"><span data-stu-id="65617-235">For example, tooensure that jobs submitted with a job template only run on Azure nodes, add hello Node Groups property toohello job template and select AzureNodes as hello required value.</span></span> <span data-ttu-id="65617-236">toocreate anpassade grupper för din Azure-noder använder hello Lägg till HpcGroup HPC PowerShell-cmdlet.</span><span class="sxs-lookup"><span data-stu-id="65617-236">toocreate custom groups for your Azure nodes, use hello Add-HpcGroup HPC PowerShell cmdlet.</span></span>

## <a name="next-steps"></a><span data-ttu-id="65617-237">Nästa steg</span><span class="sxs-lookup"><span data-stu-id="65617-237">Next steps</span></span>
* <span data-ttu-id="65617-238">Utveckla med hello Azure Batch-tjänsten toorun MPI program på hanterade pooler med beräkningsnoder i Azure som en alternativ toousing HPC Pack.</span><span class="sxs-lookup"><span data-stu-id="65617-238">As an alternative toousing HPC Pack, develop with hello Azure Batch service toorun MPI applications on managed pools of compute nodes in Azure.</span></span> <span data-ttu-id="65617-239">Se [Använd flera instanser av åtgärder toorun Message Passing Interface (MPI) program i Azure Batch](../../../batch/batch-mpi.md).</span><span class="sxs-lookup"><span data-stu-id="65617-239">See [Use multi-instance tasks toorun Message Passing Interface (MPI) applications in Azure Batch](../../../batch/batch-mpi.md).</span></span>
* <span data-ttu-id="65617-240">Om du vill toorun Linux MPI-program som har åtkomst till hello Azure RDMA nätverket finns [ställa in en Linux RDMA klustret toorun MPI program](../../linux/classic/rdma-cluster.md).</span><span class="sxs-lookup"><span data-stu-id="65617-240">If you want toorun Linux MPI applications that access hello Azure RDMA network, see [Set up a Linux RDMA cluster toorun MPI applications](../../linux/classic/rdma-cluster.md).</span></span>

<!--Image references-->
[burst]:media/hpcpack-rdma-cluster/burst.png
[iaas]:media/hpcpack-rdma-cluster/iaas.png
[pingpong1]:media/hpcpack-rdma-cluster/pingpong1.png
[pingpong2]:media/hpcpack-rdma-cluster/pingpong2.png
