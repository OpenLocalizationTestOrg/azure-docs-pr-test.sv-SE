---
title: "aaaAzure riktlinjer för Data Lake Store Storm-prestandajustering | Microsoft Docs"
description: Azure Data Lake Store Storm prestandajustering riktlinjer
services: data-lake-store
documentationcenter: 
author: stewu
manager: amitkul
editor: stewu
ms.assetid: ebde7b9f-2e51-4d43-b7ab-566417221335
ms.service: data-lake-store
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: big-data
ms.date: 12/19/2016
ms.author: stewu
ms.openlocfilehash: 5412fd46cf2373f5877030913df4fe1fc6f5473a
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 10/06/2017
---
# <a name="performance-tuning-guidance-for-storm-on-hdinsight-and-azure-data-lake-store"></a><span data-ttu-id="c14b6-103">Prestandajustering för Storm på HDInsight och Azure Data Lake Store</span><span class="sxs-lookup"><span data-stu-id="c14b6-103">Performance tuning guidance for Storm on HDInsight and Azure Data Lake Store</span></span>

<span data-ttu-id="c14b6-104">Förstå hello faktorer som ska beaktas när du finjustera hello prestanda för en Azure Storm-topologi.</span><span class="sxs-lookup"><span data-stu-id="c14b6-104">Understand hello factors that should be considered when you tune hello performance of an Azure Storm topology.</span></span> <span data-ttu-id="c14b6-105">Exempelvis är det viktigt toounderstand hello egenskaper hello arbete som utförs av hello kanaler och hello bultar (om hello arbete är i/o- eller minnesintensiva).</span><span class="sxs-lookup"><span data-stu-id="c14b6-105">For example, it's important toounderstand hello characteristics of hello work done by hello spouts and hello bolts (whether hello work is I/O or memory intensive).</span></span> <span data-ttu-id="c14b6-106">Den här artikeln innehåller en uppsättning prestandajustering riktlinjer, inklusive felsökning av vanliga problem.</span><span class="sxs-lookup"><span data-stu-id="c14b6-106">This article covers a range of performance tuning guidelines, including troubleshooting common issues.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="c14b6-107">Krav</span><span class="sxs-lookup"><span data-stu-id="c14b6-107">Prerequisites</span></span>

* <span data-ttu-id="c14b6-108">**En Azure-prenumeration**.</span><span class="sxs-lookup"><span data-stu-id="c14b6-108">**An Azure subscription**.</span></span> <span data-ttu-id="c14b6-109">Se [Hämta en kostnadsfri utvärderingsversion av Azure](https://azure.microsoft.com/pricing/free-trial/).</span><span class="sxs-lookup"><span data-stu-id="c14b6-109">See [Get Azure free trial](https://azure.microsoft.com/pricing/free-trial/).</span></span>
* <span data-ttu-id="c14b6-110">**Ett Azure Data Lake Store-konto**.</span><span class="sxs-lookup"><span data-stu-id="c14b6-110">**An Azure Data Lake Store account**.</span></span> <span data-ttu-id="c14b6-111">Anvisningar för hur toocreate en, se [Kom igång med Azure Data Lake Store](data-lake-store-get-started-portal.md).</span><span class="sxs-lookup"><span data-stu-id="c14b6-111">For instructions on how toocreate one, see [Get started with Azure Data Lake Store](data-lake-store-get-started-portal.md).</span></span>
* <span data-ttu-id="c14b6-112">**Ett Azure HDInsight-kluster** med åtkomst tooa Data Lake Store-konto.</span><span class="sxs-lookup"><span data-stu-id="c14b6-112">**An Azure HDInsight cluster** with access tooa Data Lake Store account.</span></span> <span data-ttu-id="c14b6-113">Se [skapar ett HDInsight-kluster med Data Lake Store](data-lake-store-hdinsight-hadoop-use-portal.md).</span><span class="sxs-lookup"><span data-stu-id="c14b6-113">See [Create an HDInsight cluster with Data Lake Store](data-lake-store-hdinsight-hadoop-use-portal.md).</span></span> <span data-ttu-id="c14b6-114">Kontrollera att du kan aktivera Fjärrskrivbord för hello kluster.</span><span class="sxs-lookup"><span data-stu-id="c14b6-114">Make sure you enable Remote Desktop for hello cluster.</span></span>
* <span data-ttu-id="c14b6-115">**Kör ett Storm-kluster på Data Lake Store**.</span><span class="sxs-lookup"><span data-stu-id="c14b6-115">**Running a Storm cluster on Data Lake Store**.</span></span> <span data-ttu-id="c14b6-116">Mer information finns i [Storm på HDInsight](https://docs.microsoft.com/en-us/azure/hdinsight/hdinsight-storm-overview).</span><span class="sxs-lookup"><span data-stu-id="c14b6-116">For more information, see [Storm on HDInsight](https://docs.microsoft.com/en-us/azure/hdinsight/hdinsight-storm-overview).</span></span>
* <span data-ttu-id="c14b6-117">**Prestandajustering riktlinjer för Data Lake Store**.</span><span class="sxs-lookup"><span data-stu-id="c14b6-117">**Performance tuning guidelines on Data Lake Store**.</span></span>  <span data-ttu-id="c14b6-118">Allmänna prestanda begrepp finns [Data Lake Store justera Prestandaråd](https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-performance-tuning-guidance).</span><span class="sxs-lookup"><span data-stu-id="c14b6-118">For general performance concepts, see [Data Lake Store Performance Tuning Guidance](https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-performance-tuning-guidance).</span></span>  

## <a name="tune-hello-parallelism-of-hello-topology"></a><span data-ttu-id="c14b6-119">Finjustera hello parallellitet hello-topologi</span><span class="sxs-lookup"><span data-stu-id="c14b6-119">Tune hello parallelism of hello topology</span></span>

<span data-ttu-id="c14b6-120">Du kanske kan tooimprove prestanda genom att öka hello samtidighet på hello i/o-tooand från Data Lake Store.</span><span class="sxs-lookup"><span data-stu-id="c14b6-120">You might be able tooimprove performance by increasing hello concurrency of hello I/O tooand from Data Lake Store.</span></span> <span data-ttu-id="c14b6-121">En Storm-topologi har en uppsättning av konfigurationer som bestämmer hello parallellitet:</span><span class="sxs-lookup"><span data-stu-id="c14b6-121">A Storm topology has a set of configurations that determine hello parallelism:</span></span>
* <span data-ttu-id="c14b6-122">Antalet arbetsprocesser (hello arbetare är jämnt fördelad över hello virtuella datorer).</span><span class="sxs-lookup"><span data-stu-id="c14b6-122">Number of worker processes (hello workers are evenly distributed across hello VMs).</span></span>
* <span data-ttu-id="c14b6-123">Antalet kanal utföraren instanser.</span><span class="sxs-lookup"><span data-stu-id="c14b6-123">Number of spout executor instances.</span></span>
* <span data-ttu-id="c14b6-124">Antalet instanser av bulten utförare.</span><span class="sxs-lookup"><span data-stu-id="c14b6-124">Number of bolt executor instances.</span></span>
* <span data-ttu-id="c14b6-125">Antal kanal uppgifter.</span><span class="sxs-lookup"><span data-stu-id="c14b6-125">Number of spout tasks.</span></span>
* <span data-ttu-id="c14b6-126">Antal bult uppgifter.</span><span class="sxs-lookup"><span data-stu-id="c14b6-126">Number of bolt tasks.</span></span>

<span data-ttu-id="c14b6-127">Anta till exempel på ett kluster med 4 virtuella datorer och 4 arbetsprocesser, 32 kanal executors och 32 kanal aktiviteter och 256 bult executors och 512 bult uppgifter att hello följande:</span><span class="sxs-lookup"><span data-stu-id="c14b6-127">For example, on a cluster with 4 VMs and 4 worker processes, 32 spout executors and 32 spout tasks, and 256 bolt executors and 512 bolt tasks, consider hello following:</span></span>

<span data-ttu-id="c14b6-128">Varje Övervakare som är en arbetsnod, har en enda worker Java virtual machine (JVM)-processen.</span><span class="sxs-lookup"><span data-stu-id="c14b6-128">Each supervisor, which is a worker node, has a single worker Java virtual machine (JVM) process.</span></span> <span data-ttu-id="c14b6-129">Den här processen JVM hanterar 4 kanal trådar och 64 bult trådar.</span><span class="sxs-lookup"><span data-stu-id="c14b6-129">This JVM process manages 4 spout threads and 64 bolt threads.</span></span> <span data-ttu-id="c14b6-130">Inom varje tråd körs aktiviteter sekventiellt.</span><span class="sxs-lookup"><span data-stu-id="c14b6-130">Within each thread, tasks are run sequentially.</span></span> <span data-ttu-id="c14b6-131">Varje kanal tråd har 1 aktivitet med hello föregående konfiguration, och varje bult tråd har 2 aktiviteter.</span><span class="sxs-lookup"><span data-stu-id="c14b6-131">With hello preceding configuration, each spout thread has 1 task, and each bolt thread has 2 tasks.</span></span>

<span data-ttu-id="c14b6-132">Här följer hello olika komponenter som ingår i Storm, och hur de påverkar hello nivå av parallellitet som du har:</span><span class="sxs-lookup"><span data-stu-id="c14b6-132">In Storm, here are hello various components involved, and how they affect hello level of parallelism you have:</span></span>
* <span data-ttu-id="c14b6-133">hello huvudnod (kallas Nimbus i Storm) är används toosubmit och hantera jobb.</span><span class="sxs-lookup"><span data-stu-id="c14b6-133">hello head node (called Nimbus in Storm) is used toosubmit and manage jobs.</span></span> <span data-ttu-id="c14b6-134">Dessa noder har ingen inverkan på hello grad av parallellitet.</span><span class="sxs-lookup"><span data-stu-id="c14b6-134">These nodes have no impact on hello degree of parallelism.</span></span>
* <span data-ttu-id="c14b6-135">hello handledarens noder.</span><span class="sxs-lookup"><span data-stu-id="c14b6-135">hello supervisor nodes.</span></span> <span data-ttu-id="c14b6-136">I HDInsight motsvarar vilket tooa arbetsnoden Azure VM.</span><span class="sxs-lookup"><span data-stu-id="c14b6-136">In HDInsight, this corresponds tooa worker node Azure VM.</span></span>
* <span data-ttu-id="c14b6-137">hello worker uppgifter är Storm-processer som körs i hello virtuella datorer.</span><span class="sxs-lookup"><span data-stu-id="c14b6-137">hello worker tasks are Storm processes running in hello VMs.</span></span> <span data-ttu-id="c14b6-138">Varje worker aktivitet motsvarar tooa JVM-instans.</span><span class="sxs-lookup"><span data-stu-id="c14b6-138">Each worker task corresponds tooa JVM instance.</span></span> <span data-ttu-id="c14b6-139">Storm distribuerar hello många arbetsprocesser anger du toohello arbetarnoder jämnt som möjligt.</span><span class="sxs-lookup"><span data-stu-id="c14b6-139">Storm distributes hello number of worker processes you specify toohello worker nodes as evenly as possible.</span></span>
* <span data-ttu-id="c14b6-140">Prata och bultar utföraren instanser.</span><span class="sxs-lookup"><span data-stu-id="c14b6-140">Spout and bolt executor instances.</span></span> <span data-ttu-id="c14b6-141">Varje instans utföraren motsvarar tooa tråd körs i hello arbetare (JVMs).</span><span class="sxs-lookup"><span data-stu-id="c14b6-141">Each executor instance corresponds tooa thread running within hello workers (JVMs).</span></span>
* <span data-ttu-id="c14b6-142">Storm-aktiviteter.</span><span class="sxs-lookup"><span data-stu-id="c14b6-142">Storm tasks.</span></span> <span data-ttu-id="c14b6-143">Detta är logiska aktiviteter som var och en av dessa trådar körs.</span><span class="sxs-lookup"><span data-stu-id="c14b6-143">These are logical tasks that each of these threads run.</span></span> <span data-ttu-id="c14b6-144">Detta ändrar inte hello nivå av parallellitet, så att du ska utvärdera om du behöver flera uppgifter per utföraren eller inte.</span><span class="sxs-lookup"><span data-stu-id="c14b6-144">This does not change hello level of parallelism, so you should evaluate if you need multiple tasks per executor or not.</span></span>

### <a name="get-hello-best-performance-from-data-lake-store"></a><span data-ttu-id="c14b6-145">Hämta hello bästa möjliga prestanda från Data Lake Store</span><span class="sxs-lookup"><span data-stu-id="c14b6-145">Get hello best performance from Data Lake Store</span></span>

<span data-ttu-id="c14b6-146">När du arbetar med Data Lake Store kan få du hello bästa prestanda om du hello följande:</span><span class="sxs-lookup"><span data-stu-id="c14b6-146">When working with Data Lake Store, you get hello best performance if you do hello following:</span></span>
* <span data-ttu-id="c14b6-147">Slå samman ett litet lägger till större storlek (helst 4 MB).</span><span class="sxs-lookup"><span data-stu-id="c14b6-147">Coalesce your small appends into larger sizes (ideally 4 MB).</span></span>
* <span data-ttu-id="c14b6-148">Göra så många samtidiga förfrågningar som möjligt.</span><span class="sxs-lookup"><span data-stu-id="c14b6-148">Do as many concurrent requests as you can.</span></span> <span data-ttu-id="c14b6-149">Eftersom varje bult tråd gör blockerande läser du toohave någonstans i hello intervallet 12 8 trådar per kärna.</span><span class="sxs-lookup"><span data-stu-id="c14b6-149">Because each bolt thread is doing blocking reads, you want toohave somewhere in hello range of 8-12 threads per core.</span></span> <span data-ttu-id="c14b6-150">Detta håller hello NIC och hello CPU som också används.</span><span class="sxs-lookup"><span data-stu-id="c14b6-150">This keeps hello NIC and hello CPU well utilized.</span></span> <span data-ttu-id="c14b6-151">En större VM gör det möjligt för flera samtidiga begäranden.</span><span class="sxs-lookup"><span data-stu-id="c14b6-151">A larger VM enables more concurrent requests.</span></span>  

### <a name="example-topology"></a><span data-ttu-id="c14b6-152">Exempeltopologi</span><span class="sxs-lookup"><span data-stu-id="c14b6-152">Example topology</span></span>

<span data-ttu-id="c14b6-153">Anta att du har en 8 worker nodskluster med en D13v2 Azure VM.</span><span class="sxs-lookup"><span data-stu-id="c14b6-153">Let’s assume you have an 8 worker node cluster with a D13v2 Azure VM.</span></span> <span data-ttu-id="c14b6-154">Den här virtuella datorn har 8 kärnor, så hello 8 arbetarnoder bland har 64 Totalt antal kärnor.</span><span class="sxs-lookup"><span data-stu-id="c14b6-154">This VM has 8 cores, so among hello 8 worker nodes, you have 64 total cores.</span></span>

<span data-ttu-id="c14b6-155">Anta att vi gör 8 bult trådar per kärna.</span><span class="sxs-lookup"><span data-stu-id="c14b6-155">Let’s say we do 8 bolt threads per core.</span></span> <span data-ttu-id="c14b6-156">Den angivna 64 kärnor innebär som vi vill 512 totala bult utföraren instanser (det vill säga trådar).</span><span class="sxs-lookup"><span data-stu-id="c14b6-156">Given 64 cores, that means we want 512 total bolt executor instances (that is, threads).</span></span> <span data-ttu-id="c14b6-157">I det här fallet anta att vi börjar med en JVM per virtuell dator och använder främst hello tråd samtidighet inom hello JVM tooachieve samtidighet.</span><span class="sxs-lookup"><span data-stu-id="c14b6-157">In this case, let’s say we start with one JVM per VM, and mainly use hello thread concurrency within hello JVM tooachieve concurrency.</span></span> <span data-ttu-id="c14b6-158">Det innebär att vi behöver 8 worker uppgifter (en per virtuell Azure-dator) och 512 bult executors.</span><span class="sxs-lookup"><span data-stu-id="c14b6-158">That means we need 8 worker tasks (one per Azure VM), and 512 bolt executors.</span></span> <span data-ttu-id="c14b6-159">Med den här konfigurationen Storm försöker toodistribute hello arbetare jämnt över arbetsnoder (även kallat handledarens noder), ger varje arbetsnod 1 JVM.</span><span class="sxs-lookup"><span data-stu-id="c14b6-159">Given this configuration, Storm tries toodistribute hello workers evenly across worker nodes (also known as supervisor nodes), giving each worker node 1 JVM.</span></span> <span data-ttu-id="c14b6-160">Nu inom hello ansvariga försöker Storm toodistribute hello executors jämnt mellan ansvariga, trådar ger varje handledarens (det vill säga JVM) 8 varje.</span><span class="sxs-lookup"><span data-stu-id="c14b6-160">Now within hello supervisors, Storm tries toodistribute hello executors evenly between supervisors, giving each supervisor (that is, JVM) 8 threads each.</span></span>

## <a name="tune-additional-parameters"></a><span data-ttu-id="c14b6-161">Finjustera ytterligare parametrar</span><span class="sxs-lookup"><span data-stu-id="c14b6-161">Tune additional parameters</span></span>
<span data-ttu-id="c14b6-162">När du har grundläggande hello-topologi kan du om du vill tootweak någon av parametrarna hello:</span><span class="sxs-lookup"><span data-stu-id="c14b6-162">After you have hello basic topology, you can consider whether you want tootweak any of hello parameters:</span></span>
* <span data-ttu-id="c14b6-163">**Antal JVMs per arbetsnoden.**</span><span class="sxs-lookup"><span data-stu-id="c14b6-163">**Number of JVMs per worker node.**</span></span> <span data-ttu-id="c14b6-164">Om du har en stor datastruktur (till exempel en uppslagstabell) kräver en separat kopia av du värden i minnet, varje JVM.</span><span class="sxs-lookup"><span data-stu-id="c14b6-164">If you have a large data structure (for example, a lookup table) that you host in memory, each JVM requires a separate copy.</span></span> <span data-ttu-id="c14b6-165">Du kan också använda hello-datastrukturen över många trådar om du har färre JVMs.</span><span class="sxs-lookup"><span data-stu-id="c14b6-165">Alternatively, you can use hello data structure across many threads if you have fewer JVMs.</span></span> <span data-ttu-id="c14b6-166">För hello bult i/o gör hello antalet JVMs inte så stor del av en skillnad som hello antal trådar som har lagts till i dessa JVMs.</span><span class="sxs-lookup"><span data-stu-id="c14b6-166">For hello bolt’s I/O, hello number of JVMs does not make as much of a difference as hello number of threads added across those JVMs.</span></span> <span data-ttu-id="c14b6-167">För enkelhetens skull, är det en bra idé toohave en JVM per worker.</span><span class="sxs-lookup"><span data-stu-id="c14b6-167">For simplicity, it's a good idea toohave one JVM per worker.</span></span> <span data-ttu-id="c14b6-168">Beroende på vad din bult gör eller vilka program som bearbetar du kräva, även om du kanske måste toochange numret.</span><span class="sxs-lookup"><span data-stu-id="c14b6-168">Depending on what your bolt is doing or what application processing you require, though, you may need toochange this number.</span></span>
* <span data-ttu-id="c14b6-169">**Antal kanal executors.**</span><span class="sxs-lookup"><span data-stu-id="c14b6-169">**Number of spout executors.**</span></span> <span data-ttu-id="c14b6-170">Eftersom hello föregående exempel använder bultar för att skriva tooData Datasjölager, hello antal kanaler är inte direkt relevanta toohello bult prestanda.</span><span class="sxs-lookup"><span data-stu-id="c14b6-170">Because hello preceding example uses bolts for writing tooData Lake Store, hello number of spouts is not directly relevant toohello bolt performance.</span></span> <span data-ttu-id="c14b6-171">Hello mycket bearbetning eller i/o som händer i hello kanal är det en bra idé spouts dock tootune hello för bästa prestanda.</span><span class="sxs-lookup"><span data-stu-id="c14b6-171">However, depending on hello amount of processing or I/O happening in hello spout, it's a good idea tootune hello spouts for best performance.</span></span> <span data-ttu-id="c14b6-172">Se till att du har tillräckligt med kanaler toobe kan tookeep hello bultar upptagen.</span><span class="sxs-lookup"><span data-stu-id="c14b6-172">Ensure that you have enough spouts toobe able tookeep hello bolts busy.</span></span> <span data-ttu-id="c14b6-173">hello utdata frekvens av hello kanaler ska matcha hello genomflödet i hello bultar.</span><span class="sxs-lookup"><span data-stu-id="c14b6-173">hello output rates of hello spouts should match hello throughput of hello bolts.</span></span> <span data-ttu-id="c14b6-174">hello faktiska konfigurationen beror på hello-kanal.</span><span class="sxs-lookup"><span data-stu-id="c14b6-174">hello actual configuration depends on hello spout.</span></span>
* <span data-ttu-id="c14b6-175">**Antal uppgifter.**</span><span class="sxs-lookup"><span data-stu-id="c14b6-175">**Number of tasks.**</span></span> <span data-ttu-id="c14b6-176">Varje bult körs som en enskild tråd.</span><span class="sxs-lookup"><span data-stu-id="c14b6-176">Each bolt runs as a single thread.</span></span> <span data-ttu-id="c14b6-177">Ytterligare aktiviteter per bult Ange inte några ytterligare samtidighet.</span><span class="sxs-lookup"><span data-stu-id="c14b6-177">Additional tasks per bolt don't provide any additional concurrency.</span></span> <span data-ttu-id="c14b6-178">hello enda gång de är till nytta är om processen för bekräftades hello tuppel tar en stor del av din bult körningstid.</span><span class="sxs-lookup"><span data-stu-id="c14b6-178">hello only time they are of benefit is if your process of acknowledging hello tuple takes a large proportion of your bolt execution time.</span></span> <span data-ttu-id="c14b6-179">Det är en bra idé toogroup många tupplar i en större läggas till innan du skickar en bekräftelse från hello bulten.</span><span class="sxs-lookup"><span data-stu-id="c14b6-179">It's a good idea toogroup many tuples into a larger append before you send an acknowledgement from hello bolt.</span></span> <span data-ttu-id="c14b6-180">Så i de flesta fall ger inga ytterligare fördelar i flera uppgifter.</span><span class="sxs-lookup"><span data-stu-id="c14b6-180">So, in most cases, multiple tasks provide no additional benefit.</span></span>
* <span data-ttu-id="c14b6-181">**Lokal eller blanda gruppering.**</span><span class="sxs-lookup"><span data-stu-id="c14b6-181">**Local or shuffle grouping.**</span></span> <span data-ttu-id="c14b6-182">När den här inställningen är aktiverad tupplar skickas toobolts inom hello samma arbetsprocesser.</span><span class="sxs-lookup"><span data-stu-id="c14b6-182">When this setting is enabled, tuples are sent toobolts within hello same worker process.</span></span> <span data-ttu-id="c14b6-183">Detta minskar mellan processer anrop för kommunikation och nätverk.</span><span class="sxs-lookup"><span data-stu-id="c14b6-183">This reduces inter-process communication and network calls.</span></span> <span data-ttu-id="c14b6-184">Detta rekommenderas för de flesta topologier.</span><span class="sxs-lookup"><span data-stu-id="c14b6-184">This is recommended for most topologies.</span></span>

<span data-ttu-id="c14b6-185">Det här grundläggande scenariot är en bra utgångspunkt.</span><span class="sxs-lookup"><span data-stu-id="c14b6-185">This basic scenario is a good starting point.</span></span> <span data-ttu-id="c14b6-186">Testa med dina egna data tootweak hello föregående parametrar tooachieve optimala prestanda.</span><span class="sxs-lookup"><span data-stu-id="c14b6-186">Test with your own data tootweak hello preceding parameters tooachieve optimal performance.</span></span>

## <a name="tune-hello-spout"></a><span data-ttu-id="c14b6-187">Finjustera hello kanal</span><span class="sxs-lookup"><span data-stu-id="c14b6-187">Tune hello spout</span></span>

<span data-ttu-id="c14b6-188">Du kan ändra följande inställningar tootune hello kanal hello.</span><span class="sxs-lookup"><span data-stu-id="c14b6-188">You can modify hello following settings tootune hello spout.</span></span>

- <span data-ttu-id="c14b6-189">**Tuppel timeout: topology.message.timeout.secs**.</span><span class="sxs-lookup"><span data-stu-id="c14b6-189">**Tuple timeout: topology.message.timeout.secs**.</span></span> <span data-ttu-id="c14b6-190">Den här inställningen avgör hello lång tid ett meddelande tar toocomplete och få godkännande, innan den anses misslyckades.</span><span class="sxs-lookup"><span data-stu-id="c14b6-190">This setting determines hello amount of time a message takes toocomplete, and receive acknowledgement, before it is considered failed.</span></span>

- <span data-ttu-id="c14b6-191">**Maximalt minne per arbetsprocessen: worker.childopts**.</span><span class="sxs-lookup"><span data-stu-id="c14b6-191">**Max memory per worker process: worker.childopts**.</span></span> <span data-ttu-id="c14b6-192">Den här inställningen kan du ange ytterligare kommandoradsparametrar toohello Java arbetare.</span><span class="sxs-lookup"><span data-stu-id="c14b6-192">This setting lets you specify additional command-line parameters toohello Java workers.</span></span> <span data-ttu-id="c14b6-193">hello vanligaste inställningen här är XmX som bestämmer hello maximalt minne som allokerats tooa JVM heap.</span><span class="sxs-lookup"><span data-stu-id="c14b6-193">hello most commonly used setting here is XmX, which determines hello maximum memory allocated tooa JVM’s heap.</span></span>

- <span data-ttu-id="c14b6-194">**Max kanal väntande: topology.max.spout.pending**.</span><span class="sxs-lookup"><span data-stu-id="c14b6-194">**Max spout pending: topology.max.spout.pending**.</span></span> <span data-ttu-id="c14b6-195">Den här inställningen avgör hello antalet tupplar som kan i svarta (ännu inte bekräftas på alla noder i hello topologi) per kanal tråd när som helst.</span><span class="sxs-lookup"><span data-stu-id="c14b6-195">This setting determines hello number of tuples that can in be flight (not yet acknowledged at all nodes in hello topology) per spout thread at any time.</span></span>

 <span data-ttu-id="c14b6-196">En bra beräkningen toodo är tooestimate hello storlek på din tupplar.</span><span class="sxs-lookup"><span data-stu-id="c14b6-196">A good calculation toodo is tooestimate hello size of each of your tuples.</span></span> <span data-ttu-id="c14b6-197">Sedan ta reda på hur mycket minne en kanal tråd.</span><span class="sxs-lookup"><span data-stu-id="c14b6-197">Then figure out how much memory one spout thread has.</span></span> <span data-ttu-id="c14b6-198">hello totala mängden minne som allokerats tooa tråd, dividerat med det här värdet bör ge dig hello övre gränsen för Hej max kanal väntande parametern.</span><span class="sxs-lookup"><span data-stu-id="c14b6-198">hello total memory allocated tooa thread, divided by this value, should give you hello upper bound for hello max spout pending parameter.</span></span>

## <a name="tune-hello-bolt"></a><span data-ttu-id="c14b6-199">Finjustera hello bult</span><span class="sxs-lookup"><span data-stu-id="c14b6-199">Tune hello bolt</span></span>
<span data-ttu-id="c14b6-200">När du skriver tooData Datasjölager, ange en princip för synkronisering storlek (buffert på klientsidan för hello) too4 MB.</span><span class="sxs-lookup"><span data-stu-id="c14b6-200">When you're writing tooData Lake Store, set a size sync policy (buffer on hello client side) too4 MB.</span></span> <span data-ttu-id="c14b6-201">Lokaliseraren eller hsync() sedan utförs endast när hello buffertstorleken är hello på det här värdet.</span><span class="sxs-lookup"><span data-stu-id="c14b6-201">A flushing or hsync() is then performed only when hello buffer size is hello at this value.</span></span> <span data-ttu-id="c14b6-202">hello Data Lake Store-drivrutinen på hello worker VM använder automatiskt den här buffring såvida inte du uttryckligen utföra en hsync().</span><span class="sxs-lookup"><span data-stu-id="c14b6-202">hello Data Lake Store driver on hello worker VM automatically does this buffering, unless you explicitly perform an hsync().</span></span>

<span data-ttu-id="c14b6-203">hello standard Data Lake Store Storm bult har en storlek sync princip parameter (fileBufferSize) som kan använda tootune den här parametern.</span><span class="sxs-lookup"><span data-stu-id="c14b6-203">hello default Data Lake Store Storm bolt has a size sync policy parameter (fileBufferSize) that can be used tootune this parameter.</span></span>

<span data-ttu-id="c14b6-204">I I/O-intensiva topologier är det en bra idé toohave varje bult tråd skriva tooits egen fil- och tooset en rotation filprincip (fileRotationSize).</span><span class="sxs-lookup"><span data-stu-id="c14b6-204">In I/O-intensive topologies, it's a good idea toohave each bolt thread write tooits own file, and tooset a file rotation policy (fileRotationSize).</span></span> <span data-ttu-id="c14b6-205">När hello-filen når en viss storlek, hello dataströmmen har rensats automatiskt och en ny fil ska skrivas till.</span><span class="sxs-lookup"><span data-stu-id="c14b6-205">When hello file reaches a certain size, hello stream is automatically flushed and a new file is written to.</span></span> <span data-ttu-id="c14b6-206">hello rekommenderas filstorleken för rotation är 1 GB.</span><span class="sxs-lookup"><span data-stu-id="c14b6-206">hello recommended file size for rotation is 1 GB.</span></span>

### <a name="handle-tuple-data"></a><span data-ttu-id="c14b6-207">Hantera tuppel data</span><span class="sxs-lookup"><span data-stu-id="c14b6-207">Handle tuple data</span></span>

<span data-ttu-id="c14b6-208">I Storm innehåller en kanal på tooa tuppel tills tillämpas explicit av hello bulten.</span><span class="sxs-lookup"><span data-stu-id="c14b6-208">In Storm, a spout holds on tooa tuple until it is explicitly acknowledged by hello bolt.</span></span> <span data-ttu-id="c14b6-209">Om en tuppel har lästs av hello bult men har inte bekräftats, kan inte hello kanal beständiga i Data Lake Store-serverdel.</span><span class="sxs-lookup"><span data-stu-id="c14b6-209">If a tuple has been read by hello bolt but has not been acknowledged yet, hello spout might not have persisted into Data Lake Store back end.</span></span> <span data-ttu-id="c14b6-210">När en tuppel bekräftas hello kanal kan garanteras beständiga av hello bult och kan sedan att ta bort hello källdata oavsett läser från källan.</span><span class="sxs-lookup"><span data-stu-id="c14b6-210">After a tuple is acknowledged, hello spout can be guaranteed persistence by hello bolt, and can then delete hello source data from whatever source it is reading from.</span></span>  

<span data-ttu-id="c14b6-211">För bästa prestanda på Data Lake Store har hello bult bufferten 4 MB tuppel data.</span><span class="sxs-lookup"><span data-stu-id="c14b6-211">For best performance on Data Lake Store, have hello bolt buffer 4 MB of tuple data.</span></span> <span data-ttu-id="c14b6-212">Sedan skriva toohello Datasjölager tillbaka avslutas som en 4 MB skrivåtgärder.</span><span class="sxs-lookup"><span data-stu-id="c14b6-212">Then write toohello Data Lake Store back end as one 4-MB write.</span></span> <span data-ttu-id="c14b6-213">Efter hello data har har skrivits toohello store (genom att anropa hflush()) hello bult kan bekräfta hello data tillbaka toohello kanal.</span><span class="sxs-lookup"><span data-stu-id="c14b6-213">After hello data has been successfully written toohello store (by calling hflush()), hello bolt can acknowledge hello data back toohello spout.</span></span> <span data-ttu-id="c14b6-214">Det här är vad hello exempel bultar angivna här finns.</span><span class="sxs-lookup"><span data-stu-id="c14b6-214">This is what hello example bolt supplied here does.</span></span> <span data-ttu-id="c14b6-215">Det är också godkända toohold ett större antal tupplar innan hello hflush() anrop och hello tupplar bekräftas.</span><span class="sxs-lookup"><span data-stu-id="c14b6-215">It is also acceptable toohold a larger number of tuples before hello hflush() call is made and hello tuples acknowledged.</span></span> <span data-ttu-id="c14b6-216">Detta ökar dock hello antalet tupplar som rör sig att hello kanal måste toohold, och därför hello ökar mängden minne som behövs per JVM.</span><span class="sxs-lookup"><span data-stu-id="c14b6-216">However, this increases hello number of tuples in flight that hello spout needs toohold, and therefore increases hello amount of memory required per JVM.</span></span>

> [!NOTE]
<span data-ttu-id="c14b6-217">Program kan ha en krav tooacknowledge tupplar oftare (på datamängder mindre än 4 MB) för andra prestandaskäl.</span><span class="sxs-lookup"><span data-stu-id="c14b6-217">Applications might have a requirement tooacknowledge tuples more frequently (at data sizes less than 4 MB) for other non-performance reasons.</span></span> <span data-ttu-id="c14b6-218">Som kan dock påverka hello i/o genomströmning toohello lagring serverdel.</span><span class="sxs-lookup"><span data-stu-id="c14b6-218">However, that might affect hello I/O throughput toohello storage back end.</span></span> <span data-ttu-id="c14b6-219">Noggrant väga det här förhållandet mot hello bult i/o-prestanda.</span><span class="sxs-lookup"><span data-stu-id="c14b6-219">Carefully weigh this tradeoff against hello bolt’s I/O performance.</span></span>

<span data-ttu-id="c14b6-220">Om hello mottagningshastighet av tupplar är inte hög så hello 4 MB buffert tar en lång tid toofill, bör du åtgärdar detta genom att:</span><span class="sxs-lookup"><span data-stu-id="c14b6-220">If hello incoming rate of tuples is not high, so hello 4-MB buffer takes a long time toofill, consider mitigating this by:</span></span>
* <span data-ttu-id="c14b6-221">Minska hello antalet bultar, så det finns färre buffertar toofill.</span><span class="sxs-lookup"><span data-stu-id="c14b6-221">Reducing hello number of bolts, so there are fewer buffers toofill.</span></span>
* <span data-ttu-id="c14b6-222">Med en tid- eller count-baserad princip, där en hflush() utlöses varje x rensningar eller varje y millisekunder och hello tupplar ackumulerade hittills är bekräftade tillbaka.</span><span class="sxs-lookup"><span data-stu-id="c14b6-222">Having a time-based or count-based policy, where an hflush() is triggered every x flushes or every y milliseconds, and hello tuples accumulated so far are acknowledged back.</span></span>

<span data-ttu-id="c14b6-223">Observera att hello genomflöde i det här fallet är lägre men med låg hastighet av händelser, maximalt dataflöde kan inte hello största mål ändå.</span><span class="sxs-lookup"><span data-stu-id="c14b6-223">Note that hello throughput in this case is lower, but with a slow rate of events, maximum throughput is not hello biggest objective anyway.</span></span> <span data-ttu-id="c14b6-224">Dessa åtgärder hjälper dig att minska hello totala tid det tar för en tuppel tooflow via toohello store.</span><span class="sxs-lookup"><span data-stu-id="c14b6-224">These mitigations help you reduce hello total time that it takes for a tuple tooflow through toohello store.</span></span> <span data-ttu-id="c14b6-225">Detta kan roll om du vill använda en realtid pipeline även med en låg händelsehastighet.</span><span class="sxs-lookup"><span data-stu-id="c14b6-225">This might matter if you want a real-time pipeline even with a low event rate.</span></span> <span data-ttu-id="c14b6-226">Även Observera att din inkommande tuppel frekvensen är låg, bör justera hello topology.message.timeout_secs parameter, så hello tupplar inte timeout när de får en buffert eller bearbetas.</span><span class="sxs-lookup"><span data-stu-id="c14b6-226">Also note that if your incoming tuple rate is low, you should adjust hello topology.message.timeout_secs parameter, so hello tuples don’t time out while they are getting buffered or processed.</span></span>

## <a name="monitor-your-topology-in-storm"></a><span data-ttu-id="c14b6-227">Övervaka topologin i Storm</span><span class="sxs-lookup"><span data-stu-id="c14b6-227">Monitor your topology in Storm</span></span>  
<span data-ttu-id="c14b6-228">När din topologi körs, kan du övervaka den i hello Storm-användargränssnittet.</span><span class="sxs-lookup"><span data-stu-id="c14b6-228">While your topology is running, you can monitor it in hello Storm user interface.</span></span> <span data-ttu-id="c14b6-229">Här följer hello huvudsakliga parametrar toolook på:</span><span class="sxs-lookup"><span data-stu-id="c14b6-229">Here are hello main parameters toolook at:</span></span>

* <span data-ttu-id="c14b6-230">**Totalt antal processen körning svarstid.**</span><span class="sxs-lookup"><span data-stu-id="c14b6-230">**Total process execution latency.**</span></span> <span data-ttu-id="c14b6-231">Detta är hello genomsnittstiden en tuppel tar toobe sänds av hello kanal bearbetas av hello bult och bekräftas.</span><span class="sxs-lookup"><span data-stu-id="c14b6-231">This is hello average time one tuple takes toobe emitted by hello spout, processed by hello bolt, and acknowledged.</span></span>

* <span data-ttu-id="c14b6-232">**Totalt antal bult processen svarstid.**</span><span class="sxs-lookup"><span data-stu-id="c14b6-232">**Total bolt process latency.**</span></span> <span data-ttu-id="c14b6-233">Detta är hello Genomsnittlig tid av hello tuppel på hello bult tills det mottar en bekräftelse.</span><span class="sxs-lookup"><span data-stu-id="c14b6-233">This is hello average time spent by hello tuple at hello bolt until it receives an acknowledgement.</span></span>

* <span data-ttu-id="c14b6-234">**Totalt antal bult köra svarstid.**</span><span class="sxs-lookup"><span data-stu-id="c14b6-234">**Total bolt execute latency.**</span></span> <span data-ttu-id="c14b6-235">Detta är hello Genomsnittlig tid som användes av hello bult i hello execute-metoden.</span><span class="sxs-lookup"><span data-stu-id="c14b6-235">This is hello average time spent by hello bolt in hello execute method.</span></span>

* <span data-ttu-id="c14b6-236">**Antal fel.**</span><span class="sxs-lookup"><span data-stu-id="c14b6-236">**Number of failures.**</span></span> <span data-ttu-id="c14b6-237">Detta refererar toohello antalet tupplar som inte kunde bearbetas fullständigt innan de tidsgränsen toobe.</span><span class="sxs-lookup"><span data-stu-id="c14b6-237">This refers toohello number of tuples that failed toobe fully processed before they timed out.</span></span>

* <span data-ttu-id="c14b6-238">**Kapacitet.**</span><span class="sxs-lookup"><span data-stu-id="c14b6-238">**Capacity.**</span></span> <span data-ttu-id="c14b6-239">Detta är ett mått på hur upptagen systemet är.</span><span class="sxs-lookup"><span data-stu-id="c14b6-239">This is a measure of how busy your system is.</span></span> <span data-ttu-id="c14b6-240">Om värdet är 1, fungerar lika snabbt som de kan din bultar.</span><span class="sxs-lookup"><span data-stu-id="c14b6-240">If this number is 1, your bolts are working as fast as they can.</span></span> <span data-ttu-id="c14b6-241">Om det är mindre än 1, öka hello parallellitet.</span><span class="sxs-lookup"><span data-stu-id="c14b6-241">If it is less than 1, increase hello parallelism.</span></span> <span data-ttu-id="c14b6-242">Om den är större än 1, minska hello parallellitet.</span><span class="sxs-lookup"><span data-stu-id="c14b6-242">If it is greater than 1, reduce hello parallelism.</span></span>

## <a name="troubleshoot-common-problems"></a><span data-ttu-id="c14b6-243">Felsöka vanliga problem</span><span class="sxs-lookup"><span data-stu-id="c14b6-243">Troubleshoot common problems</span></span>
<span data-ttu-id="c14b6-244">Här följer några vanliga scenarier för felsökning.</span><span class="sxs-lookup"><span data-stu-id="c14b6-244">Here are a few common troubleshooting scenarios.</span></span>
* <span data-ttu-id="c14b6-245">**Många tupplar uppnådd tidsgräns.** Titta på varje nod i hello topologi toodetermine där hello flaskhalsen är.</span><span class="sxs-lookup"><span data-stu-id="c14b6-245">**Many tuples are timing out.** Look at each node in hello topology toodetermine where hello bottleneck is.</span></span> <span data-ttu-id="c14b6-246">hello vanligaste anledningen är att hello bultar inte är kan tookeep upp med hello kanaler.</span><span class="sxs-lookup"><span data-stu-id="c14b6-246">hello most common reason for this is that hello bolts are not able tookeep up with hello spouts.</span></span> <span data-ttu-id="c14b6-247">Detta leder tootuples belastning hello interna buffertar när väntar toobe bearbetas.</span><span class="sxs-lookup"><span data-stu-id="c14b6-247">This leads tootuples clogging hello internal buffers while waiting toobe processed.</span></span> <span data-ttu-id="c14b6-248">Överväg att öka hello timeout-värde eller minska Hej max kanal väntande.</span><span class="sxs-lookup"><span data-stu-id="c14b6-248">Consider increasing hello timeout value or decreasing hello max spout pending.</span></span>

* <span data-ttu-id="c14b6-249">**Det finns en hög totala processen körning svarstid, men en låg bult processen fördröjning.**</span><span class="sxs-lookup"><span data-stu-id="c14b6-249">**There is a high total process execution latency, but a low bolt process latency.**</span></span> <span data-ttu-id="c14b6-250">I det här fallet är det möjligt att hello tupplar inte är som ska bekräftas tillräckligt snabbt.</span><span class="sxs-lookup"><span data-stu-id="c14b6-250">In this case, it is possible that hello tuples are not being acknowledged fast enough.</span></span> <span data-ttu-id="c14b6-251">Kontrollera att det finns ett tillräckligt antal acknowledgers.</span><span class="sxs-lookup"><span data-stu-id="c14b6-251">Check that there are a sufficient number of acknowledgers.</span></span> <span data-ttu-id="c14b6-252">En annan möjlighet är att de väntar i hello kö för länge innan hello bolts start behandla dem.</span><span class="sxs-lookup"><span data-stu-id="c14b6-252">Another possibility is that they are waiting in hello queue for too long before hello bolts start processing them.</span></span> <span data-ttu-id="c14b6-253">Minska Hej max kanal väntande.</span><span class="sxs-lookup"><span data-stu-id="c14b6-253">Decrease hello max spout pending.</span></span>

* <span data-ttu-id="c14b6-254">**Det finns en hög bult köra svarstid.**</span><span class="sxs-lookup"><span data-stu-id="c14b6-254">**There is a high bolt execute latency.**</span></span> <span data-ttu-id="c14b6-255">Det innebär att hello execute() metod för din bult tar för lång.</span><span class="sxs-lookup"><span data-stu-id="c14b6-255">This means that hello execute() method of your bolt is taking too long.</span></span> <span data-ttu-id="c14b6-256">Optimera hello-koden eller titta på skrivning storlekar och rensa beteende.</span><span class="sxs-lookup"><span data-stu-id="c14b6-256">Optimize hello code, or look at write sizes and flush behavior.</span></span>

### <a name="data-lake-store-throttling"></a><span data-ttu-id="c14b6-257">Begränsning av data Lake Store</span><span class="sxs-lookup"><span data-stu-id="c14b6-257">Data Lake Store throttling</span></span>
<span data-ttu-id="c14b6-258">Om du träffar hello gränserna för bandbredd som tillhandahålls av Data Lake Store, kan du se misslyckade aktiviteter.</span><span class="sxs-lookup"><span data-stu-id="c14b6-258">If you hit hello limits of bandwidth provided by Data Lake Store, you might see task failures.</span></span> <span data-ttu-id="c14b6-259">Uppgiften loggarna för begränsning av fel.</span><span class="sxs-lookup"><span data-stu-id="c14b6-259">Check task logs for throttling errors.</span></span> <span data-ttu-id="c14b6-260">Du kan minska hello parallellitet genom att öka storleken på behållaren.</span><span class="sxs-lookup"><span data-stu-id="c14b6-260">You can decrease hello parallelism by increasing container size.</span></span>    

<span data-ttu-id="c14b6-261">toocheck om du har komma begränsats aktivera hello felsökningsloggning på klientsidan för hello:</span><span class="sxs-lookup"><span data-stu-id="c14b6-261">toocheck if you are getting throttled, enable hello debug logging on hello client side:</span></span>

1. <span data-ttu-id="c14b6-262">I **Ambari** > **Storm** > **Config** > **avancerade storm-worker-log4j**, ändra  **&lt;rot nivå = ”info”&gt;**  för**&lt;rot nivå = ”debug”&gt;**.</span><span class="sxs-lookup"><span data-stu-id="c14b6-262">In **Ambari** > **Storm** > **Config** > **Advanced storm-worker-log4j**, change **&lt;root level="info"&gt;** too**&lt;root level=”debug”&gt;**.</span></span> <span data-ttu-id="c14b6-263">Starta om alla hello noder/för hello configuration tootake effekt.</span><span class="sxs-lookup"><span data-stu-id="c14b6-263">Restart all hello nodes/service for hello configuration tootake effect.</span></span>
2. <span data-ttu-id="c14b6-264">Övervakaren hello Storm-topologi som loggar in arbetarnoder (under /var/log/storm/worker-artifacts /&lt;TopologyName&gt;/&lt;port&gt;/worker.log) för Data Lake Store begränsning undantag.</span><span class="sxs-lookup"><span data-stu-id="c14b6-264">Monitor hello Storm topology logs on worker nodes (under /var/log/storm/worker-artifacts/&lt;TopologyName&gt;/&lt;port&gt;/worker.log) for Data Lake Store throttling exceptions.</span></span>

## <a name="next-steps"></a><span data-ttu-id="c14b6-265">Nästa steg</span><span class="sxs-lookup"><span data-stu-id="c14b6-265">Next steps</span></span>
<span data-ttu-id="c14b6-266">Ytterligare prestandajustering för Storm kan refereras i [bloggen](https://blogs.msdn.microsoft.com/shanyu/2015/05/14/performance-tuning-for-hdinsight-storm-and-microsoft-azure-eventhubs/).</span><span class="sxs-lookup"><span data-stu-id="c14b6-266">Additional performance tuning for Storm can be referenced in [this blog](https://blogs.msdn.microsoft.com/shanyu/2015/05/14/performance-tuning-for-hdinsight-storm-and-microsoft-azure-eventhubs/).</span></span>

<span data-ttu-id="c14b6-267">Ett ytterligare exempel toorun finns [denna som finns på GitHub](https://github.com/hdinsight/storm-performance-automation).</span><span class="sxs-lookup"><span data-stu-id="c14b6-267">For an additional example toorun, see [this one on GitHub](https://github.com/hdinsight/storm-performance-automation).</span></span>
