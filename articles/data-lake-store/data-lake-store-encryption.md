---
title: aaaEncryption i Azure Data Lake Store | Microsoft Docs
description: "Så här fungerar kryptering och nyckelrotation i Azure Data Lake Store"
services: data-lake-store
documentationcenter: 
author: yagupta
manager: 
editor: 
ms.assetid: 
ms.service: data-lake-store
ms.devlang: na
ms.topic: get-started-article
ms.tgt_pltfrm: na
ms.workload: big-data
ms.date: 4/14/2017
ms.author: yagupta
ms.openlocfilehash: a9f3a2dce8232deba93005594d1e6a21e9c0cbee
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 10/06/2017
---
# <a name="encryption-of-data-in-azure-data-lake-store"></a><span data-ttu-id="94f10-103">Kryptera data i Azure Data Lake Store</span><span class="sxs-lookup"><span data-stu-id="94f10-103">Encryption of data in Azure Data Lake Store</span></span>

<span data-ttu-id="94f10-104">Du kan skydda dina data, implementera säkerhetsprinciper och uppfylla efterlevnadskrav med hjälp av kryptering i Azure Data Lake Store.</span><span class="sxs-lookup"><span data-stu-id="94f10-104">Encryption in Azure Data Lake Store helps you protect your data, implement enterprise security policies, and meet regulatory compliance requirements.</span></span> <span data-ttu-id="94f10-105">Den här artikeln innehåller en översikt över hello design och beskrivs några av hello tekniska aspekter för implementering.</span><span class="sxs-lookup"><span data-stu-id="94f10-105">This article provides an overview of hello design, and discusses some of hello technical aspects of implementation.</span></span>

<span data-ttu-id="94f10-106">Data Lake Store har stöd för kryptering av vilande data och data under överföringen.</span><span class="sxs-lookup"><span data-stu-id="94f10-106">Data Lake Store supports encryption of data both at rest and in transit.</span></span> <span data-ttu-id="94f10-107">Data Lake Store stöder transparent kryptering av vilande data som är på som standard.</span><span class="sxs-lookup"><span data-stu-id="94f10-107">For data at rest, Data Lake Store supports "on by default," transparent encryption.</span></span> <span data-ttu-id="94f10-108">En liten förklaring av vad detta betyder:</span><span class="sxs-lookup"><span data-stu-id="94f10-108">Here is what these terms mean in a bit more detail:</span></span>

* <span data-ttu-id="94f10-109">**På som standard**: när du skapar ett nytt Data Lake Store-konto hello standardinställningen aktiverar kryptering.</span><span class="sxs-lookup"><span data-stu-id="94f10-109">**On by default**: When you create a new Data Lake Store account, hello default setting enables encryption.</span></span> <span data-ttu-id="94f10-110">Därefter är data som lagras i Data Lake Store alltid krypterat tidigare toostoring på beständiga media.</span><span class="sxs-lookup"><span data-stu-id="94f10-110">Thereafter, data that is stored in Data Lake Store is always encrypted prior toostoring on persistent media.</span></span> <span data-ttu-id="94f10-111">Det är hello som gäller för alla data och kan inte ändras efter att ett konto skapas.</span><span class="sxs-lookup"><span data-stu-id="94f10-111">This is hello behavior for all data, and it cannot be changed after an account is created.</span></span>
* <span data-ttu-id="94f10-112">**Transparent**: Data Lake Store automatiskt data tidigare toopersisting krypterar och dekrypterar data tidigare tooretrieval.</span><span class="sxs-lookup"><span data-stu-id="94f10-112">**Transparent**: Data Lake Store automatically encrypts data prior toopersisting, and decrypts data prior tooretrieval.</span></span> <span data-ttu-id="94f10-113">hello kryptering konfigureras och hanteras på hello Data Lake Store nivå av en administratör.</span><span class="sxs-lookup"><span data-stu-id="94f10-113">hello encryption is configured and managed at hello Data Lake Store level by an administrator.</span></span> <span data-ttu-id="94f10-114">Inga ändringar görs toohello data API: er.</span><span class="sxs-lookup"><span data-stu-id="94f10-114">No changes are made toohello data access APIs.</span></span> <span data-ttu-id="94f10-115">Därför krävs inga ändringar i de program och tjänster som interagerar med Data Lake Store på grund av krypteringen.</span><span class="sxs-lookup"><span data-stu-id="94f10-115">Thus, no changes are required in applications and services that interact with Data Lake Store because of encryption.</span></span>

<span data-ttu-id="94f10-116">Data under överföring (även kallat data i rörelse) krypteras också alltid i Data Lake Store.</span><span class="sxs-lookup"><span data-stu-id="94f10-116">Data in transit (also known as data in motion) is also always encrypted in Data Lake Store.</span></span> <span data-ttu-id="94f10-117">Dessutom tooencrypting data tidigare toostoring toopersistent media hello data alltid skyddas under överföringen med hjälp av HTTPS.</span><span class="sxs-lookup"><span data-stu-id="94f10-117">In addition tooencrypting data prior toostoring toopersistent media, hello data is also always secured in transit by using HTTPS.</span></span> <span data-ttu-id="94f10-118">HTTPS är hello enda protokoll som stöds för hello Data Lake Store REST-gränssnitt.</span><span class="sxs-lookup"><span data-stu-id="94f10-118">HTTPS is hello only protocol that is supported for hello Data Lake Store REST interfaces.</span></span> <span data-ttu-id="94f10-119">hello följande diagram visar hur data blir krypterade i Data Lake Store:</span><span class="sxs-lookup"><span data-stu-id="94f10-119">hello following diagram shows how data becomes encrypted in Data Lake Store:</span></span>

![Diagram över kryptering i Data Lake Store](./media/data-lake-store-encryption/fig1.png)


## <a name="set-up-encryption-with-data-lake-store"></a><span data-ttu-id="94f10-121">Konfigurera kryptering med Data Lake Store</span><span class="sxs-lookup"><span data-stu-id="94f10-121">Set up encryption with Data Lake Store</span></span>

<span data-ttu-id="94f10-122">Kryptering för Data Lake Store ställs in när kontot skapas, och är alltid aktiverat som standard.</span><span class="sxs-lookup"><span data-stu-id="94f10-122">Encryption for Data Lake Store is set up during account creation, and it is always enabled by default.</span></span> <span data-ttu-id="94f10-123">Du kan antingen hantera hello nycklar själv eller tillåta Data Lake Store toomanage dem du (detta är hello standard).</span><span class="sxs-lookup"><span data-stu-id="94f10-123">You can either manage hello keys yourself, or allow Data Lake Store toomanage them for you (this is hello default).</span></span>

<span data-ttu-id="94f10-124">Mer information finns i [Komma igång](https://docs.microsoft.com/azure/data-lake-store/data-lake-store-get-started-portal).</span><span class="sxs-lookup"><span data-stu-id="94f10-124">For more information, see [Getting started](https://docs.microsoft.com/azure/data-lake-store/data-lake-store-get-started-portal).</span></span>

## <a name="how-encryption-works-in-data-lake-store"></a><span data-ttu-id="94f10-125">Så här fungerar kryptering i Data Lake Store</span><span class="sxs-lookup"><span data-stu-id="94f10-125">How encryption works in Data Lake Store</span></span>

<span data-ttu-id="94f10-126">hello beskriver följande information hur toomanage master krypteringsnycklar och det förklarar hello tre olika typer av nycklar som du kan använda datakryptering för Data Lake Store.</span><span class="sxs-lookup"><span data-stu-id="94f10-126">hello following information covers how toomanage master encryption keys, and it explains hello three different types of keys you can use in data encryption for Data Lake Store.</span></span>

### <a name="master-encryption-keys"></a><span data-ttu-id="94f10-127">Huvudkrypteringsnycklar</span><span class="sxs-lookup"><span data-stu-id="94f10-127">Master encryption keys</span></span>

<span data-ttu-id="94f10-128">Data Lake Store har två lägen för hantering av huvudkrypteringsnycklar (Master, Encryption Keys, MEK).</span><span class="sxs-lookup"><span data-stu-id="94f10-128">Data Lake Store provides two modes for management of master encryption keys (MEKs).</span></span> <span data-ttu-id="94f10-129">Anta att hello huvudkrypteringsnyckel är hello högsta nyckeln för tillfället.</span><span class="sxs-lookup"><span data-stu-id="94f10-129">For now, assume that hello master encryption key is hello top-level key.</span></span> <span data-ttu-id="94f10-130">Åtkomst toohello huvudkrypteringsnyckel är obligatoriska toodecrypt några data som lagras i Data Lake Store.</span><span class="sxs-lookup"><span data-stu-id="94f10-130">Access toohello master encryption key is required toodecrypt any data stored in Data Lake Store.</span></span>

<span data-ttu-id="94f10-131">hello två lägen för att hantera hello huvudkrypteringsnyckel är följande:</span><span class="sxs-lookup"><span data-stu-id="94f10-131">hello two modes for managing hello master encryption key are as follows:</span></span>

*   <span data-ttu-id="94f10-132">Tjänsthanterade nycklar</span><span class="sxs-lookup"><span data-stu-id="94f10-132">Service managed keys</span></span>
*   <span data-ttu-id="94f10-133">Kundhanterade nycklar</span><span class="sxs-lookup"><span data-stu-id="94f10-133">Customer managed keys</span></span>

<span data-ttu-id="94f10-134">I båda lägena skyddas hello huvudkrypteringsnyckel genom att lagra det i Azure Key Vault.</span><span class="sxs-lookup"><span data-stu-id="94f10-134">In both modes, hello master encryption key is secured by storing it in Azure Key Vault.</span></span> <span data-ttu-id="94f10-135">Key Vault är en helt hanterad tjänst mycket säkert på Azure som kan använda toosafeguard kryptografiska nycklar.</span><span class="sxs-lookup"><span data-stu-id="94f10-135">Key Vault is a fully managed, highly secure service on Azure that can be used toosafeguard cryptographic keys.</span></span> <span data-ttu-id="94f10-136">Mer information finns i [Key Vault](https://azure.microsoft.com/services/key-vault).</span><span class="sxs-lookup"><span data-stu-id="94f10-136">For more information, see [Key Vault](https://azure.microsoft.com/services/key-vault).</span></span>

<span data-ttu-id="94f10-137">Här är en kort jämförelse av funktioner som tillhandahålls av hello två lägen för att hantera hello MEKs.</span><span class="sxs-lookup"><span data-stu-id="94f10-137">Here is a brief comparison of capabilities provided by hello two modes of managing hello MEKs.</span></span>

|  | <span data-ttu-id="94f10-138">Tjänsthanterade nycklar</span><span class="sxs-lookup"><span data-stu-id="94f10-138">Service managed keys</span></span> | <span data-ttu-id="94f10-139">Kundhanterade nycklar</span><span class="sxs-lookup"><span data-stu-id="94f10-139">Customer managed keys</span></span> |
| --- | --- | --- |
|<span data-ttu-id="94f10-140">Hur lagras data?</span><span class="sxs-lookup"><span data-stu-id="94f10-140">How is data stored?</span></span>|<span data-ttu-id="94f10-141">Alltid krypterade tidigare toobeing lagras.</span><span class="sxs-lookup"><span data-stu-id="94f10-141">Always encrypted prior toobeing stored.</span></span>|<span data-ttu-id="94f10-142">Alltid krypterade tidigare toobeing lagras.</span><span class="sxs-lookup"><span data-stu-id="94f10-142">Always encrypted prior toobeing stored.</span></span>|
|<span data-ttu-id="94f10-143">Var lagras hello kryptering huvudnyckel?</span><span class="sxs-lookup"><span data-stu-id="94f10-143">Where is hello Master Encryption Key stored?</span></span>|<span data-ttu-id="94f10-144">Key Vault</span><span class="sxs-lookup"><span data-stu-id="94f10-144">Key Vault</span></span>|<span data-ttu-id="94f10-145">Key Vault</span><span class="sxs-lookup"><span data-stu-id="94f10-145">Key Vault</span></span>|
|<span data-ttu-id="94f10-146">Är kryptering nycklar lagrade i hello Rensa utanför Key Vault?</span><span class="sxs-lookup"><span data-stu-id="94f10-146">Are any encryption keys stored in hello clear outside of Key Vault?</span></span> |<span data-ttu-id="94f10-147">Nej</span><span class="sxs-lookup"><span data-stu-id="94f10-147">No</span></span>|<span data-ttu-id="94f10-148">Nej</span><span class="sxs-lookup"><span data-stu-id="94f10-148">No</span></span>|
|<span data-ttu-id="94f10-149">Kan hello MEK hämtas av Key Vault?</span><span class="sxs-lookup"><span data-stu-id="94f10-149">Can hello MEK be retrieved by Key Vault?</span></span>|<span data-ttu-id="94f10-150">Nej.</span><span class="sxs-lookup"><span data-stu-id="94f10-150">No.</span></span> <span data-ttu-id="94f10-151">Efter hello MEK lagras i Nyckelvalvet, kan den bara användas för kryptering och dekryptering.</span><span class="sxs-lookup"><span data-stu-id="94f10-151">After hello MEK is stored in Key Vault, it can only be used for encryption and decryption.</span></span>|<span data-ttu-id="94f10-152">Nej.</span><span class="sxs-lookup"><span data-stu-id="94f10-152">No.</span></span> <span data-ttu-id="94f10-153">Efter hello MEK lagras i Nyckelvalvet, kan den bara användas för kryptering och dekryptering.</span><span class="sxs-lookup"><span data-stu-id="94f10-153">After hello MEK is stored in Key Vault, it can only be used for encryption and decryption.</span></span>|
|<span data-ttu-id="94f10-154">Vem äger hello Key Vault-instans och hello MEK?</span><span class="sxs-lookup"><span data-stu-id="94f10-154">Who owns hello Key Vault instance and hello MEK?</span></span>|<span data-ttu-id="94f10-155">hello Data Lake Store-tjänsten</span><span class="sxs-lookup"><span data-stu-id="94f10-155">hello Data Lake Store service</span></span>|<span data-ttu-id="94f10-156">Du äger hello Key Vault-instansen, som ingår i din egen Azure-prenumeration.</span><span class="sxs-lookup"><span data-stu-id="94f10-156">You own hello Key Vault instance, which belongs in your own Azure subscription.</span></span> <span data-ttu-id="94f10-157">Hej MEK i Key Vault kan hanteras av programvara eller maskinvara.</span><span class="sxs-lookup"><span data-stu-id="94f10-157">hello MEK in Key Vault can be managed by software or hardware.</span></span>|
|<span data-ttu-id="94f10-158">Kan du återkalla åtkomst toohello MEK för hello Data Lake Store-tjänsten?</span><span class="sxs-lookup"><span data-stu-id="94f10-158">Can you revoke access toohello MEK for hello Data Lake Store service?</span></span>|<span data-ttu-id="94f10-159">Nej</span><span class="sxs-lookup"><span data-stu-id="94f10-159">No</span></span>|<span data-ttu-id="94f10-160">Ja.</span><span class="sxs-lookup"><span data-stu-id="94f10-160">Yes.</span></span> <span data-ttu-id="94f10-161">Du kan hantera åtkomstkontrollistor i Nyckelvalvet och ta bort tjänstidentiteten för access control poster toohello för hello Data Lake Store-tjänsten.</span><span class="sxs-lookup"><span data-stu-id="94f10-161">You can manage access control lists in Key Vault, and remove access control entries toohello service identity for hello Data Lake Store service.</span></span>|
|<span data-ttu-id="94f10-162">Kan du ta bort permanent hello MEK?</span><span class="sxs-lookup"><span data-stu-id="94f10-162">Can you permanently delete hello MEK?</span></span>|<span data-ttu-id="94f10-163">Nej</span><span class="sxs-lookup"><span data-stu-id="94f10-163">No</span></span>|<span data-ttu-id="94f10-164">Ja.</span><span class="sxs-lookup"><span data-stu-id="94f10-164">Yes.</span></span> <span data-ttu-id="94f10-165">Om du tar bort hello MEK från Nyckelvalvet kan hello data i hello Data Lake Store-konto inte dekrypteras av vem som helst, inklusive hello Data Lake Store-tjänsten.</span><span class="sxs-lookup"><span data-stu-id="94f10-165">If you delete hello MEK from Key Vault, hello data in hello Data Lake Store account cannot be decrypted by anyone, including hello Data Lake Store service.</span></span> <br><br> <span data-ttu-id="94f10-166">Om du har uttryckligen säkerhetskopierade hello MEK tidigare toodeleting den från Nyckelvalvet, hello MEK kan återställas och hello data kan återställas.</span><span class="sxs-lookup"><span data-stu-id="94f10-166">If you have explicitly backed up hello MEK prior toodeleting it from Key Vault, hello MEK can be restored, and hello data can then be recovered.</span></span> <span data-ttu-id="94f10-167">Men om du inte säkerhetskopierat hello MEK tidigare toodeleting den från Nyckelvalvet, kan hello data i hello Data Lake Store-konto aldrig dekrypteras därefter.</span><span class="sxs-lookup"><span data-stu-id="94f10-167">However, if you have not backed up hello MEK prior toodeleting it from Key Vault, hello data in hello Data Lake Store account can never be decrypted thereafter.</span></span>|


<span data-ttu-id="94f10-168">Utöver den här skillnaden mellan som hanterar hello MEK och hello Key Vault-instans där den finns, hello resten av hello design är hello samma för båda lägena.</span><span class="sxs-lookup"><span data-stu-id="94f10-168">Aside from this difference of who manages hello MEK and hello Key Vault instance in which it resides, hello rest of hello design is hello same for both modes.</span></span>

<span data-ttu-id="94f10-169">Det är viktigt tooremember hello följande när du väljer hello-läge för hello master krypteringsnycklar:</span><span class="sxs-lookup"><span data-stu-id="94f10-169">It's important tooremember hello following when you choose hello mode for hello master encryption keys:</span></span>

*   <span data-ttu-id="94f10-170">Du kan välja om toouse kundhanterad nycklar eller för tjänsten hanteras när du etablerar ett Data Lake Store-konto.</span><span class="sxs-lookup"><span data-stu-id="94f10-170">You can choose whether toouse customer managed keys or service managed keys when you provision a Data Lake Store account.</span></span>
*   <span data-ttu-id="94f10-171">När ett Data Lake Store-konto har etablerats kan inte hello-läge ändras.</span><span class="sxs-lookup"><span data-stu-id="94f10-171">After a Data Lake Store account is provisioned, hello mode cannot be changed.</span></span>

### <a name="encryption-and-decryption-of-data"></a><span data-ttu-id="94f10-172">Kryptering och dekryptering av data</span><span class="sxs-lookup"><span data-stu-id="94f10-172">Encryption and decryption of data</span></span>

<span data-ttu-id="94f10-173">Det finns tre typer av nycklar som används i hello utformning av datakryptering.</span><span class="sxs-lookup"><span data-stu-id="94f10-173">There are three types of keys that are used in hello design of data encryption.</span></span> <span data-ttu-id="94f10-174">hello följande tabell innehåller en översikt:</span><span class="sxs-lookup"><span data-stu-id="94f10-174">hello following table provides a summary:</span></span>

| <span data-ttu-id="94f10-175">Nyckel</span><span class="sxs-lookup"><span data-stu-id="94f10-175">Key</span></span>                   | <span data-ttu-id="94f10-176">Förkortning</span><span class="sxs-lookup"><span data-stu-id="94f10-176">Abbreviation</span></span> | <span data-ttu-id="94f10-177">Kopplad till</span><span class="sxs-lookup"><span data-stu-id="94f10-177">Associated with</span></span> | <span data-ttu-id="94f10-178">Lagringsplats</span><span class="sxs-lookup"><span data-stu-id="94f10-178">Storage location</span></span>                             | <span data-ttu-id="94f10-179">Typ</span><span class="sxs-lookup"><span data-stu-id="94f10-179">Type</span></span>       | <span data-ttu-id="94f10-180">Anteckningar</span><span class="sxs-lookup"><span data-stu-id="94f10-180">Notes</span></span>                                                                                                   |
|-----------------------|--------------|-----------------|----------------------------------------------|------------|---------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="94f10-181">Huvudkrypteringsnyckel</span><span class="sxs-lookup"><span data-stu-id="94f10-181">Master Encryption Key</span></span> | <span data-ttu-id="94f10-182">MEK</span><span class="sxs-lookup"><span data-stu-id="94f10-182">MEK</span></span>          | <span data-ttu-id="94f10-183">Ett Data Lake Store-konto</span><span class="sxs-lookup"><span data-stu-id="94f10-183">A Data Lake Store account</span></span> | <span data-ttu-id="94f10-184">Key Vault</span><span class="sxs-lookup"><span data-stu-id="94f10-184">Key Vault</span></span>                              | <span data-ttu-id="94f10-185">Asymmetrisk</span><span class="sxs-lookup"><span data-stu-id="94f10-185">Asymmetric</span></span> | <span data-ttu-id="94f10-186">Det kan hanteras av Data Lake Store eller dig.</span><span class="sxs-lookup"><span data-stu-id="94f10-186">It can be managed by Data Lake Store or you.</span></span>                                                              |
| <span data-ttu-id="94f10-187">Datakrypteringsnyckel</span><span class="sxs-lookup"><span data-stu-id="94f10-187">Data Encryption Key</span></span>   | <span data-ttu-id="94f10-188">DEK</span><span class="sxs-lookup"><span data-stu-id="94f10-188">DEK</span></span>          | <span data-ttu-id="94f10-189">Ett Data Lake Store-konto</span><span class="sxs-lookup"><span data-stu-id="94f10-189">A Data Lake Store account</span></span> | <span data-ttu-id="94f10-190">Beständig lagring – hanteras av Data Lake Store-tjänsten</span><span class="sxs-lookup"><span data-stu-id="94f10-190">Persistent storage, managed by Data Lake Store service</span></span> | <span data-ttu-id="94f10-191">Symmetrisk</span><span class="sxs-lookup"><span data-stu-id="94f10-191">Symmetric</span></span>  | <span data-ttu-id="94f10-192">Hej DEK krypteras med hello MEK.</span><span class="sxs-lookup"><span data-stu-id="94f10-192">hello DEK is encrypted by hello MEK.</span></span> <span data-ttu-id="94f10-193">hello krypterade DEK är vad som lagras på beständiga media.</span><span class="sxs-lookup"><span data-stu-id="94f10-193">hello encrypted DEK is what is stored on persistent media.</span></span> |
| <span data-ttu-id="94f10-194">Blockkrypteringsnyckel</span><span class="sxs-lookup"><span data-stu-id="94f10-194">Block Encryption Key</span></span>  | <span data-ttu-id="94f10-195">BEK</span><span class="sxs-lookup"><span data-stu-id="94f10-195">BEK</span></span>          | <span data-ttu-id="94f10-196">Ett datablock</span><span class="sxs-lookup"><span data-stu-id="94f10-196">A block of data</span></span> | <span data-ttu-id="94f10-197">Ingen</span><span class="sxs-lookup"><span data-stu-id="94f10-197">None</span></span>                                         | <span data-ttu-id="94f10-198">Symmetrisk</span><span class="sxs-lookup"><span data-stu-id="94f10-198">Symmetric</span></span>  | <span data-ttu-id="94f10-199">Hej BEK härleds från hello DEK och hello datablock.</span><span class="sxs-lookup"><span data-stu-id="94f10-199">hello BEK is derived from hello DEK and hello data block.</span></span>                                                      |

<span data-ttu-id="94f10-200">hello följande diagram illustrerar de här koncepten:</span><span class="sxs-lookup"><span data-stu-id="94f10-200">hello following diagram illustrates these concepts:</span></span>

![Nycklar i datakryptering](./media/data-lake-store-encryption/fig2.png)

#### <a name="pseudo-algorithm-when-a-file-is-toobe-decrypted"></a><span data-ttu-id="94f10-202">Pseudokolumner algoritm när en fil toobe dekrypteras:</span><span class="sxs-lookup"><span data-stu-id="94f10-202">Pseudo algorithm when a file is toobe decrypted:</span></span>
1.  <span data-ttu-id="94f10-203">Kontrollera om hello DEK för hello Data Lake Store-konto är cachelagrade och redo att användas.</span><span class="sxs-lookup"><span data-stu-id="94f10-203">Check if hello DEK for hello Data Lake Store account is cached and ready for use.</span></span>
    - <span data-ttu-id="94f10-204">Om inte, Läs hello krypterade DEK från beständig lagring och skicka den tooKey valvet toobe dekrypteras.</span><span class="sxs-lookup"><span data-stu-id="94f10-204">If not, then read hello encrypted DEK from persistent storage, and send it tooKey Vault toobe decrypted.</span></span> <span data-ttu-id="94f10-205">Cache hello dekryptera DEK i minnet.</span><span class="sxs-lookup"><span data-stu-id="94f10-205">Cache hello decrypted DEK in memory.</span></span> <span data-ttu-id="94f10-206">Det är nu redo toouse.</span><span class="sxs-lookup"><span data-stu-id="94f10-206">It is now ready toouse.</span></span>
2.  <span data-ttu-id="94f10-207">För varje datablock i hello-filen:</span><span class="sxs-lookup"><span data-stu-id="94f10-207">For every block of data in hello file:</span></span>
    - <span data-ttu-id="94f10-208">Läsa hello krypterat datablock från beständig lagring.</span><span class="sxs-lookup"><span data-stu-id="94f10-208">Read hello encrypted block of data from persistent storage.</span></span>
    - <span data-ttu-id="94f10-209">Generera hello BEK från hello DEK och hello krypterat datablock.</span><span class="sxs-lookup"><span data-stu-id="94f10-209">Generate hello BEK from hello DEK and hello encrypted block of data.</span></span>
    - <span data-ttu-id="94f10-210">Använda hello BEK toodecrypt data.</span><span class="sxs-lookup"><span data-stu-id="94f10-210">Use hello BEK toodecrypt data.</span></span>


#### <a name="pseudo-algorithm-when-a-block-of-data-is-toobe-encrypted"></a><span data-ttu-id="94f10-211">Pseudokolumner algoritmen när ett datablock är krypterad toobe:</span><span class="sxs-lookup"><span data-stu-id="94f10-211">Pseudo algorithm when a block of data is toobe encrypted:</span></span>
1.  <span data-ttu-id="94f10-212">Kontrollera om hello DEK för hello Data Lake Store-konto är cachelagrade och redo att användas.</span><span class="sxs-lookup"><span data-stu-id="94f10-212">Check if hello DEK for hello Data Lake Store account is cached and ready for use.</span></span>
    - <span data-ttu-id="94f10-213">Om inte, Läs hello krypterade DEK från beständig lagring och skicka den tooKey valvet toobe dekrypteras.</span><span class="sxs-lookup"><span data-stu-id="94f10-213">If not, then read hello encrypted DEK from persistent storage, and send it tooKey Vault toobe decrypted.</span></span> <span data-ttu-id="94f10-214">Cache hello dekryptera DEK i minnet.</span><span class="sxs-lookup"><span data-stu-id="94f10-214">Cache hello decrypted DEK in memory.</span></span> <span data-ttu-id="94f10-215">Det är nu redo toouse.</span><span class="sxs-lookup"><span data-stu-id="94f10-215">It is now ready toouse.</span></span>
2.  <span data-ttu-id="94f10-216">Generera en unik BEK för hello datablock från hello DEK.</span><span class="sxs-lookup"><span data-stu-id="94f10-216">Generate a unique BEK for hello block of data from hello DEK.</span></span>
3.  <span data-ttu-id="94f10-217">Kryptera hello datablock med hello BEK, med hjälp av AES 256-kryptering.</span><span class="sxs-lookup"><span data-stu-id="94f10-217">Encrypt hello data block with hello BEK, by using AES-256 encryption.</span></span>
4.  <span data-ttu-id="94f10-218">Lagra hello krypterade data datablock i permanent lagringsutrymme.</span><span class="sxs-lookup"><span data-stu-id="94f10-218">Store hello encrypted data block of data on persistent storage.</span></span>

> [!NOTE] 
> <span data-ttu-id="94f10-219">Av prestandaskäl hello DEK i hello Rensa cachelagras i minnet för en kort tid och raderas omedelbart efteråt.</span><span class="sxs-lookup"><span data-stu-id="94f10-219">For performance reasons, hello DEK in hello clear is cached in memory for a short time, and is immediately erased afterward.</span></span> <span data-ttu-id="94f10-220">På beständiga medier lagras den alltid krypterats av hello MEK.</span><span class="sxs-lookup"><span data-stu-id="94f10-220">On persistent media, it is always stored encrypted by hello MEK.</span></span>

## <a name="key-rotation"></a><span data-ttu-id="94f10-221">Nyckelrotation</span><span class="sxs-lookup"><span data-stu-id="94f10-221">Key rotation</span></span>

<span data-ttu-id="94f10-222">Du kan rotera hello MEK när du använder en kundhanterad nycklar.</span><span class="sxs-lookup"><span data-stu-id="94f10-222">When you are using customer-managed keys, you can rotate hello MEK.</span></span> <span data-ttu-id="94f10-223">hur tooset upp ett Data Lake Store-konto med kundhanterad nycklar, se toolearn [komma igång](https://docs.microsoft.com/azure/data-lake-store/data-lake-store-get-started-portal).</span><span class="sxs-lookup"><span data-stu-id="94f10-223">toolearn how tooset up a Data Lake Store account with customer-managed keys, see [Getting started](https://docs.microsoft.com/azure/data-lake-store/data-lake-store-get-started-portal).</span></span>

### <a name="prerequisites"></a><span data-ttu-id="94f10-224">Krav</span><span class="sxs-lookup"><span data-stu-id="94f10-224">Prerequisites</span></span>

<span data-ttu-id="94f10-225">När du ställer in hello Data Lake Store-konto har du valt toouse egna nycklar.</span><span class="sxs-lookup"><span data-stu-id="94f10-225">When you set up hello Data Lake Store account, you have chosen toouse your own keys.</span></span> <span data-ttu-id="94f10-226">Det här alternativet kan inte ändras efter hello-konto har skapats.</span><span class="sxs-lookup"><span data-stu-id="94f10-226">This option cannot be changed after hello account has been created.</span></span> <span data-ttu-id="94f10-227">hello följande steg förutsätter att du använder kundhanterad nycklar (det vill säga du egna nycklar från Nyckelvalvet).</span><span class="sxs-lookup"><span data-stu-id="94f10-227">hello following steps assume that you are using customer-managed keys (that is, you have chosen your own keys from Key Vault).</span></span>

<span data-ttu-id="94f10-228">Observera att om du använder hello standardalternativen för kryptering av dina data alltid krypteras med hjälp av nycklar som hanteras av Data Lake Store.</span><span class="sxs-lookup"><span data-stu-id="94f10-228">Note that if you use hello default options for encryption, your data is always encrypted by using keys managed by Data Lake Store.</span></span> <span data-ttu-id="94f10-229">I det här alternativet kan du inte hello möjlighet toorotate nycklar som de hanteras av Data Lake Store.</span><span class="sxs-lookup"><span data-stu-id="94f10-229">In this option, you don't have hello ability toorotate keys, as they are managed by Data Lake Store.</span></span>

### <a name="how-toorotate-hello-mek-in-data-lake-store"></a><span data-ttu-id="94f10-230">Hur toorotate hello MEK i Data Lake Store</span><span class="sxs-lookup"><span data-stu-id="94f10-230">How toorotate hello MEK in Data Lake Store</span></span>

1. <span data-ttu-id="94f10-231">Logga in toohello [Azure-portalen](https://portal.azure.com/).</span><span class="sxs-lookup"><span data-stu-id="94f10-231">Sign in toohello [Azure portal](https://portal.azure.com/).</span></span>
2. <span data-ttu-id="94f10-232">Bläddra toohello Key Vault-instans som lagrar dina nycklar som associeras med Data Lake Store-konto.</span><span class="sxs-lookup"><span data-stu-id="94f10-232">Browse toohello Key Vault instance that stores your keys associated with your Data Lake Store account.</span></span> <span data-ttu-id="94f10-233">Välj **Nycklar**.</span><span class="sxs-lookup"><span data-stu-id="94f10-233">Select **Keys**.</span></span>

    ![Skärmbild av Key Vault](./media/data-lake-store-encryption/keyvault.png)

3.  <span data-ttu-id="94f10-235">Välj hello nyckeln som associeras med ditt Data Lake Store-konto och skapa en ny version av den här nyckeln.</span><span class="sxs-lookup"><span data-stu-id="94f10-235">Select hello key associated with your Data Lake Store account, and create a new version of this key.</span></span> <span data-ttu-id="94f10-236">Observera att Data Lake Store stöder för närvarande endast viktiga rotation tooa ny version av en nyckel.</span><span class="sxs-lookup"><span data-stu-id="94f10-236">Note that Data Lake Store currently only supports key rotation tooa new version of a key.</span></span> <span data-ttu-id="94f10-237">Det stöder inte roterar tooa annan nyckel.</span><span class="sxs-lookup"><span data-stu-id="94f10-237">It doesn't support rotating tooa different key.</span></span>

   ![Skärmbild av nyckelfönstret med den nya versionen markerad](./media/data-lake-store-encryption/keynewversion.png)

4.  <span data-ttu-id="94f10-239">Bläddra toohello Data Lake Store storage-konto och markera **kryptering**.</span><span class="sxs-lookup"><span data-stu-id="94f10-239">Browse toohello Data Lake Store storage account, and select **Encryption**.</span></span>

    ![Skärmbild av Data Lake Store-lagringskontofönstret, med kryptering markerat](./media/data-lake-store-encryption/select-encryption.png)

5.  <span data-ttu-id="94f10-241">Ett meddelande om att en ny nyckel version av hello nyckeln är tillgänglig.</span><span class="sxs-lookup"><span data-stu-id="94f10-241">A message notifies you that a new key version of hello key is available.</span></span> <span data-ttu-id="94f10-242">Klicka på **rotera nyckeln** tooupdate hello viktiga toohello ny version.</span><span class="sxs-lookup"><span data-stu-id="94f10-242">Click **Rotate Key** tooupdate hello key toohello new version.</span></span>

    ![Skärmbild av Data Lake Store-fönstret med meddelande och nyckelrotering markerat](./media/data-lake-store-encryption/rotatekey.png)

<span data-ttu-id="94f10-244">Den här åtgärden tar mindre än två minuter och det finns inga förväntad avbrottstid på grund av tookey rotation.</span><span class="sxs-lookup"><span data-stu-id="94f10-244">This operation should take less than two minutes, and there is no expected downtime due tookey rotation.</span></span> <span data-ttu-id="94f10-245">När hello åtgärd har slutförts, används hello ny version av hello nyckel.</span><span class="sxs-lookup"><span data-stu-id="94f10-245">After hello operation is complete, hello new version of hello key is in use.</span></span>
