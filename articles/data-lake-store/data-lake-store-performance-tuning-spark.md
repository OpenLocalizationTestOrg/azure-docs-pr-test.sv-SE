---
title: aaaAzure Data Lake Store Spark prestanda justera riktlinjer | Microsoft Docs
description: Azure Data Lake Store Spark prestandajustering riktlinjer
services: data-lake-store
documentationcenter: 
author: stewu
manager: amitkul
editor: stewu
ms.assetid: ebde7b9f-2e51-4d43-b7ab-566417221335
ms.service: data-lake-store
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: big-data
ms.date: 12/19/2016
ms.author: stewu
ms.openlocfilehash: da1d172e9cb1199ad95605ea1718e78559f79650
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 10/06/2017
---
# <a name="performance-tuning-guidance-for-spark-on-hdinsight-and-azure-data-lake-store"></a><span data-ttu-id="47ca8-103">Prestandajustering för Spark i HDInsight och Azure Data Lake Store</span><span class="sxs-lookup"><span data-stu-id="47ca8-103">Performance tuning guidance for Spark on HDInsight and Azure Data Lake Store</span></span>

<span data-ttu-id="47ca8-104">När du justera prestanda på Spark måste tooconsider hello antal appar som körs på klustret.</span><span class="sxs-lookup"><span data-stu-id="47ca8-104">When tuning performance on Spark, you need tooconsider hello number of apps that will be running on your cluster.</span></span>  <span data-ttu-id="47ca8-105">Som standard kan du köra 4 appar samtidigt på HDI-klustret (Obs: hello standardinställningen är ämne toochange).</span><span class="sxs-lookup"><span data-stu-id="47ca8-105">By default, you can run 4 apps concurrently on your HDI cluster (Note: hello default setting is subject toochange).</span></span>  <span data-ttu-id="47ca8-106">Du kan bestämma toouse färre appar så att du kan åsidosätta hello standardinställningar och använder flera hello kluster för dessa appar.</span><span class="sxs-lookup"><span data-stu-id="47ca8-106">You may decide toouse fewer apps so you can override hello default settings and use more of hello cluster for those apps.</span></span>  

## <a name="prerequisites"></a><span data-ttu-id="47ca8-107">Krav</span><span class="sxs-lookup"><span data-stu-id="47ca8-107">Prerequisites</span></span>

* <span data-ttu-id="47ca8-108">**En Azure-prenumeration**.</span><span class="sxs-lookup"><span data-stu-id="47ca8-108">**An Azure subscription**.</span></span> <span data-ttu-id="47ca8-109">Se [Hämta en kostnadsfri utvärderingsversion av Azure](https://azure.microsoft.com/pricing/free-trial/).</span><span class="sxs-lookup"><span data-stu-id="47ca8-109">See [Get Azure free trial](https://azure.microsoft.com/pricing/free-trial/).</span></span>
* <span data-ttu-id="47ca8-110">**Ett Azure Data Lake Store-konto**.</span><span class="sxs-lookup"><span data-stu-id="47ca8-110">**An Azure Data Lake Store account**.</span></span> <span data-ttu-id="47ca8-111">Anvisningar för hur toocreate en, se [Kom igång med Azure Data Lake Store](data-lake-store-get-started-portal.md)</span><span class="sxs-lookup"><span data-stu-id="47ca8-111">For instructions on how toocreate one, see [Get started with Azure Data Lake Store](data-lake-store-get-started-portal.md)</span></span>
* <span data-ttu-id="47ca8-112">**Azure HDInsight-kluster** med åtkomst tooa Data Lake Store-konto.</span><span class="sxs-lookup"><span data-stu-id="47ca8-112">**Azure HDInsight cluster** with access tooa Data Lake Store account.</span></span> <span data-ttu-id="47ca8-113">Se [skapar ett HDInsight-kluster med Data Lake Store](data-lake-store-hdinsight-hadoop-use-portal.md).</span><span class="sxs-lookup"><span data-stu-id="47ca8-113">See [Create an HDInsight cluster with Data Lake Store](data-lake-store-hdinsight-hadoop-use-portal.md).</span></span> <span data-ttu-id="47ca8-114">Kontrollera att du kan aktivera Fjärrskrivbord för hello kluster.</span><span class="sxs-lookup"><span data-stu-id="47ca8-114">Make sure you enable Remote Desktop for hello cluster.</span></span>
* <span data-ttu-id="47ca8-115">**Köra Spark-kluster på Azure Data Lake Store**.</span><span class="sxs-lookup"><span data-stu-id="47ca8-115">**Running Spark cluster on Azure Data Lake Store**.</span></span>  <span data-ttu-id="47ca8-116">Mer information finns i [använda HDInsight Spark-kluster tooanalyze data i Data Lake Store](https://docs.microsoft.com/en-us/azure/hdinsight/hdinsight-apache-spark-use-with-data-lake-store)</span><span class="sxs-lookup"><span data-stu-id="47ca8-116">For more information, see [Use HDInsight Spark cluster tooanalyze data in Data Lake Store](https://docs.microsoft.com/en-us/azure/hdinsight/hdinsight-apache-spark-use-with-data-lake-store)</span></span>
* <span data-ttu-id="47ca8-117">**Prestandajustering riktlinjer för ADLS**.</span><span class="sxs-lookup"><span data-stu-id="47ca8-117">**Performance tuning guidelines on ADLS**.</span></span>  <span data-ttu-id="47ca8-118">Allmänna prestanda begrepp finns [Data Lake Store justera Prestandaråd](https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-performance-tuning-guidance)</span><span class="sxs-lookup"><span data-stu-id="47ca8-118">For general performance concepts, see [Data Lake Store Performance Tuning Guidance](https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-performance-tuning-guidance)</span></span> 

## <a name="parameters"></a><span data-ttu-id="47ca8-119">Parametrar</span><span class="sxs-lookup"><span data-stu-id="47ca8-119">Parameters</span></span>

<span data-ttu-id="47ca8-120">När du kör Spark jobb, är här de viktigaste hello-inställningar som kan vara ögonen öppna tooincrease prestanda på ADLS:</span><span class="sxs-lookup"><span data-stu-id="47ca8-120">When running Spark jobs, here are hello most important settings that can be tuned tooincrease performance on ADLS:</span></span>

* <span data-ttu-id="47ca8-121">**NUM executors** -hello antalet samtidiga uppgifter som kan utföras.</span><span class="sxs-lookup"><span data-stu-id="47ca8-121">**Num-executors** - hello number of concurrent tasks that can be executed.</span></span>

* <span data-ttu-id="47ca8-122">**Utföraren minne** -hello mängden minne som allokerats tooeach utförare.</span><span class="sxs-lookup"><span data-stu-id="47ca8-122">**Executor-memory** - hello amount of memory allocated tooeach executor.</span></span>

* <span data-ttu-id="47ca8-123">**Utföraren kärnor** -hello antal kärnor allokerade tooeach utförare.</span><span class="sxs-lookup"><span data-stu-id="47ca8-123">**Executor-cores** - hello number of cores allocated tooeach executor.</span></span>                     

<span data-ttu-id="47ca8-124">**NUM executors** Num executors anger hello högsta antalet uppgifter som kan köras parallellt.</span><span class="sxs-lookup"><span data-stu-id="47ca8-124">**Num-executors** Num-executors will set hello maximum number of tasks that can run in parallel.</span></span>  <span data-ttu-id="47ca8-125">hello faktiska antalet uppgifter som kan köras parallellt är bundet hello minne och processorresurser som är tillgängliga i klustret.</span><span class="sxs-lookup"><span data-stu-id="47ca8-125">hello actual number of tasks that can run in parallel is bounded by hello memory and CPU resources available in your cluster.</span></span>

<span data-ttu-id="47ca8-126">**Utföraren minne** det här är hello mängden minne som allokerats tooeach utförare.</span><span class="sxs-lookup"><span data-stu-id="47ca8-126">**Executor-memory** This is hello amount of memory that is being allocated tooeach executor.</span></span>  <span data-ttu-id="47ca8-127">hello-minne som behövs för varje utföraren är beroende av hello jobb.</span><span class="sxs-lookup"><span data-stu-id="47ca8-127">hello memory needed for each executor is dependent on hello job.</span></span>  <span data-ttu-id="47ca8-128">För komplexa åtgärder måste hello minne toobe högre.</span><span class="sxs-lookup"><span data-stu-id="47ca8-128">For complex operations, hello memory needs toobe higher.</span></span>  <span data-ttu-id="47ca8-129">För enkla åtgärder som att läsa och skriva vara minneskrav lägre.</span><span class="sxs-lookup"><span data-stu-id="47ca8-129">For simple operations like read and write, memory requirements will be lower.</span></span>  <span data-ttu-id="47ca8-130">Hej mängden minne för varje utförare kan visas i Ambari.</span><span class="sxs-lookup"><span data-stu-id="47ca8-130">hello amount of memory for each executor can be viewed in Ambari.</span></span>  <span data-ttu-id="47ca8-131">Navigera tooSpark i Ambari, och visa hello konfigurationerna fliken.</span><span class="sxs-lookup"><span data-stu-id="47ca8-131">In Ambari, navigate tooSpark and view hello Configs tab.</span></span>  

<span data-ttu-id="47ca8-132">**Utföraren kärnor** anger hello mängden kärnor används per utföraren som bestämmer hello antalet parallella trådar som kan köra per utförare.</span><span class="sxs-lookup"><span data-stu-id="47ca8-132">**Executor-cores** This sets hello amount of cores used per executor, which determines hello number of parallel threads that can be run per executor.</span></span>  <span data-ttu-id="47ca8-133">Till exempel om utföraren kärnor = 2, sedan varje utförare kan köra 2 parallella aktiviteter i hello utförare.</span><span class="sxs-lookup"><span data-stu-id="47ca8-133">For example, if executor-cores = 2, then each executor can run 2 parallel tasks in hello executor.</span></span>  <span data-ttu-id="47ca8-134">hello utföraren-kärnor behövs är beroende av hello jobb.</span><span class="sxs-lookup"><span data-stu-id="47ca8-134">hello executor-cores needed will be dependent on hello job.</span></span>  <span data-ttu-id="47ca8-135">I/o tunga jobb kräver inte en stor mängd minne per aktivitet så att varje utförare kan hantera flera parallella aktiviteter.</span><span class="sxs-lookup"><span data-stu-id="47ca8-135">I/O heavy jobs do not require a large amount of memory per task so each executor can handle more parallel tasks.</span></span>

<span data-ttu-id="47ca8-136">Som standard definieras två virtuella YARN kärnor för varje fysiska kärnor när du kör Spark på HDInsight.</span><span class="sxs-lookup"><span data-stu-id="47ca8-136">By default, two virtual YARN cores are defined for each physical core when running Spark on HDInsight.</span></span>  <span data-ttu-id="47ca8-137">Det här antalet ger en bra balans mellan concurrecy och mängden kontexten växlar från flera trådar.</span><span class="sxs-lookup"><span data-stu-id="47ca8-137">This number provides a good balance of concurrecy and amount of context switching from multiple threads.</span></span>  

## <a name="guidance"></a><span data-ttu-id="47ca8-138">Riktlinjer</span><span class="sxs-lookup"><span data-stu-id="47ca8-138">Guidance</span></span>

<span data-ttu-id="47ca8-139">När du kör Spark analytiska arbetsbelastningar toowork med data i Data Lake Store, rekommenderar vi att du använder hello senaste HDInsight version tooget hello bästa prestanda med Data Lake Store.</span><span class="sxs-lookup"><span data-stu-id="47ca8-139">While running Spark analytic workloads toowork with data in Data Lake Store, we recommend that you use hello most recent HDInsight version tooget hello best performance with Data Lake Store.</span></span> <span data-ttu-id="47ca8-140">När jobbet är flera i/o-intensiva, kan vissa parametrar vara konfigurerade tooimprove prestanda.</span><span class="sxs-lookup"><span data-stu-id="47ca8-140">When your job is more I/O intensive, then certain parameters can be configured tooimprove performance.</span></span>  <span data-ttu-id="47ca8-141">Azure Data Lake Store är en mycket skalbar lagring-plattform som kan hantera högt genomflöde.</span><span class="sxs-lookup"><span data-stu-id="47ca8-141">Azure Data Lake Store is a highly scalable storage platform that can handle high throughput.</span></span>  <span data-ttu-id="47ca8-142">Om hello jobbet i huvudsak av läsning eller skrivning, kan öka samtidighet för i/o-tooand från Azure Data Lake Store öka prestanda.</span><span class="sxs-lookup"><span data-stu-id="47ca8-142">If hello job mainly consists of read or writes, then increasing concurrency for I/O tooand from Azure Data Lake Store could increase performance.</span></span>

<span data-ttu-id="47ca8-143">Det finns några allmänna metoder för tooincrease samtidighet för i/o-intensiva jobb.</span><span class="sxs-lookup"><span data-stu-id="47ca8-143">There are a few general ways tooincrease concurrency for I/O intensive jobs.</span></span>

<span data-ttu-id="47ca8-144">**Steg 1: Ta reda på hur många appar använder om klustret** – du bör känna till hur många appar körs på hello klustret, inklusive hello aktuella.</span><span class="sxs-lookup"><span data-stu-id="47ca8-144">**Step 1: Determine how many apps are running on your cluster** – You should know how many apps are running on hello cluster including hello current one.</span></span>  <span data-ttu-id="47ca8-145">hello standardvärden för varje Spark inställningen förutsätter att det finns 4 appar som körs samtidigt.</span><span class="sxs-lookup"><span data-stu-id="47ca8-145">hello default values for each Spark setting assumes that there are 4 apps running concurrently.</span></span>  <span data-ttu-id="47ca8-146">Därför ska du bara ha 25% av hello-kluster som är tillgängliga för varje app.</span><span class="sxs-lookup"><span data-stu-id="47ca8-146">Therefore, you will only have 25% of hello cluster available for each app.</span></span>  <span data-ttu-id="47ca8-147">tooget bättre prestanda, kan du åsidosätta hello standardvärdena genom att ändra hello antalet executors.</span><span class="sxs-lookup"><span data-stu-id="47ca8-147">tooget better performance, you can override hello defaults by changing hello number of executors.</span></span>  

<span data-ttu-id="47ca8-148">**Steg 2: Ange utföraren minne** – hello först öppna tooset är hello utföraren-minne.</span><span class="sxs-lookup"><span data-stu-id="47ca8-148">**Step 2: Set executor-memory** – hello first thing tooset is hello executor-memory.</span></span>  <span data-ttu-id="47ca8-149">hello minne är beroende av hello jobbet att du är pågående toorun.</span><span class="sxs-lookup"><span data-stu-id="47ca8-149">hello memory will be dependent on hello job that you are going toorun.</span></span>  <span data-ttu-id="47ca8-150">Du kan öka samtidighet genom att allokera mindre minne per utförare.</span><span class="sxs-lookup"><span data-stu-id="47ca8-150">You can increase concurrency by allocating less memory per executor.</span></span>  <span data-ttu-id="47ca8-151">Om du ser slut på minne undantag när du kör jobbet, bör du öka hello värde för denna parameter.</span><span class="sxs-lookup"><span data-stu-id="47ca8-151">If you see out of memory exceptions when you run your job, then you should increase hello value for this parameter.</span></span>  <span data-ttu-id="47ca8-152">Ett alternativ är tooget mer minne genom att använda ett kluster som har högre mängder minne eller öka hello storleken på ditt kluster.</span><span class="sxs-lookup"><span data-stu-id="47ca8-152">One alternative is tooget more memory by using a cluster that has higher amounts of memory or increasing hello size of your cluster.</span></span>  <span data-ttu-id="47ca8-153">Mer minne kan flera executors toobe används, vilket innebär att flera samtidiga.</span><span class="sxs-lookup"><span data-stu-id="47ca8-153">More memory will enable more executors toobe used, which means more concurrency.</span></span>

<span data-ttu-id="47ca8-154">**Steg 3: Ange utföraren kärnor** – för i/o-intensiv arbetsbelastning som inte har komplex, är det bra toostart med ett stort antal utföraren kärnor tooincrease hello antalet parallella aktiviteter per utförare.</span><span class="sxs-lookup"><span data-stu-id="47ca8-154">**Step 3: Set executor-cores** – For I/O intensive workloads that do not have complex operations, it’s good toostart with a high number of executor-cores tooincrease hello number of parallel tasks per executor.</span></span>  <span data-ttu-id="47ca8-155">Ange utförare kärnor too4 är en bra start.</span><span class="sxs-lookup"><span data-stu-id="47ca8-155">Setting executor-cores too4 is a good start.</span></span>   

    executor-cores = 4
<span data-ttu-id="47ca8-156">Öka hello antal kärnor utföraren får du mer parallellitet så att du kan experimentera med olika utföraren-kärnor.</span><span class="sxs-lookup"><span data-stu-id="47ca8-156">Increasing hello number of executor-cores will give you more parallelism so you can experiment with different executor-cores.</span></span>  <span data-ttu-id="47ca8-157">För jobb som har mer komplicerade åtgärder, bör du minska hello antalet kärnor per utförare.</span><span class="sxs-lookup"><span data-stu-id="47ca8-157">For jobs that have more complex operations, you should reduce hello number of cores per executor.</span></span>  <span data-ttu-id="47ca8-158">Om utföraren kärnor är kan högre än 4, sedan skräpinsamling vara ineffektivt och försämra prestanda.</span><span class="sxs-lookup"><span data-stu-id="47ca8-158">If executor-cores is set higher than 4, then garbage collection may become inefficient and degrade performance.</span></span>

<span data-ttu-id="47ca8-159">**Steg 4: Fastställ minnesmängden YARN i klustret** – den här informationen är tillgänglig i Ambari.</span><span class="sxs-lookup"><span data-stu-id="47ca8-159">**Step 4: Determine amount of YARN memory in cluster** – This information is available in Ambari.</span></span>  <span data-ttu-id="47ca8-160">Navigera tooYARN och visa hello konfigurationerna fliken.  Hej YARN minne visas i det här fönstret.</span><span class="sxs-lookup"><span data-stu-id="47ca8-160">Navigate tooYARN and view hello Configs tab.  hello YARN memory is displayed in this window.</span></span>  
<span data-ttu-id="47ca8-161">Obs: när du arbetar med hello fönstret kan du också se hello standardstorlek YARN behållare.</span><span class="sxs-lookup"><span data-stu-id="47ca8-161">Note: while you are in hello window, you can also see hello default YARN container size.</span></span>  <span data-ttu-id="47ca8-162">Hej YARN behållarens storlek är hello samma som minne per utföraren parameter.</span><span class="sxs-lookup"><span data-stu-id="47ca8-162">hello YARN container size is hello same as memory per executor paramter.</span></span>

    Total YARN memory = nodes * YARN memory per node
<span data-ttu-id="47ca8-163">**Steg 5: Beräkna num executors**</span><span class="sxs-lookup"><span data-stu-id="47ca8-163">**Step 5: Calculate num-executors**</span></span>

<span data-ttu-id="47ca8-164">**Beräkna minne begränsningen** -hello num executors parameter är begränsad genom minne eller CPU.</span><span class="sxs-lookup"><span data-stu-id="47ca8-164">**Calculate memory constraint** - hello num-executors parameter is constrained either by memory or by CPU.</span></span>  <span data-ttu-id="47ca8-165">hello minne begränsningen bestäms av hello mängden tillgängligt minne i YARN för ditt program.</span><span class="sxs-lookup"><span data-stu-id="47ca8-165">hello memory constraint is determined by hello amount of available YARN memory for your application.</span></span>  <span data-ttu-id="47ca8-166">Du bör ta totalt YARN-minne och delar av utföraren minne.</span><span class="sxs-lookup"><span data-stu-id="47ca8-166">You should take total YARN memory and divide that by executor-memory.</span></span>  <span data-ttu-id="47ca8-167">hello begränsningen måste toobe Frigör skalas för hello antal appar så att vi delar med hello antalet appar.</span><span class="sxs-lookup"><span data-stu-id="47ca8-167">hello constraint needs toobe de-scaled for hello number of apps so we divide by hello number of apps.</span></span>

    Memory constraint = (total YARN memory / executor memory) / # of apps   
<span data-ttu-id="47ca8-168">**Beräkna CPU-begränsningen** -hello CPU-begränsningen beräknas som hello totala virtuella kärnor dividerat med hello antalet kärnor per utförare.</span><span class="sxs-lookup"><span data-stu-id="47ca8-168">**Calculate CPU constraint** - hello CPU constraint is calculated as hello total virtual cores divided by hello number of cores per executor.</span></span>  <span data-ttu-id="47ca8-169">Det finns 2 virtuella kärnor för varje fysiska kärnor.</span><span class="sxs-lookup"><span data-stu-id="47ca8-169">There are 2 virtual cores for each physical core.</span></span>  <span data-ttu-id="47ca8-170">Liknande toohello minne begränsning, har vi division av hello antal appar.</span><span class="sxs-lookup"><span data-stu-id="47ca8-170">Similar toohello memory constraint, we have divide by hello number of apps.</span></span>

    virtual cores = (nodes in cluster * # of physical cores in node * 2)
    CPU constraint = (total virtual cores / # of cores per executor) / # of apps
<span data-ttu-id="47ca8-171">**Ange num executors** – hello num executors parametern bestäms genom att göra hello minst hello minne och hello CPU-begränsningen.</span><span class="sxs-lookup"><span data-stu-id="47ca8-171">**Set num-executors** – hello num-executors parameter is determined by taking hello minimum of hello memory constraint and hello CPU constraint.</span></span> 

    num-executors = Min (total virtual Cores / # of cores per executor, available YARN memory / executor-memory)   
<span data-ttu-id="47ca8-172">Anger ett högre antal num executors öka inte nödvändigtvis prestanda.</span><span class="sxs-lookup"><span data-stu-id="47ca8-172">Setting a higher number of num-executors does not necessarily increase performance.</span></span>  <span data-ttu-id="47ca8-173">Du bör överväga att lägga till flera executors lägger till extra administration för varje ytterligare utföraren som potentiellt kan försämra prestanda.</span><span class="sxs-lookup"><span data-stu-id="47ca8-173">You should consider that adding more executors will add extra overhead for each additional executor, which can potentially degrade performance.</span></span>  <span data-ttu-id="47ca8-174">NUM executors är bundet hello klusterresurser.</span><span class="sxs-lookup"><span data-stu-id="47ca8-174">Num-executors is bounded by hello cluster resources.</span></span>    

## <a name="example-calculation"></a><span data-ttu-id="47ca8-175">Exempel beräkning</span><span class="sxs-lookup"><span data-stu-id="47ca8-175">Example Calculation</span></span>

<span data-ttu-id="47ca8-176">Anta att du har ett kluster som består av 8 D4v2 noder som är igång 2 appar inklusive hello som du ska toorun.</span><span class="sxs-lookup"><span data-stu-id="47ca8-176">Let’s say you currently have a cluster composed of 8 D4v2 nodes that is running 2 apps including hello one you are going toorun.</span></span>  

<span data-ttu-id="47ca8-177">**Steg 1: Ta reda på hur många appar använder om klustret** – du vet att du har 2 appar på klustret, inklusive hello något du ska toorun.</span><span class="sxs-lookup"><span data-stu-id="47ca8-177">**Step 1: Determine how many apps are running on your cluster** – you know that you have 2 apps on your cluster, including hello one you are going toorun.</span></span>  

<span data-ttu-id="47ca8-178">**Steg 2: Ange utföraren minne** – i det här exemplet bestämma att 6 GB minne utföraren räcka för i/o-intensiva jobbet.</span><span class="sxs-lookup"><span data-stu-id="47ca8-178">**Step 2: Set executor-memory** – for this example, we determine that 6GB of executor-memory will be sufficient for I/O intensive job.</span></span>  

    executor-memory = 6GB
<span data-ttu-id="47ca8-179">**Steg 3: Ange utföraren kärnor** – eftersom det är ett i/o-intensiva jobb vi kan ange hello antalet kärnor för varje utföraren too4.</span><span class="sxs-lookup"><span data-stu-id="47ca8-179">**Step 3: Set executor-cores** – Since this is an I/O intensive job, we can set hello number of cores for each executor too4.</span></span>  <span data-ttu-id="47ca8-180">Ange kärnor per utföraren toolarger än 4 kan orsaka skräp samling problem.</span><span class="sxs-lookup"><span data-stu-id="47ca8-180">Setting cores per executor toolarger than 4 may cause garbage collection problems.</span></span>  

    executor-cores = 4
<span data-ttu-id="47ca8-181">**Steg 4: Fastställ minnesmängden YARN i klustret** – vi gå tooAmbari toofind ut att varje D4v2 har 25 GB YARN minne.</span><span class="sxs-lookup"><span data-stu-id="47ca8-181">**Step 4: Determine amount of YARN memory in cluster** – We navigate tooAmbari toofind out that each D4v2 has 25GB of YARN memory.</span></span>  <span data-ttu-id="47ca8-182">Eftersom det finns 8 noder, multipliceras hello YARN-minne med 8.</span><span class="sxs-lookup"><span data-stu-id="47ca8-182">Since there are 8 nodes, hello available YARN memory is multiplied by 8.</span></span>

    Total YARN memory = nodes * YARN memory* per node
    Total YARN memory = 8 nodes * 25GB = 200GB
<span data-ttu-id="47ca8-183">**Steg 5: Beräkna num executors** – hello num executors parametern bestäms genom att göra hello minst hello minne och CPU-begränsningen för hello dividerat med hello antal appar som körs på Spark.</span><span class="sxs-lookup"><span data-stu-id="47ca8-183">**Step 5: Calculate num-executors** – hello num-executors parameter is determined by taking hello minimum of hello memory constraint and hello CPU constraint divided by hello # of apps running on Spark.</span></span>    

<span data-ttu-id="47ca8-184">**Beräkna minne begränsningen** – hello minne begränsningen beräknas som hello totalt YARN-minne dividerat med hello minne per utförare.</span><span class="sxs-lookup"><span data-stu-id="47ca8-184">**Calculate memory constraint** – hello memory constraint is calculated as hello total YARN memory divided by hello memory per executor.</span></span>

    Memory constraint = (total YARN memory / executor memory) / # of apps   
    Memory constraint = (200GB / 6GB) / 2   
    Memory constraint = 16 (rounded)
<span data-ttu-id="47ca8-185">**Beräkna CPU-begränsningen** -hello CPU-begränsningen beräknas som hello totala yarn kärnor dividerat med hello antalet kärnor per utförare.</span><span class="sxs-lookup"><span data-stu-id="47ca8-185">**Calculate CPU constraint** - hello CPU constraint is calculated as hello total yarn cores divided by hello number of cores per executor.</span></span>
    
    YARN cores = nodes in cluster * # of cores per node * 2   
    YARN cores = 8 nodes * 8 cores per D14 * 2 = 128
    CPU constraint = (total YARN cores / # of cores per executor) / # of apps
    CPU constraint = (128 / 4) / 2
    CPU constraint = 16
<span data-ttu-id="47ca8-186">**Ange num-executors**</span><span class="sxs-lookup"><span data-stu-id="47ca8-186">**Set num-executors**</span></span>

    num-executors = Min (memory constraint, CPU constraint)
    num-executors = Min (16, 16)
    num-executors = 16    

