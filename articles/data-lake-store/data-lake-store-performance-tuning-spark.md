---
title: Azure Data Lake Store Spark prestandajustering riktlinjer | Microsoft Docs
description: Azure Data Lake Store Spark prestandajustering riktlinjer
services: data-lake-store
documentationcenter: 
author: stewu
manager: amitkul
editor: stewu
ms.assetid: ebde7b9f-2e51-4d43-b7ab-566417221335
ms.service: data-lake-store
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: big-data
ms.date: 12/19/2016
ms.author: stewu
ms.openlocfilehash: 2109744fb7ffdfafb7a86bbea355e119718af099
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 07/11/2017
---
# <a name="performance-tuning-guidance-for-spark-on-hdinsight-and-azure-data-lake-store"></a><span data-ttu-id="8e1ba-103">Prestandajustering för Spark i HDInsight och Azure Data Lake Store</span><span class="sxs-lookup"><span data-stu-id="8e1ba-103">Performance tuning guidance for Spark on HDInsight and Azure Data Lake Store</span></span>

<span data-ttu-id="8e1ba-104">När justera prestanda på Spark, måste du fundera över hur många appar som körs på klustret.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-104">When tuning performance on Spark, you need to consider the number of apps that will be running on your cluster.</span></span>  <span data-ttu-id="8e1ba-105">Som standard kan du köra 4 appar samtidigt på HDI-klustret (Obs: standardinställningen kan ändras).</span><span class="sxs-lookup"><span data-stu-id="8e1ba-105">By default, you can run 4 apps concurrently on your HDI cluster (Note: the default setting is subject to change).</span></span>  <span data-ttu-id="8e1ba-106">Du kan välja att använda färre appar så att du kan åsidosätta standardinställningarna och använder flera av klustret för dessa appar.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-106">You may decide to use fewer apps so you can override the default settings and use more of the cluster for those apps.</span></span>  

## <a name="prerequisites"></a><span data-ttu-id="8e1ba-107">Krav</span><span class="sxs-lookup"><span data-stu-id="8e1ba-107">Prerequisites</span></span>

* <span data-ttu-id="8e1ba-108">**En Azure-prenumeration**.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-108">**An Azure subscription**.</span></span> <span data-ttu-id="8e1ba-109">Se [Hämta en kostnadsfri utvärderingsversion av Azure](https://azure.microsoft.com/pricing/free-trial/).</span><span class="sxs-lookup"><span data-stu-id="8e1ba-109">See [Get Azure free trial](https://azure.microsoft.com/pricing/free-trial/).</span></span>
* <span data-ttu-id="8e1ba-110">**Ett Azure Data Lake Store-konto**.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-110">**An Azure Data Lake Store account**.</span></span> <span data-ttu-id="8e1ba-111">Anvisningar om hur du skapar en finns [Kom igång med Azure Data Lake Store](data-lake-store-get-started-portal.md)</span><span class="sxs-lookup"><span data-stu-id="8e1ba-111">For instructions on how to create one, see [Get started with Azure Data Lake Store](data-lake-store-get-started-portal.md)</span></span>
* <span data-ttu-id="8e1ba-112">**Azure HDInsight-kluster** med åtkomst till ett Data Lake Store-konto.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-112">**Azure HDInsight cluster** with access to a Data Lake Store account.</span></span> <span data-ttu-id="8e1ba-113">Se [skapar ett HDInsight-kluster med Data Lake Store](data-lake-store-hdinsight-hadoop-use-portal.md).</span><span class="sxs-lookup"><span data-stu-id="8e1ba-113">See [Create an HDInsight cluster with Data Lake Store](data-lake-store-hdinsight-hadoop-use-portal.md).</span></span> <span data-ttu-id="8e1ba-114">Kontrollera att du kan aktivera Fjärrskrivbord för klustret.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-114">Make sure you enable Remote Desktop for the cluster.</span></span>
* <span data-ttu-id="8e1ba-115">**Köra Spark-kluster på Azure Data Lake Store**.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-115">**Running Spark cluster on Azure Data Lake Store**.</span></span>  <span data-ttu-id="8e1ba-116">Mer information finns i [använda HDInsight Spark-klustret för att analysera data i Data Lake Store](https://docs.microsoft.com/en-us/azure/hdinsight/hdinsight-apache-spark-use-with-data-lake-store)</span><span class="sxs-lookup"><span data-stu-id="8e1ba-116">For more information, see [Use HDInsight Spark cluster to analyze data in Data Lake Store](https://docs.microsoft.com/en-us/azure/hdinsight/hdinsight-apache-spark-use-with-data-lake-store)</span></span>
* <span data-ttu-id="8e1ba-117">**Prestandajustering riktlinjer för ADLS**.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-117">**Performance tuning guidelines on ADLS**.</span></span>  <span data-ttu-id="8e1ba-118">Allmänna prestanda begrepp finns [Data Lake Store justera Prestandaråd](https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-performance-tuning-guidance)</span><span class="sxs-lookup"><span data-stu-id="8e1ba-118">For general performance concepts, see [Data Lake Store Performance Tuning Guidance](https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-performance-tuning-guidance)</span></span> 

## <a name="parameters"></a><span data-ttu-id="8e1ba-119">Parametrar</span><span class="sxs-lookup"><span data-stu-id="8e1ba-119">Parameters</span></span>

<span data-ttu-id="8e1ba-120">När du kör Spark jobb, är här de viktigaste inställningar som kan anpassas för att öka prestanda hos ADLS:</span><span class="sxs-lookup"><span data-stu-id="8e1ba-120">When running Spark jobs, here are the most important settings that can be tuned to increase performance on ADLS:</span></span>

* <span data-ttu-id="8e1ba-121">**NUM executors** -antalet samtidiga uppgifter som kan utföras.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-121">**Num-executors** - The number of concurrent tasks that can be executed.</span></span>

* <span data-ttu-id="8e1ba-122">**Utföraren minne** -mängden minne som allokerats för varje utförare.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-122">**Executor-memory** - The amount of memory allocated to each executor.</span></span>

* <span data-ttu-id="8e1ba-123">**Utföraren kärnor** -antal kärnor som tilldelas varje utförare.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-123">**Executor-cores** - The number of cores allocated to each executor.</span></span>                     

<span data-ttu-id="8e1ba-124">**NUM executors** Num executors anger det maximala antalet uppgifter som kan köras parallellt.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-124">**Num-executors** Num-executors will set the maximum number of tasks that can run in parallel.</span></span>  <span data-ttu-id="8e1ba-125">Det faktiska antalet uppgifter som kan köras parallellt begränsas av minne och processorresurser som är tillgängliga i klustret.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-125">The actual number of tasks that can run in parallel is bounded by the memory and CPU resources available in your cluster.</span></span>

<span data-ttu-id="8e1ba-126">**Utföraren minne** detta är mängden minne som allokeras till varje utförare.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-126">**Executor-memory** This is the amount of memory that is being allocated to each executor.</span></span>  <span data-ttu-id="8e1ba-127">Det minne som krävs för varje utföraren är beroende av jobbet.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-127">The memory needed for each executor is dependent on the job.</span></span>  <span data-ttu-id="8e1ba-128">Minnet som måste vara högre för komplexa åtgärder.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-128">For complex operations, the memory needs to be higher.</span></span>  <span data-ttu-id="8e1ba-129">För enkla åtgärder som att läsa och skriva vara minneskrav lägre.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-129">For simple operations like read and write, memory requirements will be lower.</span></span>  <span data-ttu-id="8e1ba-130">Mängden minne för varje utförare kan visas i Ambari.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-130">The amount of memory for each executor can be viewed in Ambari.</span></span>  <span data-ttu-id="8e1ba-131">Navigera till Spark i Ambari, och visar fliken konfigurationerna.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-131">In Ambari, navigate to Spark and view the Configs tab.</span></span>  

<span data-ttu-id="8e1ba-132">**Utföraren kärnor** Anger mängden kärnor används per utföraren som avgör hur många parallella trådar som kan köras per utförare.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-132">**Executor-cores** This sets the amount of cores used per executor, which determines the number of parallel threads that can be run per executor.</span></span>  <span data-ttu-id="8e1ba-133">Till exempel om utföraren kärnor = 2, sedan varje utförare kan köra 2 parallella aktiviteter i utföraren.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-133">For example, if executor-cores = 2, then each executor can run 2 parallel tasks in the executor.</span></span>  <span data-ttu-id="8e1ba-134">Utföraren-kärnor behövs är beroende av jobbet.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-134">The executor-cores needed will be dependent on the job.</span></span>  <span data-ttu-id="8e1ba-135">I/o tunga jobb kräver inte en stor mängd minne per aktivitet så att varje utförare kan hantera flera parallella aktiviteter.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-135">I/O heavy jobs do not require a large amount of memory per task so each executor can handle more parallel tasks.</span></span>

<span data-ttu-id="8e1ba-136">Som standard definieras två virtuella YARN kärnor för varje fysiska kärnor när du kör Spark på HDInsight.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-136">By default, two virtual YARN cores are defined for each physical core when running Spark on HDInsight.</span></span>  <span data-ttu-id="8e1ba-137">Det här antalet ger en bra balans mellan concurrecy och mängden kontexten växlar från flera trådar.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-137">This number provides a good balance of concurrecy and amount of context switching from multiple threads.</span></span>  

## <a name="guidance"></a><span data-ttu-id="8e1ba-138">Riktlinjer</span><span class="sxs-lookup"><span data-stu-id="8e1ba-138">Guidance</span></span>

<span data-ttu-id="8e1ba-139">När du kör Spark analytiska arbetsbelastningar för att arbeta med data i Data Lake Store, rekommenderar vi att du använder den senaste versionen av HDInsight för att få bästa prestanda med Data Lake Store.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-139">While running Spark analytic workloads to work with data in Data Lake Store, we recommend that you use the most recent HDInsight version to get the best performance with Data Lake Store.</span></span> <span data-ttu-id="8e1ba-140">När jobbet är flera i/o-intensiva, kan vissa parametrar konfigureras för att förbättra prestanda.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-140">When your job is more I/O intensive, then certain parameters can be configured to improve performance.</span></span>  <span data-ttu-id="8e1ba-141">Azure Data Lake Store är en mycket skalbar lagring-plattform som kan hantera högt genomflöde.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-141">Azure Data Lake Store is a highly scalable storage platform that can handle high throughput.</span></span>  <span data-ttu-id="8e1ba-142">Om jobbet består i huvudsak av läsning eller skrivning, kan öka samtidighet för i/o till och från Azure Data Lake Store öka prestanda.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-142">If the job mainly consists of read or writes, then increasing concurrency for I/O to and from Azure Data Lake Store could increase performance.</span></span>

<span data-ttu-id="8e1ba-143">Det finns några allmänna metoder för att öka parallellkörningen för i/o-intensiva jobb.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-143">There are a few general ways to increase concurrency for I/O intensive jobs.</span></span>

<span data-ttu-id="8e1ba-144">**Steg 1: Ta reda på hur många appar använder om klustret** – du bör känna till hur många appar körs på klustret, inklusive aktuell.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-144">**Step 1: Determine how many apps are running on your cluster** – You should know how many apps are running on the cluster including the current one.</span></span>  <span data-ttu-id="8e1ba-145">Standardvärden för varje Spark inställningen förutsätter att det finns 4 appar som körs samtidigt.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-145">The default values for each Spark setting assumes that there are 4 apps running concurrently.</span></span>  <span data-ttu-id="8e1ba-146">Därför ska du bara ha 25% av klustret för varje app.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-146">Therefore, you will only have 25% of the cluster available for each app.</span></span>  <span data-ttu-id="8e1ba-147">Du kan åsidosätta standardvärdena genom att ändra antalet Utförarna för att få bättre prestanda.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-147">To get better performance, you can override the defaults by changing the number of executors.</span></span>  

<span data-ttu-id="8e1ba-148">**Steg 2: Ange utföraren minne** – det första du ska ange är utföraren-minne.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-148">**Step 2: Set executor-memory** – the first thing to set is the executor-memory.</span></span>  <span data-ttu-id="8e1ba-149">Minnet som är beroende av det jobb som du ska köra.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-149">The memory will be dependent on the job that you are going to run.</span></span>  <span data-ttu-id="8e1ba-150">Du kan öka samtidighet genom att allokera mindre minne per utförare.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-150">You can increase concurrency by allocating less memory per executor.</span></span>  <span data-ttu-id="8e1ba-151">Om du ser slut på minne undantag när du kör jobbet, bör du öka värdet för den här parametern.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-151">If you see out of memory exceptions when you run your job, then you should increase the value for this parameter.</span></span>  <span data-ttu-id="8e1ba-152">Ett alternativ är att hämta mer minne med hjälp av ett kluster med större mängder minne eller öka storleken på ditt kluster.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-152">One alternative is to get more memory by using a cluster that has higher amounts of memory or increasing the size of your cluster.</span></span>  <span data-ttu-id="8e1ba-153">Mer minne kan flera executors som ska användas, vilket innebär att flera samtidiga.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-153">More memory will enable more executors to be used, which means more concurrency.</span></span>

<span data-ttu-id="8e1ba-154">**Steg 3: Ange utföraren kärnor** – för i/o-intensiv arbetsbelastning som inte har komplex, är det bra att börja med ett stort antal utföraren-kärnor för att öka antalet parallella aktiviteter per utförare.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-154">**Step 3: Set executor-cores** – For I/O intensive workloads that do not have complex operations, it’s good to start with a high number of executor-cores to increase the number of parallel tasks per executor.</span></span>  <span data-ttu-id="8e1ba-155">Ange utförare kärnor 4 är en bra start.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-155">Setting executor-cores to 4 is a good start.</span></span>   

    executor-cores = 4
<span data-ttu-id="8e1ba-156">Öka antalet kärnor utföraren får du mer parallellitet så att du kan experimentera med olika utföraren-kärnor.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-156">Increasing the number of executor-cores will give you more parallelism so you can experiment with different executor-cores.</span></span>  <span data-ttu-id="8e1ba-157">För jobb som har mer komplicerade åtgärder, bör du minska antalet kärnor per utförare.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-157">For jobs that have more complex operations, you should reduce the number of cores per executor.</span></span>  <span data-ttu-id="8e1ba-158">Om utföraren kärnor är kan högre än 4, sedan skräpinsamling vara ineffektivt och försämra prestanda.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-158">If executor-cores is set higher than 4, then garbage collection may become inefficient and degrade performance.</span></span>

<span data-ttu-id="8e1ba-159">**Steg 4: Fastställ minnesmängden YARN i klustret** – den här informationen är tillgänglig i Ambari.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-159">**Step 4: Determine amount of YARN memory in cluster** – This information is available in Ambari.</span></span>  <span data-ttu-id="8e1ba-160">Navigera till YARN och visar fliken konfigurationerna.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-160">Navigate to YARN and view the Configs tab.</span></span>  <span data-ttu-id="8e1ba-161">YARN-minne visas i det här fönstret.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-161">The YARN memory is displayed in this window.</span></span>  
<span data-ttu-id="8e1ba-162">Obs: när du arbetar i fönstret kan du också se standardstorleken YARN behållare.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-162">Note: while you are in the window, you can also see the default YARN container size.</span></span>  <span data-ttu-id="8e1ba-163">YARN behållaren storleken är samma som minne per utföraren parameter.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-163">The YARN container size is the same as memory per executor paramter.</span></span>

    Total YARN memory = nodes * YARN memory per node
<span data-ttu-id="8e1ba-164">**Steg 5: Beräkna num executors**</span><span class="sxs-lookup"><span data-stu-id="8e1ba-164">**Step 5: Calculate num-executors**</span></span>

<span data-ttu-id="8e1ba-165">**Beräkna minne begränsningen** -parametern num executors är begränsad genom minne eller CPU.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-165">**Calculate memory constraint** - The num-executors parameter is constrained either by memory or by CPU.</span></span>  <span data-ttu-id="8e1ba-166">Minne-begränsningen bestäms av mängden tillgängligt minne i YARN för ditt program.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-166">The memory constraint is determined by the amount of available YARN memory for your application.</span></span>  <span data-ttu-id="8e1ba-167">Du bör ta totalt YARN-minne och delar av utföraren minne.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-167">You should take total YARN memory and divide that by executor-memory.</span></span>  <span data-ttu-id="8e1ba-168">Begränsningen måste vara Frigör skalade för antalet appar så att vi delar med antalet appar.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-168">The constraint needs to be de-scaled for the number of apps so we divide by the number of apps.</span></span>

    Memory constraint = (total YARN memory / executor memory) / # of apps   
<span data-ttu-id="8e1ba-169">**Beräkna CPU-begränsningen** -begränsning av processor beräknas som de totala virtuella kärnor dividerat med antalet kärnor per utförare.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-169">**Calculate CPU constraint** - The CPU constraint is calculated as the total virtual cores divided by the number of cores per executor.</span></span>  <span data-ttu-id="8e1ba-170">Det finns 2 virtuella kärnor för varje fysiska kärnor.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-170">There are 2 virtual cores for each physical core.</span></span>  <span data-ttu-id="8e1ba-171">Liknar begränsningen minne, har vi division med antalet appar.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-171">Similar to the memory constraint, we have divide by the number of apps.</span></span>

    virtual cores = (nodes in cluster * # of physical cores in node * 2)
    CPU constraint = (total virtual cores / # of cores per executor) / # of apps
<span data-ttu-id="8e1ba-172">**Ange num executors** – parametern num executors bestäms genom att göra minimum för den minne och CPU-begränsningen.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-172">**Set num-executors** – The num-executors parameter is determined by taking the minimum of the memory constraint and the CPU constraint.</span></span> 

    num-executors = Min (total virtual Cores / # of cores per executor, available YARN memory / executor-memory)   
<span data-ttu-id="8e1ba-173">Anger ett högre antal num executors öka inte nödvändigtvis prestanda.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-173">Setting a higher number of num-executors does not necessarily increase performance.</span></span>  <span data-ttu-id="8e1ba-174">Du bör överväga att lägga till flera executors lägger till extra administration för varje ytterligare utföraren som potentiellt kan försämra prestanda.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-174">You should consider that adding more executors will add extra overhead for each additional executor, which can potentially degrade performance.</span></span>  <span data-ttu-id="8e1ba-175">NUM executors är bundet klusterresurserna.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-175">Num-executors is bounded by the cluster resources.</span></span>    

## <a name="example-calculation"></a><span data-ttu-id="8e1ba-176">Exempel beräkning</span><span class="sxs-lookup"><span data-stu-id="8e1ba-176">Example Calculation</span></span>

<span data-ttu-id="8e1ba-177">Anta att du har ett kluster som består av 8 D4v2 noder som kör 2 appar inklusive det som du ska köra.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-177">Let’s say you currently have a cluster composed of 8 D4v2 nodes that is running 2 apps including the one you are going to run.</span></span>  

<span data-ttu-id="8e1ba-178">**Steg 1: Ta reda på hur många appar använder om klustret** – du vet att du har 2 appar på klustret, inklusive det som du ska köra.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-178">**Step 1: Determine how many apps are running on your cluster** – you know that you have 2 apps on your cluster, including the one you are going to run.</span></span>  

<span data-ttu-id="8e1ba-179">**Steg 2: Ange utföraren minne** – i det här exemplet bestämma att 6 GB minne utföraren räcka för i/o-intensiva jobbet.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-179">**Step 2: Set executor-memory** – for this example, we determine that 6GB of executor-memory will be sufficient for I/O intensive job.</span></span>  

    executor-memory = 6GB
<span data-ttu-id="8e1ba-180">**Steg 3: Ange utföraren kärnor** – eftersom det är ett i/o-intensiva jobb vi kan ange antalet kärnor för varje utföraren till 4.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-180">**Step 3: Set executor-cores** – Since this is an I/O intensive job, we can set the number of cores for each executor to 4.</span></span>  <span data-ttu-id="8e1ba-181">Ange kärnor per utföraren till större än 4 kan orsaka skräp samling problem.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-181">Setting cores per executor to larger than 4 may cause garbage collection problems.</span></span>  

    executor-cores = 4
<span data-ttu-id="8e1ba-182">**Steg 4: Fastställ minnesmängden YARN i klustret** – vi gå till Ambari ta reda på att varje D4v2 har 25 GB YARN minne.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-182">**Step 4: Determine amount of YARN memory in cluster** – We navigate to Ambari to find out that each D4v2 has 25GB of YARN memory.</span></span>  <span data-ttu-id="8e1ba-183">Eftersom det finns 8 noder, multipliceras det tillgängliga minnet YARN med 8.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-183">Since there are 8 nodes, the available YARN memory is multiplied by 8.</span></span>

    Total YARN memory = nodes * YARN memory* per node
    Total YARN memory = 8 nodes * 25GB = 200GB
<span data-ttu-id="8e1ba-184">**Steg 5: Beräkna num executors** – parametern num executors bestäms av tar minst begränsningen minne och CPU-begränsningen dividerat med antal appar som körs på Spark.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-184">**Step 5: Calculate num-executors** – The num-executors parameter is determined by taking the minimum of the memory constraint and the CPU constraint divided by the # of apps running on Spark.</span></span>    

<span data-ttu-id="8e1ba-185">**Beräkna minne begränsningen** – begränsningen minne beräknas som den totala mängden minne för YARN dividerat med minne per utförare.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-185">**Calculate memory constraint** – The memory constraint is calculated as the total YARN memory divided by the memory per executor.</span></span>

    Memory constraint = (total YARN memory / executor memory) / # of apps   
    Memory constraint = (200GB / 6GB) / 2   
    Memory constraint = 16 (rounded)
<span data-ttu-id="8e1ba-186">**Beräkna CPU-begränsningen** -begränsning av processor beräknas som de totala yarn kärnor dividerat med antalet kärnor per utförare.</span><span class="sxs-lookup"><span data-stu-id="8e1ba-186">**Calculate CPU constraint** - The CPU constraint is calculated as the total yarn cores divided by the number of cores per executor.</span></span>
    
    YARN cores = nodes in cluster * # of cores per node * 2   
    YARN cores = 8 nodes * 8 cores per D14 * 2 = 128
    CPU constraint = (total YARN cores / # of cores per executor) / # of apps
    CPU constraint = (128 / 4) / 2
    CPU constraint = 16
<span data-ttu-id="8e1ba-187">**Ange num-executors**</span><span class="sxs-lookup"><span data-stu-id="8e1ba-187">**Set num-executors**</span></span>

    num-executors = Min (memory constraint, CPU constraint)
    num-executors = Min (16, 16)
    num-executors = 16    

