---
title: aaaJob skalning med Azure Stream Analytics & AzureML functions | Microsoft Docs
description: "Lär dig hur tooproperly skala Stream Analytics-jobb (partitionering, SU antal och mer) när du använder Azure Machine Learning-funktioner."
keywords: 
documentationcenter: 
services: stream-analytics
author: jeffstokes72
manager: jhubbard
editor: cgronlun
ms.assetid: 47ce7c5e-1de1-41ca-9a26-b5ecce814743
ms.service: stream-analytics
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: data-services
ms.date: 03/28/2017
ms.author: jeffstok
ms.openlocfilehash: 3fbdfaf7e8e86896c56f1d18bbde3a10bd3dca04
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 10/06/2017
---
# <a name="scale-your-stream-analytics-job-with-azure-machine-learning-functions"></a><span data-ttu-id="00b71-103">Skala Stream Analytics-jobbet med Azure Machine Learning-funktioner</span><span class="sxs-lookup"><span data-stu-id="00b71-103">Scale your Stream Analytics job with Azure Machine Learning functions</span></span>
<span data-ttu-id="00b71-104">Det är ofta ganska enkelt tooset upp ett Stream Analytics-jobb och kör exempeldata genom den.</span><span class="sxs-lookup"><span data-stu-id="00b71-104">It is often quite easy tooset up an Stream Analytics job and run some sample data through it.</span></span> <span data-ttu-id="00b71-105">Vad gör vi när vi behöver toorun hello samma jobb med högre datavolym?</span><span class="sxs-lookup"><span data-stu-id="00b71-105">What should we do when we need toorun hello same job with higher data volume?</span></span> <span data-ttu-id="00b71-106">Det krävs oss toounderstand hur tooconfigure hello Stream Analytics-jobbet så att det skalas.</span><span class="sxs-lookup"><span data-stu-id="00b71-106">It requires us toounderstand how tooconfigure hello Stream Analytics job so that it will scale.</span></span> <span data-ttu-id="00b71-107">I det här dokumentet fokuseras på hello speciella aspekter av skalning Stream Analytics jobb med Machine Learning-funktioner.</span><span class="sxs-lookup"><span data-stu-id="00b71-107">In this document, we will focus on hello special aspects of scaling Stream Analytics jobs with Machine Learning functions.</span></span> <span data-ttu-id="00b71-108">Mer information om hur tooscale Stream Analytics-jobb i allmänhet finns hello artikel [skalning jobb](stream-analytics-scale-jobs.md).</span><span class="sxs-lookup"><span data-stu-id="00b71-108">For information on how tooscale Stream Analytics jobs in general see hello article [Scaling jobs](stream-analytics-scale-jobs.md).</span></span>

## <a name="what-is-an-azure-machine-learning-function-in-stream-analytics"></a><span data-ttu-id="00b71-109">Vad är Azure Machine Learning-funktionen i Stream Analytics?</span><span class="sxs-lookup"><span data-stu-id="00b71-109">What is an Azure Machine Learning function in Stream Analytics?</span></span>
<span data-ttu-id="00b71-110">En Machine Learning i Stream Analytics kan användas som ett reguljärt funktionsanrop i hello Stream Analytics-frågespråket.</span><span class="sxs-lookup"><span data-stu-id="00b71-110">A Machine Learning function in Stream Analytics can be used like a regular function call in hello Stream Analytics query language.</span></span> <span data-ttu-id="00b71-111">Bakom hello scen emellertid hello funktionsanrop faktiskt Azure Machine Learning-webbtjänst begäranden.</span><span class="sxs-lookup"><span data-stu-id="00b71-111">However, behind hello scene, hello function calls are actually Azure Machine Learning Web Service requests.</span></span> <span data-ttu-id="00b71-112">Machine Learning-webbtjänster stöd ”batchbearbetning” flera rader som kallas Mini batch, i hello samma web service API-anrop tooimprove totala genomflödet.</span><span class="sxs-lookup"><span data-stu-id="00b71-112">Machine Learning web services support “batching” multiple rows, which is called mini-batch, in hello same web service API call, tooimprove overall throughput.</span></span> <span data-ttu-id="00b71-113">Se följande artiklar för mer information, hello [Azure Machine Learning-funktioner i Stream Analytics](https://blogs.technet.microsoft.com/machinelearning/2015/12/10/azure-ml-now-available-as-a-function-in-azure-stream-analytics/) och [Azure Machine Learning-webbtjänster](../machine-learning/machine-learning-consume-web-services.md).</span><span class="sxs-lookup"><span data-stu-id="00b71-113">Please see hello following articles for more details; [Azure Machine Learning functions in Stream Analytics](https://blogs.technet.microsoft.com/machinelearning/2015/12/10/azure-ml-now-available-as-a-function-in-azure-stream-analytics/) and [Azure Machine Learning Web Services](../machine-learning/machine-learning-consume-web-services.md).</span></span>

## <a name="configure-a-stream-analytics-job-with-machine-learning-functions"></a><span data-ttu-id="00b71-114">Konfigurera ett Stream Analytics-jobb med Machine Learning-funktioner</span><span class="sxs-lookup"><span data-stu-id="00b71-114">Configure a Stream Analytics job with Machine Learning functions</span></span>
<span data-ttu-id="00b71-115">När du konfigurerar en Machine Learning-funktionen för Stream Analytics-jobbet, finns det två parametrar tooconsider, hello batchstorlek hello Machine Learning-funktionsanrop och hello strömningsenheter (SUs) försetts hello Stream Analytics-jobbet.</span><span class="sxs-lookup"><span data-stu-id="00b71-115">When configuring a Machine Learning function for Stream Analytics job, there are two parameters tooconsider, hello batch size of hello Machine Learning function calls, and hello streaming units (SUs) provisioned for hello Stream Analytics job.</span></span> <span data-ttu-id="00b71-116">toodetermine hello lämpliga värden för dessa, först beslut måste göras mellan svarstid och genomströmning, det vill säga svarstiden för hello Stream Analytics-jobbet och dataflöde på varje SU.</span><span class="sxs-lookup"><span data-stu-id="00b71-116">toodetermine hello appropriate values for these, first a decision must be made between latency and throughput, that is, latency of hello Stream Analytics job, and throughput of each SU.</span></span> <span data-ttu-id="00b71-117">SUs kan alltid läggas tooa jobbet tooincrease genomströmningen i en väl partitionerade Stream Analytics-fråga, även om ytterligare SUs ökar hello kostnaden för hello jobb som körs.</span><span class="sxs-lookup"><span data-stu-id="00b71-117">SUs may always be added tooa job tooincrease throughput of a well partitioned Stream Analytics query, although additional SUs increases hello cost of running hello job.</span></span>

<span data-ttu-id="00b71-118">Det är därför viktigt toodetermine hello *tolerans* av fördröjning i Stream Analytics-jobbet körs.</span><span class="sxs-lookup"><span data-stu-id="00b71-118">Therefore it is important toodetermine hello *tolerance* of latency in running a Stream Analytics job.</span></span> <span data-ttu-id="00b71-119">Naturligtvis ökar ytterligare svarstiden från att köra Azure Machine Learning tjänstbegäranden med batchstorlek som kommer att förena hello svarstiden för hello Stream Analytics-jobbet.</span><span class="sxs-lookup"><span data-stu-id="00b71-119">Additional latency from running Azure Machine Learning service requests will naturally increase with batch size, which will compound hello latency of hello Stream Analytics job.</span></span> <span data-ttu-id="00b71-120">På hello kan däremot öka batchstorlek hello Stream Analytics-jobbet tooprocess * fler händelser med hello *samma nummer* av Machine Learning webbförfrågningar service.</span><span class="sxs-lookup"><span data-stu-id="00b71-120">On hello other hand, increasing batch size allows hello Stream Analytics job tooprocess *more events with hello *same number* of Machine Learning web service requests.</span></span> <span data-ttu-id="00b71-121">Ofta hello ökningen av svarstiden för Machine Learning web service är underordnad linjär toohello ökningen av batchstorlek så att det är viktigt tooconsider hello mest kostnadseffektiva batchstorlek för Machine Learning-webbtjänsten i en viss situation.</span><span class="sxs-lookup"><span data-stu-id="00b71-121">Often hello increase of Machine Learning web service latency is sub-linear toohello increase of batch size so it is important tooconsider hello most cost-efficient batch size for a Machine Learning web service in any given situation.</span></span> <span data-ttu-id="00b71-122">hello standard batchstorlek för hello web service-begäranden är 1000 och kan ändras genom att använda hello [Stream Analytics REST API](https://msdn.microsoft.com/library/mt653706.aspx "Stream Analytics REST API") eller hello [PowerShell-klienten för Stream Analytics](stream-analytics-monitor-and-manage-jobs-use-powershell.md "PowerShell-klienten för Stream Analytics").</span><span class="sxs-lookup"><span data-stu-id="00b71-122">hello default batch size for hello web service requests is 1000 and may be modified either by using hello [Stream Analytics REST API](https://msdn.microsoft.com/library/mt653706.aspx "Stream Analytics REST API") or hello [PowerShell client for Stream Analytics](stream-analytics-monitor-and-manage-jobs-use-powershell.md "PowerShell client for Stream Analytics").</span></span>

<span data-ttu-id="00b71-123">När en batchstorlek har fastställts hello mängden strömning enheter (SUs) kan bestämmas utifrån hello antalet händelser att hello-funktionen måste tooprocess per sekund.</span><span class="sxs-lookup"><span data-stu-id="00b71-123">Once a batch size has been determined, hello amount of streaming units (SUs) can be determined, based on hello number of events that hello function needs tooprocess per second.</span></span> <span data-ttu-id="00b71-124">Mer information om enheter för strömning finns [Stream Analytics skala jobb](stream-analytics-scale-jobs.md).</span><span class="sxs-lookup"><span data-stu-id="00b71-124">For more information about streaming units, see [Stream Analytics scale jobs](stream-analytics-scale-jobs.md).</span></span>

<span data-ttu-id="00b71-125">I allmänhet finns 20 samtidiga anslutningar toohello Machine Learning-webbtjänst för varje 6 SUs, förutom att 1 SU jobb och 3 SU jobb får 20 samtidiga anslutningar också.</span><span class="sxs-lookup"><span data-stu-id="00b71-125">In general, there are 20 concurrent connections toohello Machine Learning web service for every 6 SUs, except that 1 SU jobs and 3 SU jobs will get 20 concurrent connections also.</span></span>  <span data-ttu-id="00b71-126">Om frekvensen för hello-indata är 200 000 händelser per sekund och hello batchstorlek lämnas är toohello standard av 1000 hello resulterande web service fördröjning med 1000 händelser Mini batch 200 MS.</span><span class="sxs-lookup"><span data-stu-id="00b71-126">For example, if hello input data rate is 200,000 events per second and hello batch size is left toohello default of 1000 hello resulting web service latency with 1000 events mini-batch is 200ms.</span></span> <span data-ttu-id="00b71-127">Det innebär att alla anslutningar kan begär 5 toohello Machine Learning-webbtjänst på en sekund.</span><span class="sxs-lookup"><span data-stu-id="00b71-127">This means every connection can make 5 requests toohello Machine Learning web service in a second.</span></span> <span data-ttu-id="00b71-128">20 anslutningar kan hello Stream Analytics-jobbet bearbeta 20 000 händelser i 200 MS och därför 100 000 händelser på en sekund.</span><span class="sxs-lookup"><span data-stu-id="00b71-128">With 20 connections, hello Stream Analytics job can process 20,000 events in 200ms  and therefore 100,000 events in a second.</span></span> <span data-ttu-id="00b71-129">Så tooprocess 200 000 händelser per sekund, hello Stream Analytics-jobbet måste 40 samtidiga anslutningar som kommer ut too12 SUs.</span><span class="sxs-lookup"><span data-stu-id="00b71-129">So tooprocess 200,000 events per second, hello Stream Analytics job needs 40 concurrent connections, which comes out too12 SUs.</span></span> <span data-ttu-id="00b71-130">hello diagrammet nedan visar hello begäranden från webbtjänstslutpunkt för hello Stream Analytics-jobbet toohello Machine Learning – var 6 SUs har 20 samtidiga anslutningar tooMachine Learning-webbtjänst på max.</span><span class="sxs-lookup"><span data-stu-id="00b71-130">hello diagram below illustrates hello requests from hello Stream Analytics job toohello Machine Learning web service endpoint – Every 6 SUs has 20 concurrent connections tooMachine Learning web service at max.</span></span>

<span data-ttu-id="00b71-131">![Skala Stream Analytics med Machine Learning funktioner 2 jobbet exempel](./media/stream-analytics-scale-with-ml-functions/stream-analytics-scale-with-ml-functions-00.png "skala Stream Analytics med Machine Learning funktioner 2 jobbet exemplet")</span><span class="sxs-lookup"><span data-stu-id="00b71-131">![Scale Stream Analytics with Machine Learning Functions 2 job example](./media/stream-analytics-scale-with-ml-functions/stream-analytics-scale-with-ml-functions-00.png "Scale Stream Analytics with Machine Learning Functions 2 job example")</span></span>

<span data-ttu-id="00b71-132">I allmänhet ***B*** för batchstorlek, ***L*** för hello web service svarstid batchstorlek B i millisekunder, hello genomflödet av ett Stream Analytics-jobb med ***N*** SUs är:</span><span class="sxs-lookup"><span data-stu-id="00b71-132">In general, ***B*** for batch size, ***L*** for hello web service latency at batch size B in milliseconds, hello throughput of an Stream Analytics job with ***N*** SUs is:</span></span>

<span data-ttu-id="00b71-133">![Skala Stream Analytics med Machine Learning funktioner formel](./media/stream-analytics-scale-with-ml-functions/stream-analytics-scale-with-ml-functions-02.png "skala Stream Analytics med Machine Learning funktioner formel")</span><span class="sxs-lookup"><span data-stu-id="00b71-133">![Scale Stream Analytics with Machine Learning Functions Formula](./media/stream-analytics-scale-with-ml-functions/stream-analytics-scale-with-ml-functions-02.png "Scale Stream Analytics with Machine Learning Functions Formula")</span></span>

<span data-ttu-id="00b71-134">En ytterligare eftertanke kanske hello 'högsta antal samtidiga anrop' på hello Machine Learning web service sida, rekommenderar vi tooset toohello högsta värdet (för närvarande 200).</span><span class="sxs-lookup"><span data-stu-id="00b71-134">An additional consideration may be hello 'max concurrent calls' on hello Machine Learning web service side, it’s recommended tooset this toohello maximum value (200 currently).</span></span>

<span data-ttu-id="00b71-135">Mer information om den här inställningen Granska hello [skalning artikel för Machine Learning-webbtjänster](../machine-learning/machine-learning-scaling-webservice.md).</span><span class="sxs-lookup"><span data-stu-id="00b71-135">For more information on this setting please review hello [Scaling article for Machine Learning Web Services](../machine-learning/machine-learning-scaling-webservice.md).</span></span>

## <a name="example--sentiment-analysis"></a><span data-ttu-id="00b71-136">Exempel – Sentiment analys</span><span class="sxs-lookup"><span data-stu-id="00b71-136">Example – Sentiment Analysis</span></span>
<span data-ttu-id="00b71-137">hello följande exempel innehåller ett Stream Analytics-jobb med hello sentiment analys Machine Learning-funktionen, enligt beskrivningen i hello [Stream Analytics, Machine Learning integration kursen](stream-analytics-machine-learning-integration-tutorial.md).</span><span class="sxs-lookup"><span data-stu-id="00b71-137">hello following example includes a Stream Analytics job with hello sentiment analysis Machine Learning function, as described in hello [Stream Analytics Machine Learning integration tutorial](stream-analytics-machine-learning-integration-tutorial.md).</span></span>

<span data-ttu-id="00b71-138">hello frågan är en enkel fullständigt partitionerade fråga följt av hello **sentiment** fungerar enligt nedan:</span><span class="sxs-lookup"><span data-stu-id="00b71-138">hello query is a simple fully partitioned query followed by hello **sentiment** function, as shown below:</span></span>

    WITH subquery AS (
        SELECT text, sentiment(text) as result from input
    )

    Select text, result.[Score]
    Into output
    From subquery

<span data-ttu-id="00b71-139">Överväg att hello följande scenario; Stream Analytics-jobbet måste skapas tooperform sentiment analys av hello tweets (händelser) för med en genomströmning på 10 000 tweets per sekund.</span><span class="sxs-lookup"><span data-stu-id="00b71-139">Consider hello following scenario; with a throughput of 10,000 tweets per second a Stream Analytics job must be created tooperform sentiment analysis of hello tweets (events).</span></span> <span data-ttu-id="00b71-140">Med 1 SU Stream Analytics-jobbet kunde kan toohandle hello trafik?</span><span class="sxs-lookup"><span data-stu-id="00b71-140">Using 1 SU, could this Stream Analytics job be able toohandle hello traffic?</span></span> <span data-ttu-id="00b71-141">Med hjälp av hello batch standardstorlek 1000 hello jobbet ska vara kan tookeep upp med hello indata.</span><span class="sxs-lookup"><span data-stu-id="00b71-141">Using hello default batch size of 1000 hello job should be able tookeep up with hello input.</span></span> <span data-ttu-id="00b71-142">Ytterligare hello lägga till Machine Learning-funktionen ska skapa mer än en sekund av latens, vilket är hello allmänna standard svarstiden för hello sentiment analys Machine Learning-webbtjänst (med en standard batchstorlek 1000).</span><span class="sxs-lookup"><span data-stu-id="00b71-142">Further hello added Machine Learning function should generate no more than a second of latency, which is hello general default latency of hello sentiment analysis Machine Learning web service (with a default batch size of 1000).</span></span> <span data-ttu-id="00b71-143">hello Stream Analytics jobbet **övergripande** eller svarstid för slutpunkt till slutpunkt kan vara några sekunder.</span><span class="sxs-lookup"><span data-stu-id="00b71-143">hello Stream Analytics job’s **overall** or end-to-end latency would typically be a few seconds.</span></span> <span data-ttu-id="00b71-144">Ta en närmare titt till Stream Analytics-jobbet *särskilt* hello Machine Learning-funktionsanrop.</span><span class="sxs-lookup"><span data-stu-id="00b71-144">Take a more detailed look into this Stream Analytics job, *especially* hello Machine Learning function calls.</span></span> <span data-ttu-id="00b71-145">Med hello batchstorlek som 1000, tar en genomströmning på 10 000 händelser cirka 10 begäranden tooweb service.</span><span class="sxs-lookup"><span data-stu-id="00b71-145">Having hello batch size as 1000, a throughput of 10,000 events will take about 10 requests tooweb service.</span></span> <span data-ttu-id="00b71-146">Det finns tillräckligt många samtidiga anslutningar tooaccommodate även med 1 SU detta inkommande trafik.</span><span class="sxs-lookup"><span data-stu-id="00b71-146">Even with 1 SU, there are enough concurrent connections tooaccommodate this input traffic.</span></span>

<span data-ttu-id="00b71-147">Men vad händer om hello inkommande händelsehastighet ökar med 100 x och hello Stream Analytics-jobbet måste tooprocess 1 000 000 tweets per sekund?</span><span class="sxs-lookup"><span data-stu-id="00b71-147">But what if hello input event rate increases by 100x and now hello Stream Analytics job needs tooprocess 1,000,000 tweets per second?</span></span> <span data-ttu-id="00b71-148">Det finns två alternativ:</span><span class="sxs-lookup"><span data-stu-id="00b71-148">There are two options:</span></span>

1. <span data-ttu-id="00b71-149">Öka hello batchstorlek eller</span><span class="sxs-lookup"><span data-stu-id="00b71-149">Increase hello batch size, or</span></span>
2. <span data-ttu-id="00b71-150">Partitionen hello Indataströmmen tooprocess hello händelser parallellt</span><span class="sxs-lookup"><span data-stu-id="00b71-150">Partition hello input stream tooprocess hello events in parallel</span></span>

<span data-ttu-id="00b71-151">Hej jobb med hello första alternativet, **svarstid** ökar.</span><span class="sxs-lookup"><span data-stu-id="00b71-151">With hello first option, hello job **latency** will increase.</span></span>

<span data-ttu-id="00b71-152">Med andra alternativ för hello, skulle flera SUs måste toobe etablerad och därför generera flera samtidiga webbtjänstbegäranden för Machine Learning.</span><span class="sxs-lookup"><span data-stu-id="00b71-152">With hello second option, more SUs would need toobe provisioned and therefore generate more concurrent Machine Learning web service requests.</span></span> <span data-ttu-id="00b71-153">Detta innebär hello jobbet **kostnaden** ökar.</span><span class="sxs-lookup"><span data-stu-id="00b71-153">This means hello job **cost** will increase.</span></span>

<span data-ttu-id="00b71-154">Anta hello fördröjning hello sentiment analys Machine Learning-webbtjänsten är 200 MS för 1000-händelsen batchar eller nedan, 250ms för 5 000 händelse batchar 300ms för 10 000-händelsen batchar eller 500ms för 25 000 händelse batchar.</span><span class="sxs-lookup"><span data-stu-id="00b71-154">Assume hello latency of hello sentiment analysis Machine Learning web service is 200ms for 1000-event batches or below, 250ms for 5,000-event batches, 300ms for 10,000-event batches or 500ms for 25,000-event batches.</span></span>

1. <span data-ttu-id="00b71-155">Med alternativet för hello första (**inte** flera SUs-etablering), ökas hello batchstorlek för**25 000**.</span><span class="sxs-lookup"><span data-stu-id="00b71-155">Using hello first option, (**not** provisioning more SUs), hello batch size could be increased too**25,000**.</span></span> <span data-ttu-id="00b71-156">Detta skulle i sin tur låta hello jobbet tooprocess 1 000 000 händelser med 20 samtidiga anslutningar toohello Machine Learning-webbtjänst (med en fördröjning på 500ms per anrop).</span><span class="sxs-lookup"><span data-stu-id="00b71-156">This in turn would allow hello job tooprocess 1,000,000 events with 20 concurrent connections toohello Machine Learning web service (with a latency of 500ms per call).</span></span> <span data-ttu-id="00b71-157">Så hello ytterligare svarstiden för hello Stream Analytics-jobbet på grund av toohello sentiment funktionen förfrågningar mot hello Machine Learning webbtjänstbegäranden skulle ökas från **200 MS** för**500ms**.</span><span class="sxs-lookup"><span data-stu-id="00b71-157">So hello additional latency of hello Stream Analytics job due toohello sentiment function requests against hello Machine Learning web service requests would be increased from **200ms** too**500ms**.</span></span> <span data-ttu-id="00b71-158">Observera dock att batchstorlek **kan** ökas oändligt som hello Machine Learning-webbtjänster kräver hello nyttolastens storlek för en begäran vara 4 MB eller mindre web service-timeout för begäranden efter 100 sekunder av åtgärden.</span><span class="sxs-lookup"><span data-stu-id="00b71-158">However, note that batch size **cannot** be increased infinitely as hello Machine Learning web services requires hello payload size of a request be 4MB or smaller web service requests timeout after 100 seconds of operation.</span></span>
2. <span data-ttu-id="00b71-159">Med andra alternativ för hello hello batchstorlek lämnas på 1000, med 200 MS web service svarstid, webbtjänsten var 20 samtidiga anslutningar toohello att kan tooprocess 1000 * 20 * 5 händelser = 100 000 per sekund.</span><span class="sxs-lookup"><span data-stu-id="00b71-159">Using hello second option, hello batch size is left at 1000, with 200ms web service latency, every 20 concurrent connections toohello web service would be able tooprocess 1000 * 20 * 5 events = 100,000 per second.</span></span> <span data-ttu-id="00b71-160">Därför måste tooprocess 1 000 000 händelser per sekund, hello jobb 60 SUs.</span><span class="sxs-lookup"><span data-stu-id="00b71-160">So tooprocess 1,000,000 events per second, hello job would need 60 SUs.</span></span> <span data-ttu-id="00b71-161">Jämfört med toohello första alternativet, Stream Analytics-jobbet skulle bli mer web service gruppbegäranden i sin tur genererar en ökad kostnad.</span><span class="sxs-lookup"><span data-stu-id="00b71-161">Compared toohello first option, Stream Analytics job would make more web service batch requests, in turn generating an increased cost.</span></span>

<span data-ttu-id="00b71-162">Nedan finns en tabell för hello genomflödet i hello Stream Analytics-jobbet för olika SUs och batch-storlek (i antal händelser per sekund).</span><span class="sxs-lookup"><span data-stu-id="00b71-162">Below is a table for hello throughput of hello Stream Analytics job for different SUs and batch sizes (in number of events per second).</span></span>

| <span data-ttu-id="00b71-163">batchstorlek (ML svarstid)</span><span class="sxs-lookup"><span data-stu-id="00b71-163">batch size (ML latency)</span></span> | <span data-ttu-id="00b71-164">500 (200 MS)</span><span class="sxs-lookup"><span data-stu-id="00b71-164">500 (200ms)</span></span> | <span data-ttu-id="00b71-165">1 000 (200 MS)</span><span class="sxs-lookup"><span data-stu-id="00b71-165">1,000 (200ms)</span></span> | <span data-ttu-id="00b71-166">5 000 (250ms)</span><span class="sxs-lookup"><span data-stu-id="00b71-166">5,000 (250ms)</span></span> | <span data-ttu-id="00b71-167">10 000-tal (300ms)</span><span class="sxs-lookup"><span data-stu-id="00b71-167">10,000 (300ms)</span></span> | <span data-ttu-id="00b71-168">25 000 (500ms)</span><span class="sxs-lookup"><span data-stu-id="00b71-168">25,000 (500ms)</span></span> |
| --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="00b71-169">**1 SU**</span><span class="sxs-lookup"><span data-stu-id="00b71-169">**1 SU**</span></span> |<span data-ttu-id="00b71-170">2,500</span><span class="sxs-lookup"><span data-stu-id="00b71-170">2,500</span></span> |<span data-ttu-id="00b71-171">5,000</span><span class="sxs-lookup"><span data-stu-id="00b71-171">5,000</span></span> |<span data-ttu-id="00b71-172">20,000</span><span class="sxs-lookup"><span data-stu-id="00b71-172">20,000</span></span> |<span data-ttu-id="00b71-173">30,000</span><span class="sxs-lookup"><span data-stu-id="00b71-173">30,000</span></span> |<span data-ttu-id="00b71-174">50,000</span><span class="sxs-lookup"><span data-stu-id="00b71-174">50,000</span></span> |
| <span data-ttu-id="00b71-175">**3 SUs**</span><span class="sxs-lookup"><span data-stu-id="00b71-175">**3 SUs**</span></span> |<span data-ttu-id="00b71-176">2,500</span><span class="sxs-lookup"><span data-stu-id="00b71-176">2,500</span></span> |<span data-ttu-id="00b71-177">5,000</span><span class="sxs-lookup"><span data-stu-id="00b71-177">5,000</span></span> |<span data-ttu-id="00b71-178">20,000</span><span class="sxs-lookup"><span data-stu-id="00b71-178">20,000</span></span> |<span data-ttu-id="00b71-179">30,000</span><span class="sxs-lookup"><span data-stu-id="00b71-179">30,000</span></span> |<span data-ttu-id="00b71-180">50,000</span><span class="sxs-lookup"><span data-stu-id="00b71-180">50,000</span></span> |
| <span data-ttu-id="00b71-181">**6 SUs**</span><span class="sxs-lookup"><span data-stu-id="00b71-181">**6 SUs**</span></span> |<span data-ttu-id="00b71-182">2,500</span><span class="sxs-lookup"><span data-stu-id="00b71-182">2,500</span></span> |<span data-ttu-id="00b71-183">5,000</span><span class="sxs-lookup"><span data-stu-id="00b71-183">5,000</span></span> |<span data-ttu-id="00b71-184">20,000</span><span class="sxs-lookup"><span data-stu-id="00b71-184">20,000</span></span> |<span data-ttu-id="00b71-185">30,000</span><span class="sxs-lookup"><span data-stu-id="00b71-185">30,000</span></span> |<span data-ttu-id="00b71-186">50,000</span><span class="sxs-lookup"><span data-stu-id="00b71-186">50,000</span></span> |
| <span data-ttu-id="00b71-187">**12 SUs**</span><span class="sxs-lookup"><span data-stu-id="00b71-187">**12 SUs**</span></span> |<span data-ttu-id="00b71-188">5,000</span><span class="sxs-lookup"><span data-stu-id="00b71-188">5,000</span></span> |<span data-ttu-id="00b71-189">10 000</span><span class="sxs-lookup"><span data-stu-id="00b71-189">10,000</span></span> |<span data-ttu-id="00b71-190">40,000</span><span class="sxs-lookup"><span data-stu-id="00b71-190">40,000</span></span> |<span data-ttu-id="00b71-191">60,000</span><span class="sxs-lookup"><span data-stu-id="00b71-191">60,000</span></span> |<span data-ttu-id="00b71-192">100,000</span><span class="sxs-lookup"><span data-stu-id="00b71-192">100,000</span></span> |
| <span data-ttu-id="00b71-193">**18 SUs**</span><span class="sxs-lookup"><span data-stu-id="00b71-193">**18 SUs**</span></span> |<span data-ttu-id="00b71-194">7,500</span><span class="sxs-lookup"><span data-stu-id="00b71-194">7,500</span></span> |<span data-ttu-id="00b71-195">15,000</span><span class="sxs-lookup"><span data-stu-id="00b71-195">15,000</span></span> |<span data-ttu-id="00b71-196">60,000</span><span class="sxs-lookup"><span data-stu-id="00b71-196">60,000</span></span> |<span data-ttu-id="00b71-197">90,000</span><span class="sxs-lookup"><span data-stu-id="00b71-197">90,000</span></span> |<span data-ttu-id="00b71-198">150,000</span><span class="sxs-lookup"><span data-stu-id="00b71-198">150,000</span></span> |
| <span data-ttu-id="00b71-199">**24 SUs**</span><span class="sxs-lookup"><span data-stu-id="00b71-199">**24 SUs**</span></span> |<span data-ttu-id="00b71-200">10 000</span><span class="sxs-lookup"><span data-stu-id="00b71-200">10,000</span></span> |<span data-ttu-id="00b71-201">20,000</span><span class="sxs-lookup"><span data-stu-id="00b71-201">20,000</span></span> |<span data-ttu-id="00b71-202">80,000</span><span class="sxs-lookup"><span data-stu-id="00b71-202">80,000</span></span> |<span data-ttu-id="00b71-203">120,000</span><span class="sxs-lookup"><span data-stu-id="00b71-203">120,000</span></span> |<span data-ttu-id="00b71-204">200 000</span><span class="sxs-lookup"><span data-stu-id="00b71-204">200,000</span></span> |
| <span data-ttu-id="00b71-205">**…**</span><span class="sxs-lookup"><span data-stu-id="00b71-205">**…**</span></span> |<span data-ttu-id="00b71-206">…</span><span class="sxs-lookup"><span data-stu-id="00b71-206">…</span></span> |<span data-ttu-id="00b71-207">…</span><span class="sxs-lookup"><span data-stu-id="00b71-207">…</span></span> |<span data-ttu-id="00b71-208">…</span><span class="sxs-lookup"><span data-stu-id="00b71-208">…</span></span> |<span data-ttu-id="00b71-209">…</span><span class="sxs-lookup"><span data-stu-id="00b71-209">…</span></span> |<span data-ttu-id="00b71-210">…</span><span class="sxs-lookup"><span data-stu-id="00b71-210">…</span></span> |
| <span data-ttu-id="00b71-211">**60 SUs**</span><span class="sxs-lookup"><span data-stu-id="00b71-211">**60 SUs**</span></span> |<span data-ttu-id="00b71-212">25,000</span><span class="sxs-lookup"><span data-stu-id="00b71-212">25,000</span></span> |<span data-ttu-id="00b71-213">50,000</span><span class="sxs-lookup"><span data-stu-id="00b71-213">50,000</span></span> |<span data-ttu-id="00b71-214">200 000</span><span class="sxs-lookup"><span data-stu-id="00b71-214">200,000</span></span> |<span data-ttu-id="00b71-215">300,000</span><span class="sxs-lookup"><span data-stu-id="00b71-215">300,000</span></span> |<span data-ttu-id="00b71-216">500,000</span><span class="sxs-lookup"><span data-stu-id="00b71-216">500,000</span></span> |

<span data-ttu-id="00b71-217">Nu, bör du redan har en god förståelse av hur Machine Learning-funktioner i Stream Analytics fungerar.</span><span class="sxs-lookup"><span data-stu-id="00b71-217">By now, you should already have a good understanding of how Machine Learning functions in Stream Analytics work.</span></span> <span data-ttu-id="00b71-218">Du förmodligen förstå också att Stream Analytics-jobb ”pull” data från datakällor och varje ”pull” returnerar en batch med händelser för hello Stream Analytics-jobbet tooprocess.</span><span class="sxs-lookup"><span data-stu-id="00b71-218">You likely also understand that Stream Analytics jobs “pull” data from data sources and each “pull” returns a batch of events for hello Stream Analytics job tooprocess.</span></span> <span data-ttu-id="00b71-219">Hur påverkar den här pull-modellen hello Machine Learning webbtjänstbegäranden?</span><span class="sxs-lookup"><span data-stu-id="00b71-219">How does this pull model impact hello Machine Learning web service requests?</span></span>

<span data-ttu-id="00b71-220">Normalt sett vara inte hello batchstorlek som vi har angetts för Machine Learning funktioner exakt delbart med hello antalet händelser som returneras av varje Stream Analytics-jobbet ”pull”.</span><span class="sxs-lookup"><span data-stu-id="00b71-220">Normally, hello batch size we set for Machine Learning functions won’t exactly be divisible by hello number of events returned by each Stream Analytics job “pull”.</span></span> <span data-ttu-id="00b71-221">Detta inträffar när hello Machine Learning-webbtjänst anropas med ”delar” batchar.</span><span class="sxs-lookup"><span data-stu-id="00b71-221">When this occurs hello Machine Learning web service will be called with “partial” batches.</span></span> <span data-ttu-id="00b71-222">Detta görs toonot innebära ytterligare jobb svarstid försämras under buffertsammanslagning händelser från pull toopull.</span><span class="sxs-lookup"><span data-stu-id="00b71-222">This is done toonot incur additional job latency overhead in coalescing events from pull toopull.</span></span>

## <a name="new-function-related-monitoring-metrics"></a><span data-ttu-id="00b71-223">Ny funktion-relaterade övervakning mått</span><span class="sxs-lookup"><span data-stu-id="00b71-223">New function-related monitoring metrics</span></span>
<span data-ttu-id="00b71-224">Tre ytterligare funktion-relaterade mått har lagts till i hello övervakaren del av ett Stream Analytics-jobb.</span><span class="sxs-lookup"><span data-stu-id="00b71-224">In hello Monitor area of a Stream Analytics job, three additional function-related metrics have been added.</span></span> <span data-ttu-id="00b71-225">De är funktionen BEGÄRANDEN, FUNKTIONSHÄNDELSER och misslyckade BEGÄRANDEN att funktionen enligt hello bilden nedan.</span><span class="sxs-lookup"><span data-stu-id="00b71-225">They are FUNCTION REQUESTS, FUNCTION EVENTS and FAILED FUNCTION REQUESTS, as shown in hello graphic below.</span></span>

<span data-ttu-id="00b71-226">![Skala Stream Analytics med Machine Learning funktioner](./media/stream-analytics-scale-with-ml-functions/stream-analytics-scale-with-ml-functions-01.png "skala Stream Analytics med Machine Learning-funktioner")</span><span class="sxs-lookup"><span data-stu-id="00b71-226">![Scale Stream Analytics with Machine Learning Functions Metrics](./media/stream-analytics-scale-with-ml-functions/stream-analytics-scale-with-ml-functions-01.png "Scale Stream Analytics with Machine Learning Functions Metrics")</span></span>

<span data-ttu-id="00b71-227">hello definieras enligt följande:</span><span class="sxs-lookup"><span data-stu-id="00b71-227">hello are defined as follows:</span></span>

<span data-ttu-id="00b71-228">**FUNKTIONEN BEGÄRANDEN**: hello antal begäranden för funktionen.</span><span class="sxs-lookup"><span data-stu-id="00b71-228">**FUNCTION REQUESTS**: hello number of function requests.</span></span>

<span data-ttu-id="00b71-229">**FUNKTIONSHÄNDELSER**: hello antalet händelser i hello fungera begäranden.</span><span class="sxs-lookup"><span data-stu-id="00b71-229">**FUNCTION EVENTS**: hello number events in hello function requests.</span></span>

<span data-ttu-id="00b71-230">**MISSLYCKADE BEGÄRANDEN om funktionen**: hello antal funktionsfel begäranden.</span><span class="sxs-lookup"><span data-stu-id="00b71-230">**FAILED FUNCTION REQUESTS**: hello number of failed function requests.</span></span>

## <a name="key-takeaways"></a><span data-ttu-id="00b71-231">Viktiga Takeaways</span><span class="sxs-lookup"><span data-stu-id="00b71-231">Key Takeaways</span></span>
<span data-ttu-id="00b71-232">toosummarize hello huvudsakliga punkter, i ordning tooscale ett Stream Analytics-jobb med Machine Learning-funktioner, hello följande objekt måste beaktas:</span><span class="sxs-lookup"><span data-stu-id="00b71-232">toosummarize hello main points, in order tooscale an Stream Analytics job with Machine Learning functions, hello following items must be considered:</span></span>

1. <span data-ttu-id="00b71-233">hello inkommande händelsefrekvens</span><span class="sxs-lookup"><span data-stu-id="00b71-233">hello input event rate</span></span>
2. <span data-ttu-id="00b71-234">hello tolereras svarstid för hello Stream Analytics-jobbet körs (och därmed hello batchstorlek för hello Machine Learning-webbtjänst begäranden)</span><span class="sxs-lookup"><span data-stu-id="00b71-234">hello tolerated latency for hello running Stream Analytics job (and thus hello batch size of hello Machine Learning web service requests)</span></span>
3. <span data-ttu-id="00b71-235">hello etablerats Stream Analytics SUs och hello antal Machine Learning webbtjänstbegäranden (hello ytterligare funktion-relaterade kostnader)</span><span class="sxs-lookup"><span data-stu-id="00b71-235">hello provisioned Stream Analytics SUs and hello number of Machine Learning web service requests (hello additional function-related costs)</span></span>

<span data-ttu-id="00b71-236">En fullständigt partitionerade Stream Analytics-fråga används som exempel.</span><span class="sxs-lookup"><span data-stu-id="00b71-236">A fully partitioned Stream Analytics query was used as an example.</span></span> <span data-ttu-id="00b71-237">Om det behövs en mer komplex fråga hello [Azure Stream Analytics-forum](https://social.msdn.microsoft.com/Forums/en-US/home?forum=AzureStreamAnalytics) är en utmärkt resurs hello Stream Analytics-teamet för att få ytterligare hjälp.</span><span class="sxs-lookup"><span data-stu-id="00b71-237">If a more complex query is needed hello [Azure Stream Analytics forum](https://social.msdn.microsoft.com/Forums/en-US/home?forum=AzureStreamAnalytics) is a great resource for getting additional help from hello Stream Analytics team.</span></span>

## <a name="next-steps"></a><span data-ttu-id="00b71-238">Nästa steg</span><span class="sxs-lookup"><span data-stu-id="00b71-238">Next steps</span></span>
<span data-ttu-id="00b71-239">toolearn mer om Stream Analytics, se:</span><span class="sxs-lookup"><span data-stu-id="00b71-239">toolearn more about Stream Analytics, see:</span></span>

* [<span data-ttu-id="00b71-240">Komma igång med Azure Stream Analytics</span><span class="sxs-lookup"><span data-stu-id="00b71-240">Get started using Azure Stream Analytics</span></span>](stream-analytics-real-time-fraud-detection.md)
* [<span data-ttu-id="00b71-241">Skala Azure Stream Analytics-jobb</span><span class="sxs-lookup"><span data-stu-id="00b71-241">Scale Azure Stream Analytics jobs</span></span>](stream-analytics-scale-jobs.md)
* [<span data-ttu-id="00b71-242">Referens för Azure Stream Analytics-frågespråket</span><span class="sxs-lookup"><span data-stu-id="00b71-242">Azure Stream Analytics Query Language Reference</span></span>](https://msdn.microsoft.com/library/azure/dn834998.aspx)
* [<span data-ttu-id="00b71-243">Referens för Azure Stream Analytics Management REST API</span><span class="sxs-lookup"><span data-stu-id="00b71-243">Azure Stream Analytics Management REST API Reference</span></span>](https://msdn.microsoft.com/library/azure/dn835031.aspx)
