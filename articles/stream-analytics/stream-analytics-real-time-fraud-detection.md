# <a name="get-started-using-azure-stream-analytics-real-time-fraud-detection"></a><span data-ttu-id="6d4d6-101">Komma igång med Azure Stream Analytics: att upptäcka bedrägerier i realtid</span><span class="sxs-lookup"><span data-stu-id="6d4d6-101">Get started using Azure Stream Analytics: Real-time fraud detection</span></span>

<span data-ttu-id="6d4d6-102">Den här självstudiekursen innehåller en slutpunkt till slutpunkt illustration av hur du använder Azure Stream Analytics.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-102">This tutorial provides an end-to-end illustration of how to use Azure Stream Analytics.</span></span> <span data-ttu-id="6d4d6-103">Lär dig att:</span><span class="sxs-lookup"><span data-stu-id="6d4d6-103">You learn how to:</span></span> 

* <span data-ttu-id="6d4d6-104">Ta strömning händelser till en instans av Händelsehubbar i Azure.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-104">Bring streaming events into an instance of Azure Event Hubs.</span></span> <span data-ttu-id="6d4d6-105">I den här kursen ska du använda en app som vi tillhandahåller som simulerar en dataström med metadata för mobiltelefon poster.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-105">In this tutorial, you'll use an app that we provide that simulates a stream of mobile-phone metadata records.</span></span>

* <span data-ttu-id="6d4d6-106">Skriva SQL-liknande Stream Analytics-frågor för att omvandla data, samla information eller söker efter mönster.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-106">Write SQL-like Stream Analytics queries to transform data, aggregating information or looking for patterns.</span></span> <span data-ttu-id="6d4d6-107">Du ser hur du använder en fråga för att undersöka den inkommande dataströmmen och leta efter anrop som kan vara falsk.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-107">You will see how to use a query to examine the incoming stream and look for calls that might be fraudulent.</span></span>

* <span data-ttu-id="6d4d6-108">Skicka resultaten till utdatamottagare (lagring) som du kan analysera för ytterligare information.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-108">Send the results to an output sink (storage) that you can analyze for additional insights.</span></span> <span data-ttu-id="6d4d6-109">I så fall måste skickar du anropsdata misstänkta till Azure Blob storage.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-109">In this case, you'll send the suspicious call data to Azure Blob storage.</span></span>

<span data-ttu-id="6d4d6-110">I den här självstudiekursen använda vi exemplet med baserat på telefonsamtal data att upptäcka realtid bedrägerier.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-110">In  this tutorial, we use the example of real-time fraud detection based on phone-call data.</span></span> <span data-ttu-id="6d4d6-111">Men den teknik som beskriver vi är passar också för andra typer av att upptäcka bedrägerier, till exempel kreditkort bedrägeri eller identitetsstöld.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-111">But the technique we illustrate is also suited for other types of fraud detection, such as credit card fraud or identity theft.</span></span> 

## <a name="scenario-telecommunications-and-sim-fraud-detection-in-real-time"></a><span data-ttu-id="6d4d6-112">Scenario: Telekommunikation och SIM att upptäcka bedrägerier i realtid</span><span class="sxs-lookup"><span data-stu-id="6d4d6-112">Scenario: Telecommunications and SIM fraud detection in real time</span></span>

<span data-ttu-id="6d4d6-113">Ett telekommunikation företag har stora mängder data för inkommande samtal.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-113">A telecommunications company has a large volume of data for incoming calls.</span></span> <span data-ttu-id="6d4d6-114">Företaget vill identifiera bedrägliga anrop i realtid så att de kan meddela kunder eller stänga av tjänsten för ett visst tal.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-114">The company wants to detect fraudulent calls in real time so that they can notify customers or shut down service for a specific number.</span></span> <span data-ttu-id="6d4d6-115">En typ av SIM bedrägeri innebär att flera anrop från samma identitet vid ungefär samma tidpunkt men sig på geografiskt skilda platser.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-115">One type of SIM fraud involves multiple calls from the same identity around the same time but in geographically different locations.</span></span> <span data-ttu-id="6d4d6-116">För att identifiera den här typen av bedrägerier, måste företaget att granska inkommande phone poster och leta efter specifika mönster – i det här fallet för anrop som görs vid ungefär samma tidpunkt i olika länder.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-116">To detect this type of fraud, the company needs to examine incoming phone records and look for specific patterns—in this case, for calls made around the same time in different countries.</span></span> <span data-ttu-id="6d4d6-117">Alla telefonen poster som tillhör den här kategorin skrivs till lagring för efterföljande analys.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-117">Any phone records that fall into this category are written to storage for subsequent analysis.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="6d4d6-118">Krav</span><span class="sxs-lookup"><span data-stu-id="6d4d6-118">Prerequisites</span></span>

<span data-ttu-id="6d4d6-119">I den här självstudiekursen kommer du simulera telefonsamtal data med hjälp av ett klientprogram som genererar exempel telefonsamtal metadata.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-119">In this tutorial, you'll simulate phone-call data by using a client app that generates sample phone call metadata.</span></span> <span data-ttu-id="6d4d6-120">Vissa av posterna som ger appen ser ut som bedrägliga anrop.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-120">Some of the records that the app produces look like fraudulent calls.</span></span> 

<span data-ttu-id="6d4d6-121">Innan du börjar bör du kontrollera att du har följande:</span><span class="sxs-lookup"><span data-stu-id="6d4d6-121">Before you start, make sure you have the following:</span></span>

* <span data-ttu-id="6d4d6-122">Ett Azure-konto.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-122">An Azure account.</span></span>
* <span data-ttu-id="6d4d6-123">Anropet händelse generator app.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-123">The call-event generator app.</span></span> <span data-ttu-id="6d4d6-124">Du kan få detta genom att hämta den [TelcoGenerator.zip filen](http://download.microsoft.com/download/8/B/D/8BD50991-8D54-4F59-AB83-3354B69C8A7E/TelcoGenerator.zip) från Microsoft Download Center.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-124">You can get this by downloading the [TelcoGenerator.zip file](http://download.microsoft.com/download/8/B/D/8BD50991-8D54-4F59-AB83-3354B69C8A7E/TelcoGenerator.zip) from the Microsoft Download Center.</span></span> <span data-ttu-id="6d4d6-125">Packa upp paketet till en mapp på datorn.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-125">Unzip this package into a folder on your computer.</span></span> <span data-ttu-id="6d4d6-126">Om du vill visa källan Platskod och kör appen i en felsökare kan du få app källkod från [GitHub](https://aka.ms/azure-stream-analytics-telcogenerator).</span><span class="sxs-lookup"><span data-stu-id="6d4d6-126">If you want to see the source code and run the app in a debugger, you can get the app source code from [GitHub](https://aka.ms/azure-stream-analytics-telcogenerator).</span></span> 

    >[!NOTE]
    ><span data-ttu-id="6d4d6-127">Windows kan blockera hämtade ZIP-filen.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-127">Windows might block the downloaded .zip file.</span></span> <span data-ttu-id="6d4d6-128">Om du går inte att packa upp den, högerklicka på filen och välj **egenskaper**.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-128">If you can't unzip it, right-click the file and select **Properties**.</span></span> <span data-ttu-id="6d4d6-129">Om meddelandet ”den här filen kommer från en annan dator och kan ha blockerats för att skydda den här datorn”, väljer du den **avblockera** alternativ och klickar sedan på **tillämpa**.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-129">If you see the "This file came from another computer and might be blocked to help protect this computer" message, select the **Unblock** option and then click **Apply**.</span></span>

<span data-ttu-id="6d4d6-130">Om du vill granska resultatet av Streaming Analytics-jobbet måste du också ett verktyg för att visa innehållet i en Azure Blob Storage-behållare.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-130">If you want to examine the results of the Streaming Analytics job, you also need a tool for viewing the contents of a Azure Blob Storage container.</span></span> <span data-ttu-id="6d4d6-131">Om du använder Visual Studio, kan du använda [Azure Tools för Visual Studio](https://docs.microsoft.com/en-us/azure/vs-azure-tools-storage-resources-server-explorer-browse-manage) eller [Visual Studio Cloud Explorer](https://docs.microsoft.com/en-us/azure/vs-azure-tools-resources-managing-with-cloud-explorer).</span><span class="sxs-lookup"><span data-stu-id="6d4d6-131">If you use Visual Studio, you can use [Azure Tools for Visual Studio](https://docs.microsoft.com/en-us/azure/vs-azure-tools-storage-resources-server-explorer-browse-manage) or [Visual Studio Cloud Explorer](https://docs.microsoft.com/en-us/azure/vs-azure-tools-resources-managing-with-cloud-explorer).</span></span> <span data-ttu-id="6d4d6-132">Du kan också installera fristående verktyg som [Azure Lagringsutforskaren](http://storageexplorer.com/) eller [Azure Explorer](http://www.cerebrata.com/products/azure-explorer/introduction).</span><span class="sxs-lookup"><span data-stu-id="6d4d6-132">Alternatively, you can install standalone tools like [Azure Storage Explorer](http://storageexplorer.com/) or [Azure Explorer](http://www.cerebrata.com/products/azure-explorer/introduction).</span></span> 

## <a name="create-an-azure-event-hubs-to-ingest-events"></a><span data-ttu-id="6d4d6-133">Skapa ett Azure event hubs för att mata in händelser</span><span class="sxs-lookup"><span data-stu-id="6d4d6-133">Create an Azure event hubs to ingest events</span></span>

<span data-ttu-id="6d4d6-134">Att analysera en dataström du *infognings-* till Azure.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-134">To analyze a data stream, you *ingest* it into Azure.</span></span> <span data-ttu-id="6d4d6-135">Ett vanligt sätt att mata in data är att använda [Azure Event Hubs](../event-hubs/event-hubs-what-is-event-hubs.md), där du kan mata in miljontals händelser per sekund och sedan bearbeta och lagra händelseinformationen om.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-135">A typical way to ingest data is to use [Azure Event Hubs](../event-hubs/event-hubs-what-is-event-hubs.md), which lets you ingest millions of events per second and then process and store the event information.</span></span> <span data-ttu-id="6d4d6-136">För den här självstudiekursen skapar en händelsehubb och har appen anropet händelse generator skicka anropsdata till den event hub.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-136">For this tutorial, you create an event hub and then have the call-event generator app send call data to that event hub.</span></span> <span data-ttu-id="6d4d6-137">Mer information om händelsehubbar finns i [Azure Service Bus-dokumentationen](https://docs.microsoft.com/en-us/azure/service-bus/).</span><span class="sxs-lookup"><span data-stu-id="6d4d6-137">For more about event hubs, see the [Azure Service Bus documentation](https://docs.microsoft.com/en-us/azure/service-bus/).</span></span>

>[!NOTE]
><span data-ttu-id="6d4d6-138">En mer detaljerad version av den här proceduren finns [skapa ett namnområde för Händelsehubbar och en händelsehubb med hjälp av Azure portal](../event-hubs/event-hubs-create.md).</span><span class="sxs-lookup"><span data-stu-id="6d4d6-138">For a more detailed version of this procedure, see [Create an Event Hubs namespace and an event hub using the Azure portal](../event-hubs/event-hubs-create.md).</span></span> 

### <a name="create-a-namespace-and-event-hub"></a><span data-ttu-id="6d4d6-139">Skapa ett namnområde och händelse-hubb</span><span class="sxs-lookup"><span data-stu-id="6d4d6-139">Create a namespace and event hub</span></span>
<span data-ttu-id="6d4d6-140">I den här proceduren du först skapa en event hub-namnområde och sedan lägga till en händelsehubb i den namepsace.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-140">In this procedure, you first create an event hub namespace, and then you add an event hub to that namepsace.</span></span> <span data-ttu-id="6d4d6-141">Event hub namnområden används för att gruppera relaterade händelser-bussen instanser.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-141">Event hub namespaces are used to logically group related event bus instances.</span></span> 

1. <span data-ttu-id="6d4d6-142">Logga in på Azure portal och klicka på **ny** > **Sakernas Internet** > **Händelsehubb**.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-142">Log  into the Azure portal and click **New** > **Internet of Things** > **Event Hub**.</span></span> 

2. <span data-ttu-id="6d4d6-143">I den **skapa namnområdet** bladet, ange ett namn för namnområdet som `<yourname>-eh-ns-demo`.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-143">In the **Create namespace** blade, enter a namespace name such as `<yourname>-eh-ns-demo`.</span></span> <span data-ttu-id="6d4d6-144">Du kan använda valfritt namn för namnområdet, men namnet måste vara giltigt för en URL och det måste vara unikt i Azure.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-144">You can use any name for the namespace, but the name must be valid for a URL and it must be unique across Azure.</span></span> 
    
3. <span data-ttu-id="6d4d6-145">Välj en prenumeration och skapa eller välja en resursgrupp och sedan klicka på **skapa**.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-145">Select a subscription and create or choose a resource group , then click **Create**.</span></span> 

    ![Skapa ett namnområde för event hub](./media/stream-analytics-real-time-fraud-detection/stream-analytics-create-eventhub-namespace-new-portal.png)
 
4. <span data-ttu-id="6d4d6-147">När namnområdet distribution har slutförts, kan du hitta event hub namnområdet i din lista över Azure-resurser.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-147">When the namespace has finished deploying, find the event hub namespace in your list of Azure resources.</span></span> 

5. <span data-ttu-id="6d4d6-148">Klicka på det nya namnområdet och i bladet namnområdet på  **+ &nbsp;Händelsehubb**.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-148">Click the new namespace, and in the namespace blade, click **+&nbsp;Event Hub**.</span></span> 

    ![<span data-ttu-id="6d4d6-149">Knappen Lägg till Händelsehubben för att skapa en ny händelsehubb</span><span class="sxs-lookup"><span data-stu-id="6d4d6-149">The Add Event Hub button for creating a new event hub</span></span> ](./media/stream-analytics-real-time-fraud-detection/stream-analytics-create-eventhub-button-new-portal.png)    
 
6. <span data-ttu-id="6d4d6-150">Namn på ny händelsehubb `sa-eh-frauddetection-demo`.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-150">Name the new event hub `sa-eh-frauddetection-demo`.</span></span> <span data-ttu-id="6d4d6-151">Du kan använda ett annat namn.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-151">You can use a different name.</span></span> <span data-ttu-id="6d4d6-152">Om du vill anteckna, eftersom du måste ha namnet senare.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-152">If you do, make a note of it, because you need the name later.</span></span> <span data-ttu-id="6d4d6-153">Du behöver inte ange andra alternativ för händelsehubben just nu.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-153">You don't need to set any other options for the event hub right now.</span></span>

    ![Bladet för att skapa en ny händelsehubb](./media/stream-analytics-real-time-fraud-detection/stream-analytics-create-eventhub-new-portal.png)
    
 
7. <span data-ttu-id="6d4d6-155">Klicka på **Skapa**.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-155">Click **Create**.</span></span>
### <a name="grant-access-to-the-event-hub-and-get-a-connection-string"></a><span data-ttu-id="6d4d6-156">Bevilja åtkomst till händelsehubben och få en anslutningssträng</span><span class="sxs-lookup"><span data-stu-id="6d4d6-156">Grant access to the event hub and get a connection string</span></span>

<span data-ttu-id="6d4d6-157">Innan en process kan skicka data till en händelsehubb, måste händelsehubben ha en princip som tillåter åtkomstbehörighet.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-157">Before a process can send data to an event hub, the event hub must have a policy that allows appropriate access.</span></span> <span data-ttu-id="6d4d6-158">Åtkomstprincipen producerar en anslutningssträng som innehåller auktoriseringsinformation om.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-158">The access policy produces a connection string that includes authorization information.</span></span>

1.  <span data-ttu-id="6d4d6-159">I bladet händelse namnområde klickar du på **Händelsehubbar** och klicka sedan på namnet på den nya händelsehubben.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-159">In the event namespace blade, click **Event Hubs** and then click the name of your new event hub.</span></span>

2.  <span data-ttu-id="6d4d6-160">Klicka i hubbladet händelse **principer för delad åtkomst** och klicka sedan på  **+ &nbsp;Lägg till**.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-160">In the event hub blade, click **Shared access policies** and then click **+&nbsp;Add**.</span></span>

    >[!NOTE]
    ><span data-ttu-id="6d4d6-161">Kontrollera att du arbetar med händelsehubb, inte event hub namnområde.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-161">Make sure you're working with the event hub, not the event hub namespace.</span></span>

3.  <span data-ttu-id="6d4d6-162">Lägg till en princip med namnet `sa-policy-manage-demo` och **anspråk**väljer **hantera**.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-162">Add a policy named `sa-policy-manage-demo` and for **Claim**, select **Manage**.</span></span>

    ![Bladet för att skapa en ny händelse hubb princip](./media/stream-analytics-real-time-fraud-detection/stream-analytics-create-shared-access-policy-manage-new-portal.png)
 
4.  <span data-ttu-id="6d4d6-164">Klicka på **Skapa**.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-164">Click **Create**.</span></span>

5.  <span data-ttu-id="6d4d6-165">När principen har distribuerats, klickar du på den i listan med principer för delad åtkomst.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-165">After the policy has been deployed, click it in the list of shared access policies.</span></span>

6.  <span data-ttu-id="6d4d6-166">I listrutan **sträng-primära ANSLUTNINGSNYCKEL** och klicka på kopieringsknappen bredvid anslutningssträngen.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-166">Find the box labeled **CONNECTION STRING-PRIMARY KEY** and click the copy button next to the connection string.</span></span> 
    
    ![Kopiera den primära anslutning strängnyckeln från principen för åtkomst](./media/stream-analytics-real-time-fraud-detection/stream-analytics-shared-access-policy-copy-connection-string-new-portal.png)
 
7.  <span data-ttu-id="6d4d6-168">Klistra in anslutningssträngen i en textredigerare.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-168">Paste the connection string into a text editor.</span></span> <span data-ttu-id="6d4d6-169">Du behöver den här anslutningssträngen för nästa avsnitt, när du har mindre ändringar.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-169">You need this connection string for the next section, after you make some small edits to it.</span></span>

    <span data-ttu-id="6d4d6-170">Anslutningssträngen ser ut så här:</span><span class="sxs-lookup"><span data-stu-id="6d4d6-170">The connection string looks like this:</span></span>

        Endpoint=sb://YOURNAME-eh-ns-demo.servicebus.windows.net/;SharedAccessKeyName=sa-policy-manage-demo;SharedAccessKey=Gw2NFZwU1Di+rxA2T+6hJYAtFExKRXaC2oSQa0ZsPkI=;EntityPath=sa-eh-frauddetection-demo

    <span data-ttu-id="6d4d6-171">Observera att anslutningssträngen innehåller flera nyckel-värdepar, avgränsade med semikolon: `Endpoint`, `SharedAccessKeyName`, `SharedAccessKey`, och `EntityPath`.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-171">Notice that the connection string contains multiple key-value pairs, separated with semicolons: `Endpoint`, `SharedAccessKeyName`, `SharedAccessKey`, and `EntityPath`.</span></span>  

## <a name="configure-and-start-the-event-generator-application"></a><span data-ttu-id="6d4d6-172">Konfigurera och starta programmet händelse generator</span><span class="sxs-lookup"><span data-stu-id="6d4d6-172">Configure and start the event generator application</span></span>

<span data-ttu-id="6d4d6-173">Innan du börjar TelcoGenerator app måste konfigurera du den så att anropet poster skickas till händelsehubben som du just har skapat.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-173">Before you start the TelcoGenerator app, you configure it so that it will send call records to the event hub you just created.</span></span>

### <a name="configure-the-telcogeneratorapp"></a><span data-ttu-id="6d4d6-174">Konfigurera TelcoGeneratorapp</span><span class="sxs-lookup"><span data-stu-id="6d4d6-174">Configure the TelcoGeneratorapp</span></span>

1.  <span data-ttu-id="6d4d6-175">I Redigeraren för dit du kopierade anslutningssträngen, notera den `EntityPath` värdet och ta sedan bort den `EntityPath` par (inte glöm att ta bort semikolonet som föregår den).</span><span class="sxs-lookup"><span data-stu-id="6d4d6-175">In the editor where you copied the connection string, make a note of the `EntityPath` value, and then remove the `EntityPath` pair (don't forget to remove the semicolon that precedes it).</span></span> 

2.  <span data-ttu-id="6d4d6-176">Öppna filen telcodatagen.exe.config i en textredigerare i mappen där du unzipped TelcoGenerator.zip-filen.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-176">In the folder where you unzipped the TelcoGenerator.zip file, open the telcodatagen.exe.config file in an editor.</span></span> <span data-ttu-id="6d4d6-177">(Det finns fler än en .config-fil, så att du öppnat rätt.)</span><span class="sxs-lookup"><span data-stu-id="6d4d6-177">(There is more than one .config file, so be sure that you open the right one.)</span></span>

3.  <span data-ttu-id="6d4d6-178">I den `<appSettings>` element, göra detta:</span><span class="sxs-lookup"><span data-stu-id="6d4d6-178">In the `<appSettings>` element, do this:</span></span>

    * <span data-ttu-id="6d4d6-179">Värdet för den `EventHubName` nyckeln till händelsehubbens namn (det vill säga till värdet för entiteten sökvägen).</span><span class="sxs-lookup"><span data-stu-id="6d4d6-179">Set the value of the `EventHubName` key to the event hub name (that is, to the value of the entity path).</span></span>
    * <span data-ttu-id="6d4d6-180">Ange värdet för den `Microsoft.ServiceBus.ConnectionString` nyckel i anslutningssträngen.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-180">Set the value of the `Microsoft.ServiceBus.ConnectionString` key to the connection string.</span></span> 

    <span data-ttu-id="6d4d6-181">Den `<appSettings>` avsnitt ser ut som i följande exempel.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-181">The `<appSettings>` section will look like the following example.</span></span> <span data-ttu-id="6d4d6-182">(För tydlighetens skull vi omsluten raderna och ta bort vissa tecken från autentiseringstoken.)</span><span class="sxs-lookup"><span data-stu-id="6d4d6-182">(For clarity, we wrapped the lines and removed some characters from the authorization token.)</span></span>

    ![Konfigurationsfilen för TelcoGenerator app visar namn och -anslutningssträngen för hubben](./media/stream-analytics-real-time-fraud-detection/stream-analytics-telcogenerator-config-file-app-settings.png)
 
4.  <span data-ttu-id="6d4d6-184">Spara filen.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-184">Save the file.</span></span> 

### <a name="start-the-app"></a><span data-ttu-id="6d4d6-185">Starta appen</span><span class="sxs-lookup"><span data-stu-id="6d4d6-185">Start the app</span></span>
1.  <span data-ttu-id="6d4d6-186">Öppna ett kommandofönster och gå till mappen där appen TelcoGenerator är uppackade.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-186">Open a command window and change to the folder where the TelcoGenerator app is unzipped.</span></span>
2.  <span data-ttu-id="6d4d6-187">Ange följande kommando:</span><span class="sxs-lookup"><span data-stu-id="6d4d6-187">Enter the following command:</span></span>

        telcodatagen.exe 1000 .2 2

    <span data-ttu-id="6d4d6-188">Parametrarna är:</span><span class="sxs-lookup"><span data-stu-id="6d4d6-188">The parameters are:</span></span> 

    * <span data-ttu-id="6d4d6-189">Antal skivor per timme.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-189">Number of CDRs per hour.</span></span> 
    * <span data-ttu-id="6d4d6-190">SIM-kort bedrägeri sannolikhet: Hur ofta som en procentandel av alla anrop, att appen ska simulera ett bedrägliga anrop.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-190">SIM Card Fraud Probability: How often, as a percentage of all calls, that the app should simulate a fraudulent call.</span></span> <span data-ttu-id="6d4d6-191">Värdet.2 innebär som cirka 20% av anrop poster ser falska.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-191">The value .2 means that about 20% of the call records will look fraudulent.</span></span>
    * <span data-ttu-id="6d4d6-192">Varaktighet i timmar.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-192">Duration in hours.</span></span> <span data-ttu-id="6d4d6-193">Antal timmar som appen ska köras.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-193">The number of hours that the app should run.</span></span> <span data-ttu-id="6d4d6-194">Du kan även stoppa appen helst genom att trycka på Ctrl + C på kommandoraden.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-194">You can also stop the app any time by pressing Ctrl+C at the command line.</span></span>

    <span data-ttu-id="6d4d6-195">Appen startar efter några sekunder att telefonsamtal poster på skärmen när den skickar dem till händelsehubben.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-195">After a few seconds, the app starts displaying phone call records on the screen as it sends them to the event hub.</span></span>

<span data-ttu-id="6d4d6-196">Vissa viktiga fält som du ska använda i realtid bedrägeri identifiering programmet är följande:</span><span class="sxs-lookup"><span data-stu-id="6d4d6-196">Some of the key fields that you will be using in this real-time fraud detection application are the following:</span></span>

|<span data-ttu-id="6d4d6-197">**Post**</span><span class="sxs-lookup"><span data-stu-id="6d4d6-197">**Record**</span></span>|<span data-ttu-id="6d4d6-198">**Definition**</span><span class="sxs-lookup"><span data-stu-id="6d4d6-198">**Definition**</span></span>|
|----------|--------------|
|`CallrecTime`|<span data-ttu-id="6d4d6-199">Tidsstämpel för anropet starttid.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-199">The timestamp for the call start time.</span></span> |
|`SwitchNum`|<span data-ttu-id="6d4d6-200">Telefonväxeln används för att ansluta anropet.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-200">The telephone switch used to connect the call.</span></span> <span data-ttu-id="6d4d6-201">I det här exemplet är växlarna strängar som representerar landet där ursprung (USA Kina, Storbritannien, Tyskland eller Australien).</span><span class="sxs-lookup"><span data-stu-id="6d4d6-201">For this example, the switches are strings that represent the country of origin (US, China, UK, Germany, or Australia).</span></span> |
|`CallingNum`|<span data-ttu-id="6d4d6-202">Telefonnumret för anroparen.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-202">The phone number of the caller.</span></span> |
|`CallingIMSI`|<span data-ttu-id="6d4d6-203">Internationella Mobile Subscriber Identity (IMSI).</span><span class="sxs-lookup"><span data-stu-id="6d4d6-203">The International Mobile Subscriber Identity (IMSI).</span></span> <span data-ttu-id="6d4d6-204">Det här är den unika identifieraren för anroparen.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-204">This is the Unique identifier of the caller.</span></span> |
|`CalledNum`|<span data-ttu-id="6d4d6-205">Anropet mottagarens telefonnummer.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-205">The phone number of the call recipient.</span></span> |
|`CalledIMSI`|<span data-ttu-id="6d4d6-206">Internationella Mobile Subscriber Identity (IMSI).</span><span class="sxs-lookup"><span data-stu-id="6d4d6-206">International Mobile Subscriber Identity (IMSI).</span></span> <span data-ttu-id="6d4d6-207">Det här är den unika identifieraren för anropet mottagaren.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-207">This is the unique identifier of the call recipient.</span></span> |


## <a name="create-a-stream-analytics-job-to-manage-streaming-data"></a><span data-ttu-id="6d4d6-208">Skapa ett Stream Analytics-jobb för att hantera strömmande data</span><span class="sxs-lookup"><span data-stu-id="6d4d6-208">Create a Stream Analytics job to manage streaming data</span></span>

<span data-ttu-id="6d4d6-209">Nu när du har en dataström med anropet händelser kan ställa du in ett Stream Analytics-jobb.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-209">Now that you have a stream of call events, you can set up a Stream Analytics job.</span></span> <span data-ttu-id="6d4d6-210">Jobbet ska läsa data från event hub som du skapat.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-210">The job will read data from the event hub that you set up.</span></span> 

### <a name="create-the-job"></a><span data-ttu-id="6d4d6-211">Skapa jobbet</span><span class="sxs-lookup"><span data-stu-id="6d4d6-211">Create the job</span></span> 

1. <span data-ttu-id="6d4d6-212">I Azure-portalen klickar du på **ny** > **Sakernas Internet** > **Stream Analytics-jobbet**.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-212">In the Azure portal, click **New** > **Internet of Things** > **Stream Analytics job**.</span></span>

2. <span data-ttu-id="6d4d6-213">Namnge jobbet `sa_frauddetection_job_demo`, ange en prenumeration, resursgrupp och plats.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-213">Name the job `sa_frauddetection_job_demo`, specify a subscription, resource group, and location.</span></span>

    <span data-ttu-id="6d4d6-214">Det är en bra idé att placera jobbet och händelsehubben i samma region för bästa prestanda och så att du inte betala för att överföra data mellan regioner.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-214">It's a good idea to place the job and the event hub in the same region for best performance and so that you don't pay to transfer data between regions.</span></span>

    ![Skapa nytt Stream Analytics-jobb](./media/stream-analytics-real-time-fraud-detection/stream-analytics-create-sa-job-new-portal.png)

3. <span data-ttu-id="6d4d6-216">Klicka på **Skapa**.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-216">Click **Create**.</span></span>

    <span data-ttu-id="6d4d6-217">Jobbet har skapats och portalen visar jobbinformation.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-217">The job is created and the portal displays job details.</span></span> <span data-ttu-id="6d4d6-218">Inget kör ännu, men – du måste konfigurera jobbet innan den kan startas.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-218">Nothing is running yet, though—you have to configure the job before it can be started.</span></span>

### <a name="configure-job-input"></a><span data-ttu-id="6d4d6-219">Konfigurera jobbet indata</span><span class="sxs-lookup"><span data-stu-id="6d4d6-219">Configure job input</span></span>

1. <span data-ttu-id="6d4d6-220">I instrumentpanelen eller **alla resurser** bladet, lokaliserar och markerar den `sa_frauddetection_job_demo` Stream Analytics-jobbet.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-220">In the dashboard or the **All resources** blade, find and select the `sa_frauddetection_job_demo` Stream Analytics job.</span></span> 
2. <span data-ttu-id="6d4d6-221">I den **jobbet topologi** avsnitt i Stream Analytics-jobbet bladet, klickar du på den **indata** rutan.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-221">In the **Job Topology** section of the Stream Analytics job blade, click the **Input** box.</span></span>

    ![Textrutan under topologi i bladet Streaming Analytics-jobb](./media/stream-analytics-real-time-fraud-detection/stream-analytics-sa-job-input-box-new-portal.png)
 
3. <span data-ttu-id="6d4d6-223">Klicka på  **+ &nbsp;Lägg till** och fyll sedan i bladet med dessa värden:</span><span class="sxs-lookup"><span data-stu-id="6d4d6-223">Click **+&nbsp;Add** and then fill out the blade with these values:</span></span>

    * <span data-ttu-id="6d4d6-224">**Ett inmatat alias**: Använd namnet `CallStream`.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-224">**Input alias**: Use the name `CallStream`.</span></span> <span data-ttu-id="6d4d6-225">Om du använder ett annat namn, notera den eftersom du behöver senare.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-225">If you use a different name, make a note of it because you'll need it later.</span></span>
    * <span data-ttu-id="6d4d6-226">**Typ av datakälla**: Välj **dataströmmen**.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-226">**Source type**: Select **Data stream**.</span></span> <span data-ttu-id="6d4d6-227">(**Referensdata** refererar till statisk sökning data som du inte använder i den här självstudiekursen.)</span><span class="sxs-lookup"><span data-stu-id="6d4d6-227">(**Reference data** refers to static lookup data, which you won't use in this tutorial.)</span></span>
    * <span data-ttu-id="6d4d6-228">**Källan**: Välj **händelsehubb**.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-228">**Source**: Select **Event hub**.</span></span>
    * <span data-ttu-id="6d4d6-229">**Importera alternativet**: Välj **Använd händelsehubb från aktuell prenumeration**.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-229">**Import option**: Select **Use event hub from current subscription**.</span></span> 
    * <span data-ttu-id="6d4d6-230">**Service bus-namnrymd**: Välj händelsen hubb namnområdet som du skapade tidigare (`<yourname>-eh-ns-demo`).</span><span class="sxs-lookup"><span data-stu-id="6d4d6-230">**Service bus namespace**: Select the event hub namespace that you created earlier (`<yourname>-eh-ns-demo`).</span></span>
    * <span data-ttu-id="6d4d6-231">**Händelsehubb**: Välj händelsehubben som du skapade tidigare (`sa-eh-frauddetection-demo`).</span><span class="sxs-lookup"><span data-stu-id="6d4d6-231">**Event hub**: Select the event hub that you created earlier (`sa-eh-frauddetection-demo`).</span></span>
    * <span data-ttu-id="6d4d6-232">**Namnet på händelsehubben princip**: Välj den åtkomstprincip som du skapade tidigare (`sa-policy-manage-demo`).</span><span class="sxs-lookup"><span data-stu-id="6d4d6-232">**Event hub policy name**: Select the access policy that you created earlier (`sa-policy-manage-demo`).</span></span>

    ![Skapa nya indata för Streaming Analytics-jobbet](./media/stream-analytics-real-time-fraud-detection/stream-analytics-create-sa-input-new-portal.png)

4. <span data-ttu-id="6d4d6-234">Klicka på **Skapa**.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-234">Click **Create**.</span></span>

## <a name="create-queries-to-transform-real-time-data"></a><span data-ttu-id="6d4d6-235">Skapa frågor för att omvandla data i realtid</span><span class="sxs-lookup"><span data-stu-id="6d4d6-235">Create queries to transform real-time data</span></span>

<span data-ttu-id="6d4d6-236">Du har nu ett Stream Analytics-jobb som ställts in för att läsa en inkommande dataström.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-236">At this point, you have a Stream Analytics job set up to read an incoming data stream.</span></span> <span data-ttu-id="6d4d6-237">Nästa steg är att skapa en omvandling som analyserar data i realtid.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-237">The next step is to create a transformation that analyzes the data in real time.</span></span> <span data-ttu-id="6d4d6-238">Det gör du genom att skapa en fråga.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-238">You do this by creating a query.</span></span> <span data-ttu-id="6d4d6-239">Stream Analytics stöder en enkel, deklarativ frågemodell som beskriver omvandlingarna för realtidsbearbetning.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-239">Stream Analytics supports a simple, declarative query model that describes transformations for real-time processing.</span></span> <span data-ttu-id="6d4d6-240">Frågorna använder en SQL-liknande språk som har vissa tillägg som är specifika för stream analytics.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-240">The queries use a SQL-like language that has some extensions specific to stream analytics.</span></span> 

<span data-ttu-id="6d4d6-241">En mycket enkel fråga kan bara läsa alla inkommande data.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-241">A very simple query might simply read all the incoming data.</span></span> <span data-ttu-id="6d4d6-242">Men skapa du ofta frågor som ser ut för specifika data eller relationer i data.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-242">However, you often create queries that look for specific data or for relationships in the data.</span></span> <span data-ttu-id="6d4d6-243">I det här avsnittet av kursen ska du skapa och testa flera frågor för att lära dig några sätt som du kan omvandla en indataström för analys.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-243">In this section of the tutorial, you will create and test several queries to learn a few ways in which you can transform an input stream for analysis.</span></span> 

<span data-ttu-id="6d4d6-244">Frågor som du skapar här visas bara omvandlade data på skärmen.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-244">The queries you create here will just display the transformed data to the screen.</span></span> <span data-ttu-id="6d4d6-245">I ett senare avsnitt får du konfigurera utdatamottagare och en fråga som skriver omvandlade data till som mottagare.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-245">In a later section, you'll configure an output sink and a query that writes the transformed data to that sink.</span></span>

<span data-ttu-id="6d4d6-246">Mer information om språk finns i [referens för Azure Stream Analytics Query Language](https://msdn.microsoft.com/library/dn834998.aspx).</span><span class="sxs-lookup"><span data-stu-id="6d4d6-246">To learn more about the language, see the [Azure Stream Analytics Query Language Reference](https://msdn.microsoft.com/library/dn834998.aspx).</span></span>

### <a name="get-sample-data-for-testing-queries"></a><span data-ttu-id="6d4d6-247">Hämta exempeldata för att testa frågor</span><span class="sxs-lookup"><span data-stu-id="6d4d6-247">Get sample data for testing queries</span></span>

<span data-ttu-id="6d4d6-248">TelcoGenerator appen skickar poster för anrop till händelsehubben och Stream Analytics-jobbet har konfigurerats för att läsa från event hub.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-248">The TelcoGenerator app is sending call records to the event hub, and your Stream Analytics job is configured to read from the event hub.</span></span> <span data-ttu-id="6d4d6-249">Du kan använda en fråga för att testa jobbet att se till att läsa på rätt sätt.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-249">You can use a query to test the job to make sure that it's reading correctly.</span></span> <span data-ttu-id="6d4d6-250">Om du vill testa en fråga i Azure-konsolen behöver exempeldata.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-250">To  test a query in the Azure console, you need sample data.</span></span> <span data-ttu-id="6d4d6-251">Den här genomgången ska du extrahera exempeldata från strömmen som kommer till händelsehubben.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-251">For this walkthrough, you'll extract sample data from the stream that's coming into the event hub.</span></span>

1. <span data-ttu-id="6d4d6-252">Se till att appen TelcoGenerator körs och producerar anropet poster.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-252">Make sure that the TelcoGenerator app is running and producing call records.</span></span>
2. <span data-ttu-id="6d4d6-253">Gå tillbaka till bladet Streaming Analytics-jobbet i portalen.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-253">In the portal, return to the Streaming Analytics job blade.</span></span> <span data-ttu-id="6d4d6-254">(Om du har stängt bladet kan du söka efter `sa_frauddetection_job_demo` i den **alla resurser** bladet.)</span><span class="sxs-lookup"><span data-stu-id="6d4d6-254">(If you closed the blade, search for `sa_frauddetection_job_demo` in the **All resources** blade.)</span></span>
3. <span data-ttu-id="6d4d6-255">Klicka på den **frågan** rutan.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-255">Click the **Query** box.</span></span> <span data-ttu-id="6d4d6-256">Azure visar in- och utgångar som är konfigurerade för jobbet och kan du skapa en fråga som kan du omvandla Indataströmmen som skickas till utdata.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-256">Azure lists the inputs and outputs that are configured for the job, and lets you create a query that lets you transform the input stream as it is sent to the output.</span></span>
4. <span data-ttu-id="6d4d6-257">I den **frågan** bladet, klickar du på punkter bredvid den `CallStream` indata och välj sedan **exempeldata från indata**.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-257">In the **Query** blade, click the dots next to the `CallStream` input and then select **Sample data from input**.</span></span>

    ![Menyn Alternativ exempeldata för posten Streaming Analytics-jobb med ”exempeldata från indata” markerad](./media/stream-analytics-real-time-fraud-detection/stream-analytics-create-sample-data-from-input.png)

    <span data-ttu-id="6d4d6-259">Då öppnas ett blad som du kan ange hur mycket exempeldata som kan definieras enligt hur lång tid för att läsa Indataströmmen.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-259">This opens a blade that lets you specify how much sample data to get, defined in terms of how long to read the input stream.</span></span>

5. <span data-ttu-id="6d4d6-260">Ange **minuter** till 3 och klicka sedan på **OK**.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-260">Set **Minutes** to 3 and then click **OK**.</span></span> 
    
    ![Alternativ för provtagning Indataströmmen, med ”3 minuter” markerad.](./media/stream-analytics-real-time-fraud-detection/stream-analytics-input-create-sample-data.png)

    <span data-ttu-id="6d4d6-262">Azure exempel 3 minuter kan du se från Indataströmmen och meddelar dig när exempeldata är klar.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-262">Azure samples 3 minutes' worth of data from the input stream and notifies you when the sample data is ready.</span></span> <span data-ttu-id="6d4d6-263">(Detta tar en stund.)</span><span class="sxs-lookup"><span data-stu-id="6d4d6-263">(This takes a short while.)</span></span> 

<span data-ttu-id="6d4d6-264">Exempeldata lagras tillfälligt och är tillgänglig när du har frågefönster öppnas.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-264">The sample data is stored temporarily and is available while you have the query window open.</span></span> <span data-ttu-id="6d4d6-265">Om du stänger frågefönstret exempeldata ignoreras och måste du skapa en ny uppsättning exempeldata.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-265">If you close the query window, the sample data is discarded, and you'll have to create a new set of sample data.</span></span> 

<span data-ttu-id="6d4d6-266">Alternativt kan du hämta en JSON-fil som innehåller exempeldata [från GitHub](https://github.com/Azure/azure-stream-analytics/blob/master/Sample%20Data/telco.json), och sedan ladda upp den JSON-fil som ska användas som exempeldata för den `CallStream` indata.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-266">As an alternative, you can get a .json file that has sample data in it [from GitHub](https://github.com/Azure/azure-stream-analytics/blob/master/Sample%20Data/telco.json), and then upload that .json file to use as sample data for the `CallStream` input .</span></span> 

### <a name="test-using-a-pass-through-query"></a><span data-ttu-id="6d4d6-267">Testa med en direktfråga</span><span class="sxs-lookup"><span data-stu-id="6d4d6-267">Test using a pass-through query</span></span>

<span data-ttu-id="6d4d6-268">Du kan använda en direktfråga för att läsa alla fält i nyttolasten för händelsen om du vill arkivera varje händelse.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-268">If you want to archive every event, you can use a pass-through query to read all the fields in the payload of the event.</span></span>

1. <span data-ttu-id="6d4d6-269">Ange den här frågan i frågefönstret:</span><span class="sxs-lookup"><span data-stu-id="6d4d6-269">In the query window, enter this query:</span></span>

        SELECT 
            *
        FROM 
            CallStream

    >[!NOTE]
    ><span data-ttu-id="6d4d6-270">Precis som med SQL, nyckelord är inte skiftlägeskänsliga och blanksteg är inte viktig.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-270">As with SQL, keywords are not case sensitive, and whitespace is not significant.</span></span>

    <span data-ttu-id="6d4d6-271">I den här frågan `CallStream` är alias som du angav när du skapade indata.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-271">In this query, `CallStream` is the alias that you specified when you created the input.</span></span> <span data-ttu-id="6d4d6-272">Om du använde ett annat alias kan du använda det namnet i stället.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-272">If you used a different alias, use that name instead.</span></span>

2. <span data-ttu-id="6d4d6-273">Klicka på **Test**.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-273">Click **Test**.</span></span>

    <span data-ttu-id="6d4d6-274">Stream Analytics-jobbet körs frågan mot exempeldata och visar utdata längst ned i fönstret.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-274">The Stream Analytics job runs the query against the sample data and displays the output at the bottom of the window.</span></span> <span data-ttu-id="6d4d6-275">Du ser att händelsehubben och Streaming Analytics-jobbet är korrekt konfigurerade.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-275">This tells you that the event hub and the Streaming Analytics job are configured correctly.</span></span> <span data-ttu-id="6d4d6-276">(Som anges senare ska du skapa utdatamottagare som frågan kan skriva data till.)</span><span class="sxs-lookup"><span data-stu-id="6d4d6-276">(As noted, later you'll create an output sink that the query can write data to.)</span></span>

    ![Stream Analytics-jobbet utdata visar 73 poster som genereras](./media/stream-analytics-real-time-fraud-detection/stream-analytics-sa-job-sample-output.png)

    <span data-ttu-id="6d4d6-278">Det exakta antalet poster som visas beror på hur många poster som har hämtats i ditt exempel 3 minuter.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-278">The exact number of records you see will depend on how many records were captured in your 3-minute sample.</span></span>
 
### <a name="reduce-the-number-of-fields-using-a-column-projection"></a><span data-ttu-id="6d4d6-279">Minska antalet fält med en kolumn projektion</span><span class="sxs-lookup"><span data-stu-id="6d4d6-279">Reduce the number of fields using a column projection</span></span>

<span data-ttu-id="6d4d6-280">I många fall måste inte dina analyser alla kolumner i Indataströmmen.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-280">In many cases, your analysis doesn't need all the columns from the input stream.</span></span> <span data-ttu-id="6d4d6-281">Du kan använda en fråga för att projicera en mindre uppsättning returnerade fält än i direktfrågan.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-281">You can use a query to project a smaller set of returned fields than in the pass-through query.</span></span>

1. <span data-ttu-id="6d4d6-282">Ändra frågan i kodredigeraren för till följande:</span><span class="sxs-lookup"><span data-stu-id="6d4d6-282">Change the query in the code editor to the following:</span></span>

        SELECT CallRecTime, SwitchNum, CallingIMSI, CallingNum, CalledNum 
        FROM 
            CallStream

2. <span data-ttu-id="6d4d6-283">Klicka på **Test** igen.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-283">Click **Test** again.</span></span> 

    ![Stream Analytics-jobbet utdata för projektion som visar 25 poster som genereras](./media/stream-analytics-real-time-fraud-detection/stream-analytics-sa-job-sample-output-projection.png)
 
### <a name="count-incoming-calls-by-region-tumbling-window-with-aggregation"></a><span data-ttu-id="6d4d6-285">Antal inkommande anrop per region: rullande fönster med aggregering</span><span class="sxs-lookup"><span data-stu-id="6d4d6-285">Count incoming calls by region: Tumbling window with aggregation</span></span>

<span data-ttu-id="6d4d6-286">Anta att du vill räkna antalet inkommande anrop per region.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-286">Suppose you want to count the number of incoming calls per region.</span></span> <span data-ttu-id="6d4d6-287">När du vill utföra mängdfunktioner som inventering, med strömmande data, måste du segmentera dataströmmen i temporal enheter (eftersom dataströmmen själva är effektivt oändliga).</span><span class="sxs-lookup"><span data-stu-id="6d4d6-287">In streaming data, when you want to perform aggregate functions like counting, you need to segment the stream into temporal units (since the data stream itself is effectively endless).</span></span> <span data-ttu-id="6d4d6-288">Du gör detta med hjälp av en Streaming Analytics [fönstret funktionen](stream-analytics-window-functions.md).</span><span class="sxs-lookup"><span data-stu-id="6d4d6-288">You do this using a Streaming Analytics [window function](stream-analytics-window-functions.md).</span></span> <span data-ttu-id="6d4d6-289">Du kan arbeta med data i fönstret som en enhet.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-289">You can then work with the data inside that window as a unit.</span></span>

<span data-ttu-id="6d4d6-290">Den här omvandlingen du vill ha en sekvens av temporala windows som inte överlappar varandra – varje fönster har en separat uppsättning data som du kan gruppera och aggregering.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-290">For this transformation, you want a sequence of temporal windows that don't overlap—each window will have a discrete set of data that you can group and aggregate.</span></span> <span data-ttu-id="6d4d6-291">Den här typen av fönstret kallas en *rullande fönster* .</span><span class="sxs-lookup"><span data-stu-id="6d4d6-291">This type of window is referred to as a *Tumbling window* .</span></span> <span data-ttu-id="6d4d6-292">I fönstret rullande du antalet inkommande samtal grupperade efter `SwitchNum`, som motsvarar det land där anropet kommer från.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-292">Within the Tumbling window, you can get a count of the incoming calls grouped by `SwitchNum`, which represents the country where the call originated.</span></span> 

1. <span data-ttu-id="6d4d6-293">Ändra frågan i kodredigeraren för till följande:</span><span class="sxs-lookup"><span data-stu-id="6d4d6-293">Change the query in the code editor to the following:</span></span>

        SELECT 
            System.Timestamp as WindowEnd, SwitchNum, COUNT(*) as CallCount 
        FROM
            CallStream TIMESTAMP BY CallRecTime 
        GROUP BY TUMBLINGWINDOW(s, 5), SwitchNum

    <span data-ttu-id="6d4d6-294">Den här frågan använder den `Timestamp By` nyckelord i den `FROM` -sats för att ange vilka tidsstämpelfältet i Indataströmmen definition rullande fönster.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-294">This query uses the `Timestamp By` keyword in the `FROM` clause to specify which timestamp field in the input stream to use to define the Tumbling window.</span></span> <span data-ttu-id="6d4d6-295">I det här fallet fönstret delas upp data i segment av den `CallRecTime` i varje post.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-295">In this case, the window divides the data into segments by the `CallRecTime` field in each record.</span></span> <span data-ttu-id="6d4d6-296">(Om inget fält har angetts används den tid som varje händelse anländer till händelsehubben med fönsterhantering igen.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-296">(If no field is specified, the windowing operation uses the time that each event arrives at the event hub.</span></span> <span data-ttu-id="6d4d6-297">Se ”tid Vs programmet ankomsttid” i [strömma Analytics Query Language Reference](https://msdn.microsoft.com/library/azure/dn834998.aspx).</span><span class="sxs-lookup"><span data-stu-id="6d4d6-297">See "Arrival Time Vs Application Time" in [Stream Analytics Query Language Reference](https://msdn.microsoft.com/library/azure/dn834998.aspx).</span></span> 

    <span data-ttu-id="6d4d6-298">Projektionen som innehåller `System.Timestamp`, som returnerar en tidsstämpel för slutet av varje fönster.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-298">The projection includes `System.Timestamp`, which returns a timestamp for the end of each window.</span></span> 

    <span data-ttu-id="6d4d6-299">Om du vill ange att du vill använda en rullande fönster som du använder den [TUMBLINGWINDOW](https://msdn.microsoft.com/library/dn835055.aspx) fungera i den `GROUP BY `satsen.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-299">To specify that you want to use a Tumbling window, you use the [TUMBLINGWINDOW](https://msdn.microsoft.com/library/dn835055.aspx) function in the `GROUP BY `clause.</span></span> <span data-ttu-id="6d4d6-300">I funktionen anger du en tidsenhet (var som helst från en mikrosekundnivå till en dag) och en fönsterstorlek (hur många enheter).</span><span class="sxs-lookup"><span data-stu-id="6d4d6-300">In the function, you specify a time unit (anywhere from a microsecond to a day) and a window size (how many units).</span></span> <span data-ttu-id="6d4d6-301">I det här exemplet består rullande fönster av 5 sekunder intervall, så du får ett antal per land för samtal som var femte sekund.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-301">In this example, the Tumbling window consists of 5-second intervals, so you will get a count by country for every 5 seconds' worth of calls.</span></span>

2. <span data-ttu-id="6d4d6-302">Klicka på **Test** igen.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-302">Click **Test** again.</span></span> <span data-ttu-id="6d4d6-303">Observera att i resultaten tidsstämplar under **WindowEnd** finns i steg 5 sekunder.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-303">In the results, notice that the timestamps under **WindowEnd** are in 5-second increments.</span></span>

    ![Stream Analytics-jobbet utdata för aggregering, visar 13 poster som genereras](./media/stream-analytics-real-time-fraud-detection/stream-analytics-sa-job-sample-output-aggregation.png)
 
### <a name="detect-sim-fraud-using-a-self-join"></a><span data-ttu-id="6d4d6-305">Identifiera SIM bedrägeri med hjälp av en självkoppling</span><span class="sxs-lookup"><span data-stu-id="6d4d6-305">Detect SIM fraud using a self-join</span></span>

<span data-ttu-id="6d4d6-306">I det här exemplet Vi anser att bedrägliga användning ska anrop som kommer från samma användare men på olika platser inom 5 sekunder från varandra.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-306">For this example, we can consider fraudulent usage to be calls that originate from the same user but in different locations within 5 seconds of one another.</span></span> <span data-ttu-id="6d4d6-307">Samma användare kan till exempel legitimt ringa ett samtal från USA och Australien på samma gång.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-307">For example, the same user can't legitimately make a call from the US and Australia at the same time.</span></span> 

<span data-ttu-id="6d4d6-308">Om du vill söka efter dessa fall, du kan använda en självkoppling för strömmande data att ansluta till dataströmmen till sig själv baserat på den `CallRecTime` värde.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-308">To check for these cases, you can use a self-join of the streaming data to join the stream to itself based on the `CallRecTime` value.</span></span> <span data-ttu-id="6d4d6-309">Du kan sedan söka efter anropet poster där den `CallingIMSI` värde (det ursprungliga nummer) är detsamma, men `SwitchNum` värdet (land för ursprung) är inte samma.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-309">You can then look for call records where the `CallingIMSI` value (the originating number) is the same, but the `SwitchNum` value (country of origin) is not the same.</span></span>

<span data-ttu-id="6d4d6-310">När du använder en koppling med strömmande data måste kopplingen ange vissa begränsningar på hur långt matchande rader kan delas upp i tid.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-310">When you use a join with streaming data, the join must provide some limits on how far the matching rows can be separated in time.</span></span> <span data-ttu-id="6d4d6-311">(Som tidigare nämnts strömmande data är effektivt oändlig.) Tid gränser för relationen har angetts i den `ON` -satsen för en koppling med hjälp av den `DATEDIFF` funktion.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-311">(As noted earlier, the streaming data is effectively endless.) The time bounds for the relationship are specified inside the `ON` clause of the join, using the `DATEDIFF` function .</span></span> <span data-ttu-id="6d4d6-312">I det här fallet baseras kopplingen på ett samtal data 5 sekunder tidsintervall.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-312">In this case, the join is based on a 5-second interval of call data .</span></span>

1. <span data-ttu-id="6d4d6-313">Ändra frågan i kodredigeraren för till följande:</span><span class="sxs-lookup"><span data-stu-id="6d4d6-313">Change the query in the code editor to the following:</span></span> 

        SELECT  System.Timestamp as Time, 
            CS1.CallingIMSI, 
            CS1.CallingNum as CallingNum1, 
            CS2.CallingNum as CallingNum2, 
            CS1.SwitchNum as Switch1, 
            CS2.SwitchNum as Switch2 
        FROM CallStream CS1 TIMESTAMP BY CallRecTime 
            JOIN CallStream CS2 TIMESTAMP BY CallRecTime 
            ON CS1.CallingIMSI = CS2.CallingIMSI 
            AND DATEDIFF(ss, CS1, CS2) BETWEEN 1 AND 5 
        WHERE CS1.SwitchNum != CS2.SwitchNum

    <span data-ttu-id="6d4d6-314">Den här frågan är precis som alla SQL-koppling utom för den `DATEDIFF` funktionen i kopplingen.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-314">This query is like any SQL join except for the `DATEDIFF` function in the join.</span></span> <span data-ttu-id="6d4d6-315">Detta är en version av `DATEDIFF` som är specifika för Streaming Analytics och det måste visas i den `ON...BETWEEN` satsen.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-315">This is a version of `DATEDIFF` that's specific to Streaming Analytics, and it must appear in the `ON...BETWEEN` clause.</span></span> <span data-ttu-id="6d4d6-316">Parametrarna är en tidsenhet (sekunder i det här exemplet) och alias två källor för kopplingen.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-316">The parameters are a time unit (seconds in this example) and the aliases of the two sources for the join.</span></span> <span data-ttu-id="6d4d6-317">(Detta skiljer sig från standard SQL `DATEDIFF` funktionen.)</span><span class="sxs-lookup"><span data-stu-id="6d4d6-317">(This is different from the standard SQL `DATEDIFF` function.)</span></span> 

    <span data-ttu-id="6d4d6-318">Den `WHERE` -instruktionen innehåller villkor som flaggar bedrägliga anropet: de ursprungliga växlarna inte är samma.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-318">The `WHERE` clause includes the condition that flags the fraudulent call: the originating switches are not the same.</span></span> 

2. <span data-ttu-id="6d4d6-319">Klicka på **Test** igen.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-319">Click **Test** again.</span></span> 

    ![Stream Analytics-jobbet utdata för självkoppling, visar 6 poster som genereras](./media/stream-analytics-real-time-fraud-detection/stream-analytics-sa-job-sample-output-self-join.png)

3. <span data-ttu-id="6d4d6-321">Klicka på **Spara**.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-321">Click **Save**.</span></span> <span data-ttu-id="6d4d6-322">Detta sparar självkoppling frågan som en del av Streaming Analytics-jobbet.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-322">This saves the self-join query as part of the Streaming Analytics job.</span></span> <span data-ttu-id="6d4d6-323">(Den inte spara exempeldata.)</span><span class="sxs-lookup"><span data-stu-id="6d4d6-323">(It doesn't save the sample data.)</span></span>

    ![Spara Stream Analytics-jobbet](./media/stream-analytics-real-time-fraud-detection/stream-analytics-query-editor-save-button-new-portal.png)

## <a name="create-an-output-sink-to-store-transformed-data"></a><span data-ttu-id="6d4d6-325">Skapa utdatamottagare för att lagra omvandlade data</span><span class="sxs-lookup"><span data-stu-id="6d4d6-325">Create an output sink to store transformed data</span></span>

<span data-ttu-id="6d4d6-326">Du har definierat en händelseström, en händelsehubb som indata för att mata in händelser och en fråga för att genomföra en omvandling över dataströmmen.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-326">You've defined an event stream, an event hub input to ingest events, and a query to perform a transformation over the stream.</span></span> <span data-ttu-id="6d4d6-327">Det sista steget är att definiera utdatamottagare för jobbet – det vill säga en plats för att skriva transformerade dataström till.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-327">The last step is to define an output sink for the job—that is, a place to write the transformed stream to.</span></span> 

<span data-ttu-id="6d4d6-328">Du kan använda många resurser som utdata sänkor – SQL Server-databasen, tabellagring, Data Lake lagring, Power BI och en annan händelsehubb.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-328">You can use many resources as output sinks—a SQL Server database, table storage, Data Lake storage, Power BI, and even another event hub.</span></span> <span data-ttu-id="6d4d6-329">För den här kursen ska du skriva dataströmmen till Azure Blob Storage, vilket är ett vanliga alternativ för att samla in händelseinformation för senare analys, eftersom den innehåller Ostrukturerade data.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-329">For this tutorial, you'll write the stream to Azure Blob Storage, which is a typical choice for collecting event information for later analysis, since it accommodates unstructured data .</span></span>

<span data-ttu-id="6d4d6-330">Om du har en befintlig blob storage-konto kan använda du som.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-330">If you have an existing blob storage account, you can use that.</span></span> <span data-ttu-id="6d4d6-331">För den här kursen finns visar om hur du skapar ett nytt lagringskonto för den här kursen.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-331">For this tutorial, we'll show you how to create a new storage account just for this tutorial.</span></span>

### <a name="create-an-azure-blob-storage-account"></a><span data-ttu-id="6d4d6-332">Skapa ett Azure Blob Storage-konto</span><span class="sxs-lookup"><span data-stu-id="6d4d6-332">Create an Azure Blob Storage account</span></span>

1. <span data-ttu-id="6d4d6-333">Gå tillbaka till bladet Streaming Analytics-jobb på Azure-portalen.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-333">In the Azure portal, return to the Streaming Analytics job blade.</span></span> <span data-ttu-id="6d4d6-334">(Om du har stängt bladet kan du söka efter `sa_frauddetection_job_demo` i den **alla resurser** bladet.)</span><span class="sxs-lookup"><span data-stu-id="6d4d6-334">(If you closed the blade, search for `sa_frauddetection_job_demo` in the **All resources** blade.)</span></span>
2. <span data-ttu-id="6d4d6-335">I den **jobbet topologi** klickar du på den **utdata** rutan.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-335">In the **Job Topology** section, click the **Output** box.</span></span> 
3. <span data-ttu-id="6d4d6-336">I den **utdata** bladet, klickar du på  **+ &nbsp;Lägg till** och fyll sedan i bladet med dessa värden:</span><span class="sxs-lookup"><span data-stu-id="6d4d6-336">In the **Outputs** blade, click **+&nbsp;Add** and then fill out the blade with these values:</span></span>

    * <span data-ttu-id="6d4d6-337">**Ett utdataalias**: Använd namnet `CallStream-FraudulentCalls`.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-337">**Output alias**: Use the name `CallStream-FraudulentCalls`.</span></span> 
    * <span data-ttu-id="6d4d6-338">**Sink**: Välj **Blob storage**.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-338">**Sink**: Select **Blob storage**.</span></span>
    * <span data-ttu-id="6d4d6-339">**Importalternativ**: Välj **använda blob storage från aktuell prenumeration**.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-339">**Import options**: Select **Use blob storage from current subscription**.</span></span>
    * <span data-ttu-id="6d4d6-340">**Lagringskontot**.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-340">**Storage account**.</span></span> <span data-ttu-id="6d4d6-341">Välj **Skapa nytt lagringskonto.**</span><span class="sxs-lookup"><span data-stu-id="6d4d6-341">Select **Create new storage account.**</span></span>
    * <span data-ttu-id="6d4d6-342">**Lagringskontot** (andra rutan).</span><span class="sxs-lookup"><span data-stu-id="6d4d6-342">**Storage account** (second box).</span></span> <span data-ttu-id="6d4d6-343">Ange `YOURNAMEsademo`, där `YOURNAME` är ditt namn eller en annan unik sträng.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-343">Enter `YOURNAMEsademo`, where `YOURNAME` is your name or another unique string.</span></span> <span data-ttu-id="6d4d6-344">Namnet kan använda bara gemena bokstäver och siffror, och den måste vara unikt i Azure.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-344">The name can use only lowercase letters and numbers, and it must be unique across Azure.</span></span> 
    * <span data-ttu-id="6d4d6-345">**Behållaren**.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-345">**Container**.</span></span> <span data-ttu-id="6d4d6-346">Ange `sa-fraudulentcalls-demo`.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-346">Enter `sa-fraudulentcalls-demo`.</span></span>
    <span data-ttu-id="6d4d6-347">Lagringskontonamn och behållarnamn används tillsammans för att ge en URI för blobblagring, så här:</span><span class="sxs-lookup"><span data-stu-id="6d4d6-347">The storage account name and container name are used together to provide a URI for the blob storage, like this:</span></span> 

    `http://yournamesademo.blob.core.windows.net/sa-fraudulentcalls-demo/...`
    
    ![”Nya utdata” bladet för Stream Analytics-jobbet](./media/stream-analytics-real-time-fraud-detection/stream-analytics-create-output-blob-storage-new-console.png)
    
4. <span data-ttu-id="6d4d6-349">Klicka på **Skapa**.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-349">Click **Create**.</span></span> 

    <span data-ttu-id="6d4d6-350">Azure skapar lagringskontot och skapar automatiskt en nyckel.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-350">Azure creates the storage account and generates a key automatically.</span></span> 

5. <span data-ttu-id="6d4d6-351">Stäng den **utdata** bladet.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-351">Close the **Outputs** blade.</span></span> 

## <a name="start-the-streaming-analytics-job"></a><span data-ttu-id="6d4d6-352">Starta Streaming Analytics-jobbet</span><span class="sxs-lookup"><span data-stu-id="6d4d6-352">Start the Streaming Analytics job</span></span>

<span data-ttu-id="6d4d6-353">Jobbet har nu konfigurerats.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-353">The job is now configured.</span></span> <span data-ttu-id="6d4d6-354">Du har angett indata (händelsehubben), en omvandling (frågan ska sökas efter bedrägliga anrop) och utdata (blobblagring).</span><span class="sxs-lookup"><span data-stu-id="6d4d6-354">You've specified an input (the event hub), a transformation (the query to look for fraudulent calls), and an output (blob storage).</span></span> <span data-ttu-id="6d4d6-355">Nu kan du starta jobbet.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-355">You can now start the job.</span></span> 

1. <span data-ttu-id="6d4d6-356">Kontrollera att TelcoGenerator appen körs.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-356">Make sure the TelcoGenerator app is running.</span></span>

2. <span data-ttu-id="6d4d6-357">I jobb-bladet klickar du på **starta**.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-357">In the job blade, click **Start**.</span></span>

    ![Starta Stream Analytics-jobbet](./media/stream-analytics-real-time-fraud-detection/stream-analytics-sa-job-start-output.png)

3. <span data-ttu-id="6d4d6-359">I den **startjobb** bladet för utdata starttid, Välj **nu**.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-359">In the **Start job** blade, for Job output start time, select **Now**.</span></span> 

4. <span data-ttu-id="6d4d6-360">Klicka på **starta**.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-360">Click **Start**.</span></span> 

    ![”Starta jobbet” bladet för Stream Analytics-jobbet](./media/stream-analytics-real-time-fraud-detection/stream-analytics-sa-job-start-job-blade.png)

    <span data-ttu-id="6d4d6-362">Azure meddelar dig när jobbet har startat och i bladet jobb visas status som **kör**.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-362">Azure notifies you when the job has started, and in the job blade, the status is displayed as **Running**.</span></span>

    ![Stream Analytics-jobbstatusen, visar ”körs”](./media/stream-analytics-real-time-fraud-detection/stream-analytics-sa-job-running-status.png)
    

## <a name="examine-the-transformed-data"></a><span data-ttu-id="6d4d6-364">Granska omvandlade data</span><span class="sxs-lookup"><span data-stu-id="6d4d6-364">Examine the transformed data</span></span>

<span data-ttu-id="6d4d6-365">Nu har du en fullständig Streaming Analytics-jobbet.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-365">You now have a complete Streaming Analytics job.</span></span> <span data-ttu-id="6d4d6-366">Jobbet undersöka en dataström med metadata för telefonsamtal, söker efter bedrägliga telefonsamtal i realtid och skriva information om dessa falska anrop till lagring.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-366">The job is examining a stream of phone call metadata, looking for fraudulent phone calls in real time, and writing information about those fraudulent calls to storage.</span></span> 

<span data-ttu-id="6d4d6-367">Du kanske vill titta på de data som fångas av Streaming Analytics-jobb för den här kursen.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-367">To complete this tutorial, you might want to look at the data being captured by the Streaming Analytics job.</span></span> <span data-ttu-id="6d4d6-368">Data skrivs till Azure-bloggen Storage i segment (filer).</span><span class="sxs-lookup"><span data-stu-id="6d4d6-368">The data is being written to Azure Blog Storage in chunks (files).</span></span> <span data-ttu-id="6d4d6-369">Du kan använda ett verktyg som läser Azure Blob Storage.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-369">You can use any tool that reads Azure Blob Storage.</span></span> <span data-ttu-id="6d4d6-370">Enligt beskrivningen i avsnittet förutsättningar, du kan använda Azure tillägg i Visual Studio och du kan använda ett verktyg som [Azure Lagringsutforskaren](http://storageexplorer.com/) eller [Azure Explorer](http://www.cerebrata.com/products/azure-explorer/introduction).</span><span class="sxs-lookup"><span data-stu-id="6d4d6-370">As noted in the Prerequisites section, you can use Azure extensions in Visual Studio, or you can use a tool like [Azure Storage Explorer](http://storageexplorer.com/) or [Azure Explorer](http://www.cerebrata.com/products/azure-explorer/introduction).</span></span> 

<span data-ttu-id="6d4d6-371">När du undersöker innehållet i en fil i blob storage finns något som liknar följande:</span><span class="sxs-lookup"><span data-stu-id="6d4d6-371">When you examine the contents of a file in blob storage, you see something like the following :</span></span>

![Azure blob storage med Streaming Analytics-utdata](./media/stream-analytics-real-time-fraud-detection/stream-analytics-sa-job-blob-storage-view.png)
 

## <a name="clean-up-resources"></a><span data-ttu-id="6d4d6-373">Rensa resurser</span><span class="sxs-lookup"><span data-stu-id="6d4d6-373">Clean up resources</span></span>

<span data-ttu-id="6d4d6-374">Vi har ytterligare artiklar som fortsätta med scenario för upptäckt av bedrägerier och som använder de resurser som du har skapat i den här kursen.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-374">We have additional articles that continue with the fraud-detection scenario and that use the resources that you've created in this tutorial.</span></span> <span data-ttu-id="6d4d6-375">Om du vill fortsätta finns förslag under **nästa steg** senare.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-375">If you want to continue, see the suggestions under **Next steps** later.</span></span>

<span data-ttu-id="6d4d6-376">Men om du är klar och du inte behöver de resurser som du har skapat, du kan ta bort dem så att du inte debiteras onödiga Azure.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-376">However, if you're done and you don't need the resources you've created, you can delete them so that you don't incur unnecessary Azure charges.</span></span> <span data-ttu-id="6d4d6-377">Vi rekommenderar i så fall kan du göra följande:</span><span class="sxs-lookup"><span data-stu-id="6d4d6-377">In that case, we suggest that you do the following:</span></span>

1. <span data-ttu-id="6d4d6-378">Stoppa Streaming Analytics-jobbet.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-378">Stop the Streaming Analytics job.</span></span> <span data-ttu-id="6d4d6-379">I den **jobb** bladet, klickar du på **stoppa** längst upp.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-379">In the **Jobs** blade, click **Stop** at the top.</span></span>
2. <span data-ttu-id="6d4d6-380">Stoppa anger Generator app.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-380">Stop the Telco Generator app.</span></span> <span data-ttu-id="6d4d6-381">Tryck på Ctrl + C i kommandofönstret som du startade appen.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-381">In the command window where you started the app, press Ctrl+C.</span></span>
3. <span data-ttu-id="6d4d6-382">Ta bort om du har skapat en ny blob storage-konto för den här kursen.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-382">If you created a new blob storage account just for this tutorial, delete it.</span></span> 
4. <span data-ttu-id="6d4d6-383">Ta bort Streaming Analytics-jobbet.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-383">Delete the Streaming Analytics job.</span></span>
5. <span data-ttu-id="6d4d6-384">Ta bort händelsehubben.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-384">Delete the event hub.</span></span>
6. <span data-ttu-id="6d4d6-385">Ta bort namnområdet event hub.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-385">Delete the event hub namespace.</span></span>

## <a name="get-support"></a><span data-ttu-id="6d4d6-386">Få support</span><span class="sxs-lookup"><span data-stu-id="6d4d6-386">Get support</span></span>

<span data-ttu-id="6d4d6-387">För ytterligare hjälp försök vår [Azure Stream Analytics-forum](https://social.msdn.microsoft.com/Forums/en-US/home?forum=AzureStreamAnalytics).</span><span class="sxs-lookup"><span data-stu-id="6d4d6-387">For further assistance, try our [Azure Stream Analytics forum](https://social.msdn.microsoft.com/Forums/en-US/home?forum=AzureStreamAnalytics).</span></span>

## <a name="next-steps"></a><span data-ttu-id="6d4d6-388">Nästa steg</span><span class="sxs-lookup"><span data-stu-id="6d4d6-388">Next steps</span></span>

<span data-ttu-id="6d4d6-389">Du kan fortsätta den här kursen i följande artiklar:</span><span class="sxs-lookup"><span data-stu-id="6d4d6-389">You can continue this tutorial with the following articles:</span></span>

* <span data-ttu-id="6d4d6-390">[Strömma analyser och Power BI: en analys i realtid instrumentpanel för strömmande data](stream-analytics-power-bi-dashboard.md).</span><span class="sxs-lookup"><span data-stu-id="6d4d6-390">[Stream Analytics and Power BI: A real-time analytics dashboard for streaming data](stream-analytics-power-bi-dashboard.md).</span></span> <span data-ttu-id="6d4d6-391">Den här artikeln visar hur du skickar utdata till Stream Analytics-jobb anger till Power BI för visualisering i realtid och analys.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-391">This article shows you how to send the TelCo output of the Stream Analytics job to Power BI for real-time visualization and analysis.</span></span>
* <span data-ttu-id="6d4d6-392">[Hur du lagrar data från Azure Stream Analytics i en Azure Redis-Cache med hjälp av Azure Functions](stream-analytics-functions-redis.md).</span><span class="sxs-lookup"><span data-stu-id="6d4d6-392">[How to store data from Azure Stream Analytics in an Azure Redis Cache using Azure Functions](stream-analytics-functions-redis.md).</span></span> <span data-ttu-id="6d4d6-393">Den här artikeln visar hur du använder Azure Functions för att skriva bedrägliga anrop till ett Azure Redis-cache via en Service Bus-kö.</span><span class="sxs-lookup"><span data-stu-id="6d4d6-393">This article shows how to use Azure Functions to write fraudulent calls to an Azure Redis cache via a Service Bus queue.</span></span>

<span data-ttu-id="6d4d6-394">Mer information om Stream Analytics i allmänhet försök dessa artiklar:</span><span class="sxs-lookup"><span data-stu-id="6d4d6-394">For more information about Stream Analytics in general, try these articles:</span></span>

* [<span data-ttu-id="6d4d6-395">Introduktion till Azure Stream Analytics</span><span class="sxs-lookup"><span data-stu-id="6d4d6-395">Introduction to Azure Stream Analytics</span></span>](stream-analytics-introduction.md)
* [<span data-ttu-id="6d4d6-396">Skala Azure Stream Analytics-jobb</span><span class="sxs-lookup"><span data-stu-id="6d4d6-396">Scale Azure Stream Analytics jobs</span></span>](stream-analytics-scale-jobs.md)
* [<span data-ttu-id="6d4d6-397">Referens för Azure Stream Analytics-frågespråket</span><span class="sxs-lookup"><span data-stu-id="6d4d6-397">Azure Stream Analytics Query Language Reference</span></span>](https://msdn.microsoft.com/library/azure/dn834998.aspx)
* [<span data-ttu-id="6d4d6-398">Referens för Azure Stream Analytics Management REST API</span><span class="sxs-lookup"><span data-stu-id="6d4d6-398">Azure Stream Analytics Management REST API Reference</span></span>](https://msdn.microsoft.com/library/azure/dn835031.aspx)
