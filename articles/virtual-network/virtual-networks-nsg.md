---
title: "aaaNetwork säkerhetsgrupper i Azure | Microsoft Docs"
description: "Lär dig hur tooisolate och kontroll trafiken inom dina virtuella nätverk som använder hello distribuerade brandväggen i Azure med Nätverkssäkerhetsgrupper."
services: virtual-network
documentationcenter: na
author: jimdial
manager: timlt
editor: tysonn
ms.assetid: 20e850fc-6456-4b5f-9a3f-a8379b052bc9
ms.service: virtual-network
ms.devlang: na
ms.topic: get-started-article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 02/11/2016
ms.author: jdial
ms.openlocfilehash: 3528ce833dab17977327c3c9ae0e78316e5e6a05
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 10/06/2017
---
# <a name="filter-network-traffic-with-network-security-groups"></a><span data-ttu-id="282b1-103">Filtrera nätverkstrafik med nätverkssäkerhetsgrupper</span><span class="sxs-lookup"><span data-stu-id="282b1-103">Filter network traffic with network security groups</span></span>

<span data-ttu-id="282b1-104">En nätverkssäkerhetsgrupp (NSG) innehåller en lista över säkerhetsregler som tillåter eller nekar nätverket trafik tooresources anslutna tooAzure virtuella nätverk (VNet).</span><span class="sxs-lookup"><span data-stu-id="282b1-104">A network security group (NSG) contains a list of security rules that allow or deny network traffic tooresources connected tooAzure Virtual Networks (VNet).</span></span> <span data-ttu-id="282b1-105">NSG: er kan vara associerade toosubnets, enskilda virtuella datorer (klassisk) eller enskilda nätverksgränssnitt (NIC) kopplade tooVMs (Resource Manager).</span><span class="sxs-lookup"><span data-stu-id="282b1-105">NSGs can be associated toosubnets, individual VMs (classic), or individual network interfaces (NIC) attached tooVMs (Resource Manager).</span></span> <span data-ttu-id="282b1-106">När en NSG är associerad tooa undernät, tillämpas hello reglerna tooall resurser anslutna toohello undernät.</span><span class="sxs-lookup"><span data-stu-id="282b1-106">When an NSG is associated tooa subnet, hello rules apply tooall resources connected toohello subnet.</span></span> <span data-ttu-id="282b1-107">Trafik kan ytterligare begränsas av också koppla en NSG tooa VM eller nätverkskort.</span><span class="sxs-lookup"><span data-stu-id="282b1-107">Traffic can further be restricted by also associating an NSG tooa VM or NIC.</span></span>

> [!NOTE]
> <span data-ttu-id="282b1-108">Azure har två olika distributionsmodeller för att skapa och arbeta med resurser: [Resource Manager och klassisk](../resource-manager-deployment-model.md).</span><span class="sxs-lookup"><span data-stu-id="282b1-108">Azure has two different deployment models for creating and working with resources:  [Resource Manager and classic](../resource-manager-deployment-model.md).</span></span> <span data-ttu-id="282b1-109">Den här artikeln täcker bägge modellerna, men Microsoft rekommenderar att de flesta nya distributioner använder hello Resource Manager-modellen.</span><span class="sxs-lookup"><span data-stu-id="282b1-109">This article covers using both models, but Microsoft recommends that most new deployments use hello Resource Manager model.</span></span>

## <a name="nsg-resource"></a><span data-ttu-id="282b1-110">NSG-resurs</span><span class="sxs-lookup"><span data-stu-id="282b1-110">NSG resource</span></span>
<span data-ttu-id="282b1-111">NSG: er innehåller hello följande egenskaper:</span><span class="sxs-lookup"><span data-stu-id="282b1-111">NSGs contain hello following properties:</span></span>

| <span data-ttu-id="282b1-112">Egenskap</span><span class="sxs-lookup"><span data-stu-id="282b1-112">Property</span></span> | <span data-ttu-id="282b1-113">Beskrivning</span><span class="sxs-lookup"><span data-stu-id="282b1-113">Description</span></span> | <span data-ttu-id="282b1-114">Villkor</span><span class="sxs-lookup"><span data-stu-id="282b1-114">Constraints</span></span> | <span data-ttu-id="282b1-115">Överväganden</span><span class="sxs-lookup"><span data-stu-id="282b1-115">Considerations</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="282b1-116">Namn</span><span class="sxs-lookup"><span data-stu-id="282b1-116">Name</span></span> |<span data-ttu-id="282b1-117">Namn för hello NSG</span><span class="sxs-lookup"><span data-stu-id="282b1-117">Name for hello NSG</span></span> |<span data-ttu-id="282b1-118">Måste vara unikt inom hello region.</span><span class="sxs-lookup"><span data-stu-id="282b1-118">Must be unique within hello region.</span></span><br/><span data-ttu-id="282b1-119">Kan innehålla bokstäver, siffror, understreck, punkter och bindestreck.</span><span class="sxs-lookup"><span data-stu-id="282b1-119">Can contain letters, numbers, underscores, periods, and hyphens.</span></span><br/><span data-ttu-id="282b1-120">Måste börja med en bokstav eller en siffra.</span><span class="sxs-lookup"><span data-stu-id="282b1-120">Must start with a letter or number.</span></span><br/><span data-ttu-id="282b1-121">Måste sluta med en bokstav, en siffra eller understreck.</span><span class="sxs-lookup"><span data-stu-id="282b1-121">Must end with a letter, number, or underscore.</span></span><br/><span data-ttu-id="282b1-122">Får inte vara längre än 80 tecken.</span><span class="sxs-lookup"><span data-stu-id="282b1-122">Cannot exceed 80 characters.</span></span> |<span data-ttu-id="282b1-123">Eftersom du kan behöva toocreate flera NSG: er, kontrollera att du har en namngivningskonvention som gör det enkelt tooidentify hello-funktionen för din NSG.</span><span class="sxs-lookup"><span data-stu-id="282b1-123">Since you may need toocreate several NSGs, make sure you have a naming convention that makes it easy tooidentify hello function of your NSGs.</span></span> |
| <span data-ttu-id="282b1-124">Region</span><span class="sxs-lookup"><span data-stu-id="282b1-124">Region</span></span> |<span data-ttu-id="282b1-125">Azure [region](https://azure.microsoft.com/regions) där hello NSG skapas.</span><span class="sxs-lookup"><span data-stu-id="282b1-125">Azure [region](https://azure.microsoft.com/regions) where hello NSG is created.</span></span> |<span data-ttu-id="282b1-126">NSG: er kan bara vara associerad tooresources inom hello samma region som hello NSG.</span><span class="sxs-lookup"><span data-stu-id="282b1-126">NSGs can only be associated tooresources within hello same region as hello NSG.</span></span> |<span data-ttu-id="282b1-127">toolearn om hur många NSG: er som du kan ha per region, läsa hello [Azure begränsar](../azure-subscription-service-limits.md#virtual-networking-limits-classic) artikel.</span><span class="sxs-lookup"><span data-stu-id="282b1-127">toolearn about how many NSGs you can have per region, read hello [Azure limits](../azure-subscription-service-limits.md#virtual-networking-limits-classic) article.</span></span>|
| <span data-ttu-id="282b1-128">Resursgrupp</span><span class="sxs-lookup"><span data-stu-id="282b1-128">Resource group</span></span> |<span data-ttu-id="282b1-129">Hej [resursgruppen](../azure-resource-manager/resource-group-overview.md#resource-groups) hello NSG finns i.</span><span class="sxs-lookup"><span data-stu-id="282b1-129">hello [resource group](../azure-resource-manager/resource-group-overview.md#resource-groups) hello NSG exists in.</span></span> |<span data-ttu-id="282b1-130">Även om en NSG finns i en resursgrupp, det kan vara associerade tooresources i valfri resursgrupp, så länge hello resursen är en del av hello samma Azure-region som hello NSG.</span><span class="sxs-lookup"><span data-stu-id="282b1-130">Although an NSG exists in a resource group, it can be associated tooresources in any resource group, as long as hello resource is part of hello same Azure region as hello NSG.</span></span> |<span data-ttu-id="282b1-131">Resursgrupper är används toomanage flera resurser tillsammans som en distributionsenhet.</span><span class="sxs-lookup"><span data-stu-id="282b1-131">Resource groups are used toomanage multiple resources together, as a deployment unit.</span></span><br/><span data-ttu-id="282b1-132">Du kan gruppera hello NSG med resurser som den är kopplad till.</span><span class="sxs-lookup"><span data-stu-id="282b1-132">You may consider grouping hello NSG with resources it is associated to.</span></span> |
| <span data-ttu-id="282b1-133">Regler</span><span class="sxs-lookup"><span data-stu-id="282b1-133">Rules</span></span> |<span data-ttu-id="282b1-134">Inkommande eller utgående regler som definierar vilken trafik som tillåts eller nekas.</span><span class="sxs-lookup"><span data-stu-id="282b1-134">Inbound or outbound rules that define what traffic is allowed or denied.</span></span> | |<span data-ttu-id="282b1-135">Se hello [NSG-regler](#Nsg-rules) i den här artikeln.</span><span class="sxs-lookup"><span data-stu-id="282b1-135">See hello [NSG rules](#Nsg-rules) section of this article.</span></span> |

> [!NOTE]
> <span data-ttu-id="282b1-136">Slutpunktsbaserade ACL: er och nätverkssäkerhet grupper inte stöds på hello samma VM-instans.</span><span class="sxs-lookup"><span data-stu-id="282b1-136">Endpoint-based ACLs and network security groups are not supported on hello same VM instance.</span></span> <span data-ttu-id="282b1-137">Om du vill toouse en NSG och redan har en slutpunkts-ACL på plats måste du först ta bort hello slutpunkts-ACL.</span><span class="sxs-lookup"><span data-stu-id="282b1-137">If you want toouse an NSG and have an endpoint ACL already in place, first remove hello endpoint ACL.</span></span> <span data-ttu-id="282b1-138">toolearn hur tooremove en ACL läsa hello [hantera åtkomstkontrollistor (ACL) för slutpunkter med hjälp av PowerShell](virtual-networks-acl-powershell.md) artikel.</span><span class="sxs-lookup"><span data-stu-id="282b1-138">toolearn how tooremove an ACL, read hello [Managing Access Control Lists (ACLs) for Endpoints by using PowerShell](virtual-networks-acl-powershell.md) article.</span></span>
> 

### <a name="nsg-rules"></a><span data-ttu-id="282b1-139">NSG-regler</span><span class="sxs-lookup"><span data-stu-id="282b1-139">NSG rules</span></span>
<span data-ttu-id="282b1-140">NSG-regler har hello följande egenskaper:</span><span class="sxs-lookup"><span data-stu-id="282b1-140">NSG rules contain hello following properties:</span></span>

| <span data-ttu-id="282b1-141">Egenskap</span><span class="sxs-lookup"><span data-stu-id="282b1-141">Property</span></span> | <span data-ttu-id="282b1-142">Beskrivning</span><span class="sxs-lookup"><span data-stu-id="282b1-142">Description</span></span> | <span data-ttu-id="282b1-143">Villkor</span><span class="sxs-lookup"><span data-stu-id="282b1-143">Constraints</span></span> | <span data-ttu-id="282b1-144">Överväganden</span><span class="sxs-lookup"><span data-stu-id="282b1-144">Considerations</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="282b1-145">**Namn**</span><span class="sxs-lookup"><span data-stu-id="282b1-145">**Name**</span></span> |<span data-ttu-id="282b1-146">Namn för hello regel.</span><span class="sxs-lookup"><span data-stu-id="282b1-146">Name for hello rule.</span></span> |<span data-ttu-id="282b1-147">Måste vara unikt inom hello region.</span><span class="sxs-lookup"><span data-stu-id="282b1-147">Must be unique within hello region.</span></span><br/><span data-ttu-id="282b1-148">Kan innehålla bokstäver, siffror, understreck, punkter och bindestreck.</span><span class="sxs-lookup"><span data-stu-id="282b1-148">Can contain letters, numbers, underscores, periods, and hyphens.</span></span><br/><span data-ttu-id="282b1-149">Måste börja med en bokstav eller en siffra.</span><span class="sxs-lookup"><span data-stu-id="282b1-149">Must start with a letter or number.</span></span><br/><span data-ttu-id="282b1-150">Måste sluta med en bokstav, en siffra eller understreck.</span><span class="sxs-lookup"><span data-stu-id="282b1-150">Must end with a letter, number, or underscore.</span></span><br/><span data-ttu-id="282b1-151">Får inte vara längre än 80 tecken.</span><span class="sxs-lookup"><span data-stu-id="282b1-151">Cannot exceed 80 characters.</span></span> |<span data-ttu-id="282b1-152">Du kan ha flera regler inom en NSG, så se till att du följer en namngivningskonvention som gör att du tooidentify hello-funktionen för din regel.</span><span class="sxs-lookup"><span data-stu-id="282b1-152">You may have several rules within an NSG, so make sure you follow a naming convention that allows you tooidentify hello function of your rule.</span></span> |
| <span data-ttu-id="282b1-153">**Protokoll**</span><span class="sxs-lookup"><span data-stu-id="282b1-153">**Protocol**</span></span> |<span data-ttu-id="282b1-154">Protokollet toomatch för hello regeln.</span><span class="sxs-lookup"><span data-stu-id="282b1-154">Protocol toomatch for hello rule.</span></span> |<span data-ttu-id="282b1-155">TCP, UDP eller *</span><span class="sxs-lookup"><span data-stu-id="282b1-155">TCP, UDP, or *</span></span> |<span data-ttu-id="282b1-156">Använda * som ett protokoll inkluderar ICMP (enbart öst-väst-trafik), som samt UDP och TCP och kan minska hello antalet regler du behöver.</span><span class="sxs-lookup"><span data-stu-id="282b1-156">Using * as a protocol includes ICMP (East-West traffic only), as well as UDP and TCP, and may reduce hello number of rules you need.</span></span><br/><span data-ttu-id="282b1-157">AT hello samma tid med * kanske för bred lösning, det rekommenderas att du använder * bara när det behövs.</span><span class="sxs-lookup"><span data-stu-id="282b1-157">At hello same time, using * might be too broad an approach, so it's recommended that you use * only when necessary.</span></span> |
| <span data-ttu-id="282b1-158">**Källportintervall**</span><span class="sxs-lookup"><span data-stu-id="282b1-158">**Source port range**</span></span> |<span data-ttu-id="282b1-159">Källan port intervallet toomatch för hello regeln.</span><span class="sxs-lookup"><span data-stu-id="282b1-159">Source port range toomatch for hello rule.</span></span> |<span data-ttu-id="282b1-160">Enskilda portnummer mellan 1 too65535, portintervall (exempel: 1-65535), eller * (för alla portar).</span><span class="sxs-lookup"><span data-stu-id="282b1-160">Single port number from 1 too65535, port range (example: 1-65535), or * (for all ports).</span></span> |<span data-ttu-id="282b1-161">Källportar kan vara tillfälliga.</span><span class="sxs-lookup"><span data-stu-id="282b1-161">Source ports could be ephemeral.</span></span> <span data-ttu-id="282b1-162">Såvida inte klientprogrammet använder en viss port bör du använda * i de flesta fall.</span><span class="sxs-lookup"><span data-stu-id="282b1-162">Unless your client program is using a specific port, use * in most cases.</span></span><br/><span data-ttu-id="282b1-163">Försök toouse portintervall så mycket som möjligt tooavoid hello behöver för flera regler.</span><span class="sxs-lookup"><span data-stu-id="282b1-163">Try toouse port ranges as much as possible tooavoid hello need for multiple rules.</span></span><br/><span data-ttu-id="282b1-164">Flera portar eller portintervall kan inte grupperas med kommatecken.</span><span class="sxs-lookup"><span data-stu-id="282b1-164">Multiple ports or port ranges cannot be grouped by a comma.</span></span> |
| <span data-ttu-id="282b1-165">**Målportintervall**</span><span class="sxs-lookup"><span data-stu-id="282b1-165">**Destination port range**</span></span> |<span data-ttu-id="282b1-166">Mål-port intervallet toomatch för hello regeln.</span><span class="sxs-lookup"><span data-stu-id="282b1-166">Destination port range toomatch for hello rule.</span></span> |<span data-ttu-id="282b1-167">Enskilda portnummer mellan 1 too65535, portintervall (exempel: 1-65535), eller \* (för alla portar).</span><span class="sxs-lookup"><span data-stu-id="282b1-167">Single port number from 1 too65535, port range (example: 1-65535), or \* (for all ports).</span></span> |<span data-ttu-id="282b1-168">Försök toouse portintervall så mycket som möjligt tooavoid hello behöver för flera regler.</span><span class="sxs-lookup"><span data-stu-id="282b1-168">Try toouse port ranges as much as possible tooavoid hello need for multiple rules.</span></span><br/><span data-ttu-id="282b1-169">Flera portar eller portintervall kan inte grupperas med kommatecken.</span><span class="sxs-lookup"><span data-stu-id="282b1-169">Multiple ports or port ranges cannot be grouped by a comma.</span></span> |
| <span data-ttu-id="282b1-170">**Källadress-prefix**</span><span class="sxs-lookup"><span data-stu-id="282b1-170">**Source address prefix**</span></span> |<span data-ttu-id="282b1-171">Källan adress prefix eller tagg toomatch för hello regeln.</span><span class="sxs-lookup"><span data-stu-id="282b1-171">Source address prefix or tag toomatch for hello rule.</span></span> |<span data-ttu-id="282b1-172">Enskild IP-adress (exempel: 10.10.10.10), IP-undernät (exempel: 192.168.1.0/24), [standardtagg](#default-tags) eller * (för alla adresser).</span><span class="sxs-lookup"><span data-stu-id="282b1-172">Single IP address (example: 10.10.10.10), IP subnet (example: 192.168.1.0/24), [default tag](#default-tags), or * (for all addresses).</span></span> |<span data-ttu-id="282b1-173">Överväg att använda intervall, standardtaggar och * tooreduce hello antal regler.</span><span class="sxs-lookup"><span data-stu-id="282b1-173">Consider using ranges, default tags, and * tooreduce hello number of rules.</span></span> |
| <span data-ttu-id="282b1-174">**Måladress-prefix**</span><span class="sxs-lookup"><span data-stu-id="282b1-174">**Destination address prefix**</span></span> |<span data-ttu-id="282b1-175">Mål-adress prefix eller tagg toomatch för hello regeln.</span><span class="sxs-lookup"><span data-stu-id="282b1-175">Destination address prefix or tag toomatch for hello rule.</span></span> | <span data-ttu-id="282b1-176">Enskild IP-adress (exempel: 10.10.10.10), IP-undernät (exempel: 192.168.1.0/24), [standardtagg](#default-tags) eller * (för alla adresser).</span><span class="sxs-lookup"><span data-stu-id="282b1-176">Single IP address (example: 10.10.10.10), IP subnet (example: 192.168.1.0/24), [default tag](#default-tags), or * (for all addresses).</span></span> |<span data-ttu-id="282b1-177">Överväg att använda intervall, standardtaggar och * tooreduce hello antal regler.</span><span class="sxs-lookup"><span data-stu-id="282b1-177">Consider using ranges, default tags, and * tooreduce hello number of rules.</span></span> |
| <span data-ttu-id="282b1-178">**Riktning**</span><span class="sxs-lookup"><span data-stu-id="282b1-178">**Direction**</span></span> |<span data-ttu-id="282b1-179">Riktningen på trafik toomatch för hello regeln.</span><span class="sxs-lookup"><span data-stu-id="282b1-179">Direction of traffic toomatch for hello rule.</span></span> |<span data-ttu-id="282b1-180">Inkommande eller utgående.</span><span class="sxs-lookup"><span data-stu-id="282b1-180">Inbound or outbound.</span></span> |<span data-ttu-id="282b1-181">Regler för inkommande och utgående bearbetas separat, baserat på riktning.</span><span class="sxs-lookup"><span data-stu-id="282b1-181">Inbound and outbound rules are processed separately, based on direction.</span></span> |
| <span data-ttu-id="282b1-182">**Prioritet**</span><span class="sxs-lookup"><span data-stu-id="282b1-182">**Priority**</span></span> |<span data-ttu-id="282b1-183">Reglerna kontrolleras i hello prioritetsordning.</span><span class="sxs-lookup"><span data-stu-id="282b1-183">Rules are checked in hello order of priority.</span></span> <span data-ttu-id="282b1-184">När villkoren för en regel uppfylls testas inga fler regler.</span><span class="sxs-lookup"><span data-stu-id="282b1-184">Once a rule applies, no more rules are tested for matching.</span></span> | <span data-ttu-id="282b1-185">Tal mellan 100 och 4096.</span><span class="sxs-lookup"><span data-stu-id="282b1-185">Number between 100 and 4096.</span></span> | <span data-ttu-id="282b1-186">Överväg att skapa regler som hoppar prioritet med 100 för varje regel tooleave utrymme för nya regler som du kan skapa i hello framtida.</span><span class="sxs-lookup"><span data-stu-id="282b1-186">Consider creating rules jumping priorities by 100 for each rule tooleave space for new rules you might create in hello future.</span></span> |
| <span data-ttu-id="282b1-187">**Åtkomst**</span><span class="sxs-lookup"><span data-stu-id="282b1-187">**Access**</span></span> |<span data-ttu-id="282b1-188">Typ av åtkomst tooapply om hello regeln matchar.</span><span class="sxs-lookup"><span data-stu-id="282b1-188">Type of access tooapply if hello rule matches.</span></span> | <span data-ttu-id="282b1-189">Tillåt eller neka.</span><span class="sxs-lookup"><span data-stu-id="282b1-189">Allow or deny.</span></span> | <span data-ttu-id="282b1-190">Tänk på att om en regel för Tillåt inte hittas för ett paket, släpps hello-paketet.</span><span class="sxs-lookup"><span data-stu-id="282b1-190">Keep in mind that if an allow rule is not found for a packet, hello packet is dropped.</span></span> |

<span data-ttu-id="282b1-191">Nätverkssäkerhetsgrupper innehåller två regeluppsättningar: inkommande och utgående.</span><span class="sxs-lookup"><span data-stu-id="282b1-191">NSGs contain two sets of rules: Inbound and outbound.</span></span> <span data-ttu-id="282b1-192">hello prioritet för en regel måste vara unika inom varje uppsättning.</span><span class="sxs-lookup"><span data-stu-id="282b1-192">hello priority for a rule must be unique within each set.</span></span> 

![NSG-regelbearbetning](./media/virtual-network-nsg-overview/figure3.png) 

<span data-ttu-id="282b1-194">hello föregående bild visar hur NSG-regler bearbetas.</span><span class="sxs-lookup"><span data-stu-id="282b1-194">hello previous picture shows how NSG rules are processed.</span></span>

### <a name="default-tags"></a><span data-ttu-id="282b1-195">Standardtaggar</span><span class="sxs-lookup"><span data-stu-id="282b1-195">Default Tags</span></span>
<span data-ttu-id="282b1-196">Standardtaggar är systemdefinierade identifierare tooaddress en kategori av IP-adresser.</span><span class="sxs-lookup"><span data-stu-id="282b1-196">Default tags are system-provided identifiers tooaddress a category of IP addresses.</span></span> <span data-ttu-id="282b1-197">Du kan använda standardtaggar i hello **källadress-prefix** och **måladress-prefix** egenskaper för alla regler.</span><span class="sxs-lookup"><span data-stu-id="282b1-197">You can use default tags in hello **source address prefix** and **destination address prefix** properties of any rule.</span></span> <span data-ttu-id="282b1-198">Det finns tre standardtaggar som du kan använda:</span><span class="sxs-lookup"><span data-stu-id="282b1-198">There are three default tags you can use:</span></span>

* <span data-ttu-id="282b1-199">**VirtualNetwork** (Resource Manager) (**VIRTUAL_NETWORK** för klassisk): den här taggen innehåller hello virtuella nätverkets adressutrymme (CIDR-intervallen som definieras i Azure), alla anslutna lokala adressutrymmen och anslutna Azure Vnet (lokala nätverk).</span><span class="sxs-lookup"><span data-stu-id="282b1-199">**VirtualNetwork** (Resource Manager) (**VIRTUAL_NETWORK** for classic): This tag includes hello virtual network address space (CIDR ranges defined in Azure), all connected on-premises address spaces, and connected Azure VNets (local networks).</span></span>
* <span data-ttu-id="282b1-200">**AzureLoadBalancer** (Resource Manager) (**AZURE_LOADBALANCER** för klassisk): Den här taggen anger belastningsutjämnaren för Azures infrastruktur.</span><span class="sxs-lookup"><span data-stu-id="282b1-200">**AzureLoadBalancer** (Resource Manager) (**AZURE_LOADBALANCER** for classic): This tag denotes Azure’s infrastructure load balancer.</span></span> <span data-ttu-id="282b1-201">hello taggen översätter tooan IP för Azure-datacenter där Azures-hälsoavsökning kommer.</span><span class="sxs-lookup"><span data-stu-id="282b1-201">hello tag translates tooan Azure datacenter IP where Azure’s health probes originate.</span></span>
* <span data-ttu-id="282b1-202">**Internet** (Resource Manager) (**INTERNET** för klassisk): den här taggen anger hello IP-adressutrymmet som är utanför hello virtuellt nätverk och kan nås via offentligt Internet.</span><span class="sxs-lookup"><span data-stu-id="282b1-202">**Internet** (Resource Manager) (**INTERNET** for classic): This tag denotes hello IP address space that is outside hello virtual network and reachable by public Internet.</span></span> <span data-ttu-id="282b1-203">hello området inkluderar hello [Azure-ägt offentligt IP-adressutrymme](https://www.microsoft.com/download/details.aspx?id=41653).</span><span class="sxs-lookup"><span data-stu-id="282b1-203">hello range includes hello [Azure owned public IP space](https://www.microsoft.com/download/details.aspx?id=41653).</span></span>

### <a name="default-rules"></a><span data-ttu-id="282b1-204">Standardregler</span><span class="sxs-lookup"><span data-stu-id="282b1-204">Default rules</span></span>
<span data-ttu-id="282b1-205">Alla NSG:er har en uppsättning standardregler.</span><span class="sxs-lookup"><span data-stu-id="282b1-205">All NSGs contain a set of default rules.</span></span> <span data-ttu-id="282b1-206">hello standardreglerna kan inte tas bort, men eftersom de har tilldelats lägst prioritet för hello, de kan åsidosättas med hello regler som du skapar.</span><span class="sxs-lookup"><span data-stu-id="282b1-206">hello default rules cannot be deleted, but because they are assigned hello lowest priority, they can be overridden by hello rules that you create.</span></span> 

<span data-ttu-id="282b1-207">hello standardregler Tillåt och neka trafik på följande sätt:</span><span class="sxs-lookup"><span data-stu-id="282b1-207">hello default rules allow and disallow traffic as follows:</span></span>
- <span data-ttu-id="282b1-208">**Virtuellt nätverk:** Trafik som kommer från eller som går till ett virtuellt nätverk tillåts både i inkommande och utgående riktning.</span><span class="sxs-lookup"><span data-stu-id="282b1-208">**Virtual network:** Traffic originating and ending in a virtual network is allowed both in inbound and outbound directions.</span></span>
- <span data-ttu-id="282b1-209">**Internet:** Utgående trafik tillåts, men inkommande trafik blockeras.</span><span class="sxs-lookup"><span data-stu-id="282b1-209">**Internet:** Outbound traffic is allowed, but inbound traffic is blocked.</span></span>
- <span data-ttu-id="282b1-210">**Belastningsutjämnare:** Tillåt Azure belastningen belastningsutjämnaren tooprobe hello hälsotillståndet för dina virtuella datorer och rollinstanser.</span><span class="sxs-lookup"><span data-stu-id="282b1-210">**Load balancer:** Allow Azure’s load balancer tooprobe hello health of your VMs and role instances.</span></span> <span data-ttu-id="282b1-211">Du kan åsidosätta den här regeln om du inte använder en belastningsutjämnad uppsättning.</span><span class="sxs-lookup"><span data-stu-id="282b1-211">If you are not using a load balanced set you can override this rule.</span></span>

<span data-ttu-id="282b1-212">**Inkommande standardregler**</span><span class="sxs-lookup"><span data-stu-id="282b1-212">**Inbound default rules**</span></span>

| <span data-ttu-id="282b1-213">Namn</span><span class="sxs-lookup"><span data-stu-id="282b1-213">Name</span></span> | <span data-ttu-id="282b1-214">Prioritet</span><span class="sxs-lookup"><span data-stu-id="282b1-214">Priority</span></span> | <span data-ttu-id="282b1-215">Käll-IP-adress</span><span class="sxs-lookup"><span data-stu-id="282b1-215">Source IP</span></span> | <span data-ttu-id="282b1-216">Källport</span><span class="sxs-lookup"><span data-stu-id="282b1-216">Source Port</span></span> | <span data-ttu-id="282b1-217">Mål-IP-adress</span><span class="sxs-lookup"><span data-stu-id="282b1-217">Destination IP</span></span> | <span data-ttu-id="282b1-218">Målport</span><span class="sxs-lookup"><span data-stu-id="282b1-218">Destination Port</span></span> | <span data-ttu-id="282b1-219">Protokoll</span><span class="sxs-lookup"><span data-stu-id="282b1-219">Protocol</span></span> | <span data-ttu-id="282b1-220">Access</span><span class="sxs-lookup"><span data-stu-id="282b1-220">Access</span></span> |
| --- | --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="282b1-221">AllowVNetInBound</span><span class="sxs-lookup"><span data-stu-id="282b1-221">AllowVNetInBound</span></span> |<span data-ttu-id="282b1-222">65000</span><span class="sxs-lookup"><span data-stu-id="282b1-222">65000</span></span> | <span data-ttu-id="282b1-223">VirtualNetwork</span><span class="sxs-lookup"><span data-stu-id="282b1-223">VirtualNetwork</span></span> | * | <span data-ttu-id="282b1-224">VirtualNetwork</span><span class="sxs-lookup"><span data-stu-id="282b1-224">VirtualNetwork</span></span> | * | * | <span data-ttu-id="282b1-225">Tillåt</span><span class="sxs-lookup"><span data-stu-id="282b1-225">Allow</span></span> |
| <span data-ttu-id="282b1-226">AllowAzureLoadBalancerInBound</span><span class="sxs-lookup"><span data-stu-id="282b1-226">AllowAzureLoadBalancerInBound</span></span> | <span data-ttu-id="282b1-227">65001</span><span class="sxs-lookup"><span data-stu-id="282b1-227">65001</span></span> | <span data-ttu-id="282b1-228">AzureLoadBalancer</span><span class="sxs-lookup"><span data-stu-id="282b1-228">AzureLoadBalancer</span></span> | * | * | * | * | <span data-ttu-id="282b1-229">Tillåt</span><span class="sxs-lookup"><span data-stu-id="282b1-229">Allow</span></span> |
| <span data-ttu-id="282b1-230">DenyAllInBound</span><span class="sxs-lookup"><span data-stu-id="282b1-230">DenyAllInBound</span></span> |<span data-ttu-id="282b1-231">65500</span><span class="sxs-lookup"><span data-stu-id="282b1-231">65500</span></span> | * | * | * | * | * | <span data-ttu-id="282b1-232">Neka</span><span class="sxs-lookup"><span data-stu-id="282b1-232">Deny</span></span> |

<span data-ttu-id="282b1-233">**Utgående standardregler**</span><span class="sxs-lookup"><span data-stu-id="282b1-233">**Outbound default rules**</span></span>

| <span data-ttu-id="282b1-234">Namn</span><span class="sxs-lookup"><span data-stu-id="282b1-234">Name</span></span> | <span data-ttu-id="282b1-235">Prioritet</span><span class="sxs-lookup"><span data-stu-id="282b1-235">Priority</span></span> | <span data-ttu-id="282b1-236">Käll-IP-adress</span><span class="sxs-lookup"><span data-stu-id="282b1-236">Source IP</span></span> | <span data-ttu-id="282b1-237">Källport</span><span class="sxs-lookup"><span data-stu-id="282b1-237">Source Port</span></span> | <span data-ttu-id="282b1-238">Mål-IP-adress</span><span class="sxs-lookup"><span data-stu-id="282b1-238">Destination IP</span></span> | <span data-ttu-id="282b1-239">Målport</span><span class="sxs-lookup"><span data-stu-id="282b1-239">Destination Port</span></span> | <span data-ttu-id="282b1-240">Protokoll</span><span class="sxs-lookup"><span data-stu-id="282b1-240">Protocol</span></span> | <span data-ttu-id="282b1-241">Access</span><span class="sxs-lookup"><span data-stu-id="282b1-241">Access</span></span> |
| --- | --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="282b1-242">AllowVnetOutBound</span><span class="sxs-lookup"><span data-stu-id="282b1-242">AllowVnetOutBound</span></span> | <span data-ttu-id="282b1-243">65000</span><span class="sxs-lookup"><span data-stu-id="282b1-243">65000</span></span> | <span data-ttu-id="282b1-244">VirtualNetwork</span><span class="sxs-lookup"><span data-stu-id="282b1-244">VirtualNetwork</span></span> | * | <span data-ttu-id="282b1-245">VirtualNetwork</span><span class="sxs-lookup"><span data-stu-id="282b1-245">VirtualNetwork</span></span> | * | * | <span data-ttu-id="282b1-246">Tillåt</span><span class="sxs-lookup"><span data-stu-id="282b1-246">Allow</span></span> |
| <span data-ttu-id="282b1-247">AllowInternetOutBound</span><span class="sxs-lookup"><span data-stu-id="282b1-247">AllowInternetOutBound</span></span> | <span data-ttu-id="282b1-248">65001</span><span class="sxs-lookup"><span data-stu-id="282b1-248">65001</span></span> | * | * | <span data-ttu-id="282b1-249">Internet</span><span class="sxs-lookup"><span data-stu-id="282b1-249">Internet</span></span> | * | * | <span data-ttu-id="282b1-250">Tillåt</span><span class="sxs-lookup"><span data-stu-id="282b1-250">Allow</span></span> |
| <span data-ttu-id="282b1-251">DenyAllOutBound</span><span class="sxs-lookup"><span data-stu-id="282b1-251">DenyAllOutBound</span></span> | <span data-ttu-id="282b1-252">65500</span><span class="sxs-lookup"><span data-stu-id="282b1-252">65500</span></span> | * | * | * | * | * | <span data-ttu-id="282b1-253">Neka</span><span class="sxs-lookup"><span data-stu-id="282b1-253">Deny</span></span> |

## <a name="associating-nsgs"></a><span data-ttu-id="282b1-254">Koppla NSG:er</span><span class="sxs-lookup"><span data-stu-id="282b1-254">Associating NSGs</span></span>
<span data-ttu-id="282b1-255">Du kan koppla en NSG tooVMs, nätverkskort och undernät, beroende på hello distributionsmodell du använder, enligt följande:</span><span class="sxs-lookup"><span data-stu-id="282b1-255">You can associate an NSG tooVMs, NICs, and subnets, depending on hello deployment model you are using, as follows:</span></span>

* <span data-ttu-id="282b1-256">**VM (klassisk):** säkerhetsregler används tooall trafik till/från hello VM.</span><span class="sxs-lookup"><span data-stu-id="282b1-256">**VM (classic only):** Security rules are applied tooall traffic to/from hello VM.</span></span> 
* <span data-ttu-id="282b1-257">**Nätverkskort (enbart Resource Manager):** säkerhetsregler används tooall trafik till/från hello NIC hello NSG är kopplad till.</span><span class="sxs-lookup"><span data-stu-id="282b1-257">**NIC (Resource Manager only):** Security rules are applied tooall traffic to/from hello NIC hello NSG is associated to.</span></span> <span data-ttu-id="282b1-258">På en virtuell dator i flera nätverkskort, kan du tillämpa olika (eller hello samma) NSG tooeach NIC individuellt.</span><span class="sxs-lookup"><span data-stu-id="282b1-258">In a multi-NIC VM, you can apply different (or hello same) NSG tooeach NIC individually.</span></span> 
* <span data-ttu-id="282b1-259">**Undernät (Resource Manager och klassisk):** säkerhetsregler används tooany trafik till/från alla resurser anslutna toohello VNet.</span><span class="sxs-lookup"><span data-stu-id="282b1-259">**Subnet (Resource Manager and classic):** Security rules are applied tooany traffic to/from any resources connected toohello VNet.</span></span>

<span data-ttu-id="282b1-260">Du kan koppla olika NSG: er tooa VM (eller nätverkskort, beroende på hello distributionsmodell) och hello undernät som ett nätverkskort eller virtuella datorn är ansluten till.</span><span class="sxs-lookup"><span data-stu-id="282b1-260">You can associate different NSGs tooa VM (or NIC, depending on hello deployment model) and hello subnet that a NIC or VM is connected to.</span></span> <span data-ttu-id="282b1-261">Säkerhetsregler används toohello trafiken efter prioritet i varje NSG, i hello följer ordning:</span><span class="sxs-lookup"><span data-stu-id="282b1-261">Security rules are applied toohello traffic, by priority, in each NSG, in hello following order:</span></span>

- <span data-ttu-id="282b1-262">**Inkommande trafik**</span><span class="sxs-lookup"><span data-stu-id="282b1-262">**Inbound traffic**</span></span>

  1. <span data-ttu-id="282b1-263">**NSG tillämpas toosubnet:** om ett undernät NSG har en matchande regel toodeny trafik, släpps hello-paketet.</span><span class="sxs-lookup"><span data-stu-id="282b1-263">**NSG applied toosubnet:** If a subnet NSG has a matching rule toodeny traffic, hello packet is dropped.</span></span>

  2. <span data-ttu-id="282b1-264">**NSG tillämpas tooNIC** (Resource Manager) eller VM (klassisk): om VM\NIC NSG har en matchande regel som nekar trafik, paket tappas på hello VM\NIC, även om ett undernät NSG har en matchande regel som tillåter trafik.</span><span class="sxs-lookup"><span data-stu-id="282b1-264">**NSG applied tooNIC** (Resource Manager) or VM (classic): If VM\NIC NSG has a matching rule that denies traffic, packets are dropped at hello VM\NIC, even if a subnet NSG has a matching rule that allows traffic.</span></span>

- <span data-ttu-id="282b1-265">**Utgående trafik**</span><span class="sxs-lookup"><span data-stu-id="282b1-265">**Outbound traffic**</span></span>

  1. <span data-ttu-id="282b1-266">**NSG tillämpas tooNIC** (Resource Manager) eller VM (klassisk): om en VM\NIC NSG har en matchande regel som nekar trafik, paket tappas.</span><span class="sxs-lookup"><span data-stu-id="282b1-266">**NSG applied tooNIC** (Resource Manager) or VM (classic): If a VM\NIC NSG has a matching rule that denies traffic, packets are dropped.</span></span>

  2. <span data-ttu-id="282b1-267">**NSG tillämpas toosubnet:** om ett undernät NSG har en matchande regel som nekar trafik, paket tappas, även om en VM\NIC NSG har en matchande regel som tillåter trafik.</span><span class="sxs-lookup"><span data-stu-id="282b1-267">**NSG applied toosubnet:** If a subnet NSG has a matching rule that denies traffic, packets are dropped, even if a VM\NIC NSG has a matching rule that allows traffic.</span></span>

> [!NOTE]
> <span data-ttu-id="282b1-268">Även om du kan bara koppla en enda NSG tooa undernät, VM eller NIC; Du kan associera hello samma NSG tooas många resurser som du vill.</span><span class="sxs-lookup"><span data-stu-id="282b1-268">Although you can only associate a single NSG tooa subnet, VM, or NIC; you can associate hello same NSG tooas many resources as you want.</span></span>
>

## <a name="implementation"></a><span data-ttu-id="282b1-269">Implementering</span><span class="sxs-lookup"><span data-stu-id="282b1-269">Implementation</span></span>
<span data-ttu-id="282b1-270">Du kan implementera NSG: er i hello Resource Manager och klassiska distributionsmodeller med hjälp av följande verktyg hello:</span><span class="sxs-lookup"><span data-stu-id="282b1-270">You can implement NSGs in hello Resource Manager or classic deployment models using hello following tools:</span></span>

| <span data-ttu-id="282b1-271">Distributionsverktyg</span><span class="sxs-lookup"><span data-stu-id="282b1-271">Deployment tool</span></span> | <span data-ttu-id="282b1-272">Klassisk</span><span class="sxs-lookup"><span data-stu-id="282b1-272">Classic</span></span> | <span data-ttu-id="282b1-273">Resource Manager</span><span class="sxs-lookup"><span data-stu-id="282b1-273">Resource Manager</span></span> |
| --- | --- | --- |
| <span data-ttu-id="282b1-274">Azure Portal</span><span class="sxs-lookup"><span data-stu-id="282b1-274">Azure portal</span></span>   | <span data-ttu-id="282b1-275">Ja</span><span class="sxs-lookup"><span data-stu-id="282b1-275">Yes</span></span> | [<span data-ttu-id="282b1-276">Ja</span><span class="sxs-lookup"><span data-stu-id="282b1-276">Yes</span></span>](virtual-networks-create-nsg-arm-pportal.md) |
| <span data-ttu-id="282b1-277">PowerShell</span><span class="sxs-lookup"><span data-stu-id="282b1-277">PowerShell</span></span>     | [<span data-ttu-id="282b1-278">Ja</span><span class="sxs-lookup"><span data-stu-id="282b1-278">Yes</span></span>](virtual-networks-create-nsg-classic-ps.md) | [<span data-ttu-id="282b1-279">Ja</span><span class="sxs-lookup"><span data-stu-id="282b1-279">Yes</span></span>](virtual-networks-create-nsg-arm-ps.md) |
| <span data-ttu-id="282b1-280">Azure CLI **V1**</span><span class="sxs-lookup"><span data-stu-id="282b1-280">Azure CLI **V1**</span></span>   | [<span data-ttu-id="282b1-281">Ja</span><span class="sxs-lookup"><span data-stu-id="282b1-281">Yes</span></span>](virtual-networks-create-nsg-classic-cli.md) | [<span data-ttu-id="282b1-282">Ja</span><span class="sxs-lookup"><span data-stu-id="282b1-282">Yes</span></span>](virtual-networks-create-nsg-cli-nodejs.md) |
| <span data-ttu-id="282b1-283">Azure CLI **V2**</span><span class="sxs-lookup"><span data-stu-id="282b1-283">Azure CLI **V2**</span></span>   | <span data-ttu-id="282b1-284">Nej</span><span class="sxs-lookup"><span data-stu-id="282b1-284">No</span></span> | [<span data-ttu-id="282b1-285">Ja</span><span class="sxs-lookup"><span data-stu-id="282b1-285">Yes</span></span>](virtual-networks-create-nsg-arm-cli.md) |
| <span data-ttu-id="282b1-286">Azure Resource Manager-mall</span><span class="sxs-lookup"><span data-stu-id="282b1-286">Azure Resource Manager template</span></span>   | <span data-ttu-id="282b1-287">Nej</span><span class="sxs-lookup"><span data-stu-id="282b1-287">No</span></span>  | [<span data-ttu-id="282b1-288">Ja</span><span class="sxs-lookup"><span data-stu-id="282b1-288">Yes</span></span>](virtual-networks-create-nsg-arm-template.md) |

## <a name="planning"></a><span data-ttu-id="282b1-289">Planering</span><span class="sxs-lookup"><span data-stu-id="282b1-289">Planning</span></span>
<span data-ttu-id="282b1-290">Innan du implementerar NSG: er måste tooanswer hello följande frågor:</span><span class="sxs-lookup"><span data-stu-id="282b1-290">Before implementing NSGs, you need tooanswer hello following questions:</span></span>

1. <span data-ttu-id="282b1-291">Vilka typer av resurser vill du toofilter trafik tooor från?</span><span class="sxs-lookup"><span data-stu-id="282b1-291">What types of resources do you want toofilter traffic tooor from?</span></span> <span data-ttu-id="282b1-292">Du kan ansluta resurser, t.ex nätverkskort (Resource Manager), virtuella datorer (klassisk), molntjänster, programtjänstmiljöer och skalningsuppsättningar för virtuella datorer.</span><span class="sxs-lookup"><span data-stu-id="282b1-292">You can connect resources such as NICs (Resource Manager), VMs (classic), Cloud Services, Application Service Environments, and VM Scale Sets.</span></span> 
2. <span data-ttu-id="282b1-293">Är hello-resurser som du vill toofilter trafik till och från anslutna toosubnets i befintliga Vnet?</span><span class="sxs-lookup"><span data-stu-id="282b1-293">Are hello resources you want toofilter traffic to/from connected toosubnets in existing VNets?</span></span>

<span data-ttu-id="282b1-294">Mer information om planering för nätverkssäkerhet i Azure finns hello [molntjänster och nätverkssäkerhet](../best-practices-network-security.md) artikel.</span><span class="sxs-lookup"><span data-stu-id="282b1-294">For more information on planning for network security in Azure, read hello [Cloud services and network security](../best-practices-network-security.md) article.</span></span> 

## <a name="design-considerations"></a><span data-ttu-id="282b1-295">Designöverväganden</span><span class="sxs-lookup"><span data-stu-id="282b1-295">Design considerations</span></span>
<span data-ttu-id="282b1-296">När du väl vet svaren hello toohello frågor i hello [planera](#Planning) avsnittet kan du granska följande avsnitt innan du definierar dina NSG: er hello:</span><span class="sxs-lookup"><span data-stu-id="282b1-296">Once you know hello answers toohello questions in hello [Planning](#Planning) section, review hello following sections before defining your NSGs:</span></span>

### <a name="limits"></a><span data-ttu-id="282b1-297">Begränsningar</span><span class="sxs-lookup"><span data-stu-id="282b1-297">Limits</span></span>
<span data-ttu-id="282b1-298">Det finns begränsningar toohello antalet NSG: er som du kan ha en prenumeration och antalet regler per NSG.</span><span class="sxs-lookup"><span data-stu-id="282b1-298">There are limits toohello number of NSGs you can have in a subscription and number of rules per NSG.</span></span> <span data-ttu-id="282b1-299">Mer om hello gränser, läsa hello toolearn [Azure begränsar](../azure-subscription-service-limits.md#networking-limits) artikel.</span><span class="sxs-lookup"><span data-stu-id="282b1-299">toolearn more about hello limits, read hello [Azure limits](../azure-subscription-service-limits.md#networking-limits) article.</span></span>

### <a name="vnet-and-subnet-design"></a><span data-ttu-id="282b1-300">Utformning av VNet och undernät</span><span class="sxs-lookup"><span data-stu-id="282b1-300">VNet and subnet design</span></span>
<span data-ttu-id="282b1-301">Eftersom NSG: er kan vara tillämpade toosubnets, kan du minimera hello antalet NSG: er genom att gruppera dina resurser efter undernät och tillämpa NSG: er toosubnets.</span><span class="sxs-lookup"><span data-stu-id="282b1-301">Since NSGs can be applied toosubnets, you can minimize hello number of NSGs by grouping your resources by subnet, and applying NSGs toosubnets.</span></span>  <span data-ttu-id="282b1-302">Om du tooapply NSG: er toosubnets kan det hända att befintliga Vnet och undernät som du har inte har definierats med NSG: er i åtanke.</span><span class="sxs-lookup"><span data-stu-id="282b1-302">If you decide tooapply NSGs toosubnets, you may find that existing VNets and subnets you have were not defined with NSGs in mind.</span></span> <span data-ttu-id="282b1-303">Du kanske behöver toodefine nya Vnet och undernät toosupport din NSG-utformning och distribuera dina nya resurser tooyour nya undernät.</span><span class="sxs-lookup"><span data-stu-id="282b1-303">You may need toodefine new VNets and subnets toosupport your NSG design and deploy your new resources tooyour new subnets.</span></span> <span data-ttu-id="282b1-304">Sedan kan du definiera en migrering strategi toomove befintliga resurser toohello nya undernät.</span><span class="sxs-lookup"><span data-stu-id="282b1-304">You could then define a migration strategy toomove existing resources toohello new subnets.</span></span> 

### <a name="special-rules"></a><span data-ttu-id="282b1-305">Särskilda regler</span><span class="sxs-lookup"><span data-stu-id="282b1-305">Special rules</span></span>
<span data-ttu-id="282b1-306">Om du blockerar trafik som tillåts av hello enligt reglerna för inte kan din infrastruktur kommunicera med grundläggande Azure-tjänster:</span><span class="sxs-lookup"><span data-stu-id="282b1-306">If you block traffic allowed by hello following rules, your infrastructure can't communicate with essential Azure services:</span></span>

* <span data-ttu-id="282b1-307">**Virtuella IP-Adressen för hello värdnoden:** grundläggande infrastrukturtjänster som DHCP, DNS och hälsoövervakning sker via hello virtualiserade värd IP-adressen 168.63.129.16.</span><span class="sxs-lookup"><span data-stu-id="282b1-307">**Virtual IP of hello host node:** Basic infrastructure services such as DHCP, DNS, and health monitoring are provided through hello virtualized host IP address 168.63.129.16.</span></span> <span data-ttu-id="282b1-308">Den här offentliga IP-adressen hör tooMicrosoft och hello endast virtualiserade IP-adress som används i alla regioner för det här ändamålet.</span><span class="sxs-lookup"><span data-stu-id="282b1-308">This public IP address belongs tooMicrosoft and is hello only virtualized IP address used in all regions for this purpose.</span></span> <span data-ttu-id="282b1-309">Den här IP-adressen mappar toohello fysiska IP-adressen för serverdatorn (värdnoden) för hello värd hello VM.</span><span class="sxs-lookup"><span data-stu-id="282b1-309">This IP address maps toohello physical IP address of hello server machine (host node) hosting hello VM.</span></span> <span data-ttu-id="282b1-310">Hej värdnoden agerar som hello DHCP-relä, rekursiv hello DNS-matchare och hello avsökningskälla för hello ladda belastningsutjämnaren, hälsoavsökningen och datorhälsoavsökningen hello.</span><span class="sxs-lookup"><span data-stu-id="282b1-310">hello host node acts as hello DHCP relay, hello DNS recursive resolver, and hello probe source for hello load balancer health probe and hello machine health probe.</span></span> <span data-ttu-id="282b1-311">Kommunikation toothis IP-adress är inte en attack.</span><span class="sxs-lookup"><span data-stu-id="282b1-311">Communication toothis IP address is not an attack.</span></span>
* <span data-ttu-id="282b1-312">**Licensiering (nyckelhanteringstjänst):** Windows-avbildningar som körs på virtuella datorer måste vara licensierade.</span><span class="sxs-lookup"><span data-stu-id="282b1-312">**Licensing (Key Management Service):** Windows images running in VMs must be licensed.</span></span> <span data-ttu-id="282b1-313">tooensure licensiering, en begäran skickas toohello nyckelhanteringstjänst värdservrar för fjärrskrivbordssessioner som hanterar sådana frågor.</span><span class="sxs-lookup"><span data-stu-id="282b1-313">tooensure licensing, a request is sent toohello Key Management Service host servers that handle such queries.</span></span> <span data-ttu-id="282b1-314">hello-begäran har gjorts utgående via port 1688.</span><span class="sxs-lookup"><span data-stu-id="282b1-314">hello request is made outbound through port 1688.</span></span>

### <a name="icmp-traffic"></a><span data-ttu-id="282b1-315">ICMP-trafik</span><span class="sxs-lookup"><span data-stu-id="282b1-315">ICMP traffic</span></span>
<span data-ttu-id="282b1-316">hello nuvarande NSG-reglerna tillåter bara protokollen *TCP* eller *UDP*.</span><span class="sxs-lookup"><span data-stu-id="282b1-316">hello current NSG rules only allow for protocols *TCP* or *UDP*.</span></span> <span data-ttu-id="282b1-317">Det finns ingen specifik tagg för *ICMP*.</span><span class="sxs-lookup"><span data-stu-id="282b1-317">There is not a specific tag for *ICMP*.</span></span> <span data-ttu-id="282b1-318">ICMP-trafik tillåts dock inom ett VNet av hello AllowVNetInBound standardregel som tillåter trafik tooand från alla portar och protokoll inom hello virtuella nätverk.</span><span class="sxs-lookup"><span data-stu-id="282b1-318">However, ICMP traffic is allowed within a VNet by hello AllowVNetInBound default rule, that allows traffic tooand from any port and protocol within hello VNet.</span></span>

### <a name="subnets"></a><span data-ttu-id="282b1-319">Undernät</span><span class="sxs-lookup"><span data-stu-id="282b1-319">Subnets</span></span>
* <span data-ttu-id="282b1-320">Fundera över hello många nivåer din arbetsbelastning behöver.</span><span class="sxs-lookup"><span data-stu-id="282b1-320">Consider hello number of tiers your workload requires.</span></span> <span data-ttu-id="282b1-321">Varje nivå kan isoleras med ett undernät med en NSG tillämpas toohello undernät.</span><span class="sxs-lookup"><span data-stu-id="282b1-321">Each tier can be isolated by using a subnet, with an NSG applied toohello subnet.</span></span> 
* <span data-ttu-id="282b1-322">Om du måste tooimplement ett undernät för en VPN-gateway eller ExpressRoute-krets **inte** tillämpa ett NSG toothat undernät.</span><span class="sxs-lookup"><span data-stu-id="282b1-322">If you need tooimplement a subnet for a VPN gateway, or ExpressRoute circuit, do **not** apply an NSG toothat subnet.</span></span> <span data-ttu-id="282b1-323">Om du gör det kan anslutningar mellan virtuella nätverk eller i det lokala systemet misslyckas.</span><span class="sxs-lookup"><span data-stu-id="282b1-323">If you do so, cross-VNet or cross-premises connectivity may fail.</span></span> 
* <span data-ttu-id="282b1-324">Om du behöver tooimplement en virtuell nätverksenhet (NVA) kan ansluta hello NVA tooits egna undernät och skapa användardefinierade vägar (UDR) tooand från hello NVA.</span><span class="sxs-lookup"><span data-stu-id="282b1-324">If you need tooimplement a network virtual appliance (NVA), connect hello NVA tooits own subnet and create user-defined routes (UDR) tooand from hello NVA.</span></span> <span data-ttu-id="282b1-325">Du kan implementera ett undernätverksnivå NSG toofilter trafik till och från det här undernätet.</span><span class="sxs-lookup"><span data-stu-id="282b1-325">You can implement a subnet level NSG toofilter traffic in and out of this subnet.</span></span> <span data-ttu-id="282b1-326">Mer om udr: er, läsa hello toolearn [användardefinierade vägar](virtual-networks-udr-overview.md) artikel.</span><span class="sxs-lookup"><span data-stu-id="282b1-326">toolearn more about UDRs, read hello [User-defined routes](virtual-networks-udr-overview.md) article.</span></span>

### <a name="load-balancers"></a><span data-ttu-id="282b1-327">Belastningsutjämnare</span><span class="sxs-lookup"><span data-stu-id="282b1-327">Load balancers</span></span>
* <span data-ttu-id="282b1-328">Överväg att hello belastningsutjämning och network adress translation (NAT) regler för varje belastningsutjämnare som används av varje arbetsbelastning.</span><span class="sxs-lookup"><span data-stu-id="282b1-328">Consider hello load balancing and network address translation (NAT) rules for each load balancer used by each of your workloads.</span></span> <span data-ttu-id="282b1-329">NAT-regler är bundna tooa backend-pool som innehåller nätverkskort (Resource Manager) eller virtuella datorer/molntjänster rollinstanser (klassiska).</span><span class="sxs-lookup"><span data-stu-id="282b1-329">NAT rules are bound tooa back-end pool that contains NICs (Resource Manager) or VMs/Cloud Services role instances (classic).</span></span> <span data-ttu-id="282b1-330">Överväg att skapa en NSG för varje backend-poolen, så att endast trafik som mappats genom hello regeln implementeras i hello belastningsutjämnare.</span><span class="sxs-lookup"><span data-stu-id="282b1-330">Consider creating an NSG for each back-end pool, allowing only traffic mapped through hello rules implemented in hello load balancers.</span></span> <span data-ttu-id="282b1-331">Skapa en NSG för varje backend-pool garanterar filtreras även trafik som kommer toohello backend-adresspool direkt (i stället via hello belastningsutjämnare).</span><span class="sxs-lookup"><span data-stu-id="282b1-331">Creating an NSG for each back-end pool guarantees that traffic coming toohello back-end pool directly (rather than through hello load balancer), is also filtered.</span></span>
* <span data-ttu-id="282b1-332">I klassiska distributioner skapar du slutpunkter som mappar portar på en belastningen belastningsutjämnaren tooports på VM: ar eller rollinstanser.</span><span class="sxs-lookup"><span data-stu-id="282b1-332">In classic deployments, you create endpoints that map ports on a load balancer tooports on your VMs or role instances.</span></span> <span data-ttu-id="282b1-333">Du kan också skapa din egen separata offentliga belastningsutjämnare via Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="282b1-333">You can also create your own individual public-facing load balancer through Resource Manager.</span></span> <span data-ttu-id="282b1-334">hälsning målporten för inkommande trafik är hello faktiska porten i hello VM eller rollinstans inte hello port som exponeras av belastningsutjämning.</span><span class="sxs-lookup"><span data-stu-id="282b1-334">hello destination port for incoming traffic is hello actual port in hello VM or role instance, not hello port exposed by a load balancer.</span></span> <span data-ttu-id="282b1-335">hello källport och adress för hello anslutning toohello VM är en port och adress på hello fjärrdator i hello Internet, inte hello porten och adressen som exponeras av belastningsutjämnaren hello.</span><span class="sxs-lookup"><span data-stu-id="282b1-335">hello source port and address for hello connection toohello VM is a port and address on hello remote computer in hello Internet, not hello port and address exposed by hello load balancer.</span></span>
* <span data-ttu-id="282b1-336">När du skapar NSG: er toofilter trafik via en intern belastningsutjämnare (ILB), är hello källa port och adressintervallet som appliceras från hello kommer datorn, inte hello belastningsutjämnaren.</span><span class="sxs-lookup"><span data-stu-id="282b1-336">When you create NSGs toofilter traffic coming through an internal load balancer (ILB), hello source port and address range applied are  from hello originating computer, not hello load balancer.</span></span> <span data-ttu-id="282b1-337">hello mål och adressintervallet är de hello-måldatorn inte hello belastningsutjämnaren.</span><span class="sxs-lookup"><span data-stu-id="282b1-337">hello destination port and address range are those of hello destination computer, not hello load balancer.</span></span>

### <a name="other"></a><span data-ttu-id="282b1-338">Annat</span><span class="sxs-lookup"><span data-stu-id="282b1-338">Other</span></span>
* <span data-ttu-id="282b1-339">Slutpunktsbaserade åtkomstkontrollistor (ACL) och NSG: er stöds inte på hello samma VM-instans.</span><span class="sxs-lookup"><span data-stu-id="282b1-339">Endpoint-based access control lists (ACL) and NSGs are not supported on hello same VM instance.</span></span> <span data-ttu-id="282b1-340">Om du vill toouse en NSG och redan har en slutpunkts-ACL på plats måste du först ta bort hello slutpunkts-ACL.</span><span class="sxs-lookup"><span data-stu-id="282b1-340">If you want toouse an NSG and have an endpoint ACL already in place, first remove hello endpoint ACL.</span></span> <span data-ttu-id="282b1-341">Information om hur tooremove en slutpunkts-ACL, se hello [hantera slutpunkts-ACL:](virtual-networks-acl-powershell.md) artikel.</span><span class="sxs-lookup"><span data-stu-id="282b1-341">For information about how tooremove an endpoint ACL, see hello [Manage endpoint ACLs](virtual-networks-acl-powershell.md) article.</span></span>
* <span data-ttu-id="282b1-342">I hanteraren för filserverresurser, du kan använda en NSG som kopplats tooa nätverkskort för virtuella datorer med flera nätverkskort tooenable hantering (fjärråtkomst) på grundval av per nätverkskort.</span><span class="sxs-lookup"><span data-stu-id="282b1-342">In Resource Manager, you can use an NSG associated tooa NIC for VMs with multiple NICs tooenable management (remote access) on a per NIC basis.</span></span> <span data-ttu-id="282b1-343">Associera unika NSG: er tooeach NIC kan uppdelning av trafiktyper på nätverkskort.</span><span class="sxs-lookup"><span data-stu-id="282b1-343">Associating unique NSGs tooeach NIC enables separation of traffic types across NICs.</span></span>
* <span data-ttu-id="282b1-344">Liknande toohello användning av belastningsutjämnare, när du filtrerar trafik från andra Vnet, måste du använda hello källadressintervallet från hello fjärrdatorn inte hello gateway ansluter hello Vnet.</span><span class="sxs-lookup"><span data-stu-id="282b1-344">Similar toohello use of load balancers, when filtering traffic from other VNets, you must use hello source address range of hello remote computer, not hello gateway connecting hello VNets.</span></span>
* <span data-ttu-id="282b1-345">Många Azure-tjänster kan inte vara anslutna tooVNets.</span><span class="sxs-lookup"><span data-stu-id="282b1-345">Many Azure services cannot be connected tooVNets.</span></span> <span data-ttu-id="282b1-346">Om en Azure-resurs inte är anslutna tooa VNet, kan du inte använda en NSG toofilter trafik toohello resurs.</span><span class="sxs-lookup"><span data-stu-id="282b1-346">If an Azure resource is not connected tooa VNet, you cannot use an NSG toofilter traffic toohello resource.</span></span>  <span data-ttu-id="282b1-347">Dokumentationen hello hello tjänster använder du toodetermine om hello-tjänsten kan vara anslutna tooa VNet.</span><span class="sxs-lookup"><span data-stu-id="282b1-347">Read hello documentation for hello services you use toodetermine whether hello service can be connected tooa VNet.</span></span>

## <a name="sample-deployment"></a><span data-ttu-id="282b1-348">Exempeldistribution</span><span class="sxs-lookup"><span data-stu-id="282b1-348">Sample deployment</span></span>
<span data-ttu-id="282b1-349">tooillustrate hello programmet hello information i den här artikeln, Överväg ett vanligt scenario i ett program för två nivåer som visas i följande bild hello:</span><span class="sxs-lookup"><span data-stu-id="282b1-349">tooillustrate hello application of hello information in this article, consider a common scenario of a two tier application shown in hello following picture:</span></span>

![NSG:er](./media/virtual-network-nsg-overview/figure1.png)

<span data-ttu-id="282b1-351">I hello diagram visas hello *Web1* och *Web2* virtuella datorer som är anslutna toohello *klientdel* undernät och hello *DB1* och *DB2* virtuella datorer som är anslutna toohello *BackEnd* undernät.</span><span class="sxs-lookup"><span data-stu-id="282b1-351">As shown in hello diagram, hello *Web1* and *Web2* VMs are connected toohello *FrontEnd* subnet, and hello *DB1* and *DB2* VMs are connected toohello *BackEnd* subnet.</span></span>  <span data-ttu-id="282b1-352">Båda undernäten är en del av hello *TestVNet* VNet.</span><span class="sxs-lookup"><span data-stu-id="282b1-352">Both subnets are part of hello *TestVNet* VNet.</span></span> <span data-ttu-id="282b1-353">hello programkomponenter varje körs i en virtuell Azure-dator ansluten tooa VNet.</span><span class="sxs-lookup"><span data-stu-id="282b1-353">hello application components each run within an Azure VM connected tooa VNet.</span></span> <span data-ttu-id="282b1-354">hello scenariot har hello följande krav:</span><span class="sxs-lookup"><span data-stu-id="282b1-354">hello scenario has hello following requirements:</span></span>

1. <span data-ttu-id="282b1-355">Avgränsning av trafiken mellan hello WEB och DB-servrar.</span><span class="sxs-lookup"><span data-stu-id="282b1-355">Separation of traffic between hello WEB and DB servers.</span></span>
2. <span data-ttu-id="282b1-356">Belastningsutjämning regler vidarebefordra trafik från webbservrar för hello load balancer tooall på port 80.</span><span class="sxs-lookup"><span data-stu-id="282b1-356">Load balancing rules forward traffic from hello load balancer tooall web servers on port 80.</span></span>
3. <span data-ttu-id="282b1-357">Läsa in belastningsutjämning NAT-regler vidarebefordra trafik kommer i hello belastningsutjämnare på port 50001 tooport 3389 på hello WEB1 VM.</span><span class="sxs-lookup"><span data-stu-id="282b1-357">Load balancer NAT rules forward traffic coming into hello load balancer on port 50001 tooport 3389 on hello WEB1 VM.</span></span>
4. <span data-ttu-id="282b1-358">Ingen åtkomst toohello frontend- eller virtuella datorer från hello Internet, utom krav 2 och 3.</span><span class="sxs-lookup"><span data-stu-id="282b1-358">No access toohello front-end or back-end VMs from hello Internet, except requirements 2 and 3.</span></span>
5. <span data-ttu-id="282b1-359">Inga utgående Internetåtkomst från hello webb- eller DB-servrar.</span><span class="sxs-lookup"><span data-stu-id="282b1-359">No outbound Internet access from hello WEB or DB servers.</span></span>
6. <span data-ttu-id="282b1-360">Åtkomst från hello klientdel undernät tillåts tooport 3389 för alla webbservrar.</span><span class="sxs-lookup"><span data-stu-id="282b1-360">Access from hello FrontEnd subnet is allowed tooport 3389 of any web server.</span></span>
7. <span data-ttu-id="282b1-361">Åtkomst från hello klientdel undernät tillåts tooport 3389 på DB-servern.</span><span class="sxs-lookup"><span data-stu-id="282b1-361">Access from hello FrontEnd subnet is allowed tooport 3389 of any DB server.</span></span>
8. <span data-ttu-id="282b1-362">Tooport 1433 för alla servrar som DB tillåts åtkomst från hello Klientdelens undernät.</span><span class="sxs-lookup"><span data-stu-id="282b1-362">Access from hello FrontEnd subnet is allowed tooport 1433 of all DB servers.</span></span>
9. <span data-ttu-id="282b1-363">Avgränsning av hanteringstrafik (port 3389) och databastrafik (1433) på olika nätverkskort på DB-servrar.</span><span class="sxs-lookup"><span data-stu-id="282b1-363">Separation of management traffic (port 3389) and database traffic (1433) on different NICs in DB servers.</span></span>

<span data-ttu-id="282b1-364">Krav 1 – 6 (utom krav 3 och 4) är alla slutna toosubnet blanksteg.</span><span class="sxs-lookup"><span data-stu-id="282b1-364">Requirements 1-6 (except requirements 3 and 4) are all confined toosubnet spaces.</span></span> <span data-ttu-id="282b1-365">hello uppfylla följande NSG: er hello tidigare krav, och minimerar hello antalet NSG: er som krävs:</span><span class="sxs-lookup"><span data-stu-id="282b1-365">hello following NSGs meet hello previous requirements, while minimizing hello number of NSGs required:</span></span>

### <a name="frontend"></a><span data-ttu-id="282b1-366">FrontEnd</span><span class="sxs-lookup"><span data-stu-id="282b1-366">FrontEnd</span></span>
<span data-ttu-id="282b1-367">**Regler för inkommande trafik**</span><span class="sxs-lookup"><span data-stu-id="282b1-367">**Inbound rules**</span></span>

| <span data-ttu-id="282b1-368">Regel</span><span class="sxs-lookup"><span data-stu-id="282b1-368">Rule</span></span> | <span data-ttu-id="282b1-369">Åtkomst</span><span class="sxs-lookup"><span data-stu-id="282b1-369">Access</span></span> | <span data-ttu-id="282b1-370">Prioritet</span><span class="sxs-lookup"><span data-stu-id="282b1-370">Priority</span></span> | <span data-ttu-id="282b1-371">Källadress-intervall</span><span class="sxs-lookup"><span data-stu-id="282b1-371">Source address range</span></span> | <span data-ttu-id="282b1-372">Källport</span><span class="sxs-lookup"><span data-stu-id="282b1-372">Source port</span></span> | <span data-ttu-id="282b1-373">Måladress-intervall</span><span class="sxs-lookup"><span data-stu-id="282b1-373">Destination address range</span></span> | <span data-ttu-id="282b1-374">Målport</span><span class="sxs-lookup"><span data-stu-id="282b1-374">Destination port</span></span> | <span data-ttu-id="282b1-375">Protokoll</span><span class="sxs-lookup"><span data-stu-id="282b1-375">Protocol</span></span> |
| --- | --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="282b1-376">Allow-Inbound-HTTP-Internet</span><span class="sxs-lookup"><span data-stu-id="282b1-376">Allow-Inbound-HTTP-Internet</span></span> | <span data-ttu-id="282b1-377">Tillåt</span><span class="sxs-lookup"><span data-stu-id="282b1-377">Allow</span></span> | <span data-ttu-id="282b1-378">100</span><span class="sxs-lookup"><span data-stu-id="282b1-378">100</span></span> | <span data-ttu-id="282b1-379">Internet</span><span class="sxs-lookup"><span data-stu-id="282b1-379">Internet</span></span> | * | * | <span data-ttu-id="282b1-380">80</span><span class="sxs-lookup"><span data-stu-id="282b1-380">80</span></span> | <span data-ttu-id="282b1-381">TCP</span><span class="sxs-lookup"><span data-stu-id="282b1-381">TCP</span></span> |
| <span data-ttu-id="282b1-382">Allow-Inbound-RDP-Internet</span><span class="sxs-lookup"><span data-stu-id="282b1-382">Allow-Inbound-RDP-Internet</span></span> | <span data-ttu-id="282b1-383">Tillåt</span><span class="sxs-lookup"><span data-stu-id="282b1-383">Allow</span></span> | <span data-ttu-id="282b1-384">200</span><span class="sxs-lookup"><span data-stu-id="282b1-384">200</span></span> | <span data-ttu-id="282b1-385">Internet</span><span class="sxs-lookup"><span data-stu-id="282b1-385">Internet</span></span> | * | * | <span data-ttu-id="282b1-386">3389</span><span class="sxs-lookup"><span data-stu-id="282b1-386">3389</span></span> | <span data-ttu-id="282b1-387">TCP</span><span class="sxs-lookup"><span data-stu-id="282b1-387">TCP</span></span> |
| <span data-ttu-id="282b1-388">Deny-Inbound-All</span><span class="sxs-lookup"><span data-stu-id="282b1-388">Deny-Inbound-All</span></span> | <span data-ttu-id="282b1-389">Neka</span><span class="sxs-lookup"><span data-stu-id="282b1-389">Deny</span></span> | <span data-ttu-id="282b1-390">300</span><span class="sxs-lookup"><span data-stu-id="282b1-390">300</span></span> | <span data-ttu-id="282b1-391">Internet</span><span class="sxs-lookup"><span data-stu-id="282b1-391">Internet</span></span> | * | * | * | <span data-ttu-id="282b1-392">TCP</span><span class="sxs-lookup"><span data-stu-id="282b1-392">TCP</span></span> |

<span data-ttu-id="282b1-393">**Regler för utgående trafik**</span><span class="sxs-lookup"><span data-stu-id="282b1-393">**Outbound rules**</span></span>

| <span data-ttu-id="282b1-394">Regel</span><span class="sxs-lookup"><span data-stu-id="282b1-394">Rule</span></span> | <span data-ttu-id="282b1-395">Åtkomst</span><span class="sxs-lookup"><span data-stu-id="282b1-395">Access</span></span> | <span data-ttu-id="282b1-396">Prioritet</span><span class="sxs-lookup"><span data-stu-id="282b1-396">Priority</span></span> | <span data-ttu-id="282b1-397">Källadress-intervall</span><span class="sxs-lookup"><span data-stu-id="282b1-397">Source address range</span></span> | <span data-ttu-id="282b1-398">Källport</span><span class="sxs-lookup"><span data-stu-id="282b1-398">Source port</span></span> | <span data-ttu-id="282b1-399">Måladress-intervall</span><span class="sxs-lookup"><span data-stu-id="282b1-399">Destination address range</span></span> | <span data-ttu-id="282b1-400">Målport</span><span class="sxs-lookup"><span data-stu-id="282b1-400">Destination port</span></span> | <span data-ttu-id="282b1-401">Protokoll</span><span class="sxs-lookup"><span data-stu-id="282b1-401">Protocol</span></span> |
| --- | --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="282b1-402">Deny-Internet-All</span><span class="sxs-lookup"><span data-stu-id="282b1-402">Deny-Internet-All</span></span> |<span data-ttu-id="282b1-403">Neka</span><span class="sxs-lookup"><span data-stu-id="282b1-403">Deny</span></span> |<span data-ttu-id="282b1-404">100</span><span class="sxs-lookup"><span data-stu-id="282b1-404">100</span></span> | * | * | <span data-ttu-id="282b1-405">Internet</span><span class="sxs-lookup"><span data-stu-id="282b1-405">Internet</span></span> | * | * |

### <a name="backend"></a><span data-ttu-id="282b1-406">BackEnd</span><span class="sxs-lookup"><span data-stu-id="282b1-406">BackEnd</span></span>
<span data-ttu-id="282b1-407">**Regler för inkommande trafik**</span><span class="sxs-lookup"><span data-stu-id="282b1-407">**Inbound rules**</span></span>

| <span data-ttu-id="282b1-408">Regel</span><span class="sxs-lookup"><span data-stu-id="282b1-408">Rule</span></span> | <span data-ttu-id="282b1-409">Åtkomst</span><span class="sxs-lookup"><span data-stu-id="282b1-409">Access</span></span> | <span data-ttu-id="282b1-410">Prioritet</span><span class="sxs-lookup"><span data-stu-id="282b1-410">Priority</span></span> | <span data-ttu-id="282b1-411">Källadress-intervall</span><span class="sxs-lookup"><span data-stu-id="282b1-411">Source address range</span></span> | <span data-ttu-id="282b1-412">Källport</span><span class="sxs-lookup"><span data-stu-id="282b1-412">Source port</span></span> | <span data-ttu-id="282b1-413">Måladress-intervall</span><span class="sxs-lookup"><span data-stu-id="282b1-413">Destination address range</span></span> | <span data-ttu-id="282b1-414">Målport</span><span class="sxs-lookup"><span data-stu-id="282b1-414">Destination port</span></span> | <span data-ttu-id="282b1-415">Protokoll</span><span class="sxs-lookup"><span data-stu-id="282b1-415">Protocol</span></span> |
| --- | --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="282b1-416">Deny-Internet-All</span><span class="sxs-lookup"><span data-stu-id="282b1-416">Deny-Internet-All</span></span> | <span data-ttu-id="282b1-417">Neka</span><span class="sxs-lookup"><span data-stu-id="282b1-417">Deny</span></span> | <span data-ttu-id="282b1-418">100</span><span class="sxs-lookup"><span data-stu-id="282b1-418">100</span></span> | <span data-ttu-id="282b1-419">Internet</span><span class="sxs-lookup"><span data-stu-id="282b1-419">Internet</span></span> | * | * | * | * |

<span data-ttu-id="282b1-420">**Regler för utgående trafik**</span><span class="sxs-lookup"><span data-stu-id="282b1-420">**Outbound rules**</span></span>

| <span data-ttu-id="282b1-421">Regel</span><span class="sxs-lookup"><span data-stu-id="282b1-421">Rule</span></span> | <span data-ttu-id="282b1-422">Åtkomst</span><span class="sxs-lookup"><span data-stu-id="282b1-422">Access</span></span> | <span data-ttu-id="282b1-423">Prioritet</span><span class="sxs-lookup"><span data-stu-id="282b1-423">Priority</span></span> | <span data-ttu-id="282b1-424">Källadress-intervall</span><span class="sxs-lookup"><span data-stu-id="282b1-424">Source address range</span></span> | <span data-ttu-id="282b1-425">Källport</span><span class="sxs-lookup"><span data-stu-id="282b1-425">Source port</span></span> | <span data-ttu-id="282b1-426">Måladress-intervall</span><span class="sxs-lookup"><span data-stu-id="282b1-426">Destination address range</span></span> | <span data-ttu-id="282b1-427">Målport</span><span class="sxs-lookup"><span data-stu-id="282b1-427">Destination port</span></span> | <span data-ttu-id="282b1-428">Protokoll</span><span class="sxs-lookup"><span data-stu-id="282b1-428">Protocol</span></span> |
| --- | --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="282b1-429">Deny-Internet-All</span><span class="sxs-lookup"><span data-stu-id="282b1-429">Deny-Internet-All</span></span> | <span data-ttu-id="282b1-430">Neka</span><span class="sxs-lookup"><span data-stu-id="282b1-430">Deny</span></span> | <span data-ttu-id="282b1-431">100</span><span class="sxs-lookup"><span data-stu-id="282b1-431">100</span></span> | * | * | <span data-ttu-id="282b1-432">Internet</span><span class="sxs-lookup"><span data-stu-id="282b1-432">Internet</span></span> | * | * |

<span data-ttu-id="282b1-433">hello följande NSG: er skapas och tillhörande tooNICs i hello följande virtuella datorer:</span><span class="sxs-lookup"><span data-stu-id="282b1-433">hello following NSGs are created and associated tooNICs in hello following VMs:</span></span>

### <a name="web1"></a><span data-ttu-id="282b1-434">WEB1</span><span class="sxs-lookup"><span data-stu-id="282b1-434">WEB1</span></span>
<span data-ttu-id="282b1-435">**Regler för inkommande trafik**</span><span class="sxs-lookup"><span data-stu-id="282b1-435">**Inbound rules**</span></span>

| <span data-ttu-id="282b1-436">Regel</span><span class="sxs-lookup"><span data-stu-id="282b1-436">Rule</span></span> | <span data-ttu-id="282b1-437">Åtkomst</span><span class="sxs-lookup"><span data-stu-id="282b1-437">Access</span></span> | <span data-ttu-id="282b1-438">Prioritet</span><span class="sxs-lookup"><span data-stu-id="282b1-438">Priority</span></span> | <span data-ttu-id="282b1-439">Källadress-intervall</span><span class="sxs-lookup"><span data-stu-id="282b1-439">Source address range</span></span> | <span data-ttu-id="282b1-440">Källport</span><span class="sxs-lookup"><span data-stu-id="282b1-440">Source port</span></span> | <span data-ttu-id="282b1-441">Måladress-intervall</span><span class="sxs-lookup"><span data-stu-id="282b1-441">Destination address range</span></span> | <span data-ttu-id="282b1-442">Målport</span><span class="sxs-lookup"><span data-stu-id="282b1-442">Destination port</span></span> | <span data-ttu-id="282b1-443">Protokoll</span><span class="sxs-lookup"><span data-stu-id="282b1-443">Protocol</span></span> |
| --- | --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="282b1-444">Allow-Inbound-RDP-Internet</span><span class="sxs-lookup"><span data-stu-id="282b1-444">Allow-Inbound-RDP-Internet</span></span> | <span data-ttu-id="282b1-445">Tillåt</span><span class="sxs-lookup"><span data-stu-id="282b1-445">Allow</span></span> | <span data-ttu-id="282b1-446">100</span><span class="sxs-lookup"><span data-stu-id="282b1-446">100</span></span> | <span data-ttu-id="282b1-447">Internet</span><span class="sxs-lookup"><span data-stu-id="282b1-447">Internet</span></span> | * | * | <span data-ttu-id="282b1-448">3389</span><span class="sxs-lookup"><span data-stu-id="282b1-448">3389</span></span> | <span data-ttu-id="282b1-449">TCP</span><span class="sxs-lookup"><span data-stu-id="282b1-449">TCP</span></span> |
| <span data-ttu-id="282b1-450">Allow-Inbound-HTTP-Internet</span><span class="sxs-lookup"><span data-stu-id="282b1-450">Allow-Inbound-HTTP-Internet</span></span> | <span data-ttu-id="282b1-451">Tillåt</span><span class="sxs-lookup"><span data-stu-id="282b1-451">Allow</span></span> | <span data-ttu-id="282b1-452">200</span><span class="sxs-lookup"><span data-stu-id="282b1-452">200</span></span> | <span data-ttu-id="282b1-453">Internet</span><span class="sxs-lookup"><span data-stu-id="282b1-453">Internet</span></span> | * | * | <span data-ttu-id="282b1-454">80</span><span class="sxs-lookup"><span data-stu-id="282b1-454">80</span></span> | <span data-ttu-id="282b1-455">TCP</span><span class="sxs-lookup"><span data-stu-id="282b1-455">TCP</span></span> |

> [!NOTE]
> <span data-ttu-id="282b1-456">hello källadress-intervallet för hello tidigare regler är **Internet**, inte hello virtuella IP-adresser för hello belastningsutjämnaren.</span><span class="sxs-lookup"><span data-stu-id="282b1-456">hello source address range for hello previous rules is **Internet**, not hello virtual IP address of for hello load balancer.</span></span> <span data-ttu-id="282b1-457">hello källporten är *, inte 500001.</span><span class="sxs-lookup"><span data-stu-id="282b1-457">hello source port is *, not 500001.</span></span> <span data-ttu-id="282b1-458">NAT-regler för belastningsutjämning är inte hello samma som NSG säkerhetsregler.</span><span class="sxs-lookup"><span data-stu-id="282b1-458">NAT rules for load balancers are not hello same as NSG security rules.</span></span> <span data-ttu-id="282b1-459">NSG säkerhetsregler är alltid relaterade toohello ursprungliga källan och slutdestinationen för trafiken, **inte** hello belastningsutjämnaren mellan hello två.</span><span class="sxs-lookup"><span data-stu-id="282b1-459">NSG security rules are always related toohello original source and final destination of traffic, **not** hello load balancer between hello two.</span></span> 
> 
> 

### <a name="web2"></a><span data-ttu-id="282b1-460">WEB2</span><span class="sxs-lookup"><span data-stu-id="282b1-460">WEB2</span></span>
<span data-ttu-id="282b1-461">**Regler för inkommande trafik**</span><span class="sxs-lookup"><span data-stu-id="282b1-461">**Inbound rules**</span></span>

| <span data-ttu-id="282b1-462">Regel</span><span class="sxs-lookup"><span data-stu-id="282b1-462">Rule</span></span> | <span data-ttu-id="282b1-463">Åtkomst</span><span class="sxs-lookup"><span data-stu-id="282b1-463">Access</span></span> | <span data-ttu-id="282b1-464">Prioritet</span><span class="sxs-lookup"><span data-stu-id="282b1-464">Priority</span></span> | <span data-ttu-id="282b1-465">Källadress-intervall</span><span class="sxs-lookup"><span data-stu-id="282b1-465">Source address range</span></span> | <span data-ttu-id="282b1-466">Källport</span><span class="sxs-lookup"><span data-stu-id="282b1-466">Source port</span></span> | <span data-ttu-id="282b1-467">Måladress-intervall</span><span class="sxs-lookup"><span data-stu-id="282b1-467">Destination address range</span></span> | <span data-ttu-id="282b1-468">Målport</span><span class="sxs-lookup"><span data-stu-id="282b1-468">Destination port</span></span> | <span data-ttu-id="282b1-469">Protokoll</span><span class="sxs-lookup"><span data-stu-id="282b1-469">Protocol</span></span> |
| --- | --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="282b1-470">Deny-Inbound-RDP-Internet</span><span class="sxs-lookup"><span data-stu-id="282b1-470">Deny-Inbound-RDP-Internet</span></span> | <span data-ttu-id="282b1-471">Neka</span><span class="sxs-lookup"><span data-stu-id="282b1-471">Deny</span></span> | <span data-ttu-id="282b1-472">100</span><span class="sxs-lookup"><span data-stu-id="282b1-472">100</span></span> | <span data-ttu-id="282b1-473">Internet</span><span class="sxs-lookup"><span data-stu-id="282b1-473">Internet</span></span> | * | * | <span data-ttu-id="282b1-474">3389</span><span class="sxs-lookup"><span data-stu-id="282b1-474">3389</span></span> | <span data-ttu-id="282b1-475">TCP</span><span class="sxs-lookup"><span data-stu-id="282b1-475">TCP</span></span> |
| <span data-ttu-id="282b1-476">Allow-Inbound-HTTP-Internet</span><span class="sxs-lookup"><span data-stu-id="282b1-476">Allow-Inbound-HTTP-Internet</span></span> | <span data-ttu-id="282b1-477">Tillåt</span><span class="sxs-lookup"><span data-stu-id="282b1-477">Allow</span></span> | <span data-ttu-id="282b1-478">200</span><span class="sxs-lookup"><span data-stu-id="282b1-478">200</span></span> | <span data-ttu-id="282b1-479">Internet</span><span class="sxs-lookup"><span data-stu-id="282b1-479">Internet</span></span> | * | * | <span data-ttu-id="282b1-480">80</span><span class="sxs-lookup"><span data-stu-id="282b1-480">80</span></span> | <span data-ttu-id="282b1-481">TCP</span><span class="sxs-lookup"><span data-stu-id="282b1-481">TCP</span></span> |

### <a name="db-servers-management-nic"></a><span data-ttu-id="282b1-482">DB-servrar (nätverkskort för hantering)</span><span class="sxs-lookup"><span data-stu-id="282b1-482">DB servers (Management NIC)</span></span>
<span data-ttu-id="282b1-483">**Regler för inkommande trafik**</span><span class="sxs-lookup"><span data-stu-id="282b1-483">**Inbound rules**</span></span>

| <span data-ttu-id="282b1-484">Regel</span><span class="sxs-lookup"><span data-stu-id="282b1-484">Rule</span></span> | <span data-ttu-id="282b1-485">Åtkomst</span><span class="sxs-lookup"><span data-stu-id="282b1-485">Access</span></span> | <span data-ttu-id="282b1-486">Prioritet</span><span class="sxs-lookup"><span data-stu-id="282b1-486">Priority</span></span> | <span data-ttu-id="282b1-487">Källadress-intervall</span><span class="sxs-lookup"><span data-stu-id="282b1-487">Source address range</span></span> | <span data-ttu-id="282b1-488">Källport</span><span class="sxs-lookup"><span data-stu-id="282b1-488">Source port</span></span> | <span data-ttu-id="282b1-489">Måladress-intervall</span><span class="sxs-lookup"><span data-stu-id="282b1-489">Destination address range</span></span> | <span data-ttu-id="282b1-490">Målport</span><span class="sxs-lookup"><span data-stu-id="282b1-490">Destination port</span></span> | <span data-ttu-id="282b1-491">Protokoll</span><span class="sxs-lookup"><span data-stu-id="282b1-491">Protocol</span></span> |
| --- | --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="282b1-492">Allow-Inbound-RDP-Front-end</span><span class="sxs-lookup"><span data-stu-id="282b1-492">Allow-Inbound-RDP-Front-end</span></span> | <span data-ttu-id="282b1-493">Tillåt</span><span class="sxs-lookup"><span data-stu-id="282b1-493">Allow</span></span> | <span data-ttu-id="282b1-494">100</span><span class="sxs-lookup"><span data-stu-id="282b1-494">100</span></span> | <span data-ttu-id="282b1-495">192.168.1.0/24</span><span class="sxs-lookup"><span data-stu-id="282b1-495">192.168.1.0/24</span></span> | * | * | <span data-ttu-id="282b1-496">3389</span><span class="sxs-lookup"><span data-stu-id="282b1-496">3389</span></span> | <span data-ttu-id="282b1-497">TCP</span><span class="sxs-lookup"><span data-stu-id="282b1-497">TCP</span></span> |

### <a name="db-servers-database-traffic-nic"></a><span data-ttu-id="282b1-498">DB-servrar (nätverkskort för databastrafik)</span><span class="sxs-lookup"><span data-stu-id="282b1-498">DB servers (Database traffic NIC)</span></span>
<span data-ttu-id="282b1-499">**Regler för inkommande trafik**</span><span class="sxs-lookup"><span data-stu-id="282b1-499">**Inbound rules**</span></span>

| <span data-ttu-id="282b1-500">Regel</span><span class="sxs-lookup"><span data-stu-id="282b1-500">Rule</span></span> | <span data-ttu-id="282b1-501">Åtkomst</span><span class="sxs-lookup"><span data-stu-id="282b1-501">Access</span></span> | <span data-ttu-id="282b1-502">Prioritet</span><span class="sxs-lookup"><span data-stu-id="282b1-502">Priority</span></span> | <span data-ttu-id="282b1-503">Källadress-intervall</span><span class="sxs-lookup"><span data-stu-id="282b1-503">Source address range</span></span> | <span data-ttu-id="282b1-504">Källport</span><span class="sxs-lookup"><span data-stu-id="282b1-504">Source port</span></span> | <span data-ttu-id="282b1-505">Måladress-intervall</span><span class="sxs-lookup"><span data-stu-id="282b1-505">Destination address range</span></span> | <span data-ttu-id="282b1-506">Målport</span><span class="sxs-lookup"><span data-stu-id="282b1-506">Destination port</span></span> | <span data-ttu-id="282b1-507">Protokoll</span><span class="sxs-lookup"><span data-stu-id="282b1-507">Protocol</span></span> |
| --- | --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="282b1-508">Allow-Inbound-SQL-Front-end</span><span class="sxs-lookup"><span data-stu-id="282b1-508">Allow-Inbound-SQL-Front-end</span></span> | <span data-ttu-id="282b1-509">Tillåt</span><span class="sxs-lookup"><span data-stu-id="282b1-509">Allow</span></span> | <span data-ttu-id="282b1-510">100</span><span class="sxs-lookup"><span data-stu-id="282b1-510">100</span></span> | <span data-ttu-id="282b1-511">192.168.1.0/24</span><span class="sxs-lookup"><span data-stu-id="282b1-511">192.168.1.0/24</span></span> | * | * | <span data-ttu-id="282b1-512">1433</span><span class="sxs-lookup"><span data-stu-id="282b1-512">1433</span></span> | <span data-ttu-id="282b1-513">TCP</span><span class="sxs-lookup"><span data-stu-id="282b1-513">TCP</span></span> |

<span data-ttu-id="282b1-514">Eftersom vissa av hello NSG: er är associerade tooindividual nätverkskort är hello regler för resurser som har distribuerats via Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="282b1-514">Since some of hello NSGs are associated tooindividual NICs, hello rules are for resources deployed through Resource Manager.</span></span> <span data-ttu-id="282b1-515">Regler kombineras för undernät och nätverkskort, beroende på hur de är associerade.</span><span class="sxs-lookup"><span data-stu-id="282b1-515">Rules are combined for subnet and NIC, depending on how they are associated.</span></span> 

## <a name="next-steps"></a><span data-ttu-id="282b1-516">Nästa steg</span><span class="sxs-lookup"><span data-stu-id="282b1-516">Next steps</span></span>
* <span data-ttu-id="282b1-517">[Distribuera nätverkssäkerhetsgrupper (Resource Manager)](virtual-networks-create-nsg-arm-pportal.md).</span><span class="sxs-lookup"><span data-stu-id="282b1-517">[Deploy NSGs (Resource Manager)](virtual-networks-create-nsg-arm-pportal.md).</span></span>
* <span data-ttu-id="282b1-518">[Distribuera nätverkssäkerhetsgrupper (klassisk)](virtual-networks-create-nsg-classic-ps.md).</span><span class="sxs-lookup"><span data-stu-id="282b1-518">[Deploy NSGs (classic)](virtual-networks-create-nsg-classic-ps.md).</span></span>
* <span data-ttu-id="282b1-519">[Hantera NSG-loggar](virtual-network-nsg-manage-log.md).</span><span class="sxs-lookup"><span data-stu-id="282b1-519">[Manage NSG logs](virtual-network-nsg-manage-log.md).</span></span>
* <span data-ttu-id="282b1-520">[Felsöka nätverkssäkerhetsgrupper] (virtual-network-nsg-troubleshoot-portal.md)</span><span class="sxs-lookup"><span data-stu-id="282b1-520">[Troubleshoot NSGs] (virtual-network-nsg-troubleshoot-portal.md)</span></span>
