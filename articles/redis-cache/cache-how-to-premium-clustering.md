---
title: "Konfigurera Redis klustring för Premium Azure Redis-Cache | Microsoft Docs"
description: "Lär dig hur du skapar och hanterar Redis klustring för Premium-nivån Azure Redis-Cache-instanser"
services: redis-cache
documentationcenter: 
author: steved0x
manager: douge
editor: 
ms.assetid: 62208eec-52ae-4713-b077-62659fd844ab
ms.service: cache
ms.workload: tbd
ms.tgt_pltfrm: cache-redis
ms.devlang: na
ms.topic: article
ms.date: 07/05/2017
ms.author: sdanie
ms.openlocfilehash: 86a4a605dbb3b11924c14ff42238009742f72898
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 07/11/2017
---
# <a name="how-to-configure-redis-clustering-for-a-premium-azure-redis-cache"></a><span data-ttu-id="79e37-103">Konfigurera Redis klustring för Premium Azure Redis-Cache</span><span class="sxs-lookup"><span data-stu-id="79e37-103">How to configure Redis clustering for a Premium Azure Redis Cache</span></span>
<span data-ttu-id="79e37-104">Azure Redis-Cache har olika cache-erbjudanden som ger flexibilitet vid val av cachestorlek och funktioner, inklusive funktioner för Premium-nivån, till exempel klustring, beständiga och stöd för virtuella nätverk.</span><span class="sxs-lookup"><span data-stu-id="79e37-104">Azure Redis Cache has different cache offerings, which provide flexibility in the choice of cache size and features, including Premium tier features such as clustering, persistence, and virtual network support.</span></span> <span data-ttu-id="79e37-105">Den här artikeln beskriver hur du konfigurerar kluster i en premium Azure Redis-Cache-instans.</span><span class="sxs-lookup"><span data-stu-id="79e37-105">This article describes how to configure clustering in a premium Azure Redis Cache instance.</span></span>

<span data-ttu-id="79e37-106">Information om andra cache premium-funktioner finns [introduktion till Azure Redis Cache Premium-nivån](cache-premium-tier-intro.md).</span><span class="sxs-lookup"><span data-stu-id="79e37-106">For information on other premium cache features, see [Introduction to the Azure Redis Cache Premium tier](cache-premium-tier-intro.md).</span></span>

## <a name="what-is-redis-cluster"></a><span data-ttu-id="79e37-107">Vad är Redis-kluster?</span><span class="sxs-lookup"><span data-stu-id="79e37-107">What is Redis Cluster?</span></span>
<span data-ttu-id="79e37-108">Azure Redis-Cache erbjuder Redis cluster som [implementeras i Redis](http://redis.io/topics/cluster-tutorial).</span><span class="sxs-lookup"><span data-stu-id="79e37-108">Azure Redis Cache offers Redis cluster as [implemented in Redis](http://redis.io/topics/cluster-tutorial).</span></span> <span data-ttu-id="79e37-109">Med Redis-kluster får du följande fördelar:</span><span class="sxs-lookup"><span data-stu-id="79e37-109">With Redis Cluster, you get the following benefits:</span></span> 

* <span data-ttu-id="79e37-110">Möjligheten att automatiskt dela din datauppsättning mellan flera noder.</span><span class="sxs-lookup"><span data-stu-id="79e37-110">The ability to automatically split your dataset among multiple nodes.</span></span> 
* <span data-ttu-id="79e37-111">Möjligheten att fortsätta arbetet när en delmängd av noderna har uppstått fel eller inte kan kommunicera med resten av klustret.</span><span class="sxs-lookup"><span data-stu-id="79e37-111">The ability to continue operations when a subset of the nodes is experiencing failures or are unable to communicate with the rest of the cluster.</span></span> 
* <span data-ttu-id="79e37-112">Flera genomströmning: genomströmning linjärt ökar om du ökar antalet delar.</span><span class="sxs-lookup"><span data-stu-id="79e37-112">More throughput: Throughput increases linearly as you increase the number of shards.</span></span> 
* <span data-ttu-id="79e37-113">Flera minnesstorleken: linjärt ökar om du ökar antalet delar.</span><span class="sxs-lookup"><span data-stu-id="79e37-113">More memory size: Increases linearly as you increase the number of shards.</span></span>  

<span data-ttu-id="79e37-114">Mer information om storlek, genomflöde och bandbredd med premium cacheminnen finns [vilka Redis-Cache erbjudande och vilken storlek ska jag använda?](cache-faq.md#what-redis-cache-offering-and-size-should-i-use)</span><span class="sxs-lookup"><span data-stu-id="79e37-114">For more information about size, throughput, and bandwidth with premium caches, see [What Redis Cache offering and size should I use?](cache-faq.md#what-redis-cache-offering-and-size-should-i-use)</span></span>

<span data-ttu-id="79e37-115">I Azure erbjuds Redis cluster som primär replik/modell där varje Fragmentera har två primära/replik med replikering där replikeringen hanteras av Azure Redis-Cache-tjänsten.</span><span class="sxs-lookup"><span data-stu-id="79e37-115">In Azure, Redis cluster is offered as a primary/replica model where each shard has a primary/replica pair with replication where the replication is managed by Azure Redis Cache service.</span></span> 

## <a name="clustering"></a><span data-ttu-id="79e37-116">Klustring</span><span class="sxs-lookup"><span data-stu-id="79e37-116">Clustering</span></span>
<span data-ttu-id="79e37-117">Kluster har aktiverats på den **nytt Redis-Cache** bladet under skapande av cachen.</span><span class="sxs-lookup"><span data-stu-id="79e37-117">Clustering is enabled on the **New Redis Cache** blade during cache creation.</span></span> 

[!INCLUDE [redis-cache-create](../../includes/redis-cache-premium-create.md)]

<span data-ttu-id="79e37-118">Kluster har konfigurerats på den **Redis Cluster** bladet.</span><span class="sxs-lookup"><span data-stu-id="79e37-118">Clustering is configured on the **Redis Cluster** blade.</span></span>

![Klustring][redis-cache-clustering]

<span data-ttu-id="79e37-120">Du kan ha upp till 10 delar i klustret.</span><span class="sxs-lookup"><span data-stu-id="79e37-120">You can have up to 10 shards in the cluster.</span></span> <span data-ttu-id="79e37-121">Klicka på **aktiverad** och dra reglaget eller ange ett tal mellan 1 och 10 för **Fragmentera antal** och på **OK**.</span><span class="sxs-lookup"><span data-stu-id="79e37-121">Click **Enabled** and slide the slider or type a number between 1 and 10 for **Shard count** and click **OK**.</span></span>

<span data-ttu-id="79e37-122">Varje Fragmentera är en primär/replik cache-par som hanteras av Azure och den totala storleken på cacheminnet beräknas genom att multiplicera antalet delar med cachestorleken som valts i prisnivån.</span><span class="sxs-lookup"><span data-stu-id="79e37-122">Each shard is a primary/replica cache pair managed by Azure, and the total size of the cache is calculated by multiplying the number of shards by the cache size selected in the pricing tier.</span></span> 

![Klustring][redis-cache-clustering-selected]

<span data-ttu-id="79e37-124">När cachen har skapats du ansluter till den och Använd den precis som en icke-klustrade cache och Redis distribuerar data i hela cachen delar.</span><span class="sxs-lookup"><span data-stu-id="79e37-124">Once the cache is created you connect to it and use it just like a non-clustered cache, and Redis distributes the data throughout the Cache shards.</span></span> <span data-ttu-id="79e37-125">Om diagnostik är [aktiverat](cache-how-to-monitor.md#enable-cache-diagnostics), mätvärden fångas separat för varje Fragmentera och kan vara [visas](cache-how-to-monitor.md) i bladet Redis-Cache.</span><span class="sxs-lookup"><span data-stu-id="79e37-125">If diagnostics is [enabled](cache-how-to-monitor.md#enable-cache-diagnostics), metrics are captured separately for each shard and can be [viewed](cache-how-to-monitor.md) in the Redis Cache blade.</span></span> 

> [!NOTE]
> 
> <span data-ttu-id="79e37-126">Det finns några mindre skillnader som krävs i ditt klientprogram när kluster är konfigurerat.</span><span class="sxs-lookup"><span data-stu-id="79e37-126">There are some minor differences required in your client application when clustering is configured.</span></span> <span data-ttu-id="79e37-127">Mer information finns i [behöver jag göra ändringar i client-program att använda kluster?](#do-i-need-to-make-any-changes-to-my-client-application-to-use-clustering)</span><span class="sxs-lookup"><span data-stu-id="79e37-127">For more information, see [Do I need to make any changes to my client application to use clustering?](#do-i-need-to-make-any-changes-to-my-client-application-to-use-clustering)</span></span>
> 
> 

<span data-ttu-id="79e37-128">Exempel om hur du arbetar med kluster med StackExchange.Redis-klienten, finns det [clustering.cs](https://github.com/rustd/RedisSamples/blob/master/HelloWorld/Clustering.cs) del av den [Hello World](https://github.com/rustd/RedisSamples/tree/master/HelloWorld) exempel.</span><span class="sxs-lookup"><span data-stu-id="79e37-128">For sample code on working with clustering with the StackExchange.Redis client, see the [clustering.cs](https://github.com/rustd/RedisSamples/blob/master/HelloWorld/Clustering.cs) portion of the [Hello World](https://github.com/rustd/RedisSamples/tree/master/HelloWorld) sample.</span></span>

<a name="cluster-size"></a>

## <a name="change-the-cluster-size-on-a-running-premium-cache"></a><span data-ttu-id="79e37-129">Ändra klusterstorlek på ett premium-cache</span><span class="sxs-lookup"><span data-stu-id="79e37-129">Change the cluster size on a running premium cache</span></span>
<span data-ttu-id="79e37-130">Ändra klusterstorleken på ett premium-cache med aktiverad, klustring klickar du på **Redis klusterstorleken** från den **resurs menyn**.</span><span class="sxs-lookup"><span data-stu-id="79e37-130">To change the cluster size on a running premium cache with clustering enabled, click **Redis Cluster Size** from the **Resource menu**.</span></span>

> [!NOTE]
> <span data-ttu-id="79e37-131">Medan Azure Redis Cache Premium-nivån har släppts för allmän tillgänglighet, är Redis klusterstorleken-funktionen för närvarande i förhandsgranskningen.</span><span class="sxs-lookup"><span data-stu-id="79e37-131">While the Azure Redis Cache Premium tier has been released to General Availability, the Redis Cluster Size feature is currently in preview.</span></span>
> 
> 

![Redis klusterstorleken][redis-cache-redis-cluster-size]

<span data-ttu-id="79e37-133">Om du vill ändra klusterstorleken skjutreglaget eller ange ett tal mellan 1 och 10 i den **Fragmentera antal** textrutan och klicka på **OK** att spara.</span><span class="sxs-lookup"><span data-stu-id="79e37-133">To change the cluster size, use the slider or type a number between 1 and 10 in the **Shard count** text box and click **OK** to save.</span></span>

> [!NOTE]
> <span data-ttu-id="79e37-134">Skala ett kluster som kör den [MIGRERA](https://redis.io/commands/migrate) kommandot, vilket är en kostsam kommando så för minimal påverkan Överväg att köra den här åtgärden vid låg belastning.</span><span class="sxs-lookup"><span data-stu-id="79e37-134">Scaling a cluster runs the [MIGRATE](https://redis.io/commands/migrate) command, which is an expensive command, so for minimal impact, consider running this operation during non-peak hours.</span></span> <span data-ttu-id="79e37-135">Under migreringen visas en topp i belastningen på servern.</span><span class="sxs-lookup"><span data-stu-id="79e37-135">During the migration process, you will see a spike in server load.</span></span> <span data-ttu-id="79e37-136">Skala ett kluster körs lång processen och mängden tid det tar beror på antalet nycklar och storleken på de värden som är associerade med nycklarna.</span><span class="sxs-lookup"><span data-stu-id="79e37-136">Scaling a cluster is a long running process and the amount of time taken depends on the number of keys and size of the values associated with those keys.</span></span>
> 
> 

## <a name="clustering-faq"></a><span data-ttu-id="79e37-137">Kluster för vanliga frågor och svar</span><span class="sxs-lookup"><span data-stu-id="79e37-137">Clustering FAQ</span></span>
<span data-ttu-id="79e37-138">I följande lista innehåller svar på vanliga frågor om Azure Redis-Cache-kluster.</span><span class="sxs-lookup"><span data-stu-id="79e37-138">The following list contains answers to commonly asked questions about Azure Redis Cache clustering.</span></span>

* [<span data-ttu-id="79e37-139">Behöver jag göra ändringar i client-program att använda kluster?</span><span class="sxs-lookup"><span data-stu-id="79e37-139">Do I need to make any changes to my client application to use clustering?</span></span>](#do-i-need-to-make-any-changes-to-my-client-application-to-use-clustering)
* [<span data-ttu-id="79e37-140">Hur distribueras nycklar i ett kluster?</span><span class="sxs-lookup"><span data-stu-id="79e37-140">How are keys distributed in a cluster?</span></span>](#how-are-keys-distributed-in-a-cluster)
* [<span data-ttu-id="79e37-141">Vad är den största cachestorleken kan jag skapa?</span><span class="sxs-lookup"><span data-stu-id="79e37-141">What is the largest cache size I can create?</span></span>](#what-is-the-largest-cache-size-i-can-create)
* [<span data-ttu-id="79e37-142">Stöder alla Redis-klienter kluster?</span><span class="sxs-lookup"><span data-stu-id="79e37-142">Do all Redis clients support clustering?</span></span>](#do-all-redis-clients-support-clustering)
* [<span data-ttu-id="79e37-143">Hur ansluter jag min cacheminne när kluster aktiveras?</span><span class="sxs-lookup"><span data-stu-id="79e37-143">How do I connect to my cache when clustering is enabled?</span></span>](#how-do-i-connect-to-my-cache-when-clustering-is-enabled)
* [<span data-ttu-id="79e37-144">Kan jag ansluta direkt till enskilda delar min-cache?</span><span class="sxs-lookup"><span data-stu-id="79e37-144">Can I directly connect to the individual shards of my cache?</span></span>](#can-i-directly-connect-to-the-individual-shards-of-my-cache)
* [<span data-ttu-id="79e37-145">Kan jag konfigurera klustring för en tidigare skapad cache?</span><span class="sxs-lookup"><span data-stu-id="79e37-145">Can I configure clustering for a previously created cache?</span></span>](#can-i-configure-clustering-for-a-previously-created-cache)
* [<span data-ttu-id="79e37-146">Kan jag konfigurera klustring för basic eller standard-cache?</span><span class="sxs-lookup"><span data-stu-id="79e37-146">Can I configure clustering for a basic or standard cache?</span></span>](#can-i-configure-clustering-for-a-basic-or-standard-cache)
* [<span data-ttu-id="79e37-147">Kan jag använda kluster med Redis ASP.NET Session State och cachelagring av utdata-providers?</span><span class="sxs-lookup"><span data-stu-id="79e37-147">Can I use clustering with the Redis ASP.NET Session State and Output Caching providers?</span></span>](#can-i-use-clustering-with-the-redis-aspnet-session-state-and-output-caching-providers)
* [<span data-ttu-id="79e37-148">Jag får flytta undantag när du använder StackExchange.Redis och klustring, vad ska jag göra?</span><span class="sxs-lookup"><span data-stu-id="79e37-148">I am getting MOVE exceptions when using StackExchange.Redis and clustering, what should I do?</span></span>](#i-am-getting-move-exceptions-when-using-stackexchangeredis-and-clustering-what-should-i-do)

### <a name="do-i-need-to-make-any-changes-to-my-client-application-to-use-clustering"></a><span data-ttu-id="79e37-149">Behöver jag göra ändringar i client-program att använda kluster?</span><span class="sxs-lookup"><span data-stu-id="79e37-149">Do I need to make any changes to my client application to use clustering?</span></span>
* <span data-ttu-id="79e37-150">När kluster aktiveras är endast databasen 0 tillgänglig.</span><span class="sxs-lookup"><span data-stu-id="79e37-150">When clustering is enabled, only database 0 is available.</span></span> <span data-ttu-id="79e37-151">Om klientprogrammet använder flera databaser och försök att läsa eller skriva till en annan databas än 0, utlöstes följande undantag.</span><span class="sxs-lookup"><span data-stu-id="79e37-151">If your client application uses multiple databases and it tries to read or write to a database other than 0, the following exception is thrown.</span></span> <span data-ttu-id="79e37-152">`Unhandled Exception: StackExchange.Redis.RedisConnectionException: ProtocolFailure on GET --->` `StackExchange.Redis.RedisCommandException: Multiple databases are not supported on this server; cannot switch to database: 6`</span><span class="sxs-lookup"><span data-stu-id="79e37-152">`Unhandled Exception: StackExchange.Redis.RedisConnectionException: ProtocolFailure on GET --->` `StackExchange.Redis.RedisCommandException: Multiple databases are not supported on this server; cannot switch to database: 6`</span></span>
  
  <span data-ttu-id="79e37-153">Mer information finns i [Redis-kluster specifikation - implementerad delmängd](http://redis.io/topics/cluster-spec#implemented-subset).</span><span class="sxs-lookup"><span data-stu-id="79e37-153">For more information, see [Redis Cluster Specification - Implemented subset](http://redis.io/topics/cluster-spec#implemented-subset).</span></span>
* <span data-ttu-id="79e37-154">Om du använder [StackExchange.Redis](https://www.nuget.org/packages/StackExchange.Redis/), måste du använda 1.0.481 eller senare.</span><span class="sxs-lookup"><span data-stu-id="79e37-154">If you are using [StackExchange.Redis](https://www.nuget.org/packages/StackExchange.Redis/), you must use 1.0.481 or later.</span></span> <span data-ttu-id="79e37-155">Du ansluter till i cacheminnet som använder samma [slutpunkter, portarna och nycklarna](cache-configure.md#properties) som du använder när du ansluter till en cache som inte har aktiverat-kluster.</span><span class="sxs-lookup"><span data-stu-id="79e37-155">You connect to the cache using the same [endpoints, ports, and keys](cache-configure.md#properties) that you use when connecting to a cache that does not have clustering enabled.</span></span> <span data-ttu-id="79e37-156">Den enda skillnaden är att alla läsningar och skrivningar måste göras till 0-databasen.</span><span class="sxs-lookup"><span data-stu-id="79e37-156">The only difference is that all reads and writes must be done to database 0.</span></span>
  
  * <span data-ttu-id="79e37-157">Andra klienter kan ha olika krav.</span><span class="sxs-lookup"><span data-stu-id="79e37-157">Other clients may have different requirements.</span></span> <span data-ttu-id="79e37-158">Se [alla Redis-klienter stöder kluster?](#do-all-redis-clients-support-clustering)</span><span class="sxs-lookup"><span data-stu-id="79e37-158">See [Do all Redis clients support clustering?](#do-all-redis-clients-support-clustering)</span></span>
* <span data-ttu-id="79e37-159">Om programmet använder flera viktiga åtgärder batchar till ett enda kommando, måste alla nycklar finnas i samma Fragmentera.</span><span class="sxs-lookup"><span data-stu-id="79e37-159">If your application uses multiple key operations batched into a single command, all keys must be located in the same shard.</span></span> <span data-ttu-id="79e37-160">Du hittar nycklar i samma Fragmentera [hur nycklar distribueras i ett kluster?](#how-are-keys-distributed-in-a-cluster)</span><span class="sxs-lookup"><span data-stu-id="79e37-160">To locate keys in the same shard, see [How are keys distributed in a cluster?](#how-are-keys-distributed-in-a-cluster)</span></span>
* <span data-ttu-id="79e37-161">Om du använder sessionstillståndet ASP.NET för Redis-providern måste du använda 2.0.1 eller högre.</span><span class="sxs-lookup"><span data-stu-id="79e37-161">If you are using Redis ASP.NET Session State provider you must use 2.0.1 or higher.</span></span> <span data-ttu-id="79e37-162">Se [kan du använda kluster med Redis ASP.NET Session State och cachelagring av utdata-providers?](#can-i-use-clustering-with-the-redis-aspnet-session-state-and-output-caching-providers)</span><span class="sxs-lookup"><span data-stu-id="79e37-162">See [Can I use clustering with the Redis ASP.NET Session State and Output Caching providers?](#can-i-use-clustering-with-the-redis-aspnet-session-state-and-output-caching-providers)</span></span>

### <a name="how-are-keys-distributed-in-a-cluster"></a><span data-ttu-id="79e37-163">Hur distribueras nycklar i ett kluster?</span><span class="sxs-lookup"><span data-stu-id="79e37-163">How are keys distributed in a cluster?</span></span>
<span data-ttu-id="79e37-164">Per Redis [nycklar distributionsmodell](http://redis.io/topics/cluster-spec#keys-distribution-model) dokumentation: nyckel kan delas in i 16384 platser.</span><span class="sxs-lookup"><span data-stu-id="79e37-164">Per the Redis [Keys distribution model](http://redis.io/topics/cluster-spec#keys-distribution-model) documentation: The key space is split into 16384 slots.</span></span> <span data-ttu-id="79e37-165">Varje nyckel hashas och tilldelas till en av platserna, som är fördelade på noderna i klustret.</span><span class="sxs-lookup"><span data-stu-id="79e37-165">Each key is hashed and assigned to one of these slots, which are distributed across the nodes of the cluster.</span></span> <span data-ttu-id="79e37-166">Du kan konfigurera vilken del av nyckeln hashas för att säkerställa att flera nycklar finns i samma Fragmentera med hash-taggar.</span><span class="sxs-lookup"><span data-stu-id="79e37-166">You can configure which part of the key is hashed to ensure that multiple keys are located in the same shard using hash tags.</span></span>

* <span data-ttu-id="79e37-167">Nycklar med en tagg för hash - om någon del av nyckeln omges av `{` och `}`, endast den del av nyckeln hashas för att fastställa hash-plats i en nyckel.</span><span class="sxs-lookup"><span data-stu-id="79e37-167">Keys with a hash tag - if any part of the key is enclosed in `{` and `}`, only that part of the key is hashed for the purposes of determining the hash slot of a key.</span></span> <span data-ttu-id="79e37-168">Till exempel följande 3 nycklar skulle finnas i samma Fragmentera: `{key}1`, `{key}2`, och `{key}3` eftersom endast den `key` hashas del av namnet.</span><span class="sxs-lookup"><span data-stu-id="79e37-168">For example, the following 3 keys would be located in the same shard: `{key}1`, `{key}2`, and `{key}3` since only the `key` part of the name is hashed.</span></span> <span data-ttu-id="79e37-169">En fullständig lista över nycklar hash-tagg specifikationer finns [nycklar hash-taggar](http://redis.io/topics/cluster-spec#keys-hash-tags).</span><span class="sxs-lookup"><span data-stu-id="79e37-169">For a complete list of keys hash tag specifications, see [Keys hash tags](http://redis.io/topics/cluster-spec#keys-hash-tags).</span></span>
* <span data-ttu-id="79e37-170">Nycklar utan en hash-tagg - hela nyckelnamnet används för hashing.</span><span class="sxs-lookup"><span data-stu-id="79e37-170">Keys without a hash tag - the entire key name is used for hashing.</span></span> <span data-ttu-id="79e37-171">Detta resulterar i en statistiskt jämn fördelning över delar av cachen.</span><span class="sxs-lookup"><span data-stu-id="79e37-171">This results in a statistically even distribution across the shards of the cache.</span></span>

<span data-ttu-id="79e37-172">För bästa prestanda och genomflöde fördela nycklarna jämnt.</span><span class="sxs-lookup"><span data-stu-id="79e37-172">For best performance and throughput, we recommend distributing the keys evenly.</span></span> <span data-ttu-id="79e37-173">Om du använder nycklar med en hash-tagg är programmets ansvar att se till att nycklarna fördelas jämnt.</span><span class="sxs-lookup"><span data-stu-id="79e37-173">If you are using keys with a hash tag it is the application's responsibility to ensure the keys are distributed evenly.</span></span>

<span data-ttu-id="79e37-174">Mer information finns i [nycklar distributionsmodell](http://redis.io/topics/cluster-spec#keys-distribution-model), [Redis Cluster data horisontell partitionering](http://redis.io/topics/cluster-tutorial#redis-cluster-data-sharding), och [nycklar hash-taggar](http://redis.io/topics/cluster-spec#keys-hash-tags).</span><span class="sxs-lookup"><span data-stu-id="79e37-174">For more information, see [Keys distribution model](http://redis.io/topics/cluster-spec#keys-distribution-model), [Redis Cluster data sharding](http://redis.io/topics/cluster-tutorial#redis-cluster-data-sharding), and [Keys hash tags](http://redis.io/topics/cluster-spec#keys-hash-tags).</span></span>

<span data-ttu-id="79e37-175">Exempel om hur du arbetar med kluster och hitta nycklar i samma Fragmentera med StackExchange.Redis-klienten, finns det [clustering.cs](https://github.com/rustd/RedisSamples/blob/master/HelloWorld/Clustering.cs) del av den [Hello World](https://github.com/rustd/RedisSamples/tree/master/HelloWorld) exempel.</span><span class="sxs-lookup"><span data-stu-id="79e37-175">For sample code on working with clustering and locating keys in the same shard with the StackExchange.Redis client, see the [clustering.cs](https://github.com/rustd/RedisSamples/blob/master/HelloWorld/Clustering.cs) portion of the [Hello World](https://github.com/rustd/RedisSamples/tree/master/HelloWorld) sample.</span></span>

### <a name="what-is-the-largest-cache-size-i-can-create"></a><span data-ttu-id="79e37-176">Vad är den största cachestorleken kan jag skapa?</span><span class="sxs-lookup"><span data-stu-id="79e37-176">What is the largest cache size I can create?</span></span>
<span data-ttu-id="79e37-177">Den största premium cachestorleken är 53 GB.</span><span class="sxs-lookup"><span data-stu-id="79e37-177">The largest premium cache size is 53 GB.</span></span> <span data-ttu-id="79e37-178">Du kan skapa upp till 10 shards ger dig en maximal storlek på 530 GB.</span><span class="sxs-lookup"><span data-stu-id="79e37-178">You can create up to 10 shards giving you a maximum size of 530 GB.</span></span> <span data-ttu-id="79e37-179">Om du behöver en större kan du [begära mer](mailto:wapteams@microsoft.com?subject=Redis%20Cache%20quota%20increase).</span><span class="sxs-lookup"><span data-stu-id="79e37-179">If you need a larger size you can [request more](mailto:wapteams@microsoft.com?subject=Redis%20Cache%20quota%20increase).</span></span> <span data-ttu-id="79e37-180">Mer information finns i [priser för Azure Redis-Cache](https://azure.microsoft.com/pricing/details/cache/).</span><span class="sxs-lookup"><span data-stu-id="79e37-180">For more information, see [Azure Redis Cache Pricing](https://azure.microsoft.com/pricing/details/cache/).</span></span>

### <a name="do-all-redis-clients-support-clustering"></a><span data-ttu-id="79e37-181">Stöder alla Redis-klienter kluster?</span><span class="sxs-lookup"><span data-stu-id="79e37-181">Do all Redis clients support clustering?</span></span>
<span data-ttu-id="79e37-182">För närvarande inte alla klienter har stöd för Redis-kluster.</span><span class="sxs-lookup"><span data-stu-id="79e37-182">At the present time not all clients support Redis clustering.</span></span> <span data-ttu-id="79e37-183">StackExchange.Redis är ett som har stöd för den.</span><span class="sxs-lookup"><span data-stu-id="79e37-183">StackExchange.Redis is one that does support for it.</span></span> <span data-ttu-id="79e37-184">Mer information om andra klienter finns i [spelar med klustret](http://redis.io/topics/cluster-tutorial#playing-with-the-cluster) avsnitt i den [Redis cluster kursen](http://redis.io/topics/cluster-tutorial).</span><span class="sxs-lookup"><span data-stu-id="79e37-184">For more information on other clients, see the [Playing with the cluster](http://redis.io/topics/cluster-tutorial#playing-with-the-cluster) section of the [Redis cluster tutorial](http://redis.io/topics/cluster-tutorial).</span></span>

> [!NOTE]
> <span data-ttu-id="79e37-185">Om du använder StackExchange.Redis som klienten kan du kontrollera att du använder den senaste versionen av [StackExchange.Redis](https://www.nuget.org/packages/StackExchange.Redis/) 1.0.481 eller senare för kluster ska fungera korrekt.</span><span class="sxs-lookup"><span data-stu-id="79e37-185">If you are using StackExchange.Redis as your client, ensure you are using the latest version of [StackExchange.Redis](https://www.nuget.org/packages/StackExchange.Redis/) 1.0.481 or later for clustering to work correctly.</span></span> <span data-ttu-id="79e37-186">Om du har problem med flytta undantag, se [flytta undantag](#move-exceptions) för mer information.</span><span class="sxs-lookup"><span data-stu-id="79e37-186">If you have any issues with move exceptions, see [move exceptions](#move-exceptions) for more information.</span></span>
> 
> 

### <a name="how-do-i-connect-to-my-cache-when-clustering-is-enabled"></a><span data-ttu-id="79e37-187">Hur ansluter jag min cacheminne när kluster aktiveras?</span><span class="sxs-lookup"><span data-stu-id="79e37-187">How do I connect to my cache when clustering is enabled?</span></span>
<span data-ttu-id="79e37-188">Du kan ansluta till ditt cacheminne som använder samma [slutpunkter](cache-configure.md#properties), [portar](cache-configure.md#properties), och [nycklar](cache-configure.md#access-keys) som du använder när du ansluter till en cache som inte har aktiverat-kluster.</span><span class="sxs-lookup"><span data-stu-id="79e37-188">You can connect to your cache using the same [endpoints](cache-configure.md#properties), [ports](cache-configure.md#properties), and [keys](cache-configure.md#access-keys) that you use when connecting to a cache that does not have clustering enabled.</span></span> <span data-ttu-id="79e37-189">Redis hanterar kluster på serverdelen så att du inte hantera den från din klient.</span><span class="sxs-lookup"><span data-stu-id="79e37-189">Redis manages the clustering on the backend so you don't have to manage it from your client.</span></span>

### <a name="can-i-directly-connect-to-the-individual-shards-of-my-cache"></a><span data-ttu-id="79e37-190">Kan jag ansluta direkt till enskilda delar min-cache?</span><span class="sxs-lookup"><span data-stu-id="79e37-190">Can I directly connect to the individual shards of my cache?</span></span>
<span data-ttu-id="79e37-191">Detta stöds inte officiellt.</span><span class="sxs-lookup"><span data-stu-id="79e37-191">This is not officially supported.</span></span> <span data-ttu-id="79e37-192">Med som säger består varje Fragmentera av en primär/replik cache-par gemensamt kallas en cache-instans.</span><span class="sxs-lookup"><span data-stu-id="79e37-192">With that said, each shard consists of a primary/replica cache pair, collectively known as a cache instance.</span></span> <span data-ttu-id="79e37-193">Du kan ansluta till instanserna cache med hjälp av verktyget redis-cli i den [instabilt](http://redis.io/download) gren av databasen som Redis på GitHub.</span><span class="sxs-lookup"><span data-stu-id="79e37-193">You can connect to these cache instances using the redis-cli utility in the [unstable](http://redis.io/download) branch of the Redis repository at GitHub.</span></span> <span data-ttu-id="79e37-194">Den här versionen implementerar grundläggande stöd när den startas med den `-c` växla.</span><span class="sxs-lookup"><span data-stu-id="79e37-194">This version implements basic support when started with the `-c` switch.</span></span> <span data-ttu-id="79e37-195">Mer information finns i [spelar med klustret](http://redis.io/topics/cluster-tutorial#playing-with-the-cluster) på [http://redis.io](http://redis.io) i den [Redis cluster kursen](http://redis.io/topics/cluster-tutorial).</span><span class="sxs-lookup"><span data-stu-id="79e37-195">For more information see [Playing with the cluster](http://redis.io/topics/cluster-tutorial#playing-with-the-cluster) on [http://redis.io](http://redis.io) in the [Redis cluster tutorial](http://redis.io/topics/cluster-tutorial).</span></span>

<span data-ttu-id="79e37-196">För icke-ssl, använder du följande kommandon.</span><span class="sxs-lookup"><span data-stu-id="79e37-196">For non-ssl, use the following commands.</span></span>

    Redis-cli.exe –h <<cachename>> -p 13000 (to connect to instance 0)
    Redis-cli.exe –h <<cachename>> -p 13001 (to connect to instance 1)
    Redis-cli.exe –h <<cachename>> -p 13002 (to connect to instance 2)
    ...
    Redis-cli.exe –h <<cachename>> -p 1300N (to connect to instance N)

<span data-ttu-id="79e37-197">Ssl, Ersätt `1300N` med `1500N`.</span><span class="sxs-lookup"><span data-stu-id="79e37-197">For ssl, replace `1300N` with `1500N`.</span></span>

### <a name="can-i-configure-clustering-for-a-previously-created-cache"></a><span data-ttu-id="79e37-198">Kan jag konfigurera klustring för en tidigare skapad cache?</span><span class="sxs-lookup"><span data-stu-id="79e37-198">Can I configure clustering for a previously created cache?</span></span>
<span data-ttu-id="79e37-199">Du kan för närvarande bara aktivera kluster när du skapar en cache.</span><span class="sxs-lookup"><span data-stu-id="79e37-199">Currently you can only enable clustering when you create a cache.</span></span> <span data-ttu-id="79e37-200">Du kan ändra klusterstorleken när cachen har skapats, men du kan inte lägga till kluster till ett premium-cacheminne eller ta bort kluster från cache premium när cachen har skapats.</span><span class="sxs-lookup"><span data-stu-id="79e37-200">You can change the cluster size after the cache is created, but you can't add clustering to a premium cache or remove clustering from a premium cache after the cache is created.</span></span> <span data-ttu-id="79e37-201">Premium-cache med aktiverad klustring och endast en Fragmentera skiljer sig premium cache av samma storlek med utan kluster.</span><span class="sxs-lookup"><span data-stu-id="79e37-201">A premium cache with clustering enabled and only one shard is different than a premium cache of the same size with no clustering.</span></span>

### <a name="can-i-configure-clustering-for-a-basic-or-standard-cache"></a><span data-ttu-id="79e37-202">Kan jag konfigurera klustring för basic eller standard-cache?</span><span class="sxs-lookup"><span data-stu-id="79e37-202">Can I configure clustering for a basic or standard cache?</span></span>
<span data-ttu-id="79e37-203">Kluster är endast tillgängligt för premium.</span><span class="sxs-lookup"><span data-stu-id="79e37-203">Clustering is only available for premium caches.</span></span>

### <a name="can-i-use-clustering-with-the-redis-aspnet-session-state-and-output-caching-providers"></a><span data-ttu-id="79e37-204">Kan jag använda kluster med Redis ASP.NET Session State och cachelagring av utdata-providers?</span><span class="sxs-lookup"><span data-stu-id="79e37-204">Can I use clustering with the Redis ASP.NET Session State and Output Caching providers?</span></span>
* <span data-ttu-id="79e37-205">**Redis utdatacache providern** -några ändringar krävs.</span><span class="sxs-lookup"><span data-stu-id="79e37-205">**Redis Output Cache provider** - no changes required.</span></span>
* <span data-ttu-id="79e37-206">**Redis-sessionstillståndsprovider** - om du vill använda kluster, måste du använda [RedisSessionStateProvider](https://www.nuget.org/packages/Microsoft.Web.RedisSessionStateProvider) 2.0.1 eller högre eller ett undantagsfel genereras.</span><span class="sxs-lookup"><span data-stu-id="79e37-206">**Redis Session State provider** - to use clustering, you must use [RedisSessionStateProvider](https://www.nuget.org/packages/Microsoft.Web.RedisSessionStateProvider) 2.0.1 or higher or an exception is thrown.</span></span> <span data-ttu-id="79e37-207">Det här är en ny ändring; Mer information finns i [v2.0.0 information om ändringar i bryter](https://github.com/Azure/aspnet-redis-providers/wiki/v2.0.0-Breaking-Change-Details).</span><span class="sxs-lookup"><span data-stu-id="79e37-207">This is a breaking change; for more information see [v2.0.0 Breaking Change Details](https://github.com/Azure/aspnet-redis-providers/wiki/v2.0.0-Breaking-Change-Details).</span></span>

<a name="move-exceptions"></a>

### <a name="i-am-getting-move-exceptions-when-using-stackexchangeredis-and-clustering-what-should-i-do"></a><span data-ttu-id="79e37-208">Jag får flytta undantag när du använder StackExchange.Redis och klustring, vad ska jag göra?</span><span class="sxs-lookup"><span data-stu-id="79e37-208">I am getting MOVE exceptions when using StackExchange.Redis and clustering, what should I do?</span></span>
<span data-ttu-id="79e37-209">Om du använder StackExchange.Redis och ta emot `MOVE` undantag när du använder kluster, se till att du använder [StackExchange.Redis 1.1.603](https://www.nuget.org/packages/StackExchange.Redis/) eller senare.</span><span class="sxs-lookup"><span data-stu-id="79e37-209">If you are using StackExchange.Redis and receive `MOVE` exceptions when using clustering, ensure that you are using [StackExchange.Redis 1.1.603](https://www.nuget.org/packages/StackExchange.Redis/) or later.</span></span> <span data-ttu-id="79e37-210">Anvisningar om hur du konfigurerar .NET-program att använda StackExchange.Redis finns [konfigurera cache-klienter](cache-dotnet-how-to-use-azure-redis-cache.md#configure-the-cache-clients).</span><span class="sxs-lookup"><span data-stu-id="79e37-210">For instructions on configuring your .NET applications to use StackExchange.Redis, see [Configure the cache clients](cache-dotnet-how-to-use-azure-redis-cache.md#configure-the-cache-clients).</span></span>

## <a name="next-steps"></a><span data-ttu-id="79e37-211">Nästa steg</span><span class="sxs-lookup"><span data-stu-id="79e37-211">Next steps</span></span>
<span data-ttu-id="79e37-212">Lär dig hur du använder flera funktioner som cache premium.</span><span class="sxs-lookup"><span data-stu-id="79e37-212">Learn how to use more premium cache features.</span></span>

* [<span data-ttu-id="79e37-213">Introduktion till Azure Redis Cache Premium-nivån</span><span class="sxs-lookup"><span data-stu-id="79e37-213">Introduction to the Azure Redis Cache Premium tier</span></span>](cache-premium-tier-intro.md)

<!-- IMAGES -->

[redis-cache-clustering]: ./media/cache-how-to-premium-clustering/redis-cache-clustering.png

[redis-cache-clustering-selected]: ./media/cache-how-to-premium-clustering/redis-cache-clustering-selected.png

[redis-cache-redis-cluster-size]: ./media/cache-how-to-premium-clustering/redis-cache-redis-cluster-size.png







