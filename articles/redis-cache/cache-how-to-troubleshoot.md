---
title: "Felsökning av Azure Redis-Cache | Microsoft Docs"
description: "Lär dig att lösa vanliga problem med Azure Redis-Cache."
services: redis-cache
documentationcenter: 
author: steved0x
manager: douge
editor: 
ms.assetid: 928b9b9c-d64f-4252-884f-af7ba8309af6
ms.service: cache
ms.workload: tbd
ms.tgt_pltfrm: cache-redis
ms.devlang: na
ms.topic: article
ms.date: 01/06/2017
ms.author: sdanie
ms.openlocfilehash: 2e9d1b644f1e80c7d916a261a6c47fcc11a1ffe0
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 07/11/2017
---
# <a name="how-to-troubleshoot-azure-redis-cache"></a><span data-ttu-id="0ffc9-103">Felsökning av Azure Redis-Cache</span><span class="sxs-lookup"><span data-stu-id="0ffc9-103">How to troubleshoot Azure Redis Cache</span></span>
<span data-ttu-id="0ffc9-104">Den här artikeln innehåller anvisningar för felsökning av följande typer av problem med Azure Redis-Cache.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-104">This article provides guidance for troubleshooting the following categories of Azure Redis Cache issues.</span></span>

* <span data-ttu-id="0ffc9-105">[Felsökning på klienten](#client-side-troubleshooting) – det här avsnittet innehåller riktlinjer för att identifiera och lösa problem orsakade av program som ansluter till Azure Redis-Cache.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-105">[Client side troubleshooting](#client-side-troubleshooting) - This section provides guidelines on identifying and resolving issues caused by the application connecting to Azure Redis Cache.</span></span>
* <span data-ttu-id="0ffc9-106">[Felsökning på Server](#server-side-troubleshooting) – det här avsnittet innehåller riktlinjer för att identifiera och lösa problem orsakade på serversidan Azure Redis-Cache.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-106">[Server side troubleshooting](#server-side-troubleshooting) - This section provides guidelines on identifying and resolving issues caused on the Azure Redis Cache server side.</span></span>
* <span data-ttu-id="0ffc9-107">[StackExchange.Redis tidsgränsfel](#stackexchangeredis-timeout-exceptions) – det här avsnittet innehåller information om felsökning av problem när du använder StackExchange.Redis-klienten.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-107">[StackExchange.Redis timeout exceptions](#stackexchangeredis-timeout-exceptions) - This section provides information on troubleshooting issues when using the StackExchange.Redis client.</span></span>

> [!NOTE]
> <span data-ttu-id="0ffc9-108">Flera åtgärder för felsökning i den här guiden innehåller instruktioner för att köra Redis-kommandon och övervaka olika prestandamått.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-108">Several of the troubleshooting steps in this guide include instructions to run Redis commands and monitor various performance metrics.</span></span> <span data-ttu-id="0ffc9-109">Mer information och instruktioner finns i artiklarna i den [ytterligare information](#additional-information) avsnitt.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-109">For more information and instructions, see the articles in the [Additional information](#additional-information) section.</span></span>
> 
> 

## <a name="client-side-troubleshooting"></a><span data-ttu-id="0ffc9-110">Felsökning på klienten</span><span class="sxs-lookup"><span data-stu-id="0ffc9-110">Client side troubleshooting</span></span>
<span data-ttu-id="0ffc9-111">Det här avsnittet beskrivs felsöker problem som uppstår på grund av ett villkor i klientprogrammet.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-111">This section discusses troubleshooting issues that occur because of a condition on the client application.</span></span>

* [<span data-ttu-id="0ffc9-112">Minnesbelastning på klienten</span><span class="sxs-lookup"><span data-stu-id="0ffc9-112">Memory pressure on the client</span></span>](#memory-pressure-on-the-client)
* [<span data-ttu-id="0ffc9-113">Burst av trafik</span><span class="sxs-lookup"><span data-stu-id="0ffc9-113">Burst of traffic</span></span>](#burst-of-traffic)
* [<span data-ttu-id="0ffc9-114">Klienten hög CPU-användning</span><span class="sxs-lookup"><span data-stu-id="0ffc9-114">High client CPU usage</span></span>](#high-client-cpu-usage)
* [<span data-ttu-id="0ffc9-115">Klienten sida bandbredd överskreds</span><span class="sxs-lookup"><span data-stu-id="0ffc9-115">Client Side Bandwidth Exceeded</span></span>](#client-side-bandwidth-exceeded)
* [<span data-ttu-id="0ffc9-116">Storlek för stora frågor och svar</span><span class="sxs-lookup"><span data-stu-id="0ffc9-116">Large Request/Response Size</span></span>](#large-requestresponse-size)
* [<span data-ttu-id="0ffc9-117">Vad hände med data i Redis?</span><span class="sxs-lookup"><span data-stu-id="0ffc9-117">What happened to my data in Redis?</span></span>](#what-happened-to-my-data-in-redis)

### <a name="memory-pressure-on-the-client"></a><span data-ttu-id="0ffc9-118">Minnesbelastning på klienten</span><span class="sxs-lookup"><span data-stu-id="0ffc9-118">Memory pressure on the client</span></span>
#### <a name="problem"></a><span data-ttu-id="0ffc9-119">Problem</span><span class="sxs-lookup"><span data-stu-id="0ffc9-119">Problem</span></span>
<span data-ttu-id="0ffc9-120">Minnesbelastning på klientdatorn leder till att alla typer av problem med prestanda som kan fördröja behandlingen av data som skickades av Redis-instans utan fördröjning.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-120">Memory pressure on the client machine leads to all kinds of performance problems that can delay processing of data that was sent by the Redis instance without any delay.</span></span> <span data-ttu-id="0ffc9-121">När minnesbelastning träffar har systemet vanligtvis sidan data från det fysiska minnet på virtuellt minne som finns på disken.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-121">When memory pressure hits, the system typically has to page data from physical memory to virtual memory which is on disk.</span></span> <span data-ttu-id="0ffc9-122">Detta *sidan felaktigt* medför att avsevärt långsammare.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-122">This *page faulting* causes the system to slow down significantly.</span></span>

#### <a name="measurement"></a><span data-ttu-id="0ffc9-123">Mätning</span><span class="sxs-lookup"><span data-stu-id="0ffc9-123">Measurement</span></span>
1. <span data-ttu-id="0ffc9-124">Övervaka minnesanvändning på datorn för att se till att det inte överstiger tillgängligt minne.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-124">Monitor memory usage on machine to make sure that it does not exceed available memory.</span></span> 
2. <span data-ttu-id="0ffc9-125">Övervaka den `Page Faults/Sec` prestandaräknare.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-125">Monitor the `Page Faults/Sec` performance counter.</span></span> <span data-ttu-id="0ffc9-126">De flesta datorer ska ha vissa sidfel även under normal drift, så bevaka toppar i den här sidan fel prestandaräknaren som motsvarar timeout.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-126">Most systems will have some page faults even during normal operation, so watch for spikes in this page faults performance counter which correspond with timeouts.</span></span>

#### <a name="resolution"></a><span data-ttu-id="0ffc9-127">Lösning</span><span class="sxs-lookup"><span data-stu-id="0ffc9-127">Resolution</span></span>
<span data-ttu-id="0ffc9-128">Uppgradera klienten till en större klient VM-storlek med mer minne eller prova din minne användningsmönster att minska minne consuption.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-128">Upgrade your client to a larger client VM size with more memory or dig into your memory usage patterns to reduce memory consuption.</span></span>

### <a name="burst-of-traffic"></a><span data-ttu-id="0ffc9-129">Burst av trafik</span><span class="sxs-lookup"><span data-stu-id="0ffc9-129">Burst of traffic</span></span>
#### <a name="problem"></a><span data-ttu-id="0ffc9-130">Problem</span><span class="sxs-lookup"><span data-stu-id="0ffc9-130">Problem</span></span>
<span data-ttu-id="0ffc9-131">Belastning av trafik i kombination med dålig `ThreadPool` inställningar kan orsaka försening i bearbetning av data som redan har skickats som Redis-servern men har ännu inte används på klientsidan.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-131">Bursts of traffic combined with poor `ThreadPool` settings can result in delays in processing data already sent by the Redis Server but not yet consumed on the client side.</span></span>

#### <a name="measurement"></a><span data-ttu-id="0ffc9-132">Mätning</span><span class="sxs-lookup"><span data-stu-id="0ffc9-132">Measurement</span></span>
<span data-ttu-id="0ffc9-133">Övervaka hur din `ThreadPool` statistik förändras över tid genom att använda code [som detta](https://github.com/JonCole/SampleCode/blob/master/ThreadPoolMonitor/ThreadPoolLogger.cs).</span><span class="sxs-lookup"><span data-stu-id="0ffc9-133">Monitor how your `ThreadPool` statistics change over time using code [like this](https://github.com/JonCole/SampleCode/blob/master/ThreadPoolMonitor/ThreadPoolLogger.cs).</span></span> <span data-ttu-id="0ffc9-134">Du kan också titta på den `TimeoutException` meddelande från StackExchange.Redis.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-134">You can also look at the `TimeoutException` message from StackExchange.Redis.</span></span> <span data-ttu-id="0ffc9-135">Här är ett exempel:</span><span class="sxs-lookup"><span data-stu-id="0ffc9-135">Here is an example :</span></span>

    System.TimeoutException: Timeout performing EVAL, inst: 8, mgr: Inactive, queue: 0, qu: 0, qs: 0, qc: 0, wr: 0, wq: 0, in: 64221, ar: 0, 
    IOCP: (Busy=6,Free=999,Min=2,Max=1000), WORKER: (Busy=7,Free=8184,Min=2,Max=8191)

<span data-ttu-id="0ffc9-136">Det finns några problem som är intressanta i meddelandet ovan:</span><span class="sxs-lookup"><span data-stu-id="0ffc9-136">In the above message, there are several issues that are interesting:</span></span>

1. <span data-ttu-id="0ffc9-137">Observera att i den `IOCP` avsnitt och `WORKER` avsnitt som du har en `Busy` värde som är större än den `Min` värde.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-137">Notice that in the `IOCP` section and the `WORKER` section you have a `Busy` value that is greater than the `Min` value.</span></span> <span data-ttu-id="0ffc9-138">Detta innebär att din `ThreadPool` inställningarna måste du justera.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-138">This means that your `ThreadPool` settings need adjusting.</span></span>
2. <span data-ttu-id="0ffc9-139">Du kan också se `in: 64221`.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-139">You can also see `in: 64221`.</span></span> <span data-ttu-id="0ffc9-140">Detta anger att 64211 byte har tagits emot i kernel socket lagret men ännu inte har lästs av program (t.ex. StackExchange.Redis).</span><span class="sxs-lookup"><span data-stu-id="0ffc9-140">This indicates that 64211 bytes have been received at the kernel socket layer but haven't yet been read by the application (e.g. StackExchange.Redis).</span></span> <span data-ttu-id="0ffc9-141">Detta innebär oftast att programmet inte läsa data från nätverket så snabbt som servern skickar den till dig.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-141">This typically means that your application isn't reading data from the network as quickly as the server is sending it to you.</span></span>

#### <a name="resolution"></a><span data-ttu-id="0ffc9-142">Lösning</span><span class="sxs-lookup"><span data-stu-id="0ffc9-142">Resolution</span></span>
<span data-ttu-id="0ffc9-143">Konfigurera din [arbetstråd inställningar](https://gist.github.com/JonCole/e65411214030f0d823cb) se till att din trådpoolen skalar snabbt under burst-scenarier.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-143">Configure your [ThreadPool Settings](https://gist.github.com/JonCole/e65411214030f0d823cb) to make sure that your thread pool will scale up quickly under burst scenarios.</span></span>

### <a name="high-client-cpu-usage"></a><span data-ttu-id="0ffc9-144">Klienten hög CPU-användning</span><span class="sxs-lookup"><span data-stu-id="0ffc9-144">High client CPU usage</span></span>
#### <a name="problem"></a><span data-ttu-id="0ffc9-145">Problem</span><span class="sxs-lookup"><span data-stu-id="0ffc9-145">Problem</span></span>
<span data-ttu-id="0ffc9-146">Hög CPU-användning på klienten är en indikation på att systemet inte kan hålla med det arbete som den har ombetts att utföra.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-146">High CPU usage on the client is an indication that the system cannot keep up with the work that it has been asked to perform.</span></span> <span data-ttu-id="0ffc9-147">Det innebär att klienten kan inte bearbeta ett svar från Redis inom rimlig tid även om Redis skickas svaret mycket snabbt.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-147">This means that the client may fail to process a response from Redis in a timely fashion even though Redis sent the response very quickly.</span></span>

#### <a name="measurement"></a><span data-ttu-id="0ffc9-148">Mätning</span><span class="sxs-lookup"><span data-stu-id="0ffc9-148">Measurement</span></span>
<span data-ttu-id="0ffc9-149">Övervaka System Wide processoranvändningen via Azure Portal eller associerade prestandaräknaren.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-149">Monitor the System Wide CPU usage through the Azure Portal or through the associated performance counter.</span></span> <span data-ttu-id="0ffc9-150">Var noga med att inte övervaka *processen* CPU eftersom en enda process kan ha låg CPU-belastning på samma gång övergripande systemet CPU kan vara hög.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-150">Be careful not to monitor *process* CPU because a single process can have low CPU usage at the same time that overall system CPU can be high.</span></span> <span data-ttu-id="0ffc9-151">Håll utkik efter toppar i CPU-användning som motsvarar timeout.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-151">Watch for spikes in CPU usage that correspond with timeouts.</span></span> <span data-ttu-id="0ffc9-152">På grund av hög CPU, du kan också se högt `in: XXX` värdena i `TimeoutException` felmeddelanden som beskrivs i den [Burst av trafik](#burst-of-traffic) avsnitt.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-152">As a result of high CPU, you may also see high `in: XXX` values in `TimeoutException` error messages as described in the [Burst of traffic](#burst-of-traffic) section.</span></span>

> [!NOTE]
> <span data-ttu-id="0ffc9-153">StackExchange.Redis 1.1.603 och senare inkluderar den `local-cpu` mått i `TimeoutException` felmeddelanden.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-153">StackExchange.Redis 1.1.603 and later includes the `local-cpu` metric in `TimeoutException` error messages.</span></span> <span data-ttu-id="0ffc9-154">Se till att du använder den senaste versionen av den [StackExchange.Redis NuGet-paketet](https://www.nuget.org/packages/StackExchange.Redis/).</span><span class="sxs-lookup"><span data-stu-id="0ffc9-154">Ensure you using the latest version of the [StackExchange.Redis NuGet package](https://www.nuget.org/packages/StackExchange.Redis/).</span></span> <span data-ttu-id="0ffc9-155">Det finns fel som ständigt fast i koden för att göra den mer robust för timeout så att den senaste versionen är viktigt.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-155">There are bugs constantly being fixed in the code to make it more robust to timeouts so having the latest version is important.</span></span>
> 
> 

#### <a name="resolution"></a><span data-ttu-id="0ffc9-156">Lösning</span><span class="sxs-lookup"><span data-stu-id="0ffc9-156">Resolution</span></span>
<span data-ttu-id="0ffc9-157">Uppgradera till en större VM-storlek med mer CPU-kapaciteten eller undersöka vad som orsakar processoranvändning.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-157">Upgrade to a larger VM size with more CPU capacity or investigate what is causing CPU spikes.</span></span> 

### <a name="client-side-bandwidth-exceeded"></a><span data-ttu-id="0ffc9-158">Klienten sida bandbredd överskreds</span><span class="sxs-lookup"><span data-stu-id="0ffc9-158">Client side bandwidth exceeded</span></span>
#### <a name="problem"></a><span data-ttu-id="0ffc9-159">Problem</span><span class="sxs-lookup"><span data-stu-id="0ffc9-159">Problem</span></span>
<span data-ttu-id="0ffc9-160">Klientdatorer med olika storlek har begränsningar på hur mycket bandbredd som de finns tillgängliga.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-160">Different sized client machines have limitations on how much network bandwidth they have available.</span></span> <span data-ttu-id="0ffc9-161">Om klienten överskrider den tillgängliga bandbredden, kommer sedan data inte att bearbetas på klientsidan så snabbt som servern skickar den.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-161">If the client exceeds the available bandwidth, then data will not be processed on the client side as quickly as the server is sending it.</span></span> <span data-ttu-id="0ffc9-162">Detta kan leda till timeout.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-162">This can lead to timeouts.</span></span>

#### <a name="measurement"></a><span data-ttu-id="0ffc9-163">Mätning</span><span class="sxs-lookup"><span data-stu-id="0ffc9-163">Measurement</span></span>
<span data-ttu-id="0ffc9-164">Övervaka hur bandbreddsanvändningen förändras över tid genom att använda code [som detta](https://github.com/JonCole/SampleCode/blob/master/BandWidthMonitor/BandwidthLogger.cs).</span><span class="sxs-lookup"><span data-stu-id="0ffc9-164">Monitor how your Bandwidth usage change over time using code [like this](https://github.com/JonCole/SampleCode/blob/master/BandWidthMonitor/BandwidthLogger.cs).</span></span> <span data-ttu-id="0ffc9-165">Observera att den här koden inte kan köras i vissa miljöer med begränsad behörighet (till exempel Azure webbplatser).</span><span class="sxs-lookup"><span data-stu-id="0ffc9-165">Note that this code may not run successfully in some environments with restricted permissions (like Azure web sites).</span></span>

#### <a name="resolution"></a><span data-ttu-id="0ffc9-166">Lösning</span><span class="sxs-lookup"><span data-stu-id="0ffc9-166">Resolution</span></span>
<span data-ttu-id="0ffc9-167">Öka klienten VM-storlek eller minska nätverksbandbredden.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-167">Increase Client VM size or reduce network bandwidth consumption.</span></span>

### <a name="large-requestresponse-size"></a><span data-ttu-id="0ffc9-168">Storlek för stora frågor och svar</span><span class="sxs-lookup"><span data-stu-id="0ffc9-168">Large Request/Response Size</span></span>
#### <a name="problem"></a><span data-ttu-id="0ffc9-169">Problem</span><span class="sxs-lookup"><span data-stu-id="0ffc9-169">Problem</span></span>
<span data-ttu-id="0ffc9-170">Tidsgränser kan medföra att en stor begäran och svar.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-170">A large request/response can cause timeouts.</span></span> <span data-ttu-id="0ffc9-171">Anta exempelvis din timeout-värde konfigureras på din klient är 1 sekund.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-171">As an example, Suppose your timeout value configured on your client is 1 second.</span></span> <span data-ttu-id="0ffc9-172">Ditt program begär två nycklar (t.ex.) ”A” och ”B”) samtidigt (med samma fysiska nätverksanslutningen).</span><span class="sxs-lookup"><span data-stu-id="0ffc9-172">Your application requests two keys (e.g. 'A' and 'B') at the same time (using the same physical network connection).</span></span> <span data-ttu-id="0ffc9-173">De flesta klienter stöder ”Pipelining” begäranden, så att båda begäranden ”A” och ”B” skickas i uppkopplat läge till servern en efter en utan att vänta på svar.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-173">Most clients support "Pipelining" of requests, such that both requests 'A' and 'B' are sent on the wire to the server one after the other without waiting for the responses.</span></span> <span data-ttu-id="0ffc9-174">Servern skickar svar tillbaka i samma ordning.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-174">The server will send the responses back in the same order.</span></span> <span data-ttu-id="0ffc9-175">Om svaret ”A” är stor äta nog den större delen av tidsgräns för efterföljande förfrågningar.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-175">If response 'A' is large enough it can eat up most of the timeout for subsequent requests.</span></span> 

<span data-ttu-id="0ffc9-176">I följande exempel visar det här scenariot.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-176">The following example demonstrates this scenario.</span></span> <span data-ttu-id="0ffc9-177">I det här scenariot begäran ”A” och ”B” skickas snabbt, servern börjar skicka snabbt svar ”A” och ”B”, men på grund av data överföringstiden, ”B” fastna bakom andra begäran och gånger ut trots att servern svarat snabbt.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-177">In this scenario, Request 'A' and 'B' are sent quickly, the server starts sending responses 'A' and 'B' quickly, but because of data transfer times, 'B' get stuck behind the other request and times out even though the server responded quickly.</span></span>

    |-------- 1 Second Timeout (A)----------|
    |-Request A-|
         |-------- 1 Second Timeout (B) ----------|
         |-Request B-|
                |- Read Response A --------|
                                           |- Read Response B-| (**TIMEOUT**)



#### <a name="measurement"></a><span data-ttu-id="0ffc9-178">Mätning</span><span class="sxs-lookup"><span data-stu-id="0ffc9-178">Measurement</span></span>
<span data-ttu-id="0ffc9-179">Det är svårt att mäta.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-179">This is a difficult one to measure.</span></span> <span data-ttu-id="0ffc9-180">Du har i praktiken kan instrumentera din klientkod för att spåra stora begäranden och -svar.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-180">You basically have to instrument your client code to track large requests and responses.</span></span> 

#### <a name="resolution"></a><span data-ttu-id="0ffc9-181">Lösning</span><span class="sxs-lookup"><span data-stu-id="0ffc9-181">Resolution</span></span>
1. <span data-ttu-id="0ffc9-182">Redis är optimerad för ett stort antal små värden i stället för ett par stora värden.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-182">Redis is optimized for a large number of small values, rather than a few large values.</span></span> <span data-ttu-id="0ffc9-183">Den bästa lösningen är att dela upp data till relaterade mindre värden.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-183">The preferred solution is to break up your data into related smaller values.</span></span> <span data-ttu-id="0ffc9-184">Finns det [vad är perfekt värdeintervallet storlek för redis? Är 100KB för stor? ](https://groups.google.com/forum/#!searchin/redis-db/size/redis-db/n7aa2A4DZDs/3OeEPHSQBAAJ) efter information kring varför mindre värden rekommenderas.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-184">See the [What is the ideal value size range for redis? Is 100KB too large?](https://groups.google.com/forum/#!searchin/redis-db/size/redis-db/n7aa2A4DZDs/3OeEPHSQBAAJ) post for details around why smaller values are recommended.</span></span>
2. <span data-ttu-id="0ffc9-185">Öka storleken på den virtuella datorn (för klient och Server för Redis-Cache) för att få högre bandbredd, funktioner, vilket minskar data överföringstiden för större svar.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-185">Increase the size of your VM (for client and Redis Cache Server), to get higher bandwidth capabilities, reducing data transfer times for larger responses.</span></span> <span data-ttu-id="0ffc9-186">Observera att få mer bandbredd på bara servern eller bara på klienten inte kanske är tillräckligt.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-186">Note that getting more bandwidth on just the server or just on the client may not be enough.</span></span> <span data-ttu-id="0ffc9-187">Mät bandbreddsanvändningen och jämför den med funktionerna i storlek för den virtuella datorn du har för närvarande.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-187">Measure your bandwidth usage and compare it to the capabilities of the size of VM you currently have.</span></span>
3. <span data-ttu-id="0ffc9-188">Öka antalet `ConnectionMultiplexer` objekt användning och resursallokering begäranden via olika anslutningar.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-188">Increase the number of `ConnectionMultiplexer` objects you use and round-robin requests over different connections.</span></span>

### <a name="what-happened-to-my-data-in-redis"></a><span data-ttu-id="0ffc9-189">Vad hände med data i Redis?</span><span class="sxs-lookup"><span data-stu-id="0ffc9-189">What happened to my data in Redis?</span></span>
#### <a name="problem"></a><span data-ttu-id="0ffc9-190">Problem</span><span class="sxs-lookup"><span data-stu-id="0ffc9-190">Problem</span></span>
<span data-ttu-id="0ffc9-191">Förväntat för vissa data i min Azure Redis-Cache-instans, men det verkar inte vara det.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-191">I expected for certain data to be in my Azure Redis Cache instance but it didn't seem to be there.</span></span>

#### <a name="resolution"></a><span data-ttu-id="0ffc9-192">Lösning</span><span class="sxs-lookup"><span data-stu-id="0ffc9-192">Resolution</span></span>
<span data-ttu-id="0ffc9-193">Se [vad hände med data i Redis?](https://gist.github.com/JonCole/b6354d92a2d51c141490f10142884ea4#file-whathappenedtomydatainredis-md) för möjliga orsaker och lösningar.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-193">See [What happened to my data in Redis?](https://gist.github.com/JonCole/b6354d92a2d51c141490f10142884ea4#file-whathappenedtomydatainredis-md) for possible causes and resolutions.</span></span>

## <a name="server-side-troubleshooting"></a><span data-ttu-id="0ffc9-194">Felsökning på Server</span><span class="sxs-lookup"><span data-stu-id="0ffc9-194">Server side troubleshooting</span></span>
<span data-ttu-id="0ffc9-195">Det här avsnittet beskrivs felsöker problem som uppstår på grund av ett villkor på servern.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-195">This section discusses troubleshooting issues that occur because of a condition on the cache server.</span></span>

* [<span data-ttu-id="0ffc9-196">Minnesbelastning på servern</span><span class="sxs-lookup"><span data-stu-id="0ffc9-196">Memory Pressure on the server</span></span>](#memory-pressure-on-the-server)
* [<span data-ttu-id="0ffc9-197">Hög processoranvändning / Server att läsa in</span><span class="sxs-lookup"><span data-stu-id="0ffc9-197">High CPU usage / Server Load</span></span>](#high-cpu-usage-server-load)
* [<span data-ttu-id="0ffc9-198">Serverns sida bandbredd överskreds</span><span class="sxs-lookup"><span data-stu-id="0ffc9-198">Server Side Bandwidth Exceeded</span></span>](#server-side-bandwidth-exceeded)

### <a name="memory-pressure-on-the-server"></a><span data-ttu-id="0ffc9-199">Minnesbelastning på servern</span><span class="sxs-lookup"><span data-stu-id="0ffc9-199">Memory Pressure on the server</span></span>
#### <a name="problem"></a><span data-ttu-id="0ffc9-200">Problem</span><span class="sxs-lookup"><span data-stu-id="0ffc9-200">Problem</span></span>
<span data-ttu-id="0ffc9-201">Minnesbelastning på serversidan leder till att alla typer av problem med prestanda som kan fördröja behandlingen av begäran.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-201">Memory pressure on the server side leads to all kinds of performance problems that can delay processing of requests.</span></span> <span data-ttu-id="0ffc9-202">När minnesbelastning träffar har systemet vanligtvis sidan data från det fysiska minnet på virtuellt minne som finns på disken.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-202">When memory pressure hits, the system typically has to page data from physical memory to virtual memory which is on disk.</span></span> <span data-ttu-id="0ffc9-203">Detta *sidan felaktigt* medför att avsevärt långsammare.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-203">This *page faulting* causes the system to slow down significantly.</span></span> <span data-ttu-id="0ffc9-204">Det finns flera möjliga orsaker till detta minnesbelastning:</span><span class="sxs-lookup"><span data-stu-id="0ffc9-204">There are several possible causes of this memory pressure:</span></span> 

1. <span data-ttu-id="0ffc9-205">Du har fyllt i cacheminnet för att full kapacitet med data.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-205">You have filled the cache to full capacity with data.</span></span> 
2. <span data-ttu-id="0ffc9-206">Redis ser hög minnesfragmenteringen - orsakas normalt genom att lagra stora objekt (Redis är optimerad för en små objekt - finns det [vad är perfekt värdeintervallet storlek för redis? Är 100KB för stor? ](https://groups.google.com/forum/#!searchin/redis-db/size/redis-db/n7aa2A4DZDs/3OeEPHSQBAAJ) efter mer information).</span><span class="sxs-lookup"><span data-stu-id="0ffc9-206">Redis is seeing high memory fragmentation - most often caused by storing large objects (Redis is optimized for a small objects - See the [What is the ideal value size range for redis? Is 100KB too large?](https://groups.google.com/forum/#!searchin/redis-db/size/redis-db/n7aa2A4DZDs/3OeEPHSQBAAJ) post for details).</span></span> 

#### <a name="measurement"></a><span data-ttu-id="0ffc9-207">Mätning</span><span class="sxs-lookup"><span data-stu-id="0ffc9-207">Measurement</span></span>
<span data-ttu-id="0ffc9-208">Redis visar två mått som kan hjälpa dig att identifiera problemet.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-208">Redis exposes two metrics that can help you identify this issue.</span></span> <span data-ttu-id="0ffc9-209">Först är `used_memory` och den andra `used_memory_rss`.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-209">The first is `used_memory` and the other is `used_memory_rss`.</span></span> <span data-ttu-id="0ffc9-210">[De här måtten](cache-how-to-monitor.md#available-metrics-and-reporting-intervals) är tillgängliga i Azure-portalen eller via den [Redis INFO](http://redis.io/commands/info) kommando.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-210">[These metrics](cache-how-to-monitor.md#available-metrics-and-reporting-intervals) are available in the Azure Portal or through the [Redis INFO](http://redis.io/commands/info) command.</span></span>

#### <a name="resolution"></a><span data-ttu-id="0ffc9-211">Lösning</span><span class="sxs-lookup"><span data-stu-id="0ffc9-211">Resolution</span></span>
<span data-ttu-id="0ffc9-212">Det finns flera möjliga ändringar som du kan göra för att hålla minnesanvändning felfri:</span><span class="sxs-lookup"><span data-stu-id="0ffc9-212">There are several possible changes that you can make to help keep memory usage healthy:</span></span>

1. <span data-ttu-id="0ffc9-213">[Konfigurera en princip för minne](cache-configure.md#maxmemory-policy-and-maxmemory-reserved) och Ställ in förfallodatum gånger på dina nycklar.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-213">[Configure a memory policy](cache-configure.md#maxmemory-policy-and-maxmemory-reserved) and set expiration times on your keys.</span></span> <span data-ttu-id="0ffc9-214">Observera att det räcker kanske inte om du har fragmentering.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-214">Note that this may not be sufficient if you have fragmentation.</span></span>
2. <span data-ttu-id="0ffc9-215">[Anger värdet maxmemory-reserverade](cache-configure.md#maxmemory-policy-and-maxmemory-reserved) som är tillräckligt stor för att kompensera för minnesfragmentering.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-215">[Configure a maxmemory-reserved value](cache-configure.md#maxmemory-policy-and-maxmemory-reserved) that is large enough to compensate for memory fragmentation.</span></span>
3. <span data-ttu-id="0ffc9-216">Dela upp stora cachelagrade objekten i mindre relaterade objekt.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-216">Break up your large cached objects into smaller related objects.</span></span>
4. <span data-ttu-id="0ffc9-217">[Skala](cache-how-to-scale.md) till en större cachestorlek.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-217">[Scale](cache-how-to-scale.md) to a larger cache size.</span></span>
5. <span data-ttu-id="0ffc9-218">Om du använder en [premium-cache med Redis cluster aktiverat](cache-how-to-premium-clustering.md) kan du [öka antalet shards](cache-how-to-premium-clustering.md#change-the-cluster-size-on-a-running-premium-cache).</span><span class="sxs-lookup"><span data-stu-id="0ffc9-218">If you are using a [premium cache with Redis cluster enabled](cache-how-to-premium-clustering.md) you can [increase the number of shards](cache-how-to-premium-clustering.md#change-the-cluster-size-on-a-running-premium-cache).</span></span>

### <a name="high-cpu-usage--server-load"></a><span data-ttu-id="0ffc9-219">Hög processoranvändning / Server att läsa in</span><span class="sxs-lookup"><span data-stu-id="0ffc9-219">High CPU usage / Server Load</span></span>
#### <a name="problem"></a><span data-ttu-id="0ffc9-220">Problem</span><span class="sxs-lookup"><span data-stu-id="0ffc9-220">Problem</span></span>
<span data-ttu-id="0ffc9-221">Hög CPU-användning kan leda till att klienten kan inte bearbeta ett svar från Redis inom rimlig tid även om Redis skickas svaret mycket snabbt.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-221">High CPU usage can mean that the client side can fail to process a response from Redis in a timely fashion even though Redis sent the response very quickly.</span></span>

#### <a name="measurement"></a><span data-ttu-id="0ffc9-222">Mätning</span><span class="sxs-lookup"><span data-stu-id="0ffc9-222">Measurement</span></span>
<span data-ttu-id="0ffc9-223">Övervaka System Wide processoranvändningen via Azure Portal eller associerade prestandaräknaren.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-223">Monitor the System Wide CPU usage through the Azure Portal or through the associated performance counter.</span></span> <span data-ttu-id="0ffc9-224">Var noga med att inte övervaka *processen* CPU eftersom en enda process kan ha låg CPU-belastning på samma gång övergripande systemet CPU kan vara hög.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-224">Be careful not to monitor *process* CPU because a single process can have low CPU usage at the same time that overall system CPU can be high.</span></span> <span data-ttu-id="0ffc9-225">Håll utkik efter toppar i CPU-användning som motsvarar timeout.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-225">Watch for spikes in CPU usage that correspond with timeouts.</span></span>

#### <a name="resolution"></a><span data-ttu-id="0ffc9-226">Lösning</span><span class="sxs-lookup"><span data-stu-id="0ffc9-226">Resolution</span></span>
<span data-ttu-id="0ffc9-227">[Skala](cache-how-to-scale.md) till en större cache tjänstnivån med mer CPU-kapaciteten eller undersöka vad som orsakar processoranvändning.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-227">[Scale](cache-how-to-scale.md) to a larger cache tier with more CPU capacity or investigate what is causing CPU spikes.</span></span> 

### <a name="server-side-bandwidth-exceeded"></a><span data-ttu-id="0ffc9-228">Serverns sida bandbredd överskreds</span><span class="sxs-lookup"><span data-stu-id="0ffc9-228">Server Side Bandwidth Exceeded</span></span>
#### <a name="problem"></a><span data-ttu-id="0ffc9-229">Problem</span><span class="sxs-lookup"><span data-stu-id="0ffc9-229">Problem</span></span>
<span data-ttu-id="0ffc9-230">Cacheinstanser med olika storlek har begränsningar på hur mycket bandbredd som de finns tillgängliga.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-230">Different sized cache instances have limitations on how much network bandwidth they have available.</span></span> <span data-ttu-id="0ffc9-231">Om servern överskrider den tillgängliga bandbredden, kommer data inte skickas till klienten som snabbt.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-231">If the server exceeds the available bandwidth, then data will not be sent to the client as quickly.</span></span> <span data-ttu-id="0ffc9-232">Detta kan leda till timeout.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-232">This can lead to timeouts.</span></span>

#### <a name="measurement"></a><span data-ttu-id="0ffc9-233">Mätning</span><span class="sxs-lookup"><span data-stu-id="0ffc9-233">Measurement</span></span>
<span data-ttu-id="0ffc9-234">Du kan övervaka den `Cache Read` mått som avser mängden data har lästs från cacheminnet i megabyte per sekund (MB/s) under det angivna intervallet för rapportering.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-234">You can monitor the `Cache Read` metric, which is the amount of data read from the cache in Megabytes per second (MB/s) during the specified reporting interval.</span></span> <span data-ttu-id="0ffc9-235">Det här värdet motsvarar nätverksbandbredden som används av det här cacheminnet.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-235">This value corresponds to the network bandwidth used by this cache.</span></span> <span data-ttu-id="0ffc9-236">Om du vill konfigurera aviseringar för server side nätverket bandbreddsgränser, kan du skapa dem med hjälp av det här `Cache Read` räknaren.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-236">If you want to set up alerts for server side network bandwidth limits, you can create them using this `Cache Read` counter.</span></span> <span data-ttu-id="0ffc9-237">Jämför din avläsningar med värdena i [tabellen](cache-faq.md#cache-performance) för observerade bandbreddsgränser för olika cache priser nivåer och storlekar.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-237">Compare your readings with the values in [this table](cache-faq.md#cache-performance) for the observed bandwidth limits for various cache pricing tiers and sizes.</span></span>

#### <a name="resolution"></a><span data-ttu-id="0ffc9-238">Lösning</span><span class="sxs-lookup"><span data-stu-id="0ffc9-238">Resolution</span></span>
<span data-ttu-id="0ffc9-239">Om du är konsekvent nära observerade Maximal bandbredd för storleken på din prisnivå nivå och cache kan du överväga att [skalning](cache-how-to-scale.md) till en prisnivå nivå eller storlek som har större nätverksbandbredd med värdena i [tabellen](cache-faq.md#cache-performance)som en vägledning.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-239">If you are consistently near the observed maximum bandwidth for your pricing tier and cache size, consider [scaling](cache-how-to-scale.md) to a pricing tier or size that has greater network bandwidth, using the values in [this table](cache-faq.md#cache-performance) as a guide.</span></span>

## <a name="stackexchangeredis-timeout-exceptions"></a><span data-ttu-id="0ffc9-240">StackExchange.Redis tidsgränsfel</span><span class="sxs-lookup"><span data-stu-id="0ffc9-240">StackExchange.Redis timeout exceptions</span></span>
<span data-ttu-id="0ffc9-241">StackExchange.Redis använder en konfigurationsinställning namngivna `synctimeout` för synkrona åtgärder som har ett standardvärde på 1 000 ms.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-241">StackExchange.Redis uses a configuration setting named `synctimeout` for synchronous operations which has a default value  of 1000 ms.</span></span> <span data-ttu-id="0ffc9-242">Om ett synkrona anrop inte slutförs inom den angivna tiden genererar StackExchange.Redis klienten ett timeout-fel som liknar följande exempel.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-242">If a synchronous call doesn’t complete in the stipulated time, the StackExchange.Redis client throws a timeout error similar to the following example.</span></span>

    System.TimeoutException: Timeout performing MGET 2728cc84-58ae-406b-8ec8-3f962419f641, inst: 1,mgr: Inactive, queue: 73, qu=6, qs=67, qc=0, wr=1/1, in=0/0 IOCP: (Busy=6, Free=999, Min=2,Max=1000), WORKER (Busy=7,Free=8184,Min=2,Max=8191)


<span data-ttu-id="0ffc9-243">Det här felmeddelandet innehåller mått som kan hjälpa dig att peka orsaken och möjlig lösning av problemet.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-243">This error message contains metrics that can help point you to the cause and possible resolution of the issue.</span></span> <span data-ttu-id="0ffc9-244">Följande tabell innehåller information om fel meddelande mått.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-244">The following table contains details about the error message metrics.</span></span>

| <span data-ttu-id="0ffc9-245">Fel meddelande mått</span><span class="sxs-lookup"><span data-stu-id="0ffc9-245">Error message metric</span></span> | <span data-ttu-id="0ffc9-246">Information</span><span class="sxs-lookup"><span data-stu-id="0ffc9-246">Details</span></span> |
| --- | --- |
| <span data-ttu-id="0ffc9-247">PL</span><span class="sxs-lookup"><span data-stu-id="0ffc9-247">inst</span></span> |<span data-ttu-id="0ffc9-248">I det senaste tidsintervallet: 0-kommandon som har utfärdats.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-248">In the last time slice: 0 commands have been issued</span></span> |
| <span data-ttu-id="0ffc9-249">hanterare av</span><span class="sxs-lookup"><span data-stu-id="0ffc9-249">mgr</span></span> |<span data-ttu-id="0ffc9-250">Hanteraren för ingång utförs `socket.select` så att den frågar OS att indikera en socket som har att göra; i princip: läsaren inte aktivt lästes från nätverket eftersom det inte tror att det finns ingenting att göra</span><span class="sxs-lookup"><span data-stu-id="0ffc9-250">The socket manager is performing `socket.select` which means it is asking the OS to indicate a socket that has something to do; basically: the reader is not actively reading from the network because it doesn't think there is anything to do</span></span> |
| <span data-ttu-id="0ffc9-251">Kön</span><span class="sxs-lookup"><span data-stu-id="0ffc9-251">queue</span></span> |<span data-ttu-id="0ffc9-252">Totalt antal åtgärder pågående har 73</span><span class="sxs-lookup"><span data-stu-id="0ffc9-252">There are 73 total in-progress operations</span></span> |
| <span data-ttu-id="0ffc9-253">citattecken kring</span><span class="sxs-lookup"><span data-stu-id="0ffc9-253">qu</span></span> |<span data-ttu-id="0ffc9-254">6 pågående åtgärder i ej skickade kön och ännu inte har skrivits till nätverkets utgående</span><span class="sxs-lookup"><span data-stu-id="0ffc9-254">6 of the in-progress operations are in the unsent queue and have not yet been written to the outbound network</span></span> |
| <span data-ttu-id="0ffc9-255">Qs</span><span class="sxs-lookup"><span data-stu-id="0ffc9-255">qs</span></span> |<span data-ttu-id="0ffc9-256">67 han pågående åtgärder har skickats till servern, men svaret är inte tillgänglig ännu.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-256">67 of he in-progress operations have been sent to the server but a response is not yet available.</span></span> <span data-ttu-id="0ffc9-257">Svaret kan vara `Not yet sent by the server` eller`sent by the server but not yet processed by the client.`</span><span class="sxs-lookup"><span data-stu-id="0ffc9-257">The response could be `Not yet sent by the server` or `sent by the server but not yet processed by the client.`</span></span> |
| <span data-ttu-id="0ffc9-258">QC</span><span class="sxs-lookup"><span data-stu-id="0ffc9-258">qc</span></span> |<span data-ttu-id="0ffc9-259">0 av pågående åtgärder har sett svar men ännu inte har markerats som slutförd på grund av att vänta på slutförande loop</span><span class="sxs-lookup"><span data-stu-id="0ffc9-259">0 of the in-progress operations have seen replies but have not yet been marked as complete due to waiting on the completion loop</span></span> |
| <span data-ttu-id="0ffc9-260">WR</span><span class="sxs-lookup"><span data-stu-id="0ffc9-260">wr</span></span> |<span data-ttu-id="0ffc9-261">Det finns en aktiv skrivaren (d.v.s. 6 ej skickade begäranden inte ignoreras) byte/activewriters</span><span class="sxs-lookup"><span data-stu-id="0ffc9-261">There is an active writer (meaning the 6 unsent requests are not being ignored) bytes/activewriters</span></span> |
| <span data-ttu-id="0ffc9-262">i</span><span class="sxs-lookup"><span data-stu-id="0ffc9-262">in</span></span> |<span data-ttu-id="0ffc9-263">Det finns ingen aktiv läsare och noll byte är tillgängliga för att läsa på NIC byte/activereaders</span><span class="sxs-lookup"><span data-stu-id="0ffc9-263">There are no active readers and zero bytes are available to be read on the NIC bytes/activereaders</span></span> |

### <a name="steps-to-investigate"></a><span data-ttu-id="0ffc9-264">Steg för att undersöka</span><span class="sxs-lookup"><span data-stu-id="0ffc9-264">Steps to investigate</span></span>
1. <span data-ttu-id="0ffc9-265">Som bästa praxis se till att använder du följande mönster för att ansluta när du använder StackExchange.Redis-klienten.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-265">As a best practice make sure you are using the following pattern to connect when using the StackExchange.Redis client.</span></span>

    ```c#
    private static Lazy<ConnectionMultiplexer> lazyConnection = new Lazy<ConnectionMultiplexer>(() =>
    {
        return ConnectionMultiplexer.Connect("cachename.redis.cache.windows.net,abortConnect=false,ssl=true,password=...");
    
    });
    
    public static ConnectionMultiplexer Connection
    {
        get
        {
            return lazyConnection.Value;
        }
    }
    ````

    <span data-ttu-id="0ffc9-266">Mer information finns i [ansluta till cacheminnet med StackExchange.Redis](cache-dotnet-how-to-use-azure-redis-cache.md#connect-to-the-cache).</span><span class="sxs-lookup"><span data-stu-id="0ffc9-266">For more information, see [Connect to the cache using StackExchange.Redis](cache-dotnet-how-to-use-azure-redis-cache.md#connect-to-the-cache).</span></span>

1. <span data-ttu-id="0ffc9-267">Se till att din Azure Redis-Cache och klientprogrammet finns i samma region i Azure.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-267">Ensure that your Azure Redis Cache and the client application are in the same region in Azure.</span></span> <span data-ttu-id="0ffc9-268">Till exempel du kanske att få timeout när ditt cacheminne i östra USA men klienten finns i USA, västra och begäran inte slutförs inom den `synctimeout` intervall eller så kan du får ett timeout när du felsöker från lokala utvecklingsdatorn.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-268">For example, you might be getting timeouts when your cache is in East US but the client is in West US and the request doesn't complete within the `synctimeout` interval or you might be getting timeouts when you are debugging from your local development machine.</span></span> 
   
    <span data-ttu-id="0ffc9-269">Det har bör ha cacheminnet och klienten i samma Azure-region.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-269">It’s highly recommended to have the cache and in the client in the same Azure region.</span></span> <span data-ttu-id="0ffc9-270">Om du har ett scenario som innehåller mellan region anrop, bör du ange den `synctimeout` intervall för ett högre värde än standardvärdet 1 000 ms-intervall genom att inkludera en `synctimeout` egenskap i anslutningssträngen.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-270">If you have a scenario that includes cross region calls, you should set the `synctimeout` interval to a value higher than the default 1000 ms interval by including a `synctimeout` property in the connection string.</span></span> <span data-ttu-id="0ffc9-271">I följande exempel visas en StackExchange.Redis cache anslutning sträng fragment med en `synctimeout` av 2000 ms.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-271">The following example shows a StackExchange.Redis cache connection string snippet with a `synctimeout` of 2000 ms.</span></span>
   
        synctimeout=2000,cachename.redis.cache.windows.net,abortConnect=false,ssl=true,password=...
2. <span data-ttu-id="0ffc9-272">Se till att du använder den senaste versionen av den [StackExchange.Redis NuGet-paketet](https://www.nuget.org/packages/StackExchange.Redis/).</span><span class="sxs-lookup"><span data-stu-id="0ffc9-272">Ensure you using the latest version of the [StackExchange.Redis NuGet package](https://www.nuget.org/packages/StackExchange.Redis/).</span></span> <span data-ttu-id="0ffc9-273">Det finns fel som ständigt fast i koden för att göra den mer robust för timeout så att den senaste versionen är viktigt.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-273">There are bugs constantly being fixed in the code to make it more robust to timeouts so having the latest version is important.</span></span>
3. <span data-ttu-id="0ffc9-274">Om det finns begäranden som är komma bundna av bandbreddsbegränsningar på servern eller klienten, kan det ta längre tid att slutföra och därmed orsakar timeout.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-274">If there are requests that are getting bound by bandwidth limitations on the server or client, it will take longer for them to complete and thereby cause timeouts.</span></span> <span data-ttu-id="0ffc9-275">Om det finns en tidsgräns på grund av nätverkets bandbredd på servern, se [Server side bandbredd överskridit](#server-side-bandwidth-exceeded).</span><span class="sxs-lookup"><span data-stu-id="0ffc9-275">To see if your timeout is due to network bandwidth on the server, see [Server side bandwidth exceeded](#server-side-bandwidth-exceeded).</span></span> <span data-ttu-id="0ffc9-276">Om det finns en tidsgräns på grund av nätverksbandbredd för klienten, se [klienten sida bandbredd överskridit](#client-side-bandwidth-exceeded).</span><span class="sxs-lookup"><span data-stu-id="0ffc9-276">To see if your timeout is due to client network bandwidth, see [Client side bandwidth exceeded](#client-side-bandwidth-exceeded).</span></span>
4. <span data-ttu-id="0ffc9-277">Är du komma CPU bundna på servern eller på klienten?</span><span class="sxs-lookup"><span data-stu-id="0ffc9-277">Are you getting CPU bound on the server or on the client?</span></span>
   
   * <span data-ttu-id="0ffc9-278">Kontrollera om du är komma bundna av processor på klienten vilket kan leda till begäran om att inte behandlas inom den `synctimeout` intervall, vilket kan orsaka en tidsgräns.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-278">Check if you are getting bound by CPU on your client which could cause the request to not be processed within the `synctimeout` interval, thus causing a timeout.</span></span> <span data-ttu-id="0ffc9-279">Flytta till en större klienten eller distribuerar belastningen kan hjälpa till att styra.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-279">Moving to a larger client size or distributing the load can help to control this.</span></span> 
   * <span data-ttu-id="0ffc9-280">Kontrollera om du får CPU bunden på servern genom att övervaka den `CPU` [cachelagra prestanda mått](cache-how-to-monitor.md#available-metrics-and-reporting-intervals).</span><span class="sxs-lookup"><span data-stu-id="0ffc9-280">Check if you are getting CPU bound on the server by monitoring the `CPU` [cache performance metric](cache-how-to-monitor.md#available-metrics-and-reporting-intervals).</span></span> <span data-ttu-id="0ffc9-281">Begäranden som kommer medan Redis CPU-bundna kan orsaka dessa begäranden för att timeout.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-281">Requests coming in while Redis is CPU bound can cause those requests to timeout.</span></span> <span data-ttu-id="0ffc9-282">För att lösa det kan du fördela belastningen över flera delar i premium-cache eller uppgradera till en större storlek eller prisnivå.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-282">To address this you can distribute the load across multiple shards in a premium cache, or upgrade to a larger size or pricing tier.</span></span> <span data-ttu-id="0ffc9-283">Mer information finns i [servern sida bandbredd överskridit](#server-side-bandwidth-exceeded).</span><span class="sxs-lookup"><span data-stu-id="0ffc9-283">For more information, see [Server Side Bandwidth Exceeded](#server-side-bandwidth-exceeded).</span></span>
5. <span data-ttu-id="0ffc9-284">Finns det kommandon som tar lång tid att bearbeta på servern?</span><span class="sxs-lookup"><span data-stu-id="0ffc9-284">Are there commands taking long time to process on the server?</span></span> <span data-ttu-id="0ffc9-285">Tidskrävande kommandon som tar lång tid att bearbeta på redis-servern kan orsaka timeout.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-285">Long running commands that are taking long time to process on the redis-server can cause timeouts.</span></span> <span data-ttu-id="0ffc9-286">Är några exempel på tidskrävande kommandon `mget` med ett stort antal nycklar, `keys *` eller felaktiga lua skript.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-286">Some examples of long running commands are `mget` with large numbers of keys, `keys *` or poorly written lua scripts.</span></span> <span data-ttu-id="0ffc9-287">Du kan ansluta till din Azure Redis-Cache-instans med hjälp av redis-cli-klienten eller använda den [Redis-konsolen](cache-configure.md#redis-console) och kör den [SlowLog](http://redis.io/commands/slowlog) kommando för att se om det finns begäranden tar längre tid än förväntat.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-287">You can connect to your Azure Redis Cache instance using the redis-cli client or use the [Redis Console](cache-configure.md#redis-console) and run the [SlowLog](http://redis.io/commands/slowlog) command to see if there are requests taking longer than expected.</span></span> <span data-ttu-id="0ffc9-288">Redis-servern och StackExchange.Redis är optimerad för många små begäranden i stället för färre stora begäranden.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-288">Redis Server and StackExchange.Redis are optimized for many small requests rather than fewer large requests.</span></span> <span data-ttu-id="0ffc9-289">Dela upp dina data i mindre segment kan du förbättra här saker.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-289">Splitting your data into smaller chunks may improve things here.</span></span> 
   
    <span data-ttu-id="0ffc9-290">Information om hur du ansluter till Azure Redis-Cache SSL-slutpunkten med redis-cli och stunnel finns i [om ASP.NET Sessionstillståndsprovider för Redis-förhandsversionen](http://blogs.msdn.com/b/webdev/archive/2014/05/12/announcing-asp-net-session-state-provider-for-redis-preview-release.aspx) blogginlägg.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-290">For information on connecting to the Azure Redis Cache SSL endpoint using redis-cli and stunnel, see the [Announcing ASP.NET Session State Provider for Redis Preview Release](http://blogs.msdn.com/b/webdev/archive/2014/05/12/announcing-asp-net-session-state-provider-for-redis-preview-release.aspx) blog post.</span></span> <span data-ttu-id="0ffc9-291">Mer information finns i [SlowLog](http://redis.io/commands/slowlog).</span><span class="sxs-lookup"><span data-stu-id="0ffc9-291">For more information, see [SlowLog](http://redis.io/commands/slowlog).</span></span>
6. <span data-ttu-id="0ffc9-292">Hög Redis-serverbelastning kan orsaka timeout.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-292">High Redis server load can cause timeouts.</span></span> <span data-ttu-id="0ffc9-293">Du kan övervaka serverbelastningen genom att övervaka den `Redis Server Load` [cachelagra prestanda mått](cache-how-to-monitor.md#available-metrics-and-reporting-intervals).</span><span class="sxs-lookup"><span data-stu-id="0ffc9-293">You can monitor the server load by monitoring the `Redis Server Load` [cache performance metric](cache-how-to-monitor.md#available-metrics-and-reporting-intervals).</span></span> <span data-ttu-id="0ffc9-294">En serverbelastningen 100 (högsta värde) innebär att redis-servern har varit upptagen med ingen inaktivitetstid bearbetning av begäranden.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-294">A server load of 100 (maximum value) signifies that the redis server has been busy, with no idle time, processing requests.</span></span> <span data-ttu-id="0ffc9-295">Om du vill se om vissa begäranden tar upp alla funktioner för server, kör du kommandot SlowLog enligt beskrivningen i föregående stycke.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-295">To see if certain requests are taking up all of the server capability, run the SlowLog command, as described in the previous paragraph.</span></span> <span data-ttu-id="0ffc9-296">Mer information finns i [hög processoranvändning / Server att läsa in](#high-cpu-usage-server-load).</span><span class="sxs-lookup"><span data-stu-id="0ffc9-296">For more information, see [High CPU usage / Server Load](#high-cpu-usage-server-load).</span></span>
7. <span data-ttu-id="0ffc9-297">Var det andra händelser på klientsidan som kan ha orsakat ett nätverk blip?</span><span class="sxs-lookup"><span data-stu-id="0ffc9-297">Was there any other event on the client side that could have caused a network blip?</span></span> <span data-ttu-id="0ffc9-298">Kontrollera på klienten (webb, arbetsrollen eller en Iaas VM) om det fanns en händelse som skala antalet instanser av klient upp eller ned eller distribuerar en ny version av klienten eller Autoskala aktiveras? I våra tester som vi har hittat att Autoskala eller skala upp/ned kan utgående nätverksanslutningen gå förlorade i några sekunder.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-298">Check on the client (web, worker role or an Iaas VM) if there was an event like scaling the number of client instances up or down, or deploying a new version of the client or auto-scale is enabled?In our testing we have found that autoscale or scaling up/down can cause outbound network connectivity can be lost for several seconds.</span></span> <span data-ttu-id="0ffc9-299">StackExchange.Redis koden är känsligt för sådana händelser och återupprättas.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-299">StackExchange.Redis code is resilient to such events and will reconnect.</span></span> <span data-ttu-id="0ffc9-300">Under den här tiden på ny anslutning kan alla förfrågningar i kön timeout.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-300">During this time of re-connection any requests in the queue can time out.</span></span>
8. <span data-ttu-id="0ffc9-301">Har det skett en stor begäran föregående flera små begäran till Redis-Cache som gjort timeout?</span><span class="sxs-lookup"><span data-stu-id="0ffc9-301">Was there a big request preceding several small requests to the Redis Cache that timed out?</span></span> <span data-ttu-id="0ffc9-302">Parametern `qs` i felet meddelandet anger hur många begäranden har skickats från klienten till servern, men har ännu inte bearbetat svaret.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-302">The parameter `qs` in the error message tells you how many requests were sent from the client to the server, but have not yet processed a response.</span></span> <span data-ttu-id="0ffc9-303">Det här värdet kan hålla växer eftersom StackExchange.Redis använder en TCP-anslutning och kan endast läsa ett svar i taget.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-303">This value can keep growing because StackExchange.Redis uses a single TCP connection and can only read one response at a time.</span></span> <span data-ttu-id="0ffc9-304">Även om den första åtgärden tidsgränsen avbryts inte de data som skickas till och från servern och andra begäranden blockeras tills det är klart, orsakar timeout.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-304">Even though the first operation timed out, it does not stop the data being sent to/from the server, and other requests are blocked until this is finished, causing time outs.</span></span> <span data-ttu-id="0ffc9-305">En lösning är att minimera risken för timeout genom att säkerställa att din cache är tillräckligt stor för din arbetsbelastning och dela upp stora värden i mindre segment.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-305">One solution is to minimize the chance of timeouts by ensuring that your cache is large enough for your workload and splitting large values into smaller chunks.</span></span> <span data-ttu-id="0ffc9-306">En annan möjlig lösning är att använda en pool av `ConnectionMultiplexer` objekt i din klient och Välj minst inlästa `ConnectionMultiplexer` när du skickar en ny begäran.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-306">Another possible solution is to use a pool of `ConnectionMultiplexer` objects in your client, and choose the least loaded `ConnectionMultiplexer` when sending a new request.</span></span> <span data-ttu-id="0ffc9-307">Detta bör förhindra att en enda tidsgräns orsakar övriga förfrågningar till också timeout.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-307">This should prevent a single timeout from causing other requests to also timeout.</span></span>
9. <span data-ttu-id="0ffc9-308">Om du använder `RedisSessionStateprovider`, se till att du har angett korrekt gör timeout.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-308">If you are using `RedisSessionStateprovider`, ensure you have set the retry timeout correctly.</span></span> <span data-ttu-id="0ffc9-309">`retrytimeoutInMilliseconds`bör vara högre än `operationTimeoutinMilliseonds`, annars inga nya försök utförs.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-309">`retrytimeoutInMilliseconds` should be higher than `operationTimeoutinMilliseonds`, otherwise no retries will occur.</span></span> <span data-ttu-id="0ffc9-310">I följande exempel `retrytimeoutInMilliseconds` är inställd på 3000.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-310">In the following example `retrytimeoutInMilliseconds` is set to 3000.</span></span> <span data-ttu-id="0ffc9-311">Mer information finns i [ASP.NET-Sessionstillståndsprovider för Azure Redis-Cache](cache-aspnet-session-state-provider.md) och [hur du använder konfigurationsparametrarna för Sessionstillståndsprovider och Utdatacacheprovider](https://github.com/Azure/aspnet-redis-providers/wiki/Configuration).</span><span class="sxs-lookup"><span data-stu-id="0ffc9-311">For more information, see [ASP.NET Session State Provider for Azure Redis Cache](cache-aspnet-session-state-provider.md) and [How to use the configuration parameters of Session State Provider and Output Cache Provider](https://github.com/Azure/aspnet-redis-providers/wiki/Configuration).</span></span>

    <add
      name="AFRedisCacheSessionStateProvider"
      type="Microsoft.Web.Redis.RedisSessionStateProvider"
      host="enbwcache.redis.cache.windows.net"
      port="6380"
      accessKey="…"
      ssl="true"
      databaseId="0"
      applicationName="AFRedisCacheSessionState"
      connectionTimeoutInMilliseconds = "5000"
      operationTimeoutInMilliseconds = "1000"
      retryTimeoutInMilliseconds="3000" />


1. <span data-ttu-id="0ffc9-312">Kontrollera minnesanvändning på Azure Redis-Cache-servern genom att [övervakning](cache-how-to-monitor.md#available-metrics-and-reporting-intervals) `Used Memory RSS` och `Used Memory`.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-312">Check memory usage on the Azure Redis Cache server by [monitoring](cache-how-to-monitor.md#available-metrics-and-reporting-intervals) `Used Memory RSS` and `Used Memory`.</span></span> <span data-ttu-id="0ffc9-313">Om en princip för borttagning är på plats, Redis börjar ta bort nycklar när `Used_Memory` når cachestorleken.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-313">If an eviction policy is in place, Redis starts evicting keys when `Used_Memory` reaches the cache size.</span></span> <span data-ttu-id="0ffc9-314">Vi rekommenderar `Used Memory RSS` ska bara vara något högre än `Used memory`.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-314">Ideally, `Used Memory RSS` should be only slightly higher than `Used memory`.</span></span> <span data-ttu-id="0ffc9-315">En stor skillnad innebär att det minnesfragmenteringen (interna eller externa.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-315">A large difference means there is memory fragmentation (internal or external.</span></span> <span data-ttu-id="0ffc9-316">När `Used Memory RSS` är mindre än `Used Memory`, innebär det en del av cache-minnet har bytts av operativsystemet.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-316">When `Used Memory RSS` is less than `Used Memory`, it means part of the cache memory has been swapped  by the operating system.</span></span> <span data-ttu-id="0ffc9-317">Om detta inträffar kan du förväntar dig några betydande fördröjningar.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-317">If this occurs you can expect some significant latencies.</span></span> <span data-ttu-id="0ffc9-318">Eftersom Redis inte har kontroll över hur dess allokeringar mappas till minnessidor som hög `Used Memory RSS` beror ofta på en topp i minnesanvändning.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-318">Because Redis does not have control over how its allocations are mapped to memory pages, high `Used Memory RSS` is often the result of a spike in memory usage.</span></span> <span data-ttu-id="0ffc9-319">När Redis Frigör minne, minnet ges tillbaka till allokeraren och allokeraren kanske eller kanske inte ger minnet tillbaka till systemet.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-319">When Redis frees memory, the memory is given back to the allocator, and the allocator may or may not give the memory back to the system.</span></span> <span data-ttu-id="0ffc9-320">Det kan finnas en avvikelse mellan det `Used Memory` förbrukning av värdet och minne som rapporteras av operativsystemet.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-320">There may be a discrepancy between the `Used Memory` value and memory consumption as reported by the operating system.</span></span> <span data-ttu-id="0ffc9-321">Du kanske på grund av faktumet minne används och publicerat som Redis, men inte angivna tillbaka till systemet.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-321">It may be due to the fact memory has been used and released by Redis, but not given back to the system.</span></span> <span data-ttu-id="0ffc9-322">Du kan utföra följande steg för att minimera minnesproblem.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-322">To help mitigate memory issues you can perform the following steps.</span></span>
   
   * <span data-ttu-id="0ffc9-323">Uppgradera cachen till en större storlek så att du inte kör visa begränsningar i minnet i systemet.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-323">Upgrade the cache to a larger size so that you are not running up against memory limitations on the system.</span></span>
   * <span data-ttu-id="0ffc9-324">Ange förfallodatum gånger på nycklarna så att äldre värden har avlägsnats proaktivt.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-324">Set expiration times on the keys so that older values are evicted proactively.</span></span>
   * <span data-ttu-id="0ffc9-325">Övervakare av den `used_memory_rss` cachelagra mått.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-325">Monitor the the `used_memory_rss` cache metric.</span></span> <span data-ttu-id="0ffc9-326">När det här värdet närmar sig sin cachens storlek, troligen kommer att starta ser prestandaproblem.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-326">When this value approaches the size of their cache, you are likely to start seeing performance issues.</span></span> <span data-ttu-id="0ffc9-327">Distribuera data över flera delar om du använder en premium-cache, eller uppgradera till en större cachestorlek.</span><span class="sxs-lookup"><span data-stu-id="0ffc9-327">Distribute the data across multiple shards if you are using a premium cache, or upgrade to a larger cache size.</span></span>
   
   <span data-ttu-id="0ffc9-328">Mer information finns i [minnesbelastning på servern](#memory-pressure-on-the-server).</span><span class="sxs-lookup"><span data-stu-id="0ffc9-328">For more information, see [Memory Pressure on the server](#memory-pressure-on-the-server).</span></span>

## <a name="additional-information"></a><span data-ttu-id="0ffc9-329">Ytterligare information</span><span class="sxs-lookup"><span data-stu-id="0ffc9-329">Additional information</span></span>
* [<span data-ttu-id="0ffc9-330">Vilket erbjudande och vilken storlek ska jag använda för Redis-cache?</span><span class="sxs-lookup"><span data-stu-id="0ffc9-330">What Redis Cache offering and size should I use?</span></span>](cache-faq.md#what-redis-cache-offering-and-size-should-i-use)
* [<span data-ttu-id="0ffc9-331">Hur kan mäta och testa prestanda för Mina cache?</span><span class="sxs-lookup"><span data-stu-id="0ffc9-331">How can I benchmark and test the performance of my cache?</span></span>](cache-faq.md#how-can-i-benchmark-and-test-the-performance-of-my-cache)
* [<span data-ttu-id="0ffc9-332">Hur kör Redis kommandon?</span><span class="sxs-lookup"><span data-stu-id="0ffc9-332">How can I run Redis commands?</span></span>](cache-faq.md#how-can-i-run-redis-commands)
* [<span data-ttu-id="0ffc9-333">Hur du övervakar Azure Redis-Cache</span><span class="sxs-lookup"><span data-stu-id="0ffc9-333">How to monitor Azure Redis Cache</span></span>](cache-how-to-monitor.md)

