---
title: aaaCopy aktivitet prestanda och prestandajustering guiden | Microsoft Docs
description: "Läs mer om viktiga faktorer som påverkar hello prestanda för flytt av data i Azure Data Factory när du använder Kopieringsaktiviteten."
services: data-factory
documentationcenter: 
author: linda33wj
manager: jhubbard
editor: monicar
ms.assetid: 4b9a6a4f-8cf5-4e0a-a06f-8133a2b7bc58
ms.service: data-factory
ms.workload: data-services
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 08/10/2017
ms.author: jingwang
ms.openlocfilehash: b0fb5a76c34752d07e8ddfffbb799a05fb5d6be6
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 10/06/2017
---
# <a name="copy-activity-performance-and-tuning-guide"></a><span data-ttu-id="d5c9f-103">Kopiera prestandajustering guide och prestanda för aktiviteten</span><span class="sxs-lookup"><span data-stu-id="d5c9f-103">Copy Activity performance and tuning guide</span></span>
<span data-ttu-id="d5c9f-104">Azure Data Factory-Kopieringsaktiviteten levererar en förstklassig säker, tillförlitlig och högpresterande datainläsning lösning.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-104">Azure Data Factory Copy Activity delivers a first-class secure, reliable, and high-performance data loading solution.</span></span> <span data-ttu-id="d5c9f-105">Det kan du toocopy flera terabyte data varje dag i omfattande olika molnet och lokala datalager.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-105">It enables you toocopy tens of terabytes of data every day across a rich variety of cloud and on-premises data stores.</span></span> <span data-ttu-id="d5c9f-106">Blixtsnabb snabb prestanda för datainläsning är viktiga tooensure kan du fokusera på hello core ”big data” problem: skapa lösningar för avancerade analyser och hämtar djupa insikter från alla data.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-106">Blazing-fast data loading performance is key tooensure you can focus on hello core “big data” problem: building advanced analytics solutions and getting deep insights from all that data.</span></span>

<span data-ttu-id="d5c9f-107">Azure tillhandahåller en uppsättning företagsklass lösningar för lagring och data warehouse och Kopieringsaktivitet erbjuder en mycket optimerade datainläsning enkelt tooconfigure och konfigurera.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-107">Azure provides a set of enterprise-grade data storage and data warehouse solutions, and Copy Activity offers a highly optimized data loading experience that is easy tooconfigure and set up.</span></span> <span data-ttu-id="d5c9f-108">Med bara en enda kopia aktivitet, kan du få:</span><span class="sxs-lookup"><span data-stu-id="d5c9f-108">With just a single copy activity, you can achieve:</span></span>

* <span data-ttu-id="d5c9f-109">Läser in data i **Azure SQL Data Warehouse** på **1,2 Gbit/s**.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-109">Loading data into **Azure SQL Data Warehouse** at **1.2 GBps**.</span></span> <span data-ttu-id="d5c9f-110">En genomgång med ett användningsfall finns [läsa in 1 TB i Azure SQL Data Warehouse under 15 minuter med Azure Data Factory](data-factory-load-sql-data-warehouse.md).</span><span class="sxs-lookup"><span data-stu-id="d5c9f-110">For a walkthrough with a use case, see [Load 1 TB into Azure SQL Data Warehouse under 15 minutes with Azure Data Factory](data-factory-load-sql-data-warehouse.md).</span></span>
* <span data-ttu-id="d5c9f-111">Läser in data i **Azure Blob storage** på **1.0 Gbit/s**</span><span class="sxs-lookup"><span data-stu-id="d5c9f-111">Loading data into **Azure Blob storage** at **1.0 GBps**</span></span>
* <span data-ttu-id="d5c9f-112">Läser in data i **Azure Data Lake Store** på **1.0 Gbit/s**</span><span class="sxs-lookup"><span data-stu-id="d5c9f-112">Loading data into **Azure Data Lake Store** at **1.0 GBps**</span></span>

<span data-ttu-id="d5c9f-113">Den här artikeln beskrivs:</span><span class="sxs-lookup"><span data-stu-id="d5c9f-113">This article describes:</span></span>

* <span data-ttu-id="d5c9f-114">[Prestanda referensnummer](#performance-reference) för stöds källa och mottagare data lagras toohelp som du planerar att projektet.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-114">[Performance reference numbers](#performance-reference) for supported source and sink data stores toohelp you plan your project;</span></span>
* <span data-ttu-id="d5c9f-115">Funktioner som kan öka hello kopiera genomflöde i olika scenarier, inklusive [molnet data movement enheter](#cloud-data-movement-units), [parallell kopiera](#parallel-copy), och [mellanlagrad kopiera](#staged-copy);</span><span class="sxs-lookup"><span data-stu-id="d5c9f-115">Features that can boost hello copy throughput in different scenarios, including [cloud data movement units](#cloud-data-movement-units), [parallel copy](#parallel-copy), and [staged Copy](#staged-copy);</span></span>
* <span data-ttu-id="d5c9f-116">[Riktlinjer för prestandajustering](#performance-tuning-steps) på hur kopiera tootune hello prestanda och hello viktiga faktorer som kan påverka prestanda.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-116">[Performance tuning guidance](#performance-tuning-steps) on how tootune hello performance and hello key factors that can impact copy performance.</span></span>

> [!NOTE]
> <span data-ttu-id="d5c9f-117">Om du inte är bekant med Kopieringsaktiviteten i allmänhet kan se [flytta data med hjälp av Kopieringsaktiviteten](data-factory-data-movement-activities.md) innan du läser den här artikeln.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-117">If you are not familiar with Copy Activity in general, see [Move data by using Copy Activity](data-factory-data-movement-activities.md) before reading this article.</span></span>
>

## <a name="performance-reference"></a><span data-ttu-id="d5c9f-118">Prestandareferens för</span><span class="sxs-lookup"><span data-stu-id="d5c9f-118">Performance reference</span></span>

<span data-ttu-id="d5c9f-119">Tabellen nedan visar som referens, du hello kopiera genomströmning numret i Mbit/s för hello får källa och mottagare par baserat på interna tester.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-119">As a reference, below table shows hello copy throughput number in MBps for hello given source and sink pairs based on in-house testing.</span></span> <span data-ttu-id="d5c9f-120">För jämförelse, visas också hur olika inställningar för [molnet data movement enheter](#cloud-data-movement-units) eller [Data Management Gateway skalbarhet](data-factory-data-management-gateway-high-availability-scalability.md) (flera gateway-noder) hjälper dig att kopiera prestanda.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-120">For comparison, it also demonstrates how different settings of [cloud data movement units](#cloud-data-movement-units) or [Data Management Gateway scalability](data-factory-data-management-gateway-high-availability-scalability.md) (multiple gateway nodes) can help on copy performance.</span></span>

![Matris för prestanda](./media/data-factory-copy-activity-performance/CopyPerfRef.png)


<span data-ttu-id="d5c9f-122">**Punkter toonote:**</span><span class="sxs-lookup"><span data-stu-id="d5c9f-122">**Points toonote:**</span></span>
* <span data-ttu-id="d5c9f-123">Genomströmning beräknas med hjälp av hello följande formel: [storleken på data läsas från källan] / [kopia aktivitet kör duration].</span><span class="sxs-lookup"><span data-stu-id="d5c9f-123">Throughput is calculated by using hello following formula: [size of data read from source]/[Copy Activity run duration].</span></span>
* <span data-ttu-id="d5c9f-124">hello prestanda referensnummer i hello tabellen har mäts med [TPC-H](http://www.tpc.org/tpch/) datauppsättningen i en enda kopia aktivitet körs.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-124">hello performance reference numbers in hello table were measured using [TPC-H](http://www.tpc.org/tpch/) data set in a single copy activity run.</span></span>
* <span data-ttu-id="d5c9f-125">I Azure datalager hello källa och mottagare är i hello samma Azure-region.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-125">In Azure data stores, hello source and sink are in hello same Azure region.</span></span>
* <span data-ttu-id="d5c9f-126">För hybridkopiering mellan lokala och moln datalager, varje gateway-noden körs på en dator som är separat från hello lokalt datalager med nedan specifikation.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-126">For hybrid copy between on-premises and cloud data stores, each gateway node was running on a machine that was separate from hello on-premises data store with below specification.</span></span> <span data-ttu-id="d5c9f-127">När en enskild aktivitet kördes på gateway förbrukat hello kopieringsåtgärden bara en liten del av hello testa dator CPU, minne eller bandbredd i nätverket.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-127">When a single activity was running on gateway, hello copy operation consumed only a small portion of hello test machine's CPU, memory, or network bandwidth.</span></span> <span data-ttu-id="d5c9f-128">Mer information från [för Data Management Gateway](#considerations-for-data-management-gateway).</span><span class="sxs-lookup"><span data-stu-id="d5c9f-128">Learn more from [consideration for Data Management Gateway](#considerations-for-data-management-gateway).</span></span>
    <table>
    <tr>
        <td><span data-ttu-id="d5c9f-129">Processor</span><span class="sxs-lookup"><span data-stu-id="d5c9f-129">CPU</span></span></td>
        <td><span data-ttu-id="d5c9f-130">32 kärnor 2.20 GHz Intel Xeon E5-2660 v2</span><span class="sxs-lookup"><span data-stu-id="d5c9f-130">32 cores 2.20 GHz Intel Xeon E5-2660 v2</span></span></td>
    </tr>
    <tr>
        <td><span data-ttu-id="d5c9f-131">Minne</span><span class="sxs-lookup"><span data-stu-id="d5c9f-131">Memory</span></span></td>
        <td><span data-ttu-id="d5c9f-132">128 GB</span><span class="sxs-lookup"><span data-stu-id="d5c9f-132">128 GB</span></span></td>
    </tr>
    <tr>
        <td><span data-ttu-id="d5c9f-133">Nätverk</span><span class="sxs-lookup"><span data-stu-id="d5c9f-133">Network</span></span></td>
        <td><span data-ttu-id="d5c9f-134">Internet-gränssnittet: 10 Gbit/s; intranätgränssnittet: 40 Gbit/s</span><span class="sxs-lookup"><span data-stu-id="d5c9f-134">Internet interface: 10 Gbps; intranet interface: 40 Gbps</span></span></td>
    </tr>
    </table>


> [!TIP]
> <span data-ttu-id="d5c9f-135">Du kan få bättre genomströmning genom att utnyttja mer data movement enheter (DMUs) än hello standard maximala DMUs som är 32 för en moln-to-cloud kopieringsaktiviteten kör.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-135">You can achieve higher throughput by leveraging more data movement units (DMUs) than hello default maximum DMUs, which is 32 for a cloud-to-cloud copy activity run.</span></span> <span data-ttu-id="d5c9f-136">Till exempel med 100 DMUs du kan åstadkomma kopiering av data från Azure Blob till Azure Data Lake Store på **1.0GBps**.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-136">For example, with 100 DMUs, you can achieve copying data from Azure Blob into Azure Data Lake Store at **1.0GBps**.</span></span> <span data-ttu-id="d5c9f-137">Se hello [molnet data movement enheter](#cloud-data-movement-units) finns mer information om den här funktionen och hello stöds scenario.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-137">See hello [Cloud data movement units](#cloud-data-movement-units) section for details about this feature and hello supported scenario.</span></span> <span data-ttu-id="d5c9f-138">Kontakta [Azure-supporten](https://azure.microsoft.com/support/) toorequest mer DMUs.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-138">Contact [Azure support](https://azure.microsoft.com/support/) toorequest more DMUs.</span></span>

## <a name="parallel-copy"></a><span data-ttu-id="d5c9f-139">Parallell kopia</span><span class="sxs-lookup"><span data-stu-id="d5c9f-139">Parallel copy</span></span>
<span data-ttu-id="d5c9f-140">Du kan läsa från hello datakällan eller skriva data toohello mål **parallellt i en Kopieringsaktivitet kör**.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-140">You can read data from hello source or write data toohello destination **in parallel within a Copy Activity run**.</span></span> <span data-ttu-id="d5c9f-141">Den här funktionen förbättrar hello genomströmning på en kopieringsåtgärd och minskar hello tid det tar toomove data.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-141">This feature enhances hello throughput of a copy operation and reduces hello time it takes toomove data.</span></span>

<span data-ttu-id="d5c9f-142">Denna inställning skiljer sig från hello **samtidighet** egenskap i hello aktivitetsdefinitionen.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-142">This setting is different from hello **concurrency** property in hello activity definition.</span></span> <span data-ttu-id="d5c9f-143">Hej **samtidighet** egenskapen bestämmer hello antal **samtidiga Kopieringsaktiviteten körs** tooprocess data från olika aktivitet windows (1 AM too2 AM, 2 AM too3 är, 3 kl too4 är och så vidare).</span><span class="sxs-lookup"><span data-stu-id="d5c9f-143">hello **concurrency** property determines hello number of **concurrent Copy Activity runs** tooprocess data from different activity windows (1 AM too2 AM, 2 AM too3 AM, 3 AM too4 AM, and so on).</span></span> <span data-ttu-id="d5c9f-144">Den här funktionen är användbart när du utför en historisk belastning.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-144">This capability is helpful when you perform a historical load.</span></span> <span data-ttu-id="d5c9f-145">hello parallella kopiera kapaciteten gäller tooa **enkel aktivitet kör**.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-145">hello parallel copy capability applies tooa **single activity run**.</span></span>

<span data-ttu-id="d5c9f-146">Nu ska vi titta på ett exempelscenario.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-146">Let's look at a sample scenario.</span></span> <span data-ttu-id="d5c9f-147">I följande exempel hello, måste flera segment från hello senaste toobe bearbetas.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-147">In hello following example, multiple slices from hello past need toobe processed.</span></span> <span data-ttu-id="d5c9f-148">Data Factory kör en instans av Kopieringsaktiviteten (en aktivitet kör) för varje segment:</span><span class="sxs-lookup"><span data-stu-id="d5c9f-148">Data Factory runs an instance of Copy Activity (an activity run) for each slice:</span></span>

* <span data-ttu-id="d5c9f-149">Hej datasektorn från hello första aktivitetsfönstret (1 AM too2 är) == > aktivitet köras 1</span><span class="sxs-lookup"><span data-stu-id="d5c9f-149">hello data slice from hello first activity window (1 AM too2 AM) ==> Activity run 1</span></span>
* <span data-ttu-id="d5c9f-150">Hej datasektorn från hello andra aktivitetsfönstret (2 AM too3 är) == > aktivitet köras 2</span><span class="sxs-lookup"><span data-stu-id="d5c9f-150">hello data slice from hello second activity window (2 AM too3 AM) ==> Activity run 2</span></span>
* <span data-ttu-id="d5c9f-151">Hej datasektorn från hello andra aktivitetsfönstret (3 kl too4 är) == > aktivitet köras 3</span><span class="sxs-lookup"><span data-stu-id="d5c9f-151">hello data slice from hello second activity window (3 AM too4 AM) ==> Activity run 3</span></span>

<span data-ttu-id="d5c9f-152">Och så vidare.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-152">And so on.</span></span>

<span data-ttu-id="d5c9f-153">I det här exemplet när hello **samtidighet** värdet too2, **aktivitet köras 1** och **aktivitet köras 2** kopiera data från två aktivitet windows **samtidigt**  tooimprove data movement prestanda.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-153">In this example, when hello **concurrency** value is set too2, **Activity run 1** and **Activity run 2** copy data from two activity windows **concurrently** tooimprove data movement performance.</span></span> <span data-ttu-id="d5c9f-154">Men om flera filer som är associerade med aktiviteten kör 1, kopierar hello data movement service filer från hello toohello mål en källfil i taget.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-154">However, if multiple files are associated with Activity run 1, hello data movement service copies files from hello source toohello destination one file at a time.</span></span>

### <a name="cloud-data-movement-units"></a><span data-ttu-id="d5c9f-155">Molnet data movement enheter</span><span class="sxs-lookup"><span data-stu-id="d5c9f-155">Cloud data movement units</span></span>
<span data-ttu-id="d5c9f-156">En **moln data movement enhet (dmu här)** är ett mått som representerar hello styrka (en kombination av CPU, minne och nätverksresursallokering) en enhet i Data Factory.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-156">A **cloud data movement unit (DMU)** is a measure that represents hello power (a combination of CPU, memory, and network resource allocation) of a single unit in Data Factory.</span></span> <span data-ttu-id="d5c9f-157">En dmu här kan användas i ett moln-to-cloud kopieringsåtgärden, men inte i en hybrid-kopia.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-157">A DMU might be used in a cloud-to-cloud copy operation, but not in a hybrid copy.</span></span>

<span data-ttu-id="d5c9f-158">Som standard använder Data Factory en enstaka moln dmu här tooperform en enskild kopia aktivitet körs.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-158">By default, Data Factory uses a single cloud DMU tooperform a single Copy Activity run.</span></span> <span data-ttu-id="d5c9f-159">toooverride standard, ange ett värde för hello **cloudDataMovementUnits** egenskapen på följande sätt.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-159">toooverride this default, specify a value for hello **cloudDataMovementUnits** property as follows.</span></span> <span data-ttu-id="d5c9f-160">Information om hello nivå av prestanda som du kan få när du konfigurerar flera enheter för en specifik kopieringskälla och mottagare finns hello [Prestandareferens](#performance-reference).</span><span class="sxs-lookup"><span data-stu-id="d5c9f-160">For information about hello level of performance gain you might get when you configure more units for a specific copy source and sink, see hello [performance reference](#performance-reference).</span></span>

```json
"activities":[  
    {
        "name": "Sample copy activity",
        "description": "",
        "type": "Copy",
        "inputs": [{ "name": "InputDataset" }],
        "outputs": [{ "name": "OutputDataset" }],
        "typeProperties": {
            "source": {
                "type": "BlobSource",
            },
            "sink": {
                "type": "AzureDataLakeStoreSink"
            },
            "cloudDataMovementUnits": 32
        }
    }
]
```
<span data-ttu-id="d5c9f-161">Hej **tillåtna värden** för hello **cloudDataMovementUnits** egenskapen är 1 (standard), 2, 4, 8, 16, 32.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-161">hello **allowed values** for hello **cloudDataMovementUnits** property are 1 (default), 2, 4, 8, 16, 32.</span></span> <span data-ttu-id="d5c9f-162">Hej **faktiska antalet molnet DMUs** att hello kopieringen används vid körning är lika tooor som är lägre än hello konfigurerat värde, beroende på din datamönster.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-162">hello **actual number of cloud DMUs** that hello copy operation uses at run time is equal tooor less than hello configured value, depending on your data pattern.</span></span>

> [!NOTE]
> <span data-ttu-id="d5c9f-163">Om du behöver mer molnet DMUs för en högre genomströmning Kontakta [Azure-supporten](https://azure.microsoft.com/support/).</span><span class="sxs-lookup"><span data-stu-id="d5c9f-163">If you need more cloud DMUs for a higher throughput, contact [Azure support](https://azure.microsoft.com/support/).</span></span> <span data-ttu-id="d5c9f-164">Inställning av 8 och senare fungerar aktuellt endast när du **kopierar du flera filer från Blob lagring/Datasjölager/Amazon S3 eller ett moln FTP-eller ett moln SFTP tooBlob lagring/Data Lake Store/Azure SQL Database**.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-164">Setting of 8 and above currently works only when you **copy multiple files from Blob storage/Data Lake Store/Amazon S3/cloud FTP/cloud SFTP tooBlob storage/Data Lake Store/Azure SQL Database**.</span></span>
>

### <a name="parallelcopies"></a><span data-ttu-id="d5c9f-165">parallelCopies</span><span class="sxs-lookup"><span data-stu-id="d5c9f-165">parallelCopies</span></span>
<span data-ttu-id="d5c9f-166">Du kan använda hello **parallelCopies** egenskapen tooindicate hello parallellitet som du vill Kopieringsaktiviteten toouse.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-166">You can use hello **parallelCopies** property tooindicate hello parallelism that you want Copy Activity toouse.</span></span> <span data-ttu-id="d5c9f-167">Du kan se den här egenskapen som hello maximalt antal trådar inom Kopieringsaktiviteten som kan läsa från käll- eller skriva tooyour sink datalager parallellt.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-167">You can think of this property as hello maximum number of threads within Copy Activity that can read from your source or write tooyour sink data stores in parallel.</span></span>

<span data-ttu-id="d5c9f-168">För varje kopia aktivitet kör, bestämmer Data Factory hello antalet parallella kopierar toouse toocopy data från datalagret för hello källa och toohello importera data till.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-168">For each Copy Activity run, Data Factory determines hello number of parallel copies toouse toocopy data from hello source data store and toohello destination data store.</span></span> <span data-ttu-id="d5c9f-169">hello standardantalet parallella kopior som ska användas beror på hello typ av källa och mottagare som du använder.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-169">hello default number of parallel copies that it uses depends on hello type of source and sink that you are using.</span></span>  

| <span data-ttu-id="d5c9f-170">Källa och mottagare</span><span class="sxs-lookup"><span data-stu-id="d5c9f-170">Source and sink</span></span> | <span data-ttu-id="d5c9f-171">Standardvärdet för parallell Kopiera antal bestäms av tjänsten</span><span class="sxs-lookup"><span data-stu-id="d5c9f-171">Default parallel copy count determined by service</span></span> |
| --- | --- |
| <span data-ttu-id="d5c9f-172">Kopiera data mellan filbaserade butiker (Blob-lagring. Data Lake Store; Amazon S3; ett lokalt filsystem; ett lokalt HDFS)</span><span class="sxs-lookup"><span data-stu-id="d5c9f-172">Copy data between file-based stores (Blob storage; Data Lake Store; Amazon S3; an on-premises file system; an on-premises HDFS)</span></span> |<span data-ttu-id="d5c9f-173">Mellan 1 och 32.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-173">Between 1 and 32.</span></span> <span data-ttu-id="d5c9f-174">Beror på hello mycket hello filer och hello antal molnet data movement enheter (DMUs) används toocopy data mellan två molnet datalager eller hello fysiska konfigurationen av hello Gateway-datorn som används för hybridkopiering (toocopy data tooor från ett lokalt datalager ).</span><span class="sxs-lookup"><span data-stu-id="d5c9f-174">Depends on hello size of hello files and hello number of cloud data movement units (DMUs) used toocopy data between two cloud data stores, or hello physical configuration of hello Gateway machine used for a hybrid copy (toocopy data tooor from an on-premises data store).</span></span> |
| <span data-ttu-id="d5c9f-175">Kopiera data från **alla källdata lagra tooAzure Table storage**</span><span class="sxs-lookup"><span data-stu-id="d5c9f-175">Copy data from **any source data store tooAzure Table storage**</span></span> |<span data-ttu-id="d5c9f-176">4</span><span class="sxs-lookup"><span data-stu-id="d5c9f-176">4</span></span> |
| <span data-ttu-id="d5c9f-177">Alla andra källa och mottagare par</span><span class="sxs-lookup"><span data-stu-id="d5c9f-177">All other source and sink pairs</span></span> |<span data-ttu-id="d5c9f-178">1</span><span class="sxs-lookup"><span data-stu-id="d5c9f-178">1</span></span> |

<span data-ttu-id="d5c9f-179">Vanligtvis hello standardbeteendet bör ge dig hello bästa genomflöde.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-179">Usually, hello default behavior should give you hello best throughput.</span></span> <span data-ttu-id="d5c9f-180">Dock toocontrol hello läses in på datorer som är värdar för ditt datalager eller tootune kopiera prestanda, kan du välja toooverride hello standardvärdet och ange ett värde för hello **parallelCopies** egenskapen.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-180">However, toocontrol hello load on machines that host your data stores, or tootune copy performance, you may choose toooverride hello default value and specify a value for hello **parallelCopies** property.</span></span> <span data-ttu-id="d5c9f-181">hello-värdet måste vara mellan 1 och 32 (båda inkluderande).</span><span class="sxs-lookup"><span data-stu-id="d5c9f-181">hello value must be between 1 and 32 (both inclusive).</span></span> <span data-ttu-id="d5c9f-182">Vid körning för bästa prestanda hello Kopieringsaktiviteten använder du ett värde som är mindre än eller lika toohello värdet som du anger.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-182">At run time, for hello best performance, Copy Activity uses a value that is less than or equal toohello value that you set.</span></span>

```json
"activities":[  
    {
        "name": "Sample copy activity",
        "description": "",
        "type": "Copy",
        "inputs": [{ "name": "InputDataset" }],
        "outputs": [{ "name": "OutputDataset" }],
        "typeProperties": {
            "source": {
                "type": "BlobSource",
            },
            "sink": {
                "type": "AzureDataLakeStoreSink"
            },
            "parallelCopies": 8
        }
    }
]
```
<span data-ttu-id="d5c9f-183">Punkter toonote:</span><span class="sxs-lookup"><span data-stu-id="d5c9f-183">Points toonote:</span></span>

* <span data-ttu-id="d5c9f-184">När du kopierar data mellan filbaserade lagrar hello **parallelCopies** fastställa hello parallellitet till hello filnivå.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-184">When you copy data between file-based stores, hello **parallelCopies** determine hello parallelism at hello file level.</span></span> <span data-ttu-id="d5c9f-185">Hej högoptimerat inom en enskild fil skulle inträffa under automatiskt och transparent och den är utformad toouse hello bästa lämplig segmentstorleken för en viss källa data store Skriv tooload data i parallella och ortogonala tooparallelCopies.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-185">hello chunking within a single file would happen underneath automatically and transparently, and it's designed toouse hello best suitable chunk size for a given source data store type tooload data in parallel and orthogonal tooparallelCopies.</span></span> <span data-ttu-id="d5c9f-186">hello faktiskt antal parallella kopior hello data movement service använder för hello kopieringen vid körning är högst hello antalet filer som du har.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-186">hello actual number of parallel copies hello data movement service uses for hello copy operation at run time is no more than hello number of files you have.</span></span> <span data-ttu-id="d5c9f-187">Om hello kopiera beteendet är **mergeFile**, Kopieringsaktivitet kan inte utnyttja filnivå parallellitet.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-187">If hello copy behavior is **mergeFile**, Copy Activity cannot take advantage of file-level parallelism.</span></span>
* <span data-ttu-id="d5c9f-188">När du anger ett värde för hello **parallelCopies** egenskap, bör du hello belastningen ökar på käll- och mottagarnoderna datalager och toogateway om det är en kopia av hybrid.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-188">When you specify a value for hello **parallelCopies** property, consider hello load increase on your source and sink data stores, and toogateway if it is a hybrid copy.</span></span> <span data-ttu-id="d5c9f-189">Detta händer särskilt när du har flera aktiviteter eller samtidiga körningar av hello samma aktiviteter som körs mot hello samma datalager.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-189">This happens especially when you have multiple activities or concurrent runs of hello same activities that run against hello same data store.</span></span> <span data-ttu-id="d5c9f-190">Om du märker datalagret hello eller Gateway många med hello belastning, minska hello **parallelCopies** värdet toorelieve hello belastningen.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-190">If you notice that either hello data store or Gateway is overwhelmed with hello load, decrease hello **parallelCopies** value toorelieve hello load.</span></span>
* <span data-ttu-id="d5c9f-191">När du kopierar data från butiker som inte är filbaserade toostores är filbaserade hello data movement service ignorerar hello **parallelCopies** egenskapen.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-191">When you copy data from stores that are not file-based toostores that are file-based, hello data movement service ignores hello **parallelCopies** property.</span></span> <span data-ttu-id="d5c9f-192">Även om parallellitet anges tillämpas den inte i det här fallet.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-192">Even if parallelism is specified, it's not applied in this case.</span></span>

> [!NOTE]
> <span data-ttu-id="d5c9f-193">Du måste använda Data Management Gateway version 1.11 eller senare toouse hello **parallelCopies** funktion när du gör en kopia av hybrid.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-193">You must use Data Management Gateway version 1.11 or later toouse hello **parallelCopies** feature when you do a hybrid copy.</span></span>
>
>

<span data-ttu-id="d5c9f-194">toobetter använder de här två egenskaperna och tooenhance din datagenomströmning flytt, se hello [exempel på användningsområden](#case-study-use-parallel-copy).</span><span class="sxs-lookup"><span data-stu-id="d5c9f-194">toobetter use these two properties, and tooenhance your data movement throughput, see hello [sample use cases](#case-study-use-parallel-copy).</span></span> <span data-ttu-id="d5c9f-195">Du behöver inte tooconfigure **parallelCopies** tootake nytta av hello standardbeteendet.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-195">You don't need tooconfigure **parallelCopies** tootake advantage of hello default behavior.</span></span> <span data-ttu-id="d5c9f-196">Om du konfigurerar och **parallelCopies** är för liten flera molnet DMUs inte kan användas fullt ut.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-196">If you do configure and **parallelCopies** is too small, multiple cloud DMUs might not be fully utilized.</span></span>  

### <a name="billing-impact"></a><span data-ttu-id="d5c9f-197">Fakturering påverkan</span><span class="sxs-lookup"><span data-stu-id="d5c9f-197">Billing impact</span></span>
<span data-ttu-id="d5c9f-198">Den har **viktiga** tooremember som du debiteras baserat på hello total tid för hello kopieringen.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-198">It's **important** tooremember that you are charged based on hello total time of hello copy operation.</span></span> <span data-ttu-id="d5c9f-199">Om en kopieringsjobbet används tootake en timme till ett moln enhet och nu det tar 15 minuter med fyra enheter i molnet, hello hello övergripande faktura förblir nästan samma.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-199">If a copy job used tootake one hour with one cloud unit and now it takes 15 minutes with four cloud units, hello overall bill remains almost hello same.</span></span> <span data-ttu-id="d5c9f-200">Exempelvis kan du använda fyra enheter i molnet.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-200">For example, you use four cloud units.</span></span> <span data-ttu-id="d5c9f-201">hello första molnet enhet använder 10 minuter, hello andra en, 10 minuter hello tredje ett, 5 minuter och hello fjärde ett, 5 minuter, allt i en Kopieringsaktivitet kör.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-201">hello first cloud unit spends 10 minutes, hello second one, 10 minutes, hello third one, 5 minutes, and hello fourth one, 5 minutes, all in one Copy Activity run.</span></span> <span data-ttu-id="d5c9f-202">Du debiteras för hello Totalt antal copy (dataflyttning) gång, vilket är 10 + 10 + 5 + 5 = 30 minuter.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-202">You are charged for hello total copy (data movement) time, which is 10 + 10 + 5 + 5 = 30 minutes.</span></span> <span data-ttu-id="d5c9f-203">Med hjälp av **parallelCopies** påverkar inte fakturering.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-203">Using **parallelCopies** does not affect billing.</span></span>

## <a name="staged-copy"></a><span data-ttu-id="d5c9f-204">Stegvis kopia</span><span class="sxs-lookup"><span data-stu-id="d5c9f-204">Staged copy</span></span>
<span data-ttu-id="d5c9f-205">När du kopierar data från en källa data store tooa sink dataarkiv kan du välja toouse Blob storage som ett tillfälligt fristående Arkiv.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-205">When you copy data from a source data store tooa sink data store, you might choose toouse Blob storage as an interim staging store.</span></span> <span data-ttu-id="d5c9f-206">Mellanlagring är särskilt användbart i följande fall hello:</span><span class="sxs-lookup"><span data-stu-id="d5c9f-206">Staging is especially useful in hello following cases:</span></span>

1. <span data-ttu-id="d5c9f-207">**Du vill tooingest data från olika datalager till SQL Data Warehouse via PolyBase**.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-207">**You want tooingest data from various data stores into SQL Data Warehouse via PolyBase**.</span></span> <span data-ttu-id="d5c9f-208">SQL Data Warehouse använder PolyBase som en mekanism för hög genomströmning tooload stora mängder data till SQL Data Warehouse.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-208">SQL Data Warehouse uses PolyBase as a high-throughput mechanism tooload a large amount of data into SQL Data Warehouse.</span></span> <span data-ttu-id="d5c9f-209">Dock hello källdata måste vara i Blob storage och det måste uppfylla ytterligare villkor.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-209">However, hello source data must be in Blob storage, and it must meet additional criteria.</span></span> <span data-ttu-id="d5c9f-210">När du läser in data från ett annat dataarkiv än Blob storage kan du Aktivera kopiering via mellanlagring Blob mellanlagring data.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-210">When you load data from a data store other than Blob storage, you can activate data copying via interim staging Blob storage.</span></span> <span data-ttu-id="d5c9f-211">I så fall utför Data Factory hello krävs data transformationer tooensure att den uppfyller hello av PolyBase.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-211">In that case, Data Factory performs hello required data transformations tooensure that it meets hello requirements of PolyBase.</span></span> <span data-ttu-id="d5c9f-212">Därefter används PolyBase tooload data till SQL Data Warehouse.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-212">Then it uses PolyBase tooload data into SQL Data Warehouse.</span></span> <span data-ttu-id="d5c9f-213">Mer information finns i [Använd PolyBase tooload data till Azure SQL Data Warehouse](data-factory-azure-sql-data-warehouse-connector.md#use-polybase-to-load-data-into-azure-sql-data-warehouse).</span><span class="sxs-lookup"><span data-stu-id="d5c9f-213">For more details, see [Use PolyBase tooload data into Azure SQL Data Warehouse](data-factory-azure-sql-data-warehouse-connector.md#use-polybase-to-load-data-into-azure-sql-data-warehouse).</span></span> <span data-ttu-id="d5c9f-214">En genomgång med ett användningsfall finns [läsa in 1 TB i Azure SQL Data Warehouse under 15 minuter med Azure Data Factory](data-factory-load-sql-data-warehouse.md).</span><span class="sxs-lookup"><span data-stu-id="d5c9f-214">For a walkthrough with a use case, see [Load 1 TB into Azure SQL Data Warehouse under 15 minutes with Azure Data Factory](data-factory-load-sql-data-warehouse.md).</span></span>
2. <span data-ttu-id="d5c9f-215">**Ibland tar en stund tooperform hybrid dataflyttning (det vill säga toocopy mellan ett lokalt datalager och ett datalager i molnet) över en långsam nätverksanslutning**.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-215">**Sometimes it takes a while tooperform a hybrid data movement (that is, toocopy between an on-premises data store and a cloud data store) over a slow network connection**.</span></span> <span data-ttu-id="d5c9f-216">Du kan komprimera hello data lokalt så att det tar mindre tid toomove data toohello fristående datalager i hello molnet tooimprove prestanda.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-216">tooimprove performance, you can compress hello data on-premises so that it takes less time toomove data toohello staging data store in hello cloud.</span></span> <span data-ttu-id="d5c9f-217">Sedan kan du expandera hello data i hello mellanlagring store innan du läser in i datalagret för hello mål.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-217">Then you can decompress hello data in hello staging store before you load it into hello destination data store.</span></span>
3. <span data-ttu-id="d5c9f-218">**Du inte vill tooopen portar än port 80 och port 443 i brandväggen, på grund av företagets IT-principer**.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-218">**You don't want tooopen ports other than port 80 and port 443 in your firewall, because of corporate IT policies**.</span></span> <span data-ttu-id="d5c9f-219">När du kopierar data från en lokal data store tooan Azure SQL Database sink eller en Azure SQL Data Warehouse sink måste du till exempel tooactivate utgående TCP-kommunikation på port 1433 för företagets brandvägg och hello Windows-brandväggen.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-219">For example, when you copy data from an on-premises data store tooan Azure SQL Database sink or an Azure SQL Data Warehouse sink, you need tooactivate outbound TCP communication on port 1433 for both hello Windows firewall and your corporate firewall.</span></span> <span data-ttu-id="d5c9f-220">I det här scenariot utnyttja hello toofirst kopiera data tooa Blob storage fristående gatewayinstansen via HTTP eller HTTPS på port 443.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-220">In this scenario, take advantage of hello gateway toofirst copy data tooa Blob storage staging instance over HTTP or HTTPS on port 443.</span></span> <span data-ttu-id="d5c9f-221">Hämta sedan hello data till SQL Database eller SQL Data Warehouse från Blob storage mellanlagring.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-221">Then, load hello data into SQL Database or SQL Data Warehouse from Blob storage staging.</span></span> <span data-ttu-id="d5c9f-222">I det här flödet behöver du inte tooenable port 1433.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-222">In this flow, you don't need tooenable port 1433.</span></span>

### <a name="how-staged-copy-works"></a><span data-ttu-id="d5c9f-223">Hur mellanlagrade Kopiera verk</span><span class="sxs-lookup"><span data-stu-id="d5c9f-223">How staged copy works</span></span>
<span data-ttu-id="d5c9f-224">När du aktiverar hello mellanlagring funktionen första hello data kopieras från hello källa data store toohello mellanlagring datalager (ta med din egen).</span><span class="sxs-lookup"><span data-stu-id="d5c9f-224">When you activate hello staging feature, first hello data is copied from hello source data store toohello staging data store (bring your own).</span></span> <span data-ttu-id="d5c9f-225">Därefter kopieras hello data från hello mellanlagring data store toohello sink-datalagret.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-225">Next, hello data is copied from hello staging data store toohello sink data store.</span></span> <span data-ttu-id="d5c9f-226">Data Factory hanterar automatiskt hello två steg flödet för dig.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-226">Data Factory automatically manages hello two-stage flow for you.</span></span> <span data-ttu-id="d5c9f-227">Data Factory också Rensar tillfällig data från hello mellanlagring lagring när hello dataflyttning är klar.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-227">Data Factory also cleans up temporary data from hello staging storage after hello data movement is complete.</span></span>

<span data-ttu-id="d5c9f-228">Gateway används inte i hello molnet kopiera scenario (både källa och mottagare data lagras i molnet hello).</span><span class="sxs-lookup"><span data-stu-id="d5c9f-228">In hello cloud copy scenario (both source and sink data stores are in hello cloud), gateway is not used.</span></span> <span data-ttu-id="d5c9f-229">hello Data Factory-tjänsten utför hello kopia.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-229">hello Data Factory service performs hello copy operations.</span></span>

![Mellanlagrad kopia: scenariot](media/data-factory-copy-activity-performance/staged-copy-cloud-scenario.png)

<span data-ttu-id="d5c9f-231">I hello hybridscenario kopia (källan är lokala och mottagare finns i hello moln) hello gateway flyttar data från hello källdata lagra tooa mellanlagring datalagret.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-231">In hello hybrid copy scenario (source is on-premises and sink is in hello cloud), hello gateway moves data from hello source data store tooa staging data store.</span></span> <span data-ttu-id="d5c9f-232">Data Factory-tjänsten flyttar data från hello mellanlagring data lagra toohello sink-datalagret.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-232">Data Factory service moves data from hello staging data store toohello sink data store.</span></span> <span data-ttu-id="d5c9f-233">Kopiera data från ett moln data store tooan lokalt datalager via mellanlagring stöds även med omvänd hello flödet.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-233">Copying data from a cloud data store tooan on-premises data store via staging also is supported with hello reversed flow.</span></span>

![Mellanlagrad kopia: hybridscenario](media/data-factory-copy-activity-performance/staged-copy-hybrid-scenario.png)

<span data-ttu-id="d5c9f-235">När du aktiverar dataflyttning med hjälp av ett fristående Arkiv, kan du ange om du vill hello data toobe komprimerade innan du flyttar data från hello källa data lagra tooan interim eller mellanlagring datalager och expanderas innan du flyttar data från en interimistisk eller fristående datalager toohello sink-datalagret.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-235">When you activate data movement by using a staging store, you can specify whether you want hello data toobe compressed before moving data from hello source data store tooan interim or staging data store, and then decompressed before moving data from an interim or staging data store toohello sink data store.</span></span>

<span data-ttu-id="d5c9f-236">För närvarande kan du kopiera data mellan två lokala datalager med hjälp av ett fristående Arkiv.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-236">Currently, you can't copy data between two on-premises data stores by using a staging store.</span></span> <span data-ttu-id="d5c9f-237">Vi hoppas det här alternativet toobe tillgänglig snart.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-237">We expect this option toobe available soon.</span></span>

### <a name="configuration"></a><span data-ttu-id="d5c9f-238">Konfiguration</span><span class="sxs-lookup"><span data-stu-id="d5c9f-238">Configuration</span></span>
<span data-ttu-id="d5c9f-239">Konfigurera hello **enableStaging** inställningen i Kopieringsaktiviteten toospecify om du vill hello data toobe mellanlagras i Blob storage innan du läser in den i ett dataarkiv som mål.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-239">Configure hello **enableStaging** setting in Copy Activity toospecify whether you want hello data toobe staged in Blob storage before you load it into a destination data store.</span></span> <span data-ttu-id="d5c9f-240">När du anger **enableStaging** tooTRUE, ange hello ytterligare egenskaper som anges i hello nästa tabell.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-240">When you set **enableStaging** tooTRUE, specify hello additional properties listed in hello next table.</span></span> <span data-ttu-id="d5c9f-241">Om du inte har någon, du måste också toocreate ett Azure Storage eller lagring delade åtkomst signatur-länkad tjänst för Förproduktion.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-241">If you don’t have one, you also need toocreate an Azure Storage or Storage shared access signature-linked service for staging.</span></span>

| <span data-ttu-id="d5c9f-242">Egenskap</span><span class="sxs-lookup"><span data-stu-id="d5c9f-242">Property</span></span> | <span data-ttu-id="d5c9f-243">Beskrivning</span><span class="sxs-lookup"><span data-stu-id="d5c9f-243">Description</span></span> | <span data-ttu-id="d5c9f-244">Standardvärde</span><span class="sxs-lookup"><span data-stu-id="d5c9f-244">Default value</span></span> | <span data-ttu-id="d5c9f-245">Krävs</span><span class="sxs-lookup"><span data-stu-id="d5c9f-245">Required</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="d5c9f-246">**enableStaging**</span><span class="sxs-lookup"><span data-stu-id="d5c9f-246">**enableStaging**</span></span> |<span data-ttu-id="d5c9f-247">Om du vill toocopy data via en interimistisk mellanlagring store.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-247">Specify whether you want toocopy data via an interim staging store.</span></span> |<span data-ttu-id="d5c9f-248">False</span><span class="sxs-lookup"><span data-stu-id="d5c9f-248">False</span></span> |<span data-ttu-id="d5c9f-249">Nej</span><span class="sxs-lookup"><span data-stu-id="d5c9f-249">No</span></span> |
| <span data-ttu-id="d5c9f-250">**linkedServiceName**</span><span class="sxs-lookup"><span data-stu-id="d5c9f-250">**linkedServiceName**</span></span> |<span data-ttu-id="d5c9f-251">Ange hello namnet på en [AzureStorage](data-factory-azure-blob-connector.md#azure-storage-linked-service) eller [AzureStorageSas](data-factory-azure-blob-connector.md#azure-storage-sas-linked-service) länkade tjänst som refererar toohello instans av lagring som du använder som ett tillfälligt fristående Arkiv.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-251">Specify hello name of an [AzureStorage](data-factory-azure-blob-connector.md#azure-storage-linked-service) or [AzureStorageSas](data-factory-azure-blob-connector.md#azure-storage-sas-linked-service) linked service, which refers toohello instance of Storage that you use as an interim staging store.</span></span> <br/><br/> <span data-ttu-id="d5c9f-252">Du kan använda lagring med en delad åtkomst signatur tooload data till SQL Data Warehouse via PolyBase.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-252">You cannot use Storage with a shared access signature tooload data into SQL Data Warehouse via PolyBase.</span></span> <span data-ttu-id="d5c9f-253">Du kan använda den i andra scenarier.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-253">You can use it in all other scenarios.</span></span> |<span data-ttu-id="d5c9f-254">Saknas</span><span class="sxs-lookup"><span data-stu-id="d5c9f-254">N/A</span></span> |<span data-ttu-id="d5c9f-255">Ja, när **enableStaging** anges tooTRUE</span><span class="sxs-lookup"><span data-stu-id="d5c9f-255">Yes, when **enableStaging** is set tooTRUE</span></span> |
| <span data-ttu-id="d5c9f-256">**sökväg**</span><span class="sxs-lookup"><span data-stu-id="d5c9f-256">**path**</span></span> |<span data-ttu-id="d5c9f-257">Ange hello Blob storage sökväg som du vill toocontain hello mellanlagrade data.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-257">Specify hello Blob storage path that you want toocontain hello staged data.</span></span> <span data-ttu-id="d5c9f-258">Om du inte anger en sökväg skapar hello tjänsten en behållare toostore tillfälliga data.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-258">If you do not provide a path, hello service creates a container toostore temporary data.</span></span> <br/><br/> <span data-ttu-id="d5c9f-259">Ange en sökväg om du använder lagring med en signatur för delad åtkomst eller du behöver tillfällig data toobe på en viss plats.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-259">Specify a path only if you use Storage with a shared access signature, or you require temporary data toobe in a specific location.</span></span> |<span data-ttu-id="d5c9f-260">Saknas</span><span class="sxs-lookup"><span data-stu-id="d5c9f-260">N/A</span></span> |<span data-ttu-id="d5c9f-261">Nej</span><span class="sxs-lookup"><span data-stu-id="d5c9f-261">No</span></span> |
| <span data-ttu-id="d5c9f-262">**enableCompression**</span><span class="sxs-lookup"><span data-stu-id="d5c9f-262">**enableCompression**</span></span> |<span data-ttu-id="d5c9f-263">Anger om data ska komprimeras innan den kopierade toohello mål.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-263">Specifies whether data should be compressed before it is copied toohello destination.</span></span> <span data-ttu-id="d5c9f-264">Den här inställningen minskar hello mängden data som överförs.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-264">This setting reduces hello volume of data being transferred.</span></span> |<span data-ttu-id="d5c9f-265">False</span><span class="sxs-lookup"><span data-stu-id="d5c9f-265">False</span></span> |<span data-ttu-id="d5c9f-266">Nej</span><span class="sxs-lookup"><span data-stu-id="d5c9f-266">No</span></span> |

<span data-ttu-id="d5c9f-267">Här är en exempel-definition av Kopieringsaktiviteten med hello egenskaper som beskrivs i föregående tabell hello:</span><span class="sxs-lookup"><span data-stu-id="d5c9f-267">Here's a sample definition of Copy Activity with hello properties that are described in hello preceding table:</span></span>

```json
"activities":[  
{
    "name": "Sample copy activity",
    "type": "Copy",
    "inputs": [{ "name": "OnpremisesSQLServerInput" }],
    "outputs": [{ "name": "AzureSQLDBOutput" }],
    "typeProperties": {
        "source": {
            "type": "SqlSource",
        },
        "sink": {
            "type": "SqlSink"
        },
        "enableStaging": true,
        "stagingSettings": {
            "linkedServiceName": "MyStagingBlob",
            "path": "stagingcontainer/path",
            "enableCompression": true
        }
    }
}
]
```

### <a name="billing-impact"></a><span data-ttu-id="d5c9f-268">Fakturering påverkan</span><span class="sxs-lookup"><span data-stu-id="d5c9f-268">Billing impact</span></span>
<span data-ttu-id="d5c9f-269">Du debiteras baserat på två steg: kopiera varaktighet och typen.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-269">You are charged based on two steps: copy duration and copy type.</span></span>

* <span data-ttu-id="d5c9f-270">När du använder debiteras mellanlagring under en molnkopieringen (kopiera data från ett datalager för molnet data store tooanother molnet), du hello [summan av kopiera varaktighet för steg 1 och 2] x [kopia-enhetspriset för molnet].</span><span class="sxs-lookup"><span data-stu-id="d5c9f-270">When you use staging during a cloud copy (copying data from a cloud data store tooanother cloud data store), you are charged hello [sum of copy duration for step 1 and step 2] x [cloud copy unit price].</span></span>
* <span data-ttu-id="d5c9f-271">När du använder mellanlagring under en hybridkopiering (kopiera data från ett dataarkiv för lokala data store tooa molnet), debiteras du för [hybrid kopiera duration] x [kopia-enhetspriset för hybrid] + [kopia varaktighet för moln] x [kopia-enhetspriset för molnet].</span><span class="sxs-lookup"><span data-stu-id="d5c9f-271">When you use staging during a hybrid copy (copying data from an on-premises data store tooa cloud data store), you are charged for [hybrid copy duration] x [hybrid copy unit price] + [cloud copy duration] x [cloud copy unit price].</span></span>

## <a name="performance-tuning-steps"></a><span data-ttu-id="d5c9f-272">Prestanda prestandajustering steg</span><span class="sxs-lookup"><span data-stu-id="d5c9f-272">Performance tuning steps</span></span>
<span data-ttu-id="d5c9f-273">Vi rekommenderar att du har gjort tootune hello prestandan för din Data Factory-tjänsten med Kopieringsaktiviteten:</span><span class="sxs-lookup"><span data-stu-id="d5c9f-273">We suggest that you take these steps tootune hello performance of your Data Factory service with Copy Activity:</span></span>

1. <span data-ttu-id="d5c9f-274">**Upprätta en baslinje för**.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-274">**Establish a baseline**.</span></span> <span data-ttu-id="d5c9f-275">Testa din pipeline under hello utvecklingsfasen med hjälp av Kopieringsaktiviteten mot ett representativt exempel.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-275">During hello development phase, test your pipeline by using Copy Activity against a representative data sample.</span></span> <span data-ttu-id="d5c9f-276">Du kan använda hello Data Factory [segmentering modellen](data-factory-scheduling-and-execution.md) toolimit hello mängden data som du arbetar med.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-276">You can use hello Data Factory [slicing model](data-factory-scheduling-and-execution.md) toolimit hello amount of data you work with.</span></span>

   <span data-ttu-id="d5c9f-277">Samla in körningstiden och prestandaegenskaper med hjälp av hello **övervakning och hantering av App**.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-277">Collect execution time and performance characteristics by using hello **Monitoring and Management App**.</span></span> <span data-ttu-id="d5c9f-278">Välj **övervaka och hantera** på startsidan Data Factory.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-278">Choose **Monitor & Manage** on your Data Factory home page.</span></span> <span data-ttu-id="d5c9f-279">I trädvyn hello väljer hello **utdatauppsättningen**.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-279">In hello tree view, choose hello **output dataset**.</span></span> <span data-ttu-id="d5c9f-280">I hello **aktivitet Windows** Välj hello Kopieringsaktiviteten kör.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-280">In hello **Activity Windows** list, choose hello Copy Activity run.</span></span> <span data-ttu-id="d5c9f-281">**Aktiviteten Windows** visar hello Kopiera aktivitetens varaktighet och hello storleken på hello data som kopieras.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-281">**Activity Windows** lists hello Copy Activity duration and hello size of hello data that's copied.</span></span> <span data-ttu-id="d5c9f-282">hello genomströmning listas i **aktivitet fönstret Explorer**.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-282">hello throughput is listed in **Activity Window Explorer**.</span></span> <span data-ttu-id="d5c9f-283">toolearn mer om hello appen finns [övervaka och hantera Azure Data Factory pipelines med hjälp av hello övervakning och hantering av App](data-factory-monitor-manage-app.md).</span><span class="sxs-lookup"><span data-stu-id="d5c9f-283">toolearn more about hello app, see [Monitor and manage Azure Data Factory pipelines by using hello Monitoring and Management App](data-factory-monitor-manage-app.md).</span></span>

   ![Aktivitetskörningsinformation](./media/data-factory-copy-activity-performance/mmapp-activity-run-details.png)

   <span data-ttu-id="d5c9f-285">Senare i hello artikeln kan du jämföra hello prestanda och konfigurationen av din scenariot tooCopy aktivitets [Prestandareferens](#performance-reference) från våra tester.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-285">Later in hello article, you can compare hello performance and configuration of your scenario tooCopy Activity’s [performance reference](#performance-reference) from our tests.</span></span>
2. <span data-ttu-id="d5c9f-286">**Diagnostisera och optimera prestanda**.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-286">**Diagnose and optimize performance**.</span></span> <span data-ttu-id="d5c9f-287">Om hello prestanda du se inte uppfyller dina förväntningar, måste tooidentify flaskhalsar.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-287">If hello performance you observe doesn't meet your expectations, you need tooidentify performance bottlenecks.</span></span> <span data-ttu-id="d5c9f-288">Sedan kan optimera prestanda tooremove eller minska hello effekten av flaskhalsar.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-288">Then, optimize performance tooremove or reduce hello effect of bottlenecks.</span></span> <span data-ttu-id="d5c9f-289">En fullständig beskrivning av Prestandadiagnos ligger utanför hello i den här artikeln, men här är några vanliga överväganden:</span><span class="sxs-lookup"><span data-stu-id="d5c9f-289">A full description of performance diagnosis is beyond hello scope of this article, but here are some common considerations:</span></span>

   * <span data-ttu-id="d5c9f-290">Avancerade funktioner:</span><span class="sxs-lookup"><span data-stu-id="d5c9f-290">Performance features:</span></span>
     * [<span data-ttu-id="d5c9f-291">Parallell kopia</span><span class="sxs-lookup"><span data-stu-id="d5c9f-291">Parallel copy</span></span>](#parallel-copy)
     * [<span data-ttu-id="d5c9f-292">Molnet data movement enheter</span><span class="sxs-lookup"><span data-stu-id="d5c9f-292">Cloud data movement units</span></span>](#cloud-data-movement-units)
     * [<span data-ttu-id="d5c9f-293">Stegvis kopia</span><span class="sxs-lookup"><span data-stu-id="d5c9f-293">Staged copy</span></span>](#staged-copy)
     * [<span data-ttu-id="d5c9f-294">Data Management Gateway skalbarhet</span><span class="sxs-lookup"><span data-stu-id="d5c9f-294">Data Management Gateway scalability</span></span>](data-factory-data-management-gateway-high-availability-scalability.md)
   * [<span data-ttu-id="d5c9f-295">Gateway för datahantering</span><span class="sxs-lookup"><span data-stu-id="d5c9f-295">Data Management Gateway</span></span>](#considerations-for-data-management-gateway)
   * [<span data-ttu-id="d5c9f-296">Källa</span><span class="sxs-lookup"><span data-stu-id="d5c9f-296">Source</span></span>](#considerations-for-the-source)
   * [<span data-ttu-id="d5c9f-297">Sink</span><span class="sxs-lookup"><span data-stu-id="d5c9f-297">Sink</span></span>](#considerations-for-the-sink)
   * [<span data-ttu-id="d5c9f-298">Serialisering och deserialisering</span><span class="sxs-lookup"><span data-stu-id="d5c9f-298">Serialization and deserialization</span></span>](#considerations-for-serialization-and-deserialization)
   * [<span data-ttu-id="d5c9f-299">Komprimering</span><span class="sxs-lookup"><span data-stu-id="d5c9f-299">Compression</span></span>](#considerations-for-compression)
   * [<span data-ttu-id="d5c9f-300">Kolumnmappningen</span><span class="sxs-lookup"><span data-stu-id="d5c9f-300">Column mapping</span></span>](#considerations-for-column-mapping)
   * [<span data-ttu-id="d5c9f-301">Andra överväganden</span><span class="sxs-lookup"><span data-stu-id="d5c9f-301">Other considerations</span></span>](#other-considerations)
3. <span data-ttu-id="d5c9f-302">**Expandera hello configuration tooyour hela datauppsättningen**.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-302">**Expand hello configuration tooyour entire data set**.</span></span> <span data-ttu-id="d5c9f-303">När du är nöjd med hello Körningsresultat och prestanda kan du expandera hello definition och pipeline aktiva period toocover hela datauppsättningen.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-303">When you're satisfied with hello execution results and performance, you can expand hello definition and pipeline active period toocover your entire data set.</span></span>

## <a name="considerations-for-data-management-gateway"></a><span data-ttu-id="d5c9f-304">Överväganden för Data Management Gateway</span><span class="sxs-lookup"><span data-stu-id="d5c9f-304">Considerations for Data Management Gateway</span></span>
<span data-ttu-id="d5c9f-305">**Installationsprogram för gateway**: Vi rekommenderar att du använder en särskild dator toohost Data Management Gateway.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-305">**Gateway setup**: We recommend that you use a dedicated machine toohost Data Management Gateway.</span></span> <span data-ttu-id="d5c9f-306">Se [överväganden för att använda Data Management Gateway](data-factory-data-management-gateway.md#considerations-for-using-gateway).</span><span class="sxs-lookup"><span data-stu-id="d5c9f-306">See [Considerations for using Data Management Gateway](data-factory-data-management-gateway.md#considerations-for-using-gateway).</span></span>  

<span data-ttu-id="d5c9f-307">**Gateway-övervakning och upp/skalbar**: en enskild logisk gateway med en eller flera gateway-noder kan hantera flera Kopieringsaktiviteten körs vid hello samma tid samtidigt.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-307">**Gateway monitoring and scale-up/out**: A single logical gateway with one or more gateway nodes can serve multiple Copy Activity runs at hello same time concurrently.</span></span> <span data-ttu-id="d5c9f-308">Du kan visa nära realtid ögonblicksbild av resursutnyttjande (CPU, minne, network(in/out) osv) på en gateway-dator samt hello antal samtidiga jobb som körs mot gräns i hello Azure-portalen finns [övervakaren gateway i hello portal](data-factory-data-management-gateway.md#monitor-gateway-in-the-portal).</span><span class="sxs-lookup"><span data-stu-id="d5c9f-308">You can view near-real time snapshot of resource utilization (CPU, memory, network(in/out), etc.) on a gateway machine as well as hello number of concurrent jobs running versus limit in hello Azure portal, see [Monitor gateway in hello portal](data-factory-data-management-gateway.md#monitor-gateway-in-the-portal).</span></span> <span data-ttu-id="d5c9f-309">Om du har tunga behov på hybrid dataflyttning med stort antal samtidiga kopiera aktiviteten körs eller med stora mängder data toocopy överväga för[skala upp eller ut gateway](data-factory-data-management-gateway-high-availability-scalability.md#scale-considerations) så toobetter använda din resurs eller tooprovision mer resurs tooempower kopiera.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-309">If you have heavy need on hybrid data movement either with large number of concurrent copy activity runs or with large volume of data toocopy, consider too[scale up or scale out gateway](data-factory-data-management-gateway-high-availability-scalability.md#scale-considerations) so as toobetter utilize your resource or tooprovision more resource tooempower copy.</span></span> 

## <a name="considerations-for-hello-source"></a><span data-ttu-id="d5c9f-310">Överväganden för hello källa</span><span class="sxs-lookup"><span data-stu-id="d5c9f-310">Considerations for hello source</span></span>
### <a name="general"></a><span data-ttu-id="d5c9f-311">Allmänt</span><span class="sxs-lookup"><span data-stu-id="d5c9f-311">General</span></span>
<span data-ttu-id="d5c9f-312">Var noga med att hello underliggande datalagret inte är överbelastad till följd av andra arbetsbelastningar som körs på eller i förhållande till den.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-312">Be sure that hello underlying data store is not overwhelmed by other workloads that are running on or against it.</span></span>

<span data-ttu-id="d5c9f-313">Microsoft datalager finns [övervaka och justera avsnitt](#performance-reference) som är specifika toodata butiker och hjälper dig att förstå data lagra prestandaegenskaper, minimera svarstider och maximera genomströmningen.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-313">For Microsoft data stores, see [monitoring and tuning topics](#performance-reference) that are specific toodata stores, and help you understand data store performance characteristics, minimize response times, and maximize throughput.</span></span>

<span data-ttu-id="d5c9f-314">Om du kopierar data från Blob storage tooSQL Data Warehouse, kan du använda **PolyBase** tooboost prestanda.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-314">If you copy data from Blob storage tooSQL Data Warehouse, consider using **PolyBase** tooboost performance.</span></span> <span data-ttu-id="d5c9f-315">Se [Använd PolyBase tooload data till Azure SQL Data Warehouse](data-factory-azure-sql-data-warehouse-connector.md#use-polybase-to-load-data-into-azure-sql-data-warehouse) mer information.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-315">See [Use PolyBase tooload data into Azure SQL Data Warehouse](data-factory-azure-sql-data-warehouse-connector.md#use-polybase-to-load-data-into-azure-sql-data-warehouse) for details.</span></span> <span data-ttu-id="d5c9f-316">En genomgång med ett användningsfall finns [läsa in 1 TB i Azure SQL Data Warehouse under 15 minuter med Azure Data Factory](data-factory-load-sql-data-warehouse.md).</span><span class="sxs-lookup"><span data-stu-id="d5c9f-316">For a walkthrough with a use case, see [Load 1 TB into Azure SQL Data Warehouse under 15 minutes with Azure Data Factory](data-factory-load-sql-data-warehouse.md).</span></span>

### <a name="file-based-data-stores"></a><span data-ttu-id="d5c9f-317">Filbaserade datakällor</span><span class="sxs-lookup"><span data-stu-id="d5c9f-317">File-based data stores</span></span>
<span data-ttu-id="d5c9f-318">*(Inklusive Blob-lagring, Data Lake Store, Amazon S3, lokalt filsystem och lokala HDFS)*</span><span class="sxs-lookup"><span data-stu-id="d5c9f-318">*(Includes Blob storage, Data Lake Store, Amazon S3, on-premises file systems, and on-premises HDFS)*</span></span>

* <span data-ttu-id="d5c9f-319">**Genomsnittlig storlek och antalet filer**: Kopieringsaktiviteten överför en fil i taget.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-319">**Average file size and file count**: Copy Activity transfers data one file at a time.</span></span> <span data-ttu-id="d5c9f-320">Med hello samma mängd data toobe flyttas, är hello totala genomflödet lägre om hello data består av flera små filer i stället för ett par stora filer på grund av toohello bootstrap fas för varje fil.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-320">With hello same amount of data toobe moved, hello overall throughput is lower if hello data consists of many small files rather than a few large files due toohello bootstrap phase for each file.</span></span> <span data-ttu-id="d5c9f-321">Därför om möjligt, kombinera små filer till större filer toogain högre genomströmning.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-321">Therefore, if possible, combine small files into larger files toogain higher throughput.</span></span>
* <span data-ttu-id="d5c9f-322">**Format och komprimering**: finns flera sätt tooimprove prestanda hello [överväganden för serialisering och deserialisering](#considerations-for-serialization-and-deserialization) och [överväganden för komprimering](#considerations-for-compression) avsnitt.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-322">**File format and compression**: For more ways tooimprove performance, see hello [Considerations for serialization and deserialization](#considerations-for-serialization-and-deserialization) and [Considerations for compression](#considerations-for-compression) sections.</span></span>
* <span data-ttu-id="d5c9f-323">För hello **lokalt filsystem** scenario där **Data Management Gateway** är krävs, se hello [överväganden för Data Management Gateway](#considerations-for-data-management-gateway) avsnitt.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-323">For hello **on-premises file system** scenario, in which **Data Management Gateway** is required, see hello [Considerations for Data Management Gateway](#considerations-for-data-management-gateway) section.</span></span>

### <a name="relational-data-stores"></a><span data-ttu-id="d5c9f-324">Lagrar relationsdata</span><span class="sxs-lookup"><span data-stu-id="d5c9f-324">Relational data stores</span></span>
<span data-ttu-id="d5c9f-325">*(Omfattar SQL-databasen. SQL Data Warehouse; Amazon Redshift; SQL Server-databaser. och Oracle, MySQL, DB2, Teradata, Sybase och PostgreSQL databaser osv.)*</span><span class="sxs-lookup"><span data-stu-id="d5c9f-325">*(Includes SQL Database; SQL Data Warehouse; Amazon Redshift; SQL Server databases; and Oracle, MySQL, DB2, Teradata, Sybase, and PostgreSQL databases, etc.)*</span></span>

* <span data-ttu-id="d5c9f-326">**Datamönster**: tabellens schema påverkar kopiera genomflöde.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-326">**Data pattern**: Your table schema affects copy throughput.</span></span> <span data-ttu-id="d5c9f-327">En stor Radstorleken ger en bättre prestanda än små Radstorleken, toocopy hello samma mängd data.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-327">A large row size gives you a better performance than small row size, toocopy hello same amount of data.</span></span> <span data-ttu-id="d5c9f-328">hello orsak är att databasen hello mer effektivt kan hämta färre batchar av data som innehåller färre rader.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-328">hello reason is that hello database can more efficiently retrieve fewer batches of data that contain fewer rows.</span></span>
* <span data-ttu-id="d5c9f-329">**Fråga eller lagrad procedur**: Optimera hello logiken för hello fråga eller en lagrad procedur som du anger i hello Kopieringsaktiviteten toofetch källdata mer effektivt.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-329">**Query or stored procedure**: Optimize hello logic of hello query or stored procedure you specify in hello Copy Activity source toofetch data more efficiently.</span></span>
* <span data-ttu-id="d5c9f-330">För **lokala relationsdatabaser**, till exempel SQL Server och Oracle, vilket kräver att hello använder **Data Management Gateway**, se hello [överväganden för Data Management Gateway](#considerations-on-data-management-gateway) avsnitt.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-330">For **on-premises relational databases**, such as SQL Server and Oracle, which require hello use of **Data Management Gateway**, see hello [Considerations for Data Management Gateway](#considerations-on-data-management-gateway) section.</span></span>

## <a name="considerations-for-hello-sink"></a><span data-ttu-id="d5c9f-331">Överväganden för hello sink</span><span class="sxs-lookup"><span data-stu-id="d5c9f-331">Considerations for hello sink</span></span>
### <a name="general"></a><span data-ttu-id="d5c9f-332">Allmänt</span><span class="sxs-lookup"><span data-stu-id="d5c9f-332">General</span></span>
<span data-ttu-id="d5c9f-333">Var noga med att hello underliggande datalagret inte är överbelastad till följd av andra arbetsbelastningar som körs på eller i förhållande till den.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-333">Be sure that hello underlying data store is not overwhelmed by other workloads that are running on or against it.</span></span>

<span data-ttu-id="d5c9f-334">Microsoft datalager finns för[övervaka och justera avsnitt](#performance-reference) som är specifika toodata Arkiv.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-334">For Microsoft data stores, refer too[monitoring and tuning topics](#performance-reference) that are specific toodata stores.</span></span> <span data-ttu-id="d5c9f-335">Dessa avsnitt kan hjälpa dig att förstå dataegenskaper store prestanda och hur toominimize svarstider och maximera genomströmningen.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-335">These topics can help you understand data store performance characteristics and how toominimize response times and maximize throughput.</span></span>

<span data-ttu-id="d5c9f-336">Om du kopierar data från **Blob storage** för**SQL Data Warehouse**, Överväg att använda **PolyBase** tooboost prestanda.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-336">If you are copying data from **Blob storage** too**SQL Data Warehouse**, consider using **PolyBase** tooboost performance.</span></span> <span data-ttu-id="d5c9f-337">Se [Använd PolyBase tooload data till Azure SQL Data Warehouse](data-factory-azure-sql-data-warehouse-connector.md#use-polybase-to-load-data-into-azure-sql-data-warehouse) mer information.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-337">See [Use PolyBase tooload data into Azure SQL Data Warehouse](data-factory-azure-sql-data-warehouse-connector.md#use-polybase-to-load-data-into-azure-sql-data-warehouse) for details.</span></span> <span data-ttu-id="d5c9f-338">En genomgång med ett användningsfall finns [läsa in 1 TB i Azure SQL Data Warehouse under 15 minuter med Azure Data Factory](data-factory-load-sql-data-warehouse.md).</span><span class="sxs-lookup"><span data-stu-id="d5c9f-338">For a walkthrough with a use case, see [Load 1 TB into Azure SQL Data Warehouse under 15 minutes with Azure Data Factory](data-factory-load-sql-data-warehouse.md).</span></span>

### <a name="file-based-data-stores"></a><span data-ttu-id="d5c9f-339">Filbaserade datakällor</span><span class="sxs-lookup"><span data-stu-id="d5c9f-339">File-based data stores</span></span>
<span data-ttu-id="d5c9f-340">*(Inklusive Blob-lagring, Data Lake Store, Amazon S3, lokalt filsystem och lokala HDFS)*</span><span class="sxs-lookup"><span data-stu-id="d5c9f-340">*(Includes Blob storage, Data Lake Store, Amazon S3, on-premises file systems, and on-premises HDFS)*</span></span>

* <span data-ttu-id="d5c9f-341">**Kopiera beteende**: Om du kopierar data från ett annat filbaserat dataarkiv Kopieringsaktiviteten har tre alternativ via hello **copyBehavior** egenskapen.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-341">**Copy behavior**: If you copy data from a different file-based data store, Copy Activity has three options via hello **copyBehavior** property.</span></span> <span data-ttu-id="d5c9f-342">Bevarar hierarki, förenklas hierarkin eller sammanfogar filer.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-342">It preserves hierarchy, flattens hierarchy, or merges files.</span></span> <span data-ttu-id="d5c9f-343">Bevara eller förenkla hierarkin har liten eller ingen prestanda försämras men Sammanfoga filer orsakar prestanda övergripande tooincrease.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-343">Either preserving or flattening hierarchy has little or no performance overhead, but merging files causes performance overhead tooincrease.</span></span>
* <span data-ttu-id="d5c9f-344">**Format och komprimering**: Se hello [överväganden för serialisering och deserialisering](#considerations-for-serialization-and-deserialization) och [överväganden för komprimering](#considerations-for-compression) avsnitt för mer sätt tooimprove prestanda .</span><span class="sxs-lookup"><span data-stu-id="d5c9f-344">**File format and compression**: See hello [Considerations for serialization and deserialization](#considerations-for-serialization-and-deserialization) and [Considerations for compression](#considerations-for-compression) sections for more ways tooimprove performance.</span></span>
* <span data-ttu-id="d5c9f-345">**BLOB storage**: för närvarande Blob storage stöder endast blockblobbar för optimerad dataöverföring och genomflöde.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-345">**Blob storage**: Currently, Blob storage supports only block blobs for optimized data transfer and throughput.</span></span>
* <span data-ttu-id="d5c9f-346">För **lokalt filsystem** scenarier som kräver hello användning av **Data Management Gateway**, se hello [överväganden för Data Management Gateway](#considerations-for-data-management-gateway) avsnitt.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-346">For **on-premises file systems** scenarios that require hello use of **Data Management Gateway**, see hello [Considerations for Data Management Gateway](#considerations-for-data-management-gateway) section.</span></span>

### <a name="relational-data-stores"></a><span data-ttu-id="d5c9f-347">Lagrar relationsdata</span><span class="sxs-lookup"><span data-stu-id="d5c9f-347">Relational data stores</span></span>
<span data-ttu-id="d5c9f-348">*(Omfattar SQL-databas, SQL Data Warehouse, SQL Server-databaser och Oracle-databaser)*</span><span class="sxs-lookup"><span data-stu-id="d5c9f-348">*(Includes SQL Database, SQL Data Warehouse, SQL Server databases, and Oracle databases)*</span></span>

* <span data-ttu-id="d5c9f-349">**Kopiera beteende**: beroende på hello egenskaper som har angetts för **sqlSink**, Kopieringsaktiviteten skriver data toohello måldatabasen på olika sätt.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-349">**Copy behavior**: Depending on hello properties you've set for **sqlSink**, Copy Activity writes data toohello destination database in different ways.</span></span>
  * <span data-ttu-id="d5c9f-350">Som standard hello hello data movement service använder hello Bulk Copy API tooinsert data i append läge, som ger bästa prestanda.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-350">By default, hello data movement service uses hello Bulk Copy API tooinsert data in append mode, which provides hello best performance.</span></span>
  * <span data-ttu-id="d5c9f-351">Om du konfigurerar en lagrad procedur i hello sink gäller hello en datarad samtidigt i stället för som en massinläsning hello-databasen.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-351">If you configure a stored procedure in hello sink, hello database applies hello data one row at a time instead of as a bulk load.</span></span> <span data-ttu-id="d5c9f-352">Datorns prestanda sjunker.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-352">Performance drops significantly.</span></span> <span data-ttu-id="d5c9f-353">Om din datauppsättning är stor, i förekommande fall, Överväg att byta toousing hello **sqlWriterCleanupScript** egenskapen.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-353">If your data set is large, when applicable, consider switching toousing hello **sqlWriterCleanupScript** property.</span></span>
  * <span data-ttu-id="d5c9f-354">Om du konfigurerar hello **sqlWriterCleanupScript** egenskap för varje kopia aktiviteten kör, hello tjänsten triggers hello skript och sedan använder hello Bulk Copy API tooinsert hello data.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-354">If you configure hello **sqlWriterCleanupScript** property for each Copy Activity run, hello service triggers hello script, and then you use hello Bulk Copy API tooinsert hello data.</span></span> <span data-ttu-id="d5c9f-355">Till exempel toooverwrite hello hela tabellen med hello senaste data, du kan ange ett skript toofirst ta bort alla poster innan nya data för massinläsning hello hello källa.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-355">For example, toooverwrite hello entire table with hello latest data, you can specify a script toofirst delete all records before bulk-loading hello new data from hello source.</span></span>
* <span data-ttu-id="d5c9f-356">**Mönstret och batch datastorleken**:</span><span class="sxs-lookup"><span data-stu-id="d5c9f-356">**Data pattern and batch size**:</span></span>
  * <span data-ttu-id="d5c9f-357">Tabellens schema påverkar kopiera genomflöde.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-357">Your table schema affects copy throughput.</span></span> <span data-ttu-id="d5c9f-358">toocopy Hej samma mängd data, en stor Radstorleken får du bättre prestanda än en liten Radstorleken eftersom hello databasen mer effektivt kan genomföra färre batchar av data.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-358">toocopy hello same amount of data, a large row size gives you better performance than a small row size because hello database can more efficiently commit fewer batches of data.</span></span>
  * <span data-ttu-id="d5c9f-359">Kopieringsaktiviteten infogar data i en serie med batchar.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-359">Copy Activity inserts data in a series of batches.</span></span> <span data-ttu-id="d5c9f-360">Du kan ange hello antalet rader i en batch med hello **writeBatchSize** egenskapen.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-360">You can set hello number of rows in a batch by using hello **writeBatchSize** property.</span></span> <span data-ttu-id="d5c9f-361">Om dina data har liten rader, kan du ange hello **writeBatchSize** egenskap med ett högre värde toobenefit från lägre batch kostnader och högre genomströmning.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-361">If your data has small rows, you can set hello **writeBatchSize** property with a higher value toobenefit from lower batch overhead and higher throughput.</span></span> <span data-ttu-id="d5c9f-362">Om hello Radstorleken på dina data är stor, var försiktig när du ökar **writeBatchSize**.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-362">If hello row size of your data is large, be careful when you increase **writeBatchSize**.</span></span> <span data-ttu-id="d5c9f-363">Ett högt värde kan det leda tooa kopia misslyckades på grund av överbelastning hello-databasen.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-363">A high value might lead tooa copy failure caused by overloading hello database.</span></span>
* <span data-ttu-id="d5c9f-364">För **lokala relationsdatabaser** som SQL Server och Oracle, vilket kräver att hello använder **Data Management Gateway**, se hello [överväganden för Data Management Gateway](#considerations-for-data-management-gateway) avsnitt.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-364">For **on-premises relational databases** like SQL Server and Oracle, which require hello use of **Data Management Gateway**, see hello [Considerations for Data Management Gateway](#considerations-for-data-management-gateway) section.</span></span>

### <a name="nosql-stores"></a><span data-ttu-id="d5c9f-365">NoSQL-lagringsplatser</span><span class="sxs-lookup"><span data-stu-id="d5c9f-365">NoSQL stores</span></span>
<span data-ttu-id="d5c9f-366">*(Omfattar tabellagring och Azure Cosmos DB)*</span><span class="sxs-lookup"><span data-stu-id="d5c9f-366">*(Includes Table storage and Azure Cosmos DB )*</span></span>

* <span data-ttu-id="d5c9f-367">För **tabell lagring**:</span><span class="sxs-lookup"><span data-stu-id="d5c9f-367">For **Table storage**:</span></span>
  * <span data-ttu-id="d5c9f-368">**Partitionen**: skriva data toointerleaved partitioner avsevärt försämrar prestanda.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-368">**Partition**: Writing data toointerleaved partitions dramatically degrades performance.</span></span> <span data-ttu-id="d5c9f-369">Sortera källdata av partitionsnyckel så att hello data infogas effektivt i en partition efter en annan eller justera hello logik toowrite hello data tooa enda partition.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-369">Sort your source data by partition key so that hello data is inserted efficiently into one partition after another, or adjust hello logic toowrite hello data tooa single partition.</span></span>
* <span data-ttu-id="d5c9f-370">För **Cosmos Azure DB**:</span><span class="sxs-lookup"><span data-stu-id="d5c9f-370">For **Azure Cosmos DB**:</span></span>
  * <span data-ttu-id="d5c9f-371">**Batchstorlek**: hello **writeBatchSize** egenskapen anger hello antalet parallella begäranden toohello Azure Cosmos DB toocreate servicedokument.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-371">**Batch size**: hello **writeBatchSize** property sets hello number of parallel requests toohello Azure Cosmos DB service toocreate documents.</span></span> <span data-ttu-id="d5c9f-372">Du kan förvänta dig bättre prestanda om du ökar **writeBatchSize** eftersom fler parallella begäranden skickas tooAzure Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-372">You can expect better performance when you increase **writeBatchSize** because more parallel requests are sent tooAzure Cosmos DB.</span></span> <span data-ttu-id="d5c9f-373">Dock bevaka begränsning när du skriver tooAzure Cosmos DB (hello felmeddelandet är ”begär frekvensen är stor”).</span><span class="sxs-lookup"><span data-stu-id="d5c9f-373">However, watch for throttling when you write tooAzure Cosmos DB (hello error message is "Request rate is large").</span></span> <span data-ttu-id="d5c9f-374">Olika faktorer kan orsaka begränsning hello antalet villkoren i hello dokument, inklusive dokumentets storlek och hello målsamlingen indexprincip.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-374">Various factors can cause throttling, including document size, hello number of terms in hello documents, and hello target collection's indexing policy.</span></span> <span data-ttu-id="d5c9f-375">tooachieve högre kopiera dataflöde, Överväg att använda en bättre samling, till exempel S3.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-375">tooachieve higher copy throughput, consider using a better collection, for example, S3.</span></span>

## <a name="considerations-for-serialization-and-deserialization"></a><span data-ttu-id="d5c9f-376">Överväganden för serialisering och deserialisering</span><span class="sxs-lookup"><span data-stu-id="d5c9f-376">Considerations for serialization and deserialization</span></span>
<span data-ttu-id="d5c9f-377">Serialisering och deserialisering kan inträffa när din inkommande datauppsättning eller datamängd för utdata är en fil.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-377">Serialization and deserialization can occur when your input data set or output data set is a file.</span></span> <span data-ttu-id="d5c9f-378">Se [stöds format och komprimering](data-factory-supported-file-and-compression-formats.md) med information om filformat som stöds av Kopieringsaktiviteten.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-378">See [Supported file and compression formats](data-factory-supported-file-and-compression-formats.md) with details on supported file formats by Copy Activity.</span></span>

<span data-ttu-id="d5c9f-379">**Kopiera beteende**:</span><span class="sxs-lookup"><span data-stu-id="d5c9f-379">**Copy behavior**:</span></span>

* <span data-ttu-id="d5c9f-380">Kopierar filer mellan filbaserade datalager:</span><span class="sxs-lookup"><span data-stu-id="d5c9f-380">Copying files between file-based data stores:</span></span>
  * <span data-ttu-id="d5c9f-381">När inkommande och utgående datauppsättningar som båda har hello samma eller inga inställningar för format, hello data movement service kör en binär kopia utan serialisering eller deserialisering.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-381">When input and output data sets both have hello same or no file format settings, hello data movement service executes a binary copy without any serialization or deserialization.</span></span> <span data-ttu-id="d5c9f-382">Du ser ett högre genomflöde jämfört med toohello scenario, i vilken hello källa och mottagare filen formatinställningar skiljer sig från varandra.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-382">You see a higher throughput compared toohello scenario, in which hello source and sink file format settings are different from each other.</span></span>
  * <span data-ttu-id="d5c9f-383">När indata och utdata datauppsättningar båda finns i textformat och endast hello kodning typen är olika, hello data movement service har endast kodning konvertering.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-383">When input and output data sets both are in text format and only hello encoding type is different, hello data movement service only does encoding conversion.</span></span> <span data-ttu-id="d5c9f-384">Den gör inte alla serialisering och deserialisering, vilket gör att vissa prestanda försämras jämförs tooa binära kopia.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-384">It doesn't do any serialization and deserialization, which causes some performance overhead compared tooa binary copy.</span></span>
  * <span data-ttu-id="d5c9f-385">När inkommande och utgående datauppsättningar båda har olika filformat eller olika konfigurationer som avgränsare, hello data movement service deserializes källa data toostream, transformera och serialisera det till hello utdataformat som du angett.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-385">When input and output data sets both have different file formats or different configurations, like delimiters, hello data movement service deserializes source data toostream, transform, and then serialize it into hello output format you indicated.</span></span> <span data-ttu-id="d5c9f-386">Den här åtgärden resulterar i en mycket större prestanda försämras jämfört med tooother scenarier.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-386">This operation results in a much more significant performance overhead compared tooother scenarios.</span></span>
* <span data-ttu-id="d5c9f-387">När du kopierar filer till eller från ett dataarkiv som inte är filbaserade (till exempel från ett filbaserat store tooa relationella store) krävs hello serialisering eller deserialisering steg.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-387">When you copy files to/from a data store that is not file-based (for example, from a file-based store tooa relational store), hello serialization or deserialization step is required.</span></span> <span data-ttu-id="d5c9f-388">Det här steget resulterar i betydande prestanda försämras.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-388">This step results in significant performance overhead.</span></span>

<span data-ttu-id="d5c9f-389">**Filformatet**: hello-filformat som du väljer kan påverka prestanda för kopia.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-389">**File format**: hello file format you choose might affect copy performance.</span></span> <span data-ttu-id="d5c9f-390">Avro är till exempel ett compact binärformat som lagrar metadata med data.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-390">For example, Avro is a compact binary format that stores metadata with data.</span></span> <span data-ttu-id="d5c9f-391">Det har brett stöd i hello Hadoop-ekosystemet för bearbetning och frågor.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-391">It has broad support in hello Hadoop ecosystem for processing and querying.</span></span> <span data-ttu-id="d5c9f-392">Avro är dock dyrare för serialisering och deserialisering, vilket resulterar i lägre kopiera genomflöde jämfört med tootext format.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-392">However, Avro is more expensive for serialization and deserialization, which results in lower copy throughput compared tootext format.</span></span> <span data-ttu-id="d5c9f-393">Kontrollera ditt val av filformatet i hela hello processchema helhetsmässigt.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-393">Make your choice of file format throughout hello processing flow holistically.</span></span> <span data-ttu-id="d5c9f-394">Börja med vilka formuläret hello data lagras i, käll-datalager eller toobe extraheras från externa system. hello bästa format för lagring, analytisk bearbetning och frågar; och i vilket format hello data ska exporteras till dataarkiv för rapportering och visualisering verktyg.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-394">Start with what form hello data is stored in, source data stores or toobe extracted from external systems; hello best format for storage, analytical processing, and querying; and in what format hello data should be exported into data marts for reporting and visualization tools.</span></span> <span data-ttu-id="d5c9f-395">Ibland ett format som är något sämre för läsa och skriva prestanda kan vara bra när du hello övergripande analytiska processen.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-395">Sometimes a file format that is suboptimal for read and write performance might be a good choice when you consider hello overall analytical process.</span></span>

## <a name="considerations-for-compression"></a><span data-ttu-id="d5c9f-396">Överväganden för komprimering</span><span class="sxs-lookup"><span data-stu-id="d5c9f-396">Considerations for compression</span></span>
<span data-ttu-id="d5c9f-397">När din inkommande eller utgående data är en fil, kan du ange Kopieringsaktiviteten tooperform komprimering eller dekomprimering som skriver data toohello mål.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-397">When your input or output data set is a file, you can set Copy Activity tooperform compression or decompression as it writes data toohello destination.</span></span> <span data-ttu-id="d5c9f-398">När du väljer komprimering kan du göra en kompromiss mellan indata/utdata (I/O) och processor.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-398">When you choose compression, you make a tradeoff between input/output (I/O) and CPU.</span></span> <span data-ttu-id="d5c9f-399">Komprimera data hello beräkningsresurser extra kostnader.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-399">Compressing hello data costs extra in compute resources.</span></span> <span data-ttu-id="d5c9f-400">Men i RETUR minskas från nätverket och lagring.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-400">But in return, it reduces network I/O and storage.</span></span> <span data-ttu-id="d5c9f-401">Beroende på dina data, kan du se en höjning av den totala kopiera genomflödet.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-401">Depending on your data, you may see a boost in overall copy throughput.</span></span>

<span data-ttu-id="d5c9f-402">**Codec**: Kopieringsaktiviteten stöder gzip, bzip2 och Deflate komprimeringstyper.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-402">**Codec**: Copy Activity supports gzip, bzip2, and Deflate compression types.</span></span> <span data-ttu-id="d5c9f-403">Azure HDInsight kan använda alla tre typer för bearbetning.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-403">Azure HDInsight can consume all three types for processing.</span></span> <span data-ttu-id="d5c9f-404">Varje komprimerings-codec har fördelar.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-404">Each compression codec has advantages.</span></span> <span data-ttu-id="d5c9f-405">Till exempel bzip2 har hello lägsta kopiera dataflöde, men du får hello bästa Hive frågeprestanda med bzip2 eftersom du kan dela för bearbetning.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-405">For example, bzip2 has hello lowest copy throughput, but you get hello best Hive query performance with bzip2 because you can split it for processing.</span></span> <span data-ttu-id="d5c9f-406">Gzip är hello mest belastningsutjämnade alternativ och den används hello oftast.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-406">Gzip is hello most balanced option, and it is used hello most often.</span></span> <span data-ttu-id="d5c9f-407">Välj hello codec som passar bäst för ditt scenario för slutpunkt till slutpunkt.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-407">Choose hello codec that best suits your end-to-end scenario.</span></span>

<span data-ttu-id="d5c9f-408">**Nivå**: du kan välja mellan två alternativ för varje komprimerings-codec: snabbaste komprimerade och optimalt komprimerade.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-408">**Level**: You can choose from two options for each compression codec: fastest compressed and optimally compressed.</span></span> <span data-ttu-id="d5c9f-409">hello komprimerar snabbaste komprimerade alternativet hello data så snabbt som möjligt, även om hello resulterande filen inte komprimeras optimalt.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-409">hello fastest compressed option compresses hello data as quickly as possible, even if hello resulting file is not optimally compressed.</span></span> <span data-ttu-id="d5c9f-410">hello optimalt komprimerade alternativet ägnar mer tid åt komprimering och ger en minimal mängd data.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-410">hello optimally compressed option spends more time on compression and yields a minimal amount of data.</span></span> <span data-ttu-id="d5c9f-411">Du kan testa båda alternativen toosee som ger bättre prestanda i ditt fall.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-411">You can test both options toosee which provides better overall performance in your case.</span></span>

<span data-ttu-id="d5c9f-412">**En faktor**: toocopy stora mängder data mellan en lokal lagring och hello moln, Överväg att använda tillfälliga blob-lagring med komprimering.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-412">**A consideration**: toocopy a large amount of data between an on-premises store and hello cloud, consider using interim blob storage with compression.</span></span> <span data-ttu-id="d5c9f-413">Det är praktiskt att använda mellanlagring när hello bandbredd i företagets nätverk och Azure-tjänster är hello begränsande faktor och du vill hello indata datauppsättning och utdata ange båda toobe okomprimerad.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-413">Using interim storage is helpful when hello bandwidth of your corporate network and your Azure services is hello limiting factor, and you want hello input data set and output data set both toobe in uncompressed form.</span></span> <span data-ttu-id="d5c9f-414">Mer specifikt kan du dela upp en enda kopia aktivitet i två kopiera aktiviteter.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-414">More specifically, you can break a single copy activity into two copy activities.</span></span> <span data-ttu-id="d5c9f-415">hello första kopiera aktiviteten kopieras från hello källa tooan interim eller fristående blob i komprimerat format.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-415">hello first copy activity copies from hello source tooan interim or staging blob in compressed form.</span></span> <span data-ttu-id="d5c9f-416">hello andra kopieringsaktiviteten kopierar hello komprimerade data från mellanlagring och expanderar sedan medan skriver toohello mottagare.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-416">hello second copy activity copies hello compressed data from staging, and then decompresses while it writes toohello sink.</span></span>

## <a name="considerations-for-column-mapping"></a><span data-ttu-id="d5c9f-417">Överväganden för kolumnmappningen</span><span class="sxs-lookup"><span data-stu-id="d5c9f-417">Considerations for column mapping</span></span>
<span data-ttu-id="d5c9f-418">Du kan ange hello **columnMappings** egenskap i Kopieringsaktiviteten toomap alla eller en delmängd av hello indatakolumnerna kolumner toohello utdata.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-418">You can set hello **columnMappings** property in Copy Activity toomap all or a subset of hello input columns toohello output columns.</span></span> <span data-ttu-id="d5c9f-419">När hello data movement service läser hello data från hello källa, måste tooperform kolumnmappningen på hello data innan skrivning hello data toohello mottagare.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-419">After hello data movement service reads hello data from hello source, it needs tooperform column mapping on hello data before it writes hello data toohello sink.</span></span> <span data-ttu-id="d5c9f-420">Den här extra bearbetning minskar kopiera genomflöde.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-420">This extra processing reduces copy throughput.</span></span>

<span data-ttu-id="d5c9f-421">Om källa datalager frågbar kan till exempel om det är en relationell butik som SQL Database eller SQL Server, eller om det är en NoSQL-butiken som Table storage eller Azure Cosmos DB du sänder hello kolumnen filtrering och omordning logik toohello **fråga**  egenskapen istället för att använda kolumnmappningen.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-421">If your source data store is queryable, for example, if it's a relational store like SQL Database or SQL Server, or if it's a NoSQL store like Table storage or Azure Cosmos DB, consider pushing hello column filtering and reordering logic toohello **query** property instead of using column mapping.</span></span> <span data-ttu-id="d5c9f-422">Det här sättet inträffar hello projektion när hello data movement service läser data från hello källdata store, där det är mycket effektivare.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-422">This way, hello projection occurs while hello data movement service reads data from hello source data store, where it is much more efficient.</span></span>

## <a name="other-considerations"></a><span data-ttu-id="d5c9f-423">Andra överväganden</span><span class="sxs-lookup"><span data-stu-id="d5c9f-423">Other considerations</span></span>
<span data-ttu-id="d5c9f-424">Om hello storlek logik toofurther partition hello företagsdata med hjälp av du vill använda toocopy är stor, kan du justera hello segmentering mekanism i Data Factory.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-424">If hello size of data you want toocopy is large, you can adjust your business logic toofurther partition hello data using hello slicing mechanism in Data Factory.</span></span> <span data-ttu-id="d5c9f-425">Schemalägg sedan Kopieringsaktiviteten toorun oftare tooreduce hello Datastorlek för varje kopia-aktivitet körs.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-425">Then, schedule Copy Activity toorun more frequently tooreduce hello data size for each Copy Activity run.</span></span>

<span data-ttu-id="d5c9f-426">Vara försiktig hello antal datauppsättningar och kopiera aktiviteter som kräver Data Factory tooconnector toohello samma datalager på hello samma tid.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-426">Be cautious about hello number of data sets and copy activities requiring Data Factory tooconnector toohello same data store at hello same time.</span></span> <span data-ttu-id="d5c9f-427">Många samtidiga kopiera jobb kan begränsa ett datalager och lead toodegraded prestanda, kopiera jobbet interna försök, och i vissa fall, fel vid körning.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-427">Many concurrent copy jobs might throttle a data store and lead toodegraded performance, copy job internal retries, and in some cases, execution failures.</span></span>

## <a name="sample-scenario-copy-from-an-on-premises-sql-server-tooblob-storage"></a><span data-ttu-id="d5c9f-428">Exempelscenario: kopiera från en lokal SQL Server tooBlob lagringsplats</span><span class="sxs-lookup"><span data-stu-id="d5c9f-428">Sample scenario: Copy from an on-premises SQL Server tooBlob storage</span></span>
<span data-ttu-id="d5c9f-429">**Scenariot**: en pipeline bygger toocopy data från en lokal SQL Server tooBlob lagring i CSV-format.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-429">**Scenario**: A pipeline is built toocopy data from an on-premises SQL Server tooBlob storage in CSV format.</span></span> <span data-ttu-id="d5c9f-430">toomake Hej kopieringsjobbet snabbare, hello CSV-filer ska komprimeras till bzip2 format.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-430">toomake hello copy job faster, hello CSV files should be compressed into bzip2 format.</span></span>

<span data-ttu-id="d5c9f-431">**Test- och**: hello genomflödet i Kopieringsaktiviteten är mindre än 2 Mbit/s som är mycket långsammare än hello prestanda prestandamått.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-431">**Test and analysis**: hello throughput of Copy Activity is less than 2 MBps, which is much slower than hello performance benchmark.</span></span>

<span data-ttu-id="d5c9f-432">**Prestandaanalys och justera**: tootroubleshoot Hej prestandaproblem, ska vi titta på hur hello data behandlas och flyttas.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-432">**Performance analysis and tuning**: tootroubleshoot hello performance issue, let’s look at how hello data is processed and moved.</span></span>

1. <span data-ttu-id="d5c9f-433">**Läsa data**: Gateway öppnar en anslutning tooSQL Server och skickar hello frågan.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-433">**Read data**: Gateway opens a connection tooSQL Server and sends hello query.</span></span> <span data-ttu-id="d5c9f-434">SQL Server svarar genom att skicka hello data dataströmmen tooGateway via hello intranät.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-434">SQL Server responds by sending hello data stream tooGateway via hello intranet.</span></span>
2. <span data-ttu-id="d5c9f-435">**Serialisera och komprimera data**: Gateway Serialiserar hello dataformat dataströmmen tooCSV och komprimerar hello dataströmmen tooa bzip2.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-435">**Serialize and compress data**: Gateway serializes hello data stream tooCSV format, and compresses hello data tooa bzip2 stream.</span></span>
3. <span data-ttu-id="d5c9f-436">**Skriva data**: Gateway överför hello bzip2 dataströmmen tooBlob lagring via hello Internet.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-436">**Write data**: Gateway uploads hello bzip2 stream tooBlob storage via hello Internet.</span></span>

<span data-ttu-id="d5c9f-437">Som du ser hello data håller på att behandlas och flyttas i strömmande ordning: SQL Server > LAN > Gateway > WAN > Blob storage.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-437">As you can see, hello data is being processed and moved in a streaming sequential manner: SQL Server > LAN > Gateway > WAN > Blob storage.</span></span> <span data-ttu-id="d5c9f-438">**hello prestandan är gated av hello minsta dataflöde över hello pipeline**.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-438">**hello overall performance is gated by hello minimum throughput across hello pipeline**.</span></span>

![Dataflöde](./media/data-factory-copy-activity-performance/case-study-pic-1.png)

<span data-ttu-id="d5c9f-440">En eller flera av följande faktorer hello orsaka hello flaskhalsar:</span><span class="sxs-lookup"><span data-stu-id="d5c9f-440">One or more of hello following factors might cause hello performance bottleneck:</span></span>

* <span data-ttu-id="d5c9f-441">**Källan**: SQL Server har låg genomströmning på grund av tunga laster.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-441">**Source**: SQL Server itself has low throughput because of heavy loads.</span></span>
* <span data-ttu-id="d5c9f-442">**Data Management Gateway**:</span><span class="sxs-lookup"><span data-stu-id="d5c9f-442">**Data Management Gateway**:</span></span>
  * <span data-ttu-id="d5c9f-443">**LAN**: Gateway finns är långt från hello SQL Server-dator och har en långsam anslutning.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-443">**LAN**: Gateway is located far from hello SQL Server machine and has a low-bandwidth connection.</span></span>
  * <span data-ttu-id="d5c9f-444">**Gateway**: Gateway har nått sin belastningen begränsningar tooperform hello följande åtgärder:</span><span class="sxs-lookup"><span data-stu-id="d5c9f-444">**Gateway**: Gateway has reached its load limitations tooperform hello following operations:</span></span>
    * <span data-ttu-id="d5c9f-445">**Serialisering**: serialiseringen hello data dataströmmen tooCSV format har långsam genomflöde.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-445">**Serialization**: Serializing hello data stream tooCSV format has slow throughput.</span></span>
    * <span data-ttu-id="d5c9f-446">**Komprimering**: du har valt en långsam komprimerings-codec (till exempel bzip2, vilket är 2,8 Mbit/s med Core i7).</span><span class="sxs-lookup"><span data-stu-id="d5c9f-446">**Compression**: You chose a slow compression codec (for example, bzip2, which is 2.8 MBps with Core i7).</span></span>
  * <span data-ttu-id="d5c9f-447">**WAN**: hello bandbredden mellan hello företagsnätverket och Azure-tjänster är låg (till exempel T1 = 1,544 kbit/s; T2 = 6,312 kbit/s).</span><span class="sxs-lookup"><span data-stu-id="d5c9f-447">**WAN**: hello bandwidth between hello corporate network and your Azure services is low (for example, T1 = 1,544 kbps; T2 = 6,312 kbps).</span></span>
* <span data-ttu-id="d5c9f-448">**Sink**: Blob storage har låg genomströmning.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-448">**Sink**: Blob storage has low throughput.</span></span> <span data-ttu-id="d5c9f-449">(Det här scenariot är inte troligt eftersom dess SLA garanterar minst 60 Mbit/s).</span><span class="sxs-lookup"><span data-stu-id="d5c9f-449">(This scenario is unlikely because its SLA guarantees a minimum of 60 MBps.)</span></span>

<span data-ttu-id="d5c9f-450">I det här fallet kan bzip2 datakomprimering långsammare hello hela pipeline.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-450">In this case, bzip2 data compression might be slowing down hello entire pipeline.</span></span> <span data-ttu-id="d5c9f-451">Växla tooa gzip komprimerings-codec kan underlättar den här begränsningen.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-451">Switching tooa gzip compression codec might ease this bottleneck.</span></span>

## <a name="sample-scenarios-use-parallel-copy"></a><span data-ttu-id="d5c9f-452">Exempelscenarier: Använd parallella kopia</span><span class="sxs-lookup"><span data-stu-id="d5c9f-452">Sample scenarios: Use parallel copy</span></span>
<span data-ttu-id="d5c9f-453">**Scenariot I:** kopiera 1 000 MB-1-filer från hello lokalt system tooBlob lagring.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-453">**Scenario I:** Copy 1,000 1-MB files from hello on-premises file system tooBlob storage.</span></span>

<span data-ttu-id="d5c9f-454">**Analys- och prestandajustering**: T.ex, om du har installerat gateway på en dator i fyra kärnor Data Factory använder 16 parallella kopierar toomove filer från hello fillagring system tooBlob samtidigt.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-454">**Analysis and performance tuning**: For an example, if you have installed gateway on a quad core machine, Data Factory uses 16 parallel copies toomove files from hello file system tooBlob storage concurrently.</span></span> <span data-ttu-id="d5c9f-455">Den här parallellkörning resulterar i högt dataflöde.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-455">This parallel execution should result in high throughput.</span></span> <span data-ttu-id="d5c9f-456">Du kan också explicit ange hello parallella kopior count.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-456">You also can explicitly specify hello parallel copies count.</span></span> <span data-ttu-id="d5c9f-457">När du kopierar många små filer, hjälpa parallella kopior kraftigt genomströmning effektivare användning av resurser.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-457">When you copy many small files, parallel copies dramatically help throughput by using resources more effectively.</span></span>

![Scenario 1](./media/data-factory-copy-activity-performance/scenario-1.png)

<span data-ttu-id="d5c9f-459">**Scenariot II**: kopiera 20 blobbar 500 MB från Blob storage tooData Lake Store Analytics och justera prestanda.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-459">**Scenario II**: Copy 20 blobs of 500 MB each from Blob storage tooData Lake Store Analytics, and then tune performance.</span></span>

<span data-ttu-id="d5c9f-460">**Analys- och prestandajustering**: I det här scenariot kopierar Data Factory hello data från Blob storage tooData Lake Store med hjälp av en kopia (**parallelCopies** ange too1) och enkel molndata flytt enheter.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-460">**Analysis and performance tuning**: In this scenario, Data Factory copies hello data from Blob storage tooData Lake Store by using single-copy (**parallelCopies** set too1) and single-cloud data movement units.</span></span> <span data-ttu-id="d5c9f-461">hello genomströmning du se blir Stäng toothat som beskrivs i hello [prestanda referensavsnitt](#performance-reference).</span><span class="sxs-lookup"><span data-stu-id="d5c9f-461">hello throughput you observe will be close toothat described in hello [performance reference section](#performance-reference).</span></span>   

![Scenario 2](./media/data-factory-copy-activity-performance/scenario-2.png)

<span data-ttu-id="d5c9f-463">**Scenariot III**: enskilda filstorlek är större än dussintals MB och total volym är stor.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-463">**Scenario III**: Individual file size is greater than dozens of MBs and total volume is large.</span></span>

<span data-ttu-id="d5c9f-464">**Analys- och aktivera prestanda**: öka **parallelCopies** inte resulterar i bättre copy prestanda på grund av hello resursbegränsningar av ett enda moln dmu här.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-464">**Analysis and performance turning**: Increasing **parallelCopies** doesn't result in better copy performance because of hello resource limitations of a single-cloud DMU.</span></span> <span data-ttu-id="d5c9f-465">I stället bör du ange mer molnet DMUs tooget mer resurser tooperform hello dataflyttning.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-465">Instead, you should specify more cloud DMUs tooget more resources tooperform hello data movement.</span></span> <span data-ttu-id="d5c9f-466">Ange inte ett värde för hello **parallelCopies** egenskapen.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-466">Do not specify a value for hello **parallelCopies** property.</span></span> <span data-ttu-id="d5c9f-467">Data Factory hanterar hello parallellitet för dig.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-467">Data Factory handles hello parallelism for you.</span></span> <span data-ttu-id="d5c9f-468">I det här fallet, om du ställer in **cloudDataMovementUnits** too4, en genomströmning på ungefär fyra gånger inträffar.</span><span class="sxs-lookup"><span data-stu-id="d5c9f-468">In this case, if you set **cloudDataMovementUnits** too4, a throughput of about four times occurs.</span></span>

![Scenario 3](./media/data-factory-copy-activity-performance/scenario-3.png)

## <a name="reference"></a><span data-ttu-id="d5c9f-470">Referens</span><span class="sxs-lookup"><span data-stu-id="d5c9f-470">Reference</span></span>
<span data-ttu-id="d5c9f-471">Här är övervakning av programprestanda och justera referenser för några av datalager för hello stöds:</span><span class="sxs-lookup"><span data-stu-id="d5c9f-471">Here are performance monitoring and tuning references for some of hello supported data stores:</span></span>

* <span data-ttu-id="d5c9f-472">Azure-lagring (inklusive Blob storage och Table storage): [skalbarhetsmål för Azure Storage](../storage/common/storage-scalability-targets.md) och [Azure Storage checklistan för prestanda och skalbarhet](../storage/common/storage-performance-checklist.md)</span><span class="sxs-lookup"><span data-stu-id="d5c9f-472">Azure Storage (including Blob storage and Table storage): [Azure Storage scalability targets](../storage/common/storage-scalability-targets.md) and [Azure Storage performance and scalability checklist](../storage/common/storage-performance-checklist.md)</span></span>
* <span data-ttu-id="d5c9f-473">Azure SQL Database: Du kan [övervaka hello prestanda](../sql-database/sql-database-single-database-monitor.md) och kontrollera hello databasen transaktion enhet (DTU) procent</span><span class="sxs-lookup"><span data-stu-id="d5c9f-473">Azure SQL Database: You can [monitor hello performance](../sql-database/sql-database-single-database-monitor.md) and check hello database transaction unit (DTU) percentage</span></span>
* <span data-ttu-id="d5c9f-474">Azure SQL Data Warehouse: Sin förmåga mäts i informationslagerenheter (dwu: er); Se [hantera beräkningskraft i Azure SQL Data Warehouse (översikt)](../sql-data-warehouse/sql-data-warehouse-manage-compute-overview.md)</span><span class="sxs-lookup"><span data-stu-id="d5c9f-474">Azure SQL Data Warehouse: Its capability is measured in data warehouse units (DWUs); see [Manage compute power in Azure SQL Data Warehouse (Overview)](../sql-data-warehouse/sql-data-warehouse-manage-compute-overview.md)</span></span>
* <span data-ttu-id="d5c9f-475">Azure Cosmos DB: [prestandanivåer i Azure Cosmos DB](../documentdb/documentdb-performance-levels.md)</span><span class="sxs-lookup"><span data-stu-id="d5c9f-475">Azure Cosmos DB: [Performance levels in Azure Cosmos DB](../documentdb/documentdb-performance-levels.md)</span></span>
* <span data-ttu-id="d5c9f-476">Lokal SQL Server: [övervakaren och finjustera för prestanda](https://msdn.microsoft.com/library/ms189081.aspx)</span><span class="sxs-lookup"><span data-stu-id="d5c9f-476">On-premises SQL Server: [Monitor and tune for performance](https://msdn.microsoft.com/library/ms189081.aspx)</span></span>
* <span data-ttu-id="d5c9f-477">Lokala filserver: [prestandajustering för filservrar](https://msdn.microsoft.com/library/dn567661.aspx)</span><span class="sxs-lookup"><span data-stu-id="d5c9f-477">On-premises file server: [Performance tuning for file servers](https://msdn.microsoft.com/library/dn567661.aspx)</span></span>
