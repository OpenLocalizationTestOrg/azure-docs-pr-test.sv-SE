---
title: "aaaHow tooControl inkommande trafik tooan Apptjänstmiljö"
description: "Läs mer om hur tooconfigure network security regler toocontrol inkommande trafik tooan Apptjänst-miljö."
services: app-service
documentationcenter: 
author: ccompy
manager: erikre
editor: 
ms.assetid: 4cc82439-8791-48a4-9485-de6d8e1d1a08
ms.service: app-service
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 01/11/2017
ms.author: stefsch
ms.openlocfilehash: e7c6e6201db6a1ea77f7a2eee29a3b5445175495
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 10/06/2017
---
# <a name="how-toocontrol-inbound-traffic-tooan-app-service-environment"></a><span data-ttu-id="374cd-103">Hur tooControl inkommande trafik tooan Apptjänstmiljö</span><span class="sxs-lookup"><span data-stu-id="374cd-103">How tooControl Inbound Traffic tooan App Service Environment</span></span>
## <a name="overview"></a><span data-ttu-id="374cd-104">Översikt</span><span class="sxs-lookup"><span data-stu-id="374cd-104">Overview</span></span>
<span data-ttu-id="374cd-105">En Apptjänst-miljö kan skapas i **antingen** ett virtuellt nätverk i Azure Resource Manager **eller** klassiska distributionsmodellen [virtuellt nätverk][virtualnetwork].</span><span class="sxs-lookup"><span data-stu-id="374cd-105">An App Service Environment can be created in **either** an Azure Resource Manager virtual network, **or** a classic deployment model [virtual network][virtualnetwork].</span></span>  <span data-ttu-id="374cd-106">Ett nytt virtuellt nätverk och ett nytt undernät kan definieras när hello en Apptjänst-miljö skapas.</span><span class="sxs-lookup"><span data-stu-id="374cd-106">A new virtual network and new subnet can be defined at hello time an App Service Environment is created.</span></span>  <span data-ttu-id="374cd-107">Alternativt kan en Apptjänst-miljö skapas i ett befintligt virtuellt nätverk och befintlig undernät.</span><span class="sxs-lookup"><span data-stu-id="374cd-107">Alternatively, an App Service Environment can be created in a pre-existing virtual network and pre-existing subnet.</span></span>  <span data-ttu-id="374cd-108">Med en ändring som gjorts i juni 2016 distribueras ASEs också till virtuella nätverk som använder offentliga-adressintervall eller RFC1918 adressutrymmen (d.v.s. privata adresser).</span><span class="sxs-lookup"><span data-stu-id="374cd-108">With a change made in June 2016, ASEs can also be deployed into virtual networks that use either public address ranges, or RFC1918 address spaces (i.e. private addresses).</span></span>  <span data-ttu-id="374cd-109">Mer information om hur du skapar en Apptjänst-miljö finns [hur tooCreate en Apptjänstmiljö][HowToCreateAnAppServiceEnvironment].</span><span class="sxs-lookup"><span data-stu-id="374cd-109">For more details on creating an App Service Environment see [How tooCreate an App Service Environment][HowToCreateAnAppServiceEnvironment].</span></span>

<span data-ttu-id="374cd-110">En Apptjänst-miljö måste alltid skapas i ett undernät eftersom ett undernät ger en nätverksgräns som kan vara används toolock ned inkommande trafik bakom överordnade enheter och tjänster så att HTTP och HTTPS-trafik tillåts endast från specifika överordnad IP-adresser.</span><span class="sxs-lookup"><span data-stu-id="374cd-110">An App Service Environment must always be created within a subnet because a subnet provides a network boundary which can be used toolock down inbound traffic behind upstream devices and services such that HTTP and HTTPS traffic is only accepted from specific upstream IP addresses.</span></span>

<span data-ttu-id="374cd-111">Inkommande och utgående nätverkstrafik på ett undernät kontrolleras med en [nätverkssäkerhetsgruppen][NetworkSecurityGroups].</span><span class="sxs-lookup"><span data-stu-id="374cd-111">Inbound and outbound network traffic on a subnet is controlled using a [network security group][NetworkSecurityGroups].</span></span> <span data-ttu-id="374cd-112">Kontrollera inkommande trafik kräver att skapa Nätverkssäkerhetsregler i en nätverkssäkerhetsgrupp och sedan tilldela hello network security grupp hello undernät som innehåller hello Apptjänst-miljö.</span><span class="sxs-lookup"><span data-stu-id="374cd-112">Controlling inbound traffic requires creating network security rules in a network security group, and then assigning hello network security group hello subnet containing hello App Service Environment.</span></span>

<span data-ttu-id="374cd-113">När en nätverkssäkerhetsgrupp har tilldelats tooa undernät, inkommande trafik tooapps i Apptjänst-miljö är tillåtet/blockeras baserat på hello hello tillåta och neka regler som definierats i hello nätverkssäkerhetsgruppen.</span><span class="sxs-lookup"><span data-stu-id="374cd-113">Once a network security group is assigned tooa subnet, inbound traffic tooapps in hello App Service Environment is allowed/blocked based on hello allow and deny rules defined in hello network security group.</span></span>

[!INCLUDE [app-service-web-to-api-and-mobile](../../includes/app-service-web-to-api-and-mobile.md)]

## <a name="inbound-network-ports-used-in-an-app-service-environment"></a><span data-ttu-id="374cd-114">Inkommande nätverksportar som används i en Apptjänst-miljö</span><span class="sxs-lookup"><span data-stu-id="374cd-114">Inbound Network Ports Used in an App Service Environment</span></span>
<span data-ttu-id="374cd-115">Innan du låsa inkommande nätverkstrafik till en nätverkssäkerhetsgruppen är viktiga tooknow hello obligatoriska och valfria nätverksportar som används av en Apptjänst-miljö.</span><span class="sxs-lookup"><span data-stu-id="374cd-115">Before locking down inbound network traffic with a network security group, it is important tooknow hello set of required and optional network ports used by an App Service Environment.</span></span>  <span data-ttu-id="374cd-116">Stänger av misstag av trafik toosome portar kan resultera i förlust av funktioner i en Apptjänst-miljö.</span><span class="sxs-lookup"><span data-stu-id="374cd-116">Accidentally closing off traffic toosome ports can result in loss of functionality in an App Service Environment.</span></span>

<span data-ttu-id="374cd-117">hello följer en lista över portar som används av en Apptjänst-miljö.</span><span class="sxs-lookup"><span data-stu-id="374cd-117">hello following is a list of ports used by an App Service Environment.</span></span> <span data-ttu-id="374cd-118">Alla portar **TCP**, såvida inte annat anges tydligt:</span><span class="sxs-lookup"><span data-stu-id="374cd-118">All ports are **TCP**, unless otherwise clearly noted:</span></span>

* <span data-ttu-id="374cd-119">454: **krävs port** används av Azure-infrastrukturen för att hantera och underhålla Apptjänstmiljöer via SSL.</span><span class="sxs-lookup"><span data-stu-id="374cd-119">454:  **Required port** used by Azure infrastructure for managing and maintaining App Service Environments via SSL.</span></span>  <span data-ttu-id="374cd-120">Inte blockera trafik toothis port.</span><span class="sxs-lookup"><span data-stu-id="374cd-120">Do not block traffic toothis port.</span></span>  <span data-ttu-id="374cd-121">Den här porten är alltid bundna toohello offentliga VIP för en ASE.</span><span class="sxs-lookup"><span data-stu-id="374cd-121">This port is always bound toohello public VIP of an ASE.</span></span>
* <span data-ttu-id="374cd-122">455: **krävs port** används av Azure-infrastrukturen för att hantera och underhålla Apptjänstmiljöer via SSL.</span><span class="sxs-lookup"><span data-stu-id="374cd-122">455:  **Required port** used by Azure infrastructure for managing and maintaining App Service Environments via SSL.</span></span>  <span data-ttu-id="374cd-123">Inte blockera trafik toothis port.</span><span class="sxs-lookup"><span data-stu-id="374cd-123">Do not block traffic toothis port.</span></span>  <span data-ttu-id="374cd-124">Den här porten är alltid bundna toohello offentliga VIP för en ASE.</span><span class="sxs-lookup"><span data-stu-id="374cd-124">This port is always bound toohello public VIP of an ASE.</span></span>
* <span data-ttu-id="374cd-125">80: standardport för inkommande HTTP-trafik tooapps körs i App Service-planer i en Apptjänst-miljö.</span><span class="sxs-lookup"><span data-stu-id="374cd-125">80:  Default port for inbound HTTP traffic tooapps running in App Service Plans in an App Service Environment.</span></span>  <span data-ttu-id="374cd-126">Den här porten är på en ILB-aktiverade ASE bundna toohello ILB adressen hello ASE.</span><span class="sxs-lookup"><span data-stu-id="374cd-126">On an ILB-enabled ASE, this port is bound toohello ILB address of hello ASE.</span></span>
* <span data-ttu-id="374cd-127">443: standardport för inkommande SSL-trafik tooapps körs i App Service-planer i en Apptjänst-miljö.</span><span class="sxs-lookup"><span data-stu-id="374cd-127">443: Default port for inbound SSL traffic tooapps running in App Service Plans in an App Service Environment.</span></span>  <span data-ttu-id="374cd-128">Den här porten är på en ILB-aktiverade ASE bundna toohello ILB adressen hello ASE.</span><span class="sxs-lookup"><span data-stu-id="374cd-128">On an ILB-enabled ASE, this port is bound toohello ILB address of hello ASE.</span></span>
* <span data-ttu-id="374cd-129">21: kontrollkanal för FTP.</span><span class="sxs-lookup"><span data-stu-id="374cd-129">21:  Control channel for FTP.</span></span>  <span data-ttu-id="374cd-130">Den här porten blockeras på ett säkert sätt om FTP inte används.</span><span class="sxs-lookup"><span data-stu-id="374cd-130">This port can be safely blocked if FTP is not being used.</span></span>  <span data-ttu-id="374cd-131">Den här porten kan vara bundna toohello ILB-adressen för en ASE på en ILB-aktiverade ASE.</span><span class="sxs-lookup"><span data-stu-id="374cd-131">On an ILB-enabled ASE, this port can be bound toohello ILB address for an ASE.</span></span>
* <span data-ttu-id="374cd-132">990: kontrollkanal för FTPS.</span><span class="sxs-lookup"><span data-stu-id="374cd-132">990:  Control channel for FTPS.</span></span>  <span data-ttu-id="374cd-133">Den här porten blockeras på ett säkert sätt om FTPS inte används.</span><span class="sxs-lookup"><span data-stu-id="374cd-133">This port can be safely blocked if FTPS is not being used.</span></span>  <span data-ttu-id="374cd-134">Den här porten kan vara bundna toohello ILB-adressen för en ASE på en ILB-aktiverade ASE.</span><span class="sxs-lookup"><span data-stu-id="374cd-134">On an ILB-enabled ASE, this port can be bound toohello ILB address for an ASE.</span></span>
* <span data-ttu-id="374cd-135">10001 10020: datakanaler för FTP.</span><span class="sxs-lookup"><span data-stu-id="374cd-135">10001-10020: Data channels for FTP.</span></span>  <span data-ttu-id="374cd-136">Som med hello kontrollkanal blockeras dessa portar på ett säkert sätt om FTP inte används.</span><span class="sxs-lookup"><span data-stu-id="374cd-136">As with hello control channel, these ports can be safely blocked if FTP is not being used.</span></span>  <span data-ttu-id="374cd-137">På en ASE ILB-aktiverad, kan den här porten vara bundna toohello ASE'S ILB adress.</span><span class="sxs-lookup"><span data-stu-id="374cd-137">On an ILB-enabled ASE, this port can be bound toohello ASE's ILB address.</span></span>
* <span data-ttu-id="374cd-138">4016: används för fjärrfelsökning med Visual Studio 2012.</span><span class="sxs-lookup"><span data-stu-id="374cd-138">4016: Used for remote debugging with Visual Studio 2012.</span></span>  <span data-ttu-id="374cd-139">Den här porten blockeras på ett säkert sätt om hello-funktionen inte används.</span><span class="sxs-lookup"><span data-stu-id="374cd-139">This port can be safely blocked if hello feature is not being used.</span></span>  <span data-ttu-id="374cd-140">Den här porten är på en ILB-aktiverade ASE bundna toohello ILB adressen hello ASE.</span><span class="sxs-lookup"><span data-stu-id="374cd-140">On an ILB-enabled ASE, this port is bound toohello ILB address of hello ASE.</span></span>
* <span data-ttu-id="374cd-141">4018: används för fjärrfelsökning med Visual Studio 2013.</span><span class="sxs-lookup"><span data-stu-id="374cd-141">4018: Used for remote debugging with Visual Studio 2013.</span></span>  <span data-ttu-id="374cd-142">Den här porten blockeras på ett säkert sätt om hello-funktionen inte används.</span><span class="sxs-lookup"><span data-stu-id="374cd-142">This port can be safely blocked if hello feature is not being used.</span></span>  <span data-ttu-id="374cd-143">Den här porten är på en ILB-aktiverade ASE bundna toohello ILB adressen hello ASE.</span><span class="sxs-lookup"><span data-stu-id="374cd-143">On an ILB-enabled ASE, this port is bound toohello ILB address of hello ASE.</span></span>
* <span data-ttu-id="374cd-144">4020: används för fjärrfelsökning med Visual Studio 2015.</span><span class="sxs-lookup"><span data-stu-id="374cd-144">4020: Used for remote debugging with Visual Studio 2015.</span></span>  <span data-ttu-id="374cd-145">Den här porten blockeras på ett säkert sätt om hello-funktionen inte används.</span><span class="sxs-lookup"><span data-stu-id="374cd-145">This port can be safely blocked if hello feature is not being used.</span></span>  <span data-ttu-id="374cd-146">Den här porten är på en ILB-aktiverade ASE bundna toohello ILB adressen hello ASE.</span><span class="sxs-lookup"><span data-stu-id="374cd-146">On an ILB-enabled ASE, this port is bound toohello ILB address of hello ASE.</span></span>

## <a name="outbound-connectivity-and-dns-requirements"></a><span data-ttu-id="374cd-147">Utgående anslutning och DNS-krav</span><span class="sxs-lookup"><span data-stu-id="374cd-147">Outbound Connectivity and DNS Requirements</span></span>
<span data-ttu-id="374cd-148">För en Apptjänstmiljö toofunction korrekt, kräver det också utgående åtkomst toovarious slutpunkter.</span><span class="sxs-lookup"><span data-stu-id="374cd-148">For an App Service Environment toofunction properly, it also requires outbound access toovarious endpoints.</span></span> <span data-ttu-id="374cd-149">En fullständig lista över hello externa slutpunkter som används av en ASE är i hello nätverksanslutning ”krävs” avsnittet av hello [nätverkskonfigurationen för ExpressRoute](app-service-app-service-environment-network-configuration-expressroute.md#required-network-connectivity) artikel.</span><span class="sxs-lookup"><span data-stu-id="374cd-149">A full list of hello external endpoints used by an ASE is in hello "Required Network Connectivity" section of hello [Network Configuration for ExpressRoute](app-service-app-service-environment-network-configuration-expressroute.md#required-network-connectivity) article.</span></span>

<span data-ttu-id="374cd-150">Apptjänstmiljöer kräver en giltig DNS-infrastruktur som konfigurerats för hello virtuellt nätverk.</span><span class="sxs-lookup"><span data-stu-id="374cd-150">App Service Environments require a valid DNS infrastructure configured for hello virtual network.</span></span>  <span data-ttu-id="374cd-151">Om DNS-konfiguration ändras när en Apptjänst-miljö har skapats i någon orsak hello, kan utvecklare tvinga en Apptjänstmiljö toopick hello nya DNS-konfiguration.</span><span class="sxs-lookup"><span data-stu-id="374cd-151">If for any reason hello DNS configuration is changed after an App Service Environment has been created, developers can force an App Service Environment toopick up hello new DNS configuration.</span></span>  <span data-ttu-id="374cd-152">Utlöser en rullande miljö omstart med hjälp av hello ”Restart” finns hello överst på bladet hantering av hello Apptjänstmiljö i hello [Azure-portalen] [ NewPortal] kommer hello miljö toopick hello nya DNS-konfiguration.</span><span class="sxs-lookup"><span data-stu-id="374cd-152">Triggering a rolling environment reboot using hello "Restart" icon located at hello top of hello App Service Environment management blade in hello [Azure portal][NewPortal] will cause hello environment toopick up hello new DNS configuration.</span></span>

<span data-ttu-id="374cd-153">Vi rekommenderar också att alla anpassade DNS-servrar för hello virtuella nätverk konfigureras i tid tidigare toocreating en Apptjänst-miljö.</span><span class="sxs-lookup"><span data-stu-id="374cd-153">It is also recommended that any custom DNS servers on hello vnet be setup ahead of time prior toocreating an App Service Environment.</span></span>  <span data-ttu-id="374cd-154">Om DNS-konfiguration för ett virtuellt nätverk har ändrats medan en Apptjänst-miljö skapas, vilket leder till att hello Apptjänstmiljö skapa processen misslyckas.</span><span class="sxs-lookup"><span data-stu-id="374cd-154">If a virtual network's DNS configuration is changed while an App Service Environment is being created, that will result in hello App Service Environment creation process failing.</span></span>  <span data-ttu-id="374cd-155">I en liknande vein är andra änden av en VPN-gateway och hello DNS-server kan inte nås eller otillgängliga hello Apptjänstmiljö processen fungerar inte om en anpassad DNS-server finns på hello.</span><span class="sxs-lookup"><span data-stu-id="374cd-155">In a similar vein, if a custom DNS server exists on hello other end of a VPN gateway, and hello DNS server is unreachable or unavailable, hello App Service Environment creation process will also fail.</span></span>

## <a name="creating-a-network-security-group"></a><span data-ttu-id="374cd-156">Skapa en Nätverkssäkerhetsgrupp</span><span class="sxs-lookup"><span data-stu-id="374cd-156">Creating a Network Security Group</span></span>
<span data-ttu-id="374cd-157">Mer information om hur nätverkssäkerhet grupper arbetar finns hello följande [information][NetworkSecurityGroups].</span><span class="sxs-lookup"><span data-stu-id="374cd-157">For full details on how network security groups work see hello following [information][NetworkSecurityGroups].</span></span>  <span data-ttu-id="374cd-158">hello Azure Service Management exemplet nedan finputsningen på visar för nätverkssäkerhetsgrupper med fokus på Konfigurera och tillämpa en säkerhet grupp tooa undernät som innehåller en Apptjänst-miljö.</span><span class="sxs-lookup"><span data-stu-id="374cd-158">hello Azure Service Management example below touches on highlights of network security groups, with a focus on configuring and applying a network security group tooa subnet that contains an App Service Environment.</span></span>

<span data-ttu-id="374cd-159">**Obs:** nätverkssäkerhetsgrupper kan konfigureras med grafiskt hello [Azure Portal](https://portal.azure.com) eller via Azure PowerShell.</span><span class="sxs-lookup"><span data-stu-id="374cd-159">**Note:** Network security groups can be configured graphically using hello [Azure Portal](https://portal.azure.com) or through Azure PowerShell.</span></span>

<span data-ttu-id="374cd-160">Nätverkssäkerhetsgrupper skapas först som en fristående enhet som är associerad med en prenumeration.</span><span class="sxs-lookup"><span data-stu-id="374cd-160">Network security groups are first created as a standalone entity associated with a subscription.</span></span> <span data-ttu-id="374cd-161">Eftersom nätverkssäkerhetsgrupper skapas i en Azure-region, kontrollera att hello nätverkssäkerhetsgruppen skapas i hello samma region som hello Apptjänst-miljö.</span><span class="sxs-lookup"><span data-stu-id="374cd-161">Since network security groups are created in an Azure region, ensure that hello network security group is created in hello same region as hello App Service Environment.</span></span>

<span data-ttu-id="374cd-162">hello nedan visar hur du skapar en nätverkssäkerhetsgrupp:</span><span class="sxs-lookup"><span data-stu-id="374cd-162">hello following demonstrates creating a network security group:</span></span>

    New-AzureNetworkSecurityGroup -Name "testNSGexample" -Location "South Central US" -Label "Example network security group for an app service environment"

<span data-ttu-id="374cd-163">När du har skapat en nätverkssäkerhetsgrupp läggs en eller flera Nätverkssäkerhetsregler tooit.</span><span class="sxs-lookup"><span data-stu-id="374cd-163">Once a network security group is created, one or more network security rules are added tooit.</span></span>  <span data-ttu-id="374cd-164">Eftersom hello uppsättning regler som kan ändras med tiden rekommenderas toospace ut hello numrering schema används för regeln prioriteter toomake den ytterligare regler för enkelt tooinsert över tid.</span><span class="sxs-lookup"><span data-stu-id="374cd-164">Since hello set of rules may change over time, it is recommended toospace out hello numbering scheme used for rule priorities toomake it easy tooinsert additional rules over time.</span></span>

<span data-ttu-id="374cd-165">hello exemplet nedan visar en regel som uttryckligen beviljar åtkomst toohello management portar som krävs av hello Azure-infrastrukturen toomanage och underhålla en Apptjänst-miljö.</span><span class="sxs-lookup"><span data-stu-id="374cd-165">hello example below shows a rule that explicitly grants access toohello management ports needed by hello Azure infrastructure toomanage and maintain an App Service Environment.</span></span>  <span data-ttu-id="374cd-166">Observera att alla hantering av trafik som flödar över SSL och skyddas av klientcertifikat, så att även om hello portar är öppna de är tillgängligt som en annan entitet än Azure hanteringsinfrastruktur.</span><span class="sxs-lookup"><span data-stu-id="374cd-166">Note that all management traffic flows over SSL and is secured by client certificates, so even though hello ports are opened they are inaccessible by any entity other than Azure management infrastructure.</span></span>

    Get-AzureNetworkSecurityGroup -Name "testNSGexample" | Set-AzureNetworkSecurityRule -Name "ALLOW AzureMngmt" -Type Inbound -Priority 100 -Action Allow -SourceAddressPrefix 'INTERNET'  -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '454-455' -Protocol TCP


<span data-ttu-id="374cd-167">När låsa åtkomst tooport 80 och 443 för ”dölja” en Apptjänst-miljö bakom överordnade enheter eller tjänster, behöver du tooknow hello överordnade IP-adress.</span><span class="sxs-lookup"><span data-stu-id="374cd-167">When locking down access tooport 80 and 443 too"hide" an App Service Environment behind upstream devices or services, you will need tooknow hello upstream IP address.</span></span>  <span data-ttu-id="374cd-168">Till exempel om du använder en brandvägg för webbaserade program (Brandvägg) hello Brandvägg ska ha sin egen IP-adress (eller adresserna) som används när proxyanslutning trafik tooa underordnade Apptjänstmiljö.</span><span class="sxs-lookup"><span data-stu-id="374cd-168">For example, if you are using a web application firewall (WAF), hello WAF will have its own IP address (or addresses) which it uses when proxying traffic tooa downstream App Service Environment.</span></span>  <span data-ttu-id="374cd-169">Du behöver toouse denna IP-adress i hello *SourceAddressPrefix* -parametern för en nätverkssäkerhetsregeln.</span><span class="sxs-lookup"><span data-stu-id="374cd-169">You will need toouse this IP address in hello *SourceAddressPrefix* parameter of a network security rule.</span></span>

<span data-ttu-id="374cd-170">Inkommande trafik från en specifik överordnade IP-adress är uttryckligen tillåts i hello exemplet nedan.</span><span class="sxs-lookup"><span data-stu-id="374cd-170">In hello example below, inbound traffic from a specific upstream IP address is explicitly allowed.</span></span>  <span data-ttu-id="374cd-171">Hej adress *1.2.3.4* används som platshållare för hello IP-adressen för en överordnad Brandvägg.</span><span class="sxs-lookup"><span data-stu-id="374cd-171">hello address *1.2.3.4* is used as a placeholder for hello IP address of an upstream WAF.</span></span>  <span data-ttu-id="374cd-172">Ändra hello värdet toomatch hello adress som används av din överordnade enhet eller tjänst.</span><span class="sxs-lookup"><span data-stu-id="374cd-172">Change hello value toomatch hello address used by your upstream device or service.</span></span>

    Get-AzureNetworkSecurityGroup -Name "testNSGexample" | Set-AzureNetworkSecurityRule -Name "RESTRICT HTTP" -Type Inbound -Priority 200 -Action Allow -SourceAddressPrefix '1.2.3.4/32'  -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '80' -Protocol TCP
    Get-AzureNetworkSecurityGroup -Name "testNSGexample" | Set-AzureNetworkSecurityRule -Name "RESTRICT HTTPS" -Type Inbound -Priority 300 -Action Allow -SourceAddressPrefix '1.2.3.4/32'  -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '443' -Protocol TCP

<span data-ttu-id="374cd-173">Om FTP-stöd önskas kan hello enligt reglerna användas som en mall toogrant toohello FTP-kontrollen åtkomstport och data channel-portar.</span><span class="sxs-lookup"><span data-stu-id="374cd-173">If FTP support is desired, hello following rules can be used as a template toogrant access toohello FTP control port and data channel ports.</span></span>  <span data-ttu-id="374cd-174">Eftersom FTP är ett tillståndskänslig protokoll, kanske inte kan tooroute FTP-trafik via en traditionell HTTP/HTTPS brandvägg eller proxyserver enhet.</span><span class="sxs-lookup"><span data-stu-id="374cd-174">Since FTP is a stateful protocol, you may not be able tooroute FTP traffic through a traditional HTTP/HTTPS firewall or proxy device.</span></span>  <span data-ttu-id="374cd-175">I det här fallet behöver du tooset hello *SourceAddressPrefix* tooa annat värde – till exempel hello IP-adressintervall utvecklare eller distribution datorer som kör på vilken FTP-klienter.</span><span class="sxs-lookup"><span data-stu-id="374cd-175">In this case you will need tooset hello *SourceAddressPrefix* tooa different value - for example hello IP address range of developer or deployment machines on which FTP clients are running.</span></span> 

    Get-AzureNetworkSecurityGroup -Name "testNSGexample" | Set-AzureNetworkSecurityRule -Name "RESTRICT FTPCtrl" -Type Inbound -Priority 400 -Action Allow -SourceAddressPrefix '1.2.3.4/32'  -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '21' -Protocol TCP
    Get-AzureNetworkSecurityGroup -Name "testNSGexample" | Set-AzureNetworkSecurityRule -Name "RESTRICT FTPDataRange" -Type Inbound -Priority 500 -Action Allow -SourceAddressPrefix '1.2.3.4/32'  -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '10001-10020' -Protocol TCP

<span data-ttu-id="374cd-176">(**Obs:** hello portintervall för datakanal kan ändras under hello förhandsversionen.)</span><span class="sxs-lookup"><span data-stu-id="374cd-176">(**Note:**  hello data channel port range may change during hello preview period.)</span></span>

<span data-ttu-id="374cd-177">Om fjärrfelsökning med Visual Studio används, visar hello enligt reglerna för hur toogrant åt.</span><span class="sxs-lookup"><span data-stu-id="374cd-177">If remote debugging with Visual Studio is used, hello following rules demonstrate how toogrant access.</span></span>  <span data-ttu-id="374cd-178">Det finns en separat regel för varje version av Visual Studio som stöds eftersom varje version använder en annan port för fjärrfelsökning.</span><span class="sxs-lookup"><span data-stu-id="374cd-178">There is a separate rule for each supported version of Visual Studio since each version uses a different port for remote debugging.</span></span>  <span data-ttu-id="374cd-179">Precis som med FTP-åtkomst kan remote felsökning inte trafiken korrekt via en traditionell Brandvägg eller proxyserver enhet.</span><span class="sxs-lookup"><span data-stu-id="374cd-179">As with FTP access, remote debugging traffic may not flow properly through a traditional WAF or proxy device.</span></span>  <span data-ttu-id="374cd-180">Hej *SourceAddressPrefix* kan i stället anges toohello IP-adressintervall developer-datorer som kör Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="374cd-180">hello *SourceAddressPrefix* can instead be set toohello IP address range of developer machines running Visual Studio.</span></span>

    Get-AzureNetworkSecurityGroup -Name "testNSGexample" | Set-AzureNetworkSecurityRule -Name "RESTRICT RemoteDebuggingVS2012" -Type Inbound -Priority 600 -Action Allow -SourceAddressPrefix '1.2.3.4/32'  -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '4016' -Protocol TCP
    Get-AzureNetworkSecurityGroup -Name "testNSGexample" | Set-AzureNetworkSecurityRule -Name "RESTRICT RemoteDebuggingVS2013" -Type Inbound -Priority 700 -Action Allow -SourceAddressPrefix '1.2.3.4/32'  -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '4018' -Protocol TCP
    Get-AzureNetworkSecurityGroup -Name "testNSGexample" | Set-AzureNetworkSecurityRule -Name "RESTRICT RemoteDebuggingVS2015" -Type Inbound -Priority 800 -Action Allow -SourceAddressPrefix '1.2.3.4/32'  -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '4020' -Protocol TCP

## <a name="assigning-a-network-security-group-tooa-subnet"></a><span data-ttu-id="374cd-181">Tilldela en Nätverkssäkerhetsgrupp tooa undernät</span><span class="sxs-lookup"><span data-stu-id="374cd-181">Assigning a Network Security Group tooa Subnet</span></span>
<span data-ttu-id="374cd-182">En nätverkssäkerhetsgrupp har en standardsäkerhetsregel som nekar åtkomst tooall externa trafiken.</span><span class="sxs-lookup"><span data-stu-id="374cd-182">A network security group has a default security rule which denies access tooall external traffic.</span></span>  <span data-ttu-id="374cd-183">Hej resultatet från att kombinera hello Nätverkssäkerhetsregler som beskrivs ovan, och hello standardsäkerhetsregel blockerar inkommande trafik, är endast trafik från käll-adressintervall som är associerade med en *Tillåt* åtgärd ska kunna toosend trafik tooapps körs i en Apptjänst-miljö.</span><span class="sxs-lookup"><span data-stu-id="374cd-183">hello result from combining hello network security rules described above, and hello default security rule blocking inbound traffic, is that only traffic from source address ranges associated with an *Allow* action will be able toosend traffic tooapps running in an App Service Environment.</span></span>

<span data-ttu-id="374cd-184">När en nätverkssäkerhetsgrupp fylls med säkerhetsregler måste toobe tilldelade toohello undernät som innehåller hello Apptjänst-miljö.</span><span class="sxs-lookup"><span data-stu-id="374cd-184">After a network security group is populated with security rules, it needs toobe assigned toohello subnet containing hello App Service Environment.</span></span>  <span data-ttu-id="374cd-185">hello tilldelning kommandot refererar till både hello namn i hello virtuellt nätverk där hello Apptjänst-miljö finns, samt hello namnet på hello undernät där hello Apptjänstmiljö skapades.</span><span class="sxs-lookup"><span data-stu-id="374cd-185">hello assignment command references both hello name of hello virtual network where hello App Service Environment resides, as well as hello name of hello subnet where hello App Service Environment was created.</span></span>  

<span data-ttu-id="374cd-186">hello exemplet nedan visar en nätverkssäkerhetsgrupp som tilldelas tooa undernät och virtuella nätverk:</span><span class="sxs-lookup"><span data-stu-id="374cd-186">hello example below shows a network security group being assigned tooa subnet and virtual network:</span></span>

    Get-AzureNetworkSecurityGroup -Name "testNSGexample" | Set-AzureNetworkSecurityGroupToSubnet -VirtualNetworkName 'testVNet' -SubnetName 'Subnet-test'

<span data-ttu-id="374cd-187">När hello network security grupptilldelning lyckas (hello tilldelning är en långvariga åtgärder och kan ta några minuter toocomplete) bara inkommande trafik matchar *Tillåt* regler ska komma åt appar i hello App -Miljö.</span><span class="sxs-lookup"><span data-stu-id="374cd-187">Once hello network security group assignment succeeds (hello assignment is a long-running operations and can take a few minutes toocomplete), only inbound traffic matching *Allow* rules will successfully reach apps in hello App Service Environment.</span></span>

<span data-ttu-id="374cd-188">Följande exempel visar hur tooremove och därmed DIS associera hello nätverkssäkerhet gruppen från hello undernät för fullständiga hello:</span><span class="sxs-lookup"><span data-stu-id="374cd-188">For completeness hello following example shows how tooremove and thus dis-associate hello network security group from hello subnet:</span></span>

    Get-AzureNetworkSecurityGroup -Name "testNSGexample" | Remove-AzureNetworkSecurityGroupFromSubnet -VirtualNetworkName 'testVNet' -SubnetName 'Subnet-test'

## <a name="special-considerations-for-explicit-ip-ssl"></a><span data-ttu-id="374cd-189">Speciella överväganden vid Explicit IP-SSL</span><span class="sxs-lookup"><span data-stu-id="374cd-189">Special Considerations for Explicit IP-SSL</span></span>
<span data-ttu-id="374cd-190">Om en app har konfigurerats med en explicit SSL-IP-adress (tillämpliga *endast* tooASEs som har en offentlig VIP), istället för att använda hello standard IP-adressen för hello Apptjänstmiljö både HTTP och HTTPS-trafik, flöden i hello undernät via en annan uppsättning andra portar än portarna 80 och 443.</span><span class="sxs-lookup"><span data-stu-id="374cd-190">If an app is configured with an explicit IP-SSL address (applicable *only* tooASEs that have a public VIP), instead of using hello default IP address of hello App Service Environment, both HTTP and HTTPS traffic flows into hello subnet over a different set of ports other than ports 80 and 443.</span></span>

<span data-ttu-id="374cd-191">hello enskilda par portar som används av varje SSL-IP-adress kan hittas i hello portalens användargränssnitt från hello Apptjänstmiljös UX informationsbladet.</span><span class="sxs-lookup"><span data-stu-id="374cd-191">hello individual pair of ports used by each IP-SSL address can be found in hello portal user interface from hello App Service Environment's details UX blade.</span></span>  <span data-ttu-id="374cd-192">Välj ”alla inställningar”--> ”IP-adresser”.</span><span class="sxs-lookup"><span data-stu-id="374cd-192">Select "All settings" --> "IP addresses".</span></span>  <span data-ttu-id="374cd-193">Hej ”IP-adresser” bladet innehåller en tabell med alla uttryckligen konfigurerade SSL-IP-adresser för hello Apptjänst-miljön, tillsammans med hello Särskild port-par som används tooroute HTTP och HTTPS-trafik som är associerade med varje SSL-IP-adress.</span><span class="sxs-lookup"><span data-stu-id="374cd-193">hello "IP addresses" blade shows a table of all explicitly configured IP-SSL addresses for hello App Service Environment, along with hello special port pair that is used tooroute HTTP and HTTPS traffic associated with each IP-SSL address.</span></span>  <span data-ttu-id="374cd-194">Det är detta port-par som behöver toobe som används för hello DestinationPortRange parametrar när du konfigurerar regler i en nätverkssäkerhetsgrupp.</span><span class="sxs-lookup"><span data-stu-id="374cd-194">It is this port pair that needs toobe used for hello DestinationPortRange parameters when configuring rules in a network security group.</span></span>

<span data-ttu-id="374cd-195">När en app på en ASE är konfigurerade toouse IP-SSL, visas inte externa kunder och behöver inte tooworry om hello särskilda par portmappning.</span><span class="sxs-lookup"><span data-stu-id="374cd-195">When an app on an ASE is configured toouse IP-SSL, external customers will not see and do not need tooworry about hello special port pair mapping.</span></span>  <span data-ttu-id="374cd-196">Trafik toohello appar flödar normalt toohello konfigurerade SSL-IP-adress.</span><span class="sxs-lookup"><span data-stu-id="374cd-196">Traffic toohello apps will flow normally toohello configured IP-SSL address.</span></span>  <span data-ttu-id="374cd-197">hello översättning toohello särskilda port par sker automatiskt internt under hello sista delen av dirigera trafiken till hello undernät som innehåller hello ASE.</span><span class="sxs-lookup"><span data-stu-id="374cd-197">hello translation toohello special port pair automatically happens internally during hello final leg of routing traffic into hello subnet containing hello ASE.</span></span> 

## <a name="getting-started"></a><span data-ttu-id="374cd-198">Komma igång</span><span class="sxs-lookup"><span data-stu-id="374cd-198">Getting started</span></span>
<span data-ttu-id="374cd-199">tooget igång med Apptjänstmiljöer, se [introduktion tooApp-miljö][IntroToAppServiceEnvironment]</span><span class="sxs-lookup"><span data-stu-id="374cd-199">tooget started with App Service Environments, see [Introduction tooApp Service Environment][IntroToAppServiceEnvironment]</span></span>

<span data-ttu-id="374cd-200">Alla artiklar och hur-att datorns för Apptjänstmiljöer finns tillgängliga i hello [viktigt för Programtjänstmiljöer](../app-service/app-service-app-service-environments-readme.md).</span><span class="sxs-lookup"><span data-stu-id="374cd-200">All articles and How-To's for App Service Environments are available in hello [README for Application Service Environments](../app-service/app-service-app-service-environments-readme.md).</span></span>

<span data-ttu-id="374cd-201">Mer information kring appar på ett säkert sätt ansluta toobackend resurs från en Apptjänst-miljö finns [på ett säkert sätt ansluta tooBackend resurser från en Apptjänst-miljö][SecurelyConnecttoBackend]</span><span class="sxs-lookup"><span data-stu-id="374cd-201">For details around apps securely connecting toobackend resource from an App Service Environment, see [Securely connecting tooBackend resources from an App Service Environment][SecurelyConnecttoBackend]</span></span>

<span data-ttu-id="374cd-202">Mer information om hello Azure Apptjänst-plattformen finns [Azure App Service][AzureAppService].</span><span class="sxs-lookup"><span data-stu-id="374cd-202">For more information about hello Azure App Service platform, see [Azure App Service][AzureAppService].</span></span>

[!INCLUDE [app-service-web-whats-changed](../../includes/app-service-web-whats-changed.md)]

[!INCLUDE [app-service-web-try-app-service](../../includes/app-service-web-try-app-service.md)]

<!-- LINKS -->
[virtualnetwork]: https://azure.microsoft.com/documentation/articles/virtual-networks-faq/
[HowToCreateAnAppServiceEnvironment]: http://azure.microsoft.com/documentation/articles/app-service-web-how-to-create-an-app-service-environment/
[NetworkSecurityGroups]: https://azure.microsoft.com/documentation/articles/virtual-networks-nsg/
[AzureAppService]: http://azure.microsoft.com/documentation/articles/app-service-value-prop-what-is/
[IntroToAppServiceEnvironment]:  http://azure.microsoft.com/documentation/articles/app-service-app-service-environment-intro/
[SecurelyConnecttoBackend]:  http://azure.microsoft.com/documentation/articles/app-service-app-service-environment-securely-connecting-to-backend-resources/
[NewPortal]:  https://portal.azure.com  

<!-- IMAGES -->

