---
title: "Etablera och distribuera mikrotjänster förutsägbart i Azure"
description: "Lär dig hur du distribuerar ett program som består av mikrotjänster i Azure App Service som en enhet och förutsägbart med hjälp av JSON resurs mallar och PowerShell-skript."
services: app-service
documentationcenter: 
author: cephalin
manager: erikre
editor: jimbe
ms.assetid: bb51e565-e462-4c60-929a-2ff90121f41d
ms.service: app-service
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 01/06/2016
ms.author: cephalin
ms.openlocfilehash: 844f42e61ba443a4b74a52f622113e87a7781913
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 07/11/2017
---
# <a name="provision-and-deploy-microservices-predictably-in-azure"></a><span data-ttu-id="8177b-103">Etablera och distribuera mikrotjänster förutsägbart i Azure</span><span class="sxs-lookup"><span data-stu-id="8177b-103">Provision and deploy microservices predictably in Azure</span></span>
<span data-ttu-id="8177b-104">Den här kursen visar hur du etablera och distribuera ett program som består av [mikrotjänster](https://en.wikipedia.org/wiki/Microservices) i [Azure App Service](/services/app-service/) som en enhet och förutsägbart JSON resurs mallar och PowerShell-skript.</span><span class="sxs-lookup"><span data-stu-id="8177b-104">This tutorial shows how to provision and deploy an application composed of [microservices](https://en.wikipedia.org/wiki/Microservices) in [Azure App Service](/services/app-service/) as a single unit and in a predictable manner using JSON resource group templates and PowerShell scripting.</span></span> 

<span data-ttu-id="8177b-105">När etablering och distribuera hög skala program som består av hög frikopplad är mikrotjänster, repeterbarhet och förutsägbarhet viktigt att lyckas.</span><span class="sxs-lookup"><span data-stu-id="8177b-105">When provisioning and deploying high-scale applications that are composed of highly decoupled microservices, repeatability and predictability are crucial to success.</span></span> <span data-ttu-id="8177b-106">[Azure Apptjänst](/services/app-service/) kan du skapa mikrotjänster med webbappar, mobilappar, API apps och logikappar.</span><span class="sxs-lookup"><span data-stu-id="8177b-106">[Azure App Service](/services/app-service/) enables you to create microservices that include web apps, mobile apps, API apps, and logic apps.</span></span> <span data-ttu-id="8177b-107">[Azure Resource Manager](../azure-resource-manager/resource-group-overview.md) kan du hantera alla mikrotjänster som en enhet, tillsammans med resursberoenden, till exempel databasen och inställningar för åtkomstkontroll av datakälla.</span><span class="sxs-lookup"><span data-stu-id="8177b-107">[Azure Resource Manager](../azure-resource-manager/resource-group-overview.md) enables you to manage all the microservices as a unit, together with resource dependencies such as database and source control settings.</span></span> <span data-ttu-id="8177b-108">Du kan också distribuera sådant program med hjälp av JSON-mallarna och enkla PowerShell-skript.</span><span class="sxs-lookup"><span data-stu-id="8177b-108">Now, you can also deploy such an application using JSON templates and simple PowerShell scripting.</span></span> 

[!INCLUDE [app-service-web-to-api-and-mobile](../../includes/app-service-web-to-api-and-mobile.md)]

## <a name="what-you-will-do"></a><span data-ttu-id="8177b-109">Vad du ska göra</span><span class="sxs-lookup"><span data-stu-id="8177b-109">What you will do</span></span>
<span data-ttu-id="8177b-110">I självstudierna kommer du distribuera ett program som innehåller:</span><span class="sxs-lookup"><span data-stu-id="8177b-110">In the tutorial, you will deploy an application that includes:</span></span>

* <span data-ttu-id="8177b-111">Två webbappar (d.v.s. två mikrotjänster)</span><span class="sxs-lookup"><span data-stu-id="8177b-111">Two web apps (i.e. two microservices)</span></span>
* <span data-ttu-id="8177b-112">En serverdel SQL-databas</span><span class="sxs-lookup"><span data-stu-id="8177b-112">A backend SQL Database</span></span>
* <span data-ttu-id="8177b-113">App-inställningar och anslutningssträngar källkontroll</span><span class="sxs-lookup"><span data-stu-id="8177b-113">App settings, connection strings, and source control</span></span>
* <span data-ttu-id="8177b-114">Programinsikter, aviseringar, autoskalning inställningar</span><span class="sxs-lookup"><span data-stu-id="8177b-114">Application insights, alerts, autoscaling settings</span></span>

## <a name="tools-you-will-use"></a><span data-ttu-id="8177b-115">Verktyg som du vill använda</span><span class="sxs-lookup"><span data-stu-id="8177b-115">Tools you will use</span></span>
<span data-ttu-id="8177b-116">I den här självstudiekursen kommer du använda följande verktyg.</span><span class="sxs-lookup"><span data-stu-id="8177b-116">In this tutorial, you will use the following tools.</span></span> <span data-ttu-id="8177b-117">Eftersom den inte är omfattande diskussion om verktyg ska behålla till scenariot för slutpunkt till slutpunkt och bara får du en kort introduktion till varje, och var du hittar mer information om den.</span><span class="sxs-lookup"><span data-stu-id="8177b-117">Since it’s not comprehensive discussion on tools, I’m going to stick to the end-to-end scenario and just give you a brief intro to each, and where you can find more information on it.</span></span> 

### <a name="azure-resource-manager-templates-json"></a><span data-ttu-id="8177b-118">Azure Resource Manager-mallar (JSON)</span><span class="sxs-lookup"><span data-stu-id="8177b-118">Azure Resource Manager templates (JSON)</span></span>
<span data-ttu-id="8177b-119">Varje gång du skapar en webbapp i Azure App Service, till exempel använder Azure Resource Manager en JSON-mall för att skapa hela resursgruppen med komponenten resurser.</span><span class="sxs-lookup"><span data-stu-id="8177b-119">Every time you create a web app in Azure App Service, for example, Azure Resource Manager uses a JSON template to create the entire resource group with the component resources.</span></span> <span data-ttu-id="8177b-120">En komplex mall från den [Azure Marketplace](/marketplace) som den [skalbar WordPress](/marketplace/partners/wordpress/scalablewordpress/) app kan innehålla MySQL-databas, storage-konton, programtjänstplanen, webbprogram själva, Varningsregler, app-inställningar Autoskala inställningar och mer och alla dessa mallar är tillgängliga via PowerShell.</span><span class="sxs-lookup"><span data-stu-id="8177b-120">A complex template from the [Azure Marketplace](/marketplace) like the [Scalable WordPress](/marketplace/partners/wordpress/scalablewordpress/) app can include the MySQL database, storage accounts, the App Service plan, the web app itself, alert rules, app settings, autoscale settings, and more, and all these templates are available to you through PowerShell.</span></span> <span data-ttu-id="8177b-121">Information om hur du hämtar och använder dessa mallar finns i [med hjälp av Azure PowerShell med Azure Resource Manager](../powershell-azure-resource-manager.md).</span><span class="sxs-lookup"><span data-stu-id="8177b-121">For information on how to download and use these templates, see [Using Azure PowerShell with Azure Resource Manager](../powershell-azure-resource-manager.md).</span></span>

<span data-ttu-id="8177b-122">Mer information om Azure Resource Manager-mallar finns [redigera Azure Resource Manager-mallar](../azure-resource-manager/resource-group-authoring-templates.md)</span><span class="sxs-lookup"><span data-stu-id="8177b-122">For more information on the Azure Resource Manager templates, see [Authoring Azure Resource Manager Templates](../azure-resource-manager/resource-group-authoring-templates.md)</span></span>

### <a name="azure-sdk-26-for-visual-studio"></a><span data-ttu-id="8177b-123">Azure SDK 2.6 för Visual Studio</span><span class="sxs-lookup"><span data-stu-id="8177b-123">Azure SDK 2.6 for Visual Studio</span></span>
<span data-ttu-id="8177b-124">Den senaste SDK innehåller förbättringar av stöd för Resource Manager-mall i JSON-redigerare.</span><span class="sxs-lookup"><span data-stu-id="8177b-124">The newest SDK contains improvements to the Resource Manager template support in the JSON editor.</span></span> <span data-ttu-id="8177b-125">Används för att snabbt skapa en mall för resursen från grunden eller öppna en befintlig JSON-mall (t.ex en mall för hämtade galleriet) för redigering, Fyll i parameterfilen och även distribuera resursgruppen direkt från en Azure-resurs Gruppen lösning.</span><span class="sxs-lookup"><span data-stu-id="8177b-125">You can use this to quickly create a resource group template from scratch or open an existing JSON template (such as a downloaded gallery template) for modification, populate the parameters file, and even deploy the resource group directly from an Azure Resource Group solution.</span></span>

<span data-ttu-id="8177b-126">Mer information finns i [2.6 av Azure SDK för Visual Studio](https://azure.microsoft.com/blog/2015/04/29/announcing-the-azure-sdk-2-6-for-net/).</span><span class="sxs-lookup"><span data-stu-id="8177b-126">For more information, see [Azure SDK 2.6 for Visual Studio](https://azure.microsoft.com/blog/2015/04/29/announcing-the-azure-sdk-2-6-for-net/).</span></span>

### <a name="azure-powershell-080-or-later"></a><span data-ttu-id="8177b-127">Azure PowerShell 0.8.0 eller senare</span><span class="sxs-lookup"><span data-stu-id="8177b-127">Azure PowerShell 0.8.0 or later</span></span>
<span data-ttu-id="8177b-128">Från och med version 0.8.0, innehåller Azure PowerShell-installationen Azure Resource Manager-modulen utöver Azure-modulen.</span><span class="sxs-lookup"><span data-stu-id="8177b-128">Beginning in version 0.8.0, the Azure PowerShell installation includes the Azure Resource Manager module in addition to the Azure module.</span></span> <span data-ttu-id="8177b-129">Den här nya modulen kan du skript distributionen av resursgrupper.</span><span class="sxs-lookup"><span data-stu-id="8177b-129">This new module enables you to script the deployment of resource groups.</span></span>

<span data-ttu-id="8177b-130">Mer information finns i [med hjälp av Azure PowerShell med Azure Resource Manager](../powershell-azure-resource-manager.md)</span><span class="sxs-lookup"><span data-stu-id="8177b-130">For more information, see [Using Azure PowerShell with Azure Resource Manager](../powershell-azure-resource-manager.md)</span></span>

### <a name="azure-resource-explorer"></a><span data-ttu-id="8177b-131">Azure Resource Explorer</span><span class="sxs-lookup"><span data-stu-id="8177b-131">Azure Resource Explorer</span></span>
<span data-ttu-id="8177b-132">Detta [preview verktyget](https://resources.azure.com) gör att du kan utforska JSON-definitioner för alla resursgrupper i din prenumeration och de enskilda resurserna.</span><span class="sxs-lookup"><span data-stu-id="8177b-132">This [preview tool](https://resources.azure.com) enables you to explore the JSON definitions of all the resource groups in your subscription and the individual resources.</span></span> <span data-ttu-id="8177b-133">Du kan redigera JSON-definitioner av en resurs, ta bort en hel hierarki av resurser och skapa nya resurser i verktyget.</span><span class="sxs-lookup"><span data-stu-id="8177b-133">In the tool, you can edit the JSON definitions of a resource, delete an entire hierarchy of resources, and create new resources.</span></span>  <span data-ttu-id="8177b-134">Informationen som är tillgänglig i det här verktyget är mycket användbart vid redigering av mallen eftersom den visar vilka egenskaper som du måste ange för en viss typ av resurs, rätt värden, osv. Du kan även skapa en resursgrupp i den [Azure Portal](https://portal.azure.com/), granska definitionerna JSON i explorer-verktyg som hjälper dig templatize resursgruppen.</span><span class="sxs-lookup"><span data-stu-id="8177b-134">The information readily available in this tool is very helpful for template authoring because it shows you what properties you need to set for a particular type of resource, the correct values, etc. You can even create your resource group in the [Azure Portal](https://portal.azure.com/), then inspect its JSON definitions in the explorer tool to help you templatize the resource group.</span></span>

### <a name="deploy-to-azure-button"></a><span data-ttu-id="8177b-135">Distribuera till Azure-knappen</span><span class="sxs-lookup"><span data-stu-id="8177b-135">Deploy to Azure button</span></span>
<span data-ttu-id="8177b-136">Om du använder GitHub för källkontroll kan du placera en [till Azure-knappen](https://azure.microsoft.com/blog/2014/11/13/deploy-to-azure-button-for-azure-websites-2/) i din viktigt. MD, vilket gör att en nyckelfärdig distribution användargränssnitt till Azure.</span><span class="sxs-lookup"><span data-stu-id="8177b-136">If you use GitHub for source control, you can put a [Deploy to Azure button](https://azure.microsoft.com/blog/2014/11/13/deploy-to-azure-button-for-azure-websites-2/) into your README.MD, which enables a turn-key deployment UI to Azure.</span></span> <span data-ttu-id="8177b-137">Du kan göra detta för ett enkelt webbprogram, kan du utöka här om du vill aktivera distribution av en hel resursgrupp genom att placera en fil för azuredeploy.json i Lagringsplatsens rot.</span><span class="sxs-lookup"><span data-stu-id="8177b-137">While you can do this for any simple web app, you can extend this to enable deploying an entire resource group by putting an azuredeploy.json file in the repository root.</span></span> <span data-ttu-id="8177b-138">Den här JSON-fil som innehåller gruppen resource-mallen, kommer att användas av distribuera Azure-knappen för att skapa resursgruppen.</span><span class="sxs-lookup"><span data-stu-id="8177b-138">This JSON file, which contains the resource group template, will be used by the Deploy to Azure button to create the resource group.</span></span> <span data-ttu-id="8177b-139">Ett exempel finns i [ToDoApp](https://github.com/azure-appservice-samples/ToDoApp) exempel som ska användas i den här kursen.</span><span class="sxs-lookup"><span data-stu-id="8177b-139">For an example, see the [ToDoApp](https://github.com/azure-appservice-samples/ToDoApp) sample, which you will use in this tutorial.</span></span>

## <a name="get-the-sample-resource-group-template"></a><span data-ttu-id="8177b-140">Hämta exempelmall resurs grupp</span><span class="sxs-lookup"><span data-stu-id="8177b-140">Get the sample resource group template</span></span>
<span data-ttu-id="8177b-141">Nu ska vi gå rätt till den.</span><span class="sxs-lookup"><span data-stu-id="8177b-141">So now let’s get right to it.</span></span>

1. <span data-ttu-id="8177b-142">Navigera till den [ToDoApp](https://github.com/azure-appservice-samples/ToDoApp) Apptjänst exempel.</span><span class="sxs-lookup"><span data-stu-id="8177b-142">Navigate to the [ToDoApp](https://github.com/azure-appservice-samples/ToDoApp) App Service sample.</span></span>
2. <span data-ttu-id="8177b-143">Klicka på readme.md, **till Azure**.</span><span class="sxs-lookup"><span data-stu-id="8177b-143">In readme.md, click **Deploy to Azure**.</span></span>
3. <span data-ttu-id="8177b-144">Du förflyttas till den [distribuera till azure](https://deploy.azure.com) plats och ombeds indataparametrar för distribution.</span><span class="sxs-lookup"><span data-stu-id="8177b-144">You’re taken to the [deploy-to-azure](https://deploy.azure.com) site and asked to input deployment parameters.</span></span> <span data-ttu-id="8177b-145">Observera att de flesta fält fylls i med databasnamnet på och vissa slumpmässiga strängar för dig.</span><span class="sxs-lookup"><span data-stu-id="8177b-145">Notice that most of the fields are populated with the repository name and some random strings for you.</span></span> <span data-ttu-id="8177b-146">Du kan ändra alla fält om du vill, men endast saker du måste ange är administrativa SQL Server-inloggning och lösenord och klicka sedan på **nästa**.</span><span class="sxs-lookup"><span data-stu-id="8177b-146">You can change all the fields if you want, but the only things you have to enter are the SQL Server administrative login and the password, then click **Next**.</span></span>
   
   ![](./media/app-service-deploy-complex-application-predictably/gettemplate-1-deploybuttonui.png)
4. <span data-ttu-id="8177b-147">Klicka sedan på **distribuera** att starta distributionsprocessen.</span><span class="sxs-lookup"><span data-stu-id="8177b-147">Next, click **Deploy** to start the deployment process.</span></span> <span data-ttu-id="8177b-148">När processen körs kan slutföras, klickar du på http://todoapp*XXXX*. azurewebsites.net länk för att bläddra i det distribuerade programmet.</span><span class="sxs-lookup"><span data-stu-id="8177b-148">Once the process runs to completion, click the http://todoapp*XXXX*.azurewebsites.net link to browse the deployed application.</span></span> 
   
   ![](./media/app-service-deploy-complex-application-predictably/gettemplate-2-deployprogress.png)
   
   <span data-ttu-id="8177b-149">Användargränssnittet ska gå lite långsamt när du först bläddrar till den eftersom apparna bara startar utan övertyga dig om att det är ett fullt fungerande program.</span><span class="sxs-lookup"><span data-stu-id="8177b-149">The UI would be a little slow when you first browse to it because the apps are just starting up, but convince yourself that it’s a fully-functional application.</span></span>
5. <span data-ttu-id="8177b-150">Klicka på tillbaka i sidan distribuera den **hantera** länk för att visa det nya programmet i Azure Portal.</span><span class="sxs-lookup"><span data-stu-id="8177b-150">Back in the Deploy page, click the **Manage** link to see the new application in the Azure Portal.</span></span>
6. <span data-ttu-id="8177b-151">I den **Essentials** listrutan, klickar du på länken resurs grupp.</span><span class="sxs-lookup"><span data-stu-id="8177b-151">In the **Essentials** dropdown, click the resource group link.</span></span> <span data-ttu-id="8177b-152">Observera också att webbprogrammet är redan ansluten till GitHub-lagringsplatsen under **externt projekt**.</span><span class="sxs-lookup"><span data-stu-id="8177b-152">Note also that the web app is already connected to the GitHub repository under **External Project**.</span></span> 
   
   ![](./media/app-service-deploy-complex-application-predictably/gettemplate-3-portalresourcegroup.png)
7. <span data-ttu-id="8177b-153">I bladet för resursgruppen, Observera att det finns redan två webbprogram och en SQL-databasen i resursgruppen.</span><span class="sxs-lookup"><span data-stu-id="8177b-153">In the resource group blade, note that there are already two web apps and one SQL Database in the resource group.</span></span>
   
   ![](./media/app-service-deploy-complex-application-predictably/gettemplate-4-portalresourcegroupclicked.png)

<span data-ttu-id="8177b-154">Allt som du just har sett i en kort stund ett fullständigt distribuerad två mikrotjänster program med alla komponenter, beroenden, inställningar, databas och kontinuerlig publicering ställs in med en automatisk orchestration i Azure Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="8177b-154">Everything that you just saw in a few short minutes is a fully deployed two-microservice application, with all the components, dependencies, settings, database, and continuous publishing, set up by an automated orchestration in Azure Resource Manager.</span></span> <span data-ttu-id="8177b-155">Detta görs genom att två saker:</span><span class="sxs-lookup"><span data-stu-id="8177b-155">All this was done by two things:</span></span>

* <span data-ttu-id="8177b-156">Distribuera till Azure-knappen</span><span class="sxs-lookup"><span data-stu-id="8177b-156">The Deploy to Azure button</span></span>
* <span data-ttu-id="8177b-157">azuredeploy.JSON i lagringsplatsen rot</span><span class="sxs-lookup"><span data-stu-id="8177b-157">azuredeploy.json in the repo root</span></span>

<span data-ttu-id="8177b-158">Du kan distribuera den här samma program flera, hundratals eller tusentals gånger och har exakt samma konfiguration varje gång.</span><span class="sxs-lookup"><span data-stu-id="8177b-158">You can deploy this same application tens, hundreds, or thousands of times and have the exact same configuration every time.</span></span> <span data-ttu-id="8177b-159">Repeterbarhet och förutsägbarheten hos den här metoden kan du distribuera hög skala program med enkel och förtroende.</span><span class="sxs-lookup"><span data-stu-id="8177b-159">The repeatability and the predictability of this approach enables you to deploy high-scale applications with ease and confidence.</span></span>

## <a name="examine-or-edit-azuredeployjson"></a><span data-ttu-id="8177b-160">Granska (eller redigera) AZUREDEPLOY. JSON</span><span class="sxs-lookup"><span data-stu-id="8177b-160">Examine (or edit) AZUREDEPLOY.JSON</span></span>
<span data-ttu-id="8177b-161">Nu ska vi titta på hur GitHub-lagringsplatsen har ställts in.</span><span class="sxs-lookup"><span data-stu-id="8177b-161">Now let’s look at how the GitHub repository was set up.</span></span> <span data-ttu-id="8177b-162">Du kommer att använda JSON-redigerare i Azure .NET SDK, så om du inte redan har installerat [Azure .NET SDK 2.6](/downloads/), göra det nu.</span><span class="sxs-lookup"><span data-stu-id="8177b-162">You will be using the JSON editor in the Azure .NET SDK, so if you haven’t already installed [Azure .NET SDK 2.6](/downloads/), do it now.</span></span>

1. <span data-ttu-id="8177b-163">Klona den [ToDoApp](https://github.com/azure-appservice-samples/ToDoApp) databas med hjälp av din favorit git-verktyget.</span><span class="sxs-lookup"><span data-stu-id="8177b-163">Clone the [ToDoApp](https://github.com/azure-appservice-samples/ToDoApp) repository using your favorite git tool.</span></span> <span data-ttu-id="8177b-164">På skärmbilden nedan göra jag detta i teamet Explorer i Visual Studio 2013.</span><span class="sxs-lookup"><span data-stu-id="8177b-164">In the screenshot below, I’m doing this in the Team Explorer in Visual Studio 2013.</span></span>
   
   ![](./media/app-service-deploy-complex-application-predictably/examinejson-1-vsclone.png)
2. <span data-ttu-id="8177b-165">Öppna azuredeploy.json i Visual Studio Lagringsplatsens rot.</span><span class="sxs-lookup"><span data-stu-id="8177b-165">From the repository root, open azuredeploy.json in Visual Studio.</span></span> <span data-ttu-id="8177b-166">Om du inte ser fönstret JSON-disposition, måste du installera Azure .NET SDK.</span><span class="sxs-lookup"><span data-stu-id="8177b-166">If you don’t see the JSON Outline pane, you need to install Azure .NET SDK.</span></span>
   
   ![](./media/app-service-deploy-complex-application-predictably/examinejson-2-vsjsoneditor.png)

<span data-ttu-id="8177b-167">Ska inte beskrivs av JSON-format, men [mer resurser](#resources) avsnitt finns länkar för resursen grupp mallspråk.</span><span class="sxs-lookup"><span data-stu-id="8177b-167">I’m not going to describe every detail of the JSON format, but the [More Resources](#resources) section has links for learning the resource group template language.</span></span> <span data-ttu-id="8177b-168">Här kan ska bara visa intressanta funktioner som kan hjälpa dig komma igång med att göra en egen anpassad mall för distribution av appen.</span><span class="sxs-lookup"><span data-stu-id="8177b-168">Here, I’m just going to show you the interesting features that can help you get started in making your own custom template for app deployment.</span></span>

### <a name="parameters"></a><span data-ttu-id="8177b-169">Parametrar</span><span class="sxs-lookup"><span data-stu-id="8177b-169">Parameters</span></span>
<span data-ttu-id="8177b-170">Ta en titt på avsnittet Parametrar för att se att de flesta av dessa parametrar är vad den **till Azure** knappen uppmanas du att ange.</span><span class="sxs-lookup"><span data-stu-id="8177b-170">Take a look at the parameters section to see that most of these parameters are what the **Deploy to Azure** button prompts you to input.</span></span> <span data-ttu-id="8177b-171">Webbplatsen bakom den **till Azure** knappen fyller indata användargränssnitt med de parametrar som definierats i azuredeploy.json.</span><span class="sxs-lookup"><span data-stu-id="8177b-171">The site behind the **Deploy to Azure** button populates the input UI using the parameters defined in azuredeploy.json.</span></span> <span data-ttu-id="8177b-172">Dessa parametrar används i resursdefinitionerna resursnamn, egenskapsvärden, t.ex.</span><span class="sxs-lookup"><span data-stu-id="8177b-172">These parameters are used throughout the resource definitions, such as resource names, property values, etc.</span></span>

### <a name="resources"></a><span data-ttu-id="8177b-173">Resurser</span><span class="sxs-lookup"><span data-stu-id="8177b-173">Resources</span></span>
<span data-ttu-id="8177b-174">Du kan se att 4 översta resurser definieras, inklusive en SQL Server-instans, en apptjänstplan och två webbappar i noden resurser.</span><span class="sxs-lookup"><span data-stu-id="8177b-174">In the resources node, you can see that 4 top-level resources are defined, including a SQL Server instance, an App Service plan, and two web apps.</span></span> 

#### <a name="app-service-plan"></a><span data-ttu-id="8177b-175">App Service-plan</span><span class="sxs-lookup"><span data-stu-id="8177b-175">App Service plan</span></span>
<span data-ttu-id="8177b-176">Låt oss börja med en enkel rotnivå resurs i JSON.</span><span class="sxs-lookup"><span data-stu-id="8177b-176">Let’s start with a simple root-level resource in the JSON.</span></span> <span data-ttu-id="8177b-177">Klicka på App Service-plan som heter i JSON-disposition **[hostingPlanName]** att markera motsvarande JSON-kod.</span><span class="sxs-lookup"><span data-stu-id="8177b-177">In the JSON Outline, click the App Service plan named **[hostingPlanName]** to highlight the corresponding JSON code.</span></span> 

![](./media/app-service-deploy-complex-application-predictably/examinejson-3-appserviceplan.png)

<span data-ttu-id="8177b-178">Observera att den `type` elementet anger strängen för en App Service-plan (den anropades en servergrupp med en lång, lång tid sedan) och andra element och egenskaper fylls i med de parametrar som definierats i JSON-filen och den här resursen har inte någon kapslade resurser.</span><span class="sxs-lookup"><span data-stu-id="8177b-178">Note that the `type` element specifies the string for an App Service plan (it was called a server farm a long, long time ago), and other elements and properties are filled in using the parameters defined in the JSON file, and this resource doesn’t have any nested resources.</span></span>

> [!NOTE]
> <span data-ttu-id="8177b-179">Observera också att värdet för `apiVersion` anger vilken version av REST-API för att använda JSON resursdefinitionen med, och det kan påverka hur resursen ska formateras i Azure i `{}`.</span><span class="sxs-lookup"><span data-stu-id="8177b-179">Note also that the value of `apiVersion` tells Azure which version of the REST API to use the JSON resource definition with, and it can affect how the resource should be formatted inside the `{}`.</span></span> 
> 
> 

#### <a name="sql-server"></a><span data-ttu-id="8177b-180">SQL Server</span><span class="sxs-lookup"><span data-stu-id="8177b-180">SQL Server</span></span>
<span data-ttu-id="8177b-181">Klicka på SQL Server-resurs med namnet **SQLServer** i JSON-disposition.</span><span class="sxs-lookup"><span data-stu-id="8177b-181">Next, click on the SQL Server resource named **SQLServer** in the JSON Outline.</span></span>

![](./media/app-service-deploy-complex-application-predictably/examinejson-4-sqlserver.png)

<span data-ttu-id="8177b-182">Observera följande om den markerade JSON-koden:</span><span class="sxs-lookup"><span data-stu-id="8177b-182">Note the following about the highlighted JSON code:</span></span>

* <span data-ttu-id="8177b-183">Användning av parametrar säkerställer att skapade resurserna är namnet och konfigurerats på ett sätt som gör dem överensstämmer med varandra.</span><span class="sxs-lookup"><span data-stu-id="8177b-183">The use of parameters ensures that the created resources are named and configured in a way that makes them consistent with one another.</span></span>
* <span data-ttu-id="8177b-184">SQLServer-resursen har två kapslade resurser, var och en har ett annat värde för `type`.</span><span class="sxs-lookup"><span data-stu-id="8177b-184">The SQLServer resource has two nested resources, each has a different value for `type`.</span></span>
* <span data-ttu-id="8177b-185">Kapslade resurser i `“resources”: […]`, där databasen och brandväggsreglerna definieras, har en `dependsOn` element som anger resurs-ID för rotnivå SQLServer resursen.</span><span class="sxs-lookup"><span data-stu-id="8177b-185">The nested resources inside `“resources”: […]`, where the database and the firewall rules are defined, have a `dependsOn` element that specifies the resource ID of the root-level SQLServer resource.</span></span> <span data-ttu-id="8177b-186">Detta talar om Azure Resource Manager ”innan du skapar den här resursen som andra resurser måste redan finnas; och om den andra resursen har definierats i mallen, sedan skapa den första ”.</span><span class="sxs-lookup"><span data-stu-id="8177b-186">This tells Azure Resource Manager, “before you create this resource, that other resource must already exist; and if that other resource is defined in the template, then create that one first”.</span></span>
  
  > [!NOTE]
  > <span data-ttu-id="8177b-187">Detaljerad information om hur du använder den `resourceId()` finns [Azure Resource Manager mallen Functions](../azure-resource-manager/resource-group-template-functions-resource.md#resourceid).</span><span class="sxs-lookup"><span data-stu-id="8177b-187">For detailed information on how to use the `resourceId()` function, see [Azure Resource Manager Template Functions](../azure-resource-manager/resource-group-template-functions-resource.md#resourceid).</span></span>
  > 
  > 
* <span data-ttu-id="8177b-188">Effekten av den `dependsOn` elementet är att Azure Resource Manager vet vilka resurser kan skapas parallellt och vilka resurser måste vara sekventiellt.</span><span class="sxs-lookup"><span data-stu-id="8177b-188">The effect of the `dependsOn` element is that Azure Resource Manager can know which resources can be created in parallel and which resources must be created sequentially.</span></span> 

#### <a name="web-app"></a><span data-ttu-id="8177b-189">Webbapp</span><span class="sxs-lookup"><span data-stu-id="8177b-189">Web app</span></span>
<span data-ttu-id="8177b-190">Nu ska vi gå vidare till de faktiska webbappar själva, vilket är mer komplicerad.</span><span class="sxs-lookup"><span data-stu-id="8177b-190">Now, let’s move on to the actual web apps themselves, which are more complicated.</span></span> <span data-ttu-id="8177b-191">Klicka på [variables('apiSiteName')] webbappen i JSON-disposition att markera sin JSON-kod.</span><span class="sxs-lookup"><span data-stu-id="8177b-191">Click the [variables(‘apiSiteName’)] web app in the JSON Outline to highlight its JSON code.</span></span> <span data-ttu-id="8177b-192">Lägg märke till att saker får mycket mer intressant.</span><span class="sxs-lookup"><span data-stu-id="8177b-192">You’ll notice that things are getting much more interesting.</span></span> <span data-ttu-id="8177b-193">För detta ändamål ska jag berätta om funktionerna i taget:</span><span class="sxs-lookup"><span data-stu-id="8177b-193">For this purpose, I’ll talk about the features one by one:</span></span>

##### <a name="root-resource"></a><span data-ttu-id="8177b-194">Rot-resurs</span><span class="sxs-lookup"><span data-stu-id="8177b-194">Root resource</span></span>
<span data-ttu-id="8177b-195">Webbprogrammet beror på två olika resurser.</span><span class="sxs-lookup"><span data-stu-id="8177b-195">The web app depends on two different resources.</span></span> <span data-ttu-id="8177b-196">Det innebär att Azure Resource Manager skapar webbappen endast när både App Service-plan och SQL Server-instansen har skapats.</span><span class="sxs-lookup"><span data-stu-id="8177b-196">This means that Azure Resource Manager will create the web app only after both the App Service plan and the SQL Server instance are created.</span></span>

![](./media/app-service-deploy-complex-application-predictably/examinejson-5-webapproot.png)

##### <a name="app-settings"></a><span data-ttu-id="8177b-197">App-inställningar</span><span class="sxs-lookup"><span data-stu-id="8177b-197">App settings</span></span>
<span data-ttu-id="8177b-198">App-inställningar också definieras som en kapslad resurs.</span><span class="sxs-lookup"><span data-stu-id="8177b-198">The app settings are also defined as a nested resource.</span></span>

![](./media/app-service-deploy-complex-application-predictably/examinejson-6-webappsettings.png)

<span data-ttu-id="8177b-199">I den `properties` element för `config/appsettings`, du har två appinställningar i formatet `“<name>” : “<value>”`.</span><span class="sxs-lookup"><span data-stu-id="8177b-199">In the `properties` element for `config/appsettings`, you have two app settings in the format `“<name>” : “<value>”`.</span></span>

* <span data-ttu-id="8177b-200">`PROJECT`är en [KUDU inställningen](https://github.com/projectkudu/kudu/wiki/Customizing-deployments) som talar om Azure-distribution som projektet ska användas i en Visual Studio-lösning med flera projekt.</span><span class="sxs-lookup"><span data-stu-id="8177b-200">`PROJECT` is a [KUDU setting](https://github.com/projectkudu/kudu/wiki/Customizing-deployments) that tells Azure deployment which project to use in a multi-project Visual Studio solution.</span></span> <span data-ttu-id="8177b-201">Jag får du lära dig hur källkontrollen har konfigurerats, men eftersom ToDoApp koden i ett Visual Studio-lösning med flera projekt kan vi behöver den här inställningen.</span><span class="sxs-lookup"><span data-stu-id="8177b-201">I will show you later how source control is configured, but since the ToDoApp code is in a multi-project Visual Studio solution, we need this setting.</span></span>
* <span data-ttu-id="8177b-202">`clientUrl`är helt enkelt en app inställningen som programkoden använder.</span><span class="sxs-lookup"><span data-stu-id="8177b-202">`clientUrl` is simply an app setting that the application code uses.</span></span>

##### <a name="connection-strings"></a><span data-ttu-id="8177b-203">Anslutningssträngar</span><span class="sxs-lookup"><span data-stu-id="8177b-203">Connection strings</span></span>
<span data-ttu-id="8177b-204">Anslutningssträngar också definieras som en kapslad resurs.</span><span class="sxs-lookup"><span data-stu-id="8177b-204">The connection strings are also defined as a nested resource.</span></span>

![](./media/app-service-deploy-complex-application-predictably/examinejson-7-webappconnstr.png)

<span data-ttu-id="8177b-205">I den `properties` element för `config/connectionstrings`, varje anslutningssträngen har definierats som ett namn: värde-par med specifika format `“<name>” : {“value”: “…”, “type”: “…”}`.</span><span class="sxs-lookup"><span data-stu-id="8177b-205">In the `properties` element for `config/connectionstrings`, each connection string is also defined as a name:value pair, with the specific format of `“<name>” : {“value”: “…”, “type”: “…”}`.</span></span> <span data-ttu-id="8177b-206">För den `type` elementet möjliga värden är `MySql`, `SQLServer`, `SQLAzure`, och `Custom`.</span><span class="sxs-lookup"><span data-stu-id="8177b-206">For the `type` element, possible values are `MySql`, `SQLServer`, `SQLAzure`, and `Custom`.</span></span>

> [!TIP]
> <span data-ttu-id="8177b-207">Kör följande kommando i Azure PowerShell för en fullständig förteckning över sträng anslutningstyper: \[Enum]::GetNames("Microsoft.WindowsAzure.Commands.Utilities.Websites.Services.WebEntities.DatabaseType")</span><span class="sxs-lookup"><span data-stu-id="8177b-207">For a definitive list of the connection string types, run the following command in Azure PowerShell: \[Enum]::GetNames("Microsoft.WindowsAzure.Commands.Utilities.Websites.Services.WebEntities.DatabaseType")</span></span>
> 
> 

##### <a name="source-control"></a><span data-ttu-id="8177b-208">Källkontrollen</span><span class="sxs-lookup"><span data-stu-id="8177b-208">Source control</span></span>
<span data-ttu-id="8177b-209">Inställningar för källkontrollen också definieras som en kapslad resurs.</span><span class="sxs-lookup"><span data-stu-id="8177b-209">The source control settings are also defined as a nested resource.</span></span> <span data-ttu-id="8177b-210">Azure Resource Manager använder den här resursen för att konfigurera kontinuerlig publicering (se begränsning på `IsManualIntegration` senare) samt att startar distributionen av programkoden automatiskt under bearbetning av JSON-filen.</span><span class="sxs-lookup"><span data-stu-id="8177b-210">Azure Resource Manager uses this resource to configure continuous publishing (see caveat on `IsManualIntegration` later) and also to kick off the deployment of application code automatically during the processing of the JSON file.</span></span>

![](./media/app-service-deploy-complex-application-predictably/examinejson-8-webappsourcecontrol.png)

<span data-ttu-id="8177b-211">`RepoUrl`och `branch` bör vara ganska intuitiva och måste peka på Git-lagringsplats och namnet på grenen publicera från.</span><span class="sxs-lookup"><span data-stu-id="8177b-211">`RepoUrl` and `branch` should be pretty intuitive and should point to the Git repository and the name of the branch to publish from.</span></span> <span data-ttu-id="8177b-212">Dessa definieras igen av indataparametrar.</span><span class="sxs-lookup"><span data-stu-id="8177b-212">Again, these are defined by input parameters.</span></span> 

<span data-ttu-id="8177b-213">Observera i den `dependsOn` element att förutom app webbresursen, `sourcecontrols/web` beror också på `config/appsettings` och `config/connectionstrings`.</span><span class="sxs-lookup"><span data-stu-id="8177b-213">Note in the `dependsOn` element that, in addition to the web app resource itself, `sourcecontrols/web` also depends on `config/appsettings` and `config/connectionstrings`.</span></span> <span data-ttu-id="8177b-214">Detta beror på att när `sourcecontrols/web` är konfigurerad, Azure distributionsprocessen kommer automatiskt att försöka distribuera, skapa och starta programkoden.</span><span class="sxs-lookup"><span data-stu-id="8177b-214">This is because once `sourcecontrols/web` is configured, the Azure deployment process will automatically attempt to deploy, build, and start the application code.</span></span> <span data-ttu-id="8177b-215">Därför hjälper lägga till detta beroende dig att kontrollera att programmet har åtkomst till de nödvändiga app-inställningar och anslutningssträngar innan programkoden som körs.</span><span class="sxs-lookup"><span data-stu-id="8177b-215">Therefore, inserting this dependency helps you make sure that the application has access to the required app settings and connection strings before the application code is run.</span></span> 

> [!NOTE]
> <span data-ttu-id="8177b-216">Observera också att `IsManualIntegration` är inställd på `true`.</span><span class="sxs-lookup"><span data-stu-id="8177b-216">Note also that `IsManualIntegration` is set to `true`.</span></span> <span data-ttu-id="8177b-217">Den här egenskapen är nödvändiga i den här självstudiekursen eftersom du inte verkligen äger GitHub-lagringsplatsen och därför kan inte faktiskt bevilja behörighet till Azure för att konfigurera kontinuerlig publicering från [ToDoApp](https://github.com/azure-appservice-samples/ToDoApp) (dvs.</span><span class="sxs-lookup"><span data-stu-id="8177b-217">This property is necessary in this tutorial because you do not actually own the GitHub repository, and thus cannot actually grant permission to Azure to configure continuous publishing from [ToDoApp](https://github.com/azure-appservice-samples/ToDoApp) (i.e.</span></span> <span data-ttu-id="8177b-218">Skicka automatiska databasen uppdateringar till Azure).</span><span class="sxs-lookup"><span data-stu-id="8177b-218">push automatic repository updates to Azure).</span></span> <span data-ttu-id="8177b-219">Du kan använda standardvärdet `false` för den angivna databasen endast om du har konfigurerat ägarens GitHub autentiseringsuppgifter i den [Azure-portalen](https://portal.azure.com/) innan.</span><span class="sxs-lookup"><span data-stu-id="8177b-219">You can use the default value `false` for the specified repository only if you have configured the owner’s GitHub credentials in the [Azure portal](https://portal.azure.com/) before.</span></span> <span data-ttu-id="8177b-220">Med andra ord, om du har ställt in källkontrollen till GitHub eller BitBucket för en app i den [Azure Portal](https://portal.azure.com/) tidigare med ditt användar-autentiseringsuppgifter, och sedan Azure kommer ihåg autentiseringsuppgifterna och använda dem när du distribuerar en app från GitHub eller BitBucket i framtiden.</span><span class="sxs-lookup"><span data-stu-id="8177b-220">In other words, if you have set up source control to GitHub or BitBucket for any app in the [Azure Portal](https://portal.azure.com/) previously, using your user credentials, then Azure will remember the credentials and use them whenever you deploy any app from GitHub or BitBucket in the future.</span></span> <span data-ttu-id="8177b-221">Men om du inte redan har gjort det, att distribution av JSON-mall misslyckas när Azure Resource Manager försöker konfigurera inställningar för webbappens källkontrollen eftersom den inte kan logga in GitHub eller BitBucket med databasen ägarens autentiseringsuppgifter.</span><span class="sxs-lookup"><span data-stu-id="8177b-221">However, if you haven’t done this already, deployment of the JSON template will fail when Azure Resource Manager tries to configure the web app’s source control settings because it cannot log into GitHub or BitBucket with the repository owner’s credentials.</span></span>
> 
> 

## <a name="compare-the-json-template-with-deployed-resource-group"></a><span data-ttu-id="8177b-222">Jämför JSON-mall med distribuerade resursgruppen.</span><span class="sxs-lookup"><span data-stu-id="8177b-222">Compare the JSON template with deployed resource group</span></span>
<span data-ttu-id="8177b-223">Här kan du gå igenom alla webbappens blad i den [Azure Portal](https://portal.azure.com/), men det finns ett annat verktyg som inte är precis som användbart, om mer.</span><span class="sxs-lookup"><span data-stu-id="8177b-223">Here, you can go through all the web app’s blades in the [Azure Portal](https://portal.azure.com/), but there’s another tool that’s just as useful, if not more.</span></span> <span data-ttu-id="8177b-224">Gå till den [resursutforskaren Azure](https://resources.azure.com) preview verktyg som ger dig en JSON-representation av alla resursgrupper i dina prenumerationer som de finns i Azure-serverdel.</span><span class="sxs-lookup"><span data-stu-id="8177b-224">Go to the [Azure Resource Explorer](https://resources.azure.com) preview tool, which gives you a JSON representation of all the resource groups in your subscriptions, as they actually exist in the Azure backend.</span></span> <span data-ttu-id="8177b-225">Du kan också se hur den resursgrupp JSON-hierarki i Azure motsvarar hierarkin i mallfilen som används för att skapa den.</span><span class="sxs-lookup"><span data-stu-id="8177b-225">You can also see how the resource group’s JSON hierarchy in Azure corresponds with the hierarchy in the template file that’s used to create it.</span></span>

<span data-ttu-id="8177b-226">Till exempel när jag går du till den [resursutforskaren Azure](https://resources.azure.com) verktyg och Expandera noderna i Utforskaren, syns resursgruppen och resurserna rotnivå som samlas in under deras respektive resurstyper.</span><span class="sxs-lookup"><span data-stu-id="8177b-226">For example, when I go to the [Azure Resource Explorer](https://resources.azure.com) tool and expand the nodes in the explorer, I can see the resource group and the root-level resources that are collected under their respective resource types.</span></span>

![](./media/app-service-deploy-complex-application-predictably/ARM-1-treeview.png)

<span data-ttu-id="8177b-227">Om du öka detaljnivån till en webbapp du ska kunna se web app konfigurationsinformation liknar den nedan skärmbild:</span><span class="sxs-lookup"><span data-stu-id="8177b-227">If you drill down to a web app, you should be able to see web app configuration details similar to the below screenshot:</span></span>

![](./media/app-service-deploy-complex-application-predictably/ARM-2-jsonview.png)

<span data-ttu-id="8177b-228">Återigen kapslade resurser bör ha en hierarki som liknar de som finns i mallen JSON-filen och du bör se app-inställningar, anslutningssträngar, etc., avspeglas korrekt i fönstret JSON.</span><span class="sxs-lookup"><span data-stu-id="8177b-228">Again, the nested resources should have a hierarchy very similar to those in your JSON template file, and you should see the app settings, connection strings, etc., properly reflected in the JSON pane.</span></span> <span data-ttu-id="8177b-229">Avsaknad av inställningar här kan tyda på ett problem med JSON-filen och kan hjälpa dig att felsöka en JSON-fil i mallen.</span><span class="sxs-lookup"><span data-stu-id="8177b-229">The absence of settings here may indicate an issue with your JSON file and can help you troubleshoot your JSON template file.</span></span>

## <a name="deploy-the-resource-group-template-yourself"></a><span data-ttu-id="8177b-230">Distribuera mallen resurs gruppen själv</span><span class="sxs-lookup"><span data-stu-id="8177b-230">Deploy the resource group template yourself</span></span>
<span data-ttu-id="8177b-231">Den **till Azure** knappen är bra, men du kan distribuera resource group mallen i azuredeploy.json endast om du redan har pushas azuredeploy.json i GitHub.</span><span class="sxs-lookup"><span data-stu-id="8177b-231">The **Deploy to Azure** button is great, but it allows you to deploy the resource group template in azuredeploy.json only if you have already pushed azuredeploy.json to GitHub.</span></span> <span data-ttu-id="8177b-232">Azure .NET SDK innehåller dessutom verktyg som du kan distribuera en JSON-mallfil direkt från din lokala dator.</span><span class="sxs-lookup"><span data-stu-id="8177b-232">The Azure .NET SDK also provides the tools for you to deploy any JSON template file directly from your local machine.</span></span> <span data-ttu-id="8177b-233">Följ stegen nedan om du vill göra detta:</span><span class="sxs-lookup"><span data-stu-id="8177b-233">To do this, follow the steps below:</span></span>

1. <span data-ttu-id="8177b-234">I Visual Studio klickar du på **filen** > **ny** > **projekt**.</span><span class="sxs-lookup"><span data-stu-id="8177b-234">In Visual Studio, click **File** > **New** > **Project**.</span></span>
2. <span data-ttu-id="8177b-235">Klicka på **Visual C#** > **moln** > **Azure-resursgrupp**, klicka på **OK**.</span><span class="sxs-lookup"><span data-stu-id="8177b-235">Click **Visual C#** > **Cloud** > **Azure Resource Group**, then click **OK**.</span></span>
   
   ![](./media/app-service-deploy-complex-application-predictably/deploy-1-vsproject.png)
3. <span data-ttu-id="8177b-236">I **Välj Azure-mall**väljer **tom mall** och på **OK**.</span><span class="sxs-lookup"><span data-stu-id="8177b-236">In **Select Azure Template**, select **Blank Template** and click **OK**.</span></span>
4. <span data-ttu-id="8177b-237">Dra azuredeploy.json i den **mallen** mapp med det nya projektet.</span><span class="sxs-lookup"><span data-stu-id="8177b-237">Drag azuredeploy.json into the **Template** folder of your new project.</span></span>
   
   ![](./media/app-service-deploy-complex-application-predictably/deploy-2-copyjson.png)
5. <span data-ttu-id="8177b-238">Öppna den kopierade azuredeploy.json i Solution Explorer.</span><span class="sxs-lookup"><span data-stu-id="8177b-238">From Solution Explorer, open the copied azuredeploy.json.</span></span>
6. <span data-ttu-id="8177b-239">Precis som för enkelhetens bevis på ska vi lägga till vissa standard Application Insights-resurser till vårt JSON-fil genom att klicka på **Lägg till resurs**.</span><span class="sxs-lookup"><span data-stu-id="8177b-239">Just for the sake of the demonstration, let’s add some standard Application Insight resources to our JSON file, by clicking **Add Resource**.</span></span> <span data-ttu-id="8177b-240">Om du är intresserad av distribution av JSON-fil, går du vidare till steg för att distribuera.</span><span class="sxs-lookup"><span data-stu-id="8177b-240">If you’re just interested in deploying the JSON file, skip to the deploy steps.</span></span>
   
   ![](./media/app-service-deploy-complex-application-predictably/deploy-3-newresource.png)
7. <span data-ttu-id="8177b-241">Välj **Programinsikter för Web Apps**, kontrollera att en befintlig App Service-plan och webb-app är markerad och klicka sedan på **Lägg till**.</span><span class="sxs-lookup"><span data-stu-id="8177b-241">Select **Application Insights for Web Apps**, then make sure an existing App Service plan and web app is selected, and then click **Add**.</span></span>
   
   ![](./media/app-service-deploy-complex-application-predictably/deploy-4-newappinsight.png)
   
   <span data-ttu-id="8177b-242">Du ska nu kunna se flera nya resurser som, beroende på resursen och syfte, är beroende av App Service-plan eller webbprogrammet.</span><span class="sxs-lookup"><span data-stu-id="8177b-242">You’ll now be able to see several new resources that, depending on the resource and what it does, have dependencies on either the App Service plan or the web app.</span></span> <span data-ttu-id="8177b-243">Dessa resurser är inte aktiverade som deras befintliga definitionen och du ska ändra som.</span><span class="sxs-lookup"><span data-stu-id="8177b-243">These resources are not enabled by their existing definition and you’re going to change that.</span></span>
   
   ![](./media/app-service-deploy-complex-application-predictably/deploy-5-appinsightresources.png)
8. <span data-ttu-id="8177b-244">Klicka på i JSON-disposition **appInsights Autoskala** att markera sin JSON-kod.</span><span class="sxs-lookup"><span data-stu-id="8177b-244">In the JSON Outline, click **appInsights AutoScale** to highlight its JSON code.</span></span> <span data-ttu-id="8177b-245">Det här är inställningen skala för din programtjänstplan.</span><span class="sxs-lookup"><span data-stu-id="8177b-245">This is the scaling setting for your App Service plan.</span></span>
9. <span data-ttu-id="8177b-246">Leta upp i den markerade JSON-koden i `location` och `enabled` egenskaper och ange dem som visas nedan.</span><span class="sxs-lookup"><span data-stu-id="8177b-246">In the highlighted JSON code, locate the `location` and `enabled` properties and set them as shown below.</span></span>
   
   ![](./media/app-service-deploy-complex-application-predictably/deploy-6-autoscalesettings.png)
10. <span data-ttu-id="8177b-247">Klicka på i JSON-disposition **CPUHigh appInsights** att markera sin JSON-kod.</span><span class="sxs-lookup"><span data-stu-id="8177b-247">In the JSON Outline, click **CPUHigh appInsights** to highlight its JSON code.</span></span> <span data-ttu-id="8177b-248">Detta är en varning.</span><span class="sxs-lookup"><span data-stu-id="8177b-248">This is an alert.</span></span>
11. <span data-ttu-id="8177b-249">Leta upp den `location` och `isEnabled` egenskaper och ange dem som visas nedan.</span><span class="sxs-lookup"><span data-stu-id="8177b-249">Locate the `location` and `isEnabled` properties and set them as shown below.</span></span> <span data-ttu-id="8177b-250">Gör samma sak för andra tre aviseringar (lila lökar).</span><span class="sxs-lookup"><span data-stu-id="8177b-250">Do the same for the other three alerts (purple bulbs).</span></span>
    
    ![](./media/app-service-deploy-complex-application-predictably/deploy-7-alerts.png)
12. <span data-ttu-id="8177b-251">Nu är du redo att distribuera.</span><span class="sxs-lookup"><span data-stu-id="8177b-251">You’re now ready to deploy.</span></span> <span data-ttu-id="8177b-252">Högerklicka på projektet och välj **distribuera** > **ny distribution**.</span><span class="sxs-lookup"><span data-stu-id="8177b-252">Right-click the project and select **Deploy** > **New Deployment**.</span></span>
    
    ![](./media/app-service-deploy-complex-application-predictably/deploy-8-newdeployment.png)
13. <span data-ttu-id="8177b-253">Logga in på ditt Azure-konto om du inte redan gjort det..</span><span class="sxs-lookup"><span data-stu-id="8177b-253">Log into your Azure account if you haven’t already done so.</span></span>
14. <span data-ttu-id="8177b-254">Välj en befintlig resursgrupp i din prenumeration eller skapa ett nytt en, Välj **azuredeploy.json**, och klicka sedan på **redigera parametrar**.</span><span class="sxs-lookup"><span data-stu-id="8177b-254">Select an existing resource group in your subscription or create a new one, select **azuredeploy.json**, and then click **Edit Parameters**.</span></span>
    
    ![](./media/app-service-deploy-complex-application-predictably/deploy-9-deployconfig.png)
    
    <span data-ttu-id="8177b-255">Du ska nu kunna redigera de parametrar som angetts i mallfilen i en bra tabell.</span><span class="sxs-lookup"><span data-stu-id="8177b-255">You’ll now be able to edit all the parameters defined in the template file in a nice table.</span></span> <span data-ttu-id="8177b-256">Parametrar som definierar standardvärden har redan sina standardvärden och parametrar som definierar en lista över tillåtna värden som ska visas som nedrullningsbara listorna.</span><span class="sxs-lookup"><span data-stu-id="8177b-256">Parameters that define defaults will already have their default values, and parameters that define a list of allowed values will be shown as dropdowns.</span></span>
    
    ![](./media/app-service-deploy-complex-application-predictably/deploy-10-parametereditor.png)
15. <span data-ttu-id="8177b-257">Fyll i alla tomma parametrar och använda den [GitHub-repo-adress för ToDoApp](https://github.com/azure-appservice-samples/ToDoApp.git) i **repoUrl**.</span><span class="sxs-lookup"><span data-stu-id="8177b-257">Fill in all the empty parameters, and use the [GitHub repo address for ToDoApp](https://github.com/azure-appservice-samples/ToDoApp.git) in **repoUrl**.</span></span> <span data-ttu-id="8177b-258">Klicka på **spara**.</span><span class="sxs-lookup"><span data-stu-id="8177b-258">Then, click **Save**.</span></span>
    
    ![](./media/app-service-deploy-complex-application-predictably/deploy-11-parametereditorfilled.png)
    
    > [!NOTE]
    > <span data-ttu-id="8177b-259">Autoskalning är en funktion som erbjuds i **Standard** nivå eller högre och planera nivå aviseringar finns funktioner som erbjuds i **grundläggande** tjänstnivån eller högre, måste du ange den **sku** parameter att **Standard** eller **Premium** för att visa alla nya App Insights resurser lysa.</span><span class="sxs-lookup"><span data-stu-id="8177b-259">Autoscaling is a feature offered in **Standard** tier or higher, and plan-level alerts are features offered in **Basic** tier or higher, you’ll need to set the **sku** parameter to **Standard** or **Premium** in order to see all your new App Insights resources light up.</span></span>
    > 
    > 
16. <span data-ttu-id="8177b-260">Klicka på **distribuera**.</span><span class="sxs-lookup"><span data-stu-id="8177b-260">Click **Deploy**.</span></span> <span data-ttu-id="8177b-261">Om du har valt **spara lösenord**, lösenordet sparas i parameterfilen **i klartext**.</span><span class="sxs-lookup"><span data-stu-id="8177b-261">If you selected **Save passwords**, the password will be saved in the parameter file **in plain text**.</span></span> <span data-ttu-id="8177b-262">Annars kommer du ombedd att ange lösenordet för databasen under distributionsprocessen.</span><span class="sxs-lookup"><span data-stu-id="8177b-262">Otherwise, you’ll be asked to input the database password during the deployment process.</span></span>

<span data-ttu-id="8177b-263">Klart!</span><span class="sxs-lookup"><span data-stu-id="8177b-263">That’s it!</span></span> <span data-ttu-id="8177b-264">Nu måste du gå till den [Azure Portal](https://portal.azure.com/) och [resursutforskaren Azure](https://resources.azure.com) verktyg för att se nya aviseringar och Autoskala inställningar har lagts till i din JSON distribuerat program.</span><span class="sxs-lookup"><span data-stu-id="8177b-264">Now you just need to go to the [Azure Portal](https://portal.azure.com/) and the [Azure Resource Explorer](https://resources.azure.com) tool to see the new alerts and autoscale settings added to your JSON deployed application.</span></span>

<span data-ttu-id="8177b-265">Steg i det här avsnittet göra huvudsakligen följande:</span><span class="sxs-lookup"><span data-stu-id="8177b-265">Your steps in this section mainly accomplished the following:</span></span>

1. <span data-ttu-id="8177b-266">Förbereda mallfilen</span><span class="sxs-lookup"><span data-stu-id="8177b-266">Prepared the template file</span></span>
2. <span data-ttu-id="8177b-267">Skapa en parameterfil att gå med mallfilen</span><span class="sxs-lookup"><span data-stu-id="8177b-267">Created a parameter file to go with the template file</span></span>
3. <span data-ttu-id="8177b-268">Distribuera mallfil med parametern</span><span class="sxs-lookup"><span data-stu-id="8177b-268">Deployed the template file with the parameter file</span></span>

<span data-ttu-id="8177b-269">Det sista steget görs enkelt genom en PowerShell-cmdlet.</span><span class="sxs-lookup"><span data-stu-id="8177b-269">The last step is easily done by a PowerShell cmdlet.</span></span> <span data-ttu-id="8177b-270">Öppna Scripts\Deploy AzureResourceGroup.ps1 om du vill se vad Visual Studio gjorde när det distribuerade programmet.</span><span class="sxs-lookup"><span data-stu-id="8177b-270">To see what Visual Studio did when it deployed your application, open Scripts\Deploy-AzureResourceGroup.ps1.</span></span> <span data-ttu-id="8177b-271">Det finns en mängd kod det, men ska bara markera alla viktig kod som du behöver distribuera mallfil med parametern.</span><span class="sxs-lookup"><span data-stu-id="8177b-271">There’s a lot of code there, but I’m just going to highlight all the pertinent code you need to deploy the template file with the parameter file.</span></span>

![](./media/app-service-deploy-complex-application-predictably/deploy-12-powershellsnippet.png)

<span data-ttu-id="8177b-272">Senaste cmdlet, `New-AzureResourceGroup`, är det som faktiskt utför åtgärden.</span><span class="sxs-lookup"><span data-stu-id="8177b-272">The last cmdlet, `New-AzureResourceGroup`, is the one that actually performs the action.</span></span> <span data-ttu-id="8177b-273">Du bör allt detta visar att det med hjälp av verktygsuppsättning är relativt enkelt att distribuera programmet molnet förutsägbart.</span><span class="sxs-lookup"><span data-stu-id="8177b-273">All this should demonstrate to you that, with the help of tooling, it is relatively straightforward to deploy your cloud application predictably.</span></span> <span data-ttu-id="8177b-274">Varje gång du kör cmdleten på samma mall med samma parameterfil ska du få samma resultat.</span><span class="sxs-lookup"><span data-stu-id="8177b-274">Every time you run the cmdlet on the same template with the same parameter file, you’re going to get the same result.</span></span>

## <a name="summary"></a><span data-ttu-id="8177b-275">Sammanfattning</span><span class="sxs-lookup"><span data-stu-id="8177b-275">Summary</span></span>
<span data-ttu-id="8177b-276">DevOps är repeterbarhet och förutsägbarhet nycklar till en lyckad distribution av en hög skala program består av mikrotjänster.</span><span class="sxs-lookup"><span data-stu-id="8177b-276">In DevOps, repeatability and predictability are keys to any successful deployment of a high-scale application composed of microservices.</span></span> <span data-ttu-id="8177b-277">Du har distribuerat en två-mikrotjänster programmet till Azure som en enskild resursgrupp med hjälp av Azure Resource Manager-mall i den här självstudiekursen.</span><span class="sxs-lookup"><span data-stu-id="8177b-277">In this tutorial, you have deployed a two-microservice application to Azure as a single resource group using the Azure Resource Manager template.</span></span> <span data-ttu-id="8177b-278">Förhoppningsvis har det angivna kunskap du behöver för att starta konvertera ditt program i Azure till en mall och etablera och distribuera den förutsägbart.</span><span class="sxs-lookup"><span data-stu-id="8177b-278">Hopefully, it has given you the knowledge you need in order to start converting your application in Azure into a template and can provision and deploy it predictably.</span></span> 

## <a name="next-steps"></a><span data-ttu-id="8177b-279">Nästa steg</span><span class="sxs-lookup"><span data-stu-id="8177b-279">Next Steps</span></span>
<span data-ttu-id="8177b-280">Lär dig hur du [gäller flexibel metoder och kontinuerligt publicera programmet mikrotjänster med enkel](app-service-agile-software-development.md) och avancerade tekniker för programdistribution som [förhandsversionstestning distribution](app-service-web-test-in-production-controlled-test-flight.md) enkelt.</span><span class="sxs-lookup"><span data-stu-id="8177b-280">Find out how to [apply agile methodologies and continuously publish your microservices application with ease](app-service-agile-software-development.md) and advanced deployment techniques like [flighting deployment](app-service-web-test-in-production-controlled-test-flight.md) easily.</span></span>

<a name="resources"></a>

## <a name="more-resources"></a><span data-ttu-id="8177b-281">Fler resurser</span><span class="sxs-lookup"><span data-stu-id="8177b-281">More resources</span></span>
* [<span data-ttu-id="8177b-282">Språk för Azure Resource Manager-mallen</span><span class="sxs-lookup"><span data-stu-id="8177b-282">Azure Resource Manager Template Language</span></span>](../azure-resource-manager/resource-group-authoring-templates.md)
* [<span data-ttu-id="8177b-283">Redigera Azure Resource Manager-mallar</span><span class="sxs-lookup"><span data-stu-id="8177b-283">Authoring Azure Resource Manager Templates</span></span>](../azure-resource-manager/resource-group-authoring-templates.md)
* [<span data-ttu-id="8177b-284">Azure Resource Manager Mallfunktioner</span><span class="sxs-lookup"><span data-stu-id="8177b-284">Azure Resource Manager Template Functions</span></span>](../azure-resource-manager/resource-group-template-functions.md)
* [<span data-ttu-id="8177b-285">Distribuera ett program med Azure Resource Manager-mall</span><span class="sxs-lookup"><span data-stu-id="8177b-285">Deploy an application with Azure Resource Manager template</span></span>](../azure-resource-manager/resource-group-template-deploy.md)
* [<span data-ttu-id="8177b-286">Använda Azure PowerShell med Azure Resource Manager</span><span class="sxs-lookup"><span data-stu-id="8177b-286">Using Azure PowerShell with Azure Resource Manager</span></span>](../azure-resource-manager/powershell-azure-resource-manager.md)
* [<span data-ttu-id="8177b-287">Felsökning av resursgruppen distributioner i Azure</span><span class="sxs-lookup"><span data-stu-id="8177b-287">Troubleshooting Resource Group Deployments in Azure</span></span>](../azure-resource-manager/resource-manager-common-deployment-errors.md)

