---
title: "Konfigurationsinformation för nätverket för att arbeta med Expressroute"
description: "Konfigurationsinformation för nätverket för att köra Apptjänstmiljöer i virtuella nätverk som är anslutna till en ExpressRoute-krets."
services: app-service
documentationcenter: 
author: stefsch
manager: nirma
editor: 
ms.assetid: 34b49178-2595-4d32-9b41-110c96dde6bf
ms.service: app-service
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 10/14/2016
ms.author: stefsch
ms.openlocfilehash: de1d998ee86c127149dee18e9df577705054ddb4
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 07/11/2017
---
# <a name="network-configuration-details-for-app-service-environments-with-expressroute"></a><span data-ttu-id="6e51b-103">Information om nätverkskonfiguration för App Service-miljöer med ExpressRoute</span><span class="sxs-lookup"><span data-stu-id="6e51b-103">Network Configuration Details for App Service Environments with ExpressRoute</span></span>
## <a name="overview"></a><span data-ttu-id="6e51b-104">Översikt</span><span class="sxs-lookup"><span data-stu-id="6e51b-104">Overview</span></span>
<span data-ttu-id="6e51b-105">Kunder kan ansluta en [Azure ExpressRoute] [ ExpressRoute] krets på sina virtuella nätverksinfrastrukturen därför utöka sina lokala nätverk till Azure.</span><span class="sxs-lookup"><span data-stu-id="6e51b-105">Customers can connect an [Azure ExpressRoute][ExpressRoute] circuit to their virtual network infrastructure, thus extending their on-premises network to Azure.</span></span>  <span data-ttu-id="6e51b-106">En Apptjänst-miljö kan skapas i ett undernät för det här [virtuellt nätverk] [ virtualnetwork] infrastruktur.</span><span class="sxs-lookup"><span data-stu-id="6e51b-106">An App Service Environment can  be created in a subnet of this [virtual network][virtualnetwork] infrastructure.</span></span>  <span data-ttu-id="6e51b-107">Appar som körs på Apptjänst-miljön kan sedan upprätta säkra anslutningar till backend-resurser som är tillgänglig endast med ExpressRoute-anslutningen.</span><span class="sxs-lookup"><span data-stu-id="6e51b-107">Apps running on the App Service Environment can then establish secure connections to back-end resources accessible only over the ExpressRoute connection.</span></span>  

<span data-ttu-id="6e51b-108">En Apptjänst-miljö kan skapas i **antingen** ett virtuellt nätverk i Azure Resource Manager **eller** klassisk distribution modellen virtuella nätverk.</span><span class="sxs-lookup"><span data-stu-id="6e51b-108">An App Service Environment can be created in **either** an Azure Resource Manager virtual network, **or** a classic deployment model virtual network.</span></span>  <span data-ttu-id="6e51b-109">Med en ändring görs i juni 2016 distribueras ASEs nu också till virtuella nätverk som använder offentliga-adressintervall eller RFC1918 adressutrymmen (dvs.</span><span class="sxs-lookup"><span data-stu-id="6e51b-109">With a recent change made in June 2016, ASEs can also now be deployed into virtual networks that use either public address ranges, or RFC1918 address spaces (i.e.</span></span> <span data-ttu-id="6e51b-110">privata adresser).</span><span class="sxs-lookup"><span data-stu-id="6e51b-110">private addresses).</span></span> 

[!INCLUDE [app-service-web-to-api-and-mobile](../../includes/app-service-web-to-api-and-mobile.md)]

## <a name="required-network-connectivity"></a><span data-ttu-id="6e51b-111">Nödvändiga nätverksanslutning</span><span class="sxs-lookup"><span data-stu-id="6e51b-111">Required Network Connectivity</span></span>
<span data-ttu-id="6e51b-112">Det finns anslutningskrav för Apptjänstmiljöer som inte kanske ursprungligen uppfyllas i ett virtuellt nätverk som är anslutna till en ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="6e51b-112">There are network connectivity requirements for App Service Environments that may not be initially met in a virtual network connected to an ExpressRoute.</span></span>  <span data-ttu-id="6e51b-113">Apptjänstmiljöer kräver följande för att fungera korrekt:</span><span class="sxs-lookup"><span data-stu-id="6e51b-113">App Service Environments require all of the following in order to function properly:</span></span>

* <span data-ttu-id="6e51b-114">Utgående nätverksanslutning till Azure Storage-slutpunkterna över hela världen på båda portarna 80 och 443.</span><span class="sxs-lookup"><span data-stu-id="6e51b-114">Outbound network connectivity to Azure Storage endpoints worldwide on both ports 80 and 443.</span></span>  <span data-ttu-id="6e51b-115">Detta inkluderar slutpunkter finns i samma region som Apptjänst-miljön, samt lagring slutpunkter finns i **andra** Azure-regioner.</span><span class="sxs-lookup"><span data-stu-id="6e51b-115">This includes endpoints located in the same region as the App Service Environment, as well as storage endpoints located in **other** Azure regions.</span></span>  <span data-ttu-id="6e51b-116">Azure Storage-slutpunkter lösa under följande DNS-domäner: *table.core.windows.net*, *blob.core.windows.net*, *queue.core.windows.net* och *file.core.windows.net*.</span><span class="sxs-lookup"><span data-stu-id="6e51b-116">Azure Storage endpoints resolve under the following DNS domains: *table.core.windows.net*, *blob.core.windows.net*, *queue.core.windows.net* and *file.core.windows.net*.</span></span>  
* <span data-ttu-id="6e51b-117">Utgående nätverksanslutning till tjänsten Azure-filer på port 445.</span><span class="sxs-lookup"><span data-stu-id="6e51b-117">Outbound network connectivity to the Azure Files service on port 445.</span></span>
* <span data-ttu-id="6e51b-118">Utgående nätverksanslutning till Sql DB-slutpunkter som finns i samma region som Apptjänst-miljön.</span><span class="sxs-lookup"><span data-stu-id="6e51b-118">Outbound network connectivity to Sql DB endpoints located in the same region as the App Service Environment.</span></span>  <span data-ttu-id="6e51b-119">SQL DB slutpunkter lösa under följande domän: *database.windows.net*.</span><span class="sxs-lookup"><span data-stu-id="6e51b-119">Sql DB endpoints resolve under the following domain:  *database.windows.net*.</span></span>  <span data-ttu-id="6e51b-120">Detta kräver att öppna åtkomst till portarna 1433, 11000 11999 och 14000 14999.</span><span class="sxs-lookup"><span data-stu-id="6e51b-120">This requires opening access to ports 1433, 11000-11999 and 14000-14999.</span></span>  <span data-ttu-id="6e51b-121">Mer information finns [i den här artikeln på Sql Database V12 portar används](../sql-database/sql-database-develop-direct-route-ports-adonet-v12.md).</span><span class="sxs-lookup"><span data-stu-id="6e51b-121">For more details see [this article on Sql Database V12 port usage](../sql-database/sql-database-develop-direct-route-ports-adonet-v12.md).</span></span>
* <span data-ttu-id="6e51b-122">Utgående nätverksanslutning till Azure management plan slutpunkter (både ASM och ARM-slutpunkter).</span><span class="sxs-lookup"><span data-stu-id="6e51b-122">Outbound network connectivity to the Azure management plane endpoints (both ASM and ARM endpoints).</span></span>  <span data-ttu-id="6e51b-123">Detta inkluderar utgående anslutning till både *management.core.windows.net* och *management.azure.com*.</span><span class="sxs-lookup"><span data-stu-id="6e51b-123">This includes outbound connectivity to both *management.core.windows.net* and *management.azure.com*.</span></span> 
* <span data-ttu-id="6e51b-124">Utgående nätverksanslutning till *ocsp.msocsp.com*, *mscrl.microsoft.com* och *crl.microsoft.com*.</span><span class="sxs-lookup"><span data-stu-id="6e51b-124">Outbound network connectivity to *ocsp.msocsp.com*, *mscrl.microsoft.com* and *crl.microsoft.com*.</span></span>  <span data-ttu-id="6e51b-125">Detta krävs för att stödja SSL-funktioner.</span><span class="sxs-lookup"><span data-stu-id="6e51b-125">This is needed to support SSL functionality.</span></span>
* <span data-ttu-id="6e51b-126">DNS-konfigurationen för det virtuella nätverket måste kunna matcha alla slutpunkter och domäner som nämns i tidigare återställningspunkter.</span><span class="sxs-lookup"><span data-stu-id="6e51b-126">The DNS configuration for the virtual network must be capable of resolving all of the endpoints and domains mentioned in the earlier points.</span></span>  <span data-ttu-id="6e51b-127">Om dessa slutpunkter inte kan matchas Apptjänstmiljö skapa försök misslyckas och befintliga Apptjänstmiljöer kommer att markeras som ohälsosam.</span><span class="sxs-lookup"><span data-stu-id="6e51b-127">If these endpoints cannot be resolved, App Service Environment creation attempts will fail, and existing App Service Environments will be marked as unhealthy.</span></span>
* <span data-ttu-id="6e51b-128">Utgående åtkomst på port 53 krävs för kommunikation med DNS-servrar.</span><span class="sxs-lookup"><span data-stu-id="6e51b-128">Outbound access on port 53 is required for communication with DNS servers.</span></span>
* <span data-ttu-id="6e51b-129">Om en anpassad DNS-server finns på den andra änden av en VPN-gateway, måste DNS-servern vara nåbar från det undernät som innehåller Apptjänst-miljön.</span><span class="sxs-lookup"><span data-stu-id="6e51b-129">If a custom DNS server exists on the other end of a VPN gateway, the DNS server must be reachable from the subnet containing the App Service Environment.</span></span> 
* <span data-ttu-id="6e51b-130">Utgående sökvägen kan inte skickas genom interna företagets proxyservrar eller kan den vara force tunneldata till lokalt.</span><span class="sxs-lookup"><span data-stu-id="6e51b-130">The outbound network path cannot travel through internal corporate proxies, nor can it be force tunneled to on-premises.</span></span>  <span data-ttu-id="6e51b-131">Gör det ändrar effektiva NAT-adress för utgående nätverkstrafik från Apptjänst-miljön.</span><span class="sxs-lookup"><span data-stu-id="6e51b-131">Doing so changes the effective NAT address of outbound network traffic from the App Service Environment.</span></span>  <span data-ttu-id="6e51b-132">Ändrar NAT-adress för en Apptjänstmiljö utgående nätverkstrafik kan anslutningsfel till många av de slutpunkter som anges ovan.</span><span class="sxs-lookup"><span data-stu-id="6e51b-132">Changing the NAT address of an App Service Environment's outbound network traffic will cause connectivity failures to many of the endpoints listed above.</span></span>  <span data-ttu-id="6e51b-133">Detta resulterar i misslyckade försök för skapande av Apptjänst-miljö, samt tidigare felfri Apptjänstmiljöer markeras som ohälsosam.</span><span class="sxs-lookup"><span data-stu-id="6e51b-133">This results in failed App Service Environment creation attempts, as well as previously healthy App Service Environments being marked as unhealthy.</span></span>  
* <span data-ttu-id="6e51b-134">Inkommande nätverksåtkomst till portar som krävs för Apptjänstmiljöer får enligt beskrivningen i det här [artikel][requiredports].</span><span class="sxs-lookup"><span data-stu-id="6e51b-134">Inbound network access to required ports for App Service Environments must be allowed as described in this [article][requiredports].</span></span>

<span data-ttu-id="6e51b-135">DNS-kraven kan uppfyllas genom att säkerställa att ett giltigt DNS-infrastrukturen är konfigurerad och underhålls för det virtuella nätverket.</span><span class="sxs-lookup"><span data-stu-id="6e51b-135">The DNS requirements can be met by ensuring a valid DNS infrastructure is configured and maintained for the virtual network.</span></span>  <span data-ttu-id="6e51b-136">Om DNS-konfigurationen har ändrats efter en Apptjänst-miljö har skapats av någon anledning, kan utvecklare tvinga en Apptjänst-miljö för den nya DNS-konfigurationen.</span><span class="sxs-lookup"><span data-stu-id="6e51b-136">If for any reason the DNS configuration is changed after an App Service Environment has been created, developers can force an App Service Environment to pick up the new DNS configuration.</span></span>  <span data-ttu-id="6e51b-137">Utlöser en rullande miljö omstart med hjälp av ikonen ”Restart” som finns längst upp på bladet hantering av Apptjänst-miljö i det [Azure-portalen] [ NewPortal] kommer miljö för att hämta den nya DNS-konfigurationen.</span><span class="sxs-lookup"><span data-stu-id="6e51b-137">Triggering a rolling environment reboot using the "Restart" icon located at the top of the App Service Environment management blade in the [Azure portal][NewPortal] will cause the environment to pick up the new DNS configuration.</span></span>

<span data-ttu-id="6e51b-138">Inkommande network access kraven kan uppfyllas genom att konfigurera en [nätverkssäkerhetsgruppen] [ NetworkSecurityGroups] i den Apptjänstmiljö undernät så att den nödvändiga åtkomsten enligt beskrivningen i det här [artikel][requiredports].</span><span class="sxs-lookup"><span data-stu-id="6e51b-138">The inbound network access requirements can be met by configuring a [network security group][NetworkSecurityGroups] on the App Service Environment's subnet to allow the required access as described in this [article][requiredports].</span></span>

## <a name="enabling-outbound-network-connectivity-for-an-app-service-environment"></a><span data-ttu-id="6e51b-139">Aktivera utgående nätverksanslutning för en Apptjänst-miljö</span><span class="sxs-lookup"><span data-stu-id="6e51b-139">Enabling Outbound Network Connectivity for an App Service Environment</span></span>
<span data-ttu-id="6e51b-140">Som standard annonserar en nyligen skapade ExpressRoute-krets en standardväg som tillåter utgående Internet-anslutning.</span><span class="sxs-lookup"><span data-stu-id="6e51b-140">By default, a newly created ExpressRoute circuit advertises a default route that allows outbound Internet connectivity.</span></span>  <span data-ttu-id="6e51b-141">En Apptjänst-miljö kommer att kunna ansluta till andra Azure-slutpunkter med den här konfigurationen.</span><span class="sxs-lookup"><span data-stu-id="6e51b-141">With this configuration an App Service Environment will be able to connect to other Azure endpoints.</span></span>

<span data-ttu-id="6e51b-142">Men en gemensam konfiguration av customer är att definiera egna standardvägen (0.0.0.0/0) som tvingar utgående Internet-trafiken flöda lokalt i stället.</span><span class="sxs-lookup"><span data-stu-id="6e51b-142">However a common customer configuration is to define their own default route (0.0.0.0/0) which forces outbound Internet traffic to instead flow on-premises.</span></span>  <span data-ttu-id="6e51b-143">Den här trafikflöde bryts utan undantag Apptjänstmiljöer eftersom utgående trafik är antingen blockerade lokalt eller NAT skulle med ett okänt uppsättning adresser som inte längre att fungera med olika Azure-slutpunkter.</span><span class="sxs-lookup"><span data-stu-id="6e51b-143">This traffic flow invariably breaks App Service Environments because the outbound traffic is either blocked on-premises, or NAT'd to an unrecognizable set of addresses that no longer work with various Azure endpoints.</span></span>

<span data-ttu-id="6e51b-144">Lösningen är att definiera en (eller flera) användardefinierade vägar (udr: er) för det undernät som innehåller Apptjänst-miljön.</span><span class="sxs-lookup"><span data-stu-id="6e51b-144">The solution is to define one (or more) user defined routes (UDRs) on the subnet that contains the App Service Environment.</span></span>  <span data-ttu-id="6e51b-145">En UDR definierar undernät-specifika vägar som ska användas i stället för standardväg.</span><span class="sxs-lookup"><span data-stu-id="6e51b-145">A UDR defines subnet-specific routes that will be honored instead of the default route.</span></span>

<span data-ttu-id="6e51b-146">Om möjligt bör du använder följande konfiguration:</span><span class="sxs-lookup"><span data-stu-id="6e51b-146">If possible, it is recommended to use the following configuration:</span></span>

* <span data-ttu-id="6e51b-147">ExpressRoute-konfigurationen annonserar 0.0.0.0/0 och som standard kraft tunnlar all utgående trafik lokalt.</span><span class="sxs-lookup"><span data-stu-id="6e51b-147">The ExpressRoute configuration advertises 0.0.0.0/0 and by default force tunnels all outbound traffic on-premises.</span></span>
* <span data-ttu-id="6e51b-148">UDR tillämpad på undernätet som innehåller Apptjänst-miljön definierar 0.0.0.0/0 med ett nexthop-typ för Internet (ett exempel på detta finns längre ned i den här artikeln).</span><span class="sxs-lookup"><span data-stu-id="6e51b-148">The UDR applied to the subnet containing the App Service Environment defines 0.0.0.0/0 with a next hop type of Internet (an example of this is farther down in this article).</span></span>

<span data-ttu-id="6e51b-149">Den kombinerade effekten av dessa steg är att undernätverksnivån UDR företräde framför den ExpressRoute Tvingad tunneltrafik tillse utgående Internetåtkomst från Apptjänst-miljön.</span><span class="sxs-lookup"><span data-stu-id="6e51b-149">The combined effect of these steps is that the subnet level UDR will take precedence over the ExpressRoute forced tunneling, thus ensuring outbound Internet access from the App Service Environment.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="6e51b-150">De vägar som definierats i en UDR **måste** vara specifikt nog att företräde framför alla vägarna som annonseras av ExpressRoute-konfigurationen.</span><span class="sxs-lookup"><span data-stu-id="6e51b-150">The routes defined in a UDR **must** be specific enough to  take precedence over any routes advertised by the ExpressRoute configuration.</span></span>  <span data-ttu-id="6e51b-151">Exemplet nedan använder adressintervallet bred 0.0.0.0/0 och som sådan kan potentiellt av misstag åsidosättas av flödet annonser med hjälp av mer specifika adressintervall.</span><span class="sxs-lookup"><span data-stu-id="6e51b-151">The example below uses the broad 0.0.0.0/0 address range, and as such can potentially be accidentally overridden by route advertisements using more specific address ranges.</span></span>
> 
> <span data-ttu-id="6e51b-152">Apptjänstmiljöer stöds inte med ExpressRoute-konfigurationer som **annonserar vägar från offentlig peering sökvägen att privat peering sökväg mellan**.</span><span class="sxs-lookup"><span data-stu-id="6e51b-152">App Service Environments are not supported with ExpressRoute configurations that **cross-advertise routes from the public peering path to the private peering path**.</span></span>  <span data-ttu-id="6e51b-153">ExpressRoute-konfigurationer som har konfigurerats, offentlig peering får vägannonser från Microsoft för ett stort antal Microsoft Azure IP-adressintervall.</span><span class="sxs-lookup"><span data-stu-id="6e51b-153">ExpressRoute configurations that have public peering configured, will receive route advertisements from Microsoft for a large set of Microsoft Azure IP address ranges.</span></span>  <span data-ttu-id="6e51b-154">Om dessa adressintervall mellan annonseras i privat peering sökväg, är slutresultatet att alla utgående paket från den Apptjänstmiljö undernät kommer att framtvinga tunneldata kundens lokala nätverkets infrastruktur.</span><span class="sxs-lookup"><span data-stu-id="6e51b-154">If these address ranges are cross-advertised on the private peering path, the end result is that all outbound network packets from the App Service Environment's subnet will be force-tunneled to a customer's on-premises network infrastructure.</span></span>  <span data-ttu-id="6e51b-155">Det här flödet i nätverk stöds för närvarande inte med Apptjänstmiljöer.</span><span class="sxs-lookup"><span data-stu-id="6e51b-155">This network flow is currently not supported with App Service Environments.</span></span>  <span data-ttu-id="6e51b-156">En lösning på problemet är att stoppa mellan reklam vägar från offentlig peering sökvägen att privat peering sökväg.</span><span class="sxs-lookup"><span data-stu-id="6e51b-156">One solution to this problem is to stop cross-advertising routes from the public peering path to the private peering path.</span></span>
> 
> 

<span data-ttu-id="6e51b-157">Bakgrundsinformation om användardefinierade vägar är tillgänglig i det här [översikt][UDROverview].</span><span class="sxs-lookup"><span data-stu-id="6e51b-157">Background information on user defined routes is available in this [overview][UDROverview].</span></span>  

<span data-ttu-id="6e51b-158">Information om hur du skapar och konfigurerar användardefinierade vägar är tillgänglig i det här [hur till guiden][UDRHowTo].</span><span class="sxs-lookup"><span data-stu-id="6e51b-158">Details on creating and configuring user defined routes is available in this [How To Guide][UDRHowTo].</span></span>

## <a name="example-udr-configuration-for-an-app-service-environment"></a><span data-ttu-id="6e51b-159">Exempel på UDR konfiguration för en Apptjänst-miljö</span><span class="sxs-lookup"><span data-stu-id="6e51b-159">Example UDR Configuration for an App Service Environment</span></span>
<span data-ttu-id="6e51b-160">**Förutsättningar**</span><span class="sxs-lookup"><span data-stu-id="6e51b-160">**Pre-requisites**</span></span>

1. <span data-ttu-id="6e51b-161">Installera Azure Powershell från den [Azure hämtar sidan] [ AzureDownloads] (funktionsdokumentationen juni 2015 eller senare).</span><span class="sxs-lookup"><span data-stu-id="6e51b-161">Install Azure Powershell from the [Azure Downloads page][AzureDownloads] (dated June 2015 or later).</span></span>  <span data-ttu-id="6e51b-162">Under ”kommandoradsverktyg” finns det en länk för ”installera” under ”Windows Powershell” som ska installera det senaste Powershell-cmdlet.</span><span class="sxs-lookup"><span data-stu-id="6e51b-162">Under "Command-line tools" there is an "Install" link under "Windows Powershell" that will install the latest Powershell cmdlets.</span></span>
2. <span data-ttu-id="6e51b-163">Vi rekommenderar att du skapat ett unikt undernät för exklusiv användning av en Apptjänst-miljö.</span><span class="sxs-lookup"><span data-stu-id="6e51b-163">It is recommended that a unique subnet is created for exclusive use by an App Service Environment.</span></span>  <span data-ttu-id="6e51b-164">Detta säkerställer att udr: er som tillämpas på undernätet bara öppnas utgående trafik för Apptjänst-miljön.</span><span class="sxs-lookup"><span data-stu-id="6e51b-164">This ensures that the UDRs applied to the subnet will only open outbound traffic for the App Service Environment.</span></span>
3. <span data-ttu-id="6e51b-165">**Viktiga**: Distribuera inte Apptjänstmiljö förrän **när** följande konfigurationssteg följs.</span><span class="sxs-lookup"><span data-stu-id="6e51b-165">**Important**:  do not deploy the App Service Environment until **after** the following configuration steps are followed.</span></span>  <span data-ttu-id="6e51b-166">Detta säkerställer att utgående nätverksanslutningen är tillgänglig innan du försöker att distribuera en Apptjänst-miljö.</span><span class="sxs-lookup"><span data-stu-id="6e51b-166">This ensures that outbound network connectivity is available before attempting to deploy an App Service Environment.</span></span>

<span data-ttu-id="6e51b-167">**Steg 1: Skapa en namngiven routningstabell**</span><span class="sxs-lookup"><span data-stu-id="6e51b-167">**Step 1:  Create a named route table**</span></span>

<span data-ttu-id="6e51b-168">Följande kodutdrag skapar en routningstabell som kallas ”DirectInternetRouteTable” i West US Azure-region:</span><span class="sxs-lookup"><span data-stu-id="6e51b-168">The following snippet creates a route table called "DirectInternetRouteTable" in the West US Azure region:</span></span>

    New-AzureRouteTable -Name 'DirectInternetRouteTable' -Location uswest

<span data-ttu-id="6e51b-169">**Steg 2: Skapa en eller flera vägar i routningstabellen**</span><span class="sxs-lookup"><span data-stu-id="6e51b-169">**Step 2:  Create one or more routes in the route table**</span></span>

<span data-ttu-id="6e51b-170">Du behöver lägga till en eller flera vägar i routningstabellen för att aktivera utgående Internetåtkomst.</span><span class="sxs-lookup"><span data-stu-id="6e51b-170">You will need to add one or more routes to the route table in order to enable outbound Internet access.</span></span>  

<span data-ttu-id="6e51b-171">Den rekommenderade metoden för att konfigurera utgående åtkomst till Internet är att definiera en väg för 0.0.0.0/0 som visas nedan.</span><span class="sxs-lookup"><span data-stu-id="6e51b-171">The recommended approach for configuring outbound access to the Internet is to define a route for 0.0.0.0/0 as shown below.</span></span>

    Get-AzureRouteTable -Name 'DirectInternetRouteTable' | Set-AzureRoute -RouteName 'Direct Internet Range 0' -AddressPrefix 0.0.0.0/0 -NextHopType Internet

<span data-ttu-id="6e51b-172">Kom ihåg att 0.0.0.0/0 är en bred adressintervallet och därmed åsidosätts av mer specifika adressintervall annonseras av expressroute har skapats.</span><span class="sxs-lookup"><span data-stu-id="6e51b-172">Remember that 0.0.0.0/0 is a broad address range, and as such will be overridden by more specific address ranges advertised by the ExpressRoute.</span></span>  <span data-ttu-id="6e51b-173">Om du vill för att iterera tidigare rekommendationen, bör en UDR med en 0.0.0.0/0 väg användas tillsammans med en konfiguration för ExressRoute som bara annonserar samt 0.0.0.0/0.</span><span class="sxs-lookup"><span data-stu-id="6e51b-173">To re-iterate the earlier recommendation, a UDR with a 0.0.0.0/0 route should be used in conjunction with an ExressRoute configuration that only advertises 0.0.0.0/0 as well.</span></span> 

<span data-ttu-id="6e51b-174">Alternativt kan hämta du en omfattande och uppdaterad lista över CIDR-intervallen som används av Azure.</span><span class="sxs-lookup"><span data-stu-id="6e51b-174">As an alternative, you can download a comprehensive and updated list of CIDR ranges in use by Azure.</span></span>  <span data-ttu-id="6e51b-175">Xml-filen som innehåller alla Azure IP-adressintervall som är tillgängliga från den [Microsoft Download Center][DownloadCenterAddressRanges].</span><span class="sxs-lookup"><span data-stu-id="6e51b-175">The Xml file containing all of the Azure IP address ranges is available from the [Microsoft Download Center][DownloadCenterAddressRanges].</span></span>  

<span data-ttu-id="6e51b-176">Observera dock att dessa områden som ändras med tiden, vilket kräver periodiska manuell uppdatering av de användardefinierade vägarna att synkronisera.</span><span class="sxs-lookup"><span data-stu-id="6e51b-176">Note though that these ranges change over time, thus necessitating periodic manual updates to the user defined routes to keep in sync.</span></span>  <span data-ttu-id="6e51b-177">Dessutom eftersom det är en standard övre gräns på 100 vägar i en enda UDR, annonseras behöver du ”sammanfatta” Azure IP-adressintervall ska rymmas inom gränsen 100 väg i åtanke att UDR definierats vägar måste vara mer specifik än vägar av din ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="6e51b-177">Also, since there is a default upper limit of 100 routes in a single UDR, you will need to "summarize" the Azure IP address ranges to fit within the 100 route limit, keeping in mind that UDR defined routes need to be more specific than the routes advertised by your ExpressRoute.</span></span>  

<span data-ttu-id="6e51b-178">**Steg 3: Koppla routningstabellen undernät som innehåller Apptjänst-miljön**</span><span class="sxs-lookup"><span data-stu-id="6e51b-178">**Step 3:  Associate the route table to the subnet containing the App Service Environment**</span></span>

<span data-ttu-id="6e51b-179">Det sista konfigurationssteget är att koppla routningstabellen för undernätet där Apptjänst-miljön ska distribueras.</span><span class="sxs-lookup"><span data-stu-id="6e51b-179">The last  configuration step is to associate the route table to the subnet where the App Service Environment will be deployed.</span></span>  <span data-ttu-id="6e51b-180">Följande kommando associerar ”DirectInternetRouteTable” till den ”ASESubnet” som slutligen innehåller en Apptjänst-miljö.</span><span class="sxs-lookup"><span data-stu-id="6e51b-180">The following command associates the "DirectInternetRouteTable" to the "ASESubnet" that will eventually contain an App Service Environment.</span></span>

    Set-AzureSubnetRouteTable -VirtualNetworkName 'YourVirtualNetworkNameHere' -SubnetName 'ASESubnet' -RouteTableName 'DirectInternetRouteTable'


<span data-ttu-id="6e51b-181">**Steg 4: Sista stegen**</span><span class="sxs-lookup"><span data-stu-id="6e51b-181">**Step 4:  Final Steps**</span></span>

<span data-ttu-id="6e51b-182">När routningstabellen är bunden till undernätet, rekommenderas det att först testa och bekräfta den avsedda effekten.</span><span class="sxs-lookup"><span data-stu-id="6e51b-182">Once the route table is bound to the subnet, it is recommended to first test and confirm the intended effect.</span></span>  <span data-ttu-id="6e51b-183">Till exempel distribuera en virtuell dator i undernätet och kontrollera att:</span><span class="sxs-lookup"><span data-stu-id="6e51b-183">For example, deploy a virtual machine into the subnet and confirm that:</span></span>

* <span data-ttu-id="6e51b-184">Utgående trafik till både Azure och Azure-slutpunkter som nämnts tidigare i den här artikeln är **inte** flödar ned ExpressRoute-kretsen.</span><span class="sxs-lookup"><span data-stu-id="6e51b-184">Outbound traffic to both Azure and non-Azure endpoints mentioned earlier in this article is **not** flowing down the ExpressRoute circuit.</span></span>  <span data-ttu-id="6e51b-185">Det är viktigt att verifiera det här beteendet eftersom om utgående trafik från undernätet som är fortfarande tvingas tunneldata lokalt, Apptjänst-miljö skapas kommer alltid att misslyckas.</span><span class="sxs-lookup"><span data-stu-id="6e51b-185">It is very important to verify this behavior, since if outbound traffic from the subnet is still being forced tunneled on-premises, App Service Environment creation will always fail.</span></span> 
* <span data-ttu-id="6e51b-186">DNS-sökning för slutpunkter som nämnts tidigare alla löser korrekt.</span><span class="sxs-lookup"><span data-stu-id="6e51b-186">DNS lookups for the endpoints mentioned earlier are all resolving properly.</span></span> 

<span data-ttu-id="6e51b-187">När ovanstående steg bekräftas måste du ta bort den virtuella datorn eftersom undernätet måste vara ”tom” Apptjänst-miljön har skapats.</span><span class="sxs-lookup"><span data-stu-id="6e51b-187">Once the above steps are confirmed, you will need to delete the virtual machine because the subnet needs to be "empty" at the time the App Service Environment is created.</span></span>

<span data-ttu-id="6e51b-188">Fortsätt sedan med att skapa en Apptjänst-miljö.</span><span class="sxs-lookup"><span data-stu-id="6e51b-188">Then proceed with creating an App Service Environment!</span></span>

## <a name="getting-started"></a><span data-ttu-id="6e51b-189">Komma igång</span><span class="sxs-lookup"><span data-stu-id="6e51b-189">Getting started</span></span>
<span data-ttu-id="6e51b-190">Alla artiklar och hur-att datorns för Apptjänstmiljöer finns tillgängliga i den [viktigt för Programtjänstmiljöer](../app-service/app-service-app-service-environments-readme.md).</span><span class="sxs-lookup"><span data-stu-id="6e51b-190">All articles and How-To's for App Service Environments are available in the [README for Application Service Environments](../app-service/app-service-app-service-environments-readme.md).</span></span>

<span data-ttu-id="6e51b-191">Kom igång med Apptjänstmiljöer finns [introduktion till Apptjänst-miljö][IntroToAppServiceEnvironment]</span><span class="sxs-lookup"><span data-stu-id="6e51b-191">To get started with App Service Environments, see [Introduction to App Service Environment][IntroToAppServiceEnvironment]</span></span>

<span data-ttu-id="6e51b-192">Mer information om plattformen Azure App Service finns [Azure App Service][AzureAppService].</span><span class="sxs-lookup"><span data-stu-id="6e51b-192">For more information about the Azure App Service platform, see [Azure App Service][AzureAppService].</span></span>

<!-- LINKS -->
[virtualnetwork]: http://azure.microsoft.com/services/virtual-network/
[ExpressRoute]: http://azure.microsoft.com/services/expressroute/
[requiredports]: http://azure.microsoft.com/documentation/articles/app-service-app-service-environment-control-inbound-traffic/
[NetworkSecurityGroups]: http://azure.microsoft.com/documentation/articles/virtual-networks-nsg/
[UDROverview]: http://azure.microsoft.com/documentation/articles/virtual-networks-udr-overview/
[UDRHowTo]: http://azure.microsoft.com/documentation/articles/virtual-networks-udr-how-to/
[HowToCreateAnAppServiceEnvironment]: http://azure.microsoft.com/documentation/articles/app-service-web-how-to-create-an-app-service-environment/
[AzureDownloads]: http://azure.microsoft.com/en-us/downloads/ 
[DownloadCenterAddressRanges]: http://www.microsoft.com/download/details.aspx?id=41653  
[NetworkSecurityGroups]: https://azure.microsoft.com/documentation/articles/virtual-networks-nsg/
[AzureAppService]: http://azure.microsoft.com/documentation/articles/app-service-value-prop-what-is/
[IntroToAppServiceEnvironment]:  http://azure.microsoft.com/documentation/articles/app-service-app-service-environment-intro/
[NewPortal]:  https://portal.azure.com


<!-- IMAGES -->
