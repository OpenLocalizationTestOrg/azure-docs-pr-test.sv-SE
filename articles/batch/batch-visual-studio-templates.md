---
title: "aaaStart skapar Batch-lösningar med Visual Studio-projektmallar - Azure | Microsoft Docs"
description: "Lär dig mer om Visual Studio-projektmallar hur du kan implementera och köra din beräkningsintensiva arbetsbelastningar i Azure Batch."
services: batch
documentationcenter: .net
author: fayora
manager: timlt
editor: 
ms.assetid: 5e041ae2-25af-4882-a79e-3aa63c4bfb20
ms.service: batch
ms.devlang: multiple
ms.topic: article
ms.tgt_pltfrm: vm-windows
ms.workload: big-compute
ms.date: 02/27/2017
ms.author: tamram
ms.custom: H1Hack27Feb2017
ms.openlocfilehash: a61c480ddc4dffd66c01220a137a3e852e39c338
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 10/06/2017
---
# <a name="use-visual-studio-project-templates-toojump-start-batch-solutions"></a><span data-ttu-id="97e50-103">Batch-lösningar för Visual Studio-projekt mallar toojump-start</span><span class="sxs-lookup"><span data-stu-id="97e50-103">Use Visual Studio project templates toojump-start Batch solutions</span></span>

<span data-ttu-id="97e50-104">hello **Jobbhanteraren** och **aktivitet Processor Visual Studio mallar** ange koden toohelp för Batch du tooimplement och kör din beräkningsintensiva arbetsbelastningar på Batch med hello minst mängd arbete.</span><span class="sxs-lookup"><span data-stu-id="97e50-104">hello **Job Manager** and **Task Processor Visual Studio templates** for Batch provide code toohelp you tooimplement and run your compute-intensive workloads on Batch with hello least amount of effort.</span></span> <span data-ttu-id="97e50-105">Det här dokumentet beskriver dessa mallar och vägledning för hur toouse dem.</span><span class="sxs-lookup"><span data-stu-id="97e50-105">This document describes these templates and provides guidance for how toouse them.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="97e50-106">Den här artikeln beskrivs bara information tillämpliga toothese två mallar och förutsätter att du är bekant med hello Batch-tjänsten och viktiga begrepp relaterade tooit: pooler, compute-noder, jobb och uppgifter, job manager-uppgifter, miljövariabler och andra relevant information.</span><span class="sxs-lookup"><span data-stu-id="97e50-106">This article discusses only information applicable toothese two templates, and assumes that you are familiar with hello Batch service and key concepts related tooit: pools, compute nodes, jobs and tasks, job manager tasks, environment variables, and other relevant information.</span></span> <span data-ttu-id="97e50-107">Du hittar mer information finns i [grunderna i Azure Batch](batch-technical-overview.md), [Batch funktionsöversikt för utvecklare](batch-api-basics.md), och [komma igång med hello Azure Batch-biblioteket för .NET](batch-dotnet-get-started.md).</span><span class="sxs-lookup"><span data-stu-id="97e50-107">You can find more information in [Basics of Azure Batch](batch-technical-overview.md), [Batch feature overview for developers](batch-api-basics.md), and [Get started with hello Azure Batch library for .NET](batch-dotnet-get-started.md).</span></span>
> 
> 

## <a name="high-level-overview"></a><span data-ttu-id="97e50-108">Översikt på hög nivå</span><span class="sxs-lookup"><span data-stu-id="97e50-108">High-level overview</span></span>
<span data-ttu-id="97e50-109">hello Job Manager och uppgiften Processor mallar kan vara användbart två komponenter som används toocreate:</span><span class="sxs-lookup"><span data-stu-id="97e50-109">hello Job Manager and Task Processor templates can be used toocreate two useful components:</span></span>

* <span data-ttu-id="97e50-110">En manager projektaktivitet som implementerar en förgrening för jobbet som kan dela ett jobb upp på flera aktiviteter som kan köras fristående parallellt.</span><span class="sxs-lookup"><span data-stu-id="97e50-110">A job manager task that implements a job splitter that can break a job down into multiple tasks that can run independently, in parallel.</span></span>
* <span data-ttu-id="97e50-111">En uppgift processor som kan vara används tooperform föregående bearbetning och efter bearbetning runt en kommandorad för programmet.</span><span class="sxs-lookup"><span data-stu-id="97e50-111">A task processor that can be used tooperform pre-processing and post-processing around an application command line.</span></span>

<span data-ttu-id="97e50-112">Till exempel i ett scenario med film återgivning skulle hello jobbet delningslisten göra en enda film jobbet till hundratals eller tusentals olika uppgifter som behandlar enskilda ramar separat.</span><span class="sxs-lookup"><span data-stu-id="97e50-112">For example, in a movie rendering scenario, hello job splitter would turn a single movie job into hundreds or thousands of separate tasks that would process individual frames separately.</span></span> <span data-ttu-id="97e50-113">På motsvarande sätt skulle hello uppgiften processor anropa hello återgivningen programmet och alla beroende processer som är nödvändiga toorender varje ram, samt utföra eventuella ytterligare åtgärder (till exempel kopiering hello renderas ram tooa lagringsplats).</span><span class="sxs-lookup"><span data-stu-id="97e50-113">Correspondingly, hello task processor would invoke hello rendering application and all dependent processes that are needed toorender each frame, as well as perform any additional actions (for example, copying hello rendered frame tooa storage location).</span></span>

> [!NOTE]
> <span data-ttu-id="97e50-114">hello Job Manager och uppgiften Processor mallar är oberoende av varandra, så du kan välja toouse båda eller bara en av dem, beroende på hello krav för din beräknings-jobb och på dina inställningar.</span><span class="sxs-lookup"><span data-stu-id="97e50-114">hello Job Manager and Task Processor templates are independent of each other, so you can choose toouse both, or only one of them, depending on hello requirements of your compute job and on your preferences.</span></span>
> 
> 

<span data-ttu-id="97e50-115">I hello diagrammet nedan visas ett jobb för beräkning som använder de här mallarna går igenom tre steg:</span><span class="sxs-lookup"><span data-stu-id="97e50-115">As shown in hello diagram below, a compute job that uses these templates will go through three stages:</span></span>

1. <span data-ttu-id="97e50-116">hello klientkod (t.ex. program, webbtjänsten, etc.) skickar ett jobb toohello Batch-tjänsten på Azure som anger att dess jobbet manager hello job manager aktivitetsprogram.</span><span class="sxs-lookup"><span data-stu-id="97e50-116">hello client code (e.g., application, web service, etc.) submits a job toohello Batch service on Azure, specifying as its job manager task hello job manager program.</span></span>
2. <span data-ttu-id="97e50-117">hello Batch-tjänsten kör hello projektaktivitet manager på en beräkningsnod och hello jobbet delningslisten startar hello angetts antal aktiviteten processor uppgifter på som många beräkningsnoderna som krävs, baserat på hello parametrar och specifikationer i hello jobbet delningslisten kod.</span><span class="sxs-lookup"><span data-stu-id="97e50-117">hello Batch service runs hello job manager task on a compute node and hello job splitter launches hello specified number of task processor tasks, on as many compute nodes as required, based on hello parameters and specifications in hello job splitter code.</span></span>
3. <span data-ttu-id="97e50-118">hello uppgiften processor åtgärder körs oberoende av varandra, parallellt, tooprocess hello indata och generera hello utdata.</span><span class="sxs-lookup"><span data-stu-id="97e50-118">hello task processor tasks run independently, in parallel, tooprocess hello input data and generate hello output data.</span></span>

![Diagram över hur klientkod samverkar med hello Batch-tjänsten][diagram01]

## <a name="prerequisites"></a><span data-ttu-id="97e50-120">Krav</span><span class="sxs-lookup"><span data-stu-id="97e50-120">Prerequisites</span></span>
<span data-ttu-id="97e50-121">toouse hello Batch mallar, behöver du hello följande:</span><span class="sxs-lookup"><span data-stu-id="97e50-121">toouse hello Batch templates, you will need hello following:</span></span>

* <span data-ttu-id="97e50-122">En dator med Visual Studio 2015 installerat.</span><span class="sxs-lookup"><span data-stu-id="97e50-122">A computer with Visual Studio 2015 installed.</span></span> <span data-ttu-id="97e50-123">Batch-mallar är för närvarande stöds endast för Visual Studio 2015.</span><span class="sxs-lookup"><span data-stu-id="97e50-123">Batch templates are currently only supported for Visual Studio 2015.</span></span>
* <span data-ttu-id="97e50-124">hello Batch mallar, som är tillgängliga från hello [Visual Studio-galleriet] [ vs_gallery] som Visual Studio-tillägg.</span><span class="sxs-lookup"><span data-stu-id="97e50-124">hello Batch templates, which are available from hello [Visual Studio Gallery][vs_gallery] as Visual Studio extensions.</span></span> <span data-ttu-id="97e50-125">Det finns två sätt tooget hello mallar:</span><span class="sxs-lookup"><span data-stu-id="97e50-125">There are two ways tooget hello templates:</span></span>
  
  * <span data-ttu-id="97e50-126">Installera hello mallar med hjälp av hello **tillägg och uppdateringar** dialogrutan i Visual Studio (Mer information finns i [söka och med hjälp av Visual Studio-tillägg][vs_find_use_ext]).</span><span class="sxs-lookup"><span data-stu-id="97e50-126">Install hello templates using hello **Extensions and Updates** dialog box in Visual Studio (for more information, see [Finding and Using Visual Studio Extensions][vs_find_use_ext]).</span></span> <span data-ttu-id="97e50-127">I hello **tillägg och uppdateringar** dialogrutan, söka efter och hämta hello följande två tillägg:</span><span class="sxs-lookup"><span data-stu-id="97e50-127">In hello **Extensions and Updates** dialog box, search and download hello following two extensions:</span></span>
    
    * <span data-ttu-id="97e50-128">Azure Batch Job Manager med jobbet delningslisten</span><span class="sxs-lookup"><span data-stu-id="97e50-128">Azure Batch Job Manager with Job Splitter</span></span>
    * <span data-ttu-id="97e50-129">Azure Batch uppgiften Processor</span><span class="sxs-lookup"><span data-stu-id="97e50-129">Azure Batch Task Processor</span></span>
  * <span data-ttu-id="97e50-130">Ladda ned hello mallar från hello online galleriet för Visual Studio: [projektmallar för Microsoft Azure Batch][vs_gallery_templates]</span><span class="sxs-lookup"><span data-stu-id="97e50-130">Download hello templates from hello online gallery for Visual Studio: [Microsoft Azure Batch Project Templates][vs_gallery_templates]</span></span>
* <span data-ttu-id="97e50-131">Om du planerar toouse hello [programpaket](batch-application-packages.md) funktionen toodeploy hello job manager och uppgiften processor toohello Batch compute-noder måste du toolink en storage-konto tooyour Batch-kontot.</span><span class="sxs-lookup"><span data-stu-id="97e50-131">If you plan toouse hello [Application Packages](batch-application-packages.md) feature toodeploy hello job manager and task processor toohello Batch compute nodes, you need toolink a storage account tooyour Batch account.</span></span>

## <a name="preparation"></a><span data-ttu-id="97e50-132">Förberedelse</span><span class="sxs-lookup"><span data-stu-id="97e50-132">Preparation</span></span>
<span data-ttu-id="97e50-133">Vi rekommenderar att du skapar en lösning som kan innehålla din jobbhanteraren samt aktivitet processorn, eftersom detta kan göra det enklare tooshare kod mellan jobbhanteraren och uppgiften processor program.</span><span class="sxs-lookup"><span data-stu-id="97e50-133">We recommend creating a solution that can contain your job manager as well as your task processor, because this can make it easier tooshare code between your job manager and task processor programs.</span></span> <span data-ttu-id="97e50-134">toocreate den här lösningen gör du följande:</span><span class="sxs-lookup"><span data-stu-id="97e50-134">toocreate this solution, follow these steps:</span></span>

1. <span data-ttu-id="97e50-135">Öppna Visual Studio och välj **filen** > **ny** > **projekt**.</span><span class="sxs-lookup"><span data-stu-id="97e50-135">Open Visual Studio and select **File** > **New** > **Project**.</span></span>
2. <span data-ttu-id="97e50-136">Under **mallar**, expandera **andra projekttyper**, klickar du på **Visual Studio-lösningar**, och välj sedan **tomt lösning**.</span><span class="sxs-lookup"><span data-stu-id="97e50-136">Under **Templates**, expand **Other Project Types**, click **Visual Studio Solutions**, and then select **Blank Solution**.</span></span>
3. <span data-ttu-id="97e50-137">Ange ett namn som beskriver ditt program och hello syftet med den här lösningen (t.ex. ”LitwareBatchTaskPrograms”).</span><span class="sxs-lookup"><span data-stu-id="97e50-137">Type a name that describes your application and hello purpose of this solution (e.g., "LitwareBatchTaskPrograms").</span></span>
4. <span data-ttu-id="97e50-138">toocreate hello ny lösning, klickar du på **OK**.</span><span class="sxs-lookup"><span data-stu-id="97e50-138">toocreate hello new solution, click **OK**.</span></span>

## <a name="job-manager-template"></a><span data-ttu-id="97e50-139">Job Manager-mall</span><span class="sxs-lookup"><span data-stu-id="97e50-139">Job Manager template</span></span>
<span data-ttu-id="97e50-140">hello Job Manager mall kan tooimplement en projektaktivitet manager som kan utföra hello följande åtgärder:</span><span class="sxs-lookup"><span data-stu-id="97e50-140">hello Job Manager template helps you tooimplement a job manager task that can perform hello following actions:</span></span>

* <span data-ttu-id="97e50-141">Dela upp ett jobb i flera uppgifter.</span><span class="sxs-lookup"><span data-stu-id="97e50-141">Split a job into multiple tasks.</span></span>
* <span data-ttu-id="97e50-142">Skicka dessa uppgifter toorun på Batch.</span><span class="sxs-lookup"><span data-stu-id="97e50-142">Submit those tasks toorun on Batch.</span></span>

> [!NOTE]
> <span data-ttu-id="97e50-143">Läs mer om jobb manager uppgifter [Batch funktionsöversikt för utvecklare](batch-api-basics.md#job-manager-task).</span><span class="sxs-lookup"><span data-stu-id="97e50-143">For more information about job manager tasks, see [Batch feature overview for developers](batch-api-basics.md#job-manager-task).</span></span>
> 
> 

### <a name="create-a-job-manager-using-hello-template"></a><span data-ttu-id="97e50-144">Skapa en Job Manager med hjälp av hello mall</span><span class="sxs-lookup"><span data-stu-id="97e50-144">Create a Job Manager using hello template</span></span>
<span data-ttu-id="97e50-145">tooadd en job manager toohello lösning som du skapade tidigare, så här:</span><span class="sxs-lookup"><span data-stu-id="97e50-145">tooadd a job manager toohello solution that you created earlier, follow these steps:</span></span>

1. <span data-ttu-id="97e50-146">Öppna din befintliga lösning i Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="97e50-146">Open your existing solution in Visual Studio.</span></span>
2. <span data-ttu-id="97e50-147">I Solution Explorer, högerklicka på hello lösning, klickar du på **Lägg till** > **nytt projekt**.</span><span class="sxs-lookup"><span data-stu-id="97e50-147">In Solution Explorer, right-click hello solution, click **Add** > **New Project**.</span></span>
3. <span data-ttu-id="97e50-148">Under **Visual C#**, klickar du på **moln**, och klicka sedan på **Azure Batch Job Manager med jobbet delningslisten**.</span><span class="sxs-lookup"><span data-stu-id="97e50-148">Under **Visual C#**, click **Cloud**, and then click **Azure Batch Job Manager with Job Splitter**.</span></span>
4. <span data-ttu-id="97e50-149">Ange ett namn som beskriver ditt program och identifierar det här projektet som hello jobbhanteraren (t.ex.) ”LitwareJobManager”).</span><span class="sxs-lookup"><span data-stu-id="97e50-149">Type a name that describes your application and identifies this project as hello job manager (e.g. "LitwareJobManager").</span></span>
5. <span data-ttu-id="97e50-150">toocreate hello projektet klickar du på **OK**.</span><span class="sxs-lookup"><span data-stu-id="97e50-150">toocreate hello project, click **OK**.</span></span>
6. <span data-ttu-id="97e50-151">Slutligen build hello projektet tooforce Visual Studio tooload alla refererar till NuGet-paket och tooverify som hello projektet är giltigt innan du börjar att ändra den.</span><span class="sxs-lookup"><span data-stu-id="97e50-151">Finally, build hello project tooforce Visual Studio tooload all referenced NuGet packages and tooverify that hello project is valid before you start modifying it.</span></span>

### <a name="job-manager-template-files-and-their-purpose"></a><span data-ttu-id="97e50-152">Job Manager mallfilerna och deras syfte</span><span class="sxs-lookup"><span data-stu-id="97e50-152">Job Manager template files and their purpose</span></span>
<span data-ttu-id="97e50-153">När du skapar ett projekt med hello Job Manager mallen genererar tre grupper av kodfiler:</span><span class="sxs-lookup"><span data-stu-id="97e50-153">When you create a project using hello Job Manager template, it generates three groups of code files:</span></span>

* <span data-ttu-id="97e50-154">hello huvudsakliga programfilen (Program.cs).</span><span class="sxs-lookup"><span data-stu-id="97e50-154">hello main program file (Program.cs).</span></span> <span data-ttu-id="97e50-155">Innehåller hello startpunkt för programmet och översta undantagshantering.</span><span class="sxs-lookup"><span data-stu-id="97e50-155">This contains hello program entry point and top-level exception handling.</span></span> <span data-ttu-id="97e50-156">Du bör inte normalt behöver toomodify detta.</span><span class="sxs-lookup"><span data-stu-id="97e50-156">You shouldn't normally need toomodify this.</span></span>
* <span data-ttu-id="97e50-157">hello Framework-katalogen.</span><span class="sxs-lookup"><span data-stu-id="97e50-157">hello Framework directory.</span></span> <span data-ttu-id="97e50-158">Innehåller hello-filer som är ansvarig för hello-formaterad' arbete som utförs av hello job manager-program – uppackning parametrar, lägga till uppgifter toohello batchjobb osv. Du bör inte normalt måste toomodify dessa filer.</span><span class="sxs-lookup"><span data-stu-id="97e50-158">This contains hello files responsible for hello 'boilerplate' work done by hello job manager program – unpacking parameters, adding tasks toohello Batch job, etc. You shouldn't normally need toomodify these files.</span></span>
* <span data-ttu-id="97e50-159">hello delningslisten fil (JobSplitter.cs).</span><span class="sxs-lookup"><span data-stu-id="97e50-159">hello job splitter file (JobSplitter.cs).</span></span> <span data-ttu-id="97e50-160">Detta är där kommer att placeras din programspecifika logik för att dela upp ett jobb i aktiviteter.</span><span class="sxs-lookup"><span data-stu-id="97e50-160">This is where you will put your application-specific logic for splitting a job into tasks.</span></span>

<span data-ttu-id="97e50-161">Naturligtvis du kan lägga till ytterligare filer som krävs toosupport jobbet delningslisten koden, beroende på hello komplexitet hello jobbet dela logik.</span><span class="sxs-lookup"><span data-stu-id="97e50-161">Of course you can add additional files as required toosupport your job splitter code, depending on hello complexity of hello job splitting logic.</span></span>

<span data-ttu-id="97e50-162">hello mallen skapas också standard .NET projektfiler, till exempel en .csproj filen app.config, Packages.config-fil, osv.</span><span class="sxs-lookup"><span data-stu-id="97e50-162">hello template also generates standard .NET project files such as a .csproj file, app.config, packages.config, etc.</span></span>

<span data-ttu-id="97e50-163">hello resten av det här avsnittet beskrivs hello andra filer och deras kodstruktur och förklaras vad varje klass gör.</span><span class="sxs-lookup"><span data-stu-id="97e50-163">hello rest of this section describes hello different files and their code structure, and explains what each class does.</span></span>

![Visual Studio Solution Explorer visar hello Job Manager mallen lösning][solution_explorer01]

<span data-ttu-id="97e50-165">**Framework-filer**</span><span class="sxs-lookup"><span data-stu-id="97e50-165">**Framework files**</span></span>

* <span data-ttu-id="97e50-166">`Configuration.cs`: Kapslar in hello inläsning av jobb konfigurationsdata som Batch-kontoinformation, länkade lagringskontouppgifter, projekt- och information och jobbparametrar.</span><span class="sxs-lookup"><span data-stu-id="97e50-166">`Configuration.cs`: Encapsulates hello loading of job configuration data such as Batch account details, linked storage account credentials, job and task information, and job parameters.</span></span> <span data-ttu-id="97e50-167">Det ger också tillgång tooBatch definierats miljövariabler (se miljöinställningar för aktiviteter i hello Batch dokumentationen) via hello Configuration.EnvironmentVariable klass.</span><span class="sxs-lookup"><span data-stu-id="97e50-167">It also provides access tooBatch-defined environment variables (see Environment settings for tasks, in hello Batch documentation) via hello Configuration.EnvironmentVariable class.</span></span>
* <span data-ttu-id="97e50-168">`IConfiguration.cs`: Sammanfattning Hej implementering av hello Configuration klass, så att du kan testa enheten ditt jobb delningslisten med hjälp av en förfalskad eller fingerad konfigurationsobjektet.</span><span class="sxs-lookup"><span data-stu-id="97e50-168">`IConfiguration.cs`: Abstracts hello implementation of hello Configuration class, so that you can unit test your job splitter using a fake or mock configuration object.</span></span>
* <span data-ttu-id="97e50-169">`JobManager.cs`: Samordnar hello komponenter i hello job manager-program.</span><span class="sxs-lookup"><span data-stu-id="97e50-169">`JobManager.cs`: Orchestrates hello components of hello job manager program.</span></span> <span data-ttu-id="97e50-170">Den är ansvarig för hello initierar hello jobbet delningslisten, anropar hello jobbet delningslisten och sändning hello uppgifter som returneras av hello jobbet delningslisten toohello migreringsaktivitetens.</span><span class="sxs-lookup"><span data-stu-id="97e50-170">It is responsible for hello initializing hello job splitter, invoking hello job splitter, and dispatching hello tasks returned by hello job splitter toohello task submitter.</span></span>
* <span data-ttu-id="97e50-171">`JobManagerException.cs`: Representerar ett fel som kräver hello job manager tooterminate.</span><span class="sxs-lookup"><span data-stu-id="97e50-171">`JobManagerException.cs`: Represents an error that requires hello job manager tooterminate.</span></span> <span data-ttu-id="97e50-172">JobManagerException är används toowrap 'förväntades' fel där specifika diagnostisk information kan anges som en del av avslutning.</span><span class="sxs-lookup"><span data-stu-id="97e50-172">JobManagerException is used toowrap 'expected' errors where specific diagnostic information can be provided as part of termination.</span></span>
* <span data-ttu-id="97e50-173">`TaskSubmitter.cs`: Den här klassen är ansvarig tooadding uppgifter som returneras av hello jobbet delningslisten toohello Batch-jobbet.</span><span class="sxs-lookup"><span data-stu-id="97e50-173">`TaskSubmitter.cs`: This class is responsible tooadding tasks returned by hello job splitter toohello Batch job.</span></span> <span data-ttu-id="97e50-174">hello JobManager klassen aggregerar hello aktivitetssekvensen i batchar för effektiv men rimlig tillägg toohello jobbet och sedan anropar TaskSubmitter.SubmitTasks på en bakgrundstråd för varje grupp.</span><span class="sxs-lookup"><span data-stu-id="97e50-174">hello JobManager class aggregates hello sequence of tasks into batches for efficient but timely addition toohello job, then calls TaskSubmitter.SubmitTasks on a background thread for each batch.</span></span>

<span data-ttu-id="97e50-175">**Jobbet delningslisten**</span><span class="sxs-lookup"><span data-stu-id="97e50-175">**Job Splitter**</span></span>

<span data-ttu-id="97e50-176">`JobSplitter.cs`: Den här klassen innehåller programspecifika logik för att dela hello jobbet i aktiviteter.</span><span class="sxs-lookup"><span data-stu-id="97e50-176">`JobSplitter.cs`: This class contains application-specific logic for splitting hello job into tasks.</span></span> <span data-ttu-id="97e50-177">hello framework anropar hello JobSplitter.Split metoden tooobtain en serie uppgifter som läggs till toohello jobb som hello-metoden returnerar dem.</span><span class="sxs-lookup"><span data-stu-id="97e50-177">hello framework invokes hello JobSplitter.Split method tooobtain a sequence of tasks, which it adds toohello job as hello method returns them.</span></span> <span data-ttu-id="97e50-178">Detta är hello klassen där du matar in hello logiken för ditt jobb.</span><span class="sxs-lookup"><span data-stu-id="97e50-178">This is hello class where you will inject hello logic of your job.</span></span> <span data-ttu-id="97e50-179">Implementera hello dela metoden tooreturn en sekvens av CloudTask instanser som representerar hello aktiviteter som du vill toopartition hello jobb.</span><span class="sxs-lookup"><span data-stu-id="97e50-179">Implement hello Split method tooreturn a sequence of CloudTask instances representing hello tasks into which you want toopartition hello job.</span></span>

<span data-ttu-id="97e50-180">**Standard projektfiler för .NET-kommandorad**</span><span class="sxs-lookup"><span data-stu-id="97e50-180">**Standard .NET command line project files**</span></span>

* <span data-ttu-id="97e50-181">`App.config`: Standard .NET-programkonfigurationsfilen.</span><span class="sxs-lookup"><span data-stu-id="97e50-181">`App.config`: Standard .NET application configuration file.</span></span>
* <span data-ttu-id="97e50-182">`Packages.config`: Standard NuGet-paketet beroende fil.</span><span class="sxs-lookup"><span data-stu-id="97e50-182">`Packages.config`: Standard NuGet package dependency file.</span></span>
* <span data-ttu-id="97e50-183">`Program.cs`: Innehåller hello startpunkt för programmet och översta undantagshantering.</span><span class="sxs-lookup"><span data-stu-id="97e50-183">`Program.cs`: Contains hello program entry point and top-level exception handling.</span></span>

### <a name="implementing-hello-job-splitter"></a><span data-ttu-id="97e50-184">Implementera hello jobbet delningslisten</span><span class="sxs-lookup"><span data-stu-id="97e50-184">Implementing hello job splitter</span></span>
<span data-ttu-id="97e50-185">När du öppnar hello Job Manager mallprojekt har hello projektet hello JobSplitter.cs filen öppnas som standard.</span><span class="sxs-lookup"><span data-stu-id="97e50-185">When you open hello Job Manager template project, hello project will have hello JobSplitter.cs file open by default.</span></span> <span data-ttu-id="97e50-186">Du kan implementera hello dela logik för hello aktiviteter i din arbetsbelastning med hjälp av hello Split() metoden visas nedan:</span><span class="sxs-lookup"><span data-stu-id="97e50-186">You can implement hello split logic for hello tasks in your workload by using hello Split() method show below:</span></span>

```csharp
/// <summary>
/// Gets hello tasks into which toosplit hello job. This is where you inject
/// your application-specific logic for decomposing hello job into tasks.
///
/// hello job manager framework invokes hello Split method for you; you need
/// only tooimplement it, not toocall it yourself. Typically, your
/// implementation should return tasks lazily, for example using a C#
/// iterator and hello "yield return" statement; this allows tasks toobe added
/// and toostart running while splitting is still in progress.
/// </summary>
/// <returns>hello tasks toobe added toohello job. Tasks are added automatically
/// by hello job manager framework as they are returned by this method.</returns>
public IEnumerable<CloudTask> Split()
{
    // Your code for hello split logic goes here.
    int startFrame = Convert.ToInt32(_parameters["StartFrame"]);
    int endFrame = Convert.ToInt32(_parameters["EndFrame"]);

    for (int i = startFrame; i <= endFrame; i++)
    {
        yield return new CloudTask("myTask" + i, "cmd /c dir");
    }
}
```

> [!NOTE]
> <span data-ttu-id="97e50-187">hello kommenterade avsnitt i hello `Split()` metoden är endast hello-avsnitt i hello Job Manager kod som är avsedd för du toomodify genom att lägga till hello logik toosplit jobb i olika aktiviteter.</span><span class="sxs-lookup"><span data-stu-id="97e50-187">hello annotated section in hello `Split()` method is hello only section of hello Job Manager template code that is intended for you toomodify by adding hello logic toosplit your jobs into different tasks.</span></span> <span data-ttu-id="97e50-188">Om du vill toomodify ett annat avsnitt i hello mall, kontrollera att du har bekantat med hur Batch fungerar och prova några av hello [Batch-kodexempel][github_samples].</span><span class="sxs-lookup"><span data-stu-id="97e50-188">If you want toomodify a different section of hello template, please ensure you are familiarized with how Batch works, and try out a few of hello [Batch code samples][github_samples].</span></span>
> 
> 

<span data-ttu-id="97e50-189">Implementeringen Split() har åtkomst till:</span><span class="sxs-lookup"><span data-stu-id="97e50-189">Your Split() implementation has access to:</span></span>

* <span data-ttu-id="97e50-190">Hej jobbparametrar via hello `_parameters` fältet.</span><span class="sxs-lookup"><span data-stu-id="97e50-190">hello job parameters, via hello `_parameters` field.</span></span>
* <span data-ttu-id="97e50-191">Hej CloudJob objekt som representerar hello jobb via hello `_job` fältet.</span><span class="sxs-lookup"><span data-stu-id="97e50-191">hello CloudJob object representing hello job, via hello `_job` field.</span></span>
* <span data-ttu-id="97e50-192">Hej CloudTask objekt som representerar hello manager projektaktivitet via hello `_jobManagerTask` fältet.</span><span class="sxs-lookup"><span data-stu-id="97e50-192">hello CloudTask object representing hello job manager task, via hello `_jobManagerTask` field.</span></span>

<span data-ttu-id="97e50-193">Din `Split()` implementering behöver inte tooadd uppgifter toohello jobbet direkt.</span><span class="sxs-lookup"><span data-stu-id="97e50-193">Your `Split()` implementation does not need tooadd tasks toohello job directly.</span></span> <span data-ttu-id="97e50-194">I stället koden ska returnera en sekvens av CloudTask objekt och de läggas automatiskt till toohello jobb av hello framework klasser som anropar hello jobbet delningslisten.</span><span class="sxs-lookup"><span data-stu-id="97e50-194">Instead, your code should return a sequence of CloudTask objects, and these will be added toohello job automatically by hello framework classes that invoke hello job splitter.</span></span> <span data-ttu-id="97e50-195">Det är vanligt toouse C# 's iterator (`yield return`) funktion tooimplement jobbet delarna eftersom detta gör att hello uppgifter toostart körs så snart som möjligt, i stället för att väntar på att alla aktiviteter toobe beräknas.</span><span class="sxs-lookup"><span data-stu-id="97e50-195">It's common toouse C#'s iterator (`yield return`) feature tooimplement job splitters as this allows hello tasks toostart running as soon as possible rather than waiting for all tasks toobe calculated.</span></span>

<span data-ttu-id="97e50-196">**Jobbet delningslisten misslyckades**</span><span class="sxs-lookup"><span data-stu-id="97e50-196">**Job splitter failure**</span></span>

<span data-ttu-id="97e50-197">Om jobbet-delningslisten påträffar ett fel, bör det antingen:</span><span class="sxs-lookup"><span data-stu-id="97e50-197">If your job splitter encounters an error, it should either:</span></span>

* <span data-ttu-id="97e50-198">Avsluta hello sekvens med hello C# `yield break` instruktionen, där case hello jobbhanteraren behandlas som slutförd, eller</span><span class="sxs-lookup"><span data-stu-id="97e50-198">Terminate hello sequence using hello C# `yield break` statement, in which case hello job manager will be treated as successful; or</span></span>
* <span data-ttu-id="97e50-199">Utlös ett undantag, där case hello jobbhanteraren behandlas som misslyckad och kan göras beroende på hur hello-klienten har konfigurerats).</span><span class="sxs-lookup"><span data-stu-id="97e50-199">Throw an exception, in which case hello job manager will be treated as failed and may be retried depending on how hello client has configured it).</span></span>

<span data-ttu-id="97e50-200">I båda fallen måste alla uppgifter returnerades redan av hello jobbet delningslisten och tillagda toohello Batch-jobbet kommer att vara berättigad toorun.</span><span class="sxs-lookup"><span data-stu-id="97e50-200">In both cases, any tasks already returned by hello job splitter and added toohello Batch job will be eligible toorun.</span></span> <span data-ttu-id="97e50-201">Klicka om du inte vill att den här toohappen, kan du:</span><span class="sxs-lookup"><span data-stu-id="97e50-201">If you don't want this toohappen, then you could:</span></span>

* <span data-ttu-id="97e50-202">Avsluta hello jobb innan man returneras från hello jobbet delningslisten</span><span class="sxs-lookup"><span data-stu-id="97e50-202">Terminate hello job before returning from hello job splitter</span></span>
* <span data-ttu-id="97e50-203">Formulera hello hela aktiviteten till samlingen innan det returneras (det vill säga returnera en `ICollection<CloudTask>` eller `IList<CloudTask>` i stället för att implementera din jobbet delningslisten med C#-iterator)</span><span class="sxs-lookup"><span data-stu-id="97e50-203">Formulate hello entire task collection before returning it (that is, return an `ICollection<CloudTask>` or `IList<CloudTask>` instead of implementing your job splitter using a C# iterator)</span></span>
* <span data-ttu-id="97e50-204">Använd aktiviteten beroenden toomake alla aktiviteter är beroende av hello slutförande av hello job manager</span><span class="sxs-lookup"><span data-stu-id="97e50-204">Use task dependencies toomake all tasks depend on hello successful completion of hello job manager</span></span>

<span data-ttu-id="97e50-205">**Jobbet manager återförsök**</span><span class="sxs-lookup"><span data-stu-id="97e50-205">**Job manager retries**</span></span>

<span data-ttu-id="97e50-206">Om hello jobbhanteraren misslyckas utförs den igen av hello Batch-tjänsten beroende på hello klientinställningar försök igen.</span><span class="sxs-lookup"><span data-stu-id="97e50-206">If hello job manager fails, it may be retried by hello Batch service depending on hello client retry settings.</span></span> <span data-ttu-id="97e50-207">Detta är generellt sett är säkra, eftersom när hello framework lägger till aktiviteter toohello jobb, ignoreras alla aktiviteter som redan finns.</span><span class="sxs-lookup"><span data-stu-id="97e50-207">In general, this is safe, because when hello framework adds tasks toohello job, it ignores any tasks that already exist.</span></span> <span data-ttu-id="97e50-208">Men om beräkning av uppgifter är dyr, kanske vill du inte tooincur hello kostnaden för att beräkna aktiviteter som redan har lagts toohello jobb. däremot om hello kör är inte garanterat toogenerate hello samma aktivitets-ID och sedan hello 'Ignorera dubbletter' beteende inte kommer startar.</span><span class="sxs-lookup"><span data-stu-id="97e50-208">However, if calculating tasks is expensive, you may not wish tooincur hello cost of recalculating tasks that have already been added toohello job; conversely, if hello re-run is not guaranteed toogenerate hello same task IDs then hello 'ignore duplicates' behavior will not kick in.</span></span> <span data-ttu-id="97e50-209">I dessa fall bör du utforma jobbet delningslisten toodetect hello arbetet som redan har utförts och inte upprepa den, till exempel genom att utföra en CloudJob.ListTasks innan du startar tooyield uppgifter.</span><span class="sxs-lookup"><span data-stu-id="97e50-209">In these cases you should design your job splitter toodetect hello work that has already been done and not repeat it, for example by performing a CloudJob.ListTasks before starting tooyield tasks.</span></span>

### <a name="exit-codes-and-exceptions-in-hello-job-manager-template"></a><span data-ttu-id="97e50-210">Avsluta koder och undantag i hello Job Manager-mall</span><span class="sxs-lookup"><span data-stu-id="97e50-210">Exit codes and exceptions in hello Job Manager template</span></span>
<span data-ttu-id="97e50-211">Slutkoder och undantag tillhandahåller en mekanism toodetermine hello resultatet av att köra ett program och de kan hjälpa tooidentify eventuella problem med hello hello program ska köras.</span><span class="sxs-lookup"><span data-stu-id="97e50-211">Exit codes and exceptions provide a mechanism toodetermine hello outcome of running a program, and they can help tooidentify any problems with hello execution of hello program.</span></span> <span data-ttu-id="97e50-212">hello Job Manager mallen implementerar hello slutkoder och undantag som beskrivs i det här avsnittet.</span><span class="sxs-lookup"><span data-stu-id="97e50-212">hello Job Manager template implements hello exit codes and exceptions described in this section.</span></span>

<span data-ttu-id="97e50-213">En projektaktivitet manager som har implementerats med hello Job Manager mall kan returnera tre möjliga slutkoder:</span><span class="sxs-lookup"><span data-stu-id="97e50-213">A job manager task that is implemented with hello Job Manager template can return three possible exit codes:</span></span>

| <span data-ttu-id="97e50-214">Kod</span><span class="sxs-lookup"><span data-stu-id="97e50-214">Code</span></span> | <span data-ttu-id="97e50-215">Beskrivning</span><span class="sxs-lookup"><span data-stu-id="97e50-215">Description</span></span> |
| --- | --- |
| <span data-ttu-id="97e50-216">0</span><span class="sxs-lookup"><span data-stu-id="97e50-216">0</span></span> |<span data-ttu-id="97e50-217">Hej jobbhanteraren har slutförts.</span><span class="sxs-lookup"><span data-stu-id="97e50-217">hello job manager completed successfully.</span></span> <span data-ttu-id="97e50-218">Jobbet delningslisten koden körde toocompletion och alla aktiviteter har lagts till toohello jobb.</span><span class="sxs-lookup"><span data-stu-id="97e50-218">Your job splitter code ran toocompletion, and all tasks were added toohello job.</span></span> |
| <span data-ttu-id="97e50-219">1</span><span class="sxs-lookup"><span data-stu-id="97e50-219">1</span></span> |<span data-ttu-id="97e50-220">hello projektaktivitet manager misslyckades med ett undantag i en '' del av programmet hello.</span><span class="sxs-lookup"><span data-stu-id="97e50-220">hello job manager task failed with an exception in an 'expected' part of hello program.</span></span> <span data-ttu-id="97e50-221">hello undantaget var översatta tooa JobManagerException med diagnostisk information och, om möjligt hello förslag för att lösa felet.</span><span class="sxs-lookup"><span data-stu-id="97e50-221">hello exception was translated tooa JobManagerException with diagnostic information and, where possible, suggestions for resolving hello failure.</span></span> |
| <span data-ttu-id="97e50-222">2</span><span class="sxs-lookup"><span data-stu-id="97e50-222">2</span></span> |<span data-ttu-id="97e50-223">hello projektaktivitet manager misslyckades med ett 'oväntat-undantag.</span><span class="sxs-lookup"><span data-stu-id="97e50-223">hello job manager task failed with an 'unexpected' exception.</span></span> <span data-ttu-id="97e50-224">hello undantaget var loggade toostandard utdata, men hello jobbhanteraren kunde tooadd eventuell ytterligare information för diagnostik eller reparation.</span><span class="sxs-lookup"><span data-stu-id="97e50-224">hello exception was logged toostandard output, but hello job manager was unable tooadd any additional diagnostic or remediation information.</span></span> |

<span data-ttu-id="97e50-225">Hello gäller jobbet manager uppgift misslyckades, kan vissa aktiviteter fortfarande har lagts toohello service innan hello-fel uppstod.</span><span class="sxs-lookup"><span data-stu-id="97e50-225">In hello case of job manager task failure, some tasks may still have been added toohello service before hello error occurred.</span></span> <span data-ttu-id="97e50-226">Dessa aktiviteter kommer att köras som vanligt.</span><span class="sxs-lookup"><span data-stu-id="97e50-226">These tasks will run as normal.</span></span> <span data-ttu-id="97e50-227">Se ”jobbet delningslisten misslyckades” ovan beskrivning av den här kodsökvägen.</span><span class="sxs-lookup"><span data-stu-id="97e50-227">See "Job Splitter Failure" above for discussion of this code path.</span></span>

<span data-ttu-id="97e50-228">Alla hello information som returnerades av undantag skrivs i stdout.txt och stderr.txt-filer.</span><span class="sxs-lookup"><span data-stu-id="97e50-228">All hello information returned by exceptions is written into stdout.txt and stderr.txt files.</span></span> <span data-ttu-id="97e50-229">Mer information finns i [felhantering](batch-api-basics.md#error-handling).</span><span class="sxs-lookup"><span data-stu-id="97e50-229">For more information, see [Error Handling](batch-api-basics.md#error-handling).</span></span>

### <a name="client-considerations"></a><span data-ttu-id="97e50-230">Överväganden för klienten</span><span class="sxs-lookup"><span data-stu-id="97e50-230">Client considerations</span></span>
<span data-ttu-id="97e50-231">Det här avsnittet beskrivs vissa implementering klientkrav när anropar en jobbhanteraren baserat på den här mallen.</span><span class="sxs-lookup"><span data-stu-id="97e50-231">This section describes some client implementation requirements when invoking a job manager based on this template.</span></span> <span data-ttu-id="97e50-232">Se [hur toopass parametrar och miljövariabler från hello klientkod](#pass-environment-settings) information om skicka parametrar och inställningar.</span><span class="sxs-lookup"><span data-stu-id="97e50-232">See [How toopass parameters and environment variables from hello client code](#pass-environment-settings) for details on passing parameters and environment settings.</span></span>

<span data-ttu-id="97e50-233">**Obligatoriska autentiseringsuppgifter**</span><span class="sxs-lookup"><span data-stu-id="97e50-233">**Mandatory credentials**</span></span>

<span data-ttu-id="97e50-234">I ordning tooadd uppgifter toohello Azure Batch-jobbet kräver hello projektaktivitet manager din URL: en för Azure Batch-konto och nyckel.</span><span class="sxs-lookup"><span data-stu-id="97e50-234">In order tooadd tasks toohello Azure Batch job, hello job manager task requires your Azure Batch account URL and key.</span></span> <span data-ttu-id="97e50-235">Du måste skicka dessa i miljövariabler som heter YOUR_BATCH_URL och YOUR_BATCH_KEY.</span><span class="sxs-lookup"><span data-stu-id="97e50-235">You must pass these in environment variables named YOUR_BATCH_URL and YOUR_BATCH_KEY.</span></span> <span data-ttu-id="97e50-236">Du kan ange dessa i hello Job Manager aktivitetsinställningar i miljön.</span><span class="sxs-lookup"><span data-stu-id="97e50-236">You can set these in hello Job Manager task environment settings.</span></span> <span data-ttu-id="97e50-237">Till exempel i C# klient:</span><span class="sxs-lookup"><span data-stu-id="97e50-237">For example, in a C# client:</span></span>

```csharp
job.JobManagerTask.EnvironmentSettings = new [] {
    new EnvironmentSetting("YOUR_BATCH_URL", "https://account.region.batch.azure.com"),
    new EnvironmentSetting("YOUR_BATCH_KEY", "{your_base64_encoded_account_key}"),
};
```
<span data-ttu-id="97e50-238">**Autentiseringsuppgifter för lagring**</span><span class="sxs-lookup"><span data-stu-id="97e50-238">**Storage credentials**</span></span>

<span data-ttu-id="97e50-239">Normalt behöver hello klienten inte tooprovide hello länkade storage-konto autentiseringsuppgifter toohello manager projektaktivitet eftersom (a) de flesta jobbet cheferna behöver inte tooexplicitly åtkomst hello länkade storage-konto och (b) hello länkade storage-konto används ofta tooall aktiviteter som en gemensam miljö för hello jobb.</span><span class="sxs-lookup"><span data-stu-id="97e50-239">Typically, hello client does not need tooprovide hello linked storage account credentials toohello job manager task because (a) most job managers do not need tooexplicitly access hello linked storage account and (b) hello linked storage account is often provided tooall tasks as a common environment setting for hello job.</span></span> <span data-ttu-id="97e50-240">Om du inte tillhandahåller hello länkade storage-konto via hello vanliga miljöinställningar och hello jobbhanteraren kräver åtkomst toolinked lagring och sedan du ska ange autentiseringsuppgifter för hello länkad lagring på följande sätt:</span><span class="sxs-lookup"><span data-stu-id="97e50-240">If you are not providing hello linked storage account via hello common environment settings, and hello job manager requires access toolinked storage, then you should supply hello linked storage credentials as follows:</span></span>

```csharp
job.JobManagerTask.EnvironmentSettings = new [] {
    /* other environment settings */
    new EnvironmentSetting("LINKED_STORAGE_ACCOUNT", "{storageAccountName}"),
    new EnvironmentSetting("LINKED_STORAGE_KEY", "{storageAccountKey}"),
};
```

<span data-ttu-id="97e50-241">**Jobbet manager aktivitetsinställningar**</span><span class="sxs-lookup"><span data-stu-id="97e50-241">**Job manager task settings**</span></span>

<span data-ttu-id="97e50-242">hello klienten bör ange hello jobbhanteraren *killJobOnCompletion* flaggan för**FALSKT**.</span><span class="sxs-lookup"><span data-stu-id="97e50-242">hello client should set hello job manager *killJobOnCompletion* flag too**false**.</span></span>

<span data-ttu-id="97e50-243">Det är oftast säkert för hello klienten tooset *runExclusive* för**FALSKT**.</span><span class="sxs-lookup"><span data-stu-id="97e50-243">It is usually safe for hello client tooset *runExclusive* too**false**.</span></span>

<span data-ttu-id="97e50-244">hello klienten bör använda hello *resourceFiles* eller *applicationPackageReferences* samling toohave hello jobbhanteraren körbara (och dess nödvändiga DLL-filer) distribueras toohello compute-nod.</span><span class="sxs-lookup"><span data-stu-id="97e50-244">hello client should use hello *resourceFiles* or *applicationPackageReferences* collection toohave hello job manager executable (and its required DLLs) deployed toohello compute node.</span></span>

<span data-ttu-id="97e50-245">Som standard kommer hello jobbhanteraren inte göras om det misslyckas.</span><span class="sxs-lookup"><span data-stu-id="97e50-245">By default, hello job manager will not be retried if it fails.</span></span> <span data-ttu-id="97e50-246">Beroende på dina jobb manager logik hello klienter kanske tooenable återförsök via *begränsningar*/*maxTaskRetryCount*.</span><span class="sxs-lookup"><span data-stu-id="97e50-246">Depending on your job manager logic, hello client may want tooenable retries via *constraints*/*maxTaskRetryCount*.</span></span>

<span data-ttu-id="97e50-247">**Inställningar för**</span><span class="sxs-lookup"><span data-stu-id="97e50-247">**Job settings**</span></span>

<span data-ttu-id="97e50-248">Om hello jobbet delningslisten avger åtgärder med beroenden, ange hello klienten hello jobbet usesTaskDependencies tootrue.</span><span class="sxs-lookup"><span data-stu-id="97e50-248">If hello job splitter emits tasks with dependencies, hello client must set hello job's usesTaskDependencies tootrue.</span></span>

<span data-ttu-id="97e50-249">Det är ovanligt för klienter toowish tooadd uppgifter toojobs utöver vilka hello jobbet delningslisten skapar i hello jobbet delningslisten modellen.</span><span class="sxs-lookup"><span data-stu-id="97e50-249">In hello job splitter model, it is unusual for clients toowish tooadd tasks toojobs over and above what hello job splitter creates.</span></span> <span data-ttu-id="97e50-250">hello klienten bör normalt därför ange hello jobbet *onAllTasksComplete* för**terminatejob**.</span><span class="sxs-lookup"><span data-stu-id="97e50-250">hello client should therefore normally set hello job's *onAllTasksComplete* too**terminatejob**.</span></span>

## <a name="task-processor-template"></a><span data-ttu-id="97e50-251">Uppgiftsmallar för Processor</span><span class="sxs-lookup"><span data-stu-id="97e50-251">Task Processor template</span></span>
<span data-ttu-id="97e50-252">En uppgift Processor-mall kan du tooimplement en aktivitet processor som kan utföra följande åtgärder hello:</span><span class="sxs-lookup"><span data-stu-id="97e50-252">A Task Processor template helps you tooimplement a task processor that can perform hello following actions:</span></span>

* <span data-ttu-id="97e50-253">Ställ in hello information som krävs för varje Batch uppgiften toorun.</span><span class="sxs-lookup"><span data-stu-id="97e50-253">Set up hello information required by each Batch task toorun.</span></span>
* <span data-ttu-id="97e50-254">Kör alla åtgärder som krävs för varje Batch-aktivitet.</span><span class="sxs-lookup"><span data-stu-id="97e50-254">Run all actions required by each Batch task.</span></span>
* <span data-ttu-id="97e50-255">Spara aktiviteten utdata toopersistent lagring.</span><span class="sxs-lookup"><span data-stu-id="97e50-255">Save task outputs toopersistent storage.</span></span>

<span data-ttu-id="97e50-256">Även om en aktivitet processorn inte är nödvändiga toorun uppgifter på Batch är hello stor fördel med att använda en aktivitet processor att det ger en wrapper tooimplement alla-körningen åtgärder på en plats.</span><span class="sxs-lookup"><span data-stu-id="97e50-256">Although a task processor is not required toorun tasks on Batch, hello key advantage of using a task processor is that it provides a wrapper tooimplement all task execution actions in one location.</span></span> <span data-ttu-id="97e50-257">Till exempel om du behöver toorun flera program i hello kontexten för varje aktivitet, eller om du behöver toocopy toopersistent datalagring när du har slutfört varje uppgift.</span><span class="sxs-lookup"><span data-stu-id="97e50-257">For example, if you need toorun several applications in hello context of each task, or if you need toocopy data toopersistent storage after completing each task.</span></span>

<span data-ttu-id="97e50-258">hello-åtgärder som utförs av hello uppgiften processor kan vara som enkla eller komplexa, och många eller få som krävs av din arbetsbelastning.</span><span class="sxs-lookup"><span data-stu-id="97e50-258">hello actions performed by hello task processor can be as simple or complex, and as many or as few, as required by your workload.</span></span> <span data-ttu-id="97e50-259">Dessutom genom att implementera alla-åtgärder i en aktivitet processor, kan du lätt uppdatera eller lägga till åtgärder baserat på ändringar tooapplications eller arbetsbelastning krav.</span><span class="sxs-lookup"><span data-stu-id="97e50-259">Additionally, by implementing all task actions into one task processor, you can readily update or add actions based on changes tooapplications or workload requirements.</span></span> <span data-ttu-id="97e50-260">Men i vissa fall kanske en uppgift processor inte hello optimal lösning för din implementering som den kan lägga till onödiga komplexitet, till exempel när du kör jobb som går snabbt att starta från en enkel kommandorad.</span><span class="sxs-lookup"><span data-stu-id="97e50-260">However, in some cases a task processor might not be hello optimal solution for your implementation as it can add unnecessary complexity, for example when running jobs that can be quickly started from a simple command line.</span></span>

### <a name="create-a-task-processor-using-hello-template"></a><span data-ttu-id="97e50-261">Skapa en uppgift-Processor med hello mall</span><span class="sxs-lookup"><span data-stu-id="97e50-261">Create a Task Processor using hello template</span></span>
<span data-ttu-id="97e50-262">tooadd en aktivitet processor toohello lösning som du skapade tidigare, så här:</span><span class="sxs-lookup"><span data-stu-id="97e50-262">tooadd a task processor toohello solution that you created earlier, follow these steps:</span></span>

1. <span data-ttu-id="97e50-263">Öppna din befintliga lösning i Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="97e50-263">Open your existing solution in Visual Studio.</span></span>
2. <span data-ttu-id="97e50-264">I Solution Explorer, högerklicka på hello lösning, klickar du på **Lägg till**, och klicka sedan på **nytt projekt**.</span><span class="sxs-lookup"><span data-stu-id="97e50-264">In Solution Explorer, right-click hello solution, click **Add**, and then click **New Project**.</span></span>
3. <span data-ttu-id="97e50-265">Under **Visual C#**, klickar du på **moln**, och klicka sedan på **Azure Batch uppgiften Processor**.</span><span class="sxs-lookup"><span data-stu-id="97e50-265">Under **Visual C#**, click **Cloud**, and then click **Azure Batch Task Processor**.</span></span>
4. <span data-ttu-id="97e50-266">Ange ett namn som beskriver ditt program och identifierar det här projektet som hello uppgiften processor (t.ex.) ”LitwareTaskProcessor”).</span><span class="sxs-lookup"><span data-stu-id="97e50-266">Type a name that describes your application and identifies this project as hello task processor (e.g. "LitwareTaskProcessor").</span></span>
5. <span data-ttu-id="97e50-267">toocreate hello projektet klickar du på **OK**.</span><span class="sxs-lookup"><span data-stu-id="97e50-267">toocreate hello project, click **OK**.</span></span>
6. <span data-ttu-id="97e50-268">Slutligen build hello projektet tooforce Visual Studio tooload alla refererar till NuGet-paket och tooverify som hello projektet är giltigt innan du börjar att ändra den.</span><span class="sxs-lookup"><span data-stu-id="97e50-268">Finally, build hello project tooforce Visual Studio tooload all referenced NuGet packages and tooverify that hello project is valid before you start modifying it.</span></span>

### <a name="task-processor-template-files-and-their-purpose"></a><span data-ttu-id="97e50-269">Uppgiften Processor mallfilerna och deras syfte</span><span class="sxs-lookup"><span data-stu-id="97e50-269">Task Processor template files and their purpose</span></span>
<span data-ttu-id="97e50-270">När du skapar ett projekt med hello uppgiften processor mallen genererar tre grupper av kodfiler:</span><span class="sxs-lookup"><span data-stu-id="97e50-270">When you create a project using hello task processor template, it generates three groups of code files:</span></span>

* <span data-ttu-id="97e50-271">hello huvudsakliga programfilen (Program.cs).</span><span class="sxs-lookup"><span data-stu-id="97e50-271">hello main program file (Program.cs).</span></span> <span data-ttu-id="97e50-272">Innehåller hello startpunkt för programmet och översta undantagshantering.</span><span class="sxs-lookup"><span data-stu-id="97e50-272">This contains hello program entry point and top-level exception handling.</span></span> <span data-ttu-id="97e50-273">Du bör inte normalt behöver toomodify detta.</span><span class="sxs-lookup"><span data-stu-id="97e50-273">You shouldn't normally need toomodify this.</span></span>
* <span data-ttu-id="97e50-274">hello Framework-katalogen.</span><span class="sxs-lookup"><span data-stu-id="97e50-274">hello Framework directory.</span></span> <span data-ttu-id="97e50-275">Innehåller hello-filer som är ansvarig för hello-formaterad' arbete som utförs av hello job manager-program – uppackning parametrar, lägga till uppgifter toohello batchjobb osv. Du bör inte normalt måste toomodify dessa filer.</span><span class="sxs-lookup"><span data-stu-id="97e50-275">This contains hello files responsible for hello 'boilerplate' work done by hello job manager program – unpacking parameters, adding tasks toohello Batch job, etc. You shouldn't normally need toomodify these files.</span></span>
* <span data-ttu-id="97e50-276">hello uppgiften processor-fil (TaskProcessor.cs).</span><span class="sxs-lookup"><span data-stu-id="97e50-276">hello task processor file (TaskProcessor.cs).</span></span> <span data-ttu-id="97e50-277">Detta är där kommer att placeras din programspecifika logik för att köra en aktivitet (vanligtvis genom att anropa ut tooan befintliga executable).</span><span class="sxs-lookup"><span data-stu-id="97e50-277">This is where you will put your application-specific logic for executing a task (typically by calling out tooan existing executable).</span></span> <span data-ttu-id="97e50-278">Före och efterbearbetning kod, till exempel ladda ned ytterligare data eller överför resultat filer även här.</span><span class="sxs-lookup"><span data-stu-id="97e50-278">Pre- and post-processing code, such as downloading additional data or uploading result files, also goes here.</span></span>

<span data-ttu-id="97e50-279">Naturligtvis du kan lägga till ytterligare filer som krävs toosupport aktivitet processor koden, beroende på hello komplexitet hello jobbet dela logik.</span><span class="sxs-lookup"><span data-stu-id="97e50-279">Of course you can add additional files as required toosupport your task processor code, depending on hello complexity of hello job splitting logic.</span></span>

<span data-ttu-id="97e50-280">hello mallen skapas också standard .NET projektfiler, till exempel en .csproj filen app.config, Packages.config-fil, osv.</span><span class="sxs-lookup"><span data-stu-id="97e50-280">hello template also generates standard .NET project files such as a .csproj file, app.config, packages.config, etc.</span></span>

<span data-ttu-id="97e50-281">hello resten av det här avsnittet beskrivs hello andra filer och deras kodstruktur och förklaras vad varje klass gör.</span><span class="sxs-lookup"><span data-stu-id="97e50-281">hello rest of this section describes hello different files and their code structure, and explains what each class does.</span></span>

![Visual Studio Solution Explorer visar hello uppgiften Processor mallen lösning][solution_explorer02]

<span data-ttu-id="97e50-283">**Framework-filer**</span><span class="sxs-lookup"><span data-stu-id="97e50-283">**Framework files**</span></span>

* <span data-ttu-id="97e50-284">`Configuration.cs`: Kapslar in hello inläsning av jobb konfigurationsdata som Batch-kontoinformation, länkade lagringskontouppgifter, projekt- och information och jobbparametrar.</span><span class="sxs-lookup"><span data-stu-id="97e50-284">`Configuration.cs`: Encapsulates hello loading of job configuration data such as Batch account details, linked storage account credentials, job and task information, and job parameters.</span></span> <span data-ttu-id="97e50-285">Det ger också tillgång tooBatch definierats miljövariabler (se miljöinställningar för aktiviteter i hello Batch dokumentationen) via hello Configuration.EnvironmentVariable klass.</span><span class="sxs-lookup"><span data-stu-id="97e50-285">It also provides access tooBatch-defined environment variables (see Environment settings for tasks, in hello Batch documentation) via hello Configuration.EnvironmentVariable class.</span></span>
* <span data-ttu-id="97e50-286">`IConfiguration.cs`: Sammanfattning Hej implementering av hello Configuration klass, så att du kan testa enheten ditt jobb delningslisten med hjälp av en förfalskad eller fingerad konfigurationsobjektet.</span><span class="sxs-lookup"><span data-stu-id="97e50-286">`IConfiguration.cs`: Abstracts hello implementation of hello Configuration class, so that you can unit test your job splitter using a fake or mock configuration object.</span></span>
* <span data-ttu-id="97e50-287">`TaskProcessorException.cs`: Representerar ett fel som kräver hello job manager tooterminate.</span><span class="sxs-lookup"><span data-stu-id="97e50-287">`TaskProcessorException.cs`: Represents an error that requires hello job manager tooterminate.</span></span> <span data-ttu-id="97e50-288">TaskProcessorException är används toowrap 'förväntades' fel där specifika diagnostisk information kan anges som en del av avslutning.</span><span class="sxs-lookup"><span data-stu-id="97e50-288">TaskProcessorException is used toowrap 'expected' errors where specific diagnostic information can be provided as part of termination.</span></span>

<span data-ttu-id="97e50-289">**Uppgiften-Processor**</span><span class="sxs-lookup"><span data-stu-id="97e50-289">**Task Processor**</span></span>

* <span data-ttu-id="97e50-290">`TaskProcessor.cs`: Kör hello aktiviteten.</span><span class="sxs-lookup"><span data-stu-id="97e50-290">`TaskProcessor.cs`: Runs hello task.</span></span> <span data-ttu-id="97e50-291">hello framework anropar hello TaskProcessor.Run metod.</span><span class="sxs-lookup"><span data-stu-id="97e50-291">hello framework invokes hello TaskProcessor.Run method.</span></span> <span data-ttu-id="97e50-292">Detta är hello klassen där du matar in hello programspecifika logiken för uppgiften.</span><span class="sxs-lookup"><span data-stu-id="97e50-292">This is hello class where you will inject hello application-specific logic of your task.</span></span> <span data-ttu-id="97e50-293">Implementera hello Kör metod för att:</span><span class="sxs-lookup"><span data-stu-id="97e50-293">Implement hello Run method to:</span></span>
  * <span data-ttu-id="97e50-294">Analysera och kontrollera eventuella parametrar för aktiviteten</span><span class="sxs-lookup"><span data-stu-id="97e50-294">Parse and validate any task parameters</span></span>
  * <span data-ttu-id="97e50-295">Skapa hello kommandoraden för alla externa program du vill tooinvoke</span><span class="sxs-lookup"><span data-stu-id="97e50-295">Compose hello command line for any external program you want tooinvoke</span></span>
  * <span data-ttu-id="97e50-296">Logga alla diagnostisk information som du kan behöva för felsökning</span><span class="sxs-lookup"><span data-stu-id="97e50-296">Log any diagnostic information you may require for debugging purposes</span></span>
  * <span data-ttu-id="97e50-297">Starta en process som kommandoraden</span><span class="sxs-lookup"><span data-stu-id="97e50-297">Start a process using that command line</span></span>
  * <span data-ttu-id="97e50-298">Vänta tills hello processen tooexit</span><span class="sxs-lookup"><span data-stu-id="97e50-298">Wait for hello process tooexit</span></span>
  * <span data-ttu-id="97e50-299">Avbilda hello avslutningskoden hello processen toodetermine om den har lyckats eller misslyckats</span><span class="sxs-lookup"><span data-stu-id="97e50-299">Capture hello exit code of hello process toodetermine if it succeeded or failed</span></span>
  * <span data-ttu-id="97e50-300">Spara alla utdatafiler som du vill tookeep toopersistent lagring</span><span class="sxs-lookup"><span data-stu-id="97e50-300">Save any output files you want tookeep toopersistent storage</span></span>

<span data-ttu-id="97e50-301">**Standard projektfiler för .NET-kommandorad**</span><span class="sxs-lookup"><span data-stu-id="97e50-301">**Standard .NET command line project files**</span></span>

* <span data-ttu-id="97e50-302">`App.config`: Standard .NET-programkonfigurationsfilen.</span><span class="sxs-lookup"><span data-stu-id="97e50-302">`App.config`: Standard .NET application configuration file.</span></span>
* <span data-ttu-id="97e50-303">`Packages.config`: Standard NuGet-paketet beroende fil.</span><span class="sxs-lookup"><span data-stu-id="97e50-303">`Packages.config`: Standard NuGet package dependency file.</span></span>
* <span data-ttu-id="97e50-304">`Program.cs`: Innehåller hello startpunkt för programmet och översta undantagshantering.</span><span class="sxs-lookup"><span data-stu-id="97e50-304">`Program.cs`: Contains hello program entry point and top-level exception handling.</span></span>

## <a name="implementing-hello-task-processor"></a><span data-ttu-id="97e50-305">Implementera hello uppgiften processor</span><span class="sxs-lookup"><span data-stu-id="97e50-305">Implementing hello task processor</span></span>
<span data-ttu-id="97e50-306">När du öppnar hello uppgiften Processor mallprojekt har hello projektet hello TaskProcessor.cs filen öppnas som standard.</span><span class="sxs-lookup"><span data-stu-id="97e50-306">When you open hello Task Processor template project, hello project will have hello TaskProcessor.cs file open by default.</span></span> <span data-ttu-id="97e50-307">Du kan implementera hello kör logik för hello aktiviteter i din arbetsbelastning med metoden hello Run() visas nedan:</span><span class="sxs-lookup"><span data-stu-id="97e50-307">You can implement hello run logic for hello tasks in your workload by using hello Run() method shown below:</span></span>

```csharp
/// <summary>
/// Runs hello task processing logic. This is where you inject
/// your application-specific logic for decomposing hello job into tasks.
///
/// hello task processor framework invokes hello Run method for you; you need
/// only tooimplement it, not toocall it yourself. Typically, your
/// implementation will execute an external program (from resource files or
/// an application package), check hello exit code of that program and
/// save output files toopersistent storage.
/// </summary>
public async Task<int> Run()

{
    try
    {
        //Your code for hello task processor goes here.
        var command = $"compare {_parameters["Frame1"]} {_parameters["Frame2"]} compare.gif";
        using (var process = Process.Start($"cmd /c {command}"))
        {
            process.WaitForExit();
            var taskOutputStorage = new TaskOutputStorage(
            _configuration.StorageAccount,
            _configuration.JobId,
            _configuration.TaskId
            );
            await taskOutputStorage.SaveAsync(
            TaskOutputKind.TaskOutput,
            @"..\stdout.txt",
            @"stdout.txt"
            );
            return process.ExitCode;
        }
    }
    catch (Exception ex)
    {
        throw new TaskProcessorException(
        $"{ex.GetType().Name} exception in run task processor: {ex.Message}",
        ex
        );
    }
}
```
> [!NOTE]
> <span data-ttu-id="97e50-308">hello är kommenterade avsnitt i hello Run()-metoden hello endast avsnitt i hello uppgiften Processor mall-koden som är avsedd för du toomodify genom att lägga till hello kör logik för hello aktiviteter i din arbetsbelastning.</span><span class="sxs-lookup"><span data-stu-id="97e50-308">hello annotated section in hello Run() method is hello only section of hello Task Processor template code that is intended for you toomodify by adding hello run logic for hello tasks in your workload.</span></span> <span data-ttu-id="97e50-309">Om du vill toomodify ett annat avsnitt i hello mall måste du först bekanta dig med hur Batch fungerar genom att granska hello Batch dokumentation och testar några av hello Batch-kodexempel.</span><span class="sxs-lookup"><span data-stu-id="97e50-309">If you want toomodify a different section of hello template, please first familiarize yourself with how Batch works by reviewing hello Batch documentation and trying out a few of hello Batch code samples.</span></span>
> 
> 

<span data-ttu-id="97e50-310">hello Run() metoden ansvarar för att starta hello kommandoraden, starta en eller flera processer, väntar på att alla processen toocomplete, spara hello resultat och slutligen returneras med slutkoden.</span><span class="sxs-lookup"><span data-stu-id="97e50-310">hello Run() method is responsible for launching hello command line, starting one or more processes, waiting for all process toocomplete, saving hello results, and finally returning with an exit code.</span></span> <span data-ttu-id="97e50-311">hello Run()-metoden är där du implementera hello bearbetning av logik för aktiviteter.</span><span class="sxs-lookup"><span data-stu-id="97e50-311">hello Run() method is where you implement hello processing logic for your tasks.</span></span> <span data-ttu-id="97e50-312">hello uppgiften processor framework anropar hello Run()-metoden. Du behöver inte toocall den själv.</span><span class="sxs-lookup"><span data-stu-id="97e50-312">hello task processor framework invokes hello Run() method for you; you do not need toocall it yourself.</span></span>

<span data-ttu-id="97e50-313">Implementeringen Run() har åtkomst till:</span><span class="sxs-lookup"><span data-stu-id="97e50-313">Your Run() implementation has access to:</span></span>

* <span data-ttu-id="97e50-314">Hej uppgiftsparametrar via hello `_parameters` fältet.</span><span class="sxs-lookup"><span data-stu-id="97e50-314">hello task parameters, via hello `_parameters` field.</span></span>
* <span data-ttu-id="97e50-315">Hej projekt- och ID: n via hello `_jobId` och `_taskId` fält.</span><span class="sxs-lookup"><span data-stu-id="97e50-315">hello job and task ids, via hello `_jobId` and `_taskId` fields.</span></span>
* <span data-ttu-id="97e50-316">Hej uppgiftskonfigurationen via hello `_configuration` fältet.</span><span class="sxs-lookup"><span data-stu-id="97e50-316">hello task configuration, via hello `_configuration` field.</span></span>

<span data-ttu-id="97e50-317">**Aktivitet, fel**</span><span class="sxs-lookup"><span data-stu-id="97e50-317">**Task failure**</span></span>

<span data-ttu-id="97e50-318">Du kan avsluta hello Run()-metoden genom att ett undantag om fel uppstår, men detta lämnar hello översta nivå undantagshanterare kontrollen över hello sluttid för aktiviteten.</span><span class="sxs-lookup"><span data-stu-id="97e50-318">In case of failure, you can exit hello Run() method by throwing an exception, but this leaves hello top level exception handler in control of hello task exit code.</span></span> <span data-ttu-id="97e50-319">Om du behöver toocontrol hello slutkoden så att du kan skilja mellan olika typer av fel, till exempel för att ställa diagnoser eller eftersom vissa feltillstånd bör avsluta hello jobb och andra bör inte sedan ska du avsluta hello Run() metoden genom att returnera en slutkoden noll.</span><span class="sxs-lookup"><span data-stu-id="97e50-319">If you need toocontrol hello exit code so that you can distinguish different types of failure, for example for diagnostic purposes or because some failure modes should terminate hello job and others should not, then you should exit hello Run() method by returning a non-zero exit code.</span></span> <span data-ttu-id="97e50-320">Detta blir hello sluttid för aktiviteten.</span><span class="sxs-lookup"><span data-stu-id="97e50-320">This becomes hello task exit code.</span></span>

### <a name="exit-codes-and-exceptions-in-hello-task-processor-template"></a><span data-ttu-id="97e50-321">Avsluta koder och undantag i hello uppgiften Processor mall</span><span class="sxs-lookup"><span data-stu-id="97e50-321">Exit codes and exceptions in hello Task Processor template</span></span>
<span data-ttu-id="97e50-322">Slutkoder och undantag tillhandahåller en mekanism toodetermine hello resultatet av att köra ett program och de kan hjälpa dig identifiera eventuella problem med hello hello program ska köras.</span><span class="sxs-lookup"><span data-stu-id="97e50-322">Exit codes and exceptions provide a mechanism toodetermine hello outcome of running a program, and they can help identify any problems with hello execution of hello program.</span></span> <span data-ttu-id="97e50-323">hello uppgiften Processor mallen implementerar hello slutkoder och undantag som beskrivs i det här avsnittet.</span><span class="sxs-lookup"><span data-stu-id="97e50-323">hello Task Processor template implements hello exit codes and exceptions described in this section.</span></span>

<span data-ttu-id="97e50-324">En uppgift processor uppgift som implementeras med hello uppgiften Processor mall kan returnera tre möjliga slutkoder:</span><span class="sxs-lookup"><span data-stu-id="97e50-324">A task processor task that is implemented with hello Task Processor template can return three possible exit codes:</span></span>

| <span data-ttu-id="97e50-325">Kod</span><span class="sxs-lookup"><span data-stu-id="97e50-325">Code</span></span> | <span data-ttu-id="97e50-326">Beskrivning</span><span class="sxs-lookup"><span data-stu-id="97e50-326">Description</span></span> |
| --- | --- |
| <span data-ttu-id="97e50-327">[Process.ExitCode][process_exitcode]</span><span class="sxs-lookup"><span data-stu-id="97e50-327">[Process.ExitCode][process_exitcode]</span></span> |<span data-ttu-id="97e50-328">hello uppgiften processor körde toocompletion.</span><span class="sxs-lookup"><span data-stu-id="97e50-328">hello task processor ran toocompletion.</span></span> <span data-ttu-id="97e50-329">Observera att detta inte innebär programmet hello du anropade lyckades – endast hello uppgiftsprocessorn anropa den och utföra eventuell efter bearbetning utan undantag.</span><span class="sxs-lookup"><span data-stu-id="97e50-329">Note that this does not imply that hello program you invoked was successful – only that hello task processor invoked it successfully and performed any post-processing without exceptions.</span></span> <span data-ttu-id="97e50-330">hello innebörden av hello slutkoden beror på programmet hello anropas – normalt slutkoden 0 betyder hello program har slutförts och andra slutkoden hello programmet misslyckades.</span><span class="sxs-lookup"><span data-stu-id="97e50-330">hello meaning of hello exit code depends on hello invoked program – typically exit code 0 means hello program succeeded and any other exit code means hello program failed.</span></span> |
| <span data-ttu-id="97e50-331">1</span><span class="sxs-lookup"><span data-stu-id="97e50-331">1</span></span> |<span data-ttu-id="97e50-332">hello uppgiften processor misslyckades med ett undantag i en '' del av programmet hello.</span><span class="sxs-lookup"><span data-stu-id="97e50-332">hello task processor failed with an exception in an 'expected' part of hello program.</span></span> <span data-ttu-id="97e50-333">hello undantaget var översatta tooa `TaskProcessorException` med diagnostisk information och, om möjligt hello förslag för att lösa felet.</span><span class="sxs-lookup"><span data-stu-id="97e50-333">hello exception was translated tooa `TaskProcessorException` with diagnostic information and, where possible, suggestions for resolving hello failure.</span></span> |
| <span data-ttu-id="97e50-334">2</span><span class="sxs-lookup"><span data-stu-id="97e50-334">2</span></span> |<span data-ttu-id="97e50-335">hello uppgiften processor misslyckades med ett 'oväntat-undantag.</span><span class="sxs-lookup"><span data-stu-id="97e50-335">hello task processor failed with an 'unexpected' exception.</span></span> <span data-ttu-id="97e50-336">hello undantaget var loggade toostandard utdata, men hello uppgiften processor var tooadd eventuell ytterligare information för diagnostik eller reparation.</span><span class="sxs-lookup"><span data-stu-id="97e50-336">hello exception was logged toostandard output, but hello task processor was unable tooadd any additional diagnostic or remediation information.</span></span> |

> [!NOTE]
> <span data-ttu-id="97e50-337">Om hello du anropa används avsluta koder 1 och 2 tooindicate specifika felet lägen, är sedan använda slutkoder 1 och 2 för aktiviteten processor fel tvetydig.</span><span class="sxs-lookup"><span data-stu-id="97e50-337">If hello program you invoke uses exit codes 1 and 2 tooindicate specific failure modes, then using exit codes 1 and 2 for task processor errors is ambiguous.</span></span> <span data-ttu-id="97e50-338">Du kan ändra dessa uppgiften processor koder toodistinctive avsluta felkoder genom att redigera hello undantag fall i hello Program.cs-filen.</span><span class="sxs-lookup"><span data-stu-id="97e50-338">You can change these task processor error codes toodistinctive exit codes by editing hello exception cases in hello Program.cs file.</span></span>
> 
> 

<span data-ttu-id="97e50-339">Alla hello information som returnerades av undantag skrivs i stdout.txt och stderr.txt-filer.</span><span class="sxs-lookup"><span data-stu-id="97e50-339">All hello information returned by exceptions is written into stdout.txt and stderr.txt files.</span></span> <span data-ttu-id="97e50-340">Mer information finns i felhantering, i hello Batch-dokumentationen.</span><span class="sxs-lookup"><span data-stu-id="97e50-340">For more information, see Error Handling, in hello Batch documentation.</span></span>

### <a name="client-considerations"></a><span data-ttu-id="97e50-341">Överväganden för klienten</span><span class="sxs-lookup"><span data-stu-id="97e50-341">Client considerations</span></span>
<span data-ttu-id="97e50-342">**Autentiseringsuppgifter för lagring**</span><span class="sxs-lookup"><span data-stu-id="97e50-342">**Storage credentials**</span></span>

<span data-ttu-id="97e50-343">Om aktiviteten processorn använder Azure blob storage toopersist utdata, till exempel använda hello filen konventioner hjälpbibliotek, så den behöver åtkomst för*antingen* hello molnet lagringskontouppgifter *eller* en blob-behållaren URL som innehåller en signatur för delad åtkomst (SAS).</span><span class="sxs-lookup"><span data-stu-id="97e50-343">If your task processor uses Azure blob storage toopersist outputs, for example using hello file conventions helper library, then it needs access too*either* hello cloud storage account credentials *or* a blob container URL that includes a shared access signature (SAS).</span></span> <span data-ttu-id="97e50-344">hello mallen innehåller stöd för att tillhandahålla autentiseringsuppgifter via vanliga miljövariabler.</span><span class="sxs-lookup"><span data-stu-id="97e50-344">hello template includes support for providing credentials via common environment variables.</span></span> <span data-ttu-id="97e50-345">Klienten kan skicka hello lagring autentiseringsuppgifter på följande sätt:</span><span class="sxs-lookup"><span data-stu-id="97e50-345">Your client can pass hello storage credentials as follows:</span></span>

```csharp
job.CommonEnvironmentSettings = new [] {
    new EnvironmentSetting("LINKED_STORAGE_ACCOUNT", "{storageAccountName}"),
    new EnvironmentSetting("LINKED_STORAGE_KEY", "{storageAccountKey}"),
};
```

<span data-ttu-id="97e50-346">hello storage-konto är sedan tillgängliga i hello TaskProcessor klassen via hello `_configuration.StorageAccount` egenskapen.</span><span class="sxs-lookup"><span data-stu-id="97e50-346">hello storage account is then available in hello TaskProcessor class via hello `_configuration.StorageAccount` property.</span></span>

<span data-ttu-id="97e50-347">Om du vill toouse behållar-URL med SAS kan du kan också skicka detta via en gemensam miljöinställning jobb, men hello uppgiften processor mallen innehåller för närvarande inte inbyggt stöd för detta.</span><span class="sxs-lookup"><span data-stu-id="97e50-347">If you prefer toouse a container URL with SAS, you can also pass this via an job common environment setting, but hello task processor template does not currently include built-in support for this.</span></span>

<span data-ttu-id="97e50-348">**Lagringsinställningar**</span><span class="sxs-lookup"><span data-stu-id="97e50-348">**Storage setup**</span></span>

<span data-ttu-id="97e50-349">Du rekommenderas hello klient- eller manager uppgiften skapa behållare som krävs av uppgifter innan du lägger till hello uppgifter toohello jobb.</span><span class="sxs-lookup"><span data-stu-id="97e50-349">It is recommended that hello client or job manager task create any containers required by tasks before adding hello tasks toohello job.</span></span> <span data-ttu-id="97e50-350">Detta är obligatoriskt om du använder en behållar-URL med SAS som en URL inte innehåller behörighet toocreate hello behållare.</span><span class="sxs-lookup"><span data-stu-id="97e50-350">This is mandatory if you use a container URL with SAS, as such a URL does not include permission toocreate hello container.</span></span> <span data-ttu-id="97e50-351">Det rekommenderas även om du skickar lagringskontouppgifter, som sparas varje aktivitet med toocall CloudBlobContainer.CreateIfNotExistsAsync om hello behållare.</span><span class="sxs-lookup"><span data-stu-id="97e50-351">It is recommended even if you pass storage account credentials, as it saves every task having toocall CloudBlobContainer.CreateIfNotExistsAsync on hello container.</span></span>

## <a name="pass-parameters-and-environment-variables"></a><span data-ttu-id="97e50-352">Skicka parametrar och miljövariabler</span><span class="sxs-lookup"><span data-stu-id="97e50-352">Pass parameters and environment variables</span></span>
### <a name="pass-environment-settings"></a><span data-ttu-id="97e50-353">Skicka miljöinställningar</span><span class="sxs-lookup"><span data-stu-id="97e50-353">Pass environment settings</span></span>
<span data-ttu-id="97e50-354">En klient kan skicka information toohello projektaktivitet manager i hello form av inställningarna för miljön.</span><span class="sxs-lookup"><span data-stu-id="97e50-354">A client can pass information toohello job manager task in hello form of environment settings.</span></span> <span data-ttu-id="97e50-355">Den här informationen kan sedan användas av hello projektaktivitet manager när genererar hello aktivitet processor aktiviteter som körs som en del av hello compute jobb.</span><span class="sxs-lookup"><span data-stu-id="97e50-355">This information can then be used by hello job manager task when generating hello task processor tasks that will run as part of hello compute job.</span></span> <span data-ttu-id="97e50-356">Exempel på hello information som du kan överföra som miljöinställningarna är:</span><span class="sxs-lookup"><span data-stu-id="97e50-356">Examples of hello information that you can pass as environment settings are:</span></span>

* <span data-ttu-id="97e50-357">Namn och lagringskontonycklar</span><span class="sxs-lookup"><span data-stu-id="97e50-357">Storage account name and account keys</span></span>
* <span data-ttu-id="97e50-358">URL: en för batch-konto</span><span class="sxs-lookup"><span data-stu-id="97e50-358">Batch account URL</span></span>
* <span data-ttu-id="97e50-359">Batch-kontonyckel</span><span class="sxs-lookup"><span data-stu-id="97e50-359">Batch account key</span></span>

<span data-ttu-id="97e50-360">hello Batch-tjänsten har en enkel mekanism toopass miljö inställningar tooa manager projektaktivitet genom att använda hello `EnvironmentSettings` egenskap i [Microsoft.Azure.Batch.JobManagerTask][net_jobmanagertask].</span><span class="sxs-lookup"><span data-stu-id="97e50-360">hello Batch service has a simple mechanism toopass environment settings tooa job manager task by using hello `EnvironmentSettings` property in [Microsoft.Azure.Batch.JobManagerTask][net_jobmanagertask].</span></span>

<span data-ttu-id="97e50-361">Till exempel tooget hello `BatchClient` instans för Batch-kontot du skickar som miljövariabler från hello klient code hello URL och delade nyckel autentiseringsuppgifter för hello Batch-kontot.</span><span class="sxs-lookup"><span data-stu-id="97e50-361">For example, tooget hello `BatchClient` instance for a Batch account, you can pass as environment variables from hello client code hello URL and shared key credentials for hello Batch account.</span></span> <span data-ttu-id="97e50-362">På samma sätt tooaccess hello storage-konto som är länkade toohello Batch-kontot, kan du överföra hello lagringskontonamn och hello lagringskontonyckel som miljövariabler.</span><span class="sxs-lookup"><span data-stu-id="97e50-362">Likewise, tooaccess hello storage account that is linked toohello Batch account, you can pass hello storage account name and hello storage account key as environment variables.</span></span>

### <a name="pass-parameters-toohello-job-manager-template"></a><span data-ttu-id="97e50-363">Skicka parametrar toohello Job Manager-mall</span><span class="sxs-lookup"><span data-stu-id="97e50-363">Pass parameters toohello Job Manager template</span></span>
<span data-ttu-id="97e50-364">I många fall är det användbart toopass per projekt parametrar toohello manager projektaktivitet, antingen toocontrol hello jobbet dela process eller tooconfigure hello uppgifter för hello jobb.</span><span class="sxs-lookup"><span data-stu-id="97e50-364">In many cases, it's useful toopass per-job parameters toohello job manager task, either toocontrol hello job splitting process or tooconfigure hello tasks for hello job.</span></span> <span data-ttu-id="97e50-365">Du kan göra detta genom att ladda upp en JSON-fil med namnet parameters.json som en resurs för hello projektaktivitet manager.</span><span class="sxs-lookup"><span data-stu-id="97e50-365">You can do this by uploading a JSON file named parameters.json as a resource file for hello job manager task.</span></span> <span data-ttu-id="97e50-366">hello parametrar sedan kan bli tillgängliga i hello `JobSplitter._parameters` i hello Job Manager-mall.</span><span class="sxs-lookup"><span data-stu-id="97e50-366">hello parameters can then become available in hello `JobSplitter._parameters` field in hello Job Manager template.</span></span>

> [!NOTE]
> <span data-ttu-id="97e50-367">hello inbyggda parametern hanteraren stöder endast string-string ordlistor.</span><span class="sxs-lookup"><span data-stu-id="97e50-367">hello built-in parameter handler supports only string-to-string dictionaries.</span></span> <span data-ttu-id="97e50-368">Om du vill toopass komplexa JSON-värden som parametervärden du kommer behöver toopass dem som strängar och analysera dem i hello jobbet delningslisten eller ändra hello framework `Configuration.GetJobParameters` metod.</span><span class="sxs-lookup"><span data-stu-id="97e50-368">If you want toopass complex JSON values as parameter values, you will need toopass these as strings and parse them in hello job splitter, or modify hello framework's `Configuration.GetJobParameters` method.</span></span>
> 
> 

### <a name="pass-parameters-toohello-task-processor-template"></a><span data-ttu-id="97e50-369">Skicka parametrar toohello aktivitet Processor mall</span><span class="sxs-lookup"><span data-stu-id="97e50-369">Pass parameters toohello Task Processor template</span></span>
<span data-ttu-id="97e50-370">Du kan också skicka parametrar tooindividual uppgifter implementeras med hjälp av hello uppgiften Processor mallen.</span><span class="sxs-lookup"><span data-stu-id="97e50-370">You can also pass parameters tooindividual tasks implemented using hello Task Processor template.</span></span> <span data-ttu-id="97e50-371">Precis som med hello job manager-mall söker hello uppgiften processor mallen efter en resursfil med namnet</span><span class="sxs-lookup"><span data-stu-id="97e50-371">Just as with hello job manager template, hello task processor template looks for a resource file named</span></span>

<span data-ttu-id="97e50-372">parameters.JSON och om att hitta den läser in den som hello parametrar ordlistan.</span><span class="sxs-lookup"><span data-stu-id="97e50-372">parameters.json, and if found it loads it as hello parameters dictionary.</span></span> <span data-ttu-id="97e50-373">Det finns ett par olika alternativ för hur toopass parametrar toohello uppgifter för processorn:</span><span class="sxs-lookup"><span data-stu-id="97e50-373">There are a couple of options for how toopass parameters toohello task processor tasks:</span></span>

* <span data-ttu-id="97e50-374">Återanvända hello jobbparametrar JSON.</span><span class="sxs-lookup"><span data-stu-id="97e50-374">Reuse hello job parameters JSON.</span></span> <span data-ttu-id="97e50-375">Detta fungerar bra om hello endast parametrar är jobbet hela (till exempel en render höjd och bredd).</span><span class="sxs-lookup"><span data-stu-id="97e50-375">This works well if hello only parameters are job-wide ones (for example, a render height and width).</span></span> <span data-ttu-id="97e50-376">toodo, när du skapar en CloudTask i hello jobbet delningslisten kan lägga till ett toohello parameters.json resurs filen referensobjekt från hello job manager aktivitetens ResourceFiles (`JobSplitter._jobManagerTask.ResourceFiles`) toohello CloudTask ResourceFiles samling.</span><span class="sxs-lookup"><span data-stu-id="97e50-376">toodo this, when creating a CloudTask in hello job splitter, add a reference toohello parameters.json resource file object from hello job manager task's ResourceFiles (`JobSplitter._jobManagerTask.ResourceFiles`) toohello CloudTask's ResourceFiles collection.</span></span>
* <span data-ttu-id="97e50-377">Generera och överför en uppgiftsspecifika parameters.json dokument som en del av delningslisten jobbkörningen och referera till blobben i hello uppgiften resource files samlingen.</span><span class="sxs-lookup"><span data-stu-id="97e50-377">Generate and upload a task-specific parameters.json document as part of job splitter execution, and reference that blob in hello task's resource files collection.</span></span> <span data-ttu-id="97e50-378">Detta är nödvändigt om olika aktiviteter har olika parametrar.</span><span class="sxs-lookup"><span data-stu-id="97e50-378">This is necessary if different tasks have different parameters.</span></span> <span data-ttu-id="97e50-379">Ett exempel kan vara ett 3D-rendering scenario där hello ram index skickas toohello aktiviteten som en parameter.</span><span class="sxs-lookup"><span data-stu-id="97e50-379">An example might be a 3D rendering scenario where hello frame index is passed toohello task as a parameter.</span></span>

> [!NOTE]
> <span data-ttu-id="97e50-380">hello inbyggda parametern hanteraren stöder endast string-string ordlistor.</span><span class="sxs-lookup"><span data-stu-id="97e50-380">hello built-in parameter handler supports only string-to-string dictionaries.</span></span> <span data-ttu-id="97e50-381">Om du vill toopass komplexa JSON-värden som parametervärden du kommer behöver toopass dem som strängar och analysera dem i hello uppgiften processor eller ändra hello framework `Configuration.GetTaskParameters` metod.</span><span class="sxs-lookup"><span data-stu-id="97e50-381">If you want toopass complex JSON values as parameter values, you will need toopass these as strings and parse them in hello task processor, or modify hello framework's `Configuration.GetTaskParameters` method.</span></span>
> 
> 

## <a name="next-steps"></a><span data-ttu-id="97e50-382">Nästa steg</span><span class="sxs-lookup"><span data-stu-id="97e50-382">Next steps</span></span>
### <a name="persist-job-and-task-output-tooazure-storage"></a><span data-ttu-id="97e50-383">Spara jobbet och uppgift utdata tooAzure lagring</span><span class="sxs-lookup"><span data-stu-id="97e50-383">Persist job and task output tooAzure Storage</span></span>
<span data-ttu-id="97e50-384">Ett annat bra verktyg i utvecklingen av Batch-lösningar är [Azure Batch filen konventioner][nuget_package].</span><span class="sxs-lookup"><span data-stu-id="97e50-384">Another helpful tool in Batch solution development is [Azure Batch File Conventions][nuget_package].</span></span> <span data-ttu-id="97e50-385">Använd denna .NET-klassbiblioteket (för närvarande under förhandsgranskning) i din Batch .NET program tooeasily store och hämta uppgift utdata tooand från Azure Storage.</span><span class="sxs-lookup"><span data-stu-id="97e50-385">Use this .NET class library (currently in preview) in your Batch .NET applications tooeasily store and retrieve task outputs tooand from Azure Storage.</span></span> <span data-ttu-id="97e50-386">[Spara Azure Batch-jobb- och utdata](batch-task-output.md) innehåller en fullständig beskrivning av hello bibliotek och dess användning.</span><span class="sxs-lookup"><span data-stu-id="97e50-386">[Persist Azure Batch job and task output](batch-task-output.md) contains a full discussion of hello library and its usage.</span></span>

### <a name="batch-forum"></a><span data-ttu-id="97e50-387">Batch-Forum</span><span class="sxs-lookup"><span data-stu-id="97e50-387">Batch Forum</span></span>
<span data-ttu-id="97e50-388">Hej [Azure Batch-Forum] [ forum] är utmärkt placera toodiscuss Batch och ställa frågor om hello-tjänsten på MSDN.</span><span class="sxs-lookup"><span data-stu-id="97e50-388">hello [Azure Batch Forum][forum] on MSDN is a great place toodiscuss Batch and ask questions about hello service.</span></span> <span data-ttu-id="97e50-389">HEAD på över för användbara ”Fäst” inlägg och publicera dina frågor när de uppstår när du skapar Batch-lösningar.</span><span class="sxs-lookup"><span data-stu-id="97e50-389">Head on over for helpful "sticky" posts, and post your questions as they arise while you build your Batch solutions.</span></span>

[forum]: https://social.msdn.microsoft.com/forums/azure/en-US/home?forum=azurebatch
[net_jobmanagertask]: https://msdn.microsoft.com/library/azure/microsoft.azure.batch.jobmanagertask.aspx
[github_samples]: https://github.com/Azure/azure-batch-samples
[nuget_package]: https://www.nuget.org/packages/Microsoft.Azure.Batch.Conventions.Files
[process_exitcode]: https://msdn.microsoft.com/library/system.diagnostics.process.exitcode.aspx
[vs_gallery]: https://visualstudiogallery.msdn.microsoft.com/
[vs_gallery_templates]: https://go.microsoft.com/fwlink/?linkid=820714
[vs_find_use_ext]: https://msdn.microsoft.com/library/dd293638.aspx

[diagram01]: ./media/batch-visual-studio-templates/diagram01.png
[solution_explorer01]: ./media/batch-visual-studio-templates/solution_explorer01.png
[solution_explorer02]: ./media/batch-visual-studio-templates/solution_explorer02.png
