---
title: "ett jobb förloppet genom att räkna uppgifter efter status - Azure Batch aaaMonitor | Microsoft Docs"
description: "Övervaka hello ett jobb genom att anropa hello hämta uppgift räknar åtgärden toocount uppgifter för ett jobb. Du kan hämta ett antal aktiva, körs och slutförda uppgifter och aktiviteter som har lyckades eller misslyckades."
services: batch
author: tamram
manager: timlt
ms.service: batch
ms.topic: article
ms.date: 08/02/2017
ms.author: tamram
ms.openlocfilehash: 03957d8a3d678bf44587f3bc7f988a76885c2af0
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 10/06/2017
---
# <a name="count-tasks-by-state-toomonitor-a-jobs-progress-preview"></a><span data-ttu-id="daad3-104">Antal aktiviteter genom att tillståndet toomonitor jobbförloppet (förhandsgranskning)</span><span class="sxs-lookup"><span data-stu-id="daad3-104">Count tasks by state toomonitor a job's progress (Preview)</span></span>

<span data-ttu-id="daad3-105">Azure Batch tillhandahåller ett effektivt sätt toomonitor hello förloppet för ett jobb som körs tillhörande uppgifter.</span><span class="sxs-lookup"><span data-stu-id="daad3-105">Azure Batch provides an efficient way toomonitor hello progress of a job as it runs its tasks.</span></span> <span data-ttu-id="daad3-106">Du kan anropa hello [hämta uppgift räknar] [ rest_get_task_counts] åtgärden toofind ut hur många aktiviteter är i tillståndet active, körs, eller slutfördes och hur många har har lyckats eller misslyckats.</span><span class="sxs-lookup"><span data-stu-id="daad3-106">You can call hello [Get Task Counts][rest_get_task_counts] operation toofind out how many tasks are in an active, running, or completed state, and how many have succeeded or failed.</span></span> <span data-ttu-id="daad3-107">Genom att räkna hello antalet aktiviteter i varje du enklare visa hello jobbets förlopp tooa användaren eller oväntade fördröjningar eller fel som kan påverka hello jobb identifieras.</span><span class="sxs-lookup"><span data-stu-id="daad3-107">By counting hello number of tasks in each state, you can more easily display hello job's progress tooa user, or detect unexpected delays or failures that may affect hello job.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="daad3-108">hello hämta uppgift räknar åtgärden är för närvarande i förhandsvisning och finns inte ännu i Azure Government, Azure Kina och Azure Tyskland.</span><span class="sxs-lookup"><span data-stu-id="daad3-108">hello Get Task Counts operation is currently in preview, and is not yet available in Azure Government, Azure China, and Azure Germany.</span></span> 
>
>

## <a name="how-tasks-are-counted"></a><span data-ttu-id="daad3-109">Hur åtgärder ska räknas</span><span class="sxs-lookup"><span data-stu-id="daad3-109">How tasks are counted</span></span>

<span data-ttu-id="daad3-110">hello hämta uppgift räknar åtgärden räknar uppgifter efter tillstånd, enligt följande:</span><span class="sxs-lookup"><span data-stu-id="daad3-110">hello Get Task Counts operation counts tasks by state, as follows:</span></span>

- <span data-ttu-id="daad3-111">En uppgift räknas som **active** när den är i kö och kan toorun, men inte är tilldelad tooa compute-nod.</span><span class="sxs-lookup"><span data-stu-id="daad3-111">A task is counted as **active** when it is queued and able toorun, but is not currently assigned tooa compute node.</span></span> <span data-ttu-id="daad3-112">En uppgift också räknas som **active** om det är beroende av en överordnad aktivitet som inte har slutförts ännu.</span><span class="sxs-lookup"><span data-stu-id="daad3-112">A task is also counted as **active** if it is dependent on a parent task that has not yet completed.</span></span> <span data-ttu-id="daad3-113">Mer information om aktiviteten beroenden finns [och skapa aktiviteten beroenden toorun uppgifter som är beroende av andra aktiviteter](batch-task-dependencies.md).</span><span class="sxs-lookup"><span data-stu-id="daad3-113">For more information on task dependencies, see [Create task dependencies toorun tasks that depend on other tasks](batch-task-dependencies.md).</span></span> 
- <span data-ttu-id="daad3-114">En uppgift räknas som **kör** när den har tilldelats tooa compute-nod, men har inte slutförts ännu.</span><span class="sxs-lookup"><span data-stu-id="daad3-114">A task is counted as **running** when it has been assigned tooa compute node, but has not yet completed.</span></span> <span data-ttu-id="daad3-115">En uppgift räknas som **kör** när dess tillstånd är antingen `preparing` eller `running`, som anges av hello [hämta information om en aktivitet] [ rest_get_task] igen.</span><span class="sxs-lookup"><span data-stu-id="daad3-115">A task is counted as **running** when its state is either `preparing` or `running`, as indicated by hello [Get information about a task][rest_get_task] operation.</span></span>
- <span data-ttu-id="daad3-116">En uppgift räknas som **slutförts** när den inte längre är berättigad toorun.</span><span class="sxs-lookup"><span data-stu-id="daad3-116">A task is counted as **completed** when it is no longer eligible toorun.</span></span> <span data-ttu-id="daad3-117">En uppgift räknas som **slutförts** har vanligtvis antingen har slutförts, har slutförts utan fel eller också har uttömt gränsen för återförsök.</span><span class="sxs-lookup"><span data-stu-id="daad3-117">A task counted as **completed** has typically either finished successfully, or has finished unsuccessfully and has also exhausted its retry limit.</span></span> 

<span data-ttu-id="daad3-118">hello hämta uppgift räknar åtgärden rapporterar också hur många aktiviteter har har lyckats eller misslyckats.</span><span class="sxs-lookup"><span data-stu-id="daad3-118">hello Get Task Counts operation also reports how many tasks have succeeded or failed.</span></span> <span data-ttu-id="daad3-119">Batch avgör om en aktivitet har lyckats eller misslyckats genom att kontrollera hello **resultatet** -egenskapen för hello [executionInfo] [https://docs.microsoft.com/rest/api/batchservice/get-information-about-a-task#executionInfo] egenskap:</span><span class="sxs-lookup"><span data-stu-id="daad3-119">Batch determines whether a task has succeeded or failed by checking hello **result** property of hello [executionInfo][https://docs.microsoft.com/rest/api/batchservice/get-information-about-a-task#executionInfo] property:</span></span>

    - <span data-ttu-id="daad3-120">En uppgift räknas som **lyckades** om hello resultatet för körning av aktiviteten är `success`.</span><span class="sxs-lookup"><span data-stu-id="daad3-120">A task is counted as **succeeded** if hello result of task execution is `success`.</span></span>
    - <span data-ttu-id="daad3-121">En uppgift räknas som **misslyckades** om hello resultatet för körning av aktiviteten är `failure`.</span><span class="sxs-lookup"><span data-stu-id="daad3-121">A task is counted as **failed** if hello result of task execution is `failure`.</span></span>

<span data-ttu-id="daad3-122">Mer information om uppgiften tillstånd finns [hämta information om en aktivitet][rest_get_task].</span><span class="sxs-lookup"><span data-stu-id="daad3-122">For more information about task states, see [Get information about a task][rest_get_task].</span></span>

<span data-ttu-id="daad3-123">hello visar följande .NET-kodexempel hur tooretrieve aktivitet räknar efter tillstånd:</span><span class="sxs-lookup"><span data-stu-id="daad3-123">hello following .NET code sample shows how tooretrieve task counts by state:</span></span> 

```csharp
var taskCounts = await batchClient.JobOperations.GetTaskCountsAsync("job-1");

Console.WriteLine("Task count in active state: {0}", taskCounts.Active);
Console.WriteLine("Task count in preparing or running state: {0}", taskCounts.Running);
Console.WriteLine("Task count in completed state: {0}", taskCounts.Completed);
Console.WriteLine("Succeeded task count: {0}", taskCounts.Succeeded);
Console.WriteLine("Failed task count: {0}", taskCounts.Failed);
Console.WriteLine("ValidationStatus: {0}", taskCounts.ValidationStatus);
```

> [!NOTE]
> <span data-ttu-id="daad3-124">Du kan använda ett liknande mönster för REST och andra språk som stöds tooget aktivitet räknar för ett jobb.</span><span class="sxs-lookup"><span data-stu-id="daad3-124">You can use a similar pattern for REST and other supported languages tooget task counts for a job.</span></span> 
> 
> 

## <a name="consistency-checking-for-task-counts"></a><span data-ttu-id="daad3-125">Konsekvenskontrollen för aktiviteten antal</span><span class="sxs-lookup"><span data-stu-id="daad3-125">Consistency checking for task counts</span></span>

<span data-ttu-id="daad3-126">hello Batch-tjänsten aggregerar antal aktiviteten genom att samla in data från flera delar av en asynkron distribuerade system.</span><span class="sxs-lookup"><span data-stu-id="daad3-126">hello Batch service aggregates task counts by gathering data from multiple parts of an asynchronous distributed system.</span></span> <span data-ttu-id="daad3-127">tooensure som uppgift antal är korrekta Batch tillhandahåller ytterligare verifiering för tillstånd antal genom att utföra konsekvenskontroller mot flera komponenter av hello system.</span><span class="sxs-lookup"><span data-stu-id="daad3-127">tooensure that task counts are correct, Batch provides additional validation for state counts by performing consistency checks against multiple components of hello system.</span></span> <span data-ttu-id="daad3-128">Batch utför dessa konsekvenskontroller så länge det finns färre än 200 000 uppgifter i hello-jobbet.</span><span class="sxs-lookup"><span data-stu-id="daad3-128">Batch performs these consistency checks as long as there are fewer than 200,000 tasks in hello job.</span></span> <span data-ttu-id="daad3-129">Hello osannolika att hello konsekvenskontroll hittar fel, korrigerar Batch hello resultatet av hello hämta uppgifter räknar utifrån hello resultat av hello konsekvenskontroll.</span><span class="sxs-lookup"><span data-stu-id="daad3-129">In hello unlikely event that hello consistency check finds errors, Batch corrects hello result of hello Get Tasks Counts operation based on hello results of hello consistency check.</span></span> <span data-ttu-id="daad3-130">hello är konsekvenskontroll en extra mått tooensure som kunder som förlitar sig på hello hämta uppgift räknar åtgärden hämta hello rätt information de behöver för lösningen.</span><span class="sxs-lookup"><span data-stu-id="daad3-130">hello consistency check is an extra measure tooensure that customers who rely on hello Get Task Counts operation get hello right information they need for their solution.</span></span>

<span data-ttu-id="daad3-131">Hej **validationStatus** egenskapen hello svar anger om Batch har utfört hello konsekvenskontroll.</span><span class="sxs-lookup"><span data-stu-id="daad3-131">hello **validationStatus** property in hello response indicates whether Batch has performed hello consistency check.</span></span> <span data-ttu-id="daad3-132">Om inte Batch har kan toocheck tillstånd antal mot hello faktiska tillstånd lagras i hello system sedan hello **validationStatus** egenskapen för`unvalidated`.</span><span class="sxs-lookup"><span data-stu-id="daad3-132">If Batch has not been able toocheck state counts against hello actual states held in hello system, then hello **validationStatus** property is set too`unvalidated`.</span></span> <span data-ttu-id="daad3-133">Av prestandaskäl Batch kommer inte att utföra hello konsekvenskontroll om hello jobbet innehåller mer än 200 000 uppgifter, så hello **validationStatus** egenskapen kan anges för`unvalidated` i det här fallet.</span><span class="sxs-lookup"><span data-stu-id="daad3-133">For performance reasons, Batch will not perform hello consistency check if hello job includes more than 200,000 tasks, so hello **validationStatus** property may be set too`unvalidated` in this case.</span></span> <span data-ttu-id="daad3-134">Antal för hello aktivitet är dock inte nödvändigtvis fel i det här fallet även en mycket begränsad dataförlust är högst osannolikt.</span><span class="sxs-lookup"><span data-stu-id="daad3-134">However, hello task count is not necessarily wrong in this case, as even a very limited data loss is highly unlikely.</span></span> 

<span data-ttu-id="daad3-135">När status ändras i en aktivitet bearbetar hello aggregering pipeline hello ändra inom några sekunder.</span><span class="sxs-lookup"><span data-stu-id="daad3-135">When a task changes state, hello aggregation pipeline processes hello change within few seconds.</span></span> <span data-ttu-id="daad3-136">hello hämta uppgift räknar åtgärden visar hello uppdateras uppgiften antal inom denna period.</span><span class="sxs-lookup"><span data-stu-id="daad3-136">hello Get Task Counts operation reflects hello updated task counts within that period.</span></span> <span data-ttu-id="daad3-137">Men om hello aggregering pipeline missar en ändring i en aktivitet tillstånd, sedan ändring inte är registrerad tills hello nästa validering pass.</span><span class="sxs-lookup"><span data-stu-id="daad3-137">However, if hello aggregation pipeline misses a change in a task state, then that change is not registered until hello next validation pass.</span></span> <span data-ttu-id="daad3-138">Uppgiften antal kan vara något fel på grund av toohello missade händelse under denna tid, men de korrigerade på hello nästa validering pass.</span><span class="sxs-lookup"><span data-stu-id="daad3-138">During this time, task counts may be slightly inaccurate due toohello missed event, but they are corrected on hello next validation pass.</span></span>

## <a name="best-practices-for-counting-a-jobs-tasks"></a><span data-ttu-id="daad3-139">Metodtips för inventering uppgifter för ett jobb</span><span class="sxs-lookup"><span data-stu-id="daad3-139">Best practices for counting a job's tasks</span></span>

<span data-ttu-id="daad3-140">Anropar hello hämta uppgift räknar åtgärden är hello mest effektiva sättet tooreturn grundläggande antalet aktiviteter i ett jobb av tillstånd.</span><span class="sxs-lookup"><span data-stu-id="daad3-140">Calling hello Get Task Counts operation is hello most efficient way tooreturn a basic count of a job's tasks by state.</span></span> <span data-ttu-id="daad3-141">Om du använder Batch-tjänstversion 2017-06-01.5.1, rekommenderar vi skrivning eller uppdatera din kod toouse hämta uppgift räknar.</span><span class="sxs-lookup"><span data-stu-id="daad3-141">If you are using Batch service version 2017-06-01.5.1, we recommend writing or updating your code toouse Get Task Counts.</span></span>

<span data-ttu-id="daad3-142">hello hämta uppgift räknar åtgärden är inte tillgänglig i Batch-tjänsten-versioner tidigare än 2017-06-01.5.1.</span><span class="sxs-lookup"><span data-stu-id="daad3-142">hello Get Task Counts operation is not available in Batch service versions earlier than 2017-06-01.5.1.</span></span> <span data-ttu-id="daad3-143">Om du använder en äldre version av hello-tjänsten sedan använda en lista över frågan toocount aktiviteter i ett jobb i stället.</span><span class="sxs-lookup"><span data-stu-id="daad3-143">If you are using an older version of hello service, then use a list query toocount tasks in a job instead.</span></span> <span data-ttu-id="daad3-144">Mer information finns i [skapa frågor toolist Batch resurser effektivt](batch-efficient-list-queries.md).</span><span class="sxs-lookup"><span data-stu-id="daad3-144">For more information, see [Create queries toolist Batch resources efficiently](batch-efficient-list-queries.md).</span></span>

## <a name="next-steps"></a><span data-ttu-id="daad3-145">Nästa steg</span><span class="sxs-lookup"><span data-stu-id="daad3-145">Next steps</span></span>

* <span data-ttu-id="daad3-146">Se hello [Batch funktionsöversikt](batch-api-basics.md) toolearn mer om Batch-koncept och funktioner.</span><span class="sxs-lookup"><span data-stu-id="daad3-146">See hello [Batch feature overview](batch-api-basics.md) toolearn more about Batch service concepts and features.</span></span> <span data-ttu-id="daad3-147">hello artikeln beskriver hello primära Batch resurser, till exempel pooler, compute-noder, jobb och uppgifter och ger en översikt över hello tjänstens funktioner.</span><span class="sxs-lookup"><span data-stu-id="daad3-147">hello article discusses hello primary Batch resources such as pools, compute nodes, jobs, and tasks, and provides an overview of hello service's features.</span></span>
* <span data-ttu-id="daad3-148">Hello grundläggande information om hur utvecklingen av ett Batch-aktiverade program som använder hello [Batch .NET-klientbibliotek](batch-dotnet-get-started.md) eller [Python](batch-python-tutorial.md).</span><span class="sxs-lookup"><span data-stu-id="daad3-148">Learn hello basics of developing a Batch-enabled application using hello [Batch .NET client library](batch-dotnet-get-started.md) or [Python](batch-python-tutorial.md).</span></span> <span data-ttu-id="daad3-149">De här inledande artiklarna leder dig igenom ett fungerande program som använder hello Batch-tjänsten tooexecute en arbetsbelastning på flera compute-noder.</span><span class="sxs-lookup"><span data-stu-id="daad3-149">These introductory articles guide you through a working application that uses hello Batch service tooexecute a workload on multiple compute nodes.</span></span>


[rest_get_task_counts]: https://docs.microsoft.com/rest/api/batchservice/get-the-task-counts-for-a-job
[rest_get_task]: https://docs.microsoft.com/rest/api/batchservice/get-information-about-a-task
[rest_list_tasks]: https://docs.microsoft.com/rest/api/batchservice/list-the-tasks-associated-with-a-job
