---
title: "aaaProfiling live webbappar på Azure med Application Insights | Microsoft Docs"
description: "Identifiera hello varm sökväg i koden web server med en låg storleken profiler."
services: application-insights
documentationcenter: 
author: CFreemanwa
manager: carmonm
ms.service: application-insights
ms.workload: tbd
ms.tgt_pltfrm: ibiza
ms.devlang: na
ms.topic: article
ms.date: 05/04/2017
ms.author: bwren
ms.openlocfilehash: 3c7f21076f19335e0f006327932e13623ec9526b
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 10/06/2017
---
# <a name="profiling-live-azure-web-apps-with-application-insights"></a><span data-ttu-id="b7d2a-103">Profilering live Azure-webbappar med Application Insights</span><span class="sxs-lookup"><span data-stu-id="b7d2a-103">Profiling live Azure web apps with Application Insights</span></span>

<span data-ttu-id="b7d2a-104">*Den här funktionen av Application Insights är GA för Apptjänster och förhandsgranskning för beräkning.*</span><span class="sxs-lookup"><span data-stu-id="b7d2a-104">*This feature of Application Insights is GA for App Services and in preview for Compute.*</span></span>

<span data-ttu-id="b7d2a-105">Ta reda på hur mycket tid läggs varje metod i webbprogrammet live med hjälp av hello profilering verktyg [Azure Application Insights](app-insights-overview.md).</span><span class="sxs-lookup"><span data-stu-id="b7d2a-105">Find out how much time is spent in each method in your live web application by using hello profiling tool of [Azure Application Insights](app-insights-overview.md).</span></span> <span data-ttu-id="b7d2a-106">Den visas detaljerad profiler för live-frågor som har hanteras av din app och markeras hello 'varm path' som använder hello de flesta tid.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-106">It shows you detailed profiles of live requests that were served by your app, and highlights hello 'hot path' that is using hello most time.</span></span> <span data-ttu-id="b7d2a-107">Väljs automatiskt exempel som har olika svarstider.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-107">It automatically selects examples that have different response times.</span></span> <span data-ttu-id="b7d2a-108">hello-profiler använder olika tekniker toominimize kostnader.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-108">hello profiler uses various techniques toominimize overhead.</span></span>

<span data-ttu-id="b7d2a-109">hello profiler för närvarande fungerar för ASP.NET webb-appar som körs på Azure App Service i minst hello Basic prisnivån.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-109">hello profiler currently works for ASP.NET web apps running on Azure App Services, in at least hello Basic pricing tier.</span></span> 

<a id="installation"></a>
## <a name="enable-hello-profiler"></a><span data-ttu-id="b7d2a-110">Aktivera hello profiler</span><span class="sxs-lookup"><span data-stu-id="b7d2a-110">Enable hello profiler</span></span>

<span data-ttu-id="b7d2a-111">[Installera Application Insights](app-insights-asp-net.md) i koden.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-111">[Install Application Insights](app-insights-asp-net.md) in your code.</span></span> <span data-ttu-id="b7d2a-112">Om den redan är installerad, kontrollera att du har hello senaste versionen.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-112">If it's already installed, make sure you have hello latest version.</span></span> <span data-ttu-id="b7d2a-113">(toodo, högerklicka på projektet i Solution Explorer och välj Hantera NuGet-paket.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-113">(toodo this, right-click your project in Solution Explorer, and choose Manage NuGet packages.</span></span> <span data-ttu-id="b7d2a-114">Välj uppdateringar och alla uppdateringspaket.) Omdistribuera din app.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-114">Select Updates and update all packages.) Re-deploy your app.</span></span>

<span data-ttu-id="b7d2a-115">*Med hjälp av ASP.NET Core? [Markera den här kryssrutan](#aspnetcore).*</span><span class="sxs-lookup"><span data-stu-id="b7d2a-115">*Using ASP.NET Core? [Check here](#aspnetcore).*</span></span>

<span data-ttu-id="b7d2a-116">I [https://portal.azure.com](https://portal.azure.com), öppna hello Application Insights-resurs för webbappen.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-116">In [https://portal.azure.com](https://portal.azure.com), open hello Application Insights resource for your web app.</span></span> <span data-ttu-id="b7d2a-117">Öppna **prestanda** och på **aktivera Application Insights Profiler...** .</span><span class="sxs-lookup"><span data-stu-id="b7d2a-117">Open **Performance** and click **Enable Application Insights Profiler...**.</span></span>

![Klicka på hello aktivera profileraren banderoll][enable-profiler-banner]

<span data-ttu-id="b7d2a-119">Du kan alltid Klicka **konfigurera** tooview status, aktivera eller inaktivera hello Profiler.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-119">Alternatively, you can always click **Configure** tooview status, enable, or disable hello Profiler.</span></span>

![Klicka på Konfigurera i hello prestanda bladet][performance-blade]

<span data-ttu-id="b7d2a-121">Webbprogram som är konfigurerade med Application Insights visas på Konfigurera bladet.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-121">Web apps that are configured with Application Insights are listed on Configure blade.</span></span> <span data-ttu-id="b7d2a-122">Följ anvisningarna tooinstall hello profileraren agenten om det behövs.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-122">Follow instructions tooinstall hello Profiler agent if needed.</span></span> <span data-ttu-id="b7d2a-123">Om inget webbprogram har konfigurerats med Application Insights ännu, klickar du på *Lägg till länkade appar*.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-123">If no web app is configured with Application Insights yet, click *Add Linked Apps*.</span></span>

<span data-ttu-id="b7d2a-124">Använd hello *aktivera profileraren* eller *inaktivera profileraren* knapparna i hello konfigurera bladet toocontrol hello Profiler på alla dina länkade webbprogram.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-124">Use hello *Enable Profiler* or *Disable Profiler* buttons in hello Configure blade toocontrol hello Profiler on all your linked web apps.</span></span>



![Konfigurera bladet][linked app services]

<span data-ttu-id="b7d2a-126">toostop eller omstart hello profiler för en enskild App Service-instans, hittar du den **i hello App tjänstresurs**i **Webjobs**.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-126">toostop or restart hello profiler for an individual App Service instance, you'll find it **in hello App Service resource**, in **Web Jobs**.</span></span> <span data-ttu-id="b7d2a-127">toodelete utseende under den **tillägg**.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-127">toodelete it, look under **Extensions**.</span></span>

![Inaktivera profiler för en webb-jobb][disable-profiler-webjob]

<span data-ttu-id="b7d2a-129">Vi rekommenderar att du har hello Profiler som är aktiverad på alla dina toodiscover om web apps som alla prestandaproblem så snart som möjligt.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-129">We recommend that you have hello Profiler enabled on all your web apps toodiscover any performance issues as soon as possible.</span></span>

<span data-ttu-id="b7d2a-130">Om du använder WebDeploy toodeploy ändringar tooyour webbprogram, kontrollera att du utesluter hello **App_Data** mappen tas bort under distributionen.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-130">If you use WebDeploy toodeploy changes tooyour web application, ensure that you exclude hello **App_Data** folder from being deleted during deployment.</span></span> <span data-ttu-id="b7d2a-131">Annars hello profileraren tillägget filer tas bort när du sedan distribuerar hello web application tooAzure.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-131">Otherwise, hello profiler extension's files will be deleted when you next deploy hello web application tooAzure.</span></span>

### <a name="using-profiler-with-azure-vms-and-compute-resources-preview"></a><span data-ttu-id="b7d2a-132">Med hjälp av profiler med Azure Virtual Machines och beräkningsresurser (förhandsgranskning)</span><span class="sxs-lookup"><span data-stu-id="b7d2a-132">Using profiler with Azure VMs and Compute resources (preview)</span></span>

<span data-ttu-id="b7d2a-133">När du [aktivera Application Insights för Azure app Service vid körning](app-insights-azure-web-apps.md#run-time-instrumentation-with-application-insights), Profiler är automatiskt tillgänglig.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-133">When you [enable Application Insights for Azure app services at run time](app-insights-azure-web-apps.md#run-time-instrumentation-with-application-insights), Profiler is automatically available.</span></span> <span data-ttu-id="b7d2a-134">(Om du redan har aktiverat Programinsikter för hello resursen måste kanske tooupdate toohello lates version via hello **konfigurera** guiden.)</span><span class="sxs-lookup"><span data-stu-id="b7d2a-134">(If you already enabled Application Insights for hello resource, you might need tooupdate toohello lates version through hello **Configure** wizard.)</span></span>

<span data-ttu-id="b7d2a-135">Det finns en [förhandsversionen av hello Profiler för Azure Compute resurser](https://go.microsoft.com/fwlink/?linkid=848155).</span><span class="sxs-lookup"><span data-stu-id="b7d2a-135">There is a [preview version of hello Profiler for Azure Compute resources](https://go.microsoft.com/fwlink/?linkid=848155).</span></span>


## <a name="limits"></a><span data-ttu-id="b7d2a-136">Begränsningar</span><span class="sxs-lookup"><span data-stu-id="b7d2a-136">Limits</span></span>

<span data-ttu-id="b7d2a-137">hello standard datalagring är 5 dagar.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-137">hello default data retention is 5 days.</span></span> <span data-ttu-id="b7d2a-138">Maximal 10 GB inhämtas per dag.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-138">Maximum 10 GB ingested per day.</span></span>

<span data-ttu-id="b7d2a-139">Det är gratis för hello profileraren tjänsten.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-139">There is no charge for hello profiler service.</span></span> <span data-ttu-id="b7d2a-140">Ditt webbprogram måste finnas i minst hello grundläggande nivån av App-tjänster.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-140">Your web app must be hosted in at least hello Basic tier of App Services.</span></span>

## <a name="viewing-profiler-data"></a><span data-ttu-id="b7d2a-141">Visa profiler data</span><span class="sxs-lookup"><span data-stu-id="b7d2a-141">Viewing profiler data</span></span>

<span data-ttu-id="b7d2a-142">Öppna hello prestanda bladet och rulla ned toohello åtgärden listan.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-142">Open hello Performance blade and scroll down toohello operation list.</span></span>




![Application Insights prestanda bladet exempel kolumn][performance-blade-examples]

<span data-ttu-id="b7d2a-144">hello kolumner i tabellen hello är:</span><span class="sxs-lookup"><span data-stu-id="b7d2a-144">hello columns in hello table are:</span></span>

* <span data-ttu-id="b7d2a-145">**Antal** -hello antal dessa begäranden i hello tidsintervall för hello-bladet.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-145">**Count** - hello number of these requests in hello time range of hello blade.</span></span>
* <span data-ttu-id="b7d2a-146">**Medianvärdet** -hello vanliga överföringstiden för din app toorespond tooa begäran.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-146">**Median** - hello typical time your app takes toorespond tooa request.</span></span> <span data-ttu-id="b7d2a-147">Hälften av alla svar var snabbare än så.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-147">Half of all responses were faster than this.</span></span>
* <span data-ttu-id="b7d2a-148">**95: e percentilen** 95% av svar var snabbare än så.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-148">**95th percentile** 95% of responses were faster than this.</span></span> <span data-ttu-id="b7d2a-149">Om denna bild är bland annat hello median kan finnas det ett tillfälligt problem med din app.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-149">If this figure is very different from hello median, there might be an intermittent problem with your app.</span></span> <span data-ttu-id="b7d2a-150">(Eller det kan förklaras av en design-funktion, till exempel cachelagring.)</span><span class="sxs-lookup"><span data-stu-id="b7d2a-150">(Or it might be explained by a design feature such as caching.)</span></span>
* <span data-ttu-id="b7d2a-151">**Exempel** -en ikon som indikerar att hello profileraren har hämtats stackspår för den här åtgärden.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-151">**Examples** - an icon indicates that hello profiler has captured stack traces for this operation.</span></span>

<span data-ttu-id="b7d2a-152">Klicka på hello exempel ikonen tooopen hello trace explorer.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-152">Click hello Examples icon tooopen hello trace explorer.</span></span> <span data-ttu-id="b7d2a-153">hello explorer visar några exempel som hello profileraren har hämtats klassificeras efter svarstid.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-153">hello explorer shows several samples that hello profiler has captured, classified by response time.</span></span>

<span data-ttu-id="b7d2a-154">Välj en exempel-tooshow en kod på objektnivå uppdelning av tid som går åt verkställande hello-begäran.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-154">Select a sample tooshow a code-level breakdown of time spent executing hello request.</span></span>

![Application Insights Trace Explorer][trace-explorer]

<span data-ttu-id="b7d2a-156">**Visa varm sökvägen** öppnas hello största lövnod eller stänga minst något.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-156">**Show hot path** opens hello biggest leaf node, or at least something close.</span></span> <span data-ttu-id="b7d2a-157">I de flesta fall inte den här noden intilliggande tooa flaskhalsar.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-157">In most cases this node will be adjacent tooa performance bottleneck.</span></span>



* <span data-ttu-id="b7d2a-158">**Etiketten**: hello namnet på funktionen hello eller händelse.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-158">**Label**: hello name of hello function or event.</span></span> <span data-ttu-id="b7d2a-159">hello trädet innehåller en blandning av koden och händelser som inträffade (till exempel SQL- och HTTP-händelser).</span><span class="sxs-lookup"><span data-stu-id="b7d2a-159">hello tree shows a mix of code and events that occurred (such as SQL and http events).</span></span> <span data-ttu-id="b7d2a-160">hello översta händelsen representerar hello övergripande varaktighet för begäran.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-160">hello top event represents hello overall request duration.</span></span>
* <span data-ttu-id="b7d2a-161">**Förfluten tid**: hello tidsintervallet mellan hello operation hello startas och hello slut.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-161">**Elapsed**: hello time interval between hello start of hello operation and hello end.</span></span>
* <span data-ttu-id="b7d2a-162">**När**: Visar när hello funktionen/händelse kördes i relationen tooother funktioner.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-162">**When**: Shows when hello function/event was running in relation tooother functions.</span></span>

## <a name="how-tooread-performance-data"></a><span data-ttu-id="b7d2a-163">Hur tooread prestandadata</span><span class="sxs-lookup"><span data-stu-id="b7d2a-163">How tooread performance data</span></span>

<span data-ttu-id="b7d2a-164">Microsoft service profiler använder en kombination av provtagning metoden och instrumentation tooanalyze hello prestanda för ditt program.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-164">Microsoft service profiler uses a combination of sampling method and instrumentation tooanalyze hello performance of your application.</span></span>
<span data-ttu-id="b7d2a-165">När detaljerad samling pågår hello service profiler-exempel instruktion pekare på var och en av hello datorns processor i varje millisekunder.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-165">When detailed collection is in progress, service profiler samples hello instruction pointer of each of hello machine's CPU in every millisecond.</span></span>
<span data-ttu-id="b7d2a-166">Varje prov avbildar hello fullständig anropsstacken för hello tråd för närvarande körs, ger detaljerad och användbar information om vad som tråden som utfördes på båda hög och låg gjord.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-166">Each sample captures hello complete call stack of hello thread currently executing, giving detailed and useful information about what that thread was doing at both high and low levels of abstraction.</span></span> <span data-ttu-id="b7d2a-167">Service profiler samlar även in andra händelser som kontexten växling händelser, TPL händelser och trådpoolen händelser tootrack aktivitet korrelation och orsakssamband.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-167">Service profiler also collects other events such as context switching events, TPL events, and thread-pool events tootrack activity correlation and causality.</span></span>

<span data-ttu-id="b7d2a-168">hello anropsstacken visas i hello tidslinjevyn beror hello hello ovan provtagning och instrumentation.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-168">hello call stack shown in hello timeline view is hello result of hello above sampling and instrumentation.</span></span> <span data-ttu-id="b7d2a-169">Eftersom varje prov fångar hello fullständig anropsstacken för hello tråd, inkluderar den kod från hello .NET framework, samt andra ramverk som du refererar till.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-169">Because each sample captures hello complete call stack of hello thread, it includes code from hello .NET framework, as well as other frameworks you reference.</span></span>

### <span data-ttu-id="b7d2a-170"><a id="jitnewobj"></a>Objekt-allokering (`clr!JIT\_New or clr!JIT\_Newarr1`)</span><span class="sxs-lookup"><span data-stu-id="b7d2a-170"><a id="jitnewobj"></a>Object Allocation (`clr!JIT\_New or clr!JIT\_Newarr1`)</span></span>
<span data-ttu-id="b7d2a-171">`clr!JIT\_New and clr!JIT\_Newarr1`är hjälpfunktioner i .NET framework som allokerar minne från hanterad heap.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-171">`clr!JIT\_New and clr!JIT\_Newarr1` are helper functions inside .NET framework that allocates memory from managed heap.</span></span> <span data-ttu-id="b7d2a-172">`clr!JIT\_New`anropas när ett objekt har allokerats.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-172">`clr!JIT\_New` is invoked when an object is allocated.</span></span> <span data-ttu-id="b7d2a-173">`clr!JIT\_Newarr1`anropas när en objektmatris allokeras.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-173">`clr!JIT\_Newarr1` is invoked when an object array is allocated.</span></span> <span data-ttu-id="b7d2a-174">Dessa två funktioner är vanligtvis mycket snabbt och bör ta relativt små lång tid.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-174">These two functions are typically very fast and should take relatively small amount of time.</span></span> <span data-ttu-id="b7d2a-175">Om du ser `clr!JIT\_New` eller `clr!JIT\_Newarr1` ta en lång tid i tidslinjen, det är en indikation på att hello kod fördela många objekt och förbruka mycket minne.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-175">If you see `clr!JIT\_New` or `clr!JIT\_Newarr1` take a substantial amount of time in your timeline, it's an indication that hello code may be allocating many objects and consuming significant amount of memory.</span></span>

### <span data-ttu-id="b7d2a-176"><a id="theprestub"></a>Läser in kod (`clr!ThePreStub`)</span><span class="sxs-lookup"><span data-stu-id="b7d2a-176"><a id="theprestub"></a>Loading Code (`clr!ThePreStub`)</span></span>
<span data-ttu-id="b7d2a-177">`clr!ThePreStub`är en hjälpfunktion i .NET framework som förbereder hello kod tooexecute för hello första gången.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-177">`clr!ThePreStub` is a helper function inside .NET framework that prepares hello code tooexecute for hello first time.</span></span> <span data-ttu-id="b7d2a-178">Detta innefattar vanligtvis sådana, men inte begränsat till, JIT (Just i tid)-kompilering.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-178">This typically includes, but not limited to, JIT (Just In Time) compilation.</span></span> <span data-ttu-id="b7d2a-179">För varje C#-metoden `clr!ThePreStub` ska anropas en gång under hello livslängden för en process.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-179">For each C# method, `clr!ThePreStub` should be invoked at most once during hello lifetime of a process.</span></span>

<span data-ttu-id="b7d2a-180">Om du ser `clr!ThePreStub` tar lång tid för en begäran, betyder det att begäran är hello förstnämnda som utför den metoden och hello tid för .NET framework runtime tooload att metoden är betydande.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-180">If you see `clr!ThePreStub` takes significant amount of time for a request, it indicates that request is hello first one that executes that method, and hello time for .NET framework runtime tooload that method is significant.</span></span> <span data-ttu-id="b7d2a-181">Du kan överväga en värmts process som körs som del av hello koden innan användarna åtkomst till den eller Överväg att köra NGen på din sammansättningar.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-181">You can consider a warm-up process that executes that portion of hello code before your users access it, or consider running NGen on your assemblies.</span></span>

### <span data-ttu-id="b7d2a-182"><a id="lockcontention"></a>Låskonkurrens (`clr!JITutil\_MonContention` eller `clr!JITutil\_MonEnterWorker`)</span><span class="sxs-lookup"><span data-stu-id="b7d2a-182"><a id="lockcontention"></a>Lock Contention (`clr!JITutil\_MonContention` or `clr!JITutil\_MonEnterWorker`)</span></span>
<span data-ttu-id="b7d2a-183">`clr!JITutil\_MonContention`eller `clr!JITutil\_MonEnterWorker` ange hello aktuella tråden väntar på ett lås toobe släpps.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-183">`clr!JITutil\_MonContention` or `clr!JITutil\_MonEnterWorker` indicate hello current thread is waiting for a lock toobe released.</span></span> <span data-ttu-id="b7d2a-184">Detta normalt visas när du kör en C# lock-instruktion, startar Monitor.Enter metod eller anropa en metod med attributet MethodImplOptions.Synchronized.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-184">This typically shows up when executing a C# lock statement, invoking Monitor.Enter method, or invoking a method with MethodImplOptions.Synchronized attribute.</span></span> <span data-ttu-id="b7d2a-185">Låskonkurrens inträffar oftast när tråden A hämtar ett lås och tråd B försöker tooacquire hello samma låsa innan tråd A släpper den.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-185">Lock contention typically happens when thread A acquires a lock, and thread B tries tooacquire hello same lock before thread A releases it.</span></span>

### <span data-ttu-id="b7d2a-186"><a id="ngencold"></a>Läser in kod (`[COLD]`)</span><span class="sxs-lookup"><span data-stu-id="b7d2a-186"><a id="ngencold"></a>Loading code (`[COLD]`)</span></span>
<span data-ttu-id="b7d2a-187">Om hello metodnamnet innehåller `[COLD]`, som `mscorlib.ni![COLD]System.Reflection.CustomAttribute.IsDefined`, innebär det att hello .NET framework-körningen kör kod som inte är optimerad av <a href="https://msdn.microsoft.com/library/e7k32f4k.aspx">profil interaktiv optimering</a> för hello första gången.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-187">If hello method name contains `[COLD]`, such as `mscorlib.ni![COLD]System.Reflection.CustomAttribute.IsDefined`, it means that hello .NET framework runtime is executing code that is not optimized by <a href="https://msdn.microsoft.com/library/e7k32f4k.aspx">profile-guided optimization</a> for hello first time.</span></span> <span data-ttu-id="b7d2a-188">För varje metod ska det visas högst en gång under hello livstid hello-processen.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-188">For each method, it should show up at most once during hello lifetime of hello process.</span></span>

<span data-ttu-id="b7d2a-189">Om inläsning av koden tar lång tid en begäran, betyder det att begäran är hello första en tooexecute hello optimerat delen av hello-metoden.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-189">If loading code takes significant amount of time for a request, it indicates that request is hello first one tooexecute hello unoptimized portion of hello method.</span></span> <span data-ttu-id="b7d2a-190">Du kan överväga en varmt in process som körs som del av hello koden innan användarna åtkomst till den.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-190">You can consider a warm up process that executes that portion of hello code before your users access it.</span></span>

### <span data-ttu-id="b7d2a-191"><a id="httpclientsend"></a>Skicka HTTP-begäran</span><span class="sxs-lookup"><span data-stu-id="b7d2a-191"><a id="httpclientsend"></a>Send HTTP Request</span></span>
<span data-ttu-id="b7d2a-192">Metoder som `HttpClient.Send` ange hello kod väntar på att en HTTP-begäran toocomplete.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-192">Methods such as `HttpClient.Send` indicate hello code is waiting for a HTTP request toocomplete.</span></span>

### <span data-ttu-id="b7d2a-193"><a id="sqlcommand"></a>Databasåtgärden</span><span class="sxs-lookup"><span data-stu-id="b7d2a-193"><a id="sqlcommand"></a>Database Operation</span></span>
<span data-ttu-id="b7d2a-194">Metoden, till exempel SqlCommand.Execute anger hello kod väntar på en databas åtgärden toocomplete.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-194">Method such as SqlCommand.Execute indicates hello code is waiting for a database operation toocomplete.</span></span>

### <span data-ttu-id="b7d2a-195"><a id="await"></a>Väntar på (`AWAIT\_TIME`)</span><span class="sxs-lookup"><span data-stu-id="b7d2a-195"><a id="await"></a>Waiting (`AWAIT\_TIME`)</span></span>
<span data-ttu-id="b7d2a-196">`AWAIT\_TIME`Anger hello kod väntar på en annan aktivitet toocomplete.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-196">`AWAIT\_TIME` indicates hello code is waiting for another task toocomplete.</span></span> <span data-ttu-id="b7d2a-197">Detta inträffar vanligtvis med C#-await-instruktionen.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-197">This typically happens with C# 'await' statement.</span></span> <span data-ttu-id="b7d2a-198">När hello koden gör en C# 'await', hello tråd unwinds returnerar kontrollen toohello trådpoolen och det finns ingen tråd blockeras väntar hello 'await' toofinish.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-198">When hello code does a C# 'await', hello thread unwinds and returns control toohello thread-pool, and there is no thread that is blocked waiting for hello 'await' toofinish.</span></span> <span data-ttu-id="b7d2a-199">Logiskt hello men tråden som gjorde hello await 'blockeras' hello åtgärden toocomplete väntar.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-199">However, logically hello thread that did hello await is 'blocked' waiting for hello operation toocomplete.</span></span> <span data-ttu-id="b7d2a-200">Den `AWAIT\_TIME` anger hello blockeras tidpunkt väntar hello uppgiften toocomplete.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-200">The `AWAIT\_TIME` indicates hello blocked time waiting for hello task toocomplete.</span></span>

### <span data-ttu-id="b7d2a-201"><a id="block"></a>Blockerade tid</span><span class="sxs-lookup"><span data-stu-id="b7d2a-201"><a id="block"></a>Blocked Time</span></span>
<span data-ttu-id="b7d2a-202">`BLOCKED_TIME`Anger hello kod väntar på en annan resurs toobe som är tillgängliga, till exempel väntar på ett synkroniseringsobjekt, väntar på att en tråd toobe tillgängliga eller väntar på att en begäran toofinish.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-202">`BLOCKED_TIME` indicates hello code is waiting for another resource toobe available, such as waiting for a synchronization object, waiting for a thread toobe available, or waiting for a request toofinish.</span></span>

### <span data-ttu-id="b7d2a-203"><a id="cpu"></a>CPU-tid</span><span class="sxs-lookup"><span data-stu-id="b7d2a-203"><a id="cpu"></a>CPU Time</span></span>
<span data-ttu-id="b7d2a-204">hello CPU är upptagen med att köra hello-instruktioner.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-204">hello CPU is busy executing hello instructions.</span></span>

### <span data-ttu-id="b7d2a-205"><a id="disk"></a>Disktid i procent</span><span class="sxs-lookup"><span data-stu-id="b7d2a-205"><a id="disk"></a>Disk Time</span></span>
<span data-ttu-id="b7d2a-206">hello program utför diskåtgärder.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-206">hello application is performing disk operations.</span></span>

### <span data-ttu-id="b7d2a-207"><a id="network"></a>Network Time</span><span class="sxs-lookup"><span data-stu-id="b7d2a-207"><a id="network"></a>Network Time</span></span>
<span data-ttu-id="b7d2a-208">hello program utför nätverksåtgärder.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-208">hello application is performing network operations.</span></span>

### <span data-ttu-id="b7d2a-209"><a id="when"></a>När kolumnen</span><span class="sxs-lookup"><span data-stu-id="b7d2a-209"><a id="when"></a>When column</span></span>
<span data-ttu-id="b7d2a-210">Det här är en visualisering av hur hello INKLUSIVA prover samlas in för en nod variera över tid.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-210">This is a visualization of how hello INCLUSIVE samples collected for a node vary over time.</span></span> <span data-ttu-id="b7d2a-211">hello totala intervallet för hello-begäran är uppdelat i 32 tid buckets och hello inklusiva prover för noden ackumuleras till dessa 32 buckets.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-211">hello total range of hello request is divided into 32 time buckets and hello inclusive samples for that node are accumulated into those 32 buckets.</span></span> <span data-ttu-id="b7d2a-212">Varje bucket sedan representeras som en stapel vars höjd representerar ett skalade värde.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-212">Each bucket is then represented as a bar whose height represents a scaled value.</span></span> <span data-ttu-id="b7d2a-213">För markerade noder `CPU_TIME` eller `BLOCKED_TIME`, eller om det finns en tydlig relationen mellan förbrukar en resurs (cpu, disk, tråd), hello liggande representerar förbrukar en av resurserna för hello tidsperiod som bucket.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-213">For nodes marked `CPU_TIME` or `BLOCKED_TIME`, or where there is an obvious relationship of consuming a resource (cpu, disk, thread), hello bar represents consuming one of those resources for hello period of time of that bucket.</span></span> <span data-ttu-id="b7d2a-214">De här måtten kan du få mer än 100% genom att använda flera resurser.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-214">For these metrics you can get greater than 100% by consuming multiple resources.</span></span> <span data-ttu-id="b7d2a-215">Till exempel om i genomsnitt du använder två processorer via ett intervall som får sedan du 200%.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-215">For example, if on average you use two CPUs over an interval then you get 200%.</span></span>


## <span data-ttu-id="b7d2a-216"><a id="troubleshooting"></a>Felsökning</span><span class="sxs-lookup"><span data-stu-id="b7d2a-216"><a id="troubleshooting"></a>Troubleshooting</span></span>

### <a name="how-can-i-know-whether-application-insights-profiler-is-running"></a><span data-ttu-id="b7d2a-217">Hur vet jag om Application Insights profiler körs?</span><span class="sxs-lookup"><span data-stu-id="b7d2a-217">How can I know whether Application Insights profiler is running?</span></span>

<span data-ttu-id="b7d2a-218">hello profileraren körs som en kontinuerlig web-jobb i webbprogrammet.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-218">hello profiler runs as a continuous web job in Web App.</span></span> <span data-ttu-id="b7d2a-219">Du kan öppna hello webbprogrammet resurs i https://portal.azure.com och kontrollera statusen för ”ApplicationInsightsProfiler” Hej WebJobs-bladet.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-219">You can open hello Web App resource in https://portal.azure.com and check "ApplicationInsightsProfiler" status in hello WebJobs blade.</span></span> <span data-ttu-id="b7d2a-220">Om den inte körs, öppna **loggar** toofind mer.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-220">If it isn't running, open **Logs** toofind out more.</span></span>

### <a name="why-cant-i-find-any-stack-examples-even-though-hello-profiler-is-running"></a><span data-ttu-id="b7d2a-221">Varför hittar inte någon stack-exempel trots att hello profileraren körs?</span><span class="sxs-lookup"><span data-stu-id="b7d2a-221">Why can't I find any stack examples even though hello profiler is running?</span></span>

<span data-ttu-id="b7d2a-222">Här följer några saker du kan kontrollera.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-222">Here are a few things you can check.</span></span>

1. <span data-ttu-id="b7d2a-223">Se till att din Web App Service-Plan grundläggande nivån och högre.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-223">Make sure your Web App Service Plan is Basic tier and above.</span></span>
2. <span data-ttu-id="b7d2a-224">Kontrollera att ditt webbprogram har Application Insights SDK 2.2 Beta och ovan aktiverad.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-224">Make sure your Web App has Application Insights SDK 2.2 Beta and above enabled.</span></span>
3. <span data-ttu-id="b7d2a-225">Kontrollera att ditt webbprogram har hello APPINSIGHTS_INSTRUMENTATIONKEY setting hello samma instrumentation nyckel som används av Application Insights SDK.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-225">Make sure your Web App has hello APPINSIGHTS_INSTRUMENTATIONKEY setting with hello same instrumentation key used by Application Insights SDK.</span></span>
4. <span data-ttu-id="b7d2a-226">Kontrollera att ditt webbprogram som körs på .net Framework 4.6.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-226">Make sure your Web App is running on .Net Framework 4.6.</span></span>
5. <span data-ttu-id="b7d2a-227">Om det är ett ASP.NET Core-program kan också kontrollera [hello krävs beroenden](#aspnetcore).</span><span class="sxs-lookup"><span data-stu-id="b7d2a-227">If it's an ASP.NET Core application, please also check [hello required dependencies](#aspnetcore).</span></span>

<span data-ttu-id="b7d2a-228">Finns en kort värmts period när hello profileraren aktivt samlar in spårningar för flera prestanda när hello profileraren har startats.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-228">After hello profiler is started, there is a short warm-up period when hello profiler actively collects several performance traces.</span></span> <span data-ttu-id="b7d2a-229">Samlar in prestanda spårningar i två minuter i varje timme efter det hello profiler.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-229">After that, hello profiler collects performance traces for two minutes in every hour.</span></span>  

### <a name="i-was-using-azure-service-profiler-what-happened-tooit"></a><span data-ttu-id="b7d2a-230">Jag använde Azure Service Profiler.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-230">I was using Azure Service Profiler.</span></span> <span data-ttu-id="b7d2a-231">Vilka happened tooit?</span><span class="sxs-lookup"><span data-stu-id="b7d2a-231">What happened tooit?</span></span>  

<span data-ttu-id="b7d2a-232">När du aktiverar Application Insights profileraren har Azure Service Profiler-agenten inaktiverats.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-232">When you enable Application Insights Profiler, Azure Service Profiler agent is disabled.</span></span>

### <span data-ttu-id="b7d2a-233"><a id="double-counting"></a>Dubbel inventering i parallella trådar</span><span class="sxs-lookup"><span data-stu-id="b7d2a-233"><a id="double-counting"></a>Double counting in parallel threads</span></span>

<span data-ttu-id="b7d2a-234">I vissa fall hello är total tidsmått i hello stack viewer mer än hello verkliga varaktigheten av hello-begäran.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-234">In some cases hello total time metric in hello stack viewer is more than hello actual duration of hello request.</span></span>

<span data-ttu-id="b7d2a-235">Detta kan inträffa när det finns två eller flera trådar som är associerade med en begäran körs parallellt.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-235">This can happen when there are two or more threads associated with a request, operating in parallel.</span></span> <span data-ttu-id="b7d2a-236">hello totala tråd tid är sedan större än hello förfluten tid.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-236">hello total thread time is then more than hello elapsed time.</span></span> <span data-ttu-id="b7d2a-237">I många fall kan väntar på en tråd på hello andra toocomplete.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-237">In many cases one thread may be waiting on hello other toocomplete.</span></span> <span data-ttu-id="b7d2a-238">Hej viewer försöker toodetect detta och utelämna hello ointressanta vänta, men överför längs hello visar för mycket i stället för att utelämna vad som kan vara viktig information.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-238">hello viewer tries toodetect this and omit hello uninteresting wait, but errs on hello side of showing too much rather than omitting what may be critical information.</span></span>  

<span data-ttu-id="b7d2a-239">När du ser parallella trådar i dina spår måste toodetermine som trådar som väntar på för att se hello kritiska för hello-begäran.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-239">When you see parallel threads in your traces, you need toodetermine which threads are waiting so you can determine hello critical path for hello request.</span></span> <span data-ttu-id="b7d2a-240">I de flesta fall hello hello tråd som snabbt att försätta datorn i tillståndet vänta bara väntar på andra trådar.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-240">In most cases, hello thread that quickly goes into a wait state is simply waiting on hello other threads.</span></span> <span data-ttu-id="b7d2a-241">Koncentrera dig på hello andra och ignorera hello tid i hello väntande trådar.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-241">Concentrate on hello others and ignore hello time in hello waiting threads.</span></span>

### <span data-ttu-id="b7d2a-242"><a id="issue-loading-trace-in-viewer"></a>Inga profildata</span><span class="sxs-lookup"><span data-stu-id="b7d2a-242"><a id="issue-loading-trace-in-viewer"></a>No profiling data</span></span>

1. <span data-ttu-id="b7d2a-243">Om hello data som du försöker tooview är äldre än några veckor, begränsa tiden filtret och försök igen.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-243">If hello data you are trying tooview is older than a couple of weeks, try limiting your time filter and try again.</span></span>

2. <span data-ttu-id="b7d2a-244">Kontrollera att proxyservrar eller en brandvägg har inte blockerat åtkomsten toohttps://gateway.azureserviceprofiler.net.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-244">Check that proxies or a firewall have not blocked access toohttps://gateway.azureserviceprofiler.net.</span></span>

3. <span data-ttu-id="b7d2a-245">Kontrollera att hello hello Application Insights instrumentation nyckeln som du använder i din app är samma som hello Application Insights-resurs som du har aktiverat profilering med.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-245">Check that hello Application Insights instrumentation key you are using in your app is hello same as hello Application Insights resource you've enabled profiling with.</span></span> <span data-ttu-id="b7d2a-246">hello nyckeln finns vanligtvis i ApplicationInsights.config men finns också i web.config eller app.config.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-246">hello key is usually in ApplicationInsights.config but can also be found in web.config or app.config.</span></span>

### <a name="error-report-in-hello-profiling-viewer"></a><span data-ttu-id="b7d2a-247">Felrapport i hello profilering viewer</span><span class="sxs-lookup"><span data-stu-id="b7d2a-247">Error report in hello profiling viewer</span></span>

<span data-ttu-id="b7d2a-248">Filen ett supportärende från hello-portalen.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-248">File a support ticket from hello portal.</span></span> <span data-ttu-id="b7d2a-249">Ange hello Korrelations-ID från hello felmeddelande.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-249">Please include hello correlation ID from hello error message.</span></span>

## <a name="manual-installation"></a><span data-ttu-id="b7d2a-250">Manuell installation</span><span class="sxs-lookup"><span data-stu-id="b7d2a-250">Manual installation</span></span>

<span data-ttu-id="b7d2a-251">När du konfigurerar hello profileraren görs hello följande uppdateringar toohello Web App-inställningar.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-251">When you configure hello profiler, hello following updates are made toohello Web App's settings.</span></span> <span data-ttu-id="b7d2a-252">Du kan göra dem själv manuellt om din miljö kräver, till exempel om programmet körs i Azure App Service miljö (ASE):</span><span class="sxs-lookup"><span data-stu-id="b7d2a-252">You can do them yourself manually if your environment requires, for example, if your application runs in Azure App Service Environment (ASE):</span></span>

1. <span data-ttu-id="b7d2a-253">Öppna inställningar i hello web app kontroll-bladet.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-253">In hello web app control blade, open Settings.</span></span>
2. <span data-ttu-id="b7d2a-254">Ange ”.net Framework-version” toov4.6.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-254">Set ".Net Framework version" toov4.6.</span></span>
3. <span data-ttu-id="b7d2a-255">Ange ”alltid på” tooOn.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-255">Set "Always On" tooOn.</span></span>
4. <span data-ttu-id="b7d2a-256">Lägga till appinställningen ”__APPINSIGHTS_INSTRUMENTATIONKEY__” och ange hello värdet toohello samma instrumentation nyckel som används av hello SDK.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-256">Add app setting "__APPINSIGHTS_INSTRUMENTATIONKEY__" and set hello value toohello same instrumentation key used by hello SDK.</span></span>
5. <span data-ttu-id="b7d2a-257">Öppna avancerade verktyg.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-257">Open Advanced Tools.</span></span>
6. <span data-ttu-id="b7d2a-258">Klicka på ”Gå” tooopen hello Kudu webbplats.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-258">Click "Go" tooopen hello Kudu website.</span></span>
7. <span data-ttu-id="b7d2a-259">I hello Kudu-webbplatsen, väljer du ”webbplatstillägg”.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-259">In hello Kudu website, select "Site extensions".</span></span>
8. <span data-ttu-id="b7d2a-260">Installera ”__Programinsikter__” från galleriet.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-260">Install "__Application Insights__" from Gallery.</span></span>
9. <span data-ttu-id="b7d2a-261">Starta om hello webbprogram.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-261">Restart hello web app.</span></span>

## <span data-ttu-id="b7d2a-262"><a id="aspnetcore"></a>ASP.NET Core-stöd</span><span class="sxs-lookup"><span data-stu-id="b7d2a-262"><a id="aspnetcore"></a>ASP.NET Core Support</span></span>

<span data-ttu-id="b7d2a-263">ASP.NET Core programmet måste tooinstall Microsoft.ApplicationInsights.AspNetCore Nuget-paketet 2.1.0-beta6 eller högre toowork med hello Profiler.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-263">ASP.NET Core application needs tooinstall Microsoft.ApplicationInsights.AspNetCore Nuget package 2.1.0-beta6 or higher toowork with hello Profiler.</span></span> <span data-ttu-id="b7d2a-264">Vi stöder inte längre hello lägre versioner efter 6/27/2017.</span><span class="sxs-lookup"><span data-stu-id="b7d2a-264">We no longer support hello lower versions after 6/27/2017.</span></span>

## <a name="next-steps"></a><span data-ttu-id="b7d2a-265">Nästa steg</span><span class="sxs-lookup"><span data-stu-id="b7d2a-265">Next steps</span></span>

* [<span data-ttu-id="b7d2a-266">Arbeta med Application Insights i Visual Studio</span><span class="sxs-lookup"><span data-stu-id="b7d2a-266">Working with Application Insights in Visual Studio</span></span>](https://docs.microsoft.com/azure/application-insights/app-insights-visual-studio)

[performance-blade]: ./media/app-insights-profiler/performance-blade.png
[performance-blade-examples]: ./media/app-insights-profiler/performance-blade-examples.png
[trace-explorer]: ./media/app-insights-profiler/trace-explorer.png
[trace-explorer-toolbar]: ./media/app-insights-profiler/trace-explorer-toolbar.png
[trace-explorer-hint-tip]: ./media/app-insights-profiler/trace-explorer-hint-tip.png
[trace-explorer-hot-path]: ./media/app-insights-profiler/trace-explorer-hot-path.png
[enable-profiler-banner]: ./media/app-insights-profiler/enable-profiler-banner.png
[disable-profiler-webjob]: ./media/app-insights-profiler/disable-profiler-webjob.png
[linked app services]: ./media/app-insights-profiler/linked-app-services.png
