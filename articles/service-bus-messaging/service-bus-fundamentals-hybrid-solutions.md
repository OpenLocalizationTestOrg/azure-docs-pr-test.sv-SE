---
title: "Översikt över grunderna i Azure Service Bus | Microsoft Docs"
description: "En introduktion till att använda Service Bus för att ansluta Azure-appar till andra program."
services: service-bus-messaging
documentationcenter: .net
author: sethmanheim
manager: timlt
editor: 
ms.assetid: 12654cdd-82ab-4b95-b56f-08a5a8bbc6f9
ms.service: service-bus-messaging
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: get-started-article
ms.date: 06/15/2017
ms.author: sethm
ms.openlocfilehash: af8b10f0a460e695a39879718174e81f78934ef8
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 07/11/2017
---
# <a name="azure-service-bus"></a><span data-ttu-id="ee818-103">Azure Service Bus</span><span class="sxs-lookup"><span data-stu-id="ee818-103">Azure Service Bus</span></span>

<span data-ttu-id="ee818-104">Oavsett om en app eller tjänst körs i molnet eller lokalt, måste den ofta samverka med andra program eller tjänster.</span><span class="sxs-lookup"><span data-stu-id="ee818-104">Whether an application or service runs in the cloud or on premises, it often needs to interact with other applications or services.</span></span> <span data-ttu-id="ee818-105">Microsoft Azure tillhandahåller Service Bus för att du ska kunna göra detta på ett fritt och praktiskt sätt.</span><span class="sxs-lookup"><span data-stu-id="ee818-105">To provide a broadly useful way to do this, Microsoft Azure offers Service Bus.</span></span> <span data-ttu-id="ee818-106">I den här artikeln tar vi en titt på denna teknik och beskriver vad den är och varför du kanske vill använda den.</span><span class="sxs-lookup"><span data-stu-id="ee818-106">This article looks at this technology, describing what it is and why you might want to use it.</span></span>

## <a name="service-bus-fundamentals"></a><span data-ttu-id="ee818-107">Grunderna i Service Bus</span><span class="sxs-lookup"><span data-stu-id="ee818-107">Service Bus fundamentals</span></span>

<span data-ttu-id="ee818-108">Olika situationer kräver olika kommunikationsstilar.</span><span class="sxs-lookup"><span data-stu-id="ee818-108">Different situations call for different styles of communication.</span></span> <span data-ttu-id="ee818-109">Ibland är den bästa lösningen att låta appar skicka och ta emot meddelanden via en enkel kö.</span><span class="sxs-lookup"><span data-stu-id="ee818-109">Sometimes, letting applications send and receive messages through a simple queue is the best solution.</span></span> <span data-ttu-id="ee818-110">I vissa situationer räcker det inte med en vanlig kö, utan det är bättre att använda en kö med en mekanism av typen publicera och prenumerera.</span><span class="sxs-lookup"><span data-stu-id="ee818-110">In other situations, an ordinary queue isn't enough; a queue with a publish-and-subscribe mechanism is better.</span></span> <span data-ttu-id="ee818-111">I andra fall är allt som behövs en anslutning mellan apparna. Köer är överflödiga.</span><span class="sxs-lookup"><span data-stu-id="ee818-111">In some cases, all that's needed is a connection between applications, and queues are not required.</span></span> <span data-ttu-id="ee818-112">Service Bus gör att du kan använda alla tre alternativ och ser till att dina appar kan interagera på flera olika sätt.</span><span class="sxs-lookup"><span data-stu-id="ee818-112">Service Bus provides all three options, enabling your applications to interact in several different ways.</span></span>

<span data-ttu-id="ee818-113">Service Bus är en molntjänst med flera klienter, vilket innebär att tjänsten delas av flera användare.</span><span class="sxs-lookup"><span data-stu-id="ee818-113">Service Bus is a multi-tenant cloud service, which means that the service is shared by multiple users.</span></span> <span data-ttu-id="ee818-114">Varje användare, till exempel en programutvecklare, skapar ett *namnområde*, och sedan definierar utvecklaren de kommunikationsmekanismer som han eller hon vill använda inom det här namnområdet.</span><span class="sxs-lookup"><span data-stu-id="ee818-114">Each user, such as an application developer, creates a *namespace*, then defines the communication mechanisms needed within that namespace.</span></span> <span data-ttu-id="ee818-115">Bild 1 visar hur den här arkitekturen ser ut.</span><span class="sxs-lookup"><span data-stu-id="ee818-115">Figure 1 shows how this architecture looks.</span></span>

![][1]

<span data-ttu-id="ee818-116">**Bild 1: Service Bus erbjuder en tjänst för flera innehavare för att ansluta program via molnet.**</span><span class="sxs-lookup"><span data-stu-id="ee818-116">**Figure 1: Service Bus provides a multi-tenant service for connecting applications through the cloud.**</span></span>

<span data-ttu-id="ee818-117">Du kan använda en eller flera instanser av tre olika kommunikationsmekanismer inom namnområdet. Dessa ansluter till appar på olika sätt.</span><span class="sxs-lookup"><span data-stu-id="ee818-117">Within a namespace, you can use one or more instances of three different communication mechanisms, each of which connects applications in a different way.</span></span> <span data-ttu-id="ee818-118">Alternativen är:</span><span class="sxs-lookup"><span data-stu-id="ee818-118">The choices are:</span></span>

* <span data-ttu-id="ee818-119">*Köer*, som tillåter en enkelriktad kommunikation.</span><span class="sxs-lookup"><span data-stu-id="ee818-119">*Queues*, which allow one-directional communication.</span></span> <span data-ttu-id="ee818-120">Varje kö fungerar som en mellanhand (kallas ibland för en *koordinator*) som sparar skickade meddelanden tills de tas emot.</span><span class="sxs-lookup"><span data-stu-id="ee818-120">Each queue acts as an intermediary (sometimes called a *broker*) that stores sent messages until they are received.</span></span> <span data-ttu-id="ee818-121">Varje meddelande tas emot av en enda mottagare.</span><span class="sxs-lookup"><span data-stu-id="ee818-121">Each message is received by a single recipient.</span></span>
* <span data-ttu-id="ee818-122">*Ämnen*, som ger enkelriktad kommunikation med hjälp av *prenumerationer*. Ett ämne kan ha flera prenumerationer.</span><span class="sxs-lookup"><span data-stu-id="ee818-122">*Topics*, which provide one-directional communication using *subscriptions*-a single topic can have multiple subscriptions.</span></span> <span data-ttu-id="ee818-123">Precis som med köerna fungerar ämnena som en koordinator (broker), men varje prenumeration kan sedan använda ett filter för att endast ta emot meddelanden som uppfyller specifika villkor.</span><span class="sxs-lookup"><span data-stu-id="ee818-123">Like a queue, a topic acts as a broker, but each subscription can optionally use a filter to receive only messages that match specific criteria.</span></span>
* <span data-ttu-id="ee818-124">*Reläer* (relays), som ger dubbelriktad kommunikation.</span><span class="sxs-lookup"><span data-stu-id="ee818-124">*Relays*, which provide bi-directional communication.</span></span> <span data-ttu-id="ee818-125">Till skillnad från köer och ämnen lagrar inte ett relä meddelanden som redan startats. Det är alltså inte en koordinator.</span><span class="sxs-lookup"><span data-stu-id="ee818-125">Unlike queues and topics, a relay doesn't store in-flight messages; it's not a broker.</span></span> <span data-ttu-id="ee818-126">I stället skickar reläet bara meddelandena vidare till målprogrammet.</span><span class="sxs-lookup"><span data-stu-id="ee818-126">Instead, it just passes them on to the destination application.</span></span>

<span data-ttu-id="ee818-127">När du skapar en kö, ett ämne eller ett relä ger du dem ett namn.</span><span class="sxs-lookup"><span data-stu-id="ee818-127">When you create a queue, topic, or relay, you give it a name.</span></span> <span data-ttu-id="ee818-128">Det här namnet, tillsammans med det namn som du gav namnområdet, skapar en unik identifierare för objektet.</span><span class="sxs-lookup"><span data-stu-id="ee818-128">Combined with whatever you called your namespace, this name creates a unique identifier for the object.</span></span> <span data-ttu-id="ee818-129">Appen kan överföra detta namn till Service Bus och sedan använda den kön, det ämnet eller det reläet i sin kommunikation med varandra.</span><span class="sxs-lookup"><span data-stu-id="ee818-129">Applications can provide this name to Service Bus, then use that queue, topic, or relay to communicate with one another.</span></span> 

<span data-ttu-id="ee818-130">Windows-program kan använda Windows Communication Foundation (WCF) för att använda något av dessa objekt vid vidarebefordran.</span><span class="sxs-lookup"><span data-stu-id="ee818-130">To use any of these objects in the relay scenario, Windows applications can use Windows Communication Foundation (WCF).</span></span> <span data-ttu-id="ee818-131">Den här tjänsten kallas [WCF Relay](../service-bus-relay/relay-what-is-it.md).</span><span class="sxs-lookup"><span data-stu-id="ee818-131">This service is known as [WCF Relay](../service-bus-relay/relay-what-is-it.md).</span></span> <span data-ttu-id="ee818-132">För köer och ämnen kan Windows-program använda API:er för Service Bus-definierade meddelandefunktioner.</span><span class="sxs-lookup"><span data-stu-id="ee818-132">For queues and topics, Windows applications can use Service Bus-defined messaging APIs.</span></span> <span data-ttu-id="ee818-133">Om du vill att det ska vara enklare att använda objekten från andra program som inte är från Windows, tillhandahåller Microsoft SDK:er för Java, Node.js och andra programmeringsspråk.</span><span class="sxs-lookup"><span data-stu-id="ee818-133">To make these objects easier to use from non-Windows applications, Microsoft provides SDKs for Java, Node.js, and other languages.</span></span> <span data-ttu-id="ee818-134">Du kan även få åtkomst till köer och ämnen med hjälp av [REST-API:er](/rest/api/servicebus/) via HTTP.</span><span class="sxs-lookup"><span data-stu-id="ee818-134">You can also access queues and topics using [REST APIs](/rest/api/servicebus/) over HTTP(s).</span></span> 

<span data-ttu-id="ee818-135">Det är viktigt att förstå att även om själva Service Bus körs i molnet (det vill säga i datacenter för Microsoft Azure) så kan apparna som använder den köras var som helst.</span><span class="sxs-lookup"><span data-stu-id="ee818-135">It's important to understand that even though Service Bus itself runs in the cloud (that is, in Microsoft's Azure datacenters), applications that use it can run anywhere.</span></span> <span data-ttu-id="ee818-136">Du kan använda Service Bus för att ansluta appar som körs på Azure, till exempel, eller program som körs i ditt eget datacenter.</span><span class="sxs-lookup"><span data-stu-id="ee818-136">You can use Service Bus to connect applications running on Azure, for example, or applications running inside your own datacenter.</span></span> <span data-ttu-id="ee818-137">Du kan också använda Service Bus för att ansluta en app som körs på Azure eller på en annan molnplattform med ett lokalt program, eller med surfplattor och smartmobiler.</span><span class="sxs-lookup"><span data-stu-id="ee818-137">You can also use it to connect an application running on Azure or another cloud platform with an on-premises application or with tablets and phones.</span></span> <span data-ttu-id="ee818-138">Det går till och med att ansluta hushållsapparater, sensorer och andra enheter till ett centralt program eller till varandra.</span><span class="sxs-lookup"><span data-stu-id="ee818-138">It's even possible to connect household appliances, sensors, and other devices to a central application or to one other.</span></span> <span data-ttu-id="ee818-139">Service Bus är en kommunikationsmekanism i molnet och den är tillgänglig från nästan var som helst.</span><span class="sxs-lookup"><span data-stu-id="ee818-139">Service Bus is a communication mechanism in the cloud that's accessible from pretty much anywhere.</span></span> <span data-ttu-id="ee818-140">Hur du använder den beror på vad dina appar behöver göra.</span><span class="sxs-lookup"><span data-stu-id="ee818-140">How you use it depends on what your applications need to do.</span></span>

## <a name="queues"></a><span data-ttu-id="ee818-141">Köer</span><span class="sxs-lookup"><span data-stu-id="ee818-141">Queues</span></span>

<span data-ttu-id="ee818-142">Anta att du bestämmer dig för att ansluta två appar med hjälp av en Service Bus-kö.</span><span class="sxs-lookup"><span data-stu-id="ee818-142">Suppose you decide to connect two applications using a Service Bus queue.</span></span> <span data-ttu-id="ee818-143">Bild 2 visar den här situationen.</span><span class="sxs-lookup"><span data-stu-id="ee818-143">Figure 2 illustrates this situation.</span></span>

![][2]

<span data-ttu-id="ee818-144">**Bild 2: Service Bus-köer erbjuder enkelriktade asynkrona köer.**</span><span class="sxs-lookup"><span data-stu-id="ee818-144">**Figure 2: Service Bus queues provide one-way asynchronous queuing.**</span></span>

<span data-ttu-id="ee818-145">Processen är enkel: En avsändare skickar ett meddelande till en Service Bus-kö och en mottagare hämtar meddelandet vid ett senare tillfälle.</span><span class="sxs-lookup"><span data-stu-id="ee818-145">The process is simple: A sender sends a message to a Service Bus queue, and a receiver picks up that message at some later time.</span></span> <span data-ttu-id="ee818-146">En kö kan ha bara en enkel mottagare, som bild 2 visar.</span><span class="sxs-lookup"><span data-stu-id="ee818-146">A queue can have just a single receiver, as Figure 2 shows.</span></span> <span data-ttu-id="ee818-147">Eller så kan flera program läsa från samma kö.</span><span class="sxs-lookup"><span data-stu-id="ee818-147">Or, multiple applications can read from the same queue.</span></span> <span data-ttu-id="ee818-148">I det senare fallet läses varje meddelande av enbart en mottagare.</span><span class="sxs-lookup"><span data-stu-id="ee818-148">In the latter situation, each message is read by just one receiver.</span></span> <span data-ttu-id="ee818-149">För en tjänst med multi-cast bör du istället använda ett ämne.</span><span class="sxs-lookup"><span data-stu-id="ee818-149">For a multi-cast service, you should use a topic instead.</span></span>

<span data-ttu-id="ee818-150">Varje meddelande består av två delar: en uppsättning egenskaper, som alla är ett nyckel-/värdepar, och en meddelandenyttolast.</span><span class="sxs-lookup"><span data-stu-id="ee818-150">Each message has two parts: a set of properties, each a key/value pair, and a message payload.</span></span> <span data-ttu-id="ee818-151">Nyttolasten kan vara binär, text eller till och med XML.</span><span class="sxs-lookup"><span data-stu-id="ee818-151">The payload can be binary, text, or even XML.</span></span> <span data-ttu-id="ee818-152">Hur de används beror på vad en app försöker utföra.</span><span class="sxs-lookup"><span data-stu-id="ee818-152">How they're used depends on what an application is trying to do.</span></span> <span data-ttu-id="ee818-153">Ett exempel: Ett program som skickar ett meddelande om en nyligen genomförd försäljning kan innehålla egenskaperna **Säljare="Ava"** och **Belopp= 10000**.</span><span class="sxs-lookup"><span data-stu-id="ee818-153">For example, an application sending a message about a recent sale might include the properties **Seller="Ava"** and **Amount=10000**.</span></span> <span data-ttu-id="ee818-154">Meddelandetexten (brödtexten) kan innehålla en skannad bild av försäljningsavtalet, eller om det inte finns något sådant, bara vara tomt.</span><span class="sxs-lookup"><span data-stu-id="ee818-154">The message body might contain a scanned image of the sale's signed contract or, if there isn't one, remain empty.</span></span>

<span data-ttu-id="ee818-155">En mottagare kan läsa ett meddelande från en Service Bus-kö på två olika sätt.</span><span class="sxs-lookup"><span data-stu-id="ee818-155">A receiver can read a message from a Service Bus queue in two different ways.</span></span> <span data-ttu-id="ee818-156">Det första alternativet, som kallas *[ReceiveAndDelete](/dotnet/api/microsoft.servicebus.messaging.receivemode)*, tar bort meddelandet från kön och raderar det direkt.</span><span class="sxs-lookup"><span data-stu-id="ee818-156">The first option, called *[ReceiveAndDelete](/dotnet/api/microsoft.servicebus.messaging.receivemode)*, removes a message from the queue and immediately deletes it.</span></span> <span data-ttu-id="ee818-157">Detta är ett enkelt alternativ men om mottagaren kraschar innan den har slutfört behandlingen av meddelandet så kommer det att gå förlorat.</span><span class="sxs-lookup"><span data-stu-id="ee818-157">This option is simple, but if the receiver crashes before it finishes processing the message, the message is lost.</span></span> <span data-ttu-id="ee818-158">Eftersom det har tagits bort från kön kan inga andra mottagare komma åt det.</span><span class="sxs-lookup"><span data-stu-id="ee818-158">Because it's been removed from the queue, no other receiver can access it.</span></span> 

<span data-ttu-id="ee818-159">Det andra alternativet, *[PeekLock](/dotnet/api/microsoft.servicebus.messaging.receivemode)*, är utformat för att lösa detta problem.</span><span class="sxs-lookup"><span data-stu-id="ee818-159">The second option, *[PeekLock](/dotnet/api/microsoft.servicebus.messaging.receivemode)*, is meant to help with this problem.</span></span> <span data-ttu-id="ee818-160">Precis som **ReceiveAndDelete**, tar **PeekLock** bort meddelandet från kön.</span><span class="sxs-lookup"><span data-stu-id="ee818-160">Like **ReceiveAndDelete**, a **PeekLock** read removes a message from the queue.</span></span> <span data-ttu-id="ee818-161">Men det raderar inte meddelandet.</span><span class="sxs-lookup"><span data-stu-id="ee818-161">It doesn't delete the message, however.</span></span> <span data-ttu-id="ee818-162">I stället låser det meddelandet, vilket gör det osynligt för andra mottagare, och sedan inväntar alternativet en av följande tre händelser:</span><span class="sxs-lookup"><span data-stu-id="ee818-162">Instead, it locks the message, making it invisible to other receivers, then waits for one of three events:</span></span>

* <span data-ttu-id="ee818-163">Om mottagaren kan bearbeta meddelandet anropas [Complete()](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Complete) och meddelandet tas bort i kön.</span><span class="sxs-lookup"><span data-stu-id="ee818-163">If the receiver processes the message successfully, it calls [Complete()](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Complete), and the queue deletes the message.</span></span> 
* <span data-ttu-id="ee818-164">Om mottagaren inte kan bearbeta meddelandet på rätt sätt anropas [Abandon()](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Abandon).</span><span class="sxs-lookup"><span data-stu-id="ee818-164">If the receiver decides that it can't process the message successfully, it calls [Abandon()](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Abandon).</span></span> <span data-ttu-id="ee818-165">Kön tar bort spärren från meddelandet och gör det tillgängligt för andra mottagare.</span><span class="sxs-lookup"><span data-stu-id="ee818-165">The queue then removes the lock from the message and makes it available to other receivers.</span></span>
* <span data-ttu-id="ee818-166">Om mottagaren inte anropar något av dessa metoder inom en konfigurerbar tidsperiod (standardvärdet är 60 sekunder), förutsätter kön att mottagaren har misslyckats.</span><span class="sxs-lookup"><span data-stu-id="ee818-166">If the receiver calls neither of these methods within a configurable period of time (by default, 60 seconds), the queue assumes the receiver has failed.</span></span> <span data-ttu-id="ee818-167">I det här fallet reagerar den som om mottagaren hade anropat **Avbryt** och gör meddelandet tillgängligt för andra mottagare.</span><span class="sxs-lookup"><span data-stu-id="ee818-167">In this case, it behaves as if the receiver had called **Abandon**, making the message available to other receivers.</span></span>

<span data-ttu-id="ee818-168">Observera vad som kan inträffa här: samma meddelande kan levereras två gånger, kanske till två olika mottagare.</span><span class="sxs-lookup"><span data-stu-id="ee818-168">Notice what can happen here: the same message might be delivered twice, perhaps to two different receivers.</span></span> <span data-ttu-id="ee818-169">Appar som använder Service Bus-köer måste förberedas för denna händelse.</span><span class="sxs-lookup"><span data-stu-id="ee818-169">Applications using Service Bus queues must be prepared for this event.</span></span> <span data-ttu-id="ee818-170">För att förenkla identifiering av dubbletter har varje meddelande en unik [MessageID](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_MessageId)-egenskap. Denna är som standard alltid densamma, oavsett hur många gånger meddelandet har lästs från en kö.</span><span class="sxs-lookup"><span data-stu-id="ee818-170">To make duplicate detection easier, each message has a unique [MessageID](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_MessageId) property that by default stays the same no matter how many times the message is read from a queue.</span></span> 

<span data-ttu-id="ee818-171">Köer är användbara i ett ganska stort antal situationer.</span><span class="sxs-lookup"><span data-stu-id="ee818-171">Queues are useful in quite a few situations.</span></span> <span data-ttu-id="ee818-172">De gör att appar kan kommunicera även när båda inte körs på samma gång, något som är särskilt praktiskt med batch- och mobilappar.</span><span class="sxs-lookup"><span data-stu-id="ee818-172">They enable applications to communicate even when both aren't running at the same time, something that's especially handy with batch and mobile applications.</span></span> <span data-ttu-id="ee818-173">En kö med flera mottagare ger också automatisk belastningsbalansering eftersom skickade meddelanden sprids ut bland dessa mottagare.</span><span class="sxs-lookup"><span data-stu-id="ee818-173">A queue with multiple receivers also provides automatic load balancing, since sent messages are spread across these receivers.</span></span>

## <a name="topics"></a><span data-ttu-id="ee818-174">Ämnen</span><span class="sxs-lookup"><span data-stu-id="ee818-174">Topics</span></span>

<span data-ttu-id="ee818-175">Även om köer ofta är väldigt användbara, är de inte alltid den rätta lösningen.</span><span class="sxs-lookup"><span data-stu-id="ee818-175">Useful as they are, queues aren't always the right solution.</span></span> <span data-ttu-id="ee818-176">Ibland är det bättre att använda Service Bus-ämnen.</span><span class="sxs-lookup"><span data-stu-id="ee818-176">Sometimes, Service Bus topics are better.</span></span> <span data-ttu-id="ee818-177">Bild 3 ger dig en uppfattning om varför det är så.</span><span class="sxs-lookup"><span data-stu-id="ee818-177">Figure 3 illustrates this idea.</span></span>

![][3]

<span data-ttu-id="ee818-178">**Bild 3: Baserat på de filter ett prenumererande program specificerar så kan det ta emot en del eller alla meddelanden som skickats till ett Service Bus-ämne.**</span><span class="sxs-lookup"><span data-stu-id="ee818-178">**Figure 3: Based on the filter a subscribing application specifies, it can receive some or all the messages sent to a Service Bus topic.**</span></span>

<span data-ttu-id="ee818-179">Ett *ämne* liknar på många sätt en kö.</span><span class="sxs-lookup"><span data-stu-id="ee818-179">A *topic* is similar in many ways to a queue.</span></span> <span data-ttu-id="ee818-180">Avsändare skickar meddelanden till ett ämne på samma sätt som de skickar meddelanden till en kö. Och dessa meddelanden ser likadana ut som när de används i köer.</span><span class="sxs-lookup"><span data-stu-id="ee818-180">Senders submit messages to a topic in the same way that they submit messages to a queue, and those messages look the same as with queues.</span></span> <span data-ttu-id="ee818-181">Skillnaden är att ämnen gör att varje mottagande app kan skapa sin egen *prenumeration* genom att definiera ett *filter*.</span><span class="sxs-lookup"><span data-stu-id="ee818-181">The difference is that topics enable each receiving application to create its own *subscription* by defining a *filter*.</span></span> <span data-ttu-id="ee818-182">Prenumeranten kommer därefter endast att se de meddelanden som matchar filtret.</span><span class="sxs-lookup"><span data-stu-id="ee818-182">A subscriber then sees only the messages that match that filter.</span></span> <span data-ttu-id="ee818-183">Bild 3 visar till exempel en avsändare och ett ämne med tre prenumeranter, var och en med sitt eget filter:</span><span class="sxs-lookup"><span data-stu-id="ee818-183">For example, Figure 3 shows a sender and a topic with three subscribers, each with its own filter:</span></span>

* <span data-ttu-id="ee818-184">Prenumerant 1 får endast meddelanden som innehåller egenskapen *Säljare="Ava"*.</span><span class="sxs-lookup"><span data-stu-id="ee818-184">Subscriber 1 receives only messages that contain the property *Seller="Ava"*.</span></span>
* <span data-ttu-id="ee818-185">Prenumerant 2 tar emot meddelanden som innehåller egenskapen *Säljare="Ruth"* och/eller innehåller en egenskap för *belopp* vars värde är större än 100 000.</span><span class="sxs-lookup"><span data-stu-id="ee818-185">Subscriber 2 receives messages that contain the property *Seller="Ruby"* and/or contain an *Amount* property whose value is greater than 100,000.</span></span> <span data-ttu-id="ee818-186">Ruth kanske är försäljningschef så hon vill se både sina egna försäljningar och alla stora försäljningar, oavsett vem som gör dem.</span><span class="sxs-lookup"><span data-stu-id="ee818-186">Perhaps Ruby is the sales manager, so she wants to see both her own sales and all large sales regardless of who makes them.</span></span>
* <span data-ttu-id="ee818-187">Prenumerant 3 har ställt in sitt filter på *Sant*, vilket innebär att han eller hon får alla meddelanden.</span><span class="sxs-lookup"><span data-stu-id="ee818-187">Subscriber 3 has set its filter to *True*, which means that it receives all messages.</span></span> <span data-ttu-id="ee818-188">Den här appen kan till exempel ansvara för att bibehålla ett revisionsspår och därför behöver den visa alla meddelanden.</span><span class="sxs-lookup"><span data-stu-id="ee818-188">For example, this application might be responsible for maintaining an audit trail and therefore it needs to see all the messages.</span></span>

<span data-ttu-id="ee818-189">På samma sätt som med köer kan de som prenumererar på ett ämne läsa meddelanden med antingen [ReceiveAndDelete eller PeekLock](/dotnet/api/microsoft.servicebus.messaging.receivemode).</span><span class="sxs-lookup"><span data-stu-id="ee818-189">As with queues, subscribers to a topic can read messages using either [ReceiveAndDelete or PeekLock](/dotnet/api/microsoft.servicebus.messaging.receivemode).</span></span> <span data-ttu-id="ee818-190">Men till skillnad från köer kan ett enskilt meddelande som skickas till ett ämne tas emot av flera prenumerationer.</span><span class="sxs-lookup"><span data-stu-id="ee818-190">Unlike queues, however, a single message sent to a topic can be received by multiple subscriptions.</span></span> <span data-ttu-id="ee818-191">Den här metoden, som ofta kallas *publicera och prenumerera*, (eller *pub/sub*) är användbar när flera appar är intresserade av samma meddelanden.</span><span class="sxs-lookup"><span data-stu-id="ee818-191">This approach, commonly called *publish and subscribe* (or *pub/sub*), is useful whenever multiple applications are interested in the same messages.</span></span> <span data-ttu-id="ee818-192">Genom att definiera rätt typ av filter kan varje prenumerant ta del av enbart den del av meddelandeströmmen som de behöver se.</span><span class="sxs-lookup"><span data-stu-id="ee818-192">By defining the right filter, each subscriber can tap into just the part of the message stream that it needs to see.</span></span>

## <a name="relays"></a><span data-ttu-id="ee818-193">Reläer</span><span class="sxs-lookup"><span data-stu-id="ee818-193">Relays</span></span>

<span data-ttu-id="ee818-194">Både köer och ämnen ger dig enkelriktad, asynkron kommunikation via en koordinator.</span><span class="sxs-lookup"><span data-stu-id="ee818-194">Both queues and topics provide one-way asynchronous communication through a broker.</span></span> <span data-ttu-id="ee818-195">Trafiken flödar endast i en riktning och det finns ingen direkt anslutning mellan avsändarna och mottagarna.</span><span class="sxs-lookup"><span data-stu-id="ee818-195">Traffic flows in just one direction, and there's no direct connection between senders and receivers.</span></span> <span data-ttu-id="ee818-196">Men vad händer om du inte vill använda denna anslutning?</span><span class="sxs-lookup"><span data-stu-id="ee818-196">But what if you don't want this connection?</span></span> <span data-ttu-id="ee818-197">Anta att dina appar både måste kunna skicka och ta emot meddelanden. Eller så kanske du vill ha en direktlänk mellan dem och du har inget behov av en koordinator för att lagra meddelanden.</span><span class="sxs-lookup"><span data-stu-id="ee818-197">Suppose your applications need to both send and receive messages, or perhaps you want a direct link between them and you don't need a broker to store messages.</span></span> <span data-ttu-id="ee818-198">För att kunna hantera scenarier som detta tillhandahåller Service Bus *reläer* (relays), som visas på bild 4.</span><span class="sxs-lookup"><span data-stu-id="ee818-198">To address scenarios such as this, Service Bus provides *relays*, as Figure 4 shows.</span></span>

![][4]

<span data-ttu-id="ee818-199">**Bild 4: Service Bus Relay erbjuder synkron, dubbelriktad kommunikation mellan program.**</span><span class="sxs-lookup"><span data-stu-id="ee818-199">**Figure 4: Service Bus relay provides synchronous, two-way communication between applications.**</span></span>

<span data-ttu-id="ee818-200">Den naturliga frågan när det gäller reläer är: varför bör jag använda ett relä?</span><span class="sxs-lookup"><span data-stu-id="ee818-200">The obvious question to ask about relays is this: why would I use one?</span></span> <span data-ttu-id="ee818-201">Även om jag inte behöver köer, varför göra så att appar kommunicerar via en molnbaserad tjänst i stället för att helt enkelt interagera direkt med varandra?</span><span class="sxs-lookup"><span data-stu-id="ee818-201">Even if I don't need queues, why make applications communicate via a cloud service rather than just interact directly?</span></span> <span data-ttu-id="ee818-202">Svaret är att det här med att prata direkt med varandra kan vara svårare än du tror.</span><span class="sxs-lookup"><span data-stu-id="ee818-202">The answer is that talking directly can be harder than you might think.</span></span>

<span data-ttu-id="ee818-203">Anta att du vill ansluta två lokala appar. Båda körs på företagets eget datacenter.</span><span class="sxs-lookup"><span data-stu-id="ee818-203">Suppose you want to connect two on-premises applications, both running inside corporate datacenters.</span></span> <span data-ttu-id="ee818-204">Var och en av dessa appar ligger bakom en brandvägg och varje datacenter använder antagligen nätadressöversättning (NAT).</span><span class="sxs-lookup"><span data-stu-id="ee818-204">Each of these applications sits behind a firewall, and each datacenter probably uses network address translation (NAT).</span></span> <span data-ttu-id="ee818-205">Brandväggen blockerar inkommande data på i princip alla portar och NAT-användningen antyder att datorerna där apparna körs inte har en fast IP-adress som gör att du kan nå dem direkt från en plats utanför datacentret.</span><span class="sxs-lookup"><span data-stu-id="ee818-205">The firewall blocks incoming data on all but a few ports, and NAT implies that the machine each application is running on doesn't have a fixed IP address that you can reach directly from outside the datacenter.</span></span> <span data-ttu-id="ee818-206">Utan extra hjälp är det problematiskt att ansluta dessa appar till varandra med hjälp av en offentlig internetanslutning.</span><span class="sxs-lookup"><span data-stu-id="ee818-206">Without some extra help, connecting these applications over the public internet is problematic.</span></span>

<span data-ttu-id="ee818-207">Det kan hjälpa att använda ett Service Bus-relä.</span><span class="sxs-lookup"><span data-stu-id="ee818-207">A Service Bus relay can help.</span></span> <span data-ttu-id="ee818-208">För att kommunicera i båda riktningarna via ett relä, upprättar varje app en utgående TCP-anslutning med Service Bus och håller den sedan öppen.</span><span class="sxs-lookup"><span data-stu-id="ee818-208">To communicate bi-directionally through a relay, each application establishes an outbound TCP connection with Service Bus, then keeps it open.</span></span> <span data-ttu-id="ee818-209">All kommunikation mellan de två apparna överförs via dessa anslutningar.</span><span class="sxs-lookup"><span data-stu-id="ee818-209">All communication between the two applications travels over these connections.</span></span> <span data-ttu-id="ee818-210">Eftersom varje anslutning har upprättats inifrån datacentret tillåter brandväggen inkommande trafik till varje app utan att öppna nya portar.</span><span class="sxs-lookup"><span data-stu-id="ee818-210">Because each connection was established from inside the datacenter, the firewall allows incoming traffic to each application without opening new ports.</span></span> <span data-ttu-id="ee818-211">Med hjälp av den här metoden kringgår du också problemet med NAT eftersom varje app har en konsistent slutpunkt i molnet under hela kommunikationen.</span><span class="sxs-lookup"><span data-stu-id="ee818-211">This approach also gets around the NAT problem, because each application has a consistent endpoint in the cloud throughout the communication.</span></span> <span data-ttu-id="ee818-212">Genom att utföra utbyte av data via reläet kan apparna undvika problem som annars skulle ha försvårat kommunikationen.</span><span class="sxs-lookup"><span data-stu-id="ee818-212">By exchanging data through the relay, the applications can avoid the problems that would otherwise make communication difficult.</span></span> 

<span data-ttu-id="ee818-213">För att kunna använda Service Bus Relays stöder sig apparna på Windows Communication Foundation (WCF).</span><span class="sxs-lookup"><span data-stu-id="ee818-213">To use Service Bus relays, applications rely on the Windows Communication Foundation (WCF).</span></span> <span data-ttu-id="ee818-214">Service Bus ger dig WCF-bindningar som gör det enkelt för Windows-program att interagera via reläer.</span><span class="sxs-lookup"><span data-stu-id="ee818-214">Service Bus provides WCF bindings that make it straightforward for Windows applications to interact via relays.</span></span> <span data-ttu-id="ee818-215">Program som redan använder WCF behöver normalt bara ange en av dessa bindningar och sedan kan de kommunicera med varandra via ett relä.</span><span class="sxs-lookup"><span data-stu-id="ee818-215">Applications that already use WCF can typically specify one of these bindings, then talk to each other through a relay.</span></span> <span data-ttu-id="ee818-216">Men till skillnad från köer och ämnen kräver användningen av reläer från andra program än Windows-program en hel del programmeringsarbete, även om det går att genomföra. Det medföljer inga standardbibliotek.</span><span class="sxs-lookup"><span data-stu-id="ee818-216">Unlike queues and topics, however, using relays from non-Windows applications, while possible, requires some programming effort; no standard libraries are provided.</span></span>

<span data-ttu-id="ee818-217">Till skillnad från köer och ämnen skapar apparna inga reläer rent uttryckligen.</span><span class="sxs-lookup"><span data-stu-id="ee818-217">Unlike queues and topics, applications don't explicitly create relays.</span></span> <span data-ttu-id="ee818-218">När en app som du vill ta emot meddelanden med upprättar en TCP-anslutning med Service Bus, skapas istället ett relä automatiskt.</span><span class="sxs-lookup"><span data-stu-id="ee818-218">Instead, when an application that wishes to receive messages establishes a TCP connection with Service Bus, a relay is created automatically.</span></span> <span data-ttu-id="ee818-219">När anslutningen avbryts tas reläet bort.</span><span class="sxs-lookup"><span data-stu-id="ee818-219">When the connection is dropped, the relay is deleted.</span></span> <span data-ttu-id="ee818-220">Om du vill aktivera en app för att hitta det relä som skapats av en viss lyssnare, innehåller Service Bus ett register som gör det möjligt för appar att söka efter ett visst relä. Sökningen görs efter namn.</span><span class="sxs-lookup"><span data-stu-id="ee818-220">To enable an application to find the relay created by a specific listener, Service Bus provides a registry that enables applications to locate a specific relay by name.</span></span>

<span data-ttu-id="ee818-221">Reläer är den rätta lösningen när du behöver upprätta direkt kommunikation mellan program.</span><span class="sxs-lookup"><span data-stu-id="ee818-221">Relays are the right solution when you need direct communication between applications.</span></span> <span data-ttu-id="ee818-222">Föreställ dig till exempel ett bokningssystem från ett flygbolag som körs i ett lokalt datacenter. Detta måste kunna nås från incheckningskiosker, mobila enheter och andra datorer.</span><span class="sxs-lookup"><span data-stu-id="ee818-222">For example, consider an airline reservation system running in an on-premises datacenter that must be accessed from check-in kiosks, mobile devices, and other computers.</span></span> <span data-ttu-id="ee818-223">Program som körs på alla dessa system kan förlita sig på Service Bus Relays i molnet för att kommunicera med varandra, oavsett var de körs.</span><span class="sxs-lookup"><span data-stu-id="ee818-223">Applications running on all these systems could rely on Service Bus relays in the cloud to communicate, wherever they might be running.</span></span>

## <a name="summary"></a><span data-ttu-id="ee818-224">Sammanfattning</span><span class="sxs-lookup"><span data-stu-id="ee818-224">Summary</span></span>

<span data-ttu-id="ee818-225">Att ansluta program har alltid varit en del av arbetet när man skapar kompletta lösningar. Mängden scenarier som dyker upp och kräver att program och tjänster ska kunna kommunicera med varandra kommer med all säkerhet att öka eftersom fler och fler program och enheter ansluts till internet.</span><span class="sxs-lookup"><span data-stu-id="ee818-225">Connecting applications has always been part of building complete solutions, and the range of scenarios that require applications and services to communicate with each other is set to increase as more applications and devices are connected to the internet.</span></span> <span data-ttu-id="ee818-226">Syftet med Service Bus är att göra denna absolut nödvändiga funktion enklare att implementera och se till att tekniken blir mer tillgänglig, genom att tillhandahålla molnbaserad teknik och använda köer, ämnen och reläer.</span><span class="sxs-lookup"><span data-stu-id="ee818-226">By providing cloud-based technologies for achieving communication through queues, topics, and relays, Service Bus aims to make this essential function easier to implement and more broadly available.</span></span>

## <a name="next-steps"></a><span data-ttu-id="ee818-227">Nästa steg</span><span class="sxs-lookup"><span data-stu-id="ee818-227">Next steps</span></span>

<span data-ttu-id="ee818-228">Nu när du har lärt dig grunderna om Azure Service Bus, kan du följa dessa länkar om du vill veta mer.</span><span class="sxs-lookup"><span data-stu-id="ee818-228">Now that you've learned the fundamentals of Azure Service Bus, follow these links to learn more.</span></span>

* <span data-ttu-id="ee818-229">Använda [Service Bus-köer](service-bus-dotnet-get-started-with-queues.md)</span><span class="sxs-lookup"><span data-stu-id="ee818-229">How to use [Service Bus queues](service-bus-dotnet-get-started-with-queues.md)</span></span>
* <span data-ttu-id="ee818-230">Använda [Service Bus-ämnen](service-bus-dotnet-how-to-use-topics-subscriptions.md)</span><span class="sxs-lookup"><span data-stu-id="ee818-230">How to use [Service Bus topics](service-bus-dotnet-how-to-use-topics-subscriptions.md)</span></span>
* <span data-ttu-id="ee818-231">Använda [Service Bus-reläer](../service-bus-relay/service-bus-dotnet-how-to-use-relay.md)</span><span class="sxs-lookup"><span data-stu-id="ee818-231">How to use [Service Bus relay](../service-bus-relay/service-bus-dotnet-how-to-use-relay.md)</span></span>
* [<span data-ttu-id="ee818-232">Service Bus-exempel</span><span class="sxs-lookup"><span data-stu-id="ee818-232">Service Bus samples</span></span>](service-bus-samples.md)

[1]: ./media/service-bus-fundamentals-hybrid-solutions/SvcBus_01_architecture.png
[2]: ./media/service-bus-fundamentals-hybrid-solutions/SvcBus_02_queues.png
[3]: ./media/service-bus-fundamentals-hybrid-solutions/SvcBus_03_topicsandsubscriptions.png
[4]: ./media/service-bus-fundamentals-hybrid-solutions/SvcBus_04_relay.png
