---
title: "aaaCreate partitionerad Azure Service Bus-köer och ämnen | Microsoft Docs"
description: "Beskriver hur toopartition Service Bus-köer och ämnen med hjälp av flera meddelandet förmedlar."
services: service-bus-messaging
documentationcenter: na
author: sethmanheim
manager: timlt
editor: 
ms.assetid: a0c7d5a2-4876-42cb-8344-a1fc988746e7
ms.service: service-bus-messaging
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 08/07/2017
ms.author: sethm;hillaryc
ms.openlocfilehash: 6d42556a0714d6a012dc319f662521c8b0bb958b
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 10/06/2017
---
# <a name="partitioned-queues-and-topics"></a><span data-ttu-id="a5311-103">Partitionerade köer och ämnen</span><span class="sxs-lookup"><span data-stu-id="a5311-103">Partitioned queues and topics</span></span>
<span data-ttu-id="a5311-104">Azure Service Bus använder flera mäklare tooprocess meddelanden och meddelanden till flera lagrar toostore meddelanden.</span><span class="sxs-lookup"><span data-stu-id="a5311-104">Azure Service Bus employs multiple message brokers tooprocess messages and multiple messaging stores toostore messages.</span></span> <span data-ttu-id="a5311-105">En vanlig kö eller ett ämne hanteras av en enda meddelande broker och lagras i ett meddelandearkiv.</span><span class="sxs-lookup"><span data-stu-id="a5311-105">A conventional queue or topic is handled by a single message broker and stored in one messaging store.</span></span> <span data-ttu-id="a5311-106">Service Bus *partitioner* aktivera köer och ämnen, eller *meddelandeentiteter*, toobe partitionerad över flera meddelandet mäklare och meddelandearkiv.</span><span class="sxs-lookup"><span data-stu-id="a5311-106">Service Bus *partitions* enable queues and topics, or *messaging entities*, toobe partitioned across multiple message brokers and messaging stores.</span></span> <span data-ttu-id="a5311-107">Detta innebär att hello totala genomflödet av en partitionerad entitet begränsas inte längre av hello prestanda för ett enda meddelande broker eller meddelandearkiv.</span><span class="sxs-lookup"><span data-stu-id="a5311-107">This means that hello overall throughput of a partitioned entity is no longer limited by hello performance of a single message broker or messaging store.</span></span> <span data-ttu-id="a5311-108">Dessutom kan återges ett tillfälligt avbrott i ett meddelandearkiv inte en partitionerad kö eller ett ämne inte tillgänglig.</span><span class="sxs-lookup"><span data-stu-id="a5311-108">In addition, a temporary outage of a messaging store does not render a partitioned queue or topic unavailable.</span></span> <span data-ttu-id="a5311-109">Partitionerade köer och ämnen kan innehålla alla avancerade Service Bus-funktioner, till exempel stöd för transaktioner och sessioner.</span><span class="sxs-lookup"><span data-stu-id="a5311-109">Partitioned queues and topics can contain all advanced Service Bus features, such as support for transactions and sessions.</span></span>

<span data-ttu-id="a5311-110">Information om Service Bus internals finns hello [Service Bus-arkitektur] [ Service Bus architecture] artikel.</span><span class="sxs-lookup"><span data-stu-id="a5311-110">For information about Service Bus internals, see hello [Service Bus architecture][Service Bus architecture] article.</span></span>

<span data-ttu-id="a5311-111">Partitionering är aktiverad som standard när entiteten skapas på alla köer och ämnen i både Standard- och Premium-meddelanden.</span><span class="sxs-lookup"><span data-stu-id="a5311-111">Partitioning is enabled by default at entity creation on all queues and topics in both Standard and Premium messaging.</span></span> <span data-ttu-id="a5311-112">Du kan skapa Standard meddelandeentiteter nivå utan partitionering, men köer och ämnen i ett Premium-namnområde partitioneras alltid; Det här alternativet kan inte inaktiveras.</span><span class="sxs-lookup"><span data-stu-id="a5311-112">You can create Standard messaging tier entities without partitioning, but queues and topics in a Premium namespace are always partitioned; this option cannot be disabled.</span></span> 

<span data-ttu-id="a5311-113">Det är inte möjligt toochange hello alternativet på en befintlig kö eller i nivåerna Standard eller Premium-partitionering, kan du bara ange hello alternativ när du skapar hello entitet.</span><span class="sxs-lookup"><span data-stu-id="a5311-113">It is not possible toochange hello partitioning option on an existing queue or topic in either Standard or Premium tiers, you can only set hello option when you create hello entity.</span></span>

## <a name="how-it-works"></a><span data-ttu-id="a5311-114">Hur det fungerar</span><span class="sxs-lookup"><span data-stu-id="a5311-114">How it works</span></span>

<span data-ttu-id="a5311-115">Varje partitionerade kö eller ett ämne består av flera fragment.</span><span class="sxs-lookup"><span data-stu-id="a5311-115">Each partitioned queue or topic consists of multiple fragments.</span></span> <span data-ttu-id="a5311-116">Varje fragment lagras i en annan meddelandearkiv och hanteras av ett annat meddelande broker.</span><span class="sxs-lookup"><span data-stu-id="a5311-116">Each fragment is stored in a different messaging store and handled by a different message broker.</span></span> <span data-ttu-id="a5311-117">När ett meddelande skickas tooa partitionerade kö eller ett ämne, tilldelar Service Bus hello-meddelande tooone av hello-fragment.</span><span class="sxs-lookup"><span data-stu-id="a5311-117">When a message is sent tooa partitioned queue or topic, Service Bus assigns hello message tooone of hello fragments.</span></span> <span data-ttu-id="a5311-118">hello val görs slumpmässigt Service Bus eller med hjälp av en partitionsnyckel som hello avsändaren kan ange.</span><span class="sxs-lookup"><span data-stu-id="a5311-118">hello selection is done randomly by Service Bus or by using a partition key that hello sender can specify.</span></span>

<span data-ttu-id="a5311-119">När en klient vill tooreceive ett meddelande från en partitionerad kö eller en prenumeration tooa partitionerade artikeln, Service Bus frågar alla fragment för meddelanden, returnerar du första hello-meddelande som hämtas från någon av hello meddelanden lagrar toohello mottagare.</span><span class="sxs-lookup"><span data-stu-id="a5311-119">When a client wants tooreceive a message from a partitioned queue, or from a subscription tooa partitioned topic, Service Bus queries all fragments for messages, then returns hello first message that is obtained from any of hello messaging stores toohello receiver.</span></span> <span data-ttu-id="a5311-120">Service Bus cacheminnen hello andra meddelanden och returnerar dem när den tar emot ytterligare ta emot begäranden.</span><span class="sxs-lookup"><span data-stu-id="a5311-120">Service Bus caches hello other messages and returns them when it receives additional receive requests.</span></span> <span data-ttu-id="a5311-121">En mottagande klienten är inte medveten om hello partitionering; Hej klientriktade beteendet för en partitionerad kö eller ett ämne (till exempel läsa, slutföra, skjuta upp systemkön, förhämtar) är identiska toohello beteendet för en vanlig entitet.</span><span class="sxs-lookup"><span data-stu-id="a5311-121">A receiving client is not aware of hello partitioning; hello client-facing behavior of a partitioned queue or topic (for example, read, complete, defer, deadletter, prefetching) is identical toohello behavior of a regular entity.</span></span>

<span data-ttu-id="a5311-122">Det finns inga extra kostnad när de skickar ett meddelande till eller ta emot ett meddelande från en partitionerad kö eller ett ämne.</span><span class="sxs-lookup"><span data-stu-id="a5311-122">There is no additional cost when sending a message to, or receiving a message from, a partitioned queue or topic.</span></span>

## <a name="enable-partitioning"></a><span data-ttu-id="a5311-123">Aktivera partitionering</span><span class="sxs-lookup"><span data-stu-id="a5311-123">Enable partitioning</span></span>

<span data-ttu-id="a5311-124">toouse partitionerad köer och ämnen med Azure Service Bus använder hello Azure SDK version 2.2 eller senare, eller ange `api-version=2013-10` i HTTP-begäranden.</span><span class="sxs-lookup"><span data-stu-id="a5311-124">toouse partitioned queues and topics with Azure Service Bus, use hello Azure SDK version 2.2 or later, or specify `api-version=2013-10` in your HTTP requests.</span></span>

### <a name="standard"></a><span data-ttu-id="a5311-125">Standard</span><span class="sxs-lookup"><span data-stu-id="a5311-125">Standard</span></span>

<span data-ttu-id="a5311-126">I hello meddelanden standardnivån, kan du skapa Service Bus-köer och ämnen i 1, 2, 3, 4 och 5 GB storlekar (hello standardvärdet är 1 GB).</span><span class="sxs-lookup"><span data-stu-id="a5311-126">In hello Standard messaging tier, you can create Service Bus queues and topics in 1, 2, 3, 4, or 5 GB sizes (hello default is 1 GB).</span></span> <span data-ttu-id="a5311-127">Med partitionering aktiverats, skapar Service Bus 16 kopior (16 partitioner) för hello entitet för varje GB som du anger.</span><span class="sxs-lookup"><span data-stu-id="a5311-127">With partitioning enabled, Service Bus creates 16 copies (16 partitions) of hello entity for each GB you specify.</span></span> <span data-ttu-id="a5311-128">Så om du skapar en kö är 5 GB i storlek med 16 partitioner hello största köstorlek blir (5 \* 16) = 80 GB.</span><span class="sxs-lookup"><span data-stu-id="a5311-128">As such, if you create a queue that's 5 GB in size, with 16 partitions hello maximum queue size becomes (5 \* 16) = 80 GB.</span></span> <span data-ttu-id="a5311-129">Du kan se hello maximal storlek för din partitionerade kö eller ett ämne genom att titta på posten på hello [Azure-portalen][Azure portal], i hello **översikt** bladet för den enheten.</span><span class="sxs-lookup"><span data-stu-id="a5311-129">You can see hello maximum size of your partitioned queue or topic by looking at its entry on hello [Azure portal][Azure portal], in hello **Overview** blade for that entity.</span></span>

### <a name="premium"></a><span data-ttu-id="a5311-130">Premium</span><span class="sxs-lookup"><span data-stu-id="a5311-130">Premium</span></span>

<span data-ttu-id="a5311-131">I ett namnområde för Premium-nivån, kan du skapa Service Bus-köer och ämnen i 1, 2, 3, 4, 5, 10, 20, 40 eller 80 GB storlekar (hello standardvärdet är 1 GB).</span><span class="sxs-lookup"><span data-stu-id="a5311-131">In a Premium tier namespace, you can create Service Bus queues and topics in 1, 2, 3, 4, 5, 10, 20, 40, or 80 GB sizes (hello default is 1 GB).</span></span> <span data-ttu-id="a5311-132">Med partitionering aktiverad som standard skapar Service Bus två partitioner per enhet.</span><span class="sxs-lookup"><span data-stu-id="a5311-132">With partitioning enabled by default, Service Bus creates two partitions per entity.</span></span> <span data-ttu-id="a5311-133">Du kan se hello maximal storlek för din partitionerade kö eller ett ämne genom att titta på posten på hello [Azure-portalen][Azure portal], i hello **översikt** bladet för den enheten.</span><span class="sxs-lookup"><span data-stu-id="a5311-133">You can see hello maximum size of your partitioned queue or topic by looking at its entry on hello [Azure portal][Azure portal], in hello **Overview** blade for that entity.</span></span>

<span data-ttu-id="a5311-134">Mer information om partitionering i hello Premium messaging-nivån finns [Service Bus Premium- och Standard-meddelandenivåer](service-bus-premium-messaging.md).</span><span class="sxs-lookup"><span data-stu-id="a5311-134">For more information about partitioning in hello Premium messaging tier, see [Service Bus Premium and Standard messaging tiers](service-bus-premium-messaging.md).</span></span> 

### <a name="create-a-partitioned-entity"></a><span data-ttu-id="a5311-135">Skapa en partitionerad entitet</span><span class="sxs-lookup"><span data-stu-id="a5311-135">Create a partitioned entity</span></span>

<span data-ttu-id="a5311-136">Det finns flera sätt toocreate en partitionerad kö eller ett ämne.</span><span class="sxs-lookup"><span data-stu-id="a5311-136">There are several ways toocreate a partitioned queue or topic.</span></span> <span data-ttu-id="a5311-137">När du skapar hello kö eller ett ämne från ditt program måste du aktivera partitionering för hello kö eller ett ämne med respektive inställningen hello [QueueDescription.EnablePartitioning] [ QueueDescription.EnablePartitioning] eller [TopicDescription.EnablePartitioning] [ TopicDescription.EnablePartitioning] egenskapen för**SANT**.</span><span class="sxs-lookup"><span data-stu-id="a5311-137">When you create hello queue or topic from your application, you can enable partitioning for hello queue or topic by respectively setting hello [QueueDescription.EnablePartitioning][QueueDescription.EnablePartitioning] or [TopicDescription.EnablePartitioning][TopicDescription.EnablePartitioning] property too**true**.</span></span> <span data-ttu-id="a5311-138">Dessa egenskaper måste anges vid hello tid hello kön eller avsnittet skapas.</span><span class="sxs-lookup"><span data-stu-id="a5311-138">These properties must be set at hello time hello queue or topic is created.</span></span> <span data-ttu-id="a5311-139">Som nämnts tidigare anger är det inte möjligt toochange dessa egenskaper för en befintlig kö eller ett ämne.</span><span class="sxs-lookup"><span data-stu-id="a5311-139">As stated previously, it is not possible toochange these properties on an existing queue or topic.</span></span> <span data-ttu-id="a5311-140">Exempel:</span><span class="sxs-lookup"><span data-stu-id="a5311-140">For example:</span></span>

```csharp
// Create partitioned topic
NamespaceManager ns = NamespaceManager.CreateFromConnectionString(myConnectionString);
TopicDescription td = new TopicDescription(TopicName);
td.EnablePartitioning = true;
ns.CreateTopic(td);
```

<span data-ttu-id="a5311-141">Du kan också skapa en partitionerad kö eller ett ämne i hello [Azure-portalen] [ Azure portal] eller i Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="a5311-141">Alternatively, you can create a partitioned queue or topic in hello [Azure portal][Azure portal] or in Visual Studio.</span></span> <span data-ttu-id="a5311-142">När du skapar en kö eller ett ämne i hello portal hello **aktivera partitionering** alternativ i hello kö eller ett ämne **skapa** bladet är markerad som standard.</span><span class="sxs-lookup"><span data-stu-id="a5311-142">When you create a queue or topic in hello portal, hello **Enable partitioning** option in hello queue or topic **Create** blade is checked by default.</span></span> <span data-ttu-id="a5311-143">Du kan bara inaktivera det här alternativet i en standardnivån enheten. i hello är Premium nivå partitionering alltid aktiverat.</span><span class="sxs-lookup"><span data-stu-id="a5311-143">You can only disable this option in a Standard tier entity; in hello Premium tier partitioning is always enabled.</span></span> <span data-ttu-id="a5311-144">I Visual Studio klickar du på hello **aktivera partitionering** kryssrutan i hello **ny kö** eller **ny artikel** dialogrutan.</span><span class="sxs-lookup"><span data-stu-id="a5311-144">In Visual Studio, click hello **Enable Partitioning** checkbox in hello **New Queue** or **New Topic** dialog box.</span></span>

## <a name="use-of-partition-keys"></a><span data-ttu-id="a5311-145">Användning av partitionsnycklar</span><span class="sxs-lookup"><span data-stu-id="a5311-145">Use of partition keys</span></span>
<span data-ttu-id="a5311-146">När ett meddelande är i kö i en partitionerad kö eller ett ämne, kontrollerar Service Bus hello förekomsten av en partitionsnyckel.</span><span class="sxs-lookup"><span data-stu-id="a5311-146">When a message is enqueued into a partitioned queue or topic, Service Bus checks for hello presence of a partition key.</span></span> <span data-ttu-id="a5311-147">Om den hittar en väljs hello fragment baserat på nyckeln.</span><span class="sxs-lookup"><span data-stu-id="a5311-147">If it finds one, it selects hello fragment based on that key.</span></span> <span data-ttu-id="a5311-148">Om det inte hittar en partitionsnyckel, väljs hello fragment baserat på en intern algoritm.</span><span class="sxs-lookup"><span data-stu-id="a5311-148">If it does not find a partition key, it selects hello fragment based on an internal algorithm.</span></span>

### <a name="using-a-partition-key"></a><span data-ttu-id="a5311-149">Med hjälp av en partitionsnyckel</span><span class="sxs-lookup"><span data-stu-id="a5311-149">Using a partition key</span></span>
<span data-ttu-id="a5311-150">Vissa scenarier, till exempel sessioner eller transaktioner, kräver meddelanden toobe lagras i en specifik fragment.</span><span class="sxs-lookup"><span data-stu-id="a5311-150">Some scenarios, such as sessions or transactions, require messages toobe stored in a specific fragment.</span></span> <span data-ttu-id="a5311-151">Dessa scenarier kräver hello använder en partitionsnyckel.</span><span class="sxs-lookup"><span data-stu-id="a5311-151">All these scenarios require hello use of a partition key.</span></span> <span data-ttu-id="a5311-152">Alla meddelanden som används hello tilldelas samma partitionsnyckel toohello samma fragment.</span><span class="sxs-lookup"><span data-stu-id="a5311-152">All messages that use hello same partition key are assigned toohello same fragment.</span></span> <span data-ttu-id="a5311-153">Om hello fragment är tillfälligt otillgänglig, returneras ett fel i Service Bus.</span><span class="sxs-lookup"><span data-stu-id="a5311-153">If hello fragment is temporarily unavailable, Service Bus returns an error.</span></span>

<span data-ttu-id="a5311-154">Beroende på hello scenario används olika meddelandeegenskaper som en partitionsnyckel:</span><span class="sxs-lookup"><span data-stu-id="a5311-154">Depending on hello scenario, different message properties are used as a partition key:</span></span>

<span data-ttu-id="a5311-155">**Sessions-ID**: om ett meddelande har hello [BrokeredMessage.SessionId] [ BrokeredMessage.SessionId] egenskapsuppsättning och Service Bus använder den här egenskapen som hello partitionsnyckel.</span><span class="sxs-lookup"><span data-stu-id="a5311-155">**SessionId**: If a message has hello [BrokeredMessage.SessionId][BrokeredMessage.SessionId] property set, then Service Bus uses this property as hello partition key.</span></span> <span data-ttu-id="a5311-156">Det här sättet, alla meddelanden som tillhör toohello samma session hanteras av hello samma meddelande broker.</span><span class="sxs-lookup"><span data-stu-id="a5311-156">This way, all messages that belong toohello same session are handled by hello same message broker.</span></span> <span data-ttu-id="a5311-157">Detta gör att Service Bus tooguarantee meddelande ordning samt hello konsekvenskontroll av sessionstillstånd.</span><span class="sxs-lookup"><span data-stu-id="a5311-157">This enables Service Bus tooguarantee message ordering as well as hello consistency of session states.</span></span>

<span data-ttu-id="a5311-158">**PartitionKey**: om ett meddelande har hello [BrokeredMessage.PartitionKey] [ BrokeredMessage.PartitionKey] egenskapen men inte hello [BrokeredMessage.SessionId] [ BrokeredMessage.SessionId] egenskapsuppsättning och Service Bus använder hello [PartitionKey] [ PartitionKey] egenskap som hello partitionsnyckel.</span><span class="sxs-lookup"><span data-stu-id="a5311-158">**PartitionKey**: If a message has hello [BrokeredMessage.PartitionKey][BrokeredMessage.PartitionKey] property but not hello [BrokeredMessage.SessionId][BrokeredMessage.SessionId] property set, then Service Bus uses hello [PartitionKey][PartitionKey] property as hello partition key.</span></span> <span data-ttu-id="a5311-159">Om hello-meddelande har båda hello [SessionId] [ SessionId] och hello [PartitionKey] [ PartitionKey] egenskaper, båda egenskaperna måste vara identiska.</span><span class="sxs-lookup"><span data-stu-id="a5311-159">If hello message has both hello [SessionId][SessionId] and hello [PartitionKey][PartitionKey] properties set, both properties must be identical.</span></span> <span data-ttu-id="a5311-160">Om hello [PartitionKey] [ PartitionKey] tooa annat värde än hello anges i egenskapen [SessionId] [ SessionId] Service Bus-egenskapen returnerar en ogiltig åtgärden undantag.</span><span class="sxs-lookup"><span data-stu-id="a5311-160">If hello [PartitionKey][PartitionKey] property is set tooa different value than hello [SessionId][SessionId] property, Service Bus returns an invalid operation exception.</span></span> <span data-ttu-id="a5311-161">Hej [PartitionKey] [ PartitionKey] egenskapen ska användas om en avsändare skickar-session medveten transaktionella meddelanden.</span><span class="sxs-lookup"><span data-stu-id="a5311-161">hello [PartitionKey][PartitionKey] property should be used if a sender sends non-session aware transactional messages.</span></span> <span data-ttu-id="a5311-162">hello partitionsnyckel garanterar att alla meddelanden som skickas i en transaktion som hanteras av hello samma asynkrona broker.</span><span class="sxs-lookup"><span data-stu-id="a5311-162">hello partition key ensures that all messages that are sent within a transaction are handled by hello same messaging broker.</span></span>

<span data-ttu-id="a5311-163">**MessageId**: om hello kö eller ett ämne har hello [QueueDescription.RequiresDuplicateDetection] [ QueueDescription.RequiresDuplicateDetection] egenskapsuppsättning för**SANT** och hello [BrokeredMessage.SessionId] [ BrokeredMessage.SessionId] eller [BrokeredMessage.PartitionKey] [ BrokeredMessage.PartitionKey] egenskaper har inte angetts, och sedan hello [BrokeredMessage.MessageId] [ BrokeredMessage.MessageId] egenskapen fungerar som hello partitionsnyckel.</span><span class="sxs-lookup"><span data-stu-id="a5311-163">**MessageId**: If hello queue or topic has hello [QueueDescription.RequiresDuplicateDetection][QueueDescription.RequiresDuplicateDetection] property set too**true** and hello [BrokeredMessage.SessionId][BrokeredMessage.SessionId] or [BrokeredMessage.PartitionKey][BrokeredMessage.PartitionKey] properties are not set, then hello [BrokeredMessage.MessageId][BrokeredMessage.MessageId] property serves as hello partition key.</span></span> <span data-ttu-id="a5311-164">(Observera att hello bibliotek för Microsoft .NET och AMQP automatiskt tilldela en meddelande-ID om hello avsändarprogrammet inte.) I det här fallet hello alla kopior av hello samma meddelande hanteras av samma meddelande broker.</span><span class="sxs-lookup"><span data-stu-id="a5311-164">(Note that hello Microsoft .NET and AMQP libraries automatically assign a message ID if hello sending application does not.) In this case, all copies of hello same message are handled by hello same message broker.</span></span> <span data-ttu-id="a5311-165">Detta gör att Service Bus toodetect och undvika dubbla meddelanden.</span><span class="sxs-lookup"><span data-stu-id="a5311-165">This enables Service Bus toodetect and eliminate duplicate messages.</span></span> <span data-ttu-id="a5311-166">Om hello [QueueDescription.RequiresDuplicateDetection] [ QueueDescription.RequiresDuplicateDetection] egenskapen har inte angetts för**SANT**, Service Bus anses inte hello [MessageId] [ MessageId] egenskapen som en partitionsnyckel.</span><span class="sxs-lookup"><span data-stu-id="a5311-166">If hello [QueueDescription.RequiresDuplicateDetection][QueueDescription.RequiresDuplicateDetection] property is not set too**true**, Service Bus does not consider hello [MessageId][MessageId] property as a partition key.</span></span>

### <a name="not-using-a-partition-key"></a><span data-ttu-id="a5311-167">Inte använder en partitionsnyckel</span><span class="sxs-lookup"><span data-stu-id="a5311-167">Not using a partition key</span></span>
<span data-ttu-id="a5311-168">Hello saknas en partitionsnyckel distribuerar Service Bus meddelanden i en resursallokering sätt tooall hello fragment av hello partitionerade kö eller ett ämne.</span><span class="sxs-lookup"><span data-stu-id="a5311-168">In hello absence of a partition key, Service Bus distributes messages in a round-robin fashion tooall hello fragments of hello partitioned queue or topic.</span></span> <span data-ttu-id="a5311-169">Om hello valt fragment inte är tillgänglig, tilldelar Service Bus hello meddelandet tooa olika fragment.</span><span class="sxs-lookup"><span data-stu-id="a5311-169">If hello chosen fragment is not available, Service Bus assigns hello message tooa different fragment.</span></span> <span data-ttu-id="a5311-170">Det här sättet hello send-åtgärden lyckas trots hello temporär otillgänglighet ett meddelandearkiv.</span><span class="sxs-lookup"><span data-stu-id="a5311-170">This way, hello send operation succeeds despite hello temporary unavailability of a messaging store.</span></span> <span data-ttu-id="a5311-171">Du kommer dock inte får hello garanteras ordning att tillhandahåller en partitionsnyckel.</span><span class="sxs-lookup"><span data-stu-id="a5311-171">However, you will not achieve hello guaranteed ordering that a partition key provides.</span></span>

<span data-ttu-id="a5311-172">En mer detaljerad beskrivning av hello förhållandet mellan tillgänglighet (ingen partitionsnyckel) och konsekvenskontroll (med en partitionsnyckel) finns [i den här artikeln](../event-hubs/event-hubs-availability-and-consistency.md).</span><span class="sxs-lookup"><span data-stu-id="a5311-172">For a more in-depth discussion of hello tradeoff between availability (no partition key) and consistency (using a partition key), see [this article](../event-hubs/event-hubs-availability-and-consistency.md).</span></span> <span data-ttu-id="a5311-173">Den här informationen gäller även toopartitioned Service Bus-entiteter och Händelsehubbar partitioner.</span><span class="sxs-lookup"><span data-stu-id="a5311-173">This information applies equally toopartitioned Service Bus entities and Event Hubs partitions.</span></span>

<span data-ttu-id="a5311-174">toogive Service Bus tillräckligt med tid tooenqueue hello-meddelande till en annan fragment hello [MessagingFactorySettings.OperationTimeout] [ MessagingFactorySettings.OperationTimeout] värdet som anges av hello-klient som skickar hello-meddelande måste vara större än 15 sekunder.</span><span class="sxs-lookup"><span data-stu-id="a5311-174">toogive Service Bus enough time tooenqueue hello message into a different fragment, hello [MessagingFactorySettings.OperationTimeout][MessagingFactorySettings.OperationTimeout] value specified by hello client that sends hello message must be greater than 15 seconds.</span></span> <span data-ttu-id="a5311-175">Vi rekommenderar att du ställer in hello [OperationTimeout] [ OperationTimeout] egenskapen toohello standardvärdet 60 sekunder.</span><span class="sxs-lookup"><span data-stu-id="a5311-175">It is recommended that you set hello [OperationTimeout][OperationTimeout] property toohello default value of 60 seconds.</span></span>

<span data-ttu-id="a5311-176">Observera att en partitionsnyckel ”PIN” ett meddelande tooa fragment.</span><span class="sxs-lookup"><span data-stu-id="a5311-176">Note that a partition key "pins" a message tooa specific fragment.</span></span> <span data-ttu-id="a5311-177">Om hello meddelandearkiv som innehåller det här fragmentet är tillgänglig, returneras ett fel i Service Bus.</span><span class="sxs-lookup"><span data-stu-id="a5311-177">If hello messaging store that holds this fragment is unavailable, Service Bus returns an error.</span></span> <span data-ttu-id="a5311-178">Hello saknas en partitionsnyckel, Service Bus kan välja ett annat fragment och hello åtgärden lyckas.</span><span class="sxs-lookup"><span data-stu-id="a5311-178">In hello absence of a partition key, Service Bus can choose a different fragment and hello operation succeeds.</span></span> <span data-ttu-id="a5311-179">Vi rekommenderar därför att du inte anger en partitionsnyckel om det inte krävs.</span><span class="sxs-lookup"><span data-stu-id="a5311-179">Therefore, it is recommended that you do not supply a partition key unless it is required.</span></span>

## <a name="advanced-topics-use-transactions-with-partitioned-entities"></a><span data-ttu-id="a5311-180">Avancerade alternativ: använda transaktioner med partitionerade enheter</span><span class="sxs-lookup"><span data-stu-id="a5311-180">Advanced topics: use transactions with partitioned entities</span></span>
<span data-ttu-id="a5311-181">Meddelanden som skickas som en del av en transaktion måste ange en partitionsnyckel.</span><span class="sxs-lookup"><span data-stu-id="a5311-181">Messages that are sent as part of a transaction must specify a partition key.</span></span> <span data-ttu-id="a5311-182">Detta kan vara något av följande egenskaper hello: [BrokeredMessage.SessionId][BrokeredMessage.SessionId], [BrokeredMessage.PartitionKey][BrokeredMessage.PartitionKey], eller [ BrokeredMessage.MessageId][BrokeredMessage.MessageId].</span><span class="sxs-lookup"><span data-stu-id="a5311-182">This can be one of hello following properties: [BrokeredMessage.SessionId][BrokeredMessage.SessionId], [BrokeredMessage.PartitionKey][BrokeredMessage.PartitionKey], or [BrokeredMessage.MessageId][BrokeredMessage.MessageId].</span></span> <span data-ttu-id="a5311-183">Alla meddelanden som skickas som en del av samma transaktion måste ange hello hello samma partitionsnyckel.</span><span class="sxs-lookup"><span data-stu-id="a5311-183">All messages that are sent as part of hello same transaction must specify hello same partition key.</span></span> <span data-ttu-id="a5311-184">Om du försöker toosend ett meddelande utan någon partitionsnyckel inom en transaktion, returnerar Service Bus en ogiltig åtgärd undantag.</span><span class="sxs-lookup"><span data-stu-id="a5311-184">If you attempt toosend a message without a partition key within a transaction, Service Bus returns an invalid operation exception.</span></span> <span data-ttu-id="a5311-185">Om du försöker toosend flera meddelanden i hello samma transaktion som har olika partitionsnycklar, Service Bus returnerar en ogiltig åtgärd undantag.</span><span class="sxs-lookup"><span data-stu-id="a5311-185">If you attempt toosend multiple messages within hello same transaction that have different partition keys, Service Bus returns an invalid operation exception.</span></span> <span data-ttu-id="a5311-186">Exempel:</span><span class="sxs-lookup"><span data-stu-id="a5311-186">For example:</span></span>

```csharp
CommittableTransaction committableTransaction = new CommittableTransaction();
using (TransactionScope ts = new TransactionScope(committableTransaction))
{
    BrokeredMessage msg = new BrokeredMessage("This is a message");
    msg.PartitionKey = "myPartitionKey";
    messageSender.Send(msg); 
    ts.Complete();
}
committableTransaction.Commit();
```

<span data-ttu-id="a5311-187">Om någon av hello egenskaper som fungerar som en partitionsnyckel konfigureras hello Service Bus PIN-koder meddelandet tooa specifika fragment.</span><span class="sxs-lookup"><span data-stu-id="a5311-187">If any of hello properties that serve as a partition key are set, Service Bus pins hello message tooa specific fragment.</span></span> <span data-ttu-id="a5311-188">Detta inträffar oavsett används för en transaktion.</span><span class="sxs-lookup"><span data-stu-id="a5311-188">This behavior occurs whether or not a transaction is used.</span></span> <span data-ttu-id="a5311-189">Vi rekommenderar att du inte anger en partitionsnyckel om det inte är nödvändigt.</span><span class="sxs-lookup"><span data-stu-id="a5311-189">It is recommended that you do not specify a partition key if it is not necessary.</span></span>

## <a name="using-sessions-with-partitioned-entities"></a><span data-ttu-id="a5311-190">Sessioner med partitionerade enheter</span><span class="sxs-lookup"><span data-stu-id="a5311-190">Using sessions with partitioned entities</span></span>
<span data-ttu-id="a5311-191">toosend ett transaktionsmeddelande tooa session-medvetna ämne eller kö hello-meddelande måste ha hello [BrokeredMessage.SessionId] [ BrokeredMessage.SessionId] egenskapsuppsättning.</span><span class="sxs-lookup"><span data-stu-id="a5311-191">toosend a transactional message tooa session-aware topic or queue, hello message must have hello [BrokeredMessage.SessionId][BrokeredMessage.SessionId] property set.</span></span> <span data-ttu-id="a5311-192">Om hello [BrokeredMessage.PartitionKey] [ BrokeredMessage.PartitionKey] egenskapen anges också måste den vara identiska toohello [SessionId] [ SessionId] egenskapen.</span><span class="sxs-lookup"><span data-stu-id="a5311-192">If hello [BrokeredMessage.PartitionKey][BrokeredMessage.PartitionKey] property is specified as well, it must be identical toohello [SessionId][SessionId] property.</span></span> <span data-ttu-id="a5311-193">Om de skiljer sig returnerar en ogiltig åtgärd undantag i Service Bus.</span><span class="sxs-lookup"><span data-stu-id="a5311-193">If they differ, Service Bus returns an invalid operation exception.</span></span>

<span data-ttu-id="a5311-194">Till skillnad från vanliga (partitionerade) köer och ämnen är det inte möjligt toouse en enda transaktion toosend flera meddelanden toodifferent sessioner.</span><span class="sxs-lookup"><span data-stu-id="a5311-194">Unlike regular (non-partitioned) queues or topics, it is not possible toouse a single transaction toosend multiple messages toodifferent sessions.</span></span> <span data-ttu-id="a5311-195">Om försöktes, returnerar Service Bus en ogiltig åtgärd undantag.</span><span class="sxs-lookup"><span data-stu-id="a5311-195">If attempted, Service Bus returns an invalid operation exception.</span></span> <span data-ttu-id="a5311-196">Exempel:</span><span class="sxs-lookup"><span data-stu-id="a5311-196">For example:</span></span>

```csharp
CommittableTransaction committableTransaction = new CommittableTransaction();
using (TransactionScope ts = new TransactionScope(committableTransaction))
{
    BrokeredMessage msg = new BrokeredMessage("This is a message");
    msg.SessionId = "mySession";
    messageSender.Send(msg); 
    ts.Complete();
}
committableTransaction.Commit();
```

## <a name="automatic-message-forwarding-with-partitioned-entities"></a><span data-ttu-id="a5311-197">Automatisk vidarebefordring med partitionerade enheter</span><span class="sxs-lookup"><span data-stu-id="a5311-197">Automatic message forwarding with partitioned entities</span></span>
<span data-ttu-id="a5311-198">Service Bus stöder automatisk meddelandet vidarebefordran från, eller för mellan partitionerade enheter.</span><span class="sxs-lookup"><span data-stu-id="a5311-198">Service Bus supports automatic message forwarding from, to, or between partitioned entities.</span></span> <span data-ttu-id="a5311-199">tooenable meddelanden vidarebefordras måste ange hello [QueueDescription.ForwardTo] [ QueueDescription.ForwardTo] egenskapen hello källkön eller prenumeration.</span><span class="sxs-lookup"><span data-stu-id="a5311-199">tooenable automatic message forwarding, set hello [QueueDescription.ForwardTo][QueueDescription.ForwardTo] property on hello source queue or subscription.</span></span> <span data-ttu-id="a5311-200">Om hello-meddelande som anger en partitionsnyckel ([SessionId][SessionId], [PartitionKey][PartitionKey], eller [MessageId] [ MessageId]), som partitionsnyckel används för hello målentitet.</span><span class="sxs-lookup"><span data-stu-id="a5311-200">If hello message specifies a partition key ([SessionId][SessionId], [PartitionKey][PartitionKey], or [MessageId][MessageId]), that partition key is used for hello destination entity.</span></span>

## <a name="considerations-and-guidelines"></a><span data-ttu-id="a5311-201">Information och riktlinjer</span><span class="sxs-lookup"><span data-stu-id="a5311-201">Considerations and guidelines</span></span>
* <span data-ttu-id="a5311-202">**Hög konsekvenskontroll funktioner**: om en enhet använder funktioner som sessioner, identifiering av dubbletter eller explicit kontroll över partitionering nyckeln och sedan hello asynkrona åtgärder är alltid dirigeras toospecific fragment.</span><span class="sxs-lookup"><span data-stu-id="a5311-202">**High consistency features**: If an entity uses features such as sessions, duplicate detection, or explicit control of partitioning key, then hello messaging operations are always routed toospecific fragments.</span></span> <span data-ttu-id="a5311-203">Om någon av hello fragment drabbas av hög trafik eller hello underliggande arkivet är i feltillstånd, dessa åtgärder misslyckas och tillgänglighet minskar.</span><span class="sxs-lookup"><span data-stu-id="a5311-203">If any of hello fragments experience high traffic or hello underlying store is unhealthy, those operations fail and availability is reduced.</span></span> <span data-ttu-id="a5311-204">Generellt sett är hello konsekvenskontroll fortfarande mycket högre än partitionerade enheter. endast en del av trafiken upplever problem, som skillnad från tooall hello trafik.</span><span class="sxs-lookup"><span data-stu-id="a5311-204">Overall, hello consistency is still much higher than non-partitioned entities; only a subset of traffic is experiencing issues, as opposed tooall hello traffic.</span></span> <span data-ttu-id="a5311-205">Mer information finns i det här [beskrivning av tillgänglighet och konsekvenskontroll](../event-hubs/event-hubs-availability-and-consistency.md).</span><span class="sxs-lookup"><span data-stu-id="a5311-205">For more information, see this [discussion of availability and consistency](../event-hubs/event-hubs-availability-and-consistency.md).</span></span>
* <span data-ttu-id="a5311-206">**Hantering av**: åtgärder, till exempel skapa, uppdatera och ta bort måste utföras på alla hello fragment av hello entitet.</span><span class="sxs-lookup"><span data-stu-id="a5311-206">**Management**: Operations such as Create, Update and Delete must be performed on all hello fragments of hello entity.</span></span> <span data-ttu-id="a5311-207">Om några fragment är ohälsosamt kan det resultera i fel för dessa åtgärder.</span><span class="sxs-lookup"><span data-stu-id="a5311-207">If any fragment is unhealthy it could result in failures for these operations.</span></span> <span data-ttu-id="a5311-208">För hämta-åtgärden hello måste information såsom meddelandet räknar aggregeras från alla fragment.</span><span class="sxs-lookup"><span data-stu-id="a5311-208">For hello Get operation, information such as message counts must be aggregated from all fragments.</span></span> <span data-ttu-id="a5311-209">Om några fragment är felfri har hello Tillgänglighetsstatus för entiteten rapporterats som begränsad.</span><span class="sxs-lookup"><span data-stu-id="a5311-209">If any fragment is unhealthy, hello entity availability status is reported as limited.</span></span>
* <span data-ttu-id="a5311-210">**Volymen meddelandet scenarier med låg**: för sådana scenarier, särskilt när du använder hello HTTP-protokollet, kanske tooperform flera får operations i ordning tooobtain alla hälsningsmeddelande.</span><span class="sxs-lookup"><span data-stu-id="a5311-210">**Low volume message scenarios**: For such scenarios, especially when using hello HTTP protocol, you may have tooperform multiple receive operations in order tooobtain all hello messages.</span></span> <span data-ttu-id="a5311-211">Ta emot förfrågningar hello klientdelen utför en receive på alla hello fragment och cachelagrar alla hello-svar som tagits emot.</span><span class="sxs-lookup"><span data-stu-id="a5311-211">For receive requests, hello front end performs a receive on all hello fragments and caches all hello responses received.</span></span> <span data-ttu-id="a5311-212">En efterföljande receive-begäran på hello samma anslutning kan dra nytta av den här cachelagring och ta emot svarstiderna blir lägre.</span><span class="sxs-lookup"><span data-stu-id="a5311-212">A subsequent receive request on hello same connection would benefit from this caching and receive latencies will be lower.</span></span> <span data-ttu-id="a5311-213">Men om du har flera anslutningar eller använda HTTP upprättar som en ny anslutning för varje begäran.</span><span class="sxs-lookup"><span data-stu-id="a5311-213">However, if you have multiple connections or use HTTP, that establishes a new connection for each request.</span></span> <span data-ttu-id="a5311-214">Det finns därför ingen garanti för att den skulle hamna på hello samma nod.</span><span class="sxs-lookup"><span data-stu-id="a5311-214">As such, there is no guarantee that it would land on hello same node.</span></span> <span data-ttu-id="a5311-215">Om alla befintliga meddelanden är låst och cachelagras i en annan klientdelen hello får åtgärden returnerar **null**.</span><span class="sxs-lookup"><span data-stu-id="a5311-215">If all existing messages are locked and cached in another front end, hello receive operation returns **null**.</span></span> <span data-ttu-id="a5311-216">Meddelanden till slut upphör och du kan ta emot dem igen.</span><span class="sxs-lookup"><span data-stu-id="a5311-216">Messages eventually expire and you can receive them again.</span></span> <span data-ttu-id="a5311-217">HTTP keep-alive rekommenderas.</span><span class="sxs-lookup"><span data-stu-id="a5311-217">HTTP keep-alive is recommended.</span></span>
* <span data-ttu-id="a5311-218">**Bläddra/titt meddelanden**: [PeekBatch](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_PeekBatch_System_Int32_) inte alltid returnerar hello antal meddelanden som anges i hello [MessageCount](/dotnet/api/microsoft.servicebus.messaging.queuedescription#Microsoft_ServiceBus_Messaging_QueueDescription_MessageCount) egenskapen.</span><span class="sxs-lookup"><span data-stu-id="a5311-218">**Browse/Peek messages**: [PeekBatch](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_PeekBatch_System_Int32_) does not always return hello number of messages specified in hello [MessageCount](/dotnet/api/microsoft.servicebus.messaging.queuedescription#Microsoft_ServiceBus_Messaging_QueueDescription_MessageCount) property.</span></span> <span data-ttu-id="a5311-219">Det finns två vanliga orsaker till detta.</span><span class="sxs-lookup"><span data-stu-id="a5311-219">There are two common reasons for this.</span></span> <span data-ttu-id="a5311-220">En orsak är att hello hello samling meddelanden aggregerade storlek överskrider hello maximal storlek på 256KB.</span><span class="sxs-lookup"><span data-stu-id="a5311-220">One reason is that hello aggregated size of hello collection of messages exceeds hello maximum size of 256KB.</span></span> <span data-ttu-id="a5311-221">En annan orsak är att om hello kö eller ett ämne har hello [EnablePartitioning egenskapen](/dotnet/api/microsoft.servicebus.messaging.queuedescription#Microsoft_ServiceBus_Messaging_QueueDescription_EnablePartitioning) ställa in också**SANT**, en partition kan inte ha tillräckligt många meddelanden toocomplete hello begärt antal meddelanden.</span><span class="sxs-lookup"><span data-stu-id="a5311-221">Another reason is that if hello queue or topic has hello [EnablePartitioning property](/dotnet/api/microsoft.servicebus.messaging.queuedescription#Microsoft_ServiceBus_Messaging_QueueDescription_EnablePartitioning) set too**true**, a partition may not have enough messages toocomplete hello requested number of messages.</span></span> <span data-ttu-id="a5311-222">I allmänhet tooreceive ett visst antal meddelanden om ett program, den ska anropa [PeekBatch](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_PeekBatch_System_Int32_) upprepade gånger tills den hämtar det antalet meddelanden eller så finns det inga fler meddelanden toopeek.</span><span class="sxs-lookup"><span data-stu-id="a5311-222">In general, if an application wants tooreceive a specific number of messages, it should call [PeekBatch](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_PeekBatch_System_Int32_) repeatedly until it gets that number of messages, or there are no more messages toopeek.</span></span> <span data-ttu-id="a5311-223">Mer information, inklusive kodexempel, se [QueueClient.PeekBatch](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_PeekBatch_System_Int32_) eller [SubscriptionClient.PeekBatch](/dotnet/api/microsoft.servicebus.messaging.subscriptionclient#Microsoft_ServiceBus_Messaging_SubscriptionClient_PeekBatch_System_Int32_).</span><span class="sxs-lookup"><span data-stu-id="a5311-223">For more information, including code samples, see [QueueClient.PeekBatch](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_PeekBatch_System_Int32_) or [SubscriptionClient.PeekBatch](/dotnet/api/microsoft.servicebus.messaging.subscriptionclient#Microsoft_ServiceBus_Messaging_SubscriptionClient_PeekBatch_System_Int32_).</span></span>

## <a name="latest-added-features"></a><span data-ttu-id="a5311-224">Senaste extrafunktioner</span><span class="sxs-lookup"><span data-stu-id="a5311-224">Latest added features</span></span>
* <span data-ttu-id="a5311-225">Lägg till eller ta bort regeln stöds nu med partitionerade enheter.</span><span class="sxs-lookup"><span data-stu-id="a5311-225">Add or remove rule is now supported with partitioned entities.</span></span> <span data-ttu-id="a5311-226">Skiljer sig från partitionerade enheter, dessa åtgärder stöds inte under transaktioner.</span><span class="sxs-lookup"><span data-stu-id="a5311-226">Different from non-partitioned entities, these operations are not supported under transactions.</span></span> 
* <span data-ttu-id="a5311-227">AMQP stöds nu för att skicka och ta emot meddelanden tooand från en partitionerad entitet.</span><span class="sxs-lookup"><span data-stu-id="a5311-227">AMQP is now supported for sending and receiving messages tooand from a partitioned entity.</span></span>
* <span data-ttu-id="a5311-228">AMQP har nu stöd för hello följande åtgärder: [Batch skicka](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_SendBatch_System_Collections_Generic_IEnumerable_Microsoft_ServiceBus_Messaging_BrokeredMessage__), [Batch får](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_ReceiveBatch_System_Int32_), [ta emot med sekvensnumret](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_Receive_System_Int64_), [granska](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_Peek), [ Förnya Lås](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_RenewMessageLock_System_Guid_), [schemalägga meddelandet](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_ScheduleMessageAsync_Microsoft_ServiceBus_Messaging_BrokeredMessage_System_DateTimeOffset_), [Avbryt schemalagda meddelande](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_CancelScheduledMessageAsync_System_Int64_), [Lägg till regel](/dotnet/api/microsoft.servicebus.messaging.ruledescription), [ta bort regeln](/dotnet/api/microsoft.servicebus.messaging.ruledescription), [Session förnya Lås](/dotnet/api/microsoft.servicebus.messaging.messagesession#Microsoft_ServiceBus_Messaging_MessageSession_RenewLock), [Set sessionstillstånd](/dotnet/api/microsoft.servicebus.messaging.messagesession#Microsoft_ServiceBus_Messaging_MessageSession_SetState_System_IO_Stream_), [Get sessionstillstånd](/dotnet/api/microsoft.servicebus.messaging.messagesession#Microsoft_ServiceBus_Messaging_MessageSession_GetState), och [räkna upp sessioner](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_GetMessageSessionsAsync).</span><span class="sxs-lookup"><span data-stu-id="a5311-228">AMQP is now supported for hello following operations: [Batch Send](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_SendBatch_System_Collections_Generic_IEnumerable_Microsoft_ServiceBus_Messaging_BrokeredMessage__), [Batch Receive](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_ReceiveBatch_System_Int32_), [Receive by Sequence Number](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_Receive_System_Int64_), [Peek](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_Peek), [Renew Lock](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_RenewMessageLock_System_Guid_), [Schedule Message](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_ScheduleMessageAsync_Microsoft_ServiceBus_Messaging_BrokeredMessage_System_DateTimeOffset_), [Cancel Scheduled Message](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_CancelScheduledMessageAsync_System_Int64_), [Add Rule](/dotnet/api/microsoft.servicebus.messaging.ruledescription), [Remove Rule](/dotnet/api/microsoft.servicebus.messaging.ruledescription), [Session Renew Lock](/dotnet/api/microsoft.servicebus.messaging.messagesession#Microsoft_ServiceBus_Messaging_MessageSession_RenewLock), [Set Session State](/dotnet/api/microsoft.servicebus.messaging.messagesession#Microsoft_ServiceBus_Messaging_MessageSession_SetState_System_IO_Stream_), [Get Session State](/dotnet/api/microsoft.servicebus.messaging.messagesession#Microsoft_ServiceBus_Messaging_MessageSession_GetState), and [Enumerate Sessions](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_GetMessageSessionsAsync).</span></span>

## <a name="partitioned-entities-limitations"></a><span data-ttu-id="a5311-229">Begränsningar för partitionerade enheter</span><span class="sxs-lookup"><span data-stu-id="a5311-229">Partitioned entities limitations</span></span>
<span data-ttu-id="a5311-230">Service Bus medför för närvarande hello följande begränsningar på partitionerade köer och ämnen:</span><span class="sxs-lookup"><span data-stu-id="a5311-230">Currently Service Bus imposes hello following limitations on partitioned queues and topics:</span></span>

* <span data-ttu-id="a5311-231">Partitionerade köer och ämnen stöder inte skicka meddelanden som tillhör toodifferent sessioner i en enda transaktion.</span><span class="sxs-lookup"><span data-stu-id="a5311-231">Partitioned queues and topics do not support sending messages that belong toodifferent sessions in a single transaction.</span></span>
* <span data-ttu-id="a5311-232">Service Bus kan för närvarande in too100 partitionerad köer och ämnen per namnområde.</span><span class="sxs-lookup"><span data-stu-id="a5311-232">Service Bus currently allows up too100 partitioned queues or topics per namespace.</span></span> <span data-ttu-id="a5311-233">Varje partitionerade kö eller ett ämne räknar mot hello kvoten på 10 000 enheter per namnområde (inte gäller tooPremium nivån).</span><span class="sxs-lookup"><span data-stu-id="a5311-233">Each partitioned queue or topic counts towards hello quota of 10,000 entities per namespace (does not apply tooPremium tier).</span></span>

## <a name="next-steps"></a><span data-ttu-id="a5311-234">Nästa steg</span><span class="sxs-lookup"><span data-stu-id="a5311-234">Next steps</span></span>
<span data-ttu-id="a5311-235">Visa hello diskussion av [AMQP 1.0-stöd för Service Bus partitionerad köer och ämnen] [ AMQP 1.0 support for Service Bus partitioned queues and topics] toolearn mer om partitionering meddelandeentiteter.</span><span class="sxs-lookup"><span data-stu-id="a5311-235">See hello discussion of [AMQP 1.0 support for Service Bus partitioned queues and topics][AMQP 1.0 support for Service Bus partitioned queues and topics] toolearn more about partitioning messaging entities.</span></span> 

[Service Bus architecture]: service-bus-architecture.md
[Azure portal]: https://portal.azure.com
[QueueDescription.EnablePartitioning]: /dotnet/api/microsoft.servicebus.messaging.queuedescription#Microsoft_ServiceBus_Messaging_QueueDescription_EnablePartitioning
[TopicDescription.EnablePartitioning]: /dotnet/api/microsoft.servicebus.messaging.topicdescription#Microsoft_ServiceBus_Messaging_TopicDescription_EnablePartitioning
[BrokeredMessage.SessionId]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_SessionId
[BrokeredMessage.PartitionKey]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_PartitionKey
[SessionId]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_SessionId
[PartitionKey]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_PartitionKey
[QueueDescription.RequiresDuplicateDetection]: /dotnet/api/microsoft.servicebus.messaging.queuedescription#Microsoft_ServiceBus_Messaging_QueueDescription_RequiresDuplicateDetection
[BrokeredMessage.MessageId]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_MessageId
[MessageId]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_MessageId
[MessagingFactorySettings.OperationTimeout]: /dotnet/api/microsoft.servicebus.messaging.messagingfactorysettings#Microsoft_ServiceBus_Messaging_MessagingFactorySettings_OperationTimeout
[OperationTimeout]: /dotnet/api/microsoft.servicebus.messaging.messagingfactorysettings#Microsoft_ServiceBus_Messaging_MessagingFactorySettings_OperationTimeout
[QueueDescription.ForwardTo]: /dotnet/api/microsoft.servicebus.messaging.queuedescription#Microsoft_ServiceBus_Messaging_QueueDescription_ForwardTo
[AMQP 1.0 support for Service Bus partitioned queues and topics]: service-bus-partitioned-queues-and-topics-amqp-overview.md
