---
title: "Azure Service Bus länkas namnområden | Microsoft Docs"
description: "Implementeringsdetaljer parad namnområde och kostnad"
services: service-bus-messaging
documentationcenter: na
author: sethmanheim
manager: timlt
editor: 
ms.assetid: 2440c8d3-ed2e-47e0-93cf-ab7fbb855d2e
ms.service: service-bus-messaging
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 05/25/2017
ms.author: sethm
ms.openlocfilehash: a200ea7937b9f5296c743928a9408897adfba428
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 07/11/2017
---
# <a name="paired-namespace-implementation-details-and-cost-implications"></a><span data-ttu-id="92cdc-103">Länkas namnområde implementeringsdetaljer och cost effekter</span><span class="sxs-lookup"><span data-stu-id="92cdc-103">Paired namespace implementation details and cost implications</span></span>
<span data-ttu-id="92cdc-104">Den [PairNamespaceAsync] [ PairNamespaceAsync] metod med en [SendAvailabilityPairedNamespaceOptions] [ SendAvailabilityPairedNamespaceOptions] instansen, utför synliga uppgifter å dina vägnar.</span><span class="sxs-lookup"><span data-stu-id="92cdc-104">The [PairNamespaceAsync][PairNamespaceAsync] method, using a [SendAvailabilityPairedNamespaceOptions][SendAvailabilityPairedNamespaceOptions] instance, performs visible tasks on your behalf.</span></span> <span data-ttu-id="92cdc-105">Eftersom det är kostnad överväganden när du använder funktionen, är det viktigt att förstå dessa uppgifter så att du förväntar dig beteendet när det sker.</span><span class="sxs-lookup"><span data-stu-id="92cdc-105">Because there are cost considerations when using the feature, it is useful to understand those tasks so that you expect the behavior when it happens.</span></span> <span data-ttu-id="92cdc-106">API: et aktiverar följande automatiska funktioner för din räkning:</span><span class="sxs-lookup"><span data-stu-id="92cdc-106">The API engages the following automatic behavior on your behalf:</span></span>

* <span data-ttu-id="92cdc-107">Skapa eftersläpning köer.</span><span class="sxs-lookup"><span data-stu-id="92cdc-107">Creation of backlog queues.</span></span>
* <span data-ttu-id="92cdc-108">Skapa en [MessageSender] [ MessageSender] objekt som kommunicerar köer och ämnen.</span><span class="sxs-lookup"><span data-stu-id="92cdc-108">Creation of a [MessageSender][MessageSender] object that talks to queues or topics.</span></span>
* <span data-ttu-id="92cdc-109">Om en meddelandeentitet blir otillgänglig, pinga skickar meddelanden till entiteten i ett försök att identifiera när enheten blir tillgänglig igen.</span><span class="sxs-lookup"><span data-stu-id="92cdc-109">When a messaging entity becomes unavailable, sends ping messages to the entity in an attempt to detect when that entity becomes available again.</span></span>
* <span data-ttu-id="92cdc-110">Du kan även skapa en uppsättning ”meddelande pumpar” som flytta meddelanden från eftersläpning köer till de primära köerna.</span><span class="sxs-lookup"><span data-stu-id="92cdc-110">Optionally creates of a set of “message pumps” that move messages from the backlog queues to the primary queues.</span></span>
* <span data-ttu-id="92cdc-111">Samordnar avslutande/felaktig av primära och sekundära [MessagingFactory] [ MessagingFactory] instanser.</span><span class="sxs-lookup"><span data-stu-id="92cdc-111">Coordinates closing/faulting of the primary and secondary [MessagingFactory][MessagingFactory] instances.</span></span>

<span data-ttu-id="92cdc-112">På en hög nivå funktionen fungerar på följande sätt: när den primära entiteten är felfri, ingen funktionsändringar sker.</span><span class="sxs-lookup"><span data-stu-id="92cdc-112">At a high level, the feature works as follows: when the primary entity is healthy, no behavior changes occur.</span></span> <span data-ttu-id="92cdc-113">När den [FailoverInterval] [ FailoverInterval] varaktighet är slut och de primära entiteten ser inte lyckas skickar efter en inte är tillfällig [MessagingException] [ MessagingException] eller en [TimeoutException][TimeoutException], händer följande:</span><span class="sxs-lookup"><span data-stu-id="92cdc-113">When the [FailoverInterval][FailoverInterval] duration elapses, and the primary entity sees no successful sends after a non-transient [MessagingException][MessagingException] or a [TimeoutException][TimeoutException], the following behavior occurs:</span></span>

1. <span data-ttu-id="92cdc-114">Skicka till den primära entiteten har inaktiverats och systemet pingar den primära enheten förrän pingar har levereras.</span><span class="sxs-lookup"><span data-stu-id="92cdc-114">Send operations to the primary entity are disabled and the system pings the primary entity until pings can be successfully delivered.</span></span>
2. <span data-ttu-id="92cdc-115">En slumpmässig eftersläpning kö har valts.</span><span class="sxs-lookup"><span data-stu-id="92cdc-115">A random backlog queue is selected.</span></span>
3. <span data-ttu-id="92cdc-116">[BrokeredMessage] [ BrokeredMessage] objekt dirigeras till valda eftersläpning kön.</span><span class="sxs-lookup"><span data-stu-id="92cdc-116">[BrokeredMessage][BrokeredMessage] objects are routed to the chosen backlog queue.</span></span>
4. <span data-ttu-id="92cdc-117">Om en send-åtgärd till valda eftersläpning kön misslyckas kön hämtas från rotationen och en ny kö har valts.</span><span class="sxs-lookup"><span data-stu-id="92cdc-117">If a send operation to the chosen backlog queue fails, that queue is pulled from the rotation and a new queue is selected.</span></span> <span data-ttu-id="92cdc-118">Alla avsändare på den [MessagingFactory] [ MessagingFactory] instans Lär dig mer om felet.</span><span class="sxs-lookup"><span data-stu-id="92cdc-118">All senders on the [MessagingFactory][MessagingFactory] instance learn of the failure.</span></span>

<span data-ttu-id="92cdc-119">I följande figurer visas sekvensen.</span><span class="sxs-lookup"><span data-stu-id="92cdc-119">The following figures depict the sequence.</span></span> <span data-ttu-id="92cdc-120">Först skickar avsändare meddelanden.</span><span class="sxs-lookup"><span data-stu-id="92cdc-120">First, the sender sends messages.</span></span>

![Parad namnområden][0]

<span data-ttu-id="92cdc-122">Vid fel ska skickas till primära kön börjar avsändaren skicka meddelanden till en slumpmässigt vald eftersläpning kö.</span><span class="sxs-lookup"><span data-stu-id="92cdc-122">Upon failure to send to the primary queue, the sender begins sending messages to a randomly chosen backlog queue.</span></span> <span data-ttu-id="92cdc-123">Samtidigt, startar en ping-aktivitet.</span><span class="sxs-lookup"><span data-stu-id="92cdc-123">Simultaneously, it starts a ping task.</span></span>

![Parad namnområden][1]

<span data-ttu-id="92cdc-125">Nu finns kvar i sekundär kö meddelanden och inte har levererats till primära kön.</span><span class="sxs-lookup"><span data-stu-id="92cdc-125">At this point the messages are still in the secondary queue and have not been delivered to the primary queue.</span></span> <span data-ttu-id="92cdc-126">När primära kön är felfri igen, ska minst en process köras syphon.</span><span class="sxs-lookup"><span data-stu-id="92cdc-126">Once the primary queue is healthy again, at least one process should be running the syphon.</span></span> <span data-ttu-id="92cdc-127">Syphon levererar meddelanden från alla olika eftersläpning köer till rätt mål-enheter (köer och ämnen).</span><span class="sxs-lookup"><span data-stu-id="92cdc-127">The syphon delivers the messages from all the various backlog queues to the proper destination entities (queues and topics).</span></span>

![Parad namnområden][2]

<span data-ttu-id="92cdc-129">Resten av det här avsnittet innehåller information om specifik information om hur dessa delar fungerar.</span><span class="sxs-lookup"><span data-stu-id="92cdc-129">The remainder of this topic discusses the specific details of how these pieces work.</span></span>

## <a name="creation-of-backlog-queues"></a><span data-ttu-id="92cdc-130">Skapandet av eftersläpning köer</span><span class="sxs-lookup"><span data-stu-id="92cdc-130">Creation of backlog queues</span></span>
<span data-ttu-id="92cdc-131">Den [SendAvailabilityPairedNamespaceOptions] [ SendAvailabilityPairedNamespaceOptions] objekt har överförts till den [PairNamespaceAsync] [ PairNamespaceAsync] metoden anger antalet eftersläpning köer du vill använda.</span><span class="sxs-lookup"><span data-stu-id="92cdc-131">The [SendAvailabilityPairedNamespaceOptions][SendAvailabilityPairedNamespaceOptions] object passed to the [PairNamespaceAsync][PairNamespaceAsync] method indicates the number of backlog queues you want to use.</span></span> <span data-ttu-id="92cdc-132">Varje kö eftersläpning skapas med följande egenskaper uttryckligen ange (alla andra värden är inställda på att den [QueueDescription] [ QueueDescription] standardvärden):</span><span class="sxs-lookup"><span data-stu-id="92cdc-132">Each backlog queue is then created with the following properties explicitly set (all other values are set to the [QueueDescription][QueueDescription] defaults):</span></span>

| <span data-ttu-id="92cdc-133">Sökväg</span><span class="sxs-lookup"><span data-stu-id="92cdc-133">Path</span></span> | <span data-ttu-id="92cdc-134">[primära namnutrymme] / x-servicebus-överföring / [index] där [index] är ett värde i [0, BacklogQueueCount)</span><span class="sxs-lookup"><span data-stu-id="92cdc-134">[primary namespace]/x-servicebus-transfer/[index] where [index] is a value in [0, BacklogQueueCount)</span></span> |
| --- | --- |
| <span data-ttu-id="92cdc-135">MaxSizeInMegabytes</span><span class="sxs-lookup"><span data-stu-id="92cdc-135">MaxSizeInMegabytes</span></span> |<span data-ttu-id="92cdc-136">5120</span><span class="sxs-lookup"><span data-stu-id="92cdc-136">5120</span></span> |
| <span data-ttu-id="92cdc-137">MaxDeliveryCount</span><span class="sxs-lookup"><span data-stu-id="92cdc-137">MaxDeliveryCount</span></span> |<span data-ttu-id="92cdc-138">heltal. MaxValue</span><span class="sxs-lookup"><span data-stu-id="92cdc-138">int.MaxValue</span></span> |
| <span data-ttu-id="92cdc-139">DefaultMessageTimeToLive</span><span class="sxs-lookup"><span data-stu-id="92cdc-139">DefaultMessageTimeToLive</span></span> |<span data-ttu-id="92cdc-140">TimeSpan.MaxValue</span><span class="sxs-lookup"><span data-stu-id="92cdc-140">TimeSpan.MaxValue</span></span> |
| <span data-ttu-id="92cdc-141">AutoDeleteOnIdle</span><span class="sxs-lookup"><span data-stu-id="92cdc-141">AutoDeleteOnIdle</span></span> |<span data-ttu-id="92cdc-142">TimeSpan.MaxValue</span><span class="sxs-lookup"><span data-stu-id="92cdc-142">TimeSpan.MaxValue</span></span> |
| <span data-ttu-id="92cdc-143">Varaktighet</span><span class="sxs-lookup"><span data-stu-id="92cdc-143">LockDuration</span></span> |<span data-ttu-id="92cdc-144">1 minut</span><span class="sxs-lookup"><span data-stu-id="92cdc-144">1 minute</span></span> |
| <span data-ttu-id="92cdc-145">EnableDeadLetteringOnMessageExpiration</span><span class="sxs-lookup"><span data-stu-id="92cdc-145">EnableDeadLetteringOnMessageExpiration</span></span> |<span data-ttu-id="92cdc-146">SANT</span><span class="sxs-lookup"><span data-stu-id="92cdc-146">true</span></span> |
| <span data-ttu-id="92cdc-147">EnableBatchedOperations</span><span class="sxs-lookup"><span data-stu-id="92cdc-147">EnableBatchedOperations</span></span> |<span data-ttu-id="92cdc-148">SANT</span><span class="sxs-lookup"><span data-stu-id="92cdc-148">true</span></span> |

<span data-ttu-id="92cdc-149">Till exempel den första eftersläpning kön skapas för namnområdet **contoso** heter `contoso/x-servicebus-transfer/0`.</span><span class="sxs-lookup"><span data-stu-id="92cdc-149">For example, the first backlog queue created for namespace **contoso** is named `contoso/x-servicebus-transfer/0`.</span></span>

<span data-ttu-id="92cdc-150">När du skapar köerna kontrollerar koden först om det finns en sådan kö.</span><span class="sxs-lookup"><span data-stu-id="92cdc-150">When creating the queues, the code first checks to see if such a queue exists.</span></span> <span data-ttu-id="92cdc-151">Om det inte finns kön, skapa kön.</span><span class="sxs-lookup"><span data-stu-id="92cdc-151">If the queue does not exist, then the queue is created.</span></span> <span data-ttu-id="92cdc-152">Koden inte rensa ”extra” eftersläpning köer.</span><span class="sxs-lookup"><span data-stu-id="92cdc-152">The code does not clean up "extra" backlog queues.</span></span> <span data-ttu-id="92cdc-153">I synnerhet om programmet med primära namnområde **contoso** begär fem eftersläpning köer, men en eftersläpning kö med sökvägen `contoso/x-servicebus-transfer/7` finns extra eftersläpning kön är kvar men används inte.</span><span class="sxs-lookup"><span data-stu-id="92cdc-153">Specifically, if the application with the primary namespace **contoso** requests five backlog queues but a backlog queue with the path `contoso/x-servicebus-transfer/7` exists, that extra backlog queue is still present but is not used.</span></span> <span data-ttu-id="92cdc-154">Systemet tillåter uttryckligen extra eftersläpning köer finns som inte används.</span><span class="sxs-lookup"><span data-stu-id="92cdc-154">The system explicitly allows extra backlog queues to exist that would not be used.</span></span> <span data-ttu-id="92cdc-155">Du är ansvarig för att rensa alla oanvända/oönskad eftersläpning köer som ägare namnområde.</span><span class="sxs-lookup"><span data-stu-id="92cdc-155">As the namespace owner, you are responsible for cleaning up any unused/unwanted backlog queues.</span></span> <span data-ttu-id="92cdc-156">Orsaken till detta beslut är att Service Bus inte kan vet vilket syfte som finns för alla köer i namnområdet.</span><span class="sxs-lookup"><span data-stu-id="92cdc-156">The reason for this decision is that Service Bus cannot know what purposes exist for all the queues in your namespace.</span></span> <span data-ttu-id="92cdc-157">Dessutom, om en kö med det angivna namnet finns men inte uppfyller den antagna [QueueDescription][QueueDescription], din orsaker är din egen för ändra standardbeteendet.</span><span class="sxs-lookup"><span data-stu-id="92cdc-157">Furthermore, if a queue exists with the given name but does not meet the assumed [QueueDescription][QueueDescription], then your reasons are your own for changing the default behavior.</span></span> <span data-ttu-id="92cdc-158">Inga garantier görs för att ändringarna till eftersläpning köer av din kod.</span><span class="sxs-lookup"><span data-stu-id="92cdc-158">No guarantees are made for modifications to the backlog queues by your code.</span></span> <span data-ttu-id="92cdc-159">Se till att testa dina ändringar noggrant.</span><span class="sxs-lookup"><span data-stu-id="92cdc-159">Make sure to test your changes thoroughly.</span></span>

## <a name="custom-messagesender"></a><span data-ttu-id="92cdc-160">Anpassade MessageSender</span><span class="sxs-lookup"><span data-stu-id="92cdc-160">Custom MessageSender</span></span>
<span data-ttu-id="92cdc-161">När du skickar, alla meddelanden gå igenom en intern [MessageSender] [ MessageSender] objekt som fungerar sedan normalt när allt fungerar och omdirigerar till eftersläpningen köer när saker ”delar”.</span><span class="sxs-lookup"><span data-stu-id="92cdc-161">When sending, all messages go through an internal [MessageSender][MessageSender] object that behaves normally when everything works, and redirects to the backlog queues when things "break."</span></span> <span data-ttu-id="92cdc-162">Vid mottagning av ett fel uppstod, startar en timer.</span><span class="sxs-lookup"><span data-stu-id="92cdc-162">Upon receiving a non-transient failure, a timer starts.</span></span> <span data-ttu-id="92cdc-163">När en [TimeSpan] [ TimeSpan] period som består av den [FailoverInterval] [ FailoverInterval] egenskapens värde under vilket inga lyckade meddelanden skickas, växling vid fel används.</span><span class="sxs-lookup"><span data-stu-id="92cdc-163">After a [TimeSpan][TimeSpan] period consisting of the [FailoverInterval][FailoverInterval] property value during which no successful messages are sent, the failover is engaged.</span></span> <span data-ttu-id="92cdc-164">Nu händer följande för varje entitet:</span><span class="sxs-lookup"><span data-stu-id="92cdc-164">At this point, the following things happen for each entity:</span></span>

* <span data-ttu-id="92cdc-165">Ping-uppgiften körs varje [PingPrimaryInterval] [ PingPrimaryInterval] att kontrollera om enheten är tillgänglig.</span><span class="sxs-lookup"><span data-stu-id="92cdc-165">A ping task executes every [PingPrimaryInterval][PingPrimaryInterval] to check if the entity is available.</span></span> <span data-ttu-id="92cdc-166">När den här aktiviteten lyckas startar alla klientkod som använder enheten omedelbart skicka nya meddelanden till det primära namnområdet.</span><span class="sxs-lookup"><span data-stu-id="92cdc-166">Once this task succeeds, all client code that uses the entity immediately starts sending new messages to the primary namespace.</span></span>
* <span data-ttu-id="92cdc-167">Kommande begäranden att skicka till att samma entitet från andra sändare leder den [BrokeredMessage] [ BrokeredMessage] som skickas till ändras så att de är placerade i eftersläpning kön.</span><span class="sxs-lookup"><span data-stu-id="92cdc-167">Future requests to send to that same entity from any other senders will result in the [BrokeredMessage][BrokeredMessage] being sent to be modified to sit in the backlog queue.</span></span> <span data-ttu-id="92cdc-168">Detta tar bort vissa egenskaper från den [BrokeredMessage] [ BrokeredMessage] objekt och lagrar dem på en annan plats.</span><span class="sxs-lookup"><span data-stu-id="92cdc-168">The modification removes some properties from the [BrokeredMessage][BrokeredMessage] object and stores them elsewhere.</span></span> <span data-ttu-id="92cdc-169">Följande egenskaper tas bort och lagts till under ett nytt alias, vilket gör att Service Bus och SDK att bearbeta meddelanden enhetligt:</span><span class="sxs-lookup"><span data-stu-id="92cdc-169">The following properties are cleared and added under a new alias, allowing Service Bus and the SDK to process messages uniformly:</span></span>

| <span data-ttu-id="92cdc-170">Gamla egenskapsnamn</span><span class="sxs-lookup"><span data-stu-id="92cdc-170">Old Property Name</span></span> | <span data-ttu-id="92cdc-171">Nya egenskapsnamn</span><span class="sxs-lookup"><span data-stu-id="92cdc-171">New Property Name</span></span> |
| --- | --- |
| <span data-ttu-id="92cdc-172">Sessions-ID</span><span class="sxs-lookup"><span data-stu-id="92cdc-172">SessionId</span></span> |<span data-ttu-id="92cdc-173">x-ms-sessions-ID</span><span class="sxs-lookup"><span data-stu-id="92cdc-173">x-ms-sessionid</span></span> |
| <span data-ttu-id="92cdc-174">TimeToLive</span><span class="sxs-lookup"><span data-stu-id="92cdc-174">TimeToLive</span></span> |<span data-ttu-id="92cdc-175">x-ms-timetolive</span><span class="sxs-lookup"><span data-stu-id="92cdc-175">x-ms-timetolive</span></span> |
| <span data-ttu-id="92cdc-176">ScheduledEnqueueTimeUtc</span><span class="sxs-lookup"><span data-stu-id="92cdc-176">ScheduledEnqueueTimeUtc</span></span> |<span data-ttu-id="92cdc-177">x-ms-sökväg</span><span class="sxs-lookup"><span data-stu-id="92cdc-177">x-ms-path</span></span> |

<span data-ttu-id="92cdc-178">Den ursprungliga målsökvägen lagras också i meddelandet som en egenskap med namnet x-ms-sökväg.</span><span class="sxs-lookup"><span data-stu-id="92cdc-178">The original destination path is also stored within the message as a property named x-ms-path.</span></span> <span data-ttu-id="92cdc-179">Den här designen kan meddelanden för många enheter som ska finnas i en enda eftersläpning kö.</span><span class="sxs-lookup"><span data-stu-id="92cdc-179">This design allows messages for many entities to coexist in a single backlog queue.</span></span> <span data-ttu-id="92cdc-180">Egenskaperna översätts igen genom syphon.</span><span class="sxs-lookup"><span data-stu-id="92cdc-180">The properties are translated back by the syphon.</span></span>

<span data-ttu-id="92cdc-181">Anpassat [MessageSender] [ MessageSender] objekt problem kan uppstå när meddelanden hanterar 256 KB-gränsen och växling vid fel används.</span><span class="sxs-lookup"><span data-stu-id="92cdc-181">The custom [MessageSender][MessageSender] object can encounter issues when messages approach the 256-KB limit and failover is engaged.</span></span> <span data-ttu-id="92cdc-182">Anpassat [MessageSender] [ MessageSender] -objektet lagrar meddelanden för alla köer och ämnen tillsammans i eftersläpning köer.</span><span class="sxs-lookup"><span data-stu-id="92cdc-182">The custom [MessageSender][MessageSender] object stores messages for all queues and topics together in the backlog queues.</span></span> <span data-ttu-id="92cdc-183">Det här objektet blandas meddelanden från många primärfärgerna tillsammans i eftersläpning köer.</span><span class="sxs-lookup"><span data-stu-id="92cdc-183">This object mixes messages from many primaries together within the backlog queues.</span></span> <span data-ttu-id="92cdc-184">Om du vill hantera belastningsutjämningen bland många klienter som inte vet varandra SDK slumpvis en eftersläpning kö för varje [QueueClient] [ QueueClient] eller [TopicClient] [ TopicClient] du skapar i koden.</span><span class="sxs-lookup"><span data-stu-id="92cdc-184">To handle load balancing among many clients that do not know each other, the SDK randomly picks one backlog queue for each [QueueClient][QueueClient] or [TopicClient][TopicClient] you create in code.</span></span>

## <a name="pings"></a><span data-ttu-id="92cdc-185">Pingar</span><span class="sxs-lookup"><span data-stu-id="92cdc-185">Pings</span></span>
<span data-ttu-id="92cdc-186">Ett ping-meddelande är ett tomt [BrokeredMessage] [ BrokeredMessage] med dess [ContentType] [ ContentType] -egenskapen angetts till programmet/vnd.ms-servicebus-ping och en [TimeToLive] [ TimeToLive] värdet 1 sekund.</span><span class="sxs-lookup"><span data-stu-id="92cdc-186">A ping message is an empty [BrokeredMessage][BrokeredMessage] with its [ContentType][ContentType] property set to application/vnd.ms-servicebus-ping and a [TimeToLive][TimeToLive] value of 1 second.</span></span> <span data-ttu-id="92cdc-187">Den här ping har en särskild egenskap i Service Bus: ett ping skickas aldrig när alla anroparen begär en [BrokeredMessage][BrokeredMessage].</span><span class="sxs-lookup"><span data-stu-id="92cdc-187">This ping has one special characteristic in Service Bus: the server never delivers a ping when any caller requests a [BrokeredMessage][BrokeredMessage].</span></span> <span data-ttu-id="92cdc-188">Du har aldrig alltså att lära dig att ta emot och ignorera dessa meddelanden.</span><span class="sxs-lookup"><span data-stu-id="92cdc-188">Thus, you never have to learn how to receive and ignore these messages.</span></span> <span data-ttu-id="92cdc-189">Varje entitet (unikt kö eller ett ämne) per [MessagingFactory] [ MessagingFactory] instans per klient ska pingas när de anses vara otillgänglig.</span><span class="sxs-lookup"><span data-stu-id="92cdc-189">Each entity (unique queue or topic) per [MessagingFactory][MessagingFactory] instance per client will be pinged when they are considered to be unavailable.</span></span> <span data-ttu-id="92cdc-190">Som standard är detta sker en gång per minut.</span><span class="sxs-lookup"><span data-stu-id="92cdc-190">By default, this happens once per minute.</span></span> <span data-ttu-id="92cdc-191">Ping-meddelanden anses vara vanliga Service Bus-meddelanden och kan resultera i kostnader för bandbredd och meddelanden.</span><span class="sxs-lookup"><span data-stu-id="92cdc-191">Ping messages are considered to be regular Service Bus messages, and can result in charges for bandwidth and messages.</span></span> <span data-ttu-id="92cdc-192">När klienter identifiera att systemet är tillgängligt, stoppa meddelanden.</span><span class="sxs-lookup"><span data-stu-id="92cdc-192">As soon as the clients detect that the system is available, the messages stop.</span></span>

## <a name="the-syphon"></a><span data-ttu-id="92cdc-193">Syphon</span><span class="sxs-lookup"><span data-stu-id="92cdc-193">The syphon</span></span>
<span data-ttu-id="92cdc-194">Minst ett körbart program i programmet bör aktivt köra syphon.</span><span class="sxs-lookup"><span data-stu-id="92cdc-194">At least one executable program in the application should be actively running the syphon.</span></span> <span data-ttu-id="92cdc-195">Syphon utför lång avsökning får som pågår i 15 minuter.</span><span class="sxs-lookup"><span data-stu-id="92cdc-195">The syphon performs a long poll receive that lasts 15 minutes.</span></span> <span data-ttu-id="92cdc-196">När du har 10 eftersläpning köer och alla entiteter som är tillgängliga anropar programmet som är värd för syphon mottagningsåtgärd 40 gånger per timme, 960 gånger per dag och 28800 gånger i 30 dagar.</span><span class="sxs-lookup"><span data-stu-id="92cdc-196">When all entities are available and you have 10 backlog queues, the application that hosts the syphon calls the receive operation 40 times per hour, 960 times per day, and 28800 times in 30 days.</span></span> <span data-ttu-id="92cdc-197">När syphon är aktivt flyttar meddelanden från eftersläpningen till primära kön, inträffar följande avgifterna (standard kostnader för meddelandestorlek och bandbredd som används i alla led) i varje meddelande:</span><span class="sxs-lookup"><span data-stu-id="92cdc-197">When the syphon is actively moving messages from the backlog to the primary queue, each message experiences the following charges (standard charges for message size and bandwidth apply in all stages):</span></span>

1. <span data-ttu-id="92cdc-198">Skicka till eftersläpningen.</span><span class="sxs-lookup"><span data-stu-id="92cdc-198">Send to the backlog.</span></span>
2. <span data-ttu-id="92cdc-199">Ta emot från eftersläpningen.</span><span class="sxs-lookup"><span data-stu-id="92cdc-199">Receive from the backlog.</span></span>
3. <span data-ttu-id="92cdc-200">Skicka till den primära servern.</span><span class="sxs-lookup"><span data-stu-id="92cdc-200">Send to the primary.</span></span>
4. <span data-ttu-id="92cdc-201">Ta emot från den primära servern.</span><span class="sxs-lookup"><span data-stu-id="92cdc-201">Receive from the primary.</span></span>

## <a name="closefault-behavior"></a><span data-ttu-id="92cdc-202">Stäng/fel beteende</span><span class="sxs-lookup"><span data-stu-id="92cdc-202">Close/fault behavior</span></span>
<span data-ttu-id="92cdc-203">I ett program som är värd för syphon, när primärt eller sekundära [MessagingFactory] [ MessagingFactory] hos eller stängs utan sin partner som också är fel/stängd och syphon identifierar det här tillståndet syphon handlingar.</span><span class="sxs-lookup"><span data-stu-id="92cdc-203">Within an application that hosts the syphon, once the primary or secondary [MessagingFactory][MessagingFactory] faults or is closed without its partner also being faulted/closed and the syphon detects this state, the syphon acts.</span></span> <span data-ttu-id="92cdc-204">Om den andra [MessagingFactory] [ MessagingFactory] inte är stängd inom 5 sekunder, kommer syphon fault fortfarande öppen [MessagingFactory][MessagingFactory].</span><span class="sxs-lookup"><span data-stu-id="92cdc-204">If the other [MessagingFactory][MessagingFactory] is not closed within 5 seconds, the syphon will fault the still open [MessagingFactory][MessagingFactory].</span></span>

## <a name="next-steps"></a><span data-ttu-id="92cdc-205">Nästa steg</span><span class="sxs-lookup"><span data-stu-id="92cdc-205">Next steps</span></span>
<span data-ttu-id="92cdc-206">Se [asynkrona meddelanden mönster och hög tillgänglighet] [ Asynchronous messaging patterns and high availability] för en detaljerad beskrivning av asynkrona Service Bus-meddelanden.</span><span class="sxs-lookup"><span data-stu-id="92cdc-206">See [Asynchronous messaging patterns and high availability][Asynchronous messaging patterns and high availability] for a detailed discussion of Service Bus asynchronous messaging.</span></span> 

[PairNamespaceAsync]: /dotnet/api/microsoft.servicebus.messaging.messagingfactory#Microsoft_ServiceBus_Messaging_MessagingFactory_PairNamespaceAsync_Microsoft_ServiceBus_Messaging_PairedNamespaceOptions_
[SendAvailabilityPairedNamespaceOptions]: /dotnet/api/microsoft.servicebus.messaging.sendavailabilitypairednamespaceoptions
[MessageSender]: /dotnet/api/microsoft.servicebus.messaging.messagesender
[MessagingFactory]: /dotnet/api/microsoft.servicebus.messaging.messagingfactory
[FailoverInterval]: /dotnet/api/microsoft.servicebus.messaging.pairednamespaceoptions#Microsoft_ServiceBus_Messaging_PairedNamespaceOptions_FailoverInterval
[MessagingException]: /dotnet/api/microsoft.servicebus.messaging.messagingexception
[TimeoutException]: https://msdn.microsoft.com/library/azure/system.timeoutexception.aspx
[BrokeredMessage]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage
[QueueDescription]: /dotnet/api/microsoft.servicebus.messaging.queuedescription
[TimeSpan]: https://msdn.microsoft.com/library/azure/system.timespan.aspx
[PingPrimaryInterval]: /dotnet/api/microsoft.servicebus.messaging.sendavailabilitypairednamespaceoptions#Microsoft_ServiceBus_Messaging_SendAvailabilityPairedNamespaceOptions_PingPrimaryInterval
[QueueClient]: /dotnet/api/microsoft.servicebus.messaging.queueclient
[TopicClient]: /dotnet/api/microsoft.servicebus.messaging.topicclient
[ContentType]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_ContentType
[TimeToLive]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_TimeToLive
[Asynchronous messaging patterns and high availability]: service-bus-async-messaging.md
[0]: ./media/service-bus-paired-namespaces/IC673405.png
[1]: ./media/service-bus-paired-namespaces/IC673406.png
[2]: ./media/service-bus-paired-namespaces/IC673407.png
