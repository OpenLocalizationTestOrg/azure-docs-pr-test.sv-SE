---
title: "Azure Service Bus-autentisering med signaturer för delad åtkomst | Microsoft Docs"
description: "Översikt över Service Bus-autentisering med hjälp av signaturer för delad åtkomst översikt, information om SAS-autentisering med Azure Service Bus."
services: service-bus-messaging
documentationcenter: na
author: sethmanheim
manager: timlt
editor: 
ms.assetid: 
ms.service: service-bus-messaging
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 08/23/2017
ms.author: sethm
ms.openlocfilehash: a2760072acb7c62204759f3ec0d3cb9899460f2d
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 08/29/2017
---
# <a name="service-bus-authentication-with-shared-access-signatures"></a><span data-ttu-id="a2a09-103">Service Bus-autentisering med signaturer för delad åtkomst</span><span class="sxs-lookup"><span data-stu-id="a2a09-103">Service Bus authentication with Shared Access Signatures</span></span>

<span data-ttu-id="a2a09-104">*Signaturer för delad åtkomst* (SAS) är den primära säkerhetsmekanism för Service Bus-meddelanden.</span><span class="sxs-lookup"><span data-stu-id="a2a09-104">*Shared Access Signatures* (SAS) are the primary security mechanism for Service Bus messaging.</span></span> <span data-ttu-id="a2a09-105">Den här artikeln beskrivs SAS, hur de fungerar och hur du använder dem i ett plattformsoberoende sätt.</span><span class="sxs-lookup"><span data-stu-id="a2a09-105">This article discusses SAS, how they work, and how to use them in a platform-agnostic way.</span></span>

<span data-ttu-id="a2a09-106">SAS-autentisering gör det möjligt för program att autentisera till Service Bus med hjälp av en åtkomstnyckel som konfigurerats på namnområdet eller meddelandeentitet (kö eller ett ämne) som specifika rättigheter associeras.</span><span class="sxs-lookup"><span data-stu-id="a2a09-106">SAS authentication enables applications to authenticate to Service Bus using an access key configured on the namespace, or on the messaging entity (queue or topic) with which specific rights are associated.</span></span> <span data-ttu-id="a2a09-107">Du kan sedan använda denna nyckel för att generera en SAS-token som klienter i sin tur kan använda för att autentisera till Service Bus.</span><span class="sxs-lookup"><span data-stu-id="a2a09-107">You can then use this key to generate a SAS token that clients can in turn use to authenticate to Service Bus.</span></span>

<span data-ttu-id="a2a09-108">Stöd för SAS-autentisering ingår i Azure SDK version 2.0 och senare.</span><span class="sxs-lookup"><span data-stu-id="a2a09-108">SAS authentication support is included in the Azure SDK version 2.0 and later.</span></span>

## <a name="overview-of-sas"></a><span data-ttu-id="a2a09-109">Översikt över SAS</span><span class="sxs-lookup"><span data-stu-id="a2a09-109">Overview of SAS</span></span>

<span data-ttu-id="a2a09-110">Signaturer för delad åtkomst är en autentiseringsmekanism baserat på SHA-256 säker hashvärden eller URI: er.</span><span class="sxs-lookup"><span data-stu-id="a2a09-110">Shared Access Signatures are an authentication mechanism based on SHA-256 secure hashes or URIs.</span></span> <span data-ttu-id="a2a09-111">SAS är en mycket kraftfull mekanism som används av alla Service Bus-tjänster.</span><span class="sxs-lookup"><span data-stu-id="a2a09-111">SAS is an extremely powerful mechanism that is used by all Service Bus services.</span></span> <span data-ttu-id="a2a09-112">Faktiska används SAS består av två komponenter: en *delad åtkomstprincip* och en *signatur för delad åtkomst* (kallas ofta för en *token*).</span><span class="sxs-lookup"><span data-stu-id="a2a09-112">In actual use, SAS has two components: a *shared access policy* and a *Shared Access Signature* (often called a *token*).</span></span>

<span data-ttu-id="a2a09-113">SAS-autentisering i Service Bus omfattar konfiguration av en krypteringsnyckel med associerade behörigheter på en Service Bus-resurs.</span><span class="sxs-lookup"><span data-stu-id="a2a09-113">SAS authentication in Service Bus involves the configuration of a cryptographic key with associated rights on a Service Bus resource.</span></span> <span data-ttu-id="a2a09-114">Klienter begär åtkomst till Service Bus-resurser genom att presentera en SAS-token.</span><span class="sxs-lookup"><span data-stu-id="a2a09-114">Clients claim access to Service Bus resources by presenting a SAS token.</span></span> <span data-ttu-id="a2a09-115">Denna token består av resurs-URI som används och en utgången signeras med den konfigurerade nyckeln.</span><span class="sxs-lookup"><span data-stu-id="a2a09-115">This token consists of the resource URI being accessed, and an expiry signed with the configured key.</span></span>

<span data-ttu-id="a2a09-116">Du kan konfigurera auktoriseringsregler för signatur för delad åtkomst på Service Bus [vidarebefordrar](service-bus-fundamentals-hybrid-solutions.md#relays), [köer](service-bus-fundamentals-hybrid-solutions.md#queues), och [avsnitt](service-bus-fundamentals-hybrid-solutions.md#topics).</span><span class="sxs-lookup"><span data-stu-id="a2a09-116">You can configure Shared Access Signature authorization rules on Service Bus [relays](service-bus-fundamentals-hybrid-solutions.md#relays), [queues](service-bus-fundamentals-hybrid-solutions.md#queues), and [topics](service-bus-fundamentals-hybrid-solutions.md#topics).</span></span>

<span data-ttu-id="a2a09-117">SAS-autentisering används följande element:</span><span class="sxs-lookup"><span data-stu-id="a2a09-117">SAS authentication uses the following elements:</span></span>

* <span data-ttu-id="a2a09-118">[Auktoriseringsregeln för delad åtkomst](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule): en 256-bitars kryptografiska primärnyckel i Base64-representation, ett valfritt sekundärnyckeln och ett nyckelnamn och associerade behörigheter (en samling *lyssna*, *skicka*, eller *hantera* rättigheter).</span><span class="sxs-lookup"><span data-stu-id="a2a09-118">[Shared Access authorization rule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule): A 256-bit primary cryptographic key in Base64 representation, an optional secondary key, and a key name and associated rights (a collection of *Listen*, *Send*, or *Manage* rights).</span></span>
* <span data-ttu-id="a2a09-119">[Delad Åtkomstsignatur](/dotnet/api/microsoft.servicebus.sharedaccesssignaturetokenprovider) token: genereras med hjälp av HMAC-SHA256 resurssträngen, som består av URI för den resurs som används och en utgången med den kryptografiska nyckeln.</span><span class="sxs-lookup"><span data-stu-id="a2a09-119">[Shared Access Signature](/dotnet/api/microsoft.servicebus.sharedaccesssignaturetokenprovider) token: Generated using the HMAC-SHA256 of a resource string, consisting of the URI of the resource that is accessed and an expiry, with the cryptographic key.</span></span> <span data-ttu-id="a2a09-120">Signaturen och andra element som beskrivs i följande avsnitt formateras till en sträng för att bilda SAS-token.</span><span class="sxs-lookup"><span data-stu-id="a2a09-120">The signature and other elements described in the following sections are formatted into a string to form the SAS token.</span></span>

## <a name="shared-access-policy"></a><span data-ttu-id="a2a09-121">Princip för delad åtkomst</span><span class="sxs-lookup"><span data-stu-id="a2a09-121">Shared access policy</span></span>

<span data-ttu-id="a2a09-122">Ett viktigt att förstå om SAS är att det börjar med en princip.</span><span class="sxs-lookup"><span data-stu-id="a2a09-122">An important thing to understand about SAS is that it starts with a policy.</span></span> <span data-ttu-id="a2a09-123">För varje princip du bestämmer dig för tre uppgifter: **namn**, **omfång**, och **behörigheter**.</span><span class="sxs-lookup"><span data-stu-id="a2a09-123">For each policy, you decide on three pieces of information: **name**, **scope**, and **permissions**.</span></span> <span data-ttu-id="a2a09-124">Den **namn** är precis som; ett unikt namn i detta scope.</span><span class="sxs-lookup"><span data-stu-id="a2a09-124">The **name** is just that; a unique name within that scope.</span></span> <span data-ttu-id="a2a09-125">Omfånget är så enkelt: det är URI: N för den aktuella resursen.</span><span class="sxs-lookup"><span data-stu-id="a2a09-125">The scope is easy enough: it's the URI of the resource in question.</span></span> <span data-ttu-id="a2a09-126">För en Service Bus-namnrymd omfånget är det fullständigt kvalificerade domännamnet (FQDN) som `https://<yournamespace>.servicebus.windows.net/`.</span><span class="sxs-lookup"><span data-stu-id="a2a09-126">For a Service Bus namespace, the scope is the fully qualified domain name (FQDN), such as `https://<yournamespace>.servicebus.windows.net/`.</span></span>

<span data-ttu-id="a2a09-127">Behörigheterna för en princip är i stort sett självförklarande:</span><span class="sxs-lookup"><span data-stu-id="a2a09-127">The available permissions for a policy are largely self-explanatory:</span></span>

* <span data-ttu-id="a2a09-128">Skicka</span><span class="sxs-lookup"><span data-stu-id="a2a09-128">Send</span></span>
* <span data-ttu-id="a2a09-129">Lyssna</span><span class="sxs-lookup"><span data-stu-id="a2a09-129">Listen</span></span>
* <span data-ttu-id="a2a09-130">Hantera</span><span class="sxs-lookup"><span data-stu-id="a2a09-130">Manage</span></span>

<span data-ttu-id="a2a09-131">När du har skapat principen tilldelas en *primärnyckel* och en *sekundärnyckeln*.</span><span class="sxs-lookup"><span data-stu-id="a2a09-131">After you create the policy, it is assigned a *Primary Key* and a *Secondary Key*.</span></span> <span data-ttu-id="a2a09-132">Dessa är kryptografiskt starka nycklar.</span><span class="sxs-lookup"><span data-stu-id="a2a09-132">These are cryptographically strong keys.</span></span> <span data-ttu-id="a2a09-133">Inte förlorar dem eller läcka ut de - de alltid är tillgängliga i den [Azure-portalen][Azure portal].</span><span class="sxs-lookup"><span data-stu-id="a2a09-133">Don't lose them or leak them - they'll always be available in the [Azure portal][Azure portal].</span></span> <span data-ttu-id="a2a09-134">Du kan använda någon av de genererade nycklarna och återskapa dem när som helst.</span><span class="sxs-lookup"><span data-stu-id="a2a09-134">You can use either of the generated keys, and you can regenerate them at any time.</span></span> <span data-ttu-id="a2a09-135">Men om du återskapa eller ändra den primära nyckeln i princip blir alla signaturer för delad åtkomst som skapats från den ogiltiga.</span><span class="sxs-lookup"><span data-stu-id="a2a09-135">However, if you regenerate or change the primary key in the policy, any Shared Access Signatures created from it will be invalidated.</span></span>

<span data-ttu-id="a2a09-136">När du skapar ett namnområde för Service Bus, skapas automatiskt en princip för hela namnområdet som kallas **RootManageSharedAccessKey**, och den här principen har alla behörigheter.</span><span class="sxs-lookup"><span data-stu-id="a2a09-136">When you create a Service Bus namespace, a policy is automatically created for the entire namespace called **RootManageSharedAccessKey**, and this policy has all permissions.</span></span> <span data-ttu-id="a2a09-137">Du inte logga in som **rot**, så att inte använda den här principen om det finns en mycket bra anledning.</span><span class="sxs-lookup"><span data-stu-id="a2a09-137">You don't log on as **root**, so don't use this policy unless there's a really good reason.</span></span> <span data-ttu-id="a2a09-138">Du kan skapa ytterligare principer i den **konfigurera** för namnområdet i portalen.</span><span class="sxs-lookup"><span data-stu-id="a2a09-138">You can create additional policies in the **Configure** tab for the namespace in the portal.</span></span> <span data-ttu-id="a2a09-139">Det är viktigt att Observera att en enda träd i Service Bus (namnområdet, kön, etc.) bara kan ha upp till 12 principer som är kopplade till den.</span><span class="sxs-lookup"><span data-stu-id="a2a09-139">It's important to note that a single tree level in Service Bus (namespace, queue, etc.) can only have up to 12 policies attached to it.</span></span>

## <a name="configuration-for-shared-access-signature-authentication"></a><span data-ttu-id="a2a09-140">Konfiguration för autentisering med signatur för delad åtkomst</span><span class="sxs-lookup"><span data-stu-id="a2a09-140">Configuration for Shared Access Signature authentication</span></span>
<span data-ttu-id="a2a09-141">Du kan konfigurera den [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule) regeln på Service Bus-namnområden, köer och ämnen.</span><span class="sxs-lookup"><span data-stu-id="a2a09-141">You can configure the [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule) rule on Service Bus namespaces, queues, or topics.</span></span> <span data-ttu-id="a2a09-142">Konfigurera en [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule) på en Service Bus prenumeration stöds inte för närvarande, men du kan använda regler som konfigurerats på ett namnområde eller avsnittet få säker åtkomst till prenumerationer.</span><span class="sxs-lookup"><span data-stu-id="a2a09-142">Configuring a [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule) on a Service Bus subscription is currently not supported, but you can use rules configured on a namespace or topic to secure access to subscriptions.</span></span> <span data-ttu-id="a2a09-143">En fungerande exempel som visar den här proceduren finns i [autentisering med delad signatur åtkomst (SAS) med Service Bus prenumerationer](http://code.msdn.microsoft.com/Using-Shared-Access-e605b37c) exempel.</span><span class="sxs-lookup"><span data-stu-id="a2a09-143">For a working sample that illustrates this procedure, see the [Using Shared Access Signature (SAS) authentication with Service Bus Subscriptions](http://code.msdn.microsoft.com/Using-Shared-Access-e605b37c) sample.</span></span>

<span data-ttu-id="a2a09-144">Maximalt 12 regler kan konfigureras på Service Bus-namnområde, kö eller i avsnittet.</span><span class="sxs-lookup"><span data-stu-id="a2a09-144">A maximum of 12 such rules can be configured on a Service Bus namespace, queue, or topic.</span></span> <span data-ttu-id="a2a09-145">Regler som har konfigurerats på ett Service Bus-namnområde som gäller för alla entiteter i namnutrymmet.</span><span class="sxs-lookup"><span data-stu-id="a2a09-145">Rules that are configured on a Service Bus namespace apply to all entities in that namespace.</span></span>

![SAS](./media/service-bus-sas/service-bus-namespace.png)

<span data-ttu-id="a2a09-147">I den här bilden är det *manageRuleNS*, *sendRuleNS*, och *listenRuleNS* auktoriseringsregler gäller både kön F1 och avsnittet T1, medan *listenRuleQ*  och *sendRuleQ* gäller endast för kön F1 och *sendRuleT* gäller enbart för avsnittet T1.</span><span class="sxs-lookup"><span data-stu-id="a2a09-147">In this figure, the *manageRuleNS*, *sendRuleNS*, and *listenRuleNS* authorization rules apply to both queue Q1 and topic T1, while *listenRuleQ* and *sendRuleQ* apply only to queue Q1 and *sendRuleT* applies only to topic T1.</span></span>

<span data-ttu-id="a2a09-148">De viktigaste parametrarna för en [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule) är följande:</span><span class="sxs-lookup"><span data-stu-id="a2a09-148">The key parameters of a [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule) are as follows:</span></span>

| <span data-ttu-id="a2a09-149">Parameter</span><span class="sxs-lookup"><span data-stu-id="a2a09-149">Parameter</span></span> | <span data-ttu-id="a2a09-150">Beskrivning</span><span class="sxs-lookup"><span data-stu-id="a2a09-150">Description</span></span> |
| --- | --- |
| <span data-ttu-id="a2a09-151">*Nyckelnamn*</span><span class="sxs-lookup"><span data-stu-id="a2a09-151">*KeyName*</span></span> |<span data-ttu-id="a2a09-152">En sträng som beskriver auktoriseringsregeln.</span><span class="sxs-lookup"><span data-stu-id="a2a09-152">A string that describes the authorization rule.</span></span> |
| <span data-ttu-id="a2a09-153">*PrimaryKey*</span><span class="sxs-lookup"><span data-stu-id="a2a09-153">*PrimaryKey*</span></span> |<span data-ttu-id="a2a09-154">En base64-kodad 256-bitars primär nyckel för signering och verifiera SAS-token.</span><span class="sxs-lookup"><span data-stu-id="a2a09-154">A base64-encoded 256-bit primary key for signing and validating the SAS token.</span></span> |
| <span data-ttu-id="a2a09-155">*Sekundär nyckel*</span><span class="sxs-lookup"><span data-stu-id="a2a09-155">*SecondaryKey*</span></span> |<span data-ttu-id="a2a09-156">En base64-kodad 256-bitars sekundär nyckel för signering och verifiera SAS-token.</span><span class="sxs-lookup"><span data-stu-id="a2a09-156">A base64-encoded 256-bit secondary key for signing and validating the SAS token.</span></span> |
| <span data-ttu-id="a2a09-157">*AccessRights*</span><span class="sxs-lookup"><span data-stu-id="a2a09-157">*AccessRights*</span></span> |<span data-ttu-id="a2a09-158">En lista över åtkomsträttigheter som beviljats av auktoriseringsregeln.</span><span class="sxs-lookup"><span data-stu-id="a2a09-158">A list of access rights granted by the authorization rule.</span></span> <span data-ttu-id="a2a09-159">Dessa rättigheter kan vara en samling av lyssna, skicka och hantera rättigheter.</span><span class="sxs-lookup"><span data-stu-id="a2a09-159">These rights can be any collection of Listen, Send, and Manage rights.</span></span> |

<span data-ttu-id="a2a09-160">När ett namnområde för Service Bus etableras en [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule), med [KeyName](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule#Microsoft_ServiceBus_Messaging_SharedAccessAuthorizationRule_KeyName) inställd på **RootManageSharedAccessKey**, skapas som standard.</span><span class="sxs-lookup"><span data-stu-id="a2a09-160">When a Service Bus namespace is provisioned, a [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule), with [KeyName](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule#Microsoft_ServiceBus_Messaging_SharedAccessAuthorizationRule_KeyName) set to **RootManageSharedAccessKey**, is created by default.</span></span>

## <a name="generate-a-shared-access-signature-token"></a><span data-ttu-id="a2a09-161">Generera en signatur för delad åtkomst (token)</span><span class="sxs-lookup"><span data-stu-id="a2a09-161">Generate a Shared Access Signature (token)</span></span>

<span data-ttu-id="a2a09-162">Principen är inte åtkomsttoken för Service Bus.</span><span class="sxs-lookup"><span data-stu-id="a2a09-162">The policy itself is not the access token for Service Bus.</span></span> <span data-ttu-id="a2a09-163">Det är det objekt som den åtkomst-token genereras - med antingen den primära och sekundära nycklarna.</span><span class="sxs-lookup"><span data-stu-id="a2a09-163">It is the object from which the access token is generated - using either the primary or secondary key.</span></span> <span data-ttu-id="a2a09-164">Alla klienter som har åtkomst till Signeringsnycklar som anges i auktoriseringsregeln för delad åtkomst kan generera SAS-token.</span><span class="sxs-lookup"><span data-stu-id="a2a09-164">Any client that has access to the signing keys specified in the shared access authorization rule can generate the SAS token.</span></span> <span data-ttu-id="a2a09-165">Token som genereras av noggrant utforma en sträng i följande format:</span><span class="sxs-lookup"><span data-stu-id="a2a09-165">The token is generated by carefully crafting a string in the following format:</span></span>

```
SharedAccessSignature sig=<signature-string>&se=<expiry>&skn=<keyName>&sr=<URL-encoded-resourceURI>
```

<span data-ttu-id="a2a09-166">Där `signature-string` är SHA-256-hash för omfånget för token (**omfång** enligt beskrivningen i föregående avsnitt) med en CRLF läggs och en förfallotiden (i sekunder sedan epok: `00:00:00 UTC` på 1 januari 1970).</span><span class="sxs-lookup"><span data-stu-id="a2a09-166">Where `signature-string` is the SHA-256 hash of the scope of the token (**scope** as described in the previous section) with a CRLF appended and an expiry time (in seconds since the epoch: `00:00:00 UTC` on 1 January 1970).</span></span> 

> [!NOTE]
> <span data-ttu-id="a2a09-167">För att undvika en kort förfallotid för token, rekommenderas du att koda utgången tidsvärde som minst en 32-bitars heltal eller helst en lång (64-bitars) heltal.</span><span class="sxs-lookup"><span data-stu-id="a2a09-167">To avoid a short token expiry time, it is recommended that you encode the expiry time value as at least a 32-bit unsigned integer, or preferably a long (64-bit) integer.</span></span>  
> 
> 

<span data-ttu-id="a2a09-168">Hash-algoritmen liknar följande pseudokolumner kod och returnerar 32 byte.</span><span class="sxs-lookup"><span data-stu-id="a2a09-168">The hash looks similar to the following pseudo code and returns 32 bytes.</span></span>

```
SHA-256('https://<yournamespace>.servicebus.windows.net/'+'\n'+ 1438205742)
```

<span data-ttu-id="a2a09-169">Icke-hash-värden är i den **SharedAccessSignature** sträng så att mottagaren kan beräkna hash med samma parametrar för att kontrollera att returnera samma resultat.</span><span class="sxs-lookup"><span data-stu-id="a2a09-169">The non-hashed values are in the **SharedAccessSignature** string so that the recipient can compute the hash with the same parameters, to be sure that it returns the same result.</span></span> <span data-ttu-id="a2a09-170">URI: N anger scope och nyckelnamnet identifierar principen som ska användas för att beräkna hash.</span><span class="sxs-lookup"><span data-stu-id="a2a09-170">The URI specifies the scope, and the key name identifies the policy to be used to compute the hash.</span></span> <span data-ttu-id="a2a09-171">Detta är viktigt ur säkerhetssynpunkt.</span><span class="sxs-lookup"><span data-stu-id="a2a09-171">This is important from a security standpoint.</span></span> <span data-ttu-id="a2a09-172">Om signaturen inte matchar den som beräknar mottagaren (Service Bus), nekas åtkomst.</span><span class="sxs-lookup"><span data-stu-id="a2a09-172">If the signature doesn't match that which the recipient (Service Bus) calculates, then access is denied.</span></span> <span data-ttu-id="a2a09-173">Nu kan du vara säker på att avsändaren hade åtkomst till nyckeln och bör beviljas rättigheter anges i principen.</span><span class="sxs-lookup"><span data-stu-id="a2a09-173">At this point you can be sure that the sender had access to the key and should be granted the rights specified in the policy.</span></span>

<span data-ttu-id="a2a09-174">Observera att du ska använda kodade resurs-URI för den här åtgärden.</span><span class="sxs-lookup"><span data-stu-id="a2a09-174">Note that you should use the encoded resource URI for this operation.</span></span> <span data-ttu-id="a2a09-175">Resurs-URI är fullständiga URI: N för Service Bus-resurs som åtkomst begärs.</span><span class="sxs-lookup"><span data-stu-id="a2a09-175">The resource URI is the full URI of the Service Bus resource to which access is claimed.</span></span> <span data-ttu-id="a2a09-176">Till exempel `http://<namespace>.servicebus.windows.net/<entityPath>` eller `sb://<namespace>.servicebus.windows.net/<entityPath>`, dvs `http://contoso.servicebus.windows.net/contosoTopics/T1/Subscriptions/S3`.</span><span class="sxs-lookup"><span data-stu-id="a2a09-176">For example, `http://<namespace>.servicebus.windows.net/<entityPath>` or `sb://<namespace>.servicebus.windows.net/<entityPath>`; that is, `http://contoso.servicebus.windows.net/contosoTopics/T1/Subscriptions/S3`.</span></span>

<span data-ttu-id="a2a09-177">Delad åtkomst auktoriseringsregeln användas för signering måste konfigureras på enheten som anges av den här URI: N eller av en av dess hierarkiska överordnade.</span><span class="sxs-lookup"><span data-stu-id="a2a09-177">The shared access authorization rule used for signing must be configured on the entity specified by this URI, or by one of its hierarchical parents.</span></span> <span data-ttu-id="a2a09-178">Till exempel `http://contoso.servicebus.windows.net/contosoTopics/T1` eller `http://contoso.servicebus.windows.net` i föregående exempel.</span><span class="sxs-lookup"><span data-stu-id="a2a09-178">For example, `http://contoso.servicebus.windows.net/contosoTopics/T1` or `http://contoso.servicebus.windows.net` in the previous example.</span></span>

<span data-ttu-id="a2a09-179">En SAS-token är giltig för alla resurser under den `<resourceURI>` används i den `signature-string`.</span><span class="sxs-lookup"><span data-stu-id="a2a09-179">A SAS token is valid for all resources under the `<resourceURI>` used in the `signature-string`.</span></span>

<span data-ttu-id="a2a09-180">Den [KeyName](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule#Microsoft_ServiceBus_Messaging_SharedAccessAuthorizationRule_KeyName) i SAS-token refererar till den **keyName** för delad åtkomst auktoriseringsregeln som används för att generera token.</span><span class="sxs-lookup"><span data-stu-id="a2a09-180">The [KeyName](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule#Microsoft_ServiceBus_Messaging_SharedAccessAuthorizationRule_KeyName) in the SAS token refers to the **keyName** of the shared access authorization rule used to generate the token.</span></span>

<span data-ttu-id="a2a09-181">Den *URL-kodade resourceURI* måste vara samma som den URI som används i strängen till logga under beräkningen av signaturen.</span><span class="sxs-lookup"><span data-stu-id="a2a09-181">The *URL-encoded-resourceURI* must be the same as the URI used in the string-to-sign during the computation of the signature.</span></span> <span data-ttu-id="a2a09-182">Det bör vara [procent-kodade](https://msdn.microsoft.com/library/4fkewx0t.aspx).</span><span class="sxs-lookup"><span data-stu-id="a2a09-182">It should be [percent-encoded](https://msdn.microsoft.com/library/4fkewx0t.aspx).</span></span>

<span data-ttu-id="a2a09-183">Vi rekommenderar att du regelbundet återskapar nycklarna som används i den [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule) objekt.</span><span class="sxs-lookup"><span data-stu-id="a2a09-183">It is recommended that you periodically regenerate the keys used in the [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule) object.</span></span> <span data-ttu-id="a2a09-184">Program som normalt används den [PrimaryKey](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule#Microsoft_ServiceBus_Messaging_SharedAccessAuthorizationRule_PrimaryKey) att generera en SAS-token.</span><span class="sxs-lookup"><span data-stu-id="a2a09-184">Applications should generally use the [PrimaryKey](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule#Microsoft_ServiceBus_Messaging_SharedAccessAuthorizationRule_PrimaryKey) to generate a SAS token.</span></span> <span data-ttu-id="a2a09-185">När du återskapar nycklarna, bör du ersätta den [sekundär nyckel](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule#Microsoft_ServiceBus_Messaging_SharedAccessAuthorizationRule_SecondaryKey) med den gamla primärt nyckeln och skapa en ny nyckel som den nya primärnyckeln.</span><span class="sxs-lookup"><span data-stu-id="a2a09-185">When regenerating the keys, you should replace the [SecondaryKey](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule#Microsoft_ServiceBus_Messaging_SharedAccessAuthorizationRule_SecondaryKey) with the old primary key, and generate a new key as the new primary key.</span></span> <span data-ttu-id="a2a09-186">Detta gör att du kan fortsätta att använda token för auktorisering som har utfärdats med den gamla primära nyckeln och som ännu inte har gått ut.</span><span class="sxs-lookup"><span data-stu-id="a2a09-186">This enables you to continue using tokens for authorization that were issued with the old primary key, and that have not yet expired.</span></span>

<span data-ttu-id="a2a09-187">Om en nyckel manipuleras och du behöver återkalla nycklarna kan du återskapa både den [PrimaryKey](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule#Microsoft_ServiceBus_Messaging_SharedAccessAuthorizationRule_PrimaryKey) och [sekundär nyckel](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule#Microsoft_ServiceBus_Messaging_SharedAccessAuthorizationRule_SecondaryKey) av en [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule)genom att byta ut dem med nya nycklar.</span><span class="sxs-lookup"><span data-stu-id="a2a09-187">If a key is compromised and you have to revoke the keys, you can regenerate both the [PrimaryKey](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule#Microsoft_ServiceBus_Messaging_SharedAccessAuthorizationRule_PrimaryKey) and the [SecondaryKey](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule#Microsoft_ServiceBus_Messaging_SharedAccessAuthorizationRule_SecondaryKey) of a [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule), replacing them with new keys.</span></span> <span data-ttu-id="a2a09-188">Den här proceduren upphäver alla token som signerats med de gamla nycklarna.</span><span class="sxs-lookup"><span data-stu-id="a2a09-188">This procedure invalidates all tokens signed with the old keys.</span></span>

## <a name="how-to-use-shared-access-signature-authentication-with-service-bus"></a><span data-ttu-id="a2a09-189">Hur du använder autentisering med signatur för delad åtkomst med Service Bus</span><span class="sxs-lookup"><span data-stu-id="a2a09-189">How to use Shared Access Signature authentication with Service Bus</span></span>

<span data-ttu-id="a2a09-190">Följande scenarier är konfigurationen av regler för auktorisering, generering av SAS-token och klientauktorisering.</span><span class="sxs-lookup"><span data-stu-id="a2a09-190">The following scenarios include configuration of authorization rules, generation of SAS tokens, and client authorization.</span></span>

<span data-ttu-id="a2a09-191">För en fullt fungerande exempel på ett Service Bus-program som visar konfiguration och använder SAS auktorisering finns [autentisering med signatur för delad åtkomst med Service Bus](http://code.msdn.microsoft.com/Shared-Access-Signature-0a88adf8).</span><span class="sxs-lookup"><span data-stu-id="a2a09-191">For a full working sample of a Service Bus application that illustrates the configuration and uses SAS authorization, see [Shared Access Signature authentication with Service Bus](http://code.msdn.microsoft.com/Shared-Access-Signature-0a88adf8).</span></span> <span data-ttu-id="a2a09-192">Ett relaterade exempel som visar hur SAS-auktoriseringsregler som konfigurerats på namnområden eller avsnitt för att skydda Service Bus-prenumerationer finns här: [med delade signatur åtkomst (SAS)-autentisering med Service Bus prenumerationer](http://code.msdn.microsoft.com/Using-Shared-Access-e605b37c).</span><span class="sxs-lookup"><span data-stu-id="a2a09-192">A related sample that illustrates the use of SAS authorization rules configured on namespaces or topics to secure Service Bus subscriptions is available here: [Using Shared Access Signature (SAS) authentication with Service Bus Subscriptions](http://code.msdn.microsoft.com/Using-Shared-Access-e605b37c).</span></span>

## <a name="access-shared-access-authorization-rules-on-a-namespace"></a><span data-ttu-id="a2a09-193">Åtkomst till delade åtkomst auktoriseringsregler för ett namnområde</span><span class="sxs-lookup"><span data-stu-id="a2a09-193">Access Shared Access Authorization rules on a namespace</span></span>

<span data-ttu-id="a2a09-194">Autentisering med datorcertifikat krävs för åtgärderna i roten för Service Bus-namnrymd.</span><span class="sxs-lookup"><span data-stu-id="a2a09-194">Operations on the Service Bus namespace root require certificate authentication.</span></span> <span data-ttu-id="a2a09-195">Du måste överföra ett certifikat för din Azure-prenumeration.</span><span class="sxs-lookup"><span data-stu-id="a2a09-195">You must upload a management certificate for your Azure subscription.</span></span> <span data-ttu-id="a2a09-196">Följ stegen för att ladda upp ett hanteringscertifikat [här](../cloud-services/cloud-services-configure-ssl-certificate-portal.md#step-3-upload-a-certificate)med hjälp av den [Azure-portalen][Azure portal].</span><span class="sxs-lookup"><span data-stu-id="a2a09-196">To upload a management certificate, follow the steps [here](../cloud-services/cloud-services-configure-ssl-certificate-portal.md#step-3-upload-a-certificate), using the [Azure portal][Azure portal].</span></span> <span data-ttu-id="a2a09-197">Mer information om Azure-hanteringscertifikat finns i [översikt över Azure certifikat](../cloud-services/cloud-services-certs-create.md#what-are-management-certificates).</span><span class="sxs-lookup"><span data-stu-id="a2a09-197">For more information about Azure management certificates, see the [Azure certificates overview](../cloud-services/cloud-services-certs-create.md#what-are-management-certificates).</span></span>

<span data-ttu-id="a2a09-198">Slutpunkten för åtkomst till auktoriseringsregler för delad åtkomst på en Service Bus-namnrymd är följande:</span><span class="sxs-lookup"><span data-stu-id="a2a09-198">The endpoint for accessing shared access authorization rules on a Service Bus namespace is as follows:</span></span>

```http
https://management.core.windows.net/{subscriptionId}/services/ServiceBus/namespaces/{namespace}/AuthorizationRules/
```

<span data-ttu-id="a2a09-199">Så här skapar du en [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule) objekt på en Service Bus-namnrymd, köra en POST-åtgärden på den här slutpunkten med information om regeln serialiserad som JSON eller XML.</span><span class="sxs-lookup"><span data-stu-id="a2a09-199">To create a [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule) object on a Service Bus namespace, execute a POST operation on this endpoint with the rule information serialized as JSON or XML.</span></span> <span data-ttu-id="a2a09-200">Exempel:</span><span class="sxs-lookup"><span data-stu-id="a2a09-200">For example:</span></span>

```csharp
// Base address for accessing authorization rules on a namespace
string baseAddress = @"https://management.core.windows.net/<subscriptionId>/services/ServiceBus/namespaces/<namespace>/AuthorizationRules/";

// Configure authorization rule with base64-encoded 256-bit key and Send rights
var sendRule = new SharedAccessAuthorizationRule("contosoSendAll",
    SharedAccessAuthorizationRule.GenerateRandomKey(),
    new[] { AccessRights.Send });

// Operations on the Service Bus namespace root require certificate authentication.
WebRequestHandler handler = new WebRequestHandler
{
    ClientCertificateOptions = ClientCertificateOption.Manual
};
// Access the management certificate by subject name
handler.ClientCertificates.Add(GetCertificate(<certificateSN>));

HttpClient httpClient = new HttpClient(handler)
{
    BaseAddress = new Uri(baseAddress)
};
httpClient.DefaultRequestHeaders.Accept.Add(
    new MediaTypeWithQualityHeaderValue("application/json"));
httpClient.DefaultRequestHeaders.Add("x-ms-version", "2015-01-01");

// Execute a POST operation on the baseAddress above to create an auth rule
var postResult = httpClient.PostAsJsonAsync("", sendRule).Result;
```

<span data-ttu-id="a2a09-201">På liknande sätt kan använda en GET-åtgärd på slutpunkten för att läsa auktoriseringsregler som konfigurerats på namnområdet.</span><span class="sxs-lookup"><span data-stu-id="a2a09-201">Similarly, use a GET operation on the endpoint to read the authorization rules configured on the namespace.</span></span>

<span data-ttu-id="a2a09-202">Uppdatera eller ta bort en specifik auktoriseringsregeln, Använd följande slutpunkt:</span><span class="sxs-lookup"><span data-stu-id="a2a09-202">To update or delete a specific authorization rule, use the following endpoint:</span></span>

```http
https://management.core.windows.net/{subscriptionId}/services/ServiceBus/namespaces/{namespace}/AuthorizationRules/{KeyName}
```

## <a name="access-shared-access-authorization-rules-on-an-entity"></a><span data-ttu-id="a2a09-203">Åtkomst till delade åtkomst auktoriseringsregler för en entitet</span><span class="sxs-lookup"><span data-stu-id="a2a09-203">Access Shared Access Authorization rules on an entity</span></span>

<span data-ttu-id="a2a09-204">Du kan komma åt en [Microsoft.ServiceBus.Messaging.SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule) objekt som konfigurerats på en Service Bus-kö eller ett ämne via den [AuthorizationRules](/dotnet/api/microsoft.servicebus.messaging.authorizationrules) samling i den motsvarande [QueueDescription](/dotnet/api/microsoft.servicebus.messaging.queuedescription) eller [TopicDescription](/dotnet/api/microsoft.servicebus.messaging.topicdescription).</span><span class="sxs-lookup"><span data-stu-id="a2a09-204">You can access a [Microsoft.ServiceBus.Messaging.SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule) object configured on a Service Bus queue or topic through the [AuthorizationRules](/dotnet/api/microsoft.servicebus.messaging.authorizationrules) collection in the corresponding [QueueDescription](/dotnet/api/microsoft.servicebus.messaging.queuedescription) or [TopicDescription](/dotnet/api/microsoft.servicebus.messaging.topicdescription).</span></span>

<span data-ttu-id="a2a09-205">Följande kod visar hur du lägger till auktoriseringsregler för en kö.</span><span class="sxs-lookup"><span data-stu-id="a2a09-205">The following code shows how to add authorization rules for a queue.</span></span>

```csharp
// Create an instance of NamespaceManager for the operation
NamespaceManager nsm = NamespaceManager.CreateFromConnectionString(
    <connectionString> );
QueueDescription qd = new QueueDescription( <qPath> );

// Create a rule with send rights with keyName as "contosoQSendKey"
// and add it to the queue description.
qd.Authorization.Add(new SharedAccessAuthorizationRule("contosoSendKey",
    SharedAccessAuthorizationRule.GenerateRandomKey(),
    new[] { AccessRights.Send }));

// Create a rule with listen rights with keyName as "contosoQListenKey"
// and add it to the queue description.
qd.Authorization.Add(new SharedAccessAuthorizationRule("contosoQListenKey",
    SharedAccessAuthorizationRule.GenerateRandomKey(),
    new[] { AccessRights.Listen }));

// Create a rule with manage rights with keyName as "contosoQManageKey"
// and add it to the queue description.
// A rule with manage rights must also have send and receive rights.
qd.Authorization.Add(new SharedAccessAuthorizationRule("contosoQManageKey",
    SharedAccessAuthorizationRule.GenerateRandomKey(),
    new[] {AccessRights.Manage, AccessRights.Listen, AccessRights.Send }));

// Create the queue.
nsm.CreateQueue(qd);
```

## <a name="use-shared-access-signature-authorization"></a><span data-ttu-id="a2a09-206">Använda signatur för delad åtkomst auktoriseringsregler</span><span class="sxs-lookup"><span data-stu-id="a2a09-206">Use Shared Access Signature authorization</span></span>

<span data-ttu-id="a2a09-207">Program med Azure .NET SDK med Service Bus .NET-biblioteken kan använda SAS tillstånd via den [SharedAccessSignatureTokenProvider](/dotnet/api/microsoft.servicebus.sharedaccesssignaturetokenprovider) klass.</span><span class="sxs-lookup"><span data-stu-id="a2a09-207">Applications using the Azure .NET SDK with the Service Bus .NET libraries can use SAS authorization through the [SharedAccessSignatureTokenProvider](/dotnet/api/microsoft.servicebus.sharedaccesssignaturetokenprovider) class.</span></span> <span data-ttu-id="a2a09-208">Följande kod visar hur tokenleverantör för att skicka meddelanden till en Service Bus-kö.</span><span class="sxs-lookup"><span data-stu-id="a2a09-208">The following code illustrates the use of the token provider to send messages to a Service Bus queue.</span></span>

```csharp
Uri runtimeUri = ServiceBusEnvironment.CreateServiceUri("sb",
    <yourServiceNamespace>, string.Empty);
MessagingFactory mf = MessagingFactory.Create(runtimeUri,
    TokenProvider.CreateSharedAccessSignatureTokenProvider(keyName, key));
QueueClient sendClient = mf.CreateQueueClient(qPath);

//Sending hello message to queue.
BrokeredMessage helloMessage = new BrokeredMessage("Hello, Service Bus!");
helloMessage.MessageId = "SAS-Sample-Message";
sendClient.Send(helloMessage);
```

<span data-ttu-id="a2a09-209">Program kan också använda SAS för autentisering med hjälp av en SAS-anslutningssträng i metoder som accepterar anslutningssträngar.</span><span class="sxs-lookup"><span data-stu-id="a2a09-209">Applications can also use SAS for authentication by using a SAS connection string in methods that accept connection strings.</span></span>

<span data-ttu-id="a2a09-210">Observera att om du vill använda SAS-auktorisering med Service Bus reläer, kan du använda SAS-nycklar som konfigurerats på Service Bus-namnrymd.</span><span class="sxs-lookup"><span data-stu-id="a2a09-210">Note that to use SAS authorization with Service Bus relays, you can use SAS keys configured on the Service Bus namespace.</span></span> <span data-ttu-id="a2a09-211">Om du skapar ett relä uttryckligen på namnområdet ([NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager) med en [RelayDescription](/dotnet/api/microsoft.servicebus.messaging.relaydescription)) objekt du kan ange SAS-regler för att relay.</span><span class="sxs-lookup"><span data-stu-id="a2a09-211">If you explicitly create a relay on the namespace ([NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager) with a [RelayDescription](/dotnet/api/microsoft.servicebus.messaging.relaydescription)) object, you can set the SAS rules just for that relay.</span></span> <span data-ttu-id="a2a09-212">För att använda SAS-auktorisering med Service Bus-prenumerationer måste använda du SAS-nycklar som konfigurerats på en Service Bus-namnrymd eller ett ämne.</span><span class="sxs-lookup"><span data-stu-id="a2a09-212">To use SAS authorization with Service Bus subscriptions, you can use SAS keys configured on a Service Bus namespace or on a topic.</span></span>

## <a name="use-the-shared-access-signature-at-http-level"></a><span data-ttu-id="a2a09-213">Använd signatur för delad åtkomst (på http-nivå)</span><span class="sxs-lookup"><span data-stu-id="a2a09-213">Use the Shared Access Signature (at HTTP level)</span></span>

<span data-ttu-id="a2a09-214">Nu när du vet hur du skapar signaturer för delad åtkomst för alla entiteter i Service Bus är du redo att utföra en HTTP POST:</span><span class="sxs-lookup"><span data-stu-id="a2a09-214">Now that you know how to create Shared Access Signatures for any entities in Service Bus, you are ready to perform an HTTP POST:</span></span>

```http
POST https://<yournamespace>.servicebus.windows.net/<yourentity>/messages
Content-Type: application/json
Authorization: SharedAccessSignature sr=https%3A%2F%2F<yournamespace>.servicebus.windows.net%2F<yourentity>&sig=<yoursignature from code above>&se=1438205742&skn=KeyName
ContentType: application/atom+xml;type=entry;charset=utf-8
``` 

<span data-ttu-id="a2a09-215">Kom ihåg att det fungerar för alla.</span><span class="sxs-lookup"><span data-stu-id="a2a09-215">Remember, this works for everything.</span></span> <span data-ttu-id="a2a09-216">Du kan skapa SAS för kön, ämnet och prenumerationen.</span><span class="sxs-lookup"><span data-stu-id="a2a09-216">You can create SAS for a queue, topic, or subscription.</span></span> 

<span data-ttu-id="a2a09-217">Om du ger en avsändare eller en SAS-token-klienten de har inte nyckeln direkt och de kan inte återställa hash för att hämta den.</span><span class="sxs-lookup"><span data-stu-id="a2a09-217">If you give a sender or client a SAS token, they don't have the key directly, and they cannot reverse the hash to obtain it.</span></span> <span data-ttu-id="a2a09-218">Som sådana har du kontroll över vad de kan komma åt och hur lång tid.</span><span class="sxs-lookup"><span data-stu-id="a2a09-218">As such, you have control over what they can access, and for how long.</span></span> <span data-ttu-id="a2a09-219">En viktig sak att komma ihåg är att om du ändrar den primära nyckeln i princip alla signaturer för delad åtkomst som skapats från den blir ogiltiga.</span><span class="sxs-lookup"><span data-stu-id="a2a09-219">An important thing to remember is that if you change the primary key in the policy, any Shared Access Signatures created from it will be invalidated.</span></span>

## <a name="use-the-shared-access-signature-at-amqp-level"></a><span data-ttu-id="a2a09-220">Använd signatur för delad åtkomst (på AMQP nivå)</span><span class="sxs-lookup"><span data-stu-id="a2a09-220">Use the Shared Access Signature (at AMQP level)</span></span>

<span data-ttu-id="a2a09-221">Du har sett hur du använder SAS-token med en HTTP POST-begäran för att skicka data till Service Bus i föregående avsnitt.</span><span class="sxs-lookup"><span data-stu-id="a2a09-221">In the previous section, you saw how to use the SAS token with an HTTP POST request for sending data to the Service Bus.</span></span> <span data-ttu-id="a2a09-222">Du kan komma åt Service Bus med hjälp av de avancerade Message Queuing Protocol (AMQP) som önskat protokoll ska användas av prestandaskäl i många scenarier som du vet.</span><span class="sxs-lookup"><span data-stu-id="a2a09-222">As you know, you can access Service Bus using the Advanced Message Queuing Protocol (AMQP) that is the preferred protocol to use for performance reasons, in many scenarios.</span></span> <span data-ttu-id="a2a09-223">SAS-token användning med AMQP beskrivs i dokumentet [AMQP Claim-Based Security Version 1.0](https://www.oasis-open.org/committees/download.php/50506/amqp-cbs-v1%200-wd02%202013-08-12.doc) som är i utkastet sedan 2013 men väl stöds av Azure idag.</span><span class="sxs-lookup"><span data-stu-id="a2a09-223">The SAS token usage with AMQP is described in the document [AMQP Claim-Based Security Version 1.0](https://www.oasis-open.org/committees/download.php/50506/amqp-cbs-v1%200-wd02%202013-08-12.doc) that is in working draft since 2013 but well-supported by Azure today.</span></span>

<span data-ttu-id="a2a09-224">Innan du börjar skicka data till Service Bus, utgivaren måste skicka SAS-token i en AMQP-meddelande till en väldefinierad AMQP nod med namnet **$cbs** (du kan se den som en ”särskilda” kö som används av tjänsten för att hämta och verifiera alla SAS token).</span><span class="sxs-lookup"><span data-stu-id="a2a09-224">Before starting to send data to Service Bus, the publisher must send the SAS token inside an AMQP message to a well-defined AMQP node named **$cbs** (you can see it as a "special" queue used by the service to acquire and validate all the SAS tokens).</span></span> <span data-ttu-id="a2a09-225">Utgivaren måste ange den **ReplyTo** fältet i AMQP-meddelande: det här är den nod där tjänsten svarar på utgivaren med resultatet av verifieringen av token (ett enkelt request/reply-mönster mellan utgivare och tjänsten ).</span><span class="sxs-lookup"><span data-stu-id="a2a09-225">The publisher must specify the **ReplyTo** field inside the AMQP message; this is the node in which the service replies to the publisher with the result of the token validation (a simple request/reply pattern between publisher and service).</span></span> <span data-ttu-id="a2a09-226">Detta svar noder har skapats ”i farten”, talar om ”skapas dynamiskt fjärrnoden”, enligt beskrivningen i AMQP 1.0-specifikationen.</span><span class="sxs-lookup"><span data-stu-id="a2a09-226">This reply node is created "on the fly," speaking about "dynamic creation of remote node" as described by the AMQP 1.0 specification.</span></span> <span data-ttu-id="a2a09-227">När du har kontrollerat att SAS-token är giltig utgivaren gå framåt och börja skicka data till tjänsten.</span><span class="sxs-lookup"><span data-stu-id="a2a09-227">After checking that the SAS token is valid, the publisher can go forward and start to send data to the service.</span></span>

<span data-ttu-id="a2a09-228">Följande steg visar hur du skickar SAS-token med AMQP protokollet den [AMQP.Net Lite](https://github.com/Azure/amqpnetlite) bibliotek.</span><span class="sxs-lookup"><span data-stu-id="a2a09-228">The following steps show how to send the SAS token with AMQP protocol using the [AMQP.Net Lite](https://github.com/Azure/amqpnetlite) library.</span></span> <span data-ttu-id="a2a09-229">Detta är användbart om du inte använda den officiella Service Bus SDK (till exempel på WinRT .net Compact Framework, .net Framework Micro och Mono) utveckla C\#.</span><span class="sxs-lookup"><span data-stu-id="a2a09-229">This is useful if you can't use the official Service Bus SDK (for example on WinRT, .Net Compact Framework, .Net Micro Framework and Mono) developing in C\#.</span></span> <span data-ttu-id="a2a09-230">Naturligtvis kan det här biblioteket är användbar för att förstå hur anspråksbaserade fungerar på AMQP-nivå som du såg hur det fungerar på HTTP-nivå (med en HTTP POST-begäran och den SAS-token som skickas i rubriken ”tillstånd”).</span><span class="sxs-lookup"><span data-stu-id="a2a09-230">Of course, this library is useful to help understand how claims-based security works at the AMQP level, as you saw how it works at the HTTP level (with an HTTP POST request and the SAS token sent inside the "Authorization" header).</span></span> <span data-ttu-id="a2a09-231">Om du inte behöver dessa djup kunskaper om AMQP, du kan använda den officiella Service Bus SDK med .net Framework-program, vilket gör det åt dig.</span><span class="sxs-lookup"><span data-stu-id="a2a09-231">If you don't need such deep knowledge about AMQP, you can use the official Service Bus SDK with .Net Framework applications, which will do it for you.</span></span>

### <a name="c35"></a><span data-ttu-id="a2a09-232">C&#35;</span><span class="sxs-lookup"><span data-stu-id="a2a09-232">C&#35;</span></span>

```csharp
/// <summary>
/// Send claim-based security (CBS) token
/// </summary>
/// <param name="shareAccessSignature">Shared access signature (token) to send</param>
private bool PutCbsToken(Connection connection, string sasToken)
{
    bool result = true;
    Session session = new Session(connection);

    string cbsClientAddress = "cbs-client-reply-to";
    var cbsSender = new SenderLink(session, "cbs-sender", "$cbs");
    var cbsReceiver = new ReceiverLink(session, cbsClientAddress, "$cbs");

    // construct the put-token message
    var request = new Message(sasToken);
    request.Properties = new Properties();
    request.Properties.MessageId = Guid.NewGuid().ToString();
    request.Properties.ReplyTo = cbsClientAddress;
    request.ApplicationProperties = new ApplicationProperties();
    request.ApplicationProperties["operation"] = "put-token";
    request.ApplicationProperties["type"] = "servicebus.windows.net:sastoken";
    request.ApplicationProperties["name"] = Fx.Format("amqp://{0}/{1}", sbNamespace, entity);
    cbsSender.Send(request);

    // receive the response
    var response = cbsReceiver.Receive();
    if (response == null || response.Properties == null || response.ApplicationProperties == null)
    {
        result = false;
    }
    else
    {
        int statusCode = (int)response.ApplicationProperties["status-code"];
        if (statusCode != (int)HttpStatusCode.Accepted && statusCode != (int)HttpStatusCode.OK)
        {
            result = false;
        }
    }

    // the sender/receiver may be kept open for refreshing tokens
    cbsSender.Close();
    cbsReceiver.Close();
    session.Close();

    return result;
}
```

<span data-ttu-id="a2a09-233">Den `PutCbsToken()` metoden tar emot den *anslutning* (AMQP anslutning-klassinstans som tillhandahålls av den [AMQP .NET Lite biblioteket](https://github.com/Azure/amqpnetlite)) som representerar TCP-anslutningen till tjänsten och *sasToken* parameter som är SAS-token för att skicka.</span><span class="sxs-lookup"><span data-stu-id="a2a09-233">The `PutCbsToken()` method receives the *connection* (AMQP connection class instance as provided by the [AMQP .NET Lite library](https://github.com/Azure/amqpnetlite)) that represents the TCP connection to the service and the *sasToken* parameter that is the SAS token to send.</span></span> 

> [!NOTE]
> <span data-ttu-id="a2a09-234">Det är viktigt att anslutningen har skapats med **SASL autentiseringsmekanism som har angetts till externa** (och inte standard OFORMATERAD med användarnamn och lösenord som används när du inte behöver skicka SAS-token).</span><span class="sxs-lookup"><span data-stu-id="a2a09-234">It's important that the connection is created with **SASL authentication mechanism set to EXTERNAL** (and not the default PLAIN with username and password used when you don't need to send the SAS token).</span></span>
> 
> 

<span data-ttu-id="a2a09-235">Sedan skapas två AMQP länkar för att skicka SAS-token och ta emot svar (token validering resultat) från tjänsten.</span><span class="sxs-lookup"><span data-stu-id="a2a09-235">Next, the publisher creates two AMQP links for sending the SAS token and receiving the reply (the token validation result) from the service.</span></span>

<span data-ttu-id="a2a09-236">AMQP meddelandet innehåller en uppsättning egenskaper och mer än ett enkelt meddelande.</span><span class="sxs-lookup"><span data-stu-id="a2a09-236">The AMQP message contains a set of properties, and more information than a simple message.</span></span> <span data-ttu-id="a2a09-237">SAS-token är brödtexten (med sin konstruktor).</span><span class="sxs-lookup"><span data-stu-id="a2a09-237">The SAS token is the body of the message (using its constructor).</span></span> <span data-ttu-id="a2a09-238">Den **”ReplyTo”** egenskap är inställd på nodnamnet för att ta emot validering resultatet på länken mottagaren (du kan ändra dess namn om du vill och den kommer att skapas dynamiskt av tjänsten).</span><span class="sxs-lookup"><span data-stu-id="a2a09-238">The **"ReplyTo"** property is set to the node name for receiving the validation result on the receiver link (you can change its name if you want, and it will be created dynamically by the service).</span></span> <span data-ttu-id="a2a09-239">De sista tre program/anpassade egenskaperna som används av tjänsten som anger vilken typ av åtgärd som den har att köra.</span><span class="sxs-lookup"><span data-stu-id="a2a09-239">The last three application/custom properties are used by the service to indicate what kind of operation it has to execute.</span></span> <span data-ttu-id="a2a09-240">Enligt specifikationen CBS utkast de måste vara den **åtgärdsnamn** (”put-token”), den **typ av token** (i det här fallet en ”servicebus.windows.net:sastoken”), och **”namn” målgruppen** som token gäller (hela entitet).</span><span class="sxs-lookup"><span data-stu-id="a2a09-240">As described by the CBS draft specification, they must be the **operation name** ("put-token"), the **type of token** (in this case, a "servicebus.windows.net:sastoken"), and the **"name" of the audience** to which the token applies (the entire entity).</span></span>

<span data-ttu-id="a2a09-241">När du har skickat SAS-token på länken avsändaren läsa utgivaren svaret på länken mottagare.</span><span class="sxs-lookup"><span data-stu-id="a2a09-241">After sending the SAS token on the sender link, the publisher must read the reply on the receiver link.</span></span> <span data-ttu-id="a2a09-242">Svaret är ett enkelt AMQP-meddelande med en program-egenskap med namnet **”statuskod”** som kan innehålla samma värden som en HTTP-statuskod.</span><span class="sxs-lookup"><span data-stu-id="a2a09-242">The reply is a simple AMQP message with an application property named **"status-code"** that can contain the same values as an HTTP status code.</span></span>

## <a name="rights-required-for-service-bus-operations"></a><span data-ttu-id="a2a09-243">Rättigheter som krävs för Service Bus-åtgärder</span><span class="sxs-lookup"><span data-stu-id="a2a09-243">Rights required for Service Bus operations</span></span>

<span data-ttu-id="a2a09-244">I följande tabell visas de behörigheter som krävs för olika åtgärder på Service Bus-resurser.</span><span class="sxs-lookup"><span data-stu-id="a2a09-244">The following table shows the access rights required for various operations on Service Bus resources.</span></span>

| <span data-ttu-id="a2a09-245">Åtgärd</span><span class="sxs-lookup"><span data-stu-id="a2a09-245">Operation</span></span> | <span data-ttu-id="a2a09-246">Anspråk krävs</span><span class="sxs-lookup"><span data-stu-id="a2a09-246">Claim Required</span></span> | <span data-ttu-id="a2a09-247">Anspråk omfång</span><span class="sxs-lookup"><span data-stu-id="a2a09-247">Claim Scope</span></span> |
| --- | --- | --- |
| <span data-ttu-id="a2a09-248">**Namespace**</span><span class="sxs-lookup"><span data-stu-id="a2a09-248">**Namespace**</span></span> | | |
| <span data-ttu-id="a2a09-249">Konfigurera auktoriseringsregeln för ett namnområde</span><span class="sxs-lookup"><span data-stu-id="a2a09-249">Configure authorization rule on a namespace</span></span> |<span data-ttu-id="a2a09-250">Hantera</span><span class="sxs-lookup"><span data-stu-id="a2a09-250">Manage</span></span> |<span data-ttu-id="a2a09-251">Alla adresser i namnområdet</span><span class="sxs-lookup"><span data-stu-id="a2a09-251">Any namespace address</span></span> |
| <span data-ttu-id="a2a09-252">**Tjänsten registret**</span><span class="sxs-lookup"><span data-stu-id="a2a09-252">**Service Registry**</span></span> | | |
| <span data-ttu-id="a2a09-253">Räkna upp privata principer</span><span class="sxs-lookup"><span data-stu-id="a2a09-253">Enumerate Private Policies</span></span> |<span data-ttu-id="a2a09-254">Hantera</span><span class="sxs-lookup"><span data-stu-id="a2a09-254">Manage</span></span> |<span data-ttu-id="a2a09-255">Alla adresser i namnområdet</span><span class="sxs-lookup"><span data-stu-id="a2a09-255">Any namespace address</span></span> |
| <span data-ttu-id="a2a09-256">Börja lyssna på ett namnområde</span><span class="sxs-lookup"><span data-stu-id="a2a09-256">Begin listening on a namespace</span></span> |<span data-ttu-id="a2a09-257">Lyssna</span><span class="sxs-lookup"><span data-stu-id="a2a09-257">Listen</span></span> |<span data-ttu-id="a2a09-258">Alla adresser i namnområdet</span><span class="sxs-lookup"><span data-stu-id="a2a09-258">Any namespace address</span></span> |
| <span data-ttu-id="a2a09-259">Skicka meddelanden till en lyssnare på en namnrymd</span><span class="sxs-lookup"><span data-stu-id="a2a09-259">Send messages to a listener at a namespace</span></span> |<span data-ttu-id="a2a09-260">Skicka</span><span class="sxs-lookup"><span data-stu-id="a2a09-260">Send</span></span> |<span data-ttu-id="a2a09-261">Alla adresser i namnområdet</span><span class="sxs-lookup"><span data-stu-id="a2a09-261">Any namespace address</span></span> |
| <span data-ttu-id="a2a09-262">**Kön**</span><span class="sxs-lookup"><span data-stu-id="a2a09-262">**Queue**</span></span> | | |
| <span data-ttu-id="a2a09-263">Skapa en kö</span><span class="sxs-lookup"><span data-stu-id="a2a09-263">Create a queue</span></span> |<span data-ttu-id="a2a09-264">Hantera</span><span class="sxs-lookup"><span data-stu-id="a2a09-264">Manage</span></span> |<span data-ttu-id="a2a09-265">Alla adresser i namnområdet</span><span class="sxs-lookup"><span data-stu-id="a2a09-265">Any namespace address</span></span> |
| <span data-ttu-id="a2a09-266">Ta bort en kö</span><span class="sxs-lookup"><span data-stu-id="a2a09-266">Delete a queue</span></span> |<span data-ttu-id="a2a09-267">Hantera</span><span class="sxs-lookup"><span data-stu-id="a2a09-267">Manage</span></span> |<span data-ttu-id="a2a09-268">En giltig kö-adress</span><span class="sxs-lookup"><span data-stu-id="a2a09-268">Any valid queue address</span></span> |
| <span data-ttu-id="a2a09-269">Räkna upp köer</span><span class="sxs-lookup"><span data-stu-id="a2a09-269">Enumerate queues</span></span> |<span data-ttu-id="a2a09-270">Hantera</span><span class="sxs-lookup"><span data-stu-id="a2a09-270">Manage</span></span> |<span data-ttu-id="a2a09-271">$ Resurser/köer</span><span class="sxs-lookup"><span data-stu-id="a2a09-271">/$Resources/Queues</span></span> |
| <span data-ttu-id="a2a09-272">Hämta en beskrivning av kön</span><span class="sxs-lookup"><span data-stu-id="a2a09-272">Get the queue description</span></span> |<span data-ttu-id="a2a09-273">Hantera</span><span class="sxs-lookup"><span data-stu-id="a2a09-273">Manage</span></span> |<span data-ttu-id="a2a09-274">En giltig kö-adress</span><span class="sxs-lookup"><span data-stu-id="a2a09-274">Any valid queue address</span></span> |
| <span data-ttu-id="a2a09-275">Konfigurera auktoriseringsregeln för en kö</span><span class="sxs-lookup"><span data-stu-id="a2a09-275">Configure authorization rule for a queue</span></span> |<span data-ttu-id="a2a09-276">Hantera</span><span class="sxs-lookup"><span data-stu-id="a2a09-276">Manage</span></span> |<span data-ttu-id="a2a09-277">En giltig kö-adress</span><span class="sxs-lookup"><span data-stu-id="a2a09-277">Any valid queue address</span></span> |
| <span data-ttu-id="a2a09-278">Skicka in till kön</span><span class="sxs-lookup"><span data-stu-id="a2a09-278">Send into to the queue</span></span> |<span data-ttu-id="a2a09-279">Skicka</span><span class="sxs-lookup"><span data-stu-id="a2a09-279">Send</span></span> |<span data-ttu-id="a2a09-280">En giltig kö-adress</span><span class="sxs-lookup"><span data-stu-id="a2a09-280">Any valid queue address</span></span> |
| <span data-ttu-id="a2a09-281">Ta emot meddelanden från en kö</span><span class="sxs-lookup"><span data-stu-id="a2a09-281">Receive messages from a queue</span></span> |<span data-ttu-id="a2a09-282">Lyssna</span><span class="sxs-lookup"><span data-stu-id="a2a09-282">Listen</span></span> |<span data-ttu-id="a2a09-283">En giltig kö-adress</span><span class="sxs-lookup"><span data-stu-id="a2a09-283">Any valid queue address</span></span> |
| <span data-ttu-id="a2a09-284">Avbryt eller slutföra meddelanden när du har fått meddelandet i titt låsläge</span><span class="sxs-lookup"><span data-stu-id="a2a09-284">Abandon or complete messages after receiving the message in peek-lock mode</span></span> |<span data-ttu-id="a2a09-285">Lyssna</span><span class="sxs-lookup"><span data-stu-id="a2a09-285">Listen</span></span> |<span data-ttu-id="a2a09-286">En giltig kö-adress</span><span class="sxs-lookup"><span data-stu-id="a2a09-286">Any valid queue address</span></span> |
| <span data-ttu-id="a2a09-287">Skjuta upp ett meddelande för senare hämtning</span><span class="sxs-lookup"><span data-stu-id="a2a09-287">Defer a message for later retrieval</span></span> |<span data-ttu-id="a2a09-288">Lyssna</span><span class="sxs-lookup"><span data-stu-id="a2a09-288">Listen</span></span> |<span data-ttu-id="a2a09-289">En giltig kö-adress</span><span class="sxs-lookup"><span data-stu-id="a2a09-289">Any valid queue address</span></span> |
| <span data-ttu-id="a2a09-290">Systemkön ett meddelande</span><span class="sxs-lookup"><span data-stu-id="a2a09-290">Deadletter a message</span></span> |<span data-ttu-id="a2a09-291">Lyssna</span><span class="sxs-lookup"><span data-stu-id="a2a09-291">Listen</span></span> |<span data-ttu-id="a2a09-292">En giltig kö-adress</span><span class="sxs-lookup"><span data-stu-id="a2a09-292">Any valid queue address</span></span> |
| <span data-ttu-id="a2a09-293">Hämta status som är kopplade till en message queue-session</span><span class="sxs-lookup"><span data-stu-id="a2a09-293">Get the state associated with a message queue session</span></span> |<span data-ttu-id="a2a09-294">Lyssna</span><span class="sxs-lookup"><span data-stu-id="a2a09-294">Listen</span></span> |<span data-ttu-id="a2a09-295">En giltig kö-adress</span><span class="sxs-lookup"><span data-stu-id="a2a09-295">Any valid queue address</span></span> |
| <span data-ttu-id="a2a09-296">Ange tillstånd som associeras med en message queue-session</span><span class="sxs-lookup"><span data-stu-id="a2a09-296">Set the state associated with a message queue session</span></span> |<span data-ttu-id="a2a09-297">Lyssna</span><span class="sxs-lookup"><span data-stu-id="a2a09-297">Listen</span></span> |<span data-ttu-id="a2a09-298">En giltig kö-adress</span><span class="sxs-lookup"><span data-stu-id="a2a09-298">Any valid queue address</span></span> |
| <span data-ttu-id="a2a09-299">**Avsnittet**</span><span class="sxs-lookup"><span data-stu-id="a2a09-299">**Topic**</span></span> | | |
| <span data-ttu-id="a2a09-300">Skapa ett ämne</span><span class="sxs-lookup"><span data-stu-id="a2a09-300">Create a topic</span></span> |<span data-ttu-id="a2a09-301">Hantera</span><span class="sxs-lookup"><span data-stu-id="a2a09-301">Manage</span></span> |<span data-ttu-id="a2a09-302">Alla adresser i namnområdet</span><span class="sxs-lookup"><span data-stu-id="a2a09-302">Any namespace address</span></span> |
| <span data-ttu-id="a2a09-303">Ta bort ett ämne</span><span class="sxs-lookup"><span data-stu-id="a2a09-303">Delete a topic</span></span> |<span data-ttu-id="a2a09-304">Hantera</span><span class="sxs-lookup"><span data-stu-id="a2a09-304">Manage</span></span> |<span data-ttu-id="a2a09-305">En giltig avsnittet adress</span><span class="sxs-lookup"><span data-stu-id="a2a09-305">Any valid topic address</span></span> |
| <span data-ttu-id="a2a09-306">Räkna upp avsnitt</span><span class="sxs-lookup"><span data-stu-id="a2a09-306">Enumerate topics</span></span> |<span data-ttu-id="a2a09-307">Hantera</span><span class="sxs-lookup"><span data-stu-id="a2a09-307">Manage</span></span> |<span data-ttu-id="a2a09-308">$ Resurser/ämnen</span><span class="sxs-lookup"><span data-stu-id="a2a09-308">/$Resources/Topics</span></span> |
| <span data-ttu-id="a2a09-309">Avsnittet beskrivning av Erhåll</span><span class="sxs-lookup"><span data-stu-id="a2a09-309">Get the topic description</span></span> |<span data-ttu-id="a2a09-310">Hantera</span><span class="sxs-lookup"><span data-stu-id="a2a09-310">Manage</span></span> |<span data-ttu-id="a2a09-311">En giltig avsnittet adress</span><span class="sxs-lookup"><span data-stu-id="a2a09-311">Any valid topic address</span></span> |
| <span data-ttu-id="a2a09-312">Konfigurera auktoriseringsregeln för ett ämne</span><span class="sxs-lookup"><span data-stu-id="a2a09-312">Configure authorization rule for a topic</span></span> |<span data-ttu-id="a2a09-313">Hantera</span><span class="sxs-lookup"><span data-stu-id="a2a09-313">Manage</span></span> |<span data-ttu-id="a2a09-314">En giltig avsnittet adress</span><span class="sxs-lookup"><span data-stu-id="a2a09-314">Any valid topic address</span></span> |
| <span data-ttu-id="a2a09-315">Skicka till ämnet</span><span class="sxs-lookup"><span data-stu-id="a2a09-315">Send to the topic</span></span> |<span data-ttu-id="a2a09-316">Skicka</span><span class="sxs-lookup"><span data-stu-id="a2a09-316">Send</span></span> |<span data-ttu-id="a2a09-317">En giltig avsnittet adress</span><span class="sxs-lookup"><span data-stu-id="a2a09-317">Any valid topic address</span></span> |
| <span data-ttu-id="a2a09-318">**Prenumeration**</span><span class="sxs-lookup"><span data-stu-id="a2a09-318">**Subscription**</span></span> | | |
| <span data-ttu-id="a2a09-319">Skapa en prenumeration</span><span class="sxs-lookup"><span data-stu-id="a2a09-319">Create a subscription</span></span> |<span data-ttu-id="a2a09-320">Hantera</span><span class="sxs-lookup"><span data-stu-id="a2a09-320">Manage</span></span> |<span data-ttu-id="a2a09-321">Alla adresser i namnområdet</span><span class="sxs-lookup"><span data-stu-id="a2a09-321">Any namespace address</span></span> |
| <span data-ttu-id="a2a09-322">Ta bort prenumeration</span><span class="sxs-lookup"><span data-stu-id="a2a09-322">Delete subscription</span></span> |<span data-ttu-id="a2a09-323">Hantera</span><span class="sxs-lookup"><span data-stu-id="a2a09-323">Manage</span></span> |<span data-ttu-id="a2a09-324">.. /myTopic/subscriptions/mySubscription</span><span class="sxs-lookup"><span data-stu-id="a2a09-324">../myTopic/Subscriptions/mySubscription</span></span> |
| <span data-ttu-id="a2a09-325">Räkna upp prenumerationer</span><span class="sxs-lookup"><span data-stu-id="a2a09-325">Enumerate subscriptions</span></span> |<span data-ttu-id="a2a09-326">Hantera</span><span class="sxs-lookup"><span data-stu-id="a2a09-326">Manage</span></span> |<span data-ttu-id="a2a09-327">.. myTopic-prenumerationer</span><span class="sxs-lookup"><span data-stu-id="a2a09-327">../myTopic/Subscriptions</span></span> |
| <span data-ttu-id="a2a09-328">Hämta prenumeration beskrivning</span><span class="sxs-lookup"><span data-stu-id="a2a09-328">Get subscription description</span></span> |<span data-ttu-id="a2a09-329">Hantera</span><span class="sxs-lookup"><span data-stu-id="a2a09-329">Manage</span></span> |<span data-ttu-id="a2a09-330">.. /myTopic/subscriptions/mySubscription</span><span class="sxs-lookup"><span data-stu-id="a2a09-330">../myTopic/Subscriptions/mySubscription</span></span> |
| <span data-ttu-id="a2a09-331">Avbryt eller slutföra meddelanden när du har fått meddelandet i titt låsläge</span><span class="sxs-lookup"><span data-stu-id="a2a09-331">Abandon or complete messages after receiving the message in peek-lock mode</span></span> |<span data-ttu-id="a2a09-332">Lyssna</span><span class="sxs-lookup"><span data-stu-id="a2a09-332">Listen</span></span> |<span data-ttu-id="a2a09-333">.. /myTopic/subscriptions/mySubscription</span><span class="sxs-lookup"><span data-stu-id="a2a09-333">../myTopic/Subscriptions/mySubscription</span></span> |
| <span data-ttu-id="a2a09-334">Skjuta upp ett meddelande för senare hämtning</span><span class="sxs-lookup"><span data-stu-id="a2a09-334">Defer a message for later retrieval</span></span> |<span data-ttu-id="a2a09-335">Lyssna</span><span class="sxs-lookup"><span data-stu-id="a2a09-335">Listen</span></span> |<span data-ttu-id="a2a09-336">.. /myTopic/subscriptions/mySubscription</span><span class="sxs-lookup"><span data-stu-id="a2a09-336">../myTopic/Subscriptions/mySubscription</span></span> |
| <span data-ttu-id="a2a09-337">Systemkön ett meddelande</span><span class="sxs-lookup"><span data-stu-id="a2a09-337">Deadletter a message</span></span> |<span data-ttu-id="a2a09-338">Lyssna</span><span class="sxs-lookup"><span data-stu-id="a2a09-338">Listen</span></span> |<span data-ttu-id="a2a09-339">.. /myTopic/subscriptions/mySubscription</span><span class="sxs-lookup"><span data-stu-id="a2a09-339">../myTopic/Subscriptions/mySubscription</span></span> |
| <span data-ttu-id="a2a09-340">Hämta status som är associerad med ett session-avsnittet</span><span class="sxs-lookup"><span data-stu-id="a2a09-340">Get the state associated with a topic session</span></span> |<span data-ttu-id="a2a09-341">Lyssna</span><span class="sxs-lookup"><span data-stu-id="a2a09-341">Listen</span></span> |<span data-ttu-id="a2a09-342">.. /myTopic/subscriptions/mySubscription</span><span class="sxs-lookup"><span data-stu-id="a2a09-342">../myTopic/Subscriptions/mySubscription</span></span> |
| <span data-ttu-id="a2a09-343">Ange de tillstånd som är associerad med ett session-avsnittet</span><span class="sxs-lookup"><span data-stu-id="a2a09-343">Set the state associated with a topic session</span></span> |<span data-ttu-id="a2a09-344">Lyssna</span><span class="sxs-lookup"><span data-stu-id="a2a09-344">Listen</span></span> |<span data-ttu-id="a2a09-345">.. /myTopic/subscriptions/mySubscription</span><span class="sxs-lookup"><span data-stu-id="a2a09-345">../myTopic/Subscriptions/mySubscription</span></span> |
| <span data-ttu-id="a2a09-346">**Regler**</span><span class="sxs-lookup"><span data-stu-id="a2a09-346">**Rules**</span></span> | | |
| <span data-ttu-id="a2a09-347">Skapa en regel</span><span class="sxs-lookup"><span data-stu-id="a2a09-347">Create a rule</span></span> |<span data-ttu-id="a2a09-348">Hantera</span><span class="sxs-lookup"><span data-stu-id="a2a09-348">Manage</span></span> |<span data-ttu-id="a2a09-349">.. /myTopic/subscriptions/mySubscription</span><span class="sxs-lookup"><span data-stu-id="a2a09-349">../myTopic/Subscriptions/mySubscription</span></span> |
| <span data-ttu-id="a2a09-350">Ta bort en regel</span><span class="sxs-lookup"><span data-stu-id="a2a09-350">Delete a rule</span></span> |<span data-ttu-id="a2a09-351">Hantera</span><span class="sxs-lookup"><span data-stu-id="a2a09-351">Manage</span></span> |<span data-ttu-id="a2a09-352">.. /myTopic/subscriptions/mySubscription</span><span class="sxs-lookup"><span data-stu-id="a2a09-352">../myTopic/Subscriptions/mySubscription</span></span> |
| <span data-ttu-id="a2a09-353">Räkna upp regler</span><span class="sxs-lookup"><span data-stu-id="a2a09-353">Enumerate rules</span></span> |<span data-ttu-id="a2a09-354">Hantera eller lyssna</span><span class="sxs-lookup"><span data-stu-id="a2a09-354">Manage or Listen</span></span> |<span data-ttu-id="a2a09-355">.. /myTopic/subscriptions/mySubscription/rules</span><span class="sxs-lookup"><span data-stu-id="a2a09-355">../myTopic/Subscriptions/mySubscription/Rules</span></span> 

## <a name="next-steps"></a><span data-ttu-id="a2a09-356">Nästa steg</span><span class="sxs-lookup"><span data-stu-id="a2a09-356">Next steps</span></span>

<span data-ttu-id="a2a09-357">I följande ämnen kan du lära dig mer om Service Bus-meddelanden.</span><span class="sxs-lookup"><span data-stu-id="a2a09-357">To learn more about Service Bus messaging, see the following topics.</span></span>

* [<span data-ttu-id="a2a09-358">Service Bus-grunder</span><span class="sxs-lookup"><span data-stu-id="a2a09-358">Service Bus fundamentals</span></span>](service-bus-fundamentals-hybrid-solutions.md)
* [<span data-ttu-id="a2a09-359">Service Bus-köer, ämnen och prenumerationer</span><span class="sxs-lookup"><span data-stu-id="a2a09-359">Service Bus queues, topics, and subscriptions</span></span>](service-bus-queues-topics-subscriptions.md)
* [<span data-ttu-id="a2a09-360">Använd Service Bus-köer</span><span class="sxs-lookup"><span data-stu-id="a2a09-360">How to use Service Bus queues</span></span>](service-bus-dotnet-get-started-with-queues.md)
* [<span data-ttu-id="a2a09-361">Använd Service Bus ämnen och prenumerationer</span><span class="sxs-lookup"><span data-stu-id="a2a09-361">How to use Service Bus topics and subscriptions</span></span>](service-bus-dotnet-how-to-use-topics-subscriptions.md)

[Azure portal]: https://portal.azure.com