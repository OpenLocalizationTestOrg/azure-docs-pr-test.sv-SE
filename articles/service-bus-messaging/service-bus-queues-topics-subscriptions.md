---
title: "aaaOverview i Azure Service Bus-meddelanden köer, ämnen och prenumerationer | Microsoft Docs"
description: "Översikt över Service Bus meddelandeentiteter."
services: service-bus-messaging
documentationcenter: na
author: sethmanheim
manager: timlt
editor: 
ms.assetid: a306ced4-74e9-47c6-990a-d9c47efa31d5
ms.service: service-bus-messaging
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 06/28/2017
ms.author: sethm
ms.openlocfilehash: 73135d2658e341c14dbb114ab938faed91578ff1
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 10/06/2017
---
# <a name="service-bus-queues-topics-and-subscriptions"></a><span data-ttu-id="e5757-103">Service Bus-köer, -ämnen och -prenumerationer</span><span class="sxs-lookup"><span data-stu-id="e5757-103">Service Bus queues, topics, and subscriptions</span></span>

<span data-ttu-id="e5757-104">Microsoft Azure Service Bus stöder en uppsättning molnbaserade, meddelande indatavärdena mellanprogram teknologier, inklusive tillförlitliga message Queuing- och varaktig Publicera/prenumerera på meddelanden.</span><span class="sxs-lookup"><span data-stu-id="e5757-104">Microsoft Azure Service Bus supports a set of cloud-based, message-oriented middleware technologies including reliable message queuing and durable publish/subscribe messaging.</span></span> <span data-ttu-id="e5757-105">Dessa ”asynkrona” meddelandefunktioner kan betraktas som frikopplad messaging funktioner som stöd för att publicera och prenumerera, temporal Frikoppling och scenarier med hjälp av hello Service Bus-meddelanden fabric för belastningsutjämning.</span><span class="sxs-lookup"><span data-stu-id="e5757-105">These "brokered" messaging capabilities can be thought of as decoupled messaging features that support publish-subscribe, temporal decoupling, and load balancing scenarios using hello Service Bus messaging fabric.</span></span> <span data-ttu-id="e5757-106">Frikopplad kommunikation har många fördelar: klienter och servrar kan till exempel ansluta efter behov och utföra åtgärder på ett asynkront sätt.</span><span class="sxs-lookup"><span data-stu-id="e5757-106">Decoupled communication has many advantages; for example, clients and servers can connect as needed and perform their operations in an asynchronous fashion.</span></span>

<span data-ttu-id="e5757-107">Hej meddelandeentiteter som bildar hello kärnan i hello messaging funktionerna i Service Bus är köer, ämnen och prenumerationer och regler/en åtgärd.</span><span class="sxs-lookup"><span data-stu-id="e5757-107">hello messaging entities that form hello core of hello messaging capabilities in Service Bus are queues, topics and subscriptions, and rules/actions.</span></span>

## <a name="queues"></a><span data-ttu-id="e5757-108">Köer</span><span class="sxs-lookup"><span data-stu-id="e5757-108">Queues</span></span>

<span data-ttu-id="e5757-109">Köer erbjuder *First In, först ut* (FIFO) meddelandet leverans tooone eller flera konkurrerande konsumenter.</span><span class="sxs-lookup"><span data-stu-id="e5757-109">Queues offer *First In, First Out* (FIFO) message delivery tooone or more competing consumers.</span></span> <span data-ttu-id="e5757-110">Det vill säga är meddelanden vanligtvis förväntade toobe emot och bearbetas av hello mottagarna i hello ordning som de har lagts till toohello kön, och varje meddelande tas emot och bearbetas av bara en meddelandekonsument.</span><span class="sxs-lookup"><span data-stu-id="e5757-110">That is, messages are typically expected toobe received and processed by hello receivers in hello order in which they were added toohello queue, and each message is received and processed by only one message consumer.</span></span> <span data-ttu-id="e5757-111">En stor fördel med köer är tooachieve ”temporal Frikoppling” av programkomponenter.</span><span class="sxs-lookup"><span data-stu-id="e5757-111">A key benefit of using queues is tooachieve "temporal decoupling" of application components.</span></span> <span data-ttu-id="e5757-112">Med andra ord hello producenter (avsändare) och konsumenter (mottagare) behöver inte toobe skicka och ta emot meddelanden på hello samma tid, eftersom meddelanden lagras varaktigt i hello kö.</span><span class="sxs-lookup"><span data-stu-id="e5757-112">In other words, hello producers (senders) and consumers (receivers) do not have toobe sending and receiving messages at hello same time, because messages are stored durably in hello queue.</span></span> <span data-ttu-id="e5757-113">Dessutom hello producenten inte har toowait på ett svar från konsumenten hello i ordning toocontinue tooprocess och skicka meddelanden.</span><span class="sxs-lookup"><span data-stu-id="e5757-113">Furthermore, hello producer does not have toowait for a reply from hello consumer in order toocontinue tooprocess and send messages.</span></span>

<span data-ttu-id="e5757-114">En relaterad fördel är ”belastning utjämning”, som gör att producenter och konsumenter toosend och ta emot meddelanden med olika hastigheter.</span><span class="sxs-lookup"><span data-stu-id="e5757-114">A related benefit is "load leveling," which enables producers and consumers toosend and receive messages at different rates.</span></span> <span data-ttu-id="e5757-115">I många program varierar systembelastningen hello med tiden. dock är hello bearbetningstid som krävs för varje arbetsenhet vanligtvis är konstant.</span><span class="sxs-lookup"><span data-stu-id="e5757-115">In many applications, hello system load varies over time; however, hello processing time required for each unit of work is typically constant.</span></span> <span data-ttu-id="e5757-116">Medlingen mellan meddelandeproducenter och konsumenter med hjälp av en kö innebär att hello förbrukar programmet bara toobe etablerade toobe kan toohandle genomsnittlig belastning i stället för belastning.</span><span class="sxs-lookup"><span data-stu-id="e5757-116">Intermediating message producers and consumers with a queue means that hello consuming application only has toobe provisioned toobe able toohandle average load instead of peak load.</span></span> <span data-ttu-id="e5757-117">hello kön hello djup växer och dras samman allt eftersom hello inkommande belastningen varierar.</span><span class="sxs-lookup"><span data-stu-id="e5757-117">hello depth of hello queue grows and contracts as hello incoming load varies.</span></span> <span data-ttu-id="e5757-118">Detta sparar direkt pengar med beaktande toohello mängd infrastruktur krävs tooservice hello programinläsning.</span><span class="sxs-lookup"><span data-stu-id="e5757-118">This directly saves money with regard toohello amount of infrastructure required tooservice hello application load.</span></span> <span data-ttu-id="e5757-119">Som hello belastningen ökar kan fler arbetsprocesser kan tillagda tooread från hello kö.</span><span class="sxs-lookup"><span data-stu-id="e5757-119">As hello load increases, more worker processes can be added tooread from hello queue.</span></span> <span data-ttu-id="e5757-120">Varje meddelande bearbetas av bara en av hello arbetsprocesser.</span><span class="sxs-lookup"><span data-stu-id="e5757-120">Each message is processed by only one of hello worker processes.</span></span> <span data-ttu-id="e5757-121">Dessutom kan den här pull-baserade belastningsutjämning, för optimal användning av hello worker datorer även om hello worker datorer skiljer sig med beaktande tooprocessing power som de hämtar meddelanden med sina egna högsta hastighet.</span><span class="sxs-lookup"><span data-stu-id="e5757-121">Furthermore, this pull-based load balancing allows for optimum use of hello worker computers even if hello worker computers differ with regard tooprocessing power, as they will pull messages at their own maximum rate.</span></span> <span data-ttu-id="e5757-122">Det här mönstret kallas ofta ”konkurrerande konsument” hello-mönster.</span><span class="sxs-lookup"><span data-stu-id="e5757-122">This pattern is often termed hello "competing consumer" pattern.</span></span>

<span data-ttu-id="e5757-123">Med hjälp av köer toointermediate mellan meddelandeproducenter och konsumenter innehåller en inbyggd lösa kopplingar mellan hello komponenter.</span><span class="sxs-lookup"><span data-stu-id="e5757-123">Using queues toointermediate between message producers and consumers provides an inherent loose coupling between hello components.</span></span> <span data-ttu-id="e5757-124">Eftersom producenter och konsumenter inte är medvetna om varandra, kan en konsument uppgraderas utan någon inverkan på hello producenten.</span><span class="sxs-lookup"><span data-stu-id="e5757-124">Because producers and consumers are not aware of each other, a consumer can be upgraded without having any effect on hello producer.</span></span>

<span data-ttu-id="e5757-125">Skapa en kö är en process med flera steg.</span><span class="sxs-lookup"><span data-stu-id="e5757-125">Creating a queue is a multi-step process.</span></span> <span data-ttu-id="e5757-126">Du kan utföra hanteringsåtgärder för Service Bus meddelandeentiteter (köer och ämnen) via hello [Microsoft.ServiceBus.NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager#microsoft_servicebus_namespacemanager) -klassen, som har skapats genom att ange hello basadressen för hello Service Bus namnområdet och hello autentiseringsuppgifter.</span><span class="sxs-lookup"><span data-stu-id="e5757-126">You perform management operations for Service Bus messaging entities (both queues and topics) via hello [Microsoft.ServiceBus.NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager#microsoft_servicebus_namespacemanager) class, which is constructed by supplying hello base address of hello Service Bus namespace and hello user credentials.</span></span> <span data-ttu-id="e5757-127">[NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager#microsoft_servicebus_namespacemanager) tillhandahåller metoder toocreate räkna upp och ta bort meddelandeentiteter.</span><span class="sxs-lookup"><span data-stu-id="e5757-127">[NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager#microsoft_servicebus_namespacemanager) provides methods toocreate, enumerate and delete messaging entities.</span></span> <span data-ttu-id="e5757-128">När du har skapat en [Microsoft.ServiceBus.TokenProvider](/dotnet/api/microsoft.servicebus.tokenprovider#microsoft_servicebus_tokenprovider) objekt från hello SAS-namn och nyckel och ett namnområde servicehantering objekt, kan du använda hello [Microsoft.ServiceBus.NamespaceManager.CreateQueue](/dotnet/api/microsoft.servicebus.namespacemanager#Microsoft_ServiceBus_NamespaceManager_CreateQueue_System_String_) metoden toocreate hello kön.</span><span class="sxs-lookup"><span data-stu-id="e5757-128">After creating a [Microsoft.ServiceBus.TokenProvider](/dotnet/api/microsoft.servicebus.tokenprovider#microsoft_servicebus_tokenprovider) object from hello SAS name and key, and a service namespace management object, you can use hello [Microsoft.ServiceBus.NamespaceManager.CreateQueue](/dotnet/api/microsoft.servicebus.namespacemanager#Microsoft_ServiceBus_NamespaceManager_CreateQueue_System_String_) method toocreate hello queue.</span></span> <span data-ttu-id="e5757-129">Exempel:</span><span class="sxs-lookup"><span data-stu-id="e5757-129">For example:</span></span>

```csharp
// Create management credentials
TokenProvider credentials = TokenProvider.CreateSharedAccessSignatureTokenProvider(sasKeyName,sasKeyValue);
// Create namespace client
NamespaceManager namespaceClient = new NamespaceManager(ServiceBusEnvironment.CreateServiceUri("sb", ServiceNamespace, string.Empty), credentials);
```

<span data-ttu-id="e5757-130">Du kan sedan skapa ett köobjekt och en meddelandefabrik med hello Service Bus-URI som argument.</span><span class="sxs-lookup"><span data-stu-id="e5757-130">You can then create a queue object and a messaging factory with hello Service Bus URI as an argument.</span></span> <span data-ttu-id="e5757-131">Exempel:</span><span class="sxs-lookup"><span data-stu-id="e5757-131">For example:</span></span>

```csharp
QueueDescription myQueue;
myQueue = namespaceClient.CreateQueue("TestQueue");
MessagingFactory factory = MessagingFactory.Create(ServiceBusEnvironment.CreateServiceUri("sb", ServiceNamespace, string.Empty), credentials); 
QueueClient myQueueClient = factory.CreateQueueClient("TestQueue");
```

<span data-ttu-id="e5757-132">Du kan skicka meddelanden toohello kön.</span><span class="sxs-lookup"><span data-stu-id="e5757-132">You can then send messages toohello queue.</span></span> <span data-ttu-id="e5757-133">Om du har en lista över asynkrona meddelanden som kallas exempelvis `MessageList`, hello kod visas liknande toohello följande:</span><span class="sxs-lookup"><span data-stu-id="e5757-133">For example, if you have a list of brokered messages called `MessageList`, hello code appears similar toohello following:</span></span>

```csharp
for (int count = 0; count < 6; count++)
{
    var issue = MessageList[count];
    issue.Label = issue.Properties["IssueTitle"].ToString();
    myQueueClient.Send(issue);
}
```

<span data-ttu-id="e5757-134">Du sedan ta emot meddelanden från kön hello på följande sätt:</span><span class="sxs-lookup"><span data-stu-id="e5757-134">You then receive messages from hello queue as follows:</span></span>

```csharp
while ((message = myQueueClient.Receive(new TimeSpan(hours: 0, minutes: 0, seconds: 5))) != null)
    {
        Console.WriteLine(string.Format("Message received: {0}, {1}, {2}", message.SequenceNumber, message.Label, message.MessageId));
        message.Complete();

        Console.WriteLine("Processing message (sleeping...)");
        Thread.Sleep(1000);
    }
```

<span data-ttu-id="e5757-135">I hello [ReceiveAndDelete](/dotnet/api/microsoft.servicebus.messaging.receivemode) läge hello får åtgärden är en; som är när Service Bus tar emot hello begäran, den markerar hello meddelandet som Förbrukat och skickar tillbaka det toohello program.</span><span class="sxs-lookup"><span data-stu-id="e5757-135">In hello [ReceiveAndDelete](/dotnet/api/microsoft.servicebus.messaging.receivemode) mode, hello receive operation is single-shot; that is, when Service Bus receives hello request, it marks hello message as being consumed and returns it toohello application.</span></span> <span data-ttu-id="e5757-136">**ReceiveAndDelete** läge är hello enklaste modellen och fungerar bäst för scenarier där hello program kan tolerera icke-bearbetning av ett meddelande i hello händelse av fel.</span><span class="sxs-lookup"><span data-stu-id="e5757-136">**ReceiveAndDelete** mode is hello simplest model and works best for scenarios in which hello application can tolerate not processing a message in hello event of a failure.</span></span> <span data-ttu-id="e5757-137">toounderstand, Föreställ i vilka hello konsumenten problem hello mottagning av begäran och sedan kraschar innan bearbetningen.</span><span class="sxs-lookup"><span data-stu-id="e5757-137">toounderstand this, consider a scenario in which hello consumer issues hello receive request and then crashes before processing it.</span></span> <span data-ttu-id="e5757-138">Eftersom Service Bus markerar hello meddelandet som Förbrukat när hello programmet startas om och börjar förbruka meddelanden igen, att ha missat hello-meddelande som har förbrukats tidigare toohello krascher.</span><span class="sxs-lookup"><span data-stu-id="e5757-138">Because Service Bus marks hello message as being consumed, when hello application restarts and begins consuming messages again, it will have missed hello message that was consumed prior toohello crash.</span></span>

<span data-ttu-id="e5757-139">I [PeekLock](/dotnet/api/microsoft.servicebus.messaging.receivemode) läge hello får åtgärden blir två steg, vilket gör det möjligt toosupport program som inte tolererar att ett meddelande saknas.</span><span class="sxs-lookup"><span data-stu-id="e5757-139">In [PeekLock](/dotnet/api/microsoft.servicebus.messaging.receivemode) mode, hello receive operation becomes two-stage, which makes it possible toosupport applications that cannot tolerate missing messages.</span></span> <span data-ttu-id="e5757-140">När Service Bus tar emot hello begäran, den hittar hello nästa meddelande toobe förbrukas, låser det tooprevent andra användare tar emot den, och returnerar sedan toohello program.</span><span class="sxs-lookup"><span data-stu-id="e5757-140">When Service Bus receives hello request, it finds hello next message toobe consumed, locks it tooprevent other consumers from receiving it, and then returns it toohello application.</span></span> <span data-ttu-id="e5757-141">När hello programmet har avslutat bearbetningen hello-meddelande (eller lagrar det på ett tillförlitligt sätt för framtida bearbetning), Slutför hello andra steget i hello får processen genom att anropa [Slutför](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Complete) på emot hello-meddelande.</span><span class="sxs-lookup"><span data-stu-id="e5757-141">After hello application finishes processing hello message (or stores it reliably for future processing), it completes hello second stage of hello receive process by calling [Complete](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Complete) on hello received message.</span></span> <span data-ttu-id="e5757-142">När Service Bus ser hello **Slutför** anrop, markeras hello-meddelande som används.</span><span class="sxs-lookup"><span data-stu-id="e5757-142">When Service Bus sees hello **Complete** call, it marks hello message as being consumed.</span></span>

<span data-ttu-id="e5757-143">Om programmet hello inte tooprocess Hej meddelande av någon anledning, kan det anropa hello [Avbryt](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Abandon) metod för hello tog emot meddelande (i stället för [Slutför](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Complete)).</span><span class="sxs-lookup"><span data-stu-id="e5757-143">If hello application is unable tooprocess hello message for some reason, it can call hello [Abandon](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Abandon) method on hello received message (instead of [Complete](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Complete)).</span></span> <span data-ttu-id="e5757-144">Detta gör att Service Bus toounlock hello-meddelande och göra den tillgänglig toobe tas emot igen, antingen genom att hello samma konsumenten eller av en annan konkurrerande konsument.</span><span class="sxs-lookup"><span data-stu-id="e5757-144">This enables Service Bus toounlock hello message and make it available toobe received again, either by hello same consumer or by another competing consumer.</span></span> <span data-ttu-id="e5757-145">För det andra, det är en tidsgräns som är associerade med hello Lås och om hello programmet misslyckas tooprocess hello meddelande innan timeout för lås hello går ut (till exempel om hello programmet kraschar), kommer Service Bus låser upp hello-meddelande och gör den tillgänglig toobe tas emot igen (i praktiken utför en [Avbryt](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Abandon) åtgärden som standard).</span><span class="sxs-lookup"><span data-stu-id="e5757-145">Secondly, there is a timeout associated with hello lock and if hello application fails tooprocess hello message before hello lock timeout expires (for example, if hello application crashes), then Service Bus unlocks hello message and makes it available toobe received again (essentially performing an [Abandon](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Abandon) operation by default).</span></span>

<span data-ttu-id="e5757-146">Observera att i hello händelse som hello programmet kraschar efter hello meddelandet har bearbetats men innan hello **Slutför** begäran har utfärdats, hello-meddelande är toohello levereras på nytt program när den startas om.</span><span class="sxs-lookup"><span data-stu-id="e5757-146">Note that in hello event that hello application crashes after processing hello message, but before hello **Complete** request is issued, hello message is redelivered toohello application when it restarts.</span></span> <span data-ttu-id="e5757-147">Det här kallas ofta *minst när* bearbetning, det vill säga varje meddelande bearbetas minst en gång.</span><span class="sxs-lookup"><span data-stu-id="e5757-147">This is often called *At Least Once* processing; that is, each message is processed at least once.</span></span> <span data-ttu-id="e5757-148">Men i vissa situationer hello levereras samma meddelande.</span><span class="sxs-lookup"><span data-stu-id="e5757-148">However, in certain situations hello same message may be redelivered.</span></span> <span data-ttu-id="e5757-149">Om hello scenariot inte tolererar duplicerad bearbetning och sedan ytterligare logik som krävs i hello programmet toodetect dubbletter som kan uppnås baserat på hello **MessageId** -egenskapen för hello-meddelande som förblir konstant under alla leveransförsök.</span><span class="sxs-lookup"><span data-stu-id="e5757-149">If hello scenario cannot tolerate duplicate processing, then additional logic is required in hello application toodetect duplicates which can be achieved based upon hello **MessageId** property of hello message, which remains constant across delivery attempts.</span></span> <span data-ttu-id="e5757-150">Detta kallas *exakt en gång* bearbetning.</span><span class="sxs-lookup"><span data-stu-id="e5757-150">This is known as *Exactly Once* processing.</span></span>

## <a name="topics-and-subscriptions"></a><span data-ttu-id="e5757-151">Ämnen och prenumerationer</span><span class="sxs-lookup"><span data-stu-id="e5757-151">Topics and subscriptions</span></span>
<span data-ttu-id="e5757-152">I kontrast tooqueues, där varje meddelande bearbetas av en enskild konsument *avsnitt* och *prenumerationer* tillhandahålla en en-till-många-kommunikation i en *förPublicera/prenumerera* mönster.</span><span class="sxs-lookup"><span data-stu-id="e5757-152">In contrast tooqueues, in which each message is processed by a single consumer, *topics* and *subscriptions* provide a one-to-many form of communication, in a *publish/subscribe* pattern.</span></span> <span data-ttu-id="e5757-153">Användbar för att skala toovery stort antal mottagare, varje publicerat meddelande görs tillgängligt tooeach prenumeration som har registrerats med hello-avsnittet.</span><span class="sxs-lookup"><span data-stu-id="e5757-153">Useful for scaling toovery large numbers of recipients, each published message is made available tooeach subscription registered with hello topic.</span></span> <span data-ttu-id="e5757-154">Meddelanden skickas tooa avsnittet och levererat tooone eller flera associerade prenumerationer, beroende på filterregler som kan ställas in på grundval av per prenumeration.</span><span class="sxs-lookup"><span data-stu-id="e5757-154">Messages are sent tooa topic and delivered tooone or more associated subscriptions, depending on filter rules that can be set on a per-subscription basis.</span></span> <span data-ttu-id="e5757-155">hello prenumerationer kan använda ytterligare filter toorestrict hälsningsmeddelande som de vill tooreceive.</span><span class="sxs-lookup"><span data-stu-id="e5757-155">hello subscriptions can use additional filters toorestrict hello messages that they want tooreceive.</span></span> <span data-ttu-id="e5757-156">Meddelanden skickas tooa avsnittet hello samma sätt de skickas tooa kön, men meddelanden tas inte emot hello artikeln direkt.</span><span class="sxs-lookup"><span data-stu-id="e5757-156">Messages are sent tooa topic in hello same way they are sent tooa queue, but messages are not received from hello topic directly.</span></span> <span data-ttu-id="e5757-157">I stället tas de emot från prenumerationer.</span><span class="sxs-lookup"><span data-stu-id="e5757-157">Instead, they are received from subscriptions.</span></span> <span data-ttu-id="e5757-158">En prenumeration på artikeln liknar en virtuell kö som tar emot kopior av hello-meddelanden som skickas toohello avsnittet.</span><span class="sxs-lookup"><span data-stu-id="e5757-158">A topic subscription resembles a virtual queue that receives copies of hello messages that are sent toohello topic.</span></span> <span data-ttu-id="e5757-159">Meddelanden tas emot från en prenumeration identiskt toohello sätt de tas emot från en kö.</span><span class="sxs-lookup"><span data-stu-id="e5757-159">Messages are received from a subscription identically toohello way they are received from a queue.</span></span>

<span data-ttu-id="e5757-160">Som jämförelse hello sändning av meddelande funktionerna i en kö mappar direkt tooa avsnittet och dess funktioner för message-mottagning mappar tooa prenumeration.</span><span class="sxs-lookup"><span data-stu-id="e5757-160">By way of comparison, hello message-sending functionality of a queue maps directly tooa topic and its message-receiving functionality maps tooa subscription.</span></span> <span data-ttu-id="e5757-161">Det innebär att prenumerationer stöder hello samma mönster som beskrivits tidigare i det här avsnittet med beaktande tooqueues bland annat: konkurrerande konsument, temporal Frikoppling, utjämna belastningen och belastningsutjämning.</span><span class="sxs-lookup"><span data-stu-id="e5757-161">Among other things, this means that subscriptions support hello same patterns described earlier in this section with regard tooqueues: competing consumer, temporal decoupling, load leveling, and load balancing.</span></span>

<span data-ttu-id="e5757-162">Att skapa ett ämne är liknande toocreating en kö, enligt hello exempel hello föregående avsnitt.</span><span class="sxs-lookup"><span data-stu-id="e5757-162">Creating a topic is similar toocreating a queue, as shown in hello example in hello previous section.</span></span> <span data-ttu-id="e5757-163">Skapa hello-tjänstens URI och sedan använda hello [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager) klassen toocreate hello namnområde klienten.</span><span class="sxs-lookup"><span data-stu-id="e5757-163">Create hello service URI, and then use hello [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager) class toocreate hello namespace client.</span></span> <span data-ttu-id="e5757-164">Du kan sedan skapa ett avsnitt med hello [CreateTopic](/dotnet/api/microsoft.servicebus.namespacemanager#Microsoft_ServiceBus_NamespaceManager_CreateTopic_System_String_) metod.</span><span class="sxs-lookup"><span data-stu-id="e5757-164">You can then create a topic using hello [CreateTopic](/dotnet/api/microsoft.servicebus.namespacemanager#Microsoft_ServiceBus_NamespaceManager_CreateTopic_System_String_) method.</span></span> <span data-ttu-id="e5757-165">Exempel:</span><span class="sxs-lookup"><span data-stu-id="e5757-165">For example:</span></span>

```csharp
TopicDescription dataCollectionTopic = namespaceClient.CreateTopic("DataCollectionTopic");
```

<span data-ttu-id="e5757-166">Lägg till prenumerationer som du vill:</span><span class="sxs-lookup"><span data-stu-id="e5757-166">Next, add subscriptions as desired:</span></span>

```csharp
SubscriptionDescription myAgentSubscription = namespaceClient.CreateSubscription(myTopic.Path, "Inventory");
SubscriptionDescription myAuditSubscription = namespaceClient.CreateSubscription(myTopic.Path, "Dashboard");
```

<span data-ttu-id="e5757-167">Du kan sedan skapa en klient i avsnittet.</span><span class="sxs-lookup"><span data-stu-id="e5757-167">You can then create a topic client.</span></span> <span data-ttu-id="e5757-168">Exempel:</span><span class="sxs-lookup"><span data-stu-id="e5757-168">For example:</span></span>

```csharp
MessagingFactory factory = MessagingFactory.Create(serviceUri, tokenProvider);
TopicClient myTopicClient = factory.CreateTopicClient(myTopic.Path)
```

<span data-ttu-id="e5757-169">Med hello avsändaren kan du skicka och ta emot meddelanden tooand hello artikeln enligt hello föregående avsnitt.</span><span class="sxs-lookup"><span data-stu-id="e5757-169">Using hello message sender, you can send and receive messages tooand from hello topic, as shown in hello previous section.</span></span> <span data-ttu-id="e5757-170">Exempel:</span><span class="sxs-lookup"><span data-stu-id="e5757-170">For example:</span></span>

```csharp
foreach (BrokeredMessage message in messageList)
{
    myTopicClient.Send(message);
    Console.WriteLine(
    string.Format("Message sent: Id = {0}, Body = {1}", message.MessageId, message.GetBody<string>()));
}
```

<span data-ttu-id="e5757-171">Liknande tooqueues, meddelanden tas emot från en prenumeration med hjälp av en [SubscriptionClient](/dotnet/api/microsoft.servicebus.messaging.subscriptionclient) objekt i stället för en [QueueClient](/dotnet/api/microsoft.servicebus.messaging.queueclient) objekt.</span><span class="sxs-lookup"><span data-stu-id="e5757-171">Similar tooqueues, messages are received from a subscription using a [SubscriptionClient](/dotnet/api/microsoft.servicebus.messaging.subscriptionclient) object instead of a [QueueClient](/dotnet/api/microsoft.servicebus.messaging.queueclient) object.</span></span> <span data-ttu-id="e5757-172">Skapa hello prenumeration klienten, skickar hello namnet på hello avsnittet hello namnet på hello prenumeration, och (valfritt) hello mottagningsläge som parametrar.</span><span class="sxs-lookup"><span data-stu-id="e5757-172">Create hello subscription client, passing hello name of hello topic, hello name of hello subscription, and (optionally) hello receive mode as parameters.</span></span> <span data-ttu-id="e5757-173">Till exempel med hello **inventering** prenumerationen:</span><span class="sxs-lookup"><span data-stu-id="e5757-173">For example, with hello **Inventory** subscription:</span></span>

```csharp
// Create hello subscription client
MessagingFactory factory = MessagingFactory.Create(serviceUri, tokenProvider); 

SubscriptionClient agentSubscriptionClient = factory.CreateSubscriptionClient("IssueTrackingTopic", "Inventory", ReceiveMode.PeekLock);
SubscriptionClient auditSubscriptionClient = factory.CreateSubscriptionClient("IssueTrackingTopic", "Dashboard", ReceiveMode.ReceiveAndDelete); 

while ((message = agentSubscriptionClient.Receive(TimeSpan.FromSeconds(5))) != null)
{
    Console.WriteLine("\nReceiving message from Inventory...");
    Console.WriteLine(string.Format("Message received: Id = {0}, Body = {1}", message.MessageId, message.GetBody<string>()));
    message.Complete();
}          

// Create a receiver using ReceiveAndDelete mode
while ((message = auditSubscriptionClient.Receive(TimeSpan.FromSeconds(5))) != null)
{
    Console.WriteLine("\nReceiving message from Dashboard...");
    Console.WriteLine(string.Format("Message received: Id = {0}, Body = {1}", message.MessageId, message.GetBody<string>()));
}
```

### <a name="rules-and-actions"></a><span data-ttu-id="e5757-174">Regler och åtgärder</span><span class="sxs-lookup"><span data-stu-id="e5757-174">Rules and actions</span></span>
<span data-ttu-id="e5757-175">I många fall är måste meddelanden som har specifika egenskaper bearbetas på olika sätt.</span><span class="sxs-lookup"><span data-stu-id="e5757-175">In many scenarios, messages that have specific characteristics must be processed in different ways.</span></span> <span data-ttu-id="e5757-176">tooenable, kan du konfigurera prenumerationer toofind meddelanden som har önskade egenskaper och utföra vissa ändringar toothose egenskaper.</span><span class="sxs-lookup"><span data-stu-id="e5757-176">tooenable this, you can configure subscriptions toofind messages that have desired properties and then perform certain modifications toothose properties.</span></span> <span data-ttu-id="e5757-177">Du kan bara kopiera en delmängd av dessa meddelanden toohello virtuella prenumerationskön när Service Bus prenumerationer visas alla meddelanden som skickas toohello avsnittet.</span><span class="sxs-lookup"><span data-stu-id="e5757-177">While Service Bus subscriptions see all messages sent toohello topic, you can only copy a subset of those messages toohello virtual subscription queue.</span></span> <span data-ttu-id="e5757-178">Detta åstadkoms med hjälp av prenumerationsfilter.</span><span class="sxs-lookup"><span data-stu-id="e5757-178">This is accomplished using subscription filters.</span></span> <span data-ttu-id="e5757-179">Sådana ändringar kallas *filtrera åtgärder*.</span><span class="sxs-lookup"><span data-stu-id="e5757-179">Such modifications are called *filter actions*.</span></span> <span data-ttu-id="e5757-180">När en prenumeration har skapats kan du ange ett filteruttryck som körs på hello egenskaper för hello-meddelande, både hello Systemegenskaper (till exempel **etikett**) och anpassade egenskaper (till exempel **StoreName**.) hello SQL-uttryck är valfri i det här fallet; utan en SQL-filteruttrycket utförs något filter som definieras för en prenumeration på alla hälsningsmeddelande för den prenumerationen.</span><span class="sxs-lookup"><span data-stu-id="e5757-180">When a subscription is created, you can supply a filter expression that operates on hello properties of hello message, both hello system properties (for example, **Label**) and custom application properties (for example, **StoreName**.) hello SQL filter expression is optional in this case; without a SQL filter expression, any filter action defined on a subscription will be performed on all hello messages for that subscription.</span></span>

<span data-ttu-id="e5757-181">Om du använder hello föregående exempel toofilter meddelanden kommer endast från **Store1**, skulle du skapa hello instrumentpanelen prenumeration på följande sätt:</span><span class="sxs-lookup"><span data-stu-id="e5757-181">Using hello previous example, toofilter messages coming only from **Store1**, you would create hello Dashboard subscription as follows:</span></span>

```csharp
namespaceManager.CreateSubscription("IssueTrackingTopic", "Dashboard", new SqlFilter("StoreName = 'Store1'"));
```

<span data-ttu-id="e5757-182">Med den här prenumerationsfiltret på plats, endast meddelanden som har hello `StoreName` egenskapsuppsättning för`Store1` är kopierade toohello virtuella kö för hello `Dashboard` prenumeration.</span><span class="sxs-lookup"><span data-stu-id="e5757-182">With this subscription filter in place, only messages that have hello `StoreName` property set too`Store1` are copied toohello virtual queue for hello `Dashboard` subscription.</span></span>

<span data-ttu-id="e5757-183">Mer information om möjliga filtervärden dokumentationen hello för hello [SqlFilter](/dotnet/api/microsoft.servicebus.messaging.sqlfilter) och [SqlRuleAction](/dotnet/api/microsoft.servicebus.messaging.sqlruleaction) klasser.</span><span class="sxs-lookup"><span data-stu-id="e5757-183">For more information about possible filter values, see hello documentation for hello [SqlFilter](/dotnet/api/microsoft.servicebus.messaging.sqlfilter) and [SqlRuleAction](/dotnet/api/microsoft.servicebus.messaging.sqlruleaction) classes.</span></span> <span data-ttu-id="e5757-184">Se även hello [asynkrona meddelanden: avancerade filter](http://code.msdn.microsoft.com/Brokered-Messaging-6b0d2749) och [avsnittet filter](https://github.com/Azure-Samples/azure-servicebus-messaging-samples/tree/master/TopicFilters) prover.</span><span class="sxs-lookup"><span data-stu-id="e5757-184">Also, see hello [Brokered Messaging: Advanced Filters](http://code.msdn.microsoft.com/Brokered-Messaging-6b0d2749) and [Topic Filters](https://github.com/Azure-Samples/azure-servicebus-messaging-samples/tree/master/TopicFilters) samples.</span></span>

## <a name="next-steps"></a><span data-ttu-id="e5757-185">Nästa steg</span><span class="sxs-lookup"><span data-stu-id="e5757-185">Next steps</span></span>
<span data-ttu-id="e5757-186">Se hello följande avancerade avsnitt för mer information och exempel på hur du använder Service Bus-meddelanden.</span><span class="sxs-lookup"><span data-stu-id="e5757-186">See hello following advanced topics for more information and examples of using Service Bus messaging.</span></span>

* [<span data-ttu-id="e5757-187">Översikt över Service Bus-meddelandetjänster</span><span class="sxs-lookup"><span data-stu-id="e5757-187">Service Bus messaging overview</span></span>](service-bus-messaging-overview.md)
* [<span data-ttu-id="e5757-188">Service Bus brokered messaging .NET tutorial</span><span class="sxs-lookup"><span data-stu-id="e5757-188">Service Bus brokered messaging .NET tutorial</span></span>](service-bus-brokered-tutorial-dotnet.md)
* [<span data-ttu-id="e5757-189">Service Bus självstudiekurs om asynkrona meddelanden REST</span><span class="sxs-lookup"><span data-stu-id="e5757-189">Service Bus brokered messaging REST tutorial</span></span>](service-bus-brokered-tutorial-rest.md)
* [<span data-ttu-id="e5757-190">Ämnesfilter</span><span class="sxs-lookup"><span data-stu-id="e5757-190">Topic Filters sample </span></span>](https://github.com/Azure/azure-service-bus/tree/master/samples/DotNet/Microsoft.ServiceBus.Messaging/TopicFilters)
* [<span data-ttu-id="e5757-191">Asynkrona meddelanden: Avancerade filter-exempel</span><span class="sxs-lookup"><span data-stu-id="e5757-191">Brokered Messaging: Advanced Filters sample</span></span>](http://code.msdn.microsoft.com/Brokered-Messaging-6b0d2749)

