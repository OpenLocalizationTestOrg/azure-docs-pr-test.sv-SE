---
title: "aaaCreate program som använder Azure Service Bus-ämnen och prenumerationer | Microsoft Docs"
description: "Introduktion toohello publicera och prenumerera funktionerna som erbjuds av Service Bus-ämnen och prenumerationer."
services: service-bus-messaging
documentationcenter: na
author: sethmanheim
manager: timlt
editor: 
ms.assetid: a48fc9b0-b7b0-464e-8187-a517bf8b4eb4
ms.service: service-bus-messaging
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 04/07/2017
ms.author: sethm
ms.openlocfilehash: f6d7de46ace7bd5b49de612db213ced789308d91
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 10/06/2017
---
# <a name="create-applications-that-use-service-bus-topics-and-subscriptions"></a><span data-ttu-id="d1b5e-103">Skapa program som använder Service Bus-ämnen och prenumerationer</span><span class="sxs-lookup"><span data-stu-id="d1b5e-103">Create applications that use Service Bus topics and subscriptions</span></span>
<span data-ttu-id="d1b5e-104">Azure Service Bus stöder en uppsättning molnbaserade, meddelande indatavärdena mellanprogram teknologier, inklusive tillförlitliga message Queuing- och varaktig Publicera/prenumerera på meddelanden.</span><span class="sxs-lookup"><span data-stu-id="d1b5e-104">Azure Service Bus supports a set of cloud-based, message-oriented middleware technologies including reliable message queuing and durable publish/subscribe messaging.</span></span> <span data-ttu-id="d1b5e-105">Den här artikeln bygger på informationen i hello [skapa program som använder Service Bus-köer](service-bus-create-queues.md) och ger en introduktion toohello Publicera/prenumerera funktionerna i Service Bus-ämnen.</span><span class="sxs-lookup"><span data-stu-id="d1b5e-105">This article builds on hello information provided in [Create applications that use Service Bus queues](service-bus-create-queues.md) and offers an introduction toohello publish/subscribe capabilities offered by Service Bus topics.</span></span>

## <a name="evolving-retail-scenario"></a><span data-ttu-id="d1b5e-106">Utvecklingen av retail-scenario</span><span class="sxs-lookup"><span data-stu-id="d1b5e-106">Evolving retail scenario</span></span>
<span data-ttu-id="d1b5e-107">Den här artikeln fortsätter hello retail-scenariot som används i [skapa program som använder Service Bus-köer](service-bus-create-queues.md).</span><span class="sxs-lookup"><span data-stu-id="d1b5e-107">This article continues hello retail scenario used in [Create applications that use Service Bus queues](service-bus-create-queues.md).</span></span> <span data-ttu-id="d1b5e-108">Kom ihåg att försäljningsdata från enskilda punkt för försäljning () Kassaterminaler måste vara routade tooan lagersystem som använder den data toodetermine när börs har toobe fylls i.</span><span class="sxs-lookup"><span data-stu-id="d1b5e-108">Recall that sales data from individual Point of Sale (POS) terminals must be routed tooan inventory management system which uses that data toodetermine when stock has toobe replenished.</span></span> <span data-ttu-id="d1b5e-109">Varje POS terminal rapporterar försäljning data genom att skicka meddelanden toohello **DataCollectionQueue** kö, där de finns kvar tills de tas emot av hello lagersystem som visas här:</span><span class="sxs-lookup"><span data-stu-id="d1b5e-109">Each POS terminal reports its sales data by sending messages toohello **DataCollectionQueue** queue, where they remain until they are received by hello inventory management system, as shown here:</span></span>

![Service Bus 1](./media/service-bus-create-topics-subscriptions/IC657161.gif)

<span data-ttu-id="d1b5e-111">tooevolve det här scenariot, ett nytt krav har lagts till toohello system: hello store ägare vill toobe kan toomonitor hur hello store utförs i realtid.</span><span class="sxs-lookup"><span data-stu-id="d1b5e-111">tooevolve this scenario, a new requirement has been added toohello system: hello store owner wants toobe able toomonitor how hello store is performing in real time.</span></span>

<span data-ttu-id="d1b5e-112">tooaddress det här kravet hello system måste ”tryck på” av hello försäljning dataström.</span><span class="sxs-lookup"><span data-stu-id="d1b5e-112">tooaddress this requirement, hello system must "tap" off hello sales data stream.</span></span> <span data-ttu-id="d1b5e-113">Vi vill varje meddelande som skickas av hello POS terminaler toobe skickas toohello lagersystem som innan fortfarande, men vi vill att en annan kopia av varje meddelande som vi kan använda toopresent hello instrumentpanelens visa toohello store ägare.</span><span class="sxs-lookup"><span data-stu-id="d1b5e-113">We still want each message sent by hello POS terminals toobe sent toohello inventory management system as before, but we want another copy of each message that we can use toopresent hello dashboard view toohello store owner.</span></span>

<span data-ttu-id="d1b5e-114">Du kan använda Service Bus i en situation som den här, där du behöver varje meddelande toobe som används av flera parter *avsnitt*.</span><span class="sxs-lookup"><span data-stu-id="d1b5e-114">In any situation such as this, in which you require each message toobe consumed by multiple parties, you can use Service Bus *topics*.</span></span> <span data-ttu-id="d1b5e-115">Innehåller ett Publicera/prenumerera-mönster där varje publicerat meddelande görs tillgängligt tooone eller flera prenumerationer har registrerats med hello-avsnittet.</span><span class="sxs-lookup"><span data-stu-id="d1b5e-115">Topics provide a publish/subscribe pattern in which each published message is made available tooone or more subscriptions registered with hello topic.</span></span> <span data-ttu-id="d1b5e-116">Köer är däremot varje meddelande tas emot av en enskild konsument.</span><span class="sxs-lookup"><span data-stu-id="d1b5e-116">In contrast, with queues each message is received by a single consumer.</span></span>

<span data-ttu-id="d1b5e-117">Meddelanden skickas tooa avsnittet i hello samma sätt som de skickas tooa kön.</span><span class="sxs-lookup"><span data-stu-id="d1b5e-117">Messages are sent tooa topic in hello same way as they are sent tooa queue.</span></span> <span data-ttu-id="d1b5e-118">Dock tas meddelanden inte emot hello artikeln direkt; de tas emot från prenumerationer.</span><span class="sxs-lookup"><span data-stu-id="d1b5e-118">However, messages are not received from hello topic directly; they are received from subscriptions.</span></span> <span data-ttu-id="d1b5e-119">Du kan se i prenumerationen tooa avsnittet som en virtuell kö som tar emot kopior av hello-meddelanden som skickas toothat avsnittet.</span><span class="sxs-lookup"><span data-stu-id="d1b5e-119">You can think of a subscription tooa topic as a virtual queue that receives copies of hello messages that are sent toothat topic.</span></span> <span data-ttu-id="d1b5e-120">Meddelanden tas emot från en prenumeration hello samma sätt som de tas emot från en kö.</span><span class="sxs-lookup"><span data-stu-id="d1b5e-120">Messages are received from a subscription hello same way as they are received from a queue.</span></span>

<span data-ttu-id="d1b5e-121">Gå tillbaka toohello retail scenario, hello kön ersätts av ett ämne och en prenumeration har lagts till vilken hello inventering management systemkomponent kan använda.</span><span class="sxs-lookup"><span data-stu-id="d1b5e-121">Going back toohello retail scenario, hello queue is replaced by a topic, and a subscription is added, which hello inventory management system component can use.</span></span> <span data-ttu-id="d1b5e-122">hello system visas nu på följande sätt:</span><span class="sxs-lookup"><span data-stu-id="d1b5e-122">hello system now appears as follows:</span></span>

![Service Bus 2](./media/service-bus-create-topics-subscriptions/IC657165.gif)

<span data-ttu-id="d1b5e-124">hello konfigurationen här utför identiskt toohello tidigare kö-baserade designen.</span><span class="sxs-lookup"><span data-stu-id="d1b5e-124">hello configuration here performs identically toohello previous queue-based design.</span></span> <span data-ttu-id="d1b5e-125">Det vill säga meddelanden som skickas toohello avsnittet är routade toohello **inventering** prenumeration från vilka hello **lagersystem** förbrukar dem.</span><span class="sxs-lookup"><span data-stu-id="d1b5e-125">That is, messages sent toohello topic are routed toohello **Inventory** subscription, from which hello **Inventory Management System** consumes them.</span></span>

<span data-ttu-id="d1b5e-126">I ordning toosupport hello management dashboard skapar vi en andra prenumeration på hello avsnittet som visas här:</span><span class="sxs-lookup"><span data-stu-id="d1b5e-126">In order toosupport hello management dashboard, we create a second subscription on hello topic, as shown here:</span></span>

![Service Bus 3](./media/service-bus-create-topics-subscriptions/IC657166.gif)

<span data-ttu-id="d1b5e-128">Med den här konfigurationen varje meddelande från hello POS terminaler görs tillgängliga tooboth hello **instrumentpanelen** och **inventering** prenumerationer.</span><span class="sxs-lookup"><span data-stu-id="d1b5e-128">With this configuration, each message from hello POS terminals is made available tooboth hello **Dashboard** and **Inventory** subscriptions.</span></span>

## <a name="show-me-hello-code"></a><span data-ttu-id="d1b5e-129">Visa hello kod</span><span class="sxs-lookup"><span data-stu-id="d1b5e-129">Show me hello code</span></span>
<span data-ttu-id="d1b5e-130">hello artikel [skapa program som använder Service Bus-köer](service-bus-create-queues.md) beskriver hur toosign dig för ett Azure-konto och skapa ett namnområde för tjänsten.</span><span class="sxs-lookup"><span data-stu-id="d1b5e-130">hello article [Create applications that use Service Bus queues](service-bus-create-queues.md) describes how toosign up for an Azure account and create a service namespace.</span></span> <span data-ttu-id="d1b5e-131">hello enklaste sättet tooreference Service Bus-beroenden är tooinstall hello Service Bus [Nuget-paketet](https://www.nuget.org/packages/WindowsAzure.ServiceBus/).</span><span class="sxs-lookup"><span data-stu-id="d1b5e-131">hello easiest way tooreference Service Bus dependencies is tooinstall hello Service Bus [Nuget package](https://www.nuget.org/packages/WindowsAzure.ServiceBus/).</span></span> <span data-ttu-id="d1b5e-132">Du kan också hitta hello Service Bus-bibliotek som en del av hello Azure SDK.</span><span class="sxs-lookup"><span data-stu-id="d1b5e-132">You can also find hello Service Bus libraries as part of hello Azure SDK.</span></span> <span data-ttu-id="d1b5e-133">hello hämtningen är tillgänglig på hello [hämtningssidan för Azure SDK](https://azure.microsoft.com/downloads/).</span><span class="sxs-lookup"><span data-stu-id="d1b5e-133">hello download is available at hello [Azure SDK download page](https://azure.microsoft.com/downloads/).</span></span>

### <a name="create-hello-topic-and-subscriptions"></a><span data-ttu-id="d1b5e-134">Skapa hello avsnittet och prenumerationer</span><span class="sxs-lookup"><span data-stu-id="d1b5e-134">Create hello topic and subscriptions</span></span>
<span data-ttu-id="d1b5e-135">Hanteringsåtgärder för Service Bus meddelandeentiteter (köer och publicera/prenumerera avsnitt) utförs via hello [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager#microsoft_servicebus_namespacemanager) klass.</span><span class="sxs-lookup"><span data-stu-id="d1b5e-135">Management operations for Service Bus messaging entities (queues and publish/subscribe topics) are performed via hello [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager#microsoft_servicebus_namespacemanager) class.</span></span> <span data-ttu-id="d1b5e-136">Rätt autentiseringsuppgifter som krävs i ordning toocreate en **NamespaceManager** -instans för ett visst namnområde.</span><span class="sxs-lookup"><span data-stu-id="d1b5e-136">Appropriate credentials are required in order toocreate a **NamespaceManager** instance for a particular namespace.</span></span> <span data-ttu-id="d1b5e-137">Service Bus använder en [delade signatur åtkomst (SAS)](service-bus-sas.md) baserat säkerhetsmodell.</span><span class="sxs-lookup"><span data-stu-id="d1b5e-137">Service Bus uses a [Shared Access Signature (SAS)](service-bus-sas.md) based security model.</span></span> <span data-ttu-id="d1b5e-138">Hej [TokenProvider](/dotnet/api/microsoft.servicebus.tokenprovider#microsoft_servicebus_tokenprovider) klassen representerar en leverantör av säkerhetstoken med inbyggda fabriksmetoder som returnerar vissa välkända tokenleverantörer.</span><span class="sxs-lookup"><span data-stu-id="d1b5e-138">hello [TokenProvider](/dotnet/api/microsoft.servicebus.tokenprovider#microsoft_servicebus_tokenprovider) class represents a security token provider with built-in factory methods returning some well-known token providers.</span></span> <span data-ttu-id="d1b5e-139">Vi använder en [CreateSharedAccessSignatureTokenProvider](/dotnet/api/microsoft.servicebus.tokenprovider#Microsoft_ServiceBus_TokenProvider_CreateSharedAccessSignatureTokenProvider_System_String_) metoden toohold hello SAS-autentiseringsuppgifter.</span><span class="sxs-lookup"><span data-stu-id="d1b5e-139">We’ll use a [CreateSharedAccessSignatureTokenProvider](/dotnet/api/microsoft.servicebus.tokenprovider#Microsoft_ServiceBus_TokenProvider_CreateSharedAccessSignatureTokenProvider_System_String_) method toohold hello SAS credentials.</span></span> <span data-ttu-id="d1b5e-140">Hej [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager#microsoft_servicebus_namespacemanager) instans sedan konstruerade med hello basadressen för hello Service Bus-namnrymd och hello tokenleverantör.</span><span class="sxs-lookup"><span data-stu-id="d1b5e-140">hello [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager#microsoft_servicebus_namespacemanager) instance is then constructed with hello base address of hello Service Bus namespace and hello token provider.</span></span>

<span data-ttu-id="d1b5e-141">Hej [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager#microsoft_servicebus_namespacemanager) klassen innehåller metoder toocreate, räkna upp och ta bort meddelandeentiteter.</span><span class="sxs-lookup"><span data-stu-id="d1b5e-141">hello [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager#microsoft_servicebus_namespacemanager) class provides methods toocreate, enumerate and delete messaging entities.</span></span> <span data-ttu-id="d1b5e-142">Hej koden som visas här visas hur hello **NamespaceManager** -instansen är skapas och används toocreate hello **DataCollectionTopic** avsnittet.</span><span class="sxs-lookup"><span data-stu-id="d1b5e-142">hello code that is shown here shows how hello **NamespaceManager** instance is created and used toocreate hello **DataCollectionTopic** topic.</span></span>

```csharp
Uri uri = ServiceBusEnvironment.CreateServiceUri("sb", "test-blog", string.Empty);
string name = "RootManageSharedAccessKey";
string key = "abcdefghijklmopqrstuvwxyz";

TokenProvider tokenProvider = TokenProvider.CreateSharedAccessSignatureTokenProvider(name, key);
NamespaceManager namespaceManager = new NamespaceManager(uri, tokenProvider);

namespaceManager.CreateTopic("DataCollectionTopic");
```

<span data-ttu-id="d1b5e-143">Observera att det finns överlagringar av hello [CreateTopic](/dotnet/api/microsoft.servicebus.namespacemanager#Microsoft_ServiceBus_NamespaceManager_CreateTopic_System_String_) metoden som gör att du tooset egenskaper för hello-avsnittet.</span><span class="sxs-lookup"><span data-stu-id="d1b5e-143">Note that there are overloads of hello [CreateTopic](/dotnet/api/microsoft.servicebus.namespacemanager#Microsoft_ServiceBus_NamespaceManager_CreateTopic_System_String_) method that enable you tooset properties of hello topic.</span></span> <span data-ttu-id="d1b5e-144">Du kan till exempel ange hello time to live (TTL) Standardvärdet för meddelanden som skickas toohello avsnittet.</span><span class="sxs-lookup"><span data-stu-id="d1b5e-144">For example, you can set hello default time-to-live (TTL) value for messages sent toohello topic.</span></span> <span data-ttu-id="d1b5e-145">Lägg till hello **inventering** och **instrumentpanelen** prenumerationer.</span><span class="sxs-lookup"><span data-stu-id="d1b5e-145">Next, add hello **Inventory** and **Dashboard** subscriptions.</span></span>

```csharp
namespaceManager.CreateSubscription("DataCollectionTopic", "Inventory");
namespaceManager.CreateSubscription("DataCollectionTopic", "Dashboard");
```

### <a name="send-messages-toohello-topic"></a><span data-ttu-id="d1b5e-146">Skicka meddelanden toohello avsnittet</span><span class="sxs-lookup"><span data-stu-id="d1b5e-146">Send messages toohello topic</span></span>
<span data-ttu-id="d1b5e-147">För körning åtgärder på Service Bus-enheter. till exempel skicka och ta emot meddelanden, ett program måste först skapa en [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory#microsoft_servicebus_messaging_messagingfactory) objekt.</span><span class="sxs-lookup"><span data-stu-id="d1b5e-147">For run-time operations on Service Bus entities; for example, sending and receiving messages, an application must first create a [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory#microsoft_servicebus_messaging_messagingfactory) object.</span></span> <span data-ttu-id="d1b5e-148">Liknande toohello [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager#microsoft_servicebus_namespacemanager) class, hello **MessagingFactory** instans skapas från hello basadress av hello tjänstens namnområde och hello tokenleverantör.</span><span class="sxs-lookup"><span data-stu-id="d1b5e-148">Similar toohello [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager#microsoft_servicebus_namespacemanager) class, hello **MessagingFactory** instance is created from hello base address of hello service namespace and hello token provider.</span></span>

```
MessagingFactory factory = MessagingFactory.Create(uri, tokenProvider);
```

<span data-ttu-id="d1b5e-149">Meddelanden som skickas tooand togs emot från Service Bus-ämnen är instanser av hello [BrokeredMessage](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage) klass.</span><span class="sxs-lookup"><span data-stu-id="d1b5e-149">Messages sent tooand received from Service Bus topics, are instances of hello [BrokeredMessage](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage) class.</span></span> <span data-ttu-id="d1b5e-150">Den här klassen består av en uppsättning standardegenskaper (t.ex [etikett](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.label?view=azureservicebus-4.0.0#Microsoft_ServiceBus_Messaging_BrokeredMessage_Label) och [TimeToLive](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.timetolive?view=azureservicebus-4.0.0#Microsoft_ServiceBus_Messaging_BrokeredMessage_TimeToLive)), en ordlista som används toohold programegenskaper och en brödtext med godtyckliga programdata.</span><span class="sxs-lookup"><span data-stu-id="d1b5e-150">This class consists of a set of standard properties (such as [Label](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.label?view=azureservicebus-4.0.0#Microsoft_ServiceBus_Messaging_BrokeredMessage_Label) and [TimeToLive](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.timetolive?view=azureservicebus-4.0.0#Microsoft_ServiceBus_Messaging_BrokeredMessage_TimeToLive)), a dictionary that is used toohold application properties, and a body of arbitrary application data.</span></span> <span data-ttu-id="d1b5e-151">Ett program kan konfigurera hello brödtext genom att passera i någon typ av serialiserbara objekt (hello följande exempel skickas i en **SalesData** objekt som representerar hello försäljningsdata från hello POS terminal), som använder hello [ DataContractSerializer](https://msdn.microsoft.com/library/system.runtime.serialization.datacontractserializer.aspx) tooserialize hello-objekt.</span><span class="sxs-lookup"><span data-stu-id="d1b5e-151">An application can set hello body by passing in any serializable object (hello following example passes in a **SalesData** object that represents hello sales data from hello POS terminal), which will use hello [DataContractSerializer](https://msdn.microsoft.com/library/system.runtime.serialization.datacontractserializer.aspx) tooserialize hello object.</span></span> <span data-ttu-id="d1b5e-152">Du kan också en [dataströmmen](https://msdn.microsoft.com/library/system.io.stream.aspx) objekt kan anges.</span><span class="sxs-lookup"><span data-stu-id="d1b5e-152">Alternatively, a [Stream](https://msdn.microsoft.com/library/system.io.stream.aspx) object can be provided.</span></span>

```csharp
BrokeredMessage bm = new BrokeredMessage(salesData);
bm.Label = "SalesReport";
bm.Properties["StoreName"] = "Redmond";
bm.Properties["MachineID"] = "POS_1";
```

<span data-ttu-id="d1b5e-153">hello enklaste sättet toosend meddelanden toohello avsnittet är toouse [CreateMessageSender](/dotnet/api/microsoft.servicebus.messaging.messagingfactory#Microsoft_ServiceBus_Messaging_MessagingFactory_CreateMessageSender_System_String_) toocreate en [MessageSender](/dotnet/api/microsoft.servicebus.messaging.messagesender) objekt direkt från hello [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory) instans:</span><span class="sxs-lookup"><span data-stu-id="d1b5e-153">hello easiest way toosend messages toohello topic is toouse [CreateMessageSender](/dotnet/api/microsoft.servicebus.messaging.messagingfactory#Microsoft_ServiceBus_Messaging_MessagingFactory_CreateMessageSender_System_String_) toocreate a [MessageSender](/dotnet/api/microsoft.servicebus.messaging.messagesender) object directly from hello [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory) instance:</span></span>

```csharp
MessageSender sender = factory.CreateMessageSender("DataCollectionTopic");
sender.Send(bm);
```

### <a name="receive-messages-from-a-subscription"></a><span data-ttu-id="d1b5e-154">Ta emot meddelanden från en prenumeration</span><span class="sxs-lookup"><span data-stu-id="d1b5e-154">Receive messages from a subscription</span></span>
<span data-ttu-id="d1b5e-155">Liknande toousing köer, tooreceive meddelanden från en prenumeration som du kan använda en [MessageReceiver](/dotnet/api/microsoft.servicebus.messaging.messagereceiver) objekt som du skapar direkt från hello [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory) med [ CreateMessageReceiver](/dotnet/api/microsoft.servicebus.messaging.messagingfactory#Microsoft_ServiceBus_Messaging_MessagingFactory_CreateMessageReceiver_System_String_).</span><span class="sxs-lookup"><span data-stu-id="d1b5e-155">Similar toousing queues, tooreceive messages from a subscription you can use a [MessageReceiver](/dotnet/api/microsoft.servicebus.messaging.messagereceiver) object which you create directly from hello [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory) using [CreateMessageReceiver](/dotnet/api/microsoft.servicebus.messaging.messagingfactory#Microsoft_ServiceBus_Messaging_MessagingFactory_CreateMessageReceiver_System_String_).</span></span> <span data-ttu-id="d1b5e-156">Du kan använda någon av hello visas två olika lägen (**ReceiveAndDelete** och **PeekLock**), enligt beskrivningen i [skapa program som använder Service Bus-köer](service-bus-create-queues.md).</span><span class="sxs-lookup"><span data-stu-id="d1b5e-156">You can use one of hello two different receive modes (**ReceiveAndDelete** and **PeekLock**), as discussed in [Create applications that use Service Bus queues](service-bus-create-queues.md).</span></span>

<span data-ttu-id="d1b5e-157">Observera att när du skapar en **MessageReceiver** prenumerationer, hello *entityPath* parametern är av hello formuläret `topicPath/subscriptions/subscriptionName`.</span><span class="sxs-lookup"><span data-stu-id="d1b5e-157">Note that when you create a **MessageReceiver** for subscriptions, hello *entityPath* parameter is of hello form `topicPath/subscriptions/subscriptionName`.</span></span> <span data-ttu-id="d1b5e-158">Därför toocreate en **MessageReceiver** för hello **inventering** hello-prenumeration **DataCollectionTopic** avsnittet *entityPath*måste anges för`DataCollectionTopic/subscriptions/Inventory`.</span><span class="sxs-lookup"><span data-stu-id="d1b5e-158">Therefore, toocreate a **MessageReceiver** for hello **Inventory** subscription of hello **DataCollectionTopic** topic, *entityPath* must be set too`DataCollectionTopic/subscriptions/Inventory`.</span></span> <span data-ttu-id="d1b5e-159">hello kod visas på följande sätt:</span><span class="sxs-lookup"><span data-stu-id="d1b5e-159">hello code appears as follows:</span></span>

```csharp
MessageReceiver receiver = factory.CreateMessageReceiver("DataCollectionTopic/subscriptions/Inventory");
BrokeredMessage receivedMessage = receiver.Receive();
try
{
    ProcessMessage(receivedMessage);
    receivedMessage.Complete();
}
catch (Exception e)
{
    receivedMessage.Abandon();
}
```

## <a name="subscription-filters"></a><span data-ttu-id="d1b5e-160">Prenumerationsfilter</span><span class="sxs-lookup"><span data-stu-id="d1b5e-160">Subscription filters</span></span>
<span data-ttu-id="d1b5e-161">Hittills i det här scenariot görs alla meddelanden som skickas toohello avsnittet tillgängliga tooall registrerade prenumerationer.</span><span class="sxs-lookup"><span data-stu-id="d1b5e-161">So far, in this scenario all messages sent toohello topic are made available tooall registered subscriptions.</span></span> <span data-ttu-id="d1b5e-162">hello här nyckel frasen görs ”tillgänglig”.</span><span class="sxs-lookup"><span data-stu-id="d1b5e-162">hello key phrase here is "made available."</span></span> <span data-ttu-id="d1b5e-163">När Service Bus prenumerationer visas alla meddelanden som skickas toohello avsnittet kan du kopiera en delmängd av dessa meddelanden toohello virtuella prenumerationskön.</span><span class="sxs-lookup"><span data-stu-id="d1b5e-163">While Service Bus subscriptions see all messages sent toohello topic, you can copy only a subset of those messages toohello virtual subscription queue.</span></span> <span data-ttu-id="d1b5e-164">Detta görs med hjälp av prenumeration *filter*.</span><span class="sxs-lookup"><span data-stu-id="d1b5e-164">This is performed using subscription *filters*.</span></span> <span data-ttu-id="d1b5e-165">När du skapar en prenumeration kan du ange ett filteruttryck i hello form av ett SQL92 style-predikat som fungerar via hello egenskaper för hello-meddelande, både hello Systemegenskaper (till exempel [etikett](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Label)) och hello program egenskaper som **StoreName** i hello föregående exempel.</span><span class="sxs-lookup"><span data-stu-id="d1b5e-165">When you create a subscription, you can supply a filter expression in hello form of a SQL92 style predicate that operates over hello properties of hello message, both hello system properties (for example, [Label](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Label)) and hello application properties, such as **StoreName** in hello previous example.</span></span>

<span data-ttu-id="d1b5e-166">Under utveckling hello scenariot tooillustrate detta är en andra store toobe tillagda tooour retail scenario.</span><span class="sxs-lookup"><span data-stu-id="d1b5e-166">Evolving hello scenario tooillustrate this, a second store is toobe added tooour retail scenario.</span></span> <span data-ttu-id="d1b5e-167">Försäljningsdata från alla hello POS terminaler från båda butiker fortfarande ha toobe dirigeras toohello centraliserad lagersystem, men en arkivhanteraren hello instrumentpanelen verktyget bara är intresserad av hello prestanda för detta Arkiv.</span><span class="sxs-lookup"><span data-stu-id="d1b5e-167">Sales data from all of hello POS terminals from both stores still have toobe routed toohello centralized inventory management system, but a store manager using hello dashboard tool is only interested in hello performance of that store.</span></span> <span data-ttu-id="d1b5e-168">Du kan använda filtrering tooachieve detta prenumerationen.</span><span class="sxs-lookup"><span data-stu-id="d1b5e-168">You can use subscription filtering tooachieve this.</span></span> <span data-ttu-id="d1b5e-169">Observera att de anger hello när hello POS terminaler publicera meddelanden, **StoreName** programegenskapen hello-meddelande.</span><span class="sxs-lookup"><span data-stu-id="d1b5e-169">Note that when hello POS terminals publish messages, they set hello **StoreName** application property on hello message.</span></span> <span data-ttu-id="d1b5e-170">Angivna två appbutiker, till exempel **Redmond** och **Seattle**, hello POS terminaler i hello Redmond lagra stämpel sina försäljningsdata meddelanden med en **StoreName** lika med för **Redmond**, medan hello Seattle lagra POS terminaler används en **StoreName** lika med för**Seattle**.</span><span class="sxs-lookup"><span data-stu-id="d1b5e-170">Given two stores, for example **Redmond** and **Seattle**, hello POS terminals in hello Redmond store stamp their sales data messages with a **StoreName** equal too**Redmond**, whereas hello Seattle store POS terminals use a **StoreName** equal too**Seattle**.</span></span> <span data-ttu-id="d1b5e-171">Hej arkivhanteraren av hello Redmond lagra bara vill toosee data från dess POS-anslutningar.</span><span class="sxs-lookup"><span data-stu-id="d1b5e-171">hello store manager of hello Redmond store only wants toosee data from its POS terminals.</span></span> <span data-ttu-id="d1b5e-172">hello system visas på följande sätt:</span><span class="sxs-lookup"><span data-stu-id="d1b5e-172">hello system appears as follows:</span></span>

![Tjänsten Bus4](./media/service-bus-create-topics-subscriptions/IC657167.gif)

<span data-ttu-id="d1b5e-174">tooset routning för den här du skapar hello **instrumentpanelen** prenumeration på följande sätt:</span><span class="sxs-lookup"><span data-stu-id="d1b5e-174">tooset up this routing, you create hello **Dashboard** subscription as follows:</span></span>

```csharp
SqlFilter dashboardFilter = new SqlFilter("StoreName = 'Redmond'");
namespaceManager.CreateSubscription("DataCollectionTopic", "Dashboard", dashboardFilter);
```

<span data-ttu-id="d1b5e-175">Med den här [prenumerationsfiltret](/dotnet/api/microsoft.servicebus.messaging.sqlfilter), endast meddelanden som har hello **StoreName** egenskapsuppsättning för**Redmond** blir kopierade toohello virtuella kö för hello **Instrumentpanelen** prenumeration.</span><span class="sxs-lookup"><span data-stu-id="d1b5e-175">With this [subscription filter](/dotnet/api/microsoft.servicebus.messaging.sqlfilter), only messages that have hello **StoreName** property set too**Redmond** will be copied toohello virtual queue for hello **Dashboard** subscription.</span></span> <span data-ttu-id="d1b5e-176">Det finns mycket mer toosubscription filtrering, men.</span><span class="sxs-lookup"><span data-stu-id="d1b5e-176">There is much more toosubscription filtering, however.</span></span> <span data-ttu-id="d1b5e-177">Program kan ha flera filterregler per prenumeration i tillägg toohello möjlighet toomodify hello egenskaperna för ett meddelande när det överförs tooa prenumerationens virtuella kö.</span><span class="sxs-lookup"><span data-stu-id="d1b5e-177">Applications can have multiple filter rules per subscription in addition toohello ability toomodify hello properties of a message as it passes tooa subscription's virtual queue.</span></span>

## <a name="summary"></a><span data-ttu-id="d1b5e-178">Sammanfattning</span><span class="sxs-lookup"><span data-stu-id="d1b5e-178">Summary</span></span>
<span data-ttu-id="d1b5e-179">Alla hello orsaker toouse queuing beskrivs i [skapa program som använder Service Bus-köer](service-bus-create-queues.md) gäller även tootopics, speciellt:</span><span class="sxs-lookup"><span data-stu-id="d1b5e-179">All of hello reasons toouse queuing described in [Create applications that use Service Bus queues](service-bus-create-queues.md) also apply tootopics, specifically:</span></span>

* <span data-ttu-id="d1b5e-180">Tidsbestämd Frikoppling – meddelande producenter och konsumenter inte har toobe online på hello samtidigt.</span><span class="sxs-lookup"><span data-stu-id="d1b5e-180">Temporal decoupling – message producers and consumers do not have toobe online at hello same time.</span></span>
* <span data-ttu-id="d1b5e-181">Belastningsutjämning – toppar i belastningen utjämnas av hello avsnittet Aktivera konsumerande program toobe försetts genomsnittlig belastning i stället för belastning.</span><span class="sxs-lookup"><span data-stu-id="d1b5e-181">Load leveling – peaks in load are smoothed out by hello topic enabling consuming applications toobe provisioned for average load instead of peak load.</span></span>
* <span data-ttu-id="d1b5e-182">Belastningsutjämning – liknande tooa kön kan ha flera konkurrerande konsumenter som lyssnar på en enda prenumeration med varje meddelande som levererat tooonly en hello användare, vilket belastningsutjämning.</span><span class="sxs-lookup"><span data-stu-id="d1b5e-182">Load balancing – similar tooa queue, you can have multiple competing consumers listening on a single subscription, with each message handed off tooonly one of hello consumers, thereby balancing load.</span></span>
* <span data-ttu-id="d1b5e-183">Lösa kopplingar – utveckla hello messaging nätverk utan att påverka befintliga slutpunkter; till exempel lägger till prenumerationer eller ändra filter tooa avsnittet tooallow för nya konsumenter.</span><span class="sxs-lookup"><span data-stu-id="d1b5e-183">Loose coupling – you can evolve hello messaging network without affecting existing endpoints; for example, adding subscriptions or changing filters tooa topic tooallow for new consumers.</span></span>

## <a name="next-steps"></a><span data-ttu-id="d1b5e-184">Nästa steg</span><span class="sxs-lookup"><span data-stu-id="d1b5e-184">Next steps</span></span>

<span data-ttu-id="d1b5e-185">Se [skapa program som använder Service Bus-köer](service-bus-create-queues.md) information om hur toouse köer i hello POS retail scenario.</span><span class="sxs-lookup"><span data-stu-id="d1b5e-185">See [Create applications that use Service Bus queues](service-bus-create-queues.md) for information about how toouse queues in hello POS retail scenario.</span></span>

