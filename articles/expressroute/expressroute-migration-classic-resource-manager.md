---
title: "Migrera ExpressRoute associerade virtuella nätverk från classic till Resource Manager: Azure: PowerShell | Microsoft Docs"
description: "Den här sidan beskrivs hur du migrerar tillhörande virtuella nätverk till Resource Manager när du har flyttat kretsen."
documentationcenter: na
services: expressroute
author: ganesr
manager: timlt
editor: 
tags: azure-resource-manager
ms.assetid: 
ms.service: expressroute
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 07/06/2017
ms.author: ganesr;cherylmc
ms.openlocfilehash: 964ea38569062a7127f60dd6309b328db263bf6f
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 08/03/2017
---
# <a name="migrate-expressroute-associated-virtual-networks-from-classic-to-resource-manager"></a><span data-ttu-id="ddd8d-103">Migrera ExpressRoute associerade virtuella nätverk från classic till Resource Manager</span><span class="sxs-lookup"><span data-stu-id="ddd8d-103">Migrate ExpressRoute associated virtual networks from classic to Resource Manager</span></span>

<span data-ttu-id="ddd8d-104">Den här artikeln förklarar hur du migrerar Azure ExpressRoute associerade virtuella nätverk från den klassiska distributionsmodellen till Azure Resource Manager-distributionsmodellen när du har flyttat ExpressRoute-kretsen.</span><span class="sxs-lookup"><span data-stu-id="ddd8d-104">This article explains how to migrate Azure ExpressRoute associated virtual networks from the classic deployment model to the Azure Resource Manager deployment model after moving your ExpressRoute circuit.</span></span> 


## <a name="before-you-begin"></a><span data-ttu-id="ddd8d-105">Innan du börjar</span><span class="sxs-lookup"><span data-stu-id="ddd8d-105">Before you begin</span></span>
* <span data-ttu-id="ddd8d-106">Kontrollera att du har den senaste versionen av Azure PowerShell-moduler.</span><span class="sxs-lookup"><span data-stu-id="ddd8d-106">Verify that you have the latest version of the Azure PowerShell modules.</span></span> <span data-ttu-id="ddd8d-107">Mer information finns i [Installera och konfigurera Azure PowerShell](/powershell/azure/overview).</span><span class="sxs-lookup"><span data-stu-id="ddd8d-107">For more information, see [How to install and configure Azure PowerShell](/powershell/azure/overview).</span></span>
* <span data-ttu-id="ddd8d-108">Kontrollera att du har granskat den [krav](expressroute-prerequisites.md), [routningskrav](expressroute-routing.md), och [arbetsflöden](expressroute-workflows.md) innan du börjar konfigurera.</span><span class="sxs-lookup"><span data-stu-id="ddd8d-108">Make sure that you have reviewed the [prerequisites](expressroute-prerequisites.md), [routing requirements](expressroute-routing.md), and [workflows](expressroute-workflows.md) before you begin configuration.</span></span>
* <span data-ttu-id="ddd8d-109">Granska informationen som ges enligt [flytta en ExpressRoute-krets från klassisk till Resource Manager](expressroute-move.md).</span><span class="sxs-lookup"><span data-stu-id="ddd8d-109">Review the information that is provided under [Moving an ExpressRoute circuit from classic to Resource Manager](expressroute-move.md).</span></span> <span data-ttu-id="ddd8d-110">Kontrollera att du förstår de gränser och begränsningar.</span><span class="sxs-lookup"><span data-stu-id="ddd8d-110">Make sure that you fully understand the limits and limitations.</span></span>
* <span data-ttu-id="ddd8d-111">Kontrollera att kretsen är fullt fungerande i den klassiska distributionsmodellen.</span><span class="sxs-lookup"><span data-stu-id="ddd8d-111">Verify that the circuit is fully operational in the classic deployment model.</span></span>
* <span data-ttu-id="ddd8d-112">Se till att du har en resursgrupp som skapades i Resource Manager-distributionsmodellen.</span><span class="sxs-lookup"><span data-stu-id="ddd8d-112">Ensure that you have a resource group that was created in the Resource Manager deployment model.</span></span>
* <span data-ttu-id="ddd8d-113">Granska följande resursmigrering dokumentation:</span><span class="sxs-lookup"><span data-stu-id="ddd8d-113">Review the following resource-migration documentation:</span></span>

    * [<span data-ttu-id="ddd8d-114">Plattform som stöds migrering av IaaS-resurser från klassiska till Azure Resource Manager</span><span class="sxs-lookup"><span data-stu-id="ddd8d-114">Platform-supported migration of IaaS resources from classic to Azure Resource Manager</span></span>](../virtual-machines/virtual-machines-windows-migration-classic-resource-manager.md)
    * [<span data-ttu-id="ddd8d-115">Tekniska ingående om plattformen stöds från klassiska till Azure Resource Manager</span><span class="sxs-lookup"><span data-stu-id="ddd8d-115">Technical deep dive on platform-supported migration from classic to Azure Resource Manager</span></span>](../virtual-machines/virtual-machines-windows-migration-classic-resource-manager-deep-dive.md)
    * [<span data-ttu-id="ddd8d-116">Vanliga frågor och svar: Plattform som stöds migrering av IaaS-resurser från klassiska till Azure Resource Manager</span><span class="sxs-lookup"><span data-stu-id="ddd8d-116">FAQs: Platform-supported migration of IaaS resources from classic to Azure Resource Manager</span></span>](../virtual-machines/virtual-machines-windows-migration-classic-resource-manager.md)
    * [<span data-ttu-id="ddd8d-117">Granska de vanligaste migreringsfel och åtgärder</span><span class="sxs-lookup"><span data-stu-id="ddd8d-117">Review most common migration errors and mitigations</span></span>](../virtual-machines/windows/migration-classic-resource-manager-errors.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json)

## <a name="supported-and-unsupported-scenarios"></a><span data-ttu-id="ddd8d-118">Scenarier som stöds och som inte stöds</span><span class="sxs-lookup"><span data-stu-id="ddd8d-118">Supported and unsupported scenarios</span></span>

* <span data-ttu-id="ddd8d-119">En ExpressRoute-krets kan flyttas från klassiskt Resource Manager-miljön utan driftavbrott.</span><span class="sxs-lookup"><span data-stu-id="ddd8d-119">An ExpressRoute circuit can be moved from the classic to the Resource Manager environment without any downtime.</span></span> <span data-ttu-id="ddd8d-120">Du kan flytta ExpressRoute-krets från klassiskt Resource Manager-miljön utan avbrott.</span><span class="sxs-lookup"><span data-stu-id="ddd8d-120">You can move any ExpressRoute circuit from the classic to the Resource Manager environment with no downtime.</span></span> <span data-ttu-id="ddd8d-121">Följ instruktionerna i [flyttar ExpressRoute-kretsar från klassiskt till Resource Manager-distributionsmodellen med hjälp av PowerShell](expressroute-howto-move-arm.md).</span><span class="sxs-lookup"><span data-stu-id="ddd8d-121">Follow the instructions in [moving ExpressRoute circuits from the classic to the Resource Manager deployment model using PowerShell](expressroute-howto-move-arm.md).</span></span> <span data-ttu-id="ddd8d-122">Det här är en förutsättning för att flytta resurser som är anslutna till det virtuella nätverket.</span><span class="sxs-lookup"><span data-stu-id="ddd8d-122">This is a prerequisite to move resources connected to the virtual network.</span></span>
* <span data-ttu-id="ddd8d-123">Virtuella nätverk, gatewayenheter och associerade distributioner i det virtuella nätverket som är kopplade till en ExpressRoute-krets i samma prenumeration kan migreras till Resource Manager-miljö utan driftavbrott.</span><span class="sxs-lookup"><span data-stu-id="ddd8d-123">Virtual networks, gateways, and associated deployments within the virtual network that are attached to an ExpressRoute circuit in the same subscription can be migrated to the Resource Manager environment without any downtime.</span></span> <span data-ttu-id="ddd8d-124">Du kan följa stegen som beskrivs senare om du vill migrera resurser, till exempel virtuella nätverk, gateways och virtuella datorer distribueras i det virtuella nätverket.</span><span class="sxs-lookup"><span data-stu-id="ddd8d-124">You can follow the steps described later to migrate resources such as virtual networks, gateways, and virtual machines deployed within the virtual network.</span></span> <span data-ttu-id="ddd8d-125">Du måste se till att de virtuella nätverken är korrekt konfigurerade innan de migreras.</span><span class="sxs-lookup"><span data-stu-id="ddd8d-125">You must ensure that the virtual networks are configured correctly before they are migrated.</span></span> 
* <span data-ttu-id="ddd8d-126">Virtuella nätverk, gatewayenheter och associerade distributioner i det virtuella nätverket som inte ingår i samma prenumeration som ExpressRoute-kretsen kräver vissa avbrott för att slutföra migreringen.</span><span class="sxs-lookup"><span data-stu-id="ddd8d-126">Virtual networks, gateways, and associated deployments within the virtual network that are not in the same subscription as the ExpressRoute circuit require some downtime to complete the migration.</span></span> <span data-ttu-id="ddd8d-127">Det sista avsnittet i dokumentet beskriver steg ska följas för att migrera resurser.</span><span class="sxs-lookup"><span data-stu-id="ddd8d-127">The last section of the document describes the steps to be followed to migrate resources.</span></span>
* <span data-ttu-id="ddd8d-128">Ett virtuellt nätverk med både ExpressRoute-Gateway och VPN-Gateway kan inte migreras.</span><span class="sxs-lookup"><span data-stu-id="ddd8d-128">A virtual network with both ExpressRoute Gateway and VPN Gateway can't be migrated.</span></span>

## <a name="move-an-expressroute-circuit-from-classic-to-resource-manager"></a><span data-ttu-id="ddd8d-129">Flytta en ExpressRoute-krets från classic till Resource Manager</span><span class="sxs-lookup"><span data-stu-id="ddd8d-129">Move an ExpressRoute circuit from classic to Resource Manager</span></span>
<span data-ttu-id="ddd8d-130">Du måste flytta en ExpressRoute-krets från klassiskt Resource Manager-miljön innan du försöker migrera resurser som är kopplade till ExpressRoute-kretsen.</span><span class="sxs-lookup"><span data-stu-id="ddd8d-130">You must move an ExpressRoute circuit from the classic to the Resource Manager environment before you try to migrate resources that are attached to the ExpressRoute circuit.</span></span> <span data-ttu-id="ddd8d-131">För att åstadkomma detta finns i följande artiklar:</span><span class="sxs-lookup"><span data-stu-id="ddd8d-131">To accomplish this task, see the following articles:</span></span>

* <span data-ttu-id="ddd8d-132">Granska informationen som ges enligt [flytta en ExpressRoute-krets från klassisk till Resource Manager](expressroute-move.md).</span><span class="sxs-lookup"><span data-stu-id="ddd8d-132">Review the information that is provided under [Moving an ExpressRoute circuit from classic to Resource Manager](expressroute-move.md).</span></span>
* <span data-ttu-id="ddd8d-133">[Flytta en krets från classic till Resource Manager med hjälp av Azure PowerShell](expressroute-howto-move-arm.md).</span><span class="sxs-lookup"><span data-stu-id="ddd8d-133">[Move a circuit from classic to Resource Manager using Azure PowerShell](expressroute-howto-move-arm.md).</span></span>
* <span data-ttu-id="ddd8d-134">Använda Azure Service Management portal.</span><span class="sxs-lookup"><span data-stu-id="ddd8d-134">Use the Azure Service Management portal.</span></span> <span data-ttu-id="ddd8d-135">Du kan följa arbetsflödet [skapa en ny ExpressRoute-krets](expressroute-howto-circuit-portal-resource-manager.md) och välj alternativet för import.</span><span class="sxs-lookup"><span data-stu-id="ddd8d-135">You can follow the workflow to [create a new ExpressRoute circuit](expressroute-howto-circuit-portal-resource-manager.md) and select the import option.</span></span> 

<span data-ttu-id="ddd8d-136">Den här åtgärden innebär inte någon avbrottstid.</span><span class="sxs-lookup"><span data-stu-id="ddd8d-136">This operation does not involve downtime.</span></span> <span data-ttu-id="ddd8d-137">Du kan fortsätta att överföra data mellan din lokala och Microsoft medan migreringen pågår.</span><span class="sxs-lookup"><span data-stu-id="ddd8d-137">You can continue to transfer data between your premises and Microsoft while the migration is in progress.</span></span>

## <a name="migrate-virtual-networks-gateways-and-associated-deployments"></a><span data-ttu-id="ddd8d-138">Migrera associerade distributioner, gateways och virtuella nätverk</span><span class="sxs-lookup"><span data-stu-id="ddd8d-138">Migrate virtual networks, gateways, and associated deployments</span></span>

<span data-ttu-id="ddd8d-139">De steg du följer för att migrera beror på om dina resurser finns i samma prenumeration, olika prenumerationer eller båda.</span><span class="sxs-lookup"><span data-stu-id="ddd8d-139">The steps you follow to migrate depend on whether your resources are in the same subscription, different subscriptions, or both.</span></span>

### <a name="migrate-virtual-networks-gateways-and-associated-deployments-in-the-same-subscription-as-the-expressroute-circuit"></a><span data-ttu-id="ddd8d-140">Migrera virtuella nätverk, gateways och associerade distributioner i samma prenumeration som ExpressRoute-krets</span><span class="sxs-lookup"><span data-stu-id="ddd8d-140">Migrate virtual networks, gateways, and associated deployments in the same subscription as the ExpressRoute circuit</span></span>
<span data-ttu-id="ddd8d-141">Det här avsnittet beskriver de steg som ska följas för att migrera ett virtuellt nätverk, -gateway och associerade distributioner i samma prenumeration som ExpressRoute-kretsen.</span><span class="sxs-lookup"><span data-stu-id="ddd8d-141">This section describes the steps to be followed to migrate a virtual network, gateway, and associated deployments in the same subscription as the ExpressRoute circuit.</span></span> <span data-ttu-id="ddd8d-142">Inget driftstopp är associerad med den här migreringen.</span><span class="sxs-lookup"><span data-stu-id="ddd8d-142">No downtime is associated with this migration.</span></span> <span data-ttu-id="ddd8d-143">Du kan fortsätta att använda alla resurser via migreringsprocessen.</span><span class="sxs-lookup"><span data-stu-id="ddd8d-143">You can continue to use all resources through the migration process.</span></span> <span data-ttu-id="ddd8d-144">Management-plan är låst medan migreringen pågår.</span><span class="sxs-lookup"><span data-stu-id="ddd8d-144">The management plane is locked while the migration is in progress.</span></span> 

1. <span data-ttu-id="ddd8d-145">Se till att ExpressRoute-kretsen har flyttats från klassiskt Resource Manager-miljön.</span><span class="sxs-lookup"><span data-stu-id="ddd8d-145">Ensure that the ExpressRoute circuit has been moved from the classic to the Resource Manager environment.</span></span>
2. <span data-ttu-id="ddd8d-146">Se till att det virtuella nätverket har förberetts på rätt sätt för migreringen.</span><span class="sxs-lookup"><span data-stu-id="ddd8d-146">Ensure that the virtual network has been prepared appropriately for the migration.</span></span>
3. <span data-ttu-id="ddd8d-147">Registrera prenumerationen för resursmigrering.</span><span class="sxs-lookup"><span data-stu-id="ddd8d-147">Register your subscription for resource migration.</span></span> <span data-ttu-id="ddd8d-148">Använd följande PowerShell-fragment för att registrera prenumerationen för resursmigrering:</span><span class="sxs-lookup"><span data-stu-id="ddd8d-148">To register your subscription for resource migration, use the following PowerShell snippet:</span></span>

  ```powershell 
  Select-AzureRmSubscription -SubscriptionName <Your Subscription Name>
  Register-AzureRmResourceProvider -ProviderNamespace Microsoft.ClassicInfrastructureMigrate
  Get-AzureRmResourceProvider -ProviderNamespace Microsoft.ClassicInfrastructureMigrate
  ```
4. <span data-ttu-id="ddd8d-149">Validera, förbereda och migrera.</span><span class="sxs-lookup"><span data-stu-id="ddd8d-149">Validate, prepare, and migrate.</span></span> <span data-ttu-id="ddd8d-150">Om du vill flytta det virtuella nätverket, Använd följande PowerShell-fragment:</span><span class="sxs-lookup"><span data-stu-id="ddd8d-150">To move the virtual network, use the following PowerShell snippet:</span></span>

  ```powershell
  Move-AzureVirtualNetwork -Prepare $vnetName  
  Move-AzureVirtualNetwork -Commit $vnetName
  ```

  <span data-ttu-id="ddd8d-151">Du kan också avbryta migreringen genom att köra följande PowerShell-cmdlet:</span><span class="sxs-lookup"><span data-stu-id="ddd8d-151">You can also abort migration by running the following PowerShell cmdlet:</span></span>

  ```powershell
  Move-AzureVirtualNetwork -Abort $vnetName
  ```

## <a name="next-steps"></a><span data-ttu-id="ddd8d-152">Nästa steg</span><span class="sxs-lookup"><span data-stu-id="ddd8d-152">Next steps</span></span>
* [<span data-ttu-id="ddd8d-153">Plattform som stöds migrering av IaaS-resurser från klassiska till Azure Resource Manager</span><span class="sxs-lookup"><span data-stu-id="ddd8d-153">Platform-supported migration of IaaS resources from classic to Azure Resource Manager</span></span>](../virtual-machines/virtual-machines-windows-migration-classic-resource-manager.md)
* [<span data-ttu-id="ddd8d-154">Tekniska ingående om plattformen stöds från klassiska till Azure Resource Manager</span><span class="sxs-lookup"><span data-stu-id="ddd8d-154">Technical deep dive on platform-supported migration from classic to Azure Resource Manager</span></span>](../virtual-machines/virtual-machines-windows-migration-classic-resource-manager-deep-dive.md)
* [<span data-ttu-id="ddd8d-155">Vanliga frågor och svar: Plattform som stöds migrering av IaaS-resurser från klassiska till Azure Resource Manager</span><span class="sxs-lookup"><span data-stu-id="ddd8d-155">FAQs: Platform-supported migration of IaaS resources from classic to Azure Resource Manager</span></span>](../virtual-machines/virtual-machines-windows-migration-classic-resource-manager.md)
* [<span data-ttu-id="ddd8d-156">Granska de vanligaste migreringsfel och åtgärder</span><span class="sxs-lookup"><span data-stu-id="ddd8d-156">Review most common migration errors and mitigations</span></span>](../virtual-machines/windows/migration-classic-resource-manager-errors.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json)
