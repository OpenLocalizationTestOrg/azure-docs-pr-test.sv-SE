---
title: "aaaPlanning din infrastruktur för VM-säkerhetskopiering i Azure | Microsoft Docs"
description: "Viktiga överväganden när du planerar tooback av virtuella datorer i Azure"
services: backup
documentationcenter: 
author: markgalioto
manager: carmonm
editor: 
keywords: "Säkerhetskopiera virtuella datorer, säkerhetskopiera virtuella datorer"
ms.assetid: 19d2cf82-1f60-43e1-b089-9238042887a9
ms.service: backup
ms.workload: storage-backup-recovery
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 7/18/2017
ms.author: markgal;trinadhk
ms.openlocfilehash: d11982431610000293038ee6aa7df8e7bc2d8b70
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 10/06/2017
---
# <a name="plan-your-vm-backup-infrastructure-in-azure"></a><span data-ttu-id="aafcc-104">Planera din infrastruktur för VM-säkerhetskopiering i Azure</span><span class="sxs-lookup"><span data-stu-id="aafcc-104">Plan your VM backup infrastructure in Azure</span></span>
<span data-ttu-id="aafcc-105">Den här artikeln innehåller prestanda och resursen förslag toohelp du planerar din infrastruktur för säkerhetskopiering av VM.</span><span class="sxs-lookup"><span data-stu-id="aafcc-105">This article provides performance and resource suggestions toohelp you plan your VM backup infrastructure.</span></span> <span data-ttu-id="aafcc-106">Den definierar även viktiga aspekter av hello-säkerhetskopieringstjänsten; dessa aspekter kan vara avgörande för att fastställa din arkitektur kapacitetsplanering och schemaläggning.</span><span class="sxs-lookup"><span data-stu-id="aafcc-106">It also defines key aspects of hello Backup service; these aspects can be critical in determining your architecture, capacity planning, and scheduling.</span></span> <span data-ttu-id="aafcc-107">Om du har [förbereda din miljö](backup-azure-vms-prepare.md), planering är hello nästa steg innan du börjar [tooback upp virtuella datorer](backup-azure-vms.md).</span><span class="sxs-lookup"><span data-stu-id="aafcc-107">If you've [prepared your environment](backup-azure-vms-prepare.md), planning is hello next step before you begin [tooback up VMs](backup-azure-vms.md).</span></span> <span data-ttu-id="aafcc-108">Om du behöver mer information om virtuella Azure-datorer, se hello [virtuella datorer dokumentationen](https://azure.microsoft.com/documentation/services/virtual-machines/).</span><span class="sxs-lookup"><span data-stu-id="aafcc-108">If you need more information about Azure virtual machines, see hello [Virtual Machines documentation](https://azure.microsoft.com/documentation/services/virtual-machines/).</span></span>

## <a name="how-does-azure-back-up-virtual-machines"></a><span data-ttu-id="aafcc-109">Hur fungerar Azure säkerhetskopiera virtuella datorer?</span><span class="sxs-lookup"><span data-stu-id="aafcc-109">How does Azure back up virtual machines?</span></span>
<span data-ttu-id="aafcc-110">När hello Azure Backup-tjänsten startar ett säkerhetskopieringsjobb hello schemalagda tidpunkt, utlöser hello reservanknytning tootake en tidpunkt i ögonblicksbild.</span><span class="sxs-lookup"><span data-stu-id="aafcc-110">When hello Azure Backup service initiates a backup job at hello scheduled time, it triggers hello backup extension tootake a point-in-time snapshot.</span></span> <span data-ttu-id="aafcc-111">hello Azure Backup-tjänsten använder hello _VMSnapshot_ tillägg i Windows och hello _VMSnapshotLinux_ tillägget Linux.</span><span class="sxs-lookup"><span data-stu-id="aafcc-111">hello Azure Backup service uses hello _VMSnapshot_ extension in Windows, and hello _VMSnapshotLinux_ extension in Linux.</span></span> <span data-ttu-id="aafcc-112">hello tillägget installeras under hello första säkerhetskopiering.</span><span class="sxs-lookup"><span data-stu-id="aafcc-112">hello extension is installed during hello first VM backup.</span></span> <span data-ttu-id="aafcc-113">tooinstall hello tillägget hello VM måste köras.</span><span class="sxs-lookup"><span data-stu-id="aafcc-113">tooinstall hello extension, hello VM must be running.</span></span> <span data-ttu-id="aafcc-114">Om hello inte körs, tar en ögonblicksbild av hello underliggande lagring (eftersom inga program skrivningar sker när hello VM stoppas) hello Backup-tjänsten.</span><span class="sxs-lookup"><span data-stu-id="aafcc-114">If hello VM is not running, hello Backup service takes a snapshot of hello underlying storage (since no application writes occur while hello VM is stopped).</span></span>

<span data-ttu-id="aafcc-115">När en ögonblicksbild av virtuella Windows-datorer, samordnar hello Backup-tjänsten med hello Volume Shadow Copy Service (VSS) tooget en programkonsekvent ögonblicksbild av hello virtuella datorns diskar.</span><span class="sxs-lookup"><span data-stu-id="aafcc-115">When taking a snapshot of Windows VMs, hello Backup service coordinates with hello Volume Shadow Copy Service (VSS) tooget a consistent snapshot of hello virtual machine's disks.</span></span> <span data-ttu-id="aafcc-116">Om du säkerhetskopierar virtuella Linux-datorer, kan du skriva egna anpassade skript tooensure konsekvenskontroll när en VM-ögonblicksbild.</span><span class="sxs-lookup"><span data-stu-id="aafcc-116">If you're backing up Linux VMs, you can write your own custom scripts tooensure consistency when taking a VM snapshot.</span></span> <span data-ttu-id="aafcc-117">Information om att aktivera dessa skript finns senare i den här artikeln.</span><span class="sxs-lookup"><span data-stu-id="aafcc-117">Details on invoking these scripts are provided later in this article.</span></span>

<span data-ttu-id="aafcc-118">När hello Azure Backup-tjänsten tar hello ögonblicksbild, är hello data överförda toohello valvet.</span><span class="sxs-lookup"><span data-stu-id="aafcc-118">Once hello Azure Backup service takes hello snapshot, hello data is transferred toohello vault.</span></span> <span data-ttu-id="aafcc-119">toomaximize effektivitet hello-tjänsten identifierar och överför bara hello datablock som har ändrats sedan tidigare hello-säkerhetskopiering.</span><span class="sxs-lookup"><span data-stu-id="aafcc-119">toomaximize efficiency, hello service identifies and transfers only hello blocks of data that have changed since hello previous backup.</span></span>

![Arkitektur för virtuell dator i Azure-säkerhetskopiering](./media/backup-azure-vms-introduction/vmbackup-architecture.png)

<span data-ttu-id="aafcc-121">När hello dataöverföring är klar hello ögonblicksbild tas bort och skapa en återställningspunkt.</span><span class="sxs-lookup"><span data-stu-id="aafcc-121">When hello data transfer is complete, hello snapshot is removed and a recovery point is created.</span></span>

> [!NOTE]
> 1. <span data-ttu-id="aafcc-122">Under hello säkerhetskopieringen innehåller Azure Backup hello tillfälliga disk ansluten toohello virtuella datorn.</span><span class="sxs-lookup"><span data-stu-id="aafcc-122">During hello backup process, Azure Backup doesn't include hello temporary disk attached toohello virtual machine.</span></span> <span data-ttu-id="aafcc-123">Mer information finns i hello blogg på [tillfällig lagring](https://blogs.msdn.microsoft.com/mast/2013/12/06/understanding-the-temporary-drive-on-windows-azure-virtual-machines/).</span><span class="sxs-lookup"><span data-stu-id="aafcc-123">For more information, see hello blog on [temporary storage](https://blogs.msdn.microsoft.com/mast/2013/12/06/understanding-the-temporary-drive-on-windows-azure-virtual-machines/).</span></span>
> 2. <span data-ttu-id="aafcc-124">Eftersom Azure Backup tar en ögonblicksbild av en lagringsnivå och överföringar som ögonblicksbilden toovault, ändras inte hello lagringskontonycklar tills hello jobbet har slutförts.</span><span class="sxs-lookup"><span data-stu-id="aafcc-124">Since Azure Backup takes a storage-level snapshot and transfers that snapshot toovault, do not change hello storage account keys until hello backup job finishes.</span></span>
> 3. <span data-ttu-id="aafcc-125">För premium virtuella datorer kan kopiera vi hello ögonblicksbild toostorage konto.</span><span class="sxs-lookup"><span data-stu-id="aafcc-125">For premium VMs, we copy hello snapshot toostorage account.</span></span> <span data-ttu-id="aafcc-126">Detta är säker på att Azure Backup-tjänsten hämtar tillräcklig IOPS för att överföra data toovault toomake.</span><span class="sxs-lookup"><span data-stu-id="aafcc-126">This is toomake sure that Azure Backup service gets sufficient IOPS for transferring data toovault.</span></span> <span data-ttu-id="aafcc-127">Den här ytterligare en kopia av lagring debiteras enligt hello VM allokerade storleken.</span><span class="sxs-lookup"><span data-stu-id="aafcc-127">This additional copy of storage is charged as per hello VM allocated size.</span></span> 
>

### <a name="data-consistency"></a><span data-ttu-id="aafcc-128">Datakonsekvens</span><span class="sxs-lookup"><span data-stu-id="aafcc-128">Data consistency</span></span>
<span data-ttu-id="aafcc-129">Säkerhetskopiera och återställa affärskritiska data är komplicerade av hello faktum att affärskritiska data måste säkerhetskopieras när hello program producerar hello data körs.</span><span class="sxs-lookup"><span data-stu-id="aafcc-129">Backing up and restoring business critical data is complicated by hello fact that business critical data must be backed up while hello applications that produce hello data are running.</span></span> <span data-ttu-id="aafcc-130">tooaddress detta, Azure Backup stöder programkonsekventa säkerhetskopieringar för både Windows- och Linux virtuella datorer</span><span class="sxs-lookup"><span data-stu-id="aafcc-130">tooaddress this, Azure Backup supports application-consistent backups for both Windows and Linux VMs</span></span>
#### <a name="windows-vm"></a><span data-ttu-id="aafcc-131">Windows VM</span><span class="sxs-lookup"><span data-stu-id="aafcc-131">Windows VM</span></span>
<span data-ttu-id="aafcc-132">Azure Backup tar Fullständig VSS-säkerhetskopiering på virtuella Windows-datorer (Läs mer om [Fullständig VSS-säkerhetskopiering](http://blogs.technet.com/b/filecab/archive/2008/05/21/what-is-the-difference-between-vss-full-backup-and-vss-copy-backup-in-windows-server-2008.aspx)).</span><span class="sxs-lookup"><span data-stu-id="aafcc-132">Azure Backup takes VSS full backups on Windows VMs (read more about [VSS full backup](http://blogs.technet.com/b/filecab/archive/2008/05/21/what-is-the-difference-between-vss-full-backup-and-vss-copy-backup-in-windows-server-2008.aspx)).</span></span> <span data-ttu-id="aafcc-133">tooenable VSS säkerhetskopior, hello följa registret nyckel måste toobe set på hello VM.</span><span class="sxs-lookup"><span data-stu-id="aafcc-133">tooenable VSS copy backups, hello following registry key needs toobe set on hello VM.</span></span>

```
[HKEY_LOCAL_MACHINE\SOFTWARE\MICROSOFT\BCDRAGENT]
"USEVSSCOPYBACKUP"="TRUE"
```

#### <a name="linux-vms"></a><span data-ttu-id="aafcc-134">Virtuella Linux-datorer</span><span class="sxs-lookup"><span data-stu-id="aafcc-134">Linux VMs</span></span>
<span data-ttu-id="aafcc-135">Azure Backup är ett ramverk för skript.</span><span class="sxs-lookup"><span data-stu-id="aafcc-135">Azure Backup provides a scripting framework.</span></span> <span data-ttu-id="aafcc-136">tooensure programkonsekvens när du säkerhetskopierar virtuella Linux-datorer, skapa skript före och efter skript som styr hello säkerhetskopiering arbetsflödet och miljö.</span><span class="sxs-lookup"><span data-stu-id="aafcc-136">tooensure application consistency when backing up Linux VMs, create custom pre-scripts and post-scripts that control hello backup workflow and environment.</span></span> <span data-ttu-id="aafcc-137">Azure-säkerhetskopiering anropar hello före skript före hello VM-ögonblicksbild och anropar hello efter skriptet när hello VM ögonblicksbild jobbet har slutförts.</span><span class="sxs-lookup"><span data-stu-id="aafcc-137">Azure Backup invokes hello pre-script before taking hello VM snapshot and invokes hello post-script once hello VM snapshot job completes.</span></span> <span data-ttu-id="aafcc-138">Mer information finns i [programmet konsekvent VM säkerhetskopior med hjälp av skript före och efter skriptet](https://docs.microsoft.com/azure/backup/backup-azure-linux-app-consistent).</span><span class="sxs-lookup"><span data-stu-id="aafcc-138">For more details, see [application consistent VM backups using pre-script and post-script](https://docs.microsoft.com/azure/backup/backup-azure-linux-app-consistent).</span></span>
> [!NOTE]
> <span data-ttu-id="aafcc-139">Azure-säkerhetskopiering endast anropar hello customer skrivna före och efter skript.</span><span class="sxs-lookup"><span data-stu-id="aafcc-139">Azure Backup only invokes hello customer-written pre- and post-scripts.</span></span> <span data-ttu-id="aafcc-140">Om hello före skript och efter skript köras, markerar Azure Backup hello återställningspunkt som programmet konsekvent.</span><span class="sxs-lookup"><span data-stu-id="aafcc-140">If hello pre-script and post-scripts execute successfully, Azure Backup marks hello recovery point as application consistent.</span></span> <span data-ttu-id="aafcc-141">Hello kunden är slutgiltigt ansvariga för hello programkonsekvens när du använder anpassade skript.</span><span class="sxs-lookup"><span data-stu-id="aafcc-141">However, hello customer is ultimately responsible for hello application consistency when using custom scripts.</span></span>
>


<span data-ttu-id="aafcc-142">Den här tabellen beskrivs hello typerna av konsekvens och hello villkor att de inträffa under Virtuella Azure-säkerhetskopiering och återställning procedurer.</span><span class="sxs-lookup"><span data-stu-id="aafcc-142">This table explains hello types of consistency and hello conditions that they occur under during Azure VM backup and restore procedures.</span></span>

| <span data-ttu-id="aafcc-143">Konsekvens</span><span class="sxs-lookup"><span data-stu-id="aafcc-143">Consistency</span></span> | <span data-ttu-id="aafcc-144">VSS-baserade</span><span class="sxs-lookup"><span data-stu-id="aafcc-144">VSS-based</span></span> | <span data-ttu-id="aafcc-145">Förklaring och information</span><span class="sxs-lookup"><span data-stu-id="aafcc-145">Explanation and details</span></span> |
| --- | --- | --- |
| <span data-ttu-id="aafcc-146">Programkonsekvens</span><span class="sxs-lookup"><span data-stu-id="aafcc-146">Application consistency</span></span> |<span data-ttu-id="aafcc-147">Ja för Windows</span><span class="sxs-lookup"><span data-stu-id="aafcc-147">Yes for Windows</span></span>|<span data-ttu-id="aafcc-148">Programkonsekvens är idealisk för arbetsbelastningar som det säkerställer att:</span><span class="sxs-lookup"><span data-stu-id="aafcc-148">Application consistency is ideal for workloads as it ensures that:</span></span><ol><li> <span data-ttu-id="aafcc-149">hello VM *startar*.</span><span class="sxs-lookup"><span data-stu-id="aafcc-149">hello VM *boots up*.</span></span> <li><span data-ttu-id="aafcc-150">Det finns *inte är skadad*.</span><span class="sxs-lookup"><span data-stu-id="aafcc-150">There is *no corruption*.</span></span> <li><span data-ttu-id="aafcc-151">Det finns *ingen dataförlust*.</span><span class="sxs-lookup"><span data-stu-id="aafcc-151">There is *no data loss*.</span></span><li> <span data-ttu-id="aafcc-152">hello data är konsekventa toohello program som använder hello data genom att hello-programmet vid hello av säkerhetskopiering – med hjälp av VSS eller före/post skript.</span><span class="sxs-lookup"><span data-stu-id="aafcc-152">hello data is consistent toohello application that uses hello data, by involving hello application at hello time of backup--using VSS or pre/post script.</span></span></ol> <li><span data-ttu-id="aafcc-153">*Virtuella Windows-datorer*-mest Microsoft-arbetsbelastningar har VSS-skrivare som utför belastningsspecifikt åtgärder relaterade toodata konsekvenskontroll.</span><span class="sxs-lookup"><span data-stu-id="aafcc-153">*Windows VMs*- Most Microsoft workloads have VSS writers that do workload-specific actions related toodata consistency.</span></span> <span data-ttu-id="aafcc-154">Till exempel har Microsoft SQL Server en VSS-skrivare som garanterar att hello skrivningar toohello transaktionsloggfilen och hello databasen utförs korrekt.</span><span class="sxs-lookup"><span data-stu-id="aafcc-154">For example, Microsoft SQL Server has a VSS writer that ensures that hello writes toohello transaction log file and hello database are done correctly.</span></span> <span data-ttu-id="aafcc-155">För Virtuella för Windows Azure-säkerhetskopiering, toocreate en programkonsekvent återställningspunkt hello reservanknytning anropa hello VSS arbetsflöde och slutför den innan hello VM-ögonblicksbild.</span><span class="sxs-lookup"><span data-stu-id="aafcc-155">For Azure Windows VM backups, toocreate an application-consistent recovery point, hello backup extension must invoke hello VSS workflow and complete it before taking hello VM snapshot.</span></span> <span data-ttu-id="aafcc-156">För hello Azure VM ögonblicksbild toobe korrekt, hello VSS-skrivare för alla Virtuella Azure-program måste du slutföra samt.</span><span class="sxs-lookup"><span data-stu-id="aafcc-156">For hello Azure VM snapshot toobe accurate, hello VSS writers of all Azure VM applications must complete as well.</span></span> <span data-ttu-id="aafcc-157">(Läs hello [grunderna i VSS](http://blogs.technet.com/b/josebda/archive/2007/10/10/the-basics-of-the-volume-shadow-copy-service-vss.aspx) och fördjupa dig djupare i hello information om [hur det fungerar](https://technet.microsoft.com/library/cc785914%28v=ws.10%29.aspx)).</span><span class="sxs-lookup"><span data-stu-id="aafcc-157">(Learn hello [basics of VSS](http://blogs.technet.com/b/josebda/archive/2007/10/10/the-basics-of-the-volume-shadow-copy-service-vss.aspx) and dive deep into hello details of [how it works](https://technet.microsoft.com/library/cc785914%28v=ws.10%29.aspx)).</span></span> </li> <li> <span data-ttu-id="aafcc-158">*Virtuella Linux-datorer*-kunder kan köra [anpassade skript före och efter skriptet tooensure programkonsekvens](https://docs.microsoft.com/azure/backup/backup-azure-linux-app-consistent).</span><span class="sxs-lookup"><span data-stu-id="aafcc-158">*Linux VMs*- Customers can execute [custom pre-script and post-script tooensure application consistency](https://docs.microsoft.com/azure/backup/backup-azure-linux-app-consistent).</span></span> </li> |
| <span data-ttu-id="aafcc-159">Filsystemskonsekvens</span><span class="sxs-lookup"><span data-stu-id="aafcc-159">File-system consistency</span></span> |<span data-ttu-id="aafcc-160">Ja – för Windows-baserade datorer</span><span class="sxs-lookup"><span data-stu-id="aafcc-160">Yes - for Windows-based computers</span></span> |<span data-ttu-id="aafcc-161">Det finns två scenarier där hello återställningspunkt kan vara *konsekvent filsystemet*:</span><span class="sxs-lookup"><span data-stu-id="aafcc-161">There are two scenarios where hello recovery point can be *file-system consistent*:</span></span><ul><li><span data-ttu-id="aafcc-162">Säkerhetskopior av virtuella Linux-datorer i Azure, utan Förproduktion-script/efter-script eller om Förproduktion-script/efter-script misslyckades.</span><span class="sxs-lookup"><span data-stu-id="aafcc-162">Backups of Linux VMs in Azure, without pre-script/post-script or if pre-script/post-script failed.</span></span> <li><span data-ttu-id="aafcc-163">VSS-fel vid säkerhetskopiering för virtuella Windows-datorer i Azure.</span><span class="sxs-lookup"><span data-stu-id="aafcc-163">VSS failure during backup for Windows VMs in Azure.</span></span></li></ul> <span data-ttu-id="aafcc-164">I båda dessa fall är hello som är bäst att göra tooensure som:</span><span class="sxs-lookup"><span data-stu-id="aafcc-164">In both these cases, hello best that can be done is tooensure that:</span></span> <ol><li> <span data-ttu-id="aafcc-165">hello VM *startar*.</span><span class="sxs-lookup"><span data-stu-id="aafcc-165">hello VM *boots up*.</span></span> <li><span data-ttu-id="aafcc-166">Det finns *inte är skadad*.</span><span class="sxs-lookup"><span data-stu-id="aafcc-166">There is *no corruption*.</span></span><li><span data-ttu-id="aafcc-167">Det finns *ingen dataförlust*.</span><span class="sxs-lookup"><span data-stu-id="aafcc-167">There is *no data loss*.</span></span></ol> <span data-ttu-id="aafcc-168">Program behöver tooimplement sina egna ”korrigering av” mekanism på hello återställa data.</span><span class="sxs-lookup"><span data-stu-id="aafcc-168">Applications need tooimplement their own "fix-up" mechanism on hello restored data.</span></span> |
| <span data-ttu-id="aafcc-169">Kraschkonsekvens</span><span class="sxs-lookup"><span data-stu-id="aafcc-169">Crash consistency</span></span> |<span data-ttu-id="aafcc-170">Nej</span><span class="sxs-lookup"><span data-stu-id="aafcc-170">No</span></span> |<span data-ttu-id="aafcc-171">Den här situationen är likvärdiga tooa virtuella datorn upplever en ”krasch” (via antingen en mjuk eller hård reset).</span><span class="sxs-lookup"><span data-stu-id="aafcc-171">This situation is equivalent tooa virtual machine experiencing a "crash" (through either a soft or hard reset).</span></span> <span data-ttu-id="aafcc-172">Kraschkonsekvens inträffar oftast när hello virtuella Azure-datorn är avstängd vid hello tidpunkten för säkerhetskopieringen.</span><span class="sxs-lookup"><span data-stu-id="aafcc-172">Crash consistency typically happens when hello Azure virtual machine is shut down at hello time of backup.</span></span> <span data-ttu-id="aafcc-173">En kraschkonsekvent återställningspunkt ger inga garantier runt hello konsekvenskontroll av hello data på hello lagringsmedium--antingen från hello perspektiv hello operativsystem eller hello program.</span><span class="sxs-lookup"><span data-stu-id="aafcc-173">A crash-consistent recovery point provides no guarantees around hello consistency of hello data on hello storage medium--either from hello perspective of hello operating system or hello application.</span></span> <span data-ttu-id="aafcc-174">Endast hello-data som redan finns på hello disk på hello tidpunkten för säkerhetskopieringen fångas och säkerhetskopieras.</span><span class="sxs-lookup"><span data-stu-id="aafcc-174">Only hello data that already exists on hello disk at hello time of backup is captured and backed up.</span></span> <br/> <br/> <span data-ttu-id="aafcc-175">Det finns inga garantier, vanligtvis, hello operativsystemet startas, följt av disk-kontrollerar proceduren som chkdsk, toofix eventuella skador fel.</span><span class="sxs-lookup"><span data-stu-id="aafcc-175">While there are no guarantees, usually, hello operating system boots, followed by disk-checking procedure, like chkdsk, toofix any corruption errors.</span></span> <span data-ttu-id="aafcc-176">Alla data i minnet eller skrivningar som inte har överfört toohello disk går förlorade.</span><span class="sxs-lookup"><span data-stu-id="aafcc-176">Any in-memory data or writes that have not been transferred toohello disk are lost.</span></span> <span data-ttu-id="aafcc-177">hello program följer vanligtvis med sin egen kontroll om återställning av data behöver toobe klar.</span><span class="sxs-lookup"><span data-stu-id="aafcc-177">hello application typically follows with its own verification mechanism in case data rollback needs toobe done.</span></span> <br><br><span data-ttu-id="aafcc-178">Exempelvis om hello transaktionsloggen har poster som inte finns i hello databasen sedan hello databasprogramvaran gör en återställning tills hello data är konsekventa.</span><span class="sxs-lookup"><span data-stu-id="aafcc-178">As an example, if hello transaction log has entries that are not present in hello database, then hello database software does a rollback until hello data is consistent.</span></span> <span data-ttu-id="aafcc-179">När data sprids över flera virtuella diskar (till exempel volymer), ger en kraschkonsekvent återställningspunkt inga garantier hello är korrekt hello data.</span><span class="sxs-lookup"><span data-stu-id="aafcc-179">When data is spread across multiple virtual disks (like spanned volumes), a crash-consistent recovery point provides no guarantees for hello correctness of hello data.</span></span> |

## <a name="performance-and-resource-utilization"></a><span data-ttu-id="aafcc-180">Prestanda och Resursanvändning</span><span class="sxs-lookup"><span data-stu-id="aafcc-180">Performance and resource utilization</span></span>
<span data-ttu-id="aafcc-181">Som säkerhetskopieringsprogram som är distribuerade på plats bör du planera för kapacitet och resursanvändningen behov när du säkerhetskopierar virtuella datorer i Azure.</span><span class="sxs-lookup"><span data-stu-id="aafcc-181">Like backup software that is deployed on-premises, you should plan for capacity and resource utilization needs when backing up VMs in Azure.</span></span> <span data-ttu-id="aafcc-182">Hej [Azure Storage begränsar](../azure-subscription-service-limits.md#storage-limits) definiera hur toostructure VM distributioner tooget maximala prestanda med minst påverkar toorunning arbetsbelastningar.</span><span class="sxs-lookup"><span data-stu-id="aafcc-182">hello [Azure Storage limits](../azure-subscription-service-limits.md#storage-limits) define how toostructure VM deployments tooget maximum performance with minimum impact toorunning workloads.</span></span>

<span data-ttu-id="aafcc-183">Betala uppmärksamhet toohello följande Azure Storage begränsar när du planerar prestanda vid säkerhetskopiering:</span><span class="sxs-lookup"><span data-stu-id="aafcc-183">Pay attention toohello following Azure Storage limits when planning backup performance:</span></span>

* <span data-ttu-id="aafcc-184">Maximalt antal utgående per lagringskonto</span><span class="sxs-lookup"><span data-stu-id="aafcc-184">Max egress per storage account</span></span>
* <span data-ttu-id="aafcc-185">Totalt antal förfrågningar per lagringskonto</span><span class="sxs-lookup"><span data-stu-id="aafcc-185">Total request rate per storage account</span></span>

### <a name="storage-account-limits"></a><span data-ttu-id="aafcc-186">Lagringskontogränser</span><span class="sxs-lookup"><span data-stu-id="aafcc-186">Storage account limits</span></span>
<span data-ttu-id="aafcc-187">Säkerhetskopierade data kopieras från ett lagringskonto, lägger till toohello i/o-åtgärder per sekund (IOPS) och utgående trafik (eller genomströmning) mätvärden för hello storage-konto.</span><span class="sxs-lookup"><span data-stu-id="aafcc-187">Backup data copied from a storage account, adds toohello input/output operations per second (IOPS) and egress (or throughput) metrics of hello storage account.</span></span> <span data-ttu-id="aafcc-188">AT hello samma tid, virtuella datorer också förbrukar IOPS och genomflöde.</span><span class="sxs-lookup"><span data-stu-id="aafcc-188">At hello same time, virtual machines are also consuming IOPS and throughput.</span></span> <span data-ttu-id="aafcc-189">hello målet tooensure säkerhetskopiering och trafik för virtuella datorer överskrider inte din lagringskontogränser.</span><span class="sxs-lookup"><span data-stu-id="aafcc-189">hello goal is tooensure Backup and virtual machine traffic don't exceed your storage account limits.</span></span>

### <a name="number-of-disks"></a><span data-ttu-id="aafcc-190">Antal diskar</span><span class="sxs-lookup"><span data-stu-id="aafcc-190">Number of disks</span></span>
<span data-ttu-id="aafcc-191">hello säkerhetskopieringen försöker toocomplete en säkerhetskopiering så snabbt som möjligt.</span><span class="sxs-lookup"><span data-stu-id="aafcc-191">hello backup process tries toocomplete a backup job as quickly as possible.</span></span> <span data-ttu-id="aafcc-192">På så sätt kan förbrukar den så många resurser som möjligt.</span><span class="sxs-lookup"><span data-stu-id="aafcc-192">In doing so, it consumes as many resources as it can.</span></span> <span data-ttu-id="aafcc-193">Men alla i/o-åtgärder begränsas av hello *mål genomströmning för enda Blob*, som har högst 60 MB per sekund.</span><span class="sxs-lookup"><span data-stu-id="aafcc-193">However, all I/O operations are limited by hello *Target Throughput for Single Blob*, which has a limit of 60 MB per second.</span></span> <span data-ttu-id="aafcc-194">I ett försök toomaximize dess hastighet hello säkerhetskopieringen försöker tooback består av hello Virtuella diskar *parallellt*.</span><span class="sxs-lookup"><span data-stu-id="aafcc-194">In an attempt toomaximize its speed, hello backup process tries tooback up each of hello VM's disks *in parallel*.</span></span> <span data-ttu-id="aafcc-195">Om en virtuell dator har fyra diskar, försöker hello-tjänsten tooback upp alla fyra diskar parallellt.</span><span class="sxs-lookup"><span data-stu-id="aafcc-195">If a VM has four disks, hello service attempts tooback up all four disks in parallel.</span></span> <span data-ttu-id="aafcc-196">Hej **antal diskar** säkerhetskopieras, är hello viktigaste faktor för att fastställa säkerhetskopiering lagringstrafik för kontot.</span><span class="sxs-lookup"><span data-stu-id="aafcc-196">hello **number of disks** being backed up, is hello most important factor in determining storage account backup traffic.</span></span>

### <a name="backup-schedule"></a><span data-ttu-id="aafcc-197">Schemat för säkerhetskopiering</span><span class="sxs-lookup"><span data-stu-id="aafcc-197">Backup schedule</span></span>
<span data-ttu-id="aafcc-198">Ytterligare en faktor som påverkar prestanda är hello **Säkerhetskopieringsschemat**.</span><span class="sxs-lookup"><span data-stu-id="aafcc-198">An additional factor that impacts performance is hello **backup schedule**.</span></span> <span data-ttu-id="aafcc-199">Om du konfigurerar hello principer så att alla virtuella datorer säkerhetskopieras på hello samma tid och du har schemalagt en trafik har fastnat.</span><span class="sxs-lookup"><span data-stu-id="aafcc-199">If you configure hello policies so all VMs are backed up at hello same time, you have scheduled a traffic jam.</span></span> <span data-ttu-id="aafcc-200">hello säkerhetskopieringen försöker tooback upp alla diskar parallellt.</span><span class="sxs-lookup"><span data-stu-id="aafcc-200">hello backup process attempts tooback up all disks in parallel.</span></span> <span data-ttu-id="aafcc-201">tooreduce hello säkerhetskopiering trafik från ett lagringskonto, säkerhetskopiera olika virtuella datorer på olika tidpunkten hello, utan överlappande.</span><span class="sxs-lookup"><span data-stu-id="aafcc-201">tooreduce hello backup traffic from a storage account, back up different VMs at different time of hello day, with no overlap.</span></span>

## <a name="capacity-planning"></a><span data-ttu-id="aafcc-202">Kapacitetsplanering</span><span class="sxs-lookup"><span data-stu-id="aafcc-202">Capacity planning</span></span>
<span data-ttu-id="aafcc-203">Kombinera hello tidigare faktorer behöver du tooplan för hello lagringsbehov konto användning.</span><span class="sxs-lookup"><span data-stu-id="aafcc-203">Putting hello previous factors together, you need tooplan for hello storage account usage needs.</span></span> <span data-ttu-id="aafcc-204">Hämta hello [VM säkerhetskopiering kapacitetsplanering Excel-kalkylblad](https://gallery.technet.microsoft.com/Azure-Backup-Storage-a46d7e33) toosee hello inverkan på disk och schemat för säkerhetskopiering val.</span><span class="sxs-lookup"><span data-stu-id="aafcc-204">Download hello [VM backup capacity planning Excel spreadsheet](https://gallery.technet.microsoft.com/Azure-Backup-Storage-a46d7e33) toosee hello impact of your disk and backup schedule choices.</span></span>

### <a name="backup-throughput"></a><span data-ttu-id="aafcc-205">Säkerhetskopiering genomflöde</span><span class="sxs-lookup"><span data-stu-id="aafcc-205">Backup throughput</span></span>
<span data-ttu-id="aafcc-206">Azure Backup läser hello block på disken hello och lagrar bara hello ändrade data (inkrementell säkerhetskopiering) för varje disk som säkerhetskopieras.</span><span class="sxs-lookup"><span data-stu-id="aafcc-206">For each disk being backed up, Azure Backup reads hello blocks on hello disk and stores only hello changed data (incremental backup).</span></span> <span data-ttu-id="aafcc-207">hello visar följande tabell hello Backup service genomströmning genomsnittsvärden.</span><span class="sxs-lookup"><span data-stu-id="aafcc-207">hello following table shows hello average Backup service throughput values.</span></span> <span data-ttu-id="aafcc-208">Använda hello följande data kan beräkna du hello tidsperiod behövs tooback in en disk för en given storlek.</span><span class="sxs-lookup"><span data-stu-id="aafcc-208">Using hello following data, you can estimate hello amount of time needed tooback up a disk of a given size.</span></span>

| <span data-ttu-id="aafcc-209">Säkerhetskopieringen</span><span class="sxs-lookup"><span data-stu-id="aafcc-209">Backup operation</span></span> | <span data-ttu-id="aafcc-210">Bästa genomflöde</span><span class="sxs-lookup"><span data-stu-id="aafcc-210">Best-case throughput</span></span> |
| --- | --- |
| <span data-ttu-id="aafcc-211">Den första säkerhetskopieringen</span><span class="sxs-lookup"><span data-stu-id="aafcc-211">Initial backup</span></span> |<span data-ttu-id="aafcc-212">160 Mbit/s</span><span class="sxs-lookup"><span data-stu-id="aafcc-212">160 Mbps</span></span> |
| <span data-ttu-id="aafcc-213">Inkrementell säkerhetskopiering (DR)</span><span class="sxs-lookup"><span data-stu-id="aafcc-213">Incremental backup (DR)</span></span> |<span data-ttu-id="aafcc-214">640 Mbit/s</span><span class="sxs-lookup"><span data-stu-id="aafcc-214">640 Mbps</span></span> <br><br> <span data-ttu-id="aafcc-215">Genomströmning således avsevärt om hello ändrat data (som måste säkerhetskopieras toobe) sprids över hello disk.</span><span class="sxs-lookup"><span data-stu-id="aafcc-215">Throughput drops significantly if hello changed data (that needs toobe backed up) is dispersed across hello disk.</span></span>|

## <a name="total-vm-backup-time"></a><span data-ttu-id="aafcc-216">Total tid för säkerhetskopiering av VM</span><span class="sxs-lookup"><span data-stu-id="aafcc-216">Total VM backup time</span></span>
<span data-ttu-id="aafcc-217">Medan de flesta av hello säkerhetskopieringstiden används till att läsa och kopiera data, bidra andra åtgärder toohello totala tid som behövs tooback upp en virtuell dator:</span><span class="sxs-lookup"><span data-stu-id="aafcc-217">While most of hello backup time is spent reading and copying data, other operations contribute toohello total time needed tooback up a VM:</span></span>

* <span data-ttu-id="aafcc-218">Tid som krävs för[installera eller uppdatera hello reservanknytning](backup-azure-vms.md).</span><span class="sxs-lookup"><span data-stu-id="aafcc-218">Time needed too[install or update hello backup extension](backup-azure-vms.md).</span></span>
* <span data-ttu-id="aafcc-219">Snapshot-tid, vilket är hello tidsåtgång tootrigger en ögonblicksbild.</span><span class="sxs-lookup"><span data-stu-id="aafcc-219">Snapshot time, which is hello time taken tootrigger a snapshot.</span></span> <span data-ttu-id="aafcc-220">Ögonblicksbilder är utlösta Stäng toohello schemalagd tid för säkerhetskopiering.</span><span class="sxs-lookup"><span data-stu-id="aafcc-220">Snapshots are triggered close toohello scheduled backup time.</span></span>
* <span data-ttu-id="aafcc-221">Kötid.</span><span class="sxs-lookup"><span data-stu-id="aafcc-221">Queue wait time.</span></span> <span data-ttu-id="aafcc-222">Eftersom hello Backup-tjänsten bearbetar säkerhetskopior från flera kunder, kanske kopiera säkerhetskopierade data från ögonblicksbilden toohello säkerhetskopiering eller återställningstjänster valvet inte startar omedelbart.</span><span class="sxs-lookup"><span data-stu-id="aafcc-222">Since hello Backup service is processing backups from multiple customers, copying backup data from snapshot toohello backup or Recovery Services vault might not start immediately.</span></span> <span data-ttu-id="aafcc-223">I tidpunkter på belastning hello vänta sträcka ut upp tooeight timmar på grund av toohello antal säkerhetskopior som bearbetas.</span><span class="sxs-lookup"><span data-stu-id="aafcc-223">In times of peak load, hello wait can stretch up tooeight hours due toohello number of backups being processed.</span></span> <span data-ttu-id="aafcc-224">Hello totala VM tid för säkerhetskopiering är dock mindre än 24 timmar för principer för daglig säkerhetskopiering.</span><span class="sxs-lookup"><span data-stu-id="aafcc-224">However, hello total VM backup time is less than 24 hours for daily backup policies.</span></span>
* <span data-ttu-id="aafcc-225">Data överföringstiden, tid som krävs för säkerhetskopiering tjänsten toocompute hello inkrementella ändringar från tidigare säkerhetskopia och överför dessa ändringar toovault lagring.</span><span class="sxs-lookup"><span data-stu-id="aafcc-225">Data transfer time, time needed for backup service toocompute hello incremental changes from previous backup and transfer those changes toovault storage.</span></span>

### <a name="why-am-i-observing-longer12-hours-backup-time"></a><span data-ttu-id="aafcc-226">Varför jag sett longer(>12 hours) Säkerhetskopiera tid?</span><span class="sxs-lookup"><span data-stu-id="aafcc-226">Why am I observing longer(>12 hours) backup time?</span></span>
<span data-ttu-id="aafcc-227">Säkerhetskopiering består av två faser: ta ögonblicksbilder och överföra hello ögonblicksbilder toohello valvet.</span><span class="sxs-lookup"><span data-stu-id="aafcc-227">Backup consists of two phases: taking snapshots and transferring hello snapshots toohello vault.</span></span> <span data-ttu-id="aafcc-228">Hej säkerhetskopieringstjänst optimerar för lagring.</span><span class="sxs-lookup"><span data-stu-id="aafcc-228">hello Backup service optimizes for storage.</span></span> <span data-ttu-id="aafcc-229">När du överför hello ögonblicksbild data tooa valvet överförs hello endast inkrementella ändringar från hello tidigare ögonblicksbild.</span><span class="sxs-lookup"><span data-stu-id="aafcc-229">When transferring hello snapshot data tooa vault, hello service only transfers incremental changes from hello previous snapshot.</span></span>  <span data-ttu-id="aafcc-230">toodetermine hello inkrementella ändringar hello service beräknar hello kontrollsumma hello-block.</span><span class="sxs-lookup"><span data-stu-id="aafcc-230">toodetermine hello incremental changes, hello service computes hello checksum of hello blocks.</span></span> <span data-ttu-id="aafcc-231">Om ett block ändras identifieras hello block som ett block toobe skickas toohello valvet.</span><span class="sxs-lookup"><span data-stu-id="aafcc-231">If a block is changed, hello block is identified as a block toobe sent toohello vault.</span></span> <span data-ttu-id="aafcc-232">Sedan identifieras hello tjänsten flyttar ytterligare i var och en av hello block, söker efter affärsmöjligheter toominimize hello data tootransfer.</span><span class="sxs-lookup"><span data-stu-id="aafcc-232">Then hello service drills further into each of hello identified blocks, looking for opportunities toominimize hello data tootransfer.</span></span> <span data-ttu-id="aafcc-233">Efter utvärdering av alla ändrade block hello service slår samman hello ändringar och skickar dem toohello valvet.</span><span class="sxs-lookup"><span data-stu-id="aafcc-233">After evaluating all changed blocks, hello service coalesces hello changes and sends them toohello vault.</span></span> <span data-ttu-id="aafcc-234">I vissa äldre program är liten, fragmenterade skrivningar inte optimalt för lagring.</span><span class="sxs-lookup"><span data-stu-id="aafcc-234">In some legacy applications, small, fragmented writes are not optimal for storage.</span></span> <span data-ttu-id="aafcc-235">Om hello ögonblicksbild innehåller många små, fragmenterade skrivningar, tillbringar hello service extra tid för bearbetning av hello data skrivits av hello program.</span><span class="sxs-lookup"><span data-stu-id="aafcc-235">If hello snapshot contains many small, fragmented writes, hello service spends additional time processing hello data written by hello applications.</span></span> <span data-ttu-id="aafcc-236">hello rekommenderas programmet write block från Azure, för program som körs på hello VM, är minst 8 KB.</span><span class="sxs-lookup"><span data-stu-id="aafcc-236">hello recommended application write block from Azure, for applications running inside hello VM, is a minimum of 8 KB.</span></span> <span data-ttu-id="aafcc-237">Om programmet använder ett block med mindre än 8 KB, påverkas Säkerhetskopieringens prestanda.</span><span class="sxs-lookup"><span data-stu-id="aafcc-237">If your application uses a block of less than 8 KB, backup performance is effected.</span></span> <span data-ttu-id="aafcc-238">Justera prestanda vid säkerhetskopiering ditt program tooimprove finns [justera program för optimala prestanda med Azure storage](../storage/common/storage-premium-storage-performance.md).</span><span class="sxs-lookup"><span data-stu-id="aafcc-238">For help with tuning your application tooimprove backup performance, see [Tuning applications for optimal performance with Azure storage](../storage/common/storage-premium-storage-performance.md).</span></span> <span data-ttu-id="aafcc-239">Men hello artikeln på säkerhetskopieringsprestanda används Premium storage exempel, gäller hello riktlinjer för standardlagring diskar.</span><span class="sxs-lookup"><span data-stu-id="aafcc-239">Though hello article on backup performance uses Premium storage examples, hello guidance is applicable for Standard storage disks.</span></span>

## <a name="total-restore-time"></a><span data-ttu-id="aafcc-240">Totalt antal återställningstid</span><span class="sxs-lookup"><span data-stu-id="aafcc-240">Total restore time</span></span>
<span data-ttu-id="aafcc-241">En återställningsåtgärd består av två huvudsakliga sub aktiviteter: kopiera data från hello valvet toohello valt kundlagringskontot och skapar hello virtuell dator.</span><span class="sxs-lookup"><span data-stu-id="aafcc-241">A restore operation consists of two main sub tasks: Copying data back from hello vault toohello chosen customer storage account, and creating hello virtual machine.</span></span> <span data-ttu-id="aafcc-242">Kopiera data från valvet hello beror på var hello säkerhetskopior lagras internt i Azure och där hello kundlagringskontot lagras.</span><span class="sxs-lookup"><span data-stu-id="aafcc-242">Copying data back from hello vault depends on where hello backups are stored internally in Azure, and where hello customer storage account is stored.</span></span> <span data-ttu-id="aafcc-243">Tidsåtgång toocopy data beror på:</span><span class="sxs-lookup"><span data-stu-id="aafcc-243">Time taken toocopy data depends upon:</span></span>
* <span data-ttu-id="aafcc-244">Tid - Kötid eftersom hello-tjänsten bearbetar återställningsjobb från flera kunder på hello samtidigt, restore-begäranden är placeras i en kö.</span><span class="sxs-lookup"><span data-stu-id="aafcc-244">Queue wait time - Since hello service processes restore jobs from multiple customers at hello same time, restore requests are put in a queue.</span></span>
* <span data-ttu-id="aafcc-245">Kopiera data tid - Data kopieras från hello valvet toohello kundlagringskontot.</span><span class="sxs-lookup"><span data-stu-id="aafcc-245">Data copy time - Data is copied from hello vault toohello customer storage account.</span></span> <span data-ttu-id="aafcc-246">Återställa tiden beror på IOPS och genomströmning Azure Backup-tjänsten hämtar på hello valt kundlagringskontot.</span><span class="sxs-lookup"><span data-stu-id="aafcc-246">Restore time depends on IOPS and throughput Azure Backup service gets on hello selected customer storage account.</span></span> <span data-ttu-id="aafcc-247">tooreduce Hej kopiera under hello återställningsprocessen, Välj ett lagringskonto som inte lästs in med andra program skrivningar och läsningar.</span><span class="sxs-lookup"><span data-stu-id="aafcc-247">tooreduce hello copying time during hello restore process, select a storage account not loaded with other application writes and reads.</span></span>

## <a name="best-practices"></a><span data-ttu-id="aafcc-248">Bästa praxis</span><span class="sxs-lookup"><span data-stu-id="aafcc-248">Best practices</span></span>
<span data-ttu-id="aafcc-249">Vi rekommenderar följande dessa metoder när du konfigurerar säkerhetskopieringar för virtuella datorer:</span><span class="sxs-lookup"><span data-stu-id="aafcc-249">We suggest following these practices while configuring backups for virtual machines:</span></span>

* <span data-ttu-id="aafcc-250">Inte schemalägga fler än 10 klassiska virtuella datorer från samma cloud service tooback på hello hello samtidigt.</span><span class="sxs-lookup"><span data-stu-id="aafcc-250">Don't schedule more than 10 classic VMs from hello same cloud service tooback up at hello same time.</span></span> <span data-ttu-id="aafcc-251">Om du vill tooback in flera virtuella datorer från samma tjänst i molnet, starta Sprid hello säkerhetskopiering gånger med en timme.</span><span class="sxs-lookup"><span data-stu-id="aafcc-251">If you want tooback up multiple VMs from same cloud service, stagger hello backup start times by an hour.</span></span>
* <span data-ttu-id="aafcc-252">Schemalägg inte fler än 40 VMs tooback in på hello samtidigt.</span><span class="sxs-lookup"><span data-stu-id="aafcc-252">Do not schedule more than 40 VMs tooback up at hello same time.</span></span>
* <span data-ttu-id="aafcc-253">Schemalägga VM säkerhetskopior vid låg belastning.</span><span class="sxs-lookup"><span data-stu-id="aafcc-253">Schedule VM backups during non-peak hours.</span></span> <span data-ttu-id="aafcc-254">Det här sättet hello Backup-tjänsten använder IOPS för överföring av data från hello kunden storage-konto toohello valv.</span><span class="sxs-lookup"><span data-stu-id="aafcc-254">This way hello Backup service uses IOPS for transferring data from hello customer storage account toohello vault.</span></span>
* <span data-ttu-id="aafcc-255">Se till att en principen tillämpas på virtuella datorer som är fördelade på olika lagringskonton.</span><span class="sxs-lookup"><span data-stu-id="aafcc-255">Make sure that a policy is applied on VMs spread across different storage accounts.</span></span> <span data-ttu-id="aafcc-256">Vi rekommenderar högst 20 totala diskar från en enda lagringskonto skyddas av hello samma schema för säkerhetskopiering.</span><span class="sxs-lookup"><span data-stu-id="aafcc-256">We suggest no more than 20 total disks from a single storage account be protected by hello same backup schedule.</span></span> <span data-ttu-id="aafcc-257">Om du har mer än 20 diskar i ett lagringskonto sprider sig hello dessa virtuella datorer över flera principer tooget krävs IOPS under hello överföring fasen av hello säkerhetskopieringsprocessen.</span><span class="sxs-lookup"><span data-stu-id="aafcc-257">If you have greater than 20 disks in a storage account, spread those VMs across multiple policies tooget hello required IOPS during hello transfer phase of hello backup process.</span></span>
* <span data-ttu-id="aafcc-258">Återställ inte en virtuell dator som körs på toosame lagring premiumlagringskonto.</span><span class="sxs-lookup"><span data-stu-id="aafcc-258">Do not restore a VM running on Premium storage toosame storage account.</span></span> <span data-ttu-id="aafcc-259">Om hello återställningsprocessen åtgärden sammanfaller med hello säkerhetskopieringen, minskas hello tillgängliga IOPS för säkerhetskopiering.</span><span class="sxs-lookup"><span data-stu-id="aafcc-259">If hello restore operation process coincides with hello backup operation, it reduces hello available IOPS for backup.</span></span>
* <span data-ttu-id="aafcc-260">Se till att lagringskontot att värdar premiumdiskar har minst 50% ledigt utrymme för mellanlagring ögonblicksbild för en lyckad säkerhetskopia för Premium VM-säkerhetskopiering.</span><span class="sxs-lookup"><span data-stu-id="aafcc-260">For Premium VM backup, ensure that storage account that hosts premium disks has atleast 50% free space for staging snapshot for a successful backup.</span></span> 
* <span data-ttu-id="aafcc-261">Kontrollera att python-version på virtuella Linux-datorer aktiverad för säkerhetskopiering är 2.7</span><span class="sxs-lookup"><span data-stu-id="aafcc-261">Make sure that python version on Linux VMs enabled for backup is 2.7</span></span>

## <a name="data-encryption"></a><span data-ttu-id="aafcc-262">Datakryptering</span><span class="sxs-lookup"><span data-stu-id="aafcc-262">Data encryption</span></span>
<span data-ttu-id="aafcc-263">Azure-säkerhetskopiering Kryptera inte data som en del av hello säkerhetskopieringsprocessen.</span><span class="sxs-lookup"><span data-stu-id="aafcc-263">Azure Backup does not encrypt data as a part of hello backup process.</span></span> <span data-ttu-id="aafcc-264">Men du kan kryptera data i hello VM och säkerhetskopiera hello skyddade data sömlöst (Läs mer om [säkerhetskopiering av krypterade data](backup-azure-vms-encryption.md)).</span><span class="sxs-lookup"><span data-stu-id="aafcc-264">However, you can encrypt data within hello VM and back up hello protected data seamlessly (read more about [backup of encrypted data](backup-azure-vms-encryption.md)).</span></span>

## <a name="calculating-hello-cost-of-protected-instances"></a><span data-ttu-id="aafcc-265">Beräknar hello kostnad för skyddade instanser</span><span class="sxs-lookup"><span data-stu-id="aafcc-265">Calculating hello cost of protected instances</span></span>
<span data-ttu-id="aafcc-266">Virtuella Azure-datorer som säkerhetskopieras via Azure Backup är föremål för[priser för Azure Backup](https://azure.microsoft.com/pricing/details/backup/).</span><span class="sxs-lookup"><span data-stu-id="aafcc-266">Azure virtual machines that are backed up through Azure Backup are subject too[Azure Backup pricing](https://azure.microsoft.com/pricing/details/backup/).</span></span> <span data-ttu-id="aafcc-267">hello skyddade instanser beräkningen baseras på hello *faktiska* storlek hello virtuell dator som är hello summan av alla hello data i hello virtuella datorn och exklusive hello ”resurs-disk”.</span><span class="sxs-lookup"><span data-stu-id="aafcc-267">hello Protected Instances calculation is based on hello *actual* size of hello virtual machine, which is hello sum of all hello data in hello virtual machine--excluding hello “resource disk.”</span></span>

<span data-ttu-id="aafcc-268">Priser för säkerhetskopiering av virtuella datorer är *inte* baserat på hello maximala stöds storlek för varje virtuell dator för data disk bifogade toohello.</span><span class="sxs-lookup"><span data-stu-id="aafcc-268">Pricing for backing up VMs is *not* based on hello maximum supported size for each data disk attached toohello virtual machine.</span></span> <span data-ttu-id="aafcc-269">Priser baseras på hello faktiska data som lagras i hello datadisk.</span><span class="sxs-lookup"><span data-stu-id="aafcc-269">Pricing is based on hello actual data stored in hello data disk.</span></span> <span data-ttu-id="aafcc-270">På liknande sätt baseras hello säkerhetskopieringslagring faktura på hello mängden data som lagras i Azure Backup, vilket är hello summan av hello faktiska data i varje återställningspunkt.</span><span class="sxs-lookup"><span data-stu-id="aafcc-270">Similarly, hello backup storage bill is based on hello amount of data that is stored in Azure Backup, which is hello sum of hello actual data in each recovery point.</span></span>

<span data-ttu-id="aafcc-271">Till exempel ta en Standard A2-storlek virtuell dator med två ytterligare hårddiskar med en maximal storlek på 1 TB.</span><span class="sxs-lookup"><span data-stu-id="aafcc-271">For example, take an A2 Standard-sized virtual machine that has two additional data disks with a maximum size of 1 TB each.</span></span> <span data-ttu-id="aafcc-272">hello ger följande tabell hello faktiska data som lagras på var och en av dessa diskar:</span><span class="sxs-lookup"><span data-stu-id="aafcc-272">hello following table gives hello actual data stored on each of these disks:</span></span>

| <span data-ttu-id="aafcc-273">Disktyp</span><span class="sxs-lookup"><span data-stu-id="aafcc-273">Disk type</span></span> | <span data-ttu-id="aafcc-274">Maxstorlek</span><span class="sxs-lookup"><span data-stu-id="aafcc-274">Max size</span></span> | <span data-ttu-id="aafcc-275">Faktiska data finns</span><span class="sxs-lookup"><span data-stu-id="aafcc-275">Actual data present</span></span> |
| --- | --- | --- |
| <span data-ttu-id="aafcc-276">Operativsystemdisk</span><span class="sxs-lookup"><span data-stu-id="aafcc-276">Operating system disk</span></span> |<span data-ttu-id="aafcc-277">1 023 GB</span><span class="sxs-lookup"><span data-stu-id="aafcc-277">1023 GB</span></span> |<span data-ttu-id="aafcc-278">17 GB</span><span class="sxs-lookup"><span data-stu-id="aafcc-278">17 GB</span></span> |
| <span data-ttu-id="aafcc-279">Lokal disk / resurs disk</span><span class="sxs-lookup"><span data-stu-id="aafcc-279">Local disk / Resource disk</span></span> |<span data-ttu-id="aafcc-280">135 GB</span><span class="sxs-lookup"><span data-stu-id="aafcc-280">135 GB</span></span> |<span data-ttu-id="aafcc-281">5 GB (ingår inte för säkerhetskopiering)</span><span class="sxs-lookup"><span data-stu-id="aafcc-281">5 GB (not included for backup)</span></span> |
| <span data-ttu-id="aafcc-282">Datadisk 1</span><span class="sxs-lookup"><span data-stu-id="aafcc-282">Data disk 1</span></span> |<span data-ttu-id="aafcc-283">1 023 GB</span><span class="sxs-lookup"><span data-stu-id="aafcc-283">1023 GB</span></span> |<span data-ttu-id="aafcc-284">30 GB</span><span class="sxs-lookup"><span data-stu-id="aafcc-284">30 GB</span></span> |
| <span data-ttu-id="aafcc-285">Datadisk 2</span><span class="sxs-lookup"><span data-stu-id="aafcc-285">Data disk 2</span></span> |<span data-ttu-id="aafcc-286">1 023 GB</span><span class="sxs-lookup"><span data-stu-id="aafcc-286">1023 GB</span></span> |<span data-ttu-id="aafcc-287">0 GB</span><span class="sxs-lookup"><span data-stu-id="aafcc-287">0 GB</span></span> |

<span data-ttu-id="aafcc-288">Hej *faktiska* storleken på hello virtuella datorn är i det här fallet 17 GB + 30 GB + 0 GB = 47 GB.</span><span class="sxs-lookup"><span data-stu-id="aafcc-288">hello *actual* size of hello virtual machine in this case is 17 GB + 30 GB + 0 GB = 47 GB.</span></span> <span data-ttu-id="aafcc-289">Den här skyddade instansstorleken (47 GB) blir hello grunden för hello månadsfaktura.</span><span class="sxs-lookup"><span data-stu-id="aafcc-289">This Protected Instance size (47 GB) becomes hello basis for hello monthly bill.</span></span> <span data-ttu-id="aafcc-290">Som hello växer mängden data i hello virtuella hello skyddade instansstorleken används för fakturering ändringar därefter.</span><span class="sxs-lookup"><span data-stu-id="aafcc-290">As hello amount of data in hello virtual machine grows, hello Protected Instance size used for billing changes accordingly.</span></span>

<span data-ttu-id="aafcc-291">Faktureringen startar inte förrän hello första lyckade säkerhetskopieringen är klar.</span><span class="sxs-lookup"><span data-stu-id="aafcc-291">Billing does not start until hello first successful backup completes.</span></span> <span data-ttu-id="aafcc-292">Nu inleds hello fakturering för både lagring och skyddade instanser.</span><span class="sxs-lookup"><span data-stu-id="aafcc-292">At this point, hello billing for both Storage and Protected Instances begins.</span></span> <span data-ttu-id="aafcc-293">Fakturering fortsätter så länge det finns *någon säkerhetskopierade data lagras i ett valv* för hello virtuella datorn.</span><span class="sxs-lookup"><span data-stu-id="aafcc-293">Billing continues as long as there is *any backup data stored in a vault* for hello virtual machine.</span></span> <span data-ttu-id="aafcc-294">Om du stoppar skydd på hello virtuell dator, men säkerhetskopierade data för virtuella datorer finns i ett valv, fortsätter fakturering.</span><span class="sxs-lookup"><span data-stu-id="aafcc-294">If you stop protection on hello virtual machine, but virtual machine backup data exists in a vault, billing continues.</span></span>

<span data-ttu-id="aafcc-295">Faktureringen för en angiven virtuell dator slutar endast om hello skyddet har avbrutits *och* alla säkerhetskopierade data tas bort.</span><span class="sxs-lookup"><span data-stu-id="aafcc-295">Billing for a specified virtual machine stops only if hello protection is stopped *and* all backup data is deleted.</span></span> <span data-ttu-id="aafcc-296">När skydd stanna och det finns inga aktiva jobb för säkerhetskopiering, hello storleken på hello senaste lyckade säkerhetskopiering blir hello skyddade instansstorleken används för hello månadsfaktura.</span><span class="sxs-lookup"><span data-stu-id="aafcc-296">When protection stops and there are no active backup jobs, hello size of hello last successful VM backup becomes hello Protected Instance size used for hello monthly bill.</span></span>

## <a name="questions"></a><span data-ttu-id="aafcc-297">Frågor?</span><span class="sxs-lookup"><span data-stu-id="aafcc-297">Questions?</span></span>
<span data-ttu-id="aafcc-298">Om du har frågor eller om det inte finns någon funktion som du vill att toosee ingår, [skicka feedback](http://aka.ms/azurebackup_feedback).</span><span class="sxs-lookup"><span data-stu-id="aafcc-298">If you have questions, or if there is any feature that you would like toosee included, [send us feedback](http://aka.ms/azurebackup_feedback).</span></span>

## <a name="next-steps"></a><span data-ttu-id="aafcc-299">Nästa steg</span><span class="sxs-lookup"><span data-stu-id="aafcc-299">Next steps</span></span>
* [<span data-ttu-id="aafcc-300">Säkerhetskopiera virtuella datorer</span><span class="sxs-lookup"><span data-stu-id="aafcc-300">Back up virtual machines</span></span>](backup-azure-vms.md)
* [<span data-ttu-id="aafcc-301">Hantera säkerhetskopiering av virtuella datorer</span><span class="sxs-lookup"><span data-stu-id="aafcc-301">Manage virtual machine backup</span></span>](backup-azure-manage-vms.md)
* [<span data-ttu-id="aafcc-302">Återställa virtuella datorer</span><span class="sxs-lookup"><span data-stu-id="aafcc-302">Restore virtual machines</span></span>](backup-azure-restore-vms.md)
* [<span data-ttu-id="aafcc-303">Felsökning av problem med backup VM</span><span class="sxs-lookup"><span data-stu-id="aafcc-303">Troubleshoot VM backup issues</span></span>](backup-azure-vms-troubleshoot.md)
