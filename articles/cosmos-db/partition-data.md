---
title: aaaPartitioning och teckenbredden i Azure Cosmos DB | Microsoft Docs
description: "Lär dig mer om hur partitionering fungerar i Azure Cosmos DB hur tooconfigure partitionering och partitionsnycklar och hur toopick hello höger partitions-nyckeln för ditt program."
services: cosmos-db
author: arramac
manager: jhubbard
editor: monicar
documentationcenter: 
ms.assetid: cac9a8cd-b5a3-4827-8505-d40bb61b2416
ms.service: cosmos-db
ms.workload: data-services
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 05/10/2017
ms.author: arramac
ms.custom: H1Hack27Feb2017
ms.openlocfilehash: 87d56db8c4ccc6b94b1650baff0fcfb3db6d1777
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 10/06/2017
---
# <a name="how-toopartition-and-scale-in-azure-cosmos-db"></a><span data-ttu-id="7d7fc-103">Hur toopartition och skala i Azure Cosmos DB</span><span class="sxs-lookup"><span data-stu-id="7d7fc-103">How toopartition and scale in Azure Cosmos DB</span></span>

<span data-ttu-id="7d7fc-104">[Microsoft Azure Cosmos DB](https://azure.microsoft.com/services/cosmos-db/) är en global distribuerade och flera olika modeller databasen syftar toohelp du uppnå snabb och förutsägbar prestanda och skalning sömlöst tillsammans med ditt program som de växer.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-104">[Microsoft Azure Cosmos DB](https://azure.microsoft.com/services/cosmos-db/) is a global distributed, multi-model database service designed toohelp you achieve fast, predictable performance and scale seamlessly along with your application as it grows.</span></span> <span data-ttu-id="7d7fc-105">Den här artikeln innehåller en översikt över hur partitionering fungerar för alla data som hello modeller i Azure Cosmos DB och beskriver hur du kan konfigurera Azure Cosmos DB behållare tooeffectively skala ditt program.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-105">This article provides an overview of how partitioning works for all hello data models in Azure Cosmos DB, and describes how you can configure Azure Cosmos DB containers tooeffectively scale your applications.</span></span>

<span data-ttu-id="7d7fc-106">Partitionering och partitionsnycklar också beskrivs i den här Azure fredag video med Scott Hanselman och Azure Cosmos DB Principal tekniker Manager, Shireesh Thota.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-106">Partitioning and partition keys are also covered in this Azure Friday video with Scott Hanselman and Azure Cosmos DB Principal Engineering Manager, Shireesh Thota.</span></span>

> [!VIDEO https://channel9.msdn.com/Shows/Azure-Friday/Azure-DocumentDB-Elastic-Scale-Partitioning/player]
> 

## <a name="partitioning-in-azure-cosmos-db"></a><span data-ttu-id="7d7fc-107">Partitionering i Azure Cosmos DB</span><span class="sxs-lookup"><span data-stu-id="7d7fc-107">Partitioning in Azure Cosmos DB</span></span>
<span data-ttu-id="7d7fc-108">Du kan lagra och fråga schemat mindre data med ordning millisekunder svarstider skaländras i Azure Cosmos-databasen.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-108">In Azure Cosmos DB, you can store and query schema-less data with order-of-millisecond response times at any scale.</span></span> <span data-ttu-id="7d7fc-109">Cosmos DB innehåller behållare för lagring av data kallas **samlingar (för dokument), diagram och tabeller**.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-109">Cosmos DB provides containers for storing data called **collections (for document), graphs, or tables**.</span></span> <span data-ttu-id="7d7fc-110">Behållare är logiska nätverksresurser och kan sträcka sig över en eller flera partitioner fysiska servrar.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-110">Containers are logical resources and can span one or more physical partitions or servers.</span></span> <span data-ttu-id="7d7fc-111">hello antalet partitioner bestäms av Cosmos DB baserat på hello lagringsstorlek och hello etablerat dataflöde för hello behållare.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-111">hello number of partitions is determined by Cosmos DB based on hello storage size and hello provisioned throughput of hello container.</span></span> <span data-ttu-id="7d7fc-112">Varje partition i Cosmos-databasen har en fast mängd SSD-baserad lagring som är kopplad till den och replikeras för hög tillgänglighet.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-112">Every partition in Cosmos DB has a fixed amount of SSD-backed storage associated with it, and is replicated for high availability.</span></span> <span data-ttu-id="7d7fc-113">Partitionen management hanteras helt av Azure Cosmos DB och du inte har toowrite komplex kod eller hantera din partitioner.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-113">Partition management is fully managed by Azure Cosmos DB, and you do not have toowrite complex code or manage your partitions.</span></span> <span data-ttu-id="7d7fc-114">Cosmos DB behållare är obegränsad lagring och genomflöde.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-114">Cosmos DB containers are unlimited in terms of storage and throughput.</span></span> 

![vågrät](./media/introduction/azure-cosmos-db-partitioning.png) 

<span data-ttu-id="7d7fc-116">Partitionering är transparent tooyour program.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-116">Partitioning is transparent tooyour application.</span></span> <span data-ttu-id="7d7fc-117">Cosmos DB stöder snabb läsning och skrivning, frågor, transaktionella logik, konsekvensnivåer och detaljerad åtkomstkontroll via metoder/API: er tooa enskild behållare resurs.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-117">Cosmos DB supports fast reads and writes, queries, transactional logic, consistency levels, and fine-grained access control via methods/APIs tooa single container resource.</span></span> <span data-ttu-id="7d7fc-118">hello tjänsten hanterar distribuera data över partitioner och routning frågan begäranden toohello rätt partition.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-118">hello service handles distributing data across partitions and routing query requests toohello right partition.</span></span> 

<span data-ttu-id="7d7fc-119">Hur fungerar partitionering?</span><span class="sxs-lookup"><span data-stu-id="7d7fc-119">How does partitioning work?</span></span> <span data-ttu-id="7d7fc-120">Varje objekt måste ha en partitionsnyckel och en rad, som kan identifieras.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-120">Each item must have a partition key and a row key, which uniquely identify it.</span></span> <span data-ttu-id="7d7fc-121">Din partitionsnyckel fungerar som en logisk partition för dina data och ger Cosmos DB en naturlig gräns för att distribuera data över partitioner.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-121">Your partition key acts as a logical partition for your data, and provides Cosmos DB with a natural boundary for distributing data across partitions.</span></span> <span data-ttu-id="7d7fc-122">I korthet är här hur partitionering fungerar i Azure Cosmos DB:</span><span class="sxs-lookup"><span data-stu-id="7d7fc-122">In brief, here is how partitioning works in Azure Cosmos DB:</span></span>

* <span data-ttu-id="7d7fc-123">Du etablerar en Cosmos-DB-behållare med `T` begäranden/s genomströmning</span><span class="sxs-lookup"><span data-stu-id="7d7fc-123">You provision a Cosmos DB container with `T` requests/s throughput</span></span>
* <span data-ttu-id="7d7fc-124">Hello bakgrunden Cosmos DB tillhandahåller partitioner behövs tooserve `T` begäranden/s.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-124">Behind hello scenes, Cosmos DB provisions partitions needed tooserve `T` requests/s.</span></span> <span data-ttu-id="7d7fc-125">Om `T` är högre än hello maximalt dataflöde per partition `t`, sedan Cosmos DB tillhandahåller `N`  =  `T/t` partitioner</span><span class="sxs-lookup"><span data-stu-id="7d7fc-125">If `T` is higher than hello maximum throughput per partition `t`, then Cosmos DB provisions `N` = `T/t` partitions</span></span>
* <span data-ttu-id="7d7fc-126">Cosmos DB allokerar hello nyckel utrymme på partitionen viktiga hashvärden jämnt över hello `N` partitioner.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-126">Cosmos DB allocates hello key space of partition key hashes evenly across hello `N` partitions.</span></span> <span data-ttu-id="7d7fc-127">Därför 1 N partition nyckelvärdena (logiska partitioner) är värd för varje partition (fysiska partition)</span><span class="sxs-lookup"><span data-stu-id="7d7fc-127">So, each partition (physical partition) hosts 1-N partition key values (logical partitions)</span></span>
* <span data-ttu-id="7d7fc-128">När en fysisk partition `p` når sin lagringsgräns, Cosmos DB sömlöst delar `p` till två nya partitioner `p1` och `p2` och distribuerar värden som motsvarar tooroughly halva hello nycklar tooeach av hello partitioner.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-128">When a physical partition `p` reaches its storage limit, Cosmos DB seamlessly splits `p` into two new partitions `p1` and `p2` and distributes values corresponding tooroughly half hello keys tooeach of hello partitions.</span></span> <span data-ttu-id="7d7fc-129">Den här delade åtgärden är osynliga tooyour program.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-129">This split operation is invisible tooyour application.</span></span>
* <span data-ttu-id="7d7fc-130">På liknande sätt, när du etablerar genomströmning som är högre än `t*N` dataflöde, Cosmos DB delar upp en eller flera av dina partitioner toosupport hello högre genomströmning</span><span class="sxs-lookup"><span data-stu-id="7d7fc-130">Similarly, when you provision throughput higher than `t*N` throughput, Cosmos DB splits one or more of your partitions toosupport hello higher throughput</span></span>

<span data-ttu-id="7d7fc-131">hello semantik för partitionsnycklar är något annorlunda toomatch hello semantiken för varje API, som visas i följande tabell hello:</span><span class="sxs-lookup"><span data-stu-id="7d7fc-131">hello semantics for partition keys are slightly different toomatch hello semantics of each API, as shown in hello following table:</span></span>

| <span data-ttu-id="7d7fc-132">API</span><span class="sxs-lookup"><span data-stu-id="7d7fc-132">API</span></span> | <span data-ttu-id="7d7fc-133">Partitionsnyckeln</span><span class="sxs-lookup"><span data-stu-id="7d7fc-133">Partition Key</span></span> | <span data-ttu-id="7d7fc-134">Radnyckel</span><span class="sxs-lookup"><span data-stu-id="7d7fc-134">Row Key</span></span> |
| --- | --- | --- |
| <span data-ttu-id="7d7fc-135">DocumentDB</span><span class="sxs-lookup"><span data-stu-id="7d7fc-135">DocumentDB</span></span> | <span data-ttu-id="7d7fc-136">Anpassad partitionering nyckelsökvägen</span><span class="sxs-lookup"><span data-stu-id="7d7fc-136">custom partition key path</span></span> | <span data-ttu-id="7d7fc-137">fast`id`</span><span class="sxs-lookup"><span data-stu-id="7d7fc-137">fixed `id`</span></span> | 
| <span data-ttu-id="7d7fc-138">MongoDB</span><span class="sxs-lookup"><span data-stu-id="7d7fc-138">MongoDB</span></span> | <span data-ttu-id="7d7fc-139">anpassade Fragmentera nyckel</span><span class="sxs-lookup"><span data-stu-id="7d7fc-139">custom shard key</span></span>  | <span data-ttu-id="7d7fc-140">fast`_id`</span><span class="sxs-lookup"><span data-stu-id="7d7fc-140">fixed `_id`</span></span> | 
| <span data-ttu-id="7d7fc-141">Graph</span><span class="sxs-lookup"><span data-stu-id="7d7fc-141">Graph</span></span> | <span data-ttu-id="7d7fc-142">Anpassad partitionering nyckelegenskapen</span><span class="sxs-lookup"><span data-stu-id="7d7fc-142">custom partition key property</span></span> | <span data-ttu-id="7d7fc-143">fast`id`</span><span class="sxs-lookup"><span data-stu-id="7d7fc-143">fixed `id`</span></span> | 
| <span data-ttu-id="7d7fc-144">Tabell</span><span class="sxs-lookup"><span data-stu-id="7d7fc-144">Table</span></span> | <span data-ttu-id="7d7fc-145">fast`PartitionKey`</span><span class="sxs-lookup"><span data-stu-id="7d7fc-145">fixed `PartitionKey`</span></span> | <span data-ttu-id="7d7fc-146">fast`RowKey`</span><span class="sxs-lookup"><span data-stu-id="7d7fc-146">fixed `RowKey`</span></span> | 

<span data-ttu-id="7d7fc-147">Cosmos DB använder hash-baserad partitionering.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-147">Cosmos DB uses hash-based partitioning.</span></span> <span data-ttu-id="7d7fc-148">När du skriver ett objekt Cosmos DB hashar hello partitionsnyckelvärde och Använd hello hashas resultatet toodetermine vilket partition toostore hello objekt i.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-148">When you write an item, Cosmos DB hashes hello partition key value and use hello hashed result toodetermine which partition toostore hello item in.</span></span> <span data-ttu-id="7d7fc-149">Cosmos DB lagrar alla artiklar med hello samma partitionsnyckel i hello samma fysiska partition.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-149">Cosmos DB stores all items with hello same partition key in hello same physical partition.</span></span> <span data-ttu-id="7d7fc-150">hello valet av hello partitionsnyckel är ett viktigt beslut som du har toomake i designläge.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-150">hello choice of hello partition key is an important decision that you have toomake at design time.</span></span> <span data-ttu-id="7d7fc-151">Du måste välja ett egenskapsnamn som har ett stort antal värden och har även åtkomstmönster.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-151">You must pick a property name that has a wide range of values and has even access patterns.</span></span>

> [!NOTE]
> <span data-ttu-id="7d7fc-152">Det är en bästa praxis toohave en partitionsnyckel med många distinkta värden (100-tal-1 000-tal minst).</span><span class="sxs-lookup"><span data-stu-id="7d7fc-152">It is a best practice toohave a partition key with many distinct values (100s-1000s at a minimum).</span></span>
>

<span data-ttu-id="7d7fc-153">Azure DB Cosmos-behållare kan skapas som ”fast” eller ”unlimited”.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-153">Azure Cosmos DB containers can be created as "fixed" or "unlimited."</span></span> <span data-ttu-id="7d7fc-154">Fast storlek behållare har en maxgräns på 10 GB och 10 000 RU/s genomströmning.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-154">Fixed-size containers have a maximum limit of 10 GB and 10,000 RU/s throughput.</span></span> <span data-ttu-id="7d7fc-155">Vissa API: er kan hello partition viktiga toobe utelämnas för behållare med fast storlek.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-155">Some APIs allow hello partition key toobe omitted for fixed-size containers.</span></span> <span data-ttu-id="7d7fc-156">Du måste ange en lägsta dataflöde på 2500 RU/s toocreate en behållare som obegränsade.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-156">toocreate a container as unlimited, you must specify a minimum throughput of 2500 RU/s.</span></span>

## <a name="partitioning-and-provisioned-throughput"></a><span data-ttu-id="7d7fc-157">Partitionering och etablerat dataflöde</span><span class="sxs-lookup"><span data-stu-id="7d7fc-157">Partitioning and provisioned throughput</span></span>
<span data-ttu-id="7d7fc-158">Cosmos DB är utformad för förutsägbar prestanda.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-158">Cosmos DB is designed for predictable performance.</span></span> <span data-ttu-id="7d7fc-159">När du skapar en behållare kan du reservera genomflöde i  **[programbegäran](request-units.md) (RU) per sekund med en potentiell tillägget för RU per minut**.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-159">When you create a container, you reserve throughput in terms of **[request units](request-units.md) (RU) per second with a potential add-on for RU per minute**.</span></span> <span data-ttu-id="7d7fc-160">Varje begäran har tilldelats en avgift för begäran enhet som är proportionell toohello mängden systemresurser som CPU, minne och i/o som används av hello åtgärden.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-160">Each request is assigned a request unit charge that is proportionate toohello amount of system resources like CPU, Memory, and IO consumed by hello operation.</span></span> <span data-ttu-id="7d7fc-161">En läsning av ett 1-KB-dokument med sessionskonsekvens förbrukar en begäran enhet.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-161">A read of a 1-KB document with Session consistency consumes one request unit.</span></span> <span data-ttu-id="7d7fc-162">Läs är 1 RU oavsett hello antal objekt som lagras eller hello antalet samtidiga begäranden som körs vid hello samtidigt.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-162">A read is 1 RU regardless of hello number of items stored or hello number of concurrent requests running at hello same time.</span></span> <span data-ttu-id="7d7fc-163">Större objekt kräver högre frågeenheter beroende på hello storlek.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-163">Larger items require higher request units depending on hello size.</span></span> <span data-ttu-id="7d7fc-164">Om du känner hello storleken på dina enheter och hello antalet läsningar du toosupport för programmet, du kan etablera hello exakta mängden dataflödet som krävs för ditt program är behöver läsa.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-164">If you know hello size of your entities and hello number of reads you need toosupport for your application, you can provision hello exact amount of throughput required for your application's read needs.</span></span> 

> [!NOTE]
> <span data-ttu-id="7d7fc-165">tooachieve hello totala genomflödet i hello behållare, måste du välja en partitionsnyckel som gör att du tooevenly distribuera begäranden mellan vissa nyckelvärden för olika partition.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-165">tooachieve hello full throughput of hello container, you must choose a partition key that allows you tooevenly distribute requests among some distinct partition key values.</span></span>
> 
> 

<a name="designing-for-partitioning"></a>
## <a name="working-with-hello-azure-cosmos-db-apis"></a><span data-ttu-id="7d7fc-166">Arbeta med hello Azure Cosmos DB API: er</span><span class="sxs-lookup"><span data-stu-id="7d7fc-166">Working with hello Azure Cosmos DB APIs</span></span>
<span data-ttu-id="7d7fc-167">Du kan använda hello Azure-portalen eller Azure CLI toocreate behållare och skala dem när som helst.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-167">You can use hello Azure portal or Azure CLI toocreate containers and scale them at any time.</span></span> <span data-ttu-id="7d7fc-168">Det här avsnittet visas hur toocreate behållare och ange hello genomflöde och partition definitionen i varje hello stöds API: er.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-168">This section shows how toocreate containers and specify hello throughput and partition key definition in each of hello supported APIs.</span></span>

### <a name="documentdb-api"></a><span data-ttu-id="7d7fc-169">DocumentDB-API</span><span class="sxs-lookup"><span data-stu-id="7d7fc-169">DocumentDB API</span></span>
<span data-ttu-id="7d7fc-170">hello som följande exempel visar hur en behållare (insamling) med hjälp av toocreate hello DocumentDB-API.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-170">hello following sample shows how toocreate a container (collection) using hello DocumentDB API.</span></span> <span data-ttu-id="7d7fc-171">Du hittar mer information finns i [partitionering med DocumentDB API](partition-data.md).</span><span class="sxs-lookup"><span data-stu-id="7d7fc-171">You can find more details in [Partitioning with DocumentDB API](partition-data.md).</span></span>

```csharp
DocumentClient client = new DocumentClient(new Uri(endpoint), authKey);
await client.CreateDatabaseAsync(new Database { Id = "db" });

DocumentCollection myCollection = new DocumentCollection();
myCollection.Id = "coll";
myCollection.PartitionKey.Paths.Add("/deviceId");

await client.CreateDocumentCollectionAsync(
    UriFactory.CreateDatabaseUri("db"),
    myCollection,
    new RequestOptions { OfferThroughput = 20000 });
```

<span data-ttu-id="7d7fc-172">Du kan läsa en artikel (dokument) med hello `GET` metod i hello REST API eller med hjälp av `ReadDocumentAsync` i ett hello SDK: er.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-172">You can read an item (document) using hello `GET` method in hello REST API or using `ReadDocumentAsync` in one of hello SDKs.</span></span>

```csharp
// Read document. Needs hello partition key and hello ID toobe specified
DeviceReading document = await client.ReadDocumentAsync<DeviceReading>(
  UriFactory.CreateDocumentUri("db", "coll", "XMS-001-FE24C"), 
  new RequestOptions { PartitionKey = new PartitionKey("XMS-0001") });
```

### <a name="mongodb-api"></a><span data-ttu-id="7d7fc-173">MongoDB-API</span><span class="sxs-lookup"><span data-stu-id="7d7fc-173">MongoDB API</span></span>
<span data-ttu-id="7d7fc-174">Du kan skapa ett delat samling via din favorit-verktyget, drivrutiner och SDK med hello MongoDB-API.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-174">With hello MongoDB API, you can create a sharded collection through your favorite tool, driver, or SDK.</span></span> <span data-ttu-id="7d7fc-175">I det här exemplet använder vi hello Mongo-gränssnittet för att skapa en samling hello.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-175">In this example, we use hello Mongo Shell for hello collection creation.</span></span>

<span data-ttu-id="7d7fc-176">I hello Mongo Shell:</span><span class="sxs-lookup"><span data-stu-id="7d7fc-176">In hello Mongo Shell:</span></span>

```
db.runCommand( { shardCollection: "admin.people", key: { region: "hashed" } } )
```
    
<span data-ttu-id="7d7fc-177">Resultat:</span><span class="sxs-lookup"><span data-stu-id="7d7fc-177">Results:</span></span>

```JSON
{
    "_t" : "ShardCollectionResponse",
    "ok" : 1,
    "collectionsharded" : "admin.people"
}
```

### <a name="table-api"></a><span data-ttu-id="7d7fc-178">Tabell-API</span><span class="sxs-lookup"><span data-stu-id="7d7fc-178">Table API</span></span>

<span data-ttu-id="7d7fc-179">Med hello tabell API ange hello genomströmning för tabeller i hello appSettings-konfigurationen för programmet:</span><span class="sxs-lookup"><span data-stu-id="7d7fc-179">With hello Table API, you specify hello throughput for tables in hello appSettings configuration for your application:</span></span>

```xml
<configuration>
    <appSettings>
      <!--Table creation options -->
      <add key="TableThroughput" value="700"/>
    </appSettings>
</configuration>
```

<span data-ttu-id="7d7fc-180">Sedan kan du skapa en tabell med hello Azure Table storage SDK.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-180">Then you create a table using hello Azure Table storage SDK.</span></span> <span data-ttu-id="7d7fc-181">hello partitionsnyckel skapas implicit som hello `PartitionKey` värde.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-181">hello partition key is implicitly created as hello `PartitionKey` value.</span></span> 

```csharp
CloudTableClient tableClient = storageAccount.CreateCloudTableClient();

CloudTable table = tableClient.GetTableReference("people");
table.CreateIfNotExists();
```

<span data-ttu-id="7d7fc-182">Du kan hämta en enda entitet med hjälp av följande fragment hello:</span><span class="sxs-lookup"><span data-stu-id="7d7fc-182">You can retrieve a single entity using hello following snippet:</span></span>

```csharp
// Create a retrieve operation that takes a customer entity.
TableOperation retrieveOperation = TableOperation.Retrieve<CustomerEntity>("Smith", "Ben");

// Execute hello retrieve operation.
TableResult retrievedResult = table.Execute(retrieveOperation);
```
<span data-ttu-id="7d7fc-183">Se [utveckling med hello tabell API](tutorial-develop-table-dotnet.md) för mer information.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-183">See [Developing with hello Table API](tutorial-develop-table-dotnet.md) for more details.</span></span>

### <a name="graph-api"></a><span data-ttu-id="7d7fc-184">Graph API</span><span class="sxs-lookup"><span data-stu-id="7d7fc-184">Graph API</span></span>

<span data-ttu-id="7d7fc-185">Du måste använda hello Azure-portalen eller CLI toocreate behållare med hello Graph API.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-185">With hello Graph API, you must use hello Azure portal or CLI toocreate containers.</span></span> <span data-ttu-id="7d7fc-186">Eftersom Azure Cosmos DB flera modell kan du alternativt med någon av hello andra modeller toocreate och skala graph-behållaren.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-186">Alternatively, since Azure Cosmos DB is multi-model, you can use one of hello other models toocreate and scale your graph container.</span></span>

<span data-ttu-id="7d7fc-187">Du kan läsa alla hörn eller en kant med hello partitionsnyckel och ID: t i Gremlin.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-187">You can read any vertex or edge using hello partition key and id in Gremlin.</span></span> <span data-ttu-id="7d7fc-188">Till exempel för ett diagram med region (”USA”) som hello partitionsnyckel och ”Seattle” som hello radnyckel hittar du en nod med hjälp av hello följande syntax:</span><span class="sxs-lookup"><span data-stu-id="7d7fc-188">For example, for a graph with region ("USA") as hello partition key, and "Seattle" as hello row key, you can find a vertex using hello following syntax:</span></span>

```
g.V(['USA', 'Seattle'])
```

<span data-ttu-id="7d7fc-189">På samma sätt som med kanter, kan du referera en kant med hello partitionsnyckel och radnyckel.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-189">Same with edges, you can reference an edge using hello partition key and row key.</span></span>

```
g.E(['USA', 'I5'])
```

<span data-ttu-id="7d7fc-190">Se [Gremlin stöd för Cosmos-DB](gremlin-support.md) för mer information.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-190">See [Gremlin support for Cosmos DB](gremlin-support.md) for more details.</span></span>


<a name="designing-for-partitioning"></a>
## <a name="designing-for-partitioning"></a><span data-ttu-id="7d7fc-191">Utformning för partitionering</span><span class="sxs-lookup"><span data-stu-id="7d7fc-191">Designing for partitioning</span></span>
<span data-ttu-id="7d7fc-192">tooscale effektivt med Azure Cosmos DB måste toopick en bra partitionsnyckel när du skapar en behållare.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-192">tooscale effectively with Azure Cosmos DB, you need toopick a good partition key when you create your container.</span></span> <span data-ttu-id="7d7fc-193">Det finns två viktiga överväganden för att välja en partitionsnyckel:</span><span class="sxs-lookup"><span data-stu-id="7d7fc-193">There are two key considerations for choosing a partition key:</span></span>

* <span data-ttu-id="7d7fc-194">**Gräns för frågan och transaktioner**: valet av partitionsnyckel ska utjämna hello måste tooenable hello användning av transaktioner mot hello krav toodistribute entiteterna mot flera partition nycklar tooensure en skalbar lösning.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-194">**Boundary for query and transactions**: Your choice of partition key should balance hello need tooenable hello use of transactions against hello requirement toodistribute your entities across multiple partition keys tooensure a scalable solution.</span></span> <span data-ttu-id="7d7fc-195">Du kan ange hello på en extreme samma partitionsnyckel för alla objekt, men detta kan begränsa hello skalbarhet i lösningen.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-195">At one extreme, you could set hello same partition key for all your items, but this may limit hello scalability of your solution.</span></span> <span data-ttu-id="7d7fc-196">Vid hello andra extreme kan du tilldela en unik partitionsnyckel för varje objekt som skulle vara mycket skalbar, men som skulle kunna hindra att du använder transaktioner mellan dokument via lagrade procedurer och utlösare.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-196">At hello other extreme, you could assign a unique partition key for each item, which would be highly scalable but would prevent you from using cross document transactions via stored procedures and triggers.</span></span> <span data-ttu-id="7d7fc-197">En perfekt Partitionsnyckeln är något som gör att du toouse effektiva frågor och som har tillräcklig kardinalitet tooensure din lösning är skalbart.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-197">An ideal partition key is one that enables you toouse efficient queries and that has sufficient cardinality tooensure your solution is scalable.</span></span> 
* <span data-ttu-id="7d7fc-198">**Inga lagrings- och prestandakrav flaskhalsar**: det är viktigt toopick en egenskap som gör att skriver toobe fördelad över olika distinkta värden.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-198">**No storage and performance bottlenecks**: It is important toopick a property that allows writes toobe distributed across various distinct values.</span></span> <span data-ttu-id="7d7fc-199">Begäranden toohello samma partitionsnyckel får inte överskrida hello genomströmningen i en enda partition och har begränsats.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-199">Requests toohello same partition key cannot exceed hello throughput of a single partition, and are throttled.</span></span> <span data-ttu-id="7d7fc-200">Det är därför viktigt toopick en partitionsnyckel inte resulterar i ”aktiva punkter” i ditt program.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-200">So it is important toopick a partition key that does not result in "hot spots" within your application.</span></span> <span data-ttu-id="7d7fc-201">Eftersom alla hello-data för en enda partitionsnyckel måste lagras i en partition bör också tooavoid partitionsnycklar som har stora mängder data för hello samma värde.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-201">Since all hello data for a single partition key must be stored within a partition, it is also recommended tooavoid partition keys that have high volumes of data for hello same value.</span></span> 

<span data-ttu-id="7d7fc-202">Nu ska vi titta på några verkliga scenarier och bra partitionsnycklar för varje:</span><span class="sxs-lookup"><span data-stu-id="7d7fc-202">Let's look at a few real-world scenarios, and good partition keys for each:</span></span>
* <span data-ttu-id="7d7fc-203">Om du implementerar en serverdel för användarens profil, är ett bra alternativ för partitionsnyckel med hello användar-ID.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-203">If you’re implementing a user profile backend, then hello user ID is a good choice for partition key.</span></span>
* <span data-ttu-id="7d7fc-204">Om du lagrar IoT data till exempel enhetens tillstånd, är enhets-ID ett bra alternativ för partitionsnyckel.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-204">If you’re storing IoT data for example, device state, a device ID is a good choice for partition key.</span></span>
* <span data-ttu-id="7d7fc-205">Om du använder Azure Cosmos DB för loggning av time series-data, hello värdnamn eller process-ID är ett bra alternativ för partitionsnyckel.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-205">If you’re using Azure Cosmos DB for logging time-series data, then hello hostname or process ID is a good choice for partition key.</span></span>
* <span data-ttu-id="7d7fc-206">Om du har en arkitektur med flera innehavare är hello klient-ID ett bra alternativ för partitionsnyckel.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-206">If you have a multi-tenant architecture, hello tenant ID is a good choice for partition key.</span></span>

<span data-ttu-id="7d7fc-207">I vissa användningsfall som IoT och användarprofiler, hello partitionsnyckel kan vara hello samma som ditt id (Dokumentnyckel).</span><span class="sxs-lookup"><span data-stu-id="7d7fc-207">In some use cases like IoT and user profiles, hello partition key might be hello same as your id (document key).</span></span> <span data-ttu-id="7d7fc-208">Du kan ha en partitionsnyckel än hello-id i andra som hello tid series-data.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-208">In others like hello time series data, you might have a partition key that’s different than hello id.</span></span>

### <a name="partitioning-and-loggingtime-series-data"></a><span data-ttu-id="7d7fc-209">Partitionering och loggning-tidsserier data</span><span class="sxs-lookup"><span data-stu-id="7d7fc-209">Partitioning and logging/time-series data</span></span>
<span data-ttu-id="7d7fc-210">En av hello vanliga användningsområden för Cosmos DB är för loggning och telemetri.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-210">One of hello common use cases of Cosmos DB is for logging and telemetry.</span></span> <span data-ttu-id="7d7fc-211">Det är viktigt toopick en bra partitionsnyckel eftersom du kan behöva tooread/skrivning stora mängder data.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-211">It is important toopick a good partition key since you might need tooread/write vast volumes of data.</span></span> <span data-ttu-id="7d7fc-212">hello beror på din läsning och skrivning priser och typer av frågor som du förväntar dig toorun.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-212">hello choice depends on your read and write rates and kinds of queries you expect toorun.</span></span> <span data-ttu-id="7d7fc-213">Här följer några tips på hur toochoose en bra partitionsnyckel.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-213">Here are some tips on how toochoose a good partition key.</span></span>

* <span data-ttu-id="7d7fc-214">Om din användningsfall omfattar en liten andel skriver kan sparas under en längre tid och måste tooquery av intervall med tidsstämplar och filter, och sedan använda en sammanslagning av hello timestamp, till exempel datum som en partitionsnyckel är en bra metod.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-214">If your use case involves a small rate of writes accumulating over a long period of time, and need tooquery by ranges of timestamps and other filters, then using a rollup of hello timestamp, for example,  date as a partition key is a good approach.</span></span> <span data-ttu-id="7d7fc-215">Detta ger dig tooquery över alla hello-data för ett datum från en enda partition.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-215">This allows you tooquery over all hello data for a date from a single partition.</span></span> 
* <span data-ttu-id="7d7fc-216">Om din arbetsbelastning skrivs frekventa som är vanligare, bör du använda en partitionsnyckel som inte baseras på tidsstämpel så att Cosmos DB kan distribuera skrivningar jämnt mellan olika partitioner.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-216">If your workload is written heavy, which is more common, you should use a partition key that’s not based on timestamp so that Cosmos DB can distribute writes evenly across various partitions.</span></span> <span data-ttu-id="7d7fc-217">Här är ett värdnamn, process-ID, aktivitets-ID eller en annan egenskap med hög kardinalitet ett bra alternativ.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-217">Here a hostname, process ID, activity ID, or another property with high cardinality is a good choice.</span></span> 
* <span data-ttu-id="7d7fc-218">Ett tredje sätt är en hybrid en om du har flera behållare, ett för varje dag/månad och hello Partitionsnyckeln är en detaljerad egenskap som värdnamn.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-218">A third approach is a hybrid one where you have multiple containers, one for each day/month and hello partition key is a granular property like hostname.</span></span> <span data-ttu-id="7d7fc-219">Hello förmånen som du kan ange olika genomströmning baserat på hello tidsfönstret har, till exempel hello behållare för hello aktuella månaden har etablerats med högre genomströmning eftersom det används läsningar och skrivningar, medan tidigare månader med lägre genomströmning eftersom de fungerar endast läsningar.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-219">This has hello benefit that you can set different throughput based on hello time window, for example, hello container for hello current month is provisioned with higher throughput since it serves reads and writes, whereas previous months with lower throughput since they only serve reads.</span></span>

### <a name="partitioning-and-multi-tenancy"></a><span data-ttu-id="7d7fc-220">Partitionering och flera innehavare</span><span class="sxs-lookup"><span data-stu-id="7d7fc-220">Partitioning and multi-tenancy</span></span>
<span data-ttu-id="7d7fc-221">Om du implementerar ett program för flera innehavare med Cosmos DB, finns det två populära mönster – en partitionsnyckel per klient och en behållare per klient.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-221">If you are implementing a multi-tenant application using Cosmos DB, there are two popular patterns – one partition key per tenant, and one container per tenant.</span></span> <span data-ttu-id="7d7fc-222">Här följer hello- och nackdelar för varje:</span><span class="sxs-lookup"><span data-stu-id="7d7fc-222">Here are hello pros and cons for each:</span></span>

* <span data-ttu-id="7d7fc-223">En partitionsnyckel per klient: I den här modellen klienter som är samordnad inom en enskild behållare.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-223">One Partition Key per tenant: In this model, tenants are collocated within a single container.</span></span> <span data-ttu-id="7d7fc-224">Men frågor och infogningar för objekt inom en enskild klient kan utföras mot en enskild partition.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-224">But queries and inserts for items within a single tenant can be performed against a single partition.</span></span> <span data-ttu-id="7d7fc-225">Du kan också implementera transaktionella logik i alla artiklar i en klient.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-225">You can also implement transactional logic across all items within a tenant.</span></span> <span data-ttu-id="7d7fc-226">Eftersom flera innehavare delar en behållare kan spara du kostnader för lagring och genomströmning genom poolning resurser för klienter i en enskild behållare i stället för att etablera extra utrymme för varje klient.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-226">Since multiple tenants share a container, you can save storage and throughput costs by pooling resources for tenants within a single container rather than provisioning extra headroom for each tenant.</span></span> <span data-ttu-id="7d7fc-227">hello Nackdelen är att du inte har isolering av prestandan per klient.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-227">hello drawback is that you do not have performance isolation per tenant.</span></span> <span data-ttu-id="7d7fc-228">Ökar prestanda/dataflöde gäller toohello hela behållaren vs riktade ökar för klienter.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-228">Performance/throughput increases apply toohello entire container vs targeted increases for tenants.</span></span>
* <span data-ttu-id="7d7fc-229">En behållare per klient: varje innehavare har sin egen behållare.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-229">One Container per tenant: Each tenant has its own container.</span></span> <span data-ttu-id="7d7fc-230">Du kan reservera prestanda per klient i den här modellen.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-230">In this model, you can reserve performance per tenant.</span></span> <span data-ttu-id="7d7fc-231">Den här modellen är mer kostnadseffektivt för program med flera klienter med några innehavare med Cosmos DB ny allokering prismodell.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-231">With Cosmos DB's new provisioning pricing model, this model is more cost-effective for multi-tenant applications with a few tenants.</span></span>

<span data-ttu-id="7d7fc-232">Du kan också använda en kombination/nivåer metod som collocates små klienter och migrerar större hyresgäster tootheir egen behållare.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-232">You can also use a combination/tiered approach that collocates small tenants and migrates larger tenants tootheir own container.</span></span>

## <a name="next-steps"></a><span data-ttu-id="7d7fc-233">Nästa steg</span><span class="sxs-lookup"><span data-stu-id="7d7fc-233">Next steps</span></span>
<span data-ttu-id="7d7fc-234">Vi tillhandahöll en översikt för en översikt över begrepp och bästa praxis för partitionering med Azure Cosmos DB API: er i den här artikeln.</span><span class="sxs-lookup"><span data-stu-id="7d7fc-234">In this article, we provided an overview for an overview of concepts and best practices for partitioning with any Azure Cosmos DB API.</span></span> 

* <span data-ttu-id="7d7fc-235">Lär dig mer om [etablerat dataflöde i Azure Cosmos DB](request-units.md)</span><span class="sxs-lookup"><span data-stu-id="7d7fc-235">Learn about [provisioned throughput in Azure Cosmos DB](request-units.md)</span></span>
* <span data-ttu-id="7d7fc-236">Lär dig mer om [global distributionsplatsen i Azure Cosmos DB](distribute-data-globally.md)</span><span class="sxs-lookup"><span data-stu-id="7d7fc-236">Learn about [global distribution in Azure Cosmos DB](distribute-data-globally.md)</span></span>



