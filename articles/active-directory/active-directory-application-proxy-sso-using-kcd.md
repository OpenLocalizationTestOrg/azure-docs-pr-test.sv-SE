---
title: aaaSingle-inloggning med Application Proxy | Microsoft Docs
description: Beskriver hur tooprovide enkel inloggning med Azure AD Application Proxy.
services: active-directory
documentationcenter: 
author: kgremban
manager: femila
ms.assetid: ded0d9c9-45f6-47d7-bd0f-3f7fd99ab621
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/25/2017
ms.author: kgremban
ms.reviewer: harshja
ms.custom: H1Hack27Feb2017, it-pro
ms.openlocfilehash: 0047e834cd42e057a75ebc0c5dcf860734464a05
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 10/06/2017
---
# <a name="kerberos-constrained-delegation-for-single-sign-on-tooyour-apps-with-application-proxy"></a><span data-ttu-id="81259-103">Kerberos-begränsad delegering för enkel inloggning tooyour appar med Application Proxy</span><span class="sxs-lookup"><span data-stu-id="81259-103">Kerberos Constrained Delegation for single sign-on tooyour apps with Application Proxy</span></span>

<span data-ttu-id="81259-104">Du kan tillhandahålla enkel inloggning för lokalt program som publicerats via programproxy som skyddas med integrerad Windows-autentisering.</span><span class="sxs-lookup"><span data-stu-id="81259-104">You can provide single sign-on for on-premises applications published through Application Proxy that are secured with Integrated Windows Authentication.</span></span> <span data-ttu-id="81259-105">Dessa program kräver en Kerberos-biljett för åtkomst till.</span><span class="sxs-lookup"><span data-stu-id="81259-105">These applications require a Kerberos ticket for access.</span></span> <span data-ttu-id="81259-106">Programproxy använder Kerberos-begränsad delegering (KCD) toosupport dessa program.</span><span class="sxs-lookup"><span data-stu-id="81259-106">Application Proxy uses Kerberos Constrained Delegation (KCD) toosupport these applications.</span></span> 

<span data-ttu-id="81259-107">Du kan aktivera enkel inloggning tooyour program med integrerad autentisering IWA (Windows) genom att ge Application Proxy kopplingar behörigheter i Active Directory tooimpersonate användare.</span><span class="sxs-lookup"><span data-stu-id="81259-107">You can enable single sign-on tooyour applications using Integrated Windows Authentication (IWA) by giving Application Proxy connectors permission in Active Directory tooimpersonate users.</span></span> <span data-ttu-id="81259-108">hello kopplingar som använder den här behörigheten toosend och ta emot token åt.</span><span class="sxs-lookup"><span data-stu-id="81259-108">hello connectors use this permission toosend and receive tokens on their behalf.</span></span>

## <a name="how-single-sign-on-with-kcd-works"></a><span data-ttu-id="81259-109">Hur enkel inloggning med KCD fungerar</span><span class="sxs-lookup"><span data-stu-id="81259-109">How single sign-on with KCD works</span></span>
<span data-ttu-id="81259-110">Det här diagrammet beskrivs hello flödet när en användare försöker tooaccess ett lokalt program som använder IWA.</span><span class="sxs-lookup"><span data-stu-id="81259-110">This diagram explains hello flow when a user attempts tooaccess an on-prem application that uses IWA.</span></span>

![Flödesdiagram för Microsoft AAD-autentisering](./media/active-directory-application-proxy-sso-using-kcd/AuthDiagram.png)

1. <span data-ttu-id="81259-112">hello användaren anger hello URL tooaccess hello lokala program via Webbprogramproxy.</span><span class="sxs-lookup"><span data-stu-id="81259-112">hello user enters hello URL tooaccess hello on-prem application through Application Proxy.</span></span>
2. <span data-ttu-id="81259-113">Application Proxy dirigerar hello begäran tooAzure AD authentication services toopreauthenticate.</span><span class="sxs-lookup"><span data-stu-id="81259-113">Application Proxy redirects hello request tooAzure AD authentication services toopreauthenticate.</span></span> <span data-ttu-id="81259-114">Nu är gäller Azure AD alla tillämpliga autentiserings- och auktoriseringsprinciper, till exempel flerfunktionsautentisering.</span><span class="sxs-lookup"><span data-stu-id="81259-114">At this point, Azure AD applies any applicable authentication and authorization policies, such as multifactor authentication.</span></span> <span data-ttu-id="81259-115">Om hello användaren har verifierats Azure AD skapar en token och skickar den toohello användaren.</span><span class="sxs-lookup"><span data-stu-id="81259-115">If hello user is validated, Azure AD creates a token and sends it toohello user.</span></span>
3. <span data-ttu-id="81259-116">hello användaren skickar hello token tooApplication Proxy.</span><span class="sxs-lookup"><span data-stu-id="81259-116">hello user passes hello token tooApplication Proxy.</span></span>
4. <span data-ttu-id="81259-117">Programproxy validerar hello token hämtar hello UPN (User Principal Name) från den och sedan skickar hello begäran hello UPN och hello namn SPN (Service Principal) toohello anslutningen via en säker kanal dually autentiserad.</span><span class="sxs-lookup"><span data-stu-id="81259-117">Application Proxy validates hello token and retrieves hello User Principal Name (UPN) from it, and then sends hello request, hello UPN, and hello Service Principal Name (SPN) toohello Connector through a dually authenticated secure channel.</span></span>
5. <span data-ttu-id="81259-118">hello Connector utför Kerberos-begränsad delegering (KCD)-förhandling med hello lokal AD, personifiering hello användaren tooget ett token toohello Kerberos-program.</span><span class="sxs-lookup"><span data-stu-id="81259-118">hello Connector performs Kerberos Constrained Delegation (KCD) negotiation with hello on-prem AD, impersonating hello user tooget a Kerberos token toohello application.</span></span>
6. <span data-ttu-id="81259-119">Active Directory skickar hello Kerberos-token för hello programmet toohello koppling.</span><span class="sxs-lookup"><span data-stu-id="81259-119">Active Directory sends hello Kerberos token for hello application toohello Connector.</span></span>
7. <span data-ttu-id="81259-120">hello Connector skickar hello ursprungliga begäran toohello programserver med hjälp av hello Kerberos-token togs emot från AD.</span><span class="sxs-lookup"><span data-stu-id="81259-120">hello Connector sends hello original request toohello application server, using hello Kerberos token it received from AD.</span></span>
8. <span data-ttu-id="81259-121">hello skickar hello svar toohello Connector, som då returneras toohello Application Proxy-tjänsten och slutligen toohello användare.</span><span class="sxs-lookup"><span data-stu-id="81259-121">hello application sends hello response toohello Connector, which is then returned toohello Application Proxy service and finally toohello user.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="81259-122">Krav</span><span class="sxs-lookup"><span data-stu-id="81259-122">Prerequisites</span></span>
<span data-ttu-id="81259-123">Innan du börjar med enkel inloggning för IWA program, kontrollera att din miljö är redo med hello följande inställningar och konfigurationer:</span><span class="sxs-lookup"><span data-stu-id="81259-123">Before you get started with single sign-on for IWA applications, make sure your environment is ready with hello following settings and configurations:</span></span>

* <span data-ttu-id="81259-124">Dina appar, t.ex SharePoint Web apps ställs toouse integrerad Windows-autentisering.</span><span class="sxs-lookup"><span data-stu-id="81259-124">Your apps, like SharePoint Web apps, are set toouse Integrated Windows Authentication.</span></span> <span data-ttu-id="81259-125">Mer information finns i [aktivera stöd för Kerberos-autentisering](https://technet.microsoft.com/library/dd759186.aspx), eller för SharePoint finns [planera för Kerberos-autentisering i SharePoint 2013](https://technet.microsoft.com/library/ee806870.aspx).</span><span class="sxs-lookup"><span data-stu-id="81259-125">For more information, see [Enable Support for Kerberos Authentication](https://technet.microsoft.com/library/dd759186.aspx), or for SharePoint see [Plan for Kerberos authentication in SharePoint 2013](https://technet.microsoft.com/library/ee806870.aspx).</span></span>
* <span data-ttu-id="81259-126">Alla dina appar har [Service Principal Names](https://social.technet.microsoft.com/wiki/contents/articles/717.service-principal-names-spns-setspn-syntax-setspn-exe.aspx).</span><span class="sxs-lookup"><span data-stu-id="81259-126">All your apps have [Service Principal Names](https://social.technet.microsoft.com/wiki/contents/articles/717.service-principal-names-spns-setspn-syntax-setspn-exe.aspx).</span></span>
* <span data-ttu-id="81259-127">hello server körs hello koppling och hello-server som kör hello app är ansluten till en domän och en del av hello samma domän eller betrodda domäner.</span><span class="sxs-lookup"><span data-stu-id="81259-127">hello server running hello Connector and hello server running hello app are domain joined and part of hello same domain or trusting domains.</span></span> <span data-ttu-id="81259-128">Mer information om domänanslutning finns [ansluta en dator tooa domän](https://technet.microsoft.com/library/dd807102.aspx).</span><span class="sxs-lookup"><span data-stu-id="81259-128">For more information on domain join, see [Join a Computer tooa Domain](https://technet.microsoft.com/library/dd807102.aspx).</span></span>
* <span data-ttu-id="81259-129">hello-server som kör hello Connector har åtkomst tooread hello TokenGroupsGlobalAndUniversal attribut för användare.</span><span class="sxs-lookup"><span data-stu-id="81259-129">hello server running hello Connector has access tooread hello TokenGroupsGlobalAndUniversal attribute for users.</span></span> <span data-ttu-id="81259-130">Den här standardinställningen kanske har påverkats av säkerhet härdning hello-miljö.</span><span class="sxs-lookup"><span data-stu-id="81259-130">This default setting might have been impacted by security hardening hello environment.</span></span>

### <a name="configure-active-directory"></a><span data-ttu-id="81259-131">Konfigurera Active Directory</span><span class="sxs-lookup"><span data-stu-id="81259-131">Configure Active Directory</span></span>
<span data-ttu-id="81259-132">hello Active Directory-konfigurationen varierar, beroende på om dina Application Proxy connector och hello Programserver är i hello samma domän eller inte.</span><span class="sxs-lookup"><span data-stu-id="81259-132">hello Active Directory configuration varies, depending on whether your Application Proxy connector and hello application server are in hello same domain or not.</span></span>

#### <a name="connector-and-application-server-in-hello-same-domain"></a><span data-ttu-id="81259-133">Koppling och programserver i hello samma domän</span><span class="sxs-lookup"><span data-stu-id="81259-133">Connector and application server in hello same domain</span></span>
1. <span data-ttu-id="81259-134">I Active Directory, gå för**verktyg** > **användare och datorer**.</span><span class="sxs-lookup"><span data-stu-id="81259-134">In Active Directory, go too**Tools** > **Users and Computers**.</span></span>
2. <span data-ttu-id="81259-135">Välj hello-server som kör hello-anslutningen.</span><span class="sxs-lookup"><span data-stu-id="81259-135">Select hello server running hello connector.</span></span>
3. <span data-ttu-id="81259-136">Högerklicka och välj **egenskaper** > **delegering**.</span><span class="sxs-lookup"><span data-stu-id="81259-136">Right-click and select **Properties** > **Delegation**.</span></span>
4. <span data-ttu-id="81259-137">Välj **förtroende för den här datorn för delegering toospecified services**.</span><span class="sxs-lookup"><span data-stu-id="81259-137">Select **Trust this computer for delegation toospecified services only**.</span></span> 
5. <span data-ttu-id="81259-138">Under **Services toowhich det här kontot kan ge delegerade autentiseringsuppgifter** Lägg till hello värde för hello SPN-identitet hello-programserver.</span><span class="sxs-lookup"><span data-stu-id="81259-138">Under **Services toowhich this account can present delegated credentials** add hello value for hello SPN identity of hello application server.</span></span> <span data-ttu-id="81259-139">Detta gör hello Application Proxy Connector tooimpersonate användare i AD mot hello-program som anges i hello-listan.</span><span class="sxs-lookup"><span data-stu-id="81259-139">This enables hello Application Proxy Connector tooimpersonate users in AD against hello applications defined in hello list.</span></span>

   ![Skärmbild av Connector SVR egenskaper](./media/active-directory-application-proxy-sso-using-kcd/Properties.jpg)

#### <a name="connector-and-application-server-in-different-domains"></a><span data-ttu-id="81259-141">Koppling och programservrar i olika domäner</span><span class="sxs-lookup"><span data-stu-id="81259-141">Connector and application server in different domains</span></span>
1. <span data-ttu-id="81259-142">En lista över förutsättningar för att arbeta med KCD över domäner finns [Kerberos-begränsad delegering över domäner](https://technet.microsoft.com/library/hh831477.aspx).</span><span class="sxs-lookup"><span data-stu-id="81259-142">For a list of prerequisites for working with KCD across domains, see [Kerberos Constrained Delegation across domains](https://technet.microsoft.com/library/hh831477.aspx).</span></span>
2. <span data-ttu-id="81259-143">Använd hello `principalsallowedtodelegateto` egenskapen hello Connector server tooenable hello Application Proxy toodelegate för hello-anslutningsservern.</span><span class="sxs-lookup"><span data-stu-id="81259-143">Use hello `principalsallowedtodelegateto` property on hello Connector server tooenable hello Application Proxy toodelegate for hello Connector server.</span></span> <span data-ttu-id="81259-144">hello programservern `sharepointserviceaccount` och hello delegera server är `connectormachineaccount`.</span><span class="sxs-lookup"><span data-stu-id="81259-144">hello application server is `sharepointserviceaccount` and hello delegating server is `connectormachineaccount`.</span></span> <span data-ttu-id="81259-145">Använd den här koden som ett exempel för Windows 2012 R2:</span><span class="sxs-lookup"><span data-stu-id="81259-145">For Windows 2012 R2, use this code as an example:</span></span>

        $connector= Get-ADComputer -Identity connectormachineaccount -server dc.connectordomain.com

        Set-ADComputer -Identity sharepointserviceaccount -PrincipalsAllowedToDelegateToAccount $connector

        Get-ADComputer sharepointserviceaccount -Properties PrincipalsAllowedToDelegateToAccount

<span data-ttu-id="81259-146">Sharepointserviceaccount kan vara hello Service Pack datorkontot eller ett tjänstkonto som programpoolen körs under vilka hello Service Pack.</span><span class="sxs-lookup"><span data-stu-id="81259-146">Sharepointserviceaccount can be hello SPS machine account or a service account under which hello SPS app pool is running.</span></span>

## <a name="configure-single-sign-on"></a><span data-ttu-id="81259-147">Konfigurera enkel inloggning</span><span class="sxs-lookup"><span data-stu-id="81259-147">Configure single sign-on</span></span> 
1. <span data-ttu-id="81259-148">Publicera programmet enligt instruktionerna i toohello [publicera program med programproxy](application-proxy-publish-azure-portal.md).</span><span class="sxs-lookup"><span data-stu-id="81259-148">Publish your application according toohello instructions described in [Publish applications with Application Proxy](application-proxy-publish-azure-portal.md).</span></span> <span data-ttu-id="81259-149">Se till att tooselect **Azure Active Directory** som hello **förautentisering metoden**.</span><span class="sxs-lookup"><span data-stu-id="81259-149">Make sure tooselect **Azure Active Directory** as hello **Preauthentication Method**.</span></span>
2. <span data-ttu-id="81259-150">När programmet visas i hello lista över företagsprogram, markerar du den och klickar på **enkel inloggning**.</span><span class="sxs-lookup"><span data-stu-id="81259-150">After your application appears in hello list of enterprise applications, select it and click **Single sign-on**.</span></span>
3. <span data-ttu-id="81259-151">Ställ in hello enkel inloggning för**integrerad Windows-autentisering**.</span><span class="sxs-lookup"><span data-stu-id="81259-151">Set hello single sign-on mode too**Integrated Windows Authentication**.</span></span>  
4. <span data-ttu-id="81259-152">Ange hello **interna program SPN** hello-programserver.</span><span class="sxs-lookup"><span data-stu-id="81259-152">Enter hello **Internal Application SPN** of hello application server.</span></span> <span data-ttu-id="81259-153">I det här exemplet är hello SPN för vårt publicerade program http/www.contoso.com. Den här SPN måste toobe i hello lista över tjänster toowhich hello connector kan ge delegerade autentiseringsuppgifter.</span><span class="sxs-lookup"><span data-stu-id="81259-153">In this example, hello SPN for our published application is http/www.contoso.com. This SPN needs toobe in hello list of services toowhich hello connector can present delegated credentials.</span></span> 
5. <span data-ttu-id="81259-154">Välj hello **delegerad inloggningen identitet** för hello connector toouse åt dina användare.</span><span class="sxs-lookup"><span data-stu-id="81259-154">Choose hello **Delegated Login Identity** for hello connector toouse on behalf of your users.</span></span> <span data-ttu-id="81259-155">Mer information finns i [arbeta med olika lokala och molnidentiteter](#Working-with-different-on-premises-and-cloud-identities)</span><span class="sxs-lookup"><span data-stu-id="81259-155">For more information, see [Working with different on-premises and cloud identities](#Working-with-different-on-premises-and-cloud-identities)</span></span>

   ![Avancerad konfiguration](./media/active-directory-application-proxy-sso-using-kcd/cwap_auth2.png)  


## <a name="sso-for-non-windows-apps"></a><span data-ttu-id="81259-157">Enkel inloggning för Windows-appar</span><span class="sxs-lookup"><span data-stu-id="81259-157">SSO for non-Windows apps</span></span>
<span data-ttu-id="81259-158">hello flödet av Kerberos-delegering i Azure AD Application Proxy startar när Azure AD autentiserar hello användaren i hello molnet.</span><span class="sxs-lookup"><span data-stu-id="81259-158">hello Kerberos delegation flow in Azure AD Application Proxy starts when Azure AD authenticates hello user in hello cloud.</span></span> <span data-ttu-id="81259-159">När hello begäran kommer lokalt, hello hello Azure AD Application Proxy-anslutningen utfärdar en Kerberos-biljett hello användarens räkning genom att interagera med lokala Active Directory.</span><span class="sxs-lookup"><span data-stu-id="81259-159">Once hello request arrives on-premises, hello Azure AD Application Proxy connector issues a Kerberos ticket on behalf of hello user by interacting with hello local Active Directory.</span></span> <span data-ttu-id="81259-160">Den här processen är refererad tooas Kerberos-begränsad delegering (KCD).</span><span class="sxs-lookup"><span data-stu-id="81259-160">This process is referred tooas Kerberos Constrained Delegation (KCD).</span></span> <span data-ttu-id="81259-161">I hello skickas nästa fas en begäran toohello backend-programmet med Kerberos-biljett.</span><span class="sxs-lookup"><span data-stu-id="81259-161">In hello next phase, a request is sent toohello backend application with this Kerberos ticket.</span></span> <span data-ttu-id="81259-162">Det finns flera protokoll som definierar hur toosend sådana begäranden.</span><span class="sxs-lookup"><span data-stu-id="81259-162">There are several protocols that define how toosend such requests.</span></span> <span data-ttu-id="81259-163">De flesta Windows-servrar förväntas Negotiate/SPNego som stöds nu på Azure AD Application Proxy.</span><span class="sxs-lookup"><span data-stu-id="81259-163">Most non-Windows servers expect Negotiate/SPNego that is now supported on Azure AD Application Proxy.</span></span>

<span data-ttu-id="81259-164">Mer information om Kerberos finns [alla önskade tooknow om Kerberos-begränsad delegering (KCD)](https://blogs.technet.microsoft.com/applicationproxyblog/2015/09/21/all-you-want-to-know-about-kerberos-constrained-delegation-kcd).</span><span class="sxs-lookup"><span data-stu-id="81259-164">For more information about Kerberos, see [All you want tooknow about Kerberos Constrained Delegation (KCD)](https://blogs.technet.microsoft.com/applicationproxyblog/2015/09/21/all-you-want-to-know-about-kerberos-constrained-delegation-kcd).</span></span>

<span data-ttu-id="81259-165">Appar för icke-Windows vanligtvis användaren användarnamn eller SAM-namnen i stället för domänen e-postadresser.</span><span class="sxs-lookup"><span data-stu-id="81259-165">Non-Windows apps typically user usernames or SAM account names instead of domain email addresses.</span></span> <span data-ttu-id="81259-166">Om det inträffar tooyour program måste tooconfigure hello delegerad inloggningen identitet fältet tooconnect moln identiteter tooyour programmet identiteter.</span><span class="sxs-lookup"><span data-stu-id="81259-166">If that situation applies tooyour applications, you need tooconfigure hello delegated login identity field tooconnect your cloud identities tooyour application identities.</span></span> 

## <a name="working-with-different-on-premises-and-cloud-identities"></a><span data-ttu-id="81259-167">Arbeta med olika lokala och molnidentiteter</span><span class="sxs-lookup"><span data-stu-id="81259-167">Working with different on-premises and cloud identities</span></span>
<span data-ttu-id="81259-168">Programproxy förutsätter att användarna har exakt hello samma identitet i hello molnet och lokalt.</span><span class="sxs-lookup"><span data-stu-id="81259-168">Application Proxy assumes that users have exactly hello same identity in hello cloud and on-premises.</span></span> <span data-ttu-id="81259-169">Om detta inte är fallet hello kan du kan fortfarande använda KCD för enkel inloggning.</span><span class="sxs-lookup"><span data-stu-id="81259-169">If that's not hello case, you can can still use KCD for single sign-on.</span></span> <span data-ttu-id="81259-170">Konfigurera en **delegerade identitet för nätverksinloggning** för varje program toospecify vilken identitet som ska användas när du utför enkel inloggning.</span><span class="sxs-lookup"><span data-stu-id="81259-170">Configure a **Delegated login identity** for each application toospecify which identity should be used when performing single sign-on.</span></span>  

<span data-ttu-id="81259-171">Den här funktionen gör att många organisationer som har en annan lokal och molnet identiteter toohave SSO från hello tooon lokala molnappar utan hello användare tooenter olika användarnamn och lösenord.</span><span class="sxs-lookup"><span data-stu-id="81259-171">This capability allows many organizations that have different on-premises and cloud identities toohave SSO from hello cloud tooon-premises apps without requiring hello users tooenter different usernames and passwords.</span></span> <span data-ttu-id="81259-172">Detta inkluderar organisationer som:</span><span class="sxs-lookup"><span data-stu-id="81259-172">This includes organizations that:</span></span>

* <span data-ttu-id="81259-173">Har flera domäner internt (joe@us.contoso.com, joe@eu.contoso.com) och en enda domän i hello molnet (joe@contoso.com).</span><span class="sxs-lookup"><span data-stu-id="81259-173">Have multiple domains internally (joe@us.contoso.com, joe@eu.contoso.com) and a single domain in hello cloud (joe@contoso.com).</span></span>
* <span data-ttu-id="81259-174">Ha icke-dirigerbara domännamn internt (joe@contoso.usa) och en juridiska i hello molnet.</span><span class="sxs-lookup"><span data-stu-id="81259-174">Have non-routable domain name internally (joe@contoso.usa) and a legal one in hello cloud.</span></span>
* <span data-ttu-id="81259-175">Använd inte domännamn internt (Johan)</span><span class="sxs-lookup"><span data-stu-id="81259-175">Do not use domain names internally (joe)</span></span>
* <span data-ttu-id="81259-176">Använd olika alias på lokalt och i hello molnet.</span><span class="sxs-lookup"><span data-stu-id="81259-176">Use different aliases on-prem and in hello cloud.</span></span> <span data-ttu-id="81259-177">Till exempel joe-johns@contoso.com vs.joej@contoso.com</span><span class="sxs-lookup"><span data-stu-id="81259-177">For example, joe-johns@contoso.com vs. joej@contoso.com</span></span>  

<span data-ttu-id="81259-178">Du kan välja vilka identitet toouse tooobtain hello Kerberos-biljetten med Application Proxy.</span><span class="sxs-lookup"><span data-stu-id="81259-178">With Application Proxy, you can select which identity toouse tooobtain hello Kerberos ticket.</span></span> <span data-ttu-id="81259-179">Den här inställningen är per program.</span><span class="sxs-lookup"><span data-stu-id="81259-179">This setting is per application.</span></span> <span data-ttu-id="81259-180">Vissa av dessa alternativ är lämpliga för system som inte accepterar e-postadressformat, andra har utformats för alternativa inloggningen.</span><span class="sxs-lookup"><span data-stu-id="81259-180">Some of these options are suitable for systems that do not accept email address format, others are designed for alternative login.</span></span>

![Delegerad inloggningen identitet parametern skärmbild](./media/active-directory-application-proxy-sso-using-kcd/app_proxy_sso_diff_id_upn.png)

<span data-ttu-id="81259-182">Om delegerade inloggningen identitet används kanske hello värde inte unika mellan alla hello domäner och skogar i organisationen.</span><span class="sxs-lookup"><span data-stu-id="81259-182">If delegated login identity is used, hello value might not be unique across all hello domains or forests in your organization.</span></span> <span data-ttu-id="81259-183">Du kan undvika det här problemet genom att publicera programmen två gånger med två olika Connector-grupper.</span><span class="sxs-lookup"><span data-stu-id="81259-183">You can avoid this issue by publishing these applications twice using two different Connector groups.</span></span> <span data-ttu-id="81259-184">Eftersom varje program har en annan målgrupp, kan du ansluta till dess kopplingar tooa annan domän.</span><span class="sxs-lookup"><span data-stu-id="81259-184">Since each application has a different user audience, you can join its Connectors tooa different domain.</span></span>

### <a name="configure-sso-for-different-identities"></a><span data-ttu-id="81259-185">Konfigurera enkel inloggning för olika identiteter</span><span class="sxs-lookup"><span data-stu-id="81259-185">Configure SSO for different identities</span></span>
1. <span data-ttu-id="81259-186">Konfigurera inställningar för Azure AD Connect så hello huvudsakliga identitet är hello e-postadress (e-post).</span><span class="sxs-lookup"><span data-stu-id="81259-186">Configure Azure AD Connect settings so hello main identity is hello email address (mail).</span></span> <span data-ttu-id="81259-187">Detta görs som en del av hello anpassa processen genom att ändra hello **användarens huvudnamn** i hello synkroniseringsinställningar.</span><span class="sxs-lookup"><span data-stu-id="81259-187">This is done as part of hello customize process, by changing hello **User Principal Name** field in hello sync settings.</span></span> <span data-ttu-id="81259-188">De här inställningarna avgör också hur användare loggar in tooOffice365, Windows10 enheter och andra program som använder Azure AD som deras identitet store.</span><span class="sxs-lookup"><span data-stu-id="81259-188">These settings also determine how users log in tooOffice365, Windows10 devices, and other applications that use Azure AD as their identity store.</span></span>  
   <span data-ttu-id="81259-189">![Identifiera användare skärmbild - UPN-namnet listrutan](./media/active-directory-application-proxy-sso-using-kcd/app_proxy_sso_diff_id_connect_settings.png)</span><span class="sxs-lookup"><span data-stu-id="81259-189">![Identifying users screenshot - User Principal Name dropdown](./media/active-directory-application-proxy-sso-using-kcd/app_proxy_sso_diff_id_connect_settings.png)</span></span>  
2. <span data-ttu-id="81259-190">Hello programkonfigurationen inställningarna för hello programmet vill toomodify, Välj hello **delegerad inloggningen identitet** toobe används:</span><span class="sxs-lookup"><span data-stu-id="81259-190">In hello Application Configuration settings for hello application you would like toomodify, select hello **Delegated Login Identity** toobe used:</span></span>

   * <span data-ttu-id="81259-191">Användarens huvudnamn (till exempel joe@contoso.com)</span><span class="sxs-lookup"><span data-stu-id="81259-191">User Principal Name (for example, joe@contoso.com)</span></span>
   * <span data-ttu-id="81259-192">Alternativa UPN-namnet (till exempel joed@contoso.local)</span><span class="sxs-lookup"><span data-stu-id="81259-192">Alternate User Principal Name (for example, joed@contoso.local)</span></span>
   * <span data-ttu-id="81259-193">Användarnamnet som en del av användarens huvudnamn (till exempel Johan)</span><span class="sxs-lookup"><span data-stu-id="81259-193">Username part of User Principal Name (for example, joe)</span></span>
   * <span data-ttu-id="81259-194">Användarnamnet som en del av alternativt UPN-namn (till exempel joed)</span><span class="sxs-lookup"><span data-stu-id="81259-194">Username part of Alternate User Principal Name (for example, joed)</span></span>
   * <span data-ttu-id="81259-195">Lokala SAM-kontonamn (beroende på konfigurationen av domänkontrollanten hello)</span><span class="sxs-lookup"><span data-stu-id="81259-195">On-premises SAM account name (depends on hello domain controller configuration)</span></span>

### <a name="troubleshooting-sso-for-different-identities"></a><span data-ttu-id="81259-196">Felsökning av enkel inloggning för olika identiteter</span><span class="sxs-lookup"><span data-stu-id="81259-196">Troubleshooting SSO for different identities</span></span>
<span data-ttu-id="81259-197">Om det finns ett fel i hello SSO-processen, visas den i hello connector datorn händelseloggen som beskrivs i [felsökning](application-proxy-back-end-kerberos-constrained-delegation-how-to.md).</span><span class="sxs-lookup"><span data-stu-id="81259-197">If there is an error in hello SSO process, it appears in hello connector machine event log as explained in [Troubleshooting](application-proxy-back-end-kerberos-constrained-delegation-how-to.md).</span></span>
<span data-ttu-id="81259-198">Men i vissa fall hello begäran skickas har toohello backend-programmet när det här programmet svarar i olika HTTP-svar.</span><span class="sxs-lookup"><span data-stu-id="81259-198">But, in some cases, hello request is successfully sent toohello backend application while this application replies in various other HTTP responses.</span></span> <span data-ttu-id="81259-199">Felsökning av dessa fall ska starta genom att undersöka händelsenummer 24029 på hello connector dator i händelseloggen för hello Application Proxy-sessionen.</span><span class="sxs-lookup"><span data-stu-id="81259-199">Troubleshooting these cases should start by examining event number 24029 on hello connector machine in hello Application Proxy session event log.</span></span> <span data-ttu-id="81259-200">hello användar-ID som användes för delegering visas i hello ”användare” fältet inom hello händelseinformation.</span><span class="sxs-lookup"><span data-stu-id="81259-200">hello user identity that was used for delegation appears in hello “user” field within hello event details.</span></span> <span data-ttu-id="81259-201">tooturn på sessionsloggen, Välj **visa analytiska loggar och felsökningsloggar** hello event viewer Visa-menyn.</span><span class="sxs-lookup"><span data-stu-id="81259-201">tooturn on session log, select **Show analytic and debug logs** in hello event viewer view menu.</span></span>

## <a name="next-steps"></a><span data-ttu-id="81259-202">Nästa steg</span><span class="sxs-lookup"><span data-stu-id="81259-202">Next steps</span></span>

* [<span data-ttu-id="81259-203">Hur tooconfigure en programproxy programmet toouse Kerberos-begränsad delegering</span><span class="sxs-lookup"><span data-stu-id="81259-203">How tooconfigure an Application Proxy application toouse Kerberos Constrained Delegation</span></span>](application-proxy-back-end-kerberos-constrained-delegation-how-to.md)
* [<span data-ttu-id="81259-204">Felsökning av problem med Application Proxy</span><span class="sxs-lookup"><span data-stu-id="81259-204">Troubleshoot issues you're having with Application Proxy</span></span>](active-directory-application-proxy-troubleshoot.md)


<span data-ttu-id="81259-205">Hello senaste nyheterna och uppdateringarna finns på hello [bloggen om Application Proxy](http://blogs.technet.com/b/applicationproxyblog/)</span><span class="sxs-lookup"><span data-stu-id="81259-205">For hello latest news and updates, check out hello [Application Proxy blog](http://blogs.technet.com/b/applicationproxyblog/)</span></span>

