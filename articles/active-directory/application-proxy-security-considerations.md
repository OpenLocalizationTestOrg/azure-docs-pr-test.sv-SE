---
title: "aaaSecurity överväganden för Azure AD Application Proxy | Microsoft Docs"
description: "Beskriver säkerhetsaspekter för att använda Azure AD Application Proxy"
services: active-directory
documentationcenter: 
author: kgremban
manager: femila
ms.assetid: 
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 08/03/2017
ms.author: kgremban
ms.reviewer: harshja
ms.custom: it-pro
ms.openlocfilehash: ebd14b9d1fc8f4629c5916e5a910595727d935d5
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 10/06/2017
---
# <a name="security-considerations-for-accessing-apps-remotely-with-azure-ad-application-proxy"></a><span data-ttu-id="495f4-103">Säkerhetsaspekter för att komma åt appar med Azure AD Application Proxy</span><span class="sxs-lookup"><span data-stu-id="495f4-103">Security considerations for accessing apps remotely with Azure AD Application Proxy</span></span>

<span data-ttu-id="495f4-104">Den här artikeln förklarar hur Azure Active Directory Application Proxy ger en säker tjänst för att publicera och åtkomst till dina program via fjärranslutning.</span><span class="sxs-lookup"><span data-stu-id="495f4-104">This article explains how Azure Active Directory Application Proxy provides a secure service for publishing and accessing your applications remotely.</span></span>

<span data-ttu-id="495f4-105">följande diagram visar hur Azure AD hello kan säker fjärråtkomst tooyour lokala program.</span><span class="sxs-lookup"><span data-stu-id="495f4-105">hello following diagram shows how Azure AD enables secure remote access tooyour on-premises applications.</span></span>

 ![Diagram över säker fjärråtkomst via Azure AD Application Proxy](./media/application-proxy-security-considerations/secure-remote-access.png)

## <a name="security-benefits"></a><span data-ttu-id="495f4-107">Säkerhetsfördelarna</span><span class="sxs-lookup"><span data-stu-id="495f4-107">Security benefits</span></span>

<span data-ttu-id="495f4-108">Azure AD Application Proxy ger följande säkerhetsfördelarna hello:</span><span class="sxs-lookup"><span data-stu-id="495f4-108">Azure AD Application Proxy offers hello following security benefits:</span></span>

### <a name="authenticated-access"></a><span data-ttu-id="495f4-109">Autentiserad åtkomst</span><span class="sxs-lookup"><span data-stu-id="495f4-109">Authenticated access</span></span> 

<span data-ttu-id="495f4-110">Om du väljer toouse Azure Active Directory förautentisering kan endast autentiserade anslutningar ansluta till nätverket.</span><span class="sxs-lookup"><span data-stu-id="495f4-110">If you choose toouse Azure Active Directory preauthentication, then only authenticated connections can access your network.</span></span>

<span data-ttu-id="495f4-111">Azure AD Application Proxy är beroende av hello Azure AD säkerhetstokentjänst (STS) för alla autentisering.</span><span class="sxs-lookup"><span data-stu-id="495f4-111">Azure AD Application Proxy relies on hello Azure AD security token service (STS) for all authentication.</span></span>  <span data-ttu-id="495f4-112">Förautentisering, blockeras sin natur som ett stort antal anonyma attacker eftersom endast autentiserade identiteter kan komma åt hello backend-programmet.</span><span class="sxs-lookup"><span data-stu-id="495f4-112">Preauthentication, by its very nature, blocks a significant number of anonymous attacks, because only authenticated identities can access hello back-end application.</span></span>

<span data-ttu-id="495f4-113">Om du väljer genomströmning som metod för förautentisering kan få du inte förmånen.</span><span class="sxs-lookup"><span data-stu-id="495f4-113">If you choose Passthrough as your preauthentication method, you don't get this benefit.</span></span> 

### <a name="conditional-access"></a><span data-ttu-id="495f4-114">Villkorlig åtkomst</span><span class="sxs-lookup"><span data-stu-id="495f4-114">Conditional access</span></span>

<span data-ttu-id="495f4-115">Tillämpa rikare kontrollerna för principer innan anslutningar upprättas tooyour nätverk.</span><span class="sxs-lookup"><span data-stu-id="495f4-115">Apply richer policy controls before connections tooyour network are established.</span></span>

<span data-ttu-id="495f4-116">Med [villkorlig åtkomst](active-directory-conditional-access-azuread-connected-apps.md), kan du definiera begränsningar på vilken trafik som är tillåten tooaccess backend-program.</span><span class="sxs-lookup"><span data-stu-id="495f4-116">With [conditional access](active-directory-conditional-access-azuread-connected-apps.md), you can define restrictions on what traffic is allowed tooaccess your back-end applications.</span></span> <span data-ttu-id="495f4-117">Du kan skapa principer som begränsar inloggningar baserat på plats, stark autentisering och risken för användarprofil.</span><span class="sxs-lookup"><span data-stu-id="495f4-117">You can create policies that restrict sign-ins based on location, strength of authentication, and user risk profile.</span></span>

<span data-ttu-id="495f4-118">Du kan också använda principer för villkorlig åtkomst tooconfigure Multifaktorautentisering, lägga till ett annat lager av säkerhet tooyour användarautentisering.</span><span class="sxs-lookup"><span data-stu-id="495f4-118">You can also use conditional access tooconfigure Multi-Factor Authentication policies, adding another layer of security tooyour user authentications.</span></span> 

### <a name="traffic-termination"></a><span data-ttu-id="495f4-119">Avslutning av trafik</span><span class="sxs-lookup"><span data-stu-id="495f4-119">Traffic termination</span></span>

<span data-ttu-id="495f4-120">All trafik avslutas i hello molnet.</span><span class="sxs-lookup"><span data-stu-id="495f4-120">All traffic is terminated in hello cloud.</span></span>

<span data-ttu-id="495f4-121">Eftersom Azure AD Application Proxy är en omvänd proxy, avbryts alla trafik tooback slutpunkt program vid hello-tjänsten.</span><span class="sxs-lookup"><span data-stu-id="495f4-121">Because Azure AD Application Proxy is a reverse-proxy, all traffic tooback-end applications is terminated at hello service.</span></span> <span data-ttu-id="495f4-122">hello session kan hämta återupprätta endast med hello backend-server, vilket innebär att dina backend-servrar inte är exponeras toodirect HTTP-trafik.</span><span class="sxs-lookup"><span data-stu-id="495f4-122">hello session can get reestablished only with hello back-end server, which means that your back-end servers are not exposed toodirect HTTP traffic.</span></span> <span data-ttu-id="495f4-123">Den här konfigurationen innebär att du skyddas bättre från riktade attacker.</span><span class="sxs-lookup"><span data-stu-id="495f4-123">This configuration means that you are better protected from targeted attacks.</span></span>

### <a name="all-access-is-outbound"></a><span data-ttu-id="495f4-124">All åtkomst är utgående</span><span class="sxs-lookup"><span data-stu-id="495f4-124">All access is outbound</span></span> 

<span data-ttu-id="495f4-125">Du behöver inte tooopen inkommande anslutningar toohello företagets nätverk.</span><span class="sxs-lookup"><span data-stu-id="495f4-125">You don't need tooopen inbound connections toohello corporate network.</span></span>

<span data-ttu-id="495f4-126">Application Proxy kopplingar kan bara använda utgående anslutningar toohello Azure AD Application Proxy-tjänsten, vilket innebär att det ingen behövs tooopen portar i brandväggen för inkommande anslutningar.</span><span class="sxs-lookup"><span data-stu-id="495f4-126">Application Proxy connectors only use outbound connections toohello Azure AD Application Proxy service, which means that there is no need tooopen firewall ports for incoming connections.</span></span> <span data-ttu-id="495f4-127">Traditionella proxyservrar krävs ett perimeternätverk (även kallat *DMZ*, *demilitariserad zon*, eller *avskärmat undernät*) och får åtkomst till toounauthenticated anslutningar till hello nätverksgräns.</span><span class="sxs-lookup"><span data-stu-id="495f4-127">Traditional proxies required a perimeter network (also known as *DMZ*, *demilitarized zone*, or *screened subnet*) and allowed access toounauthenticated connections at hello network edge.</span></span> <span data-ttu-id="495f4-128">Det här scenariot krävs för många ytterligare investeringar i webbprogram brandväggen produkter tooanalyze trafik och ger ytterligare skydd toohello miljö.</span><span class="sxs-lookup"><span data-stu-id="495f4-128">This scenario required many additional investments in web application firewall products tooanalyze traffic and offer addition protections toohello environment.</span></span> <span data-ttu-id="495f4-129">Med Application Proxy behöver du inte ett perimeternätverk eftersom alla anslutningar är utgående och sker över en säker kanal.</span><span class="sxs-lookup"><span data-stu-id="495f4-129">With Application Proxy, you don't need a perimeter network because all connections are outbound and take place over a secure channel.</span></span>

<span data-ttu-id="495f4-130">Läs mer om kopplingar [förstå Azure AD Application Proxy kopplingar](application-proxy-understand-connectors.md).</span><span class="sxs-lookup"><span data-stu-id="495f4-130">For more information about connectors, see [Understand Azure AD Application Proxy connectors](application-proxy-understand-connectors.md).</span></span>

### <a name="cloud-scale-analytics-and-machine-learning"></a><span data-ttu-id="495f4-131">Skalbar molnlagring analyser och maskininlärning</span><span class="sxs-lookup"><span data-stu-id="495f4-131">Cloud-scale analytics and machine learning</span></span> 

<span data-ttu-id="495f4-132">Hämta senaste säkerhetsskydd.</span><span class="sxs-lookup"><span data-stu-id="495f4-132">Get cutting-edge security protection.</span></span>

<span data-ttu-id="495f4-133">Eftersom det är en del av Azure Active Directory Application Proxy kan utnyttja [Azure AD Identity Protection](active-directory-identityprotection.md), med machine learning-driven intelligence och data från hello Microsoft Security Response Center och Digital Crimes Unit.</span><span class="sxs-lookup"><span data-stu-id="495f4-133">Because it's part of Azure Active Directory, Application Proxy can leverage [Azure AD Identity Protection](active-directory-identityprotection.md), with machine learning-driven intelligence and data from hello Microsoft Security Response Center and Digital Crimes Unit.</span></span> <span data-ttu-id="495f4-134">Tillsammans vi proaktivt identifiera avslöjade konton och erbjuder realtidsskydd från hög risk inloggningar. Vi ta hänsyn till flera faktorer, till exempel åtkomst från infekterade enheter via anonymizing nätverk, och från ovanliga och inte troligt platser.</span><span class="sxs-lookup"><span data-stu-id="495f4-134">Together we proactively identify compromised accounts and offer real-time protection from high-risk sign-ins. We take into account numerous factors, such as access from infected devices, through anonymizing networks, and from atypical and unlikely locations.</span></span>

<span data-ttu-id="495f4-135">Många av dessa rapporter och händelser som är redan tillgängliga via ett API för integrering med din säkerhetsinformation och händelse-hanteringssystem (SIEM).</span><span class="sxs-lookup"><span data-stu-id="495f4-135">Many of these reports and events are already available through an API for integration with your security information and event management (SIEM) systems.</span></span>

### <a name="remote-access-as-a-service"></a><span data-ttu-id="495f4-136">Fjärråtkomst som en tjänst</span><span class="sxs-lookup"><span data-stu-id="495f4-136">Remote access as a service</span></span>

<span data-ttu-id="495f4-137">Du har inte tooworry om underhåll och korrigering lokala servrar.</span><span class="sxs-lookup"><span data-stu-id="495f4-137">You don’t have tooworry about maintaining and patching on-premises servers.</span></span>

<span data-ttu-id="495f4-138">Okorrigerade programvara fortfarande står för ett stort antal attacker.</span><span class="sxs-lookup"><span data-stu-id="495f4-138">Unpatched software still accounts for a large number of attacks.</span></span> <span data-ttu-id="495f4-139">Azure AD Application Proxy är en Internet-skala som Microsoft äger, så du får alltid hello senaste säkerhetskorrigeringar och uppgraderingar.</span><span class="sxs-lookup"><span data-stu-id="495f4-139">Azure AD Application Proxy is an Internet-scale service that Microsoft owns, so you always get hello latest security patches and upgrades.</span></span>

<span data-ttu-id="495f4-140">tooimprove hello säkerheten för program som publicerats av Azure AD Application Proxy, vi blockera web crawler robotar från indexering och arkivera dina program.</span><span class="sxs-lookup"><span data-stu-id="495f4-140">tooimprove hello security of applications published by Azure AD Application Proxy, we block web crawler robots from indexing and archiving your applications.</span></span> <span data-ttu-id="495f4-141">Varje gång en web crawler robot försöker hämta av roboten inställningarna för en publicerad appen Application Proxy svarar med en robots.txt-fil som innehåller `User-agent: * Disallow: /`.</span><span class="sxs-lookup"><span data-stu-id="495f4-141">Each time a web crawler robot tries to retrieve the robot's settings for a published app, Application Proxy replies with a robots.txt file that includes `User-agent: * Disallow: /`.</span></span>

## <a name="under-hello-hood"></a><span data-ttu-id="495f4-142">Under huven hello</span><span class="sxs-lookup"><span data-stu-id="495f4-142">Under hello hood</span></span>

<span data-ttu-id="495f4-143">Azure AD Application Proxy består av två delar:</span><span class="sxs-lookup"><span data-stu-id="495f4-143">Azure AD Application Proxy consists of two parts:</span></span>

* <span data-ttu-id="495f4-144">Hej molnbaserad tjänst: den här tjänsten körs i Azure och är där hello externa klientanvändare anslutningar görs.</span><span class="sxs-lookup"><span data-stu-id="495f4-144">hello cloud-based service: This service runs in Azure, and is where hello external client/user connections are made.</span></span>
* <span data-ttu-id="495f4-145">[hello-lokala anslutningen](application-proxy-understand-connectors.md): komponenten lokalt hello connector lyssnar efter förfrågningar från hello Azure AD Application Proxy-tjänsten och hanterar anslutningar toohello interna program.</span><span class="sxs-lookup"><span data-stu-id="495f4-145">[hello on-premises connector](application-proxy-understand-connectors.md): An on-premises component, hello connector listens for requests from hello Azure AD Application Proxy service and handles connections toohello internal applications.</span></span> 

<span data-ttu-id="495f4-146">Ett flöde mellan hello koppling och hello Application Proxy-tjänsten upprättas när:</span><span class="sxs-lookup"><span data-stu-id="495f4-146">A flow between hello connector and hello Application Proxy service is established when:</span></span>

* <span data-ttu-id="495f4-147">hello kopplingen har först ställts in.</span><span class="sxs-lookup"><span data-stu-id="495f4-147">hello connector is first set up.</span></span>
* <span data-ttu-id="495f4-148">hello koppling hämtar konfigurationsinformation från hello Application Proxy-tjänsten.</span><span class="sxs-lookup"><span data-stu-id="495f4-148">hello connector pulls configuration information from hello Application Proxy service.</span></span>
* <span data-ttu-id="495f4-149">En användare kommer åt ett publicerat program.</span><span class="sxs-lookup"><span data-stu-id="495f4-149">A user accesses a published application.</span></span>

>[!NOTE]
><span data-ttu-id="495f4-150">All kommunikation som sker över SSL och de har sitt ursprung alltid på hello connector toohello Application Proxy-tjänsten.</span><span class="sxs-lookup"><span data-stu-id="495f4-150">All communications occur over SSL, and they always originate at hello connector toohello Application Proxy service.</span></span> <span data-ttu-id="495f4-151">hello-tjänsten är endast utgående.</span><span class="sxs-lookup"><span data-stu-id="495f4-151">hello service is outbound only.</span></span>

<span data-ttu-id="495f4-152">hello-anslutningen använder en klient certifikat tooauthenticate toohello Application Proxy-tjänsten för nästan alla samtal.</span><span class="sxs-lookup"><span data-stu-id="495f4-152">hello connector uses a client certificate tooauthenticate toohello Application Proxy service for nearly all calls.</span></span> <span data-ttu-id="495f4-153">hello endast undantag toothis processen är hello installationen steg där hello Klientcertifikatet har upprättats.</span><span class="sxs-lookup"><span data-stu-id="495f4-153">hello only exception toothis process is hello initial setup step, where hello client certificate is established.</span></span>

### <a name="installing-hello-connector"></a><span data-ttu-id="495f4-154">Installerar hello connector</span><span class="sxs-lookup"><span data-stu-id="495f4-154">Installing hello connector</span></span>

<span data-ttu-id="495f4-155">När hello connector installeras först, äga rum hello följande flödet händelser:</span><span class="sxs-lookup"><span data-stu-id="495f4-155">When hello connector is first set up, hello following flow events take place:</span></span>

1. <span data-ttu-id="495f4-156">hello kopplingstjänsten registrering toohello händer som en del av hello installationen av hello-anslutningen.</span><span class="sxs-lookup"><span data-stu-id="495f4-156">hello connector registration toohello service happens as part of hello installation of hello connector.</span></span> <span data-ttu-id="495f4-157">Användare är begärd tooenter sina Azure AD-administratörsautentiseringsuppgifter.</span><span class="sxs-lookup"><span data-stu-id="495f4-157">Users are prompted tooenter their Azure AD admin credentials.</span></span> <span data-ttu-id="495f4-158">Den token som erhållits från den här autentiseringen sedan presenteras toohello Azure AD Application Proxy-tjänsten.</span><span class="sxs-lookup"><span data-stu-id="495f4-158">The token acquired from this authentication is then presented toohello Azure AD Application Proxy service.</span></span>
2. <span data-ttu-id="495f4-159">hello Application Proxy-tjänsten utvärderar hello-token.</span><span class="sxs-lookup"><span data-stu-id="495f4-159">hello Application Proxy service evaluates hello token.</span></span> <span data-ttu-id="495f4-160">Det garanterar att hello användaren är en företagsadministratör inom hello-klient som hello token har utfärdats för.</span><span class="sxs-lookup"><span data-stu-id="495f4-160">It ensures that hello user is a company administrator within hello tenant that hello token was issued for.</span></span> <span data-ttu-id="495f4-161">Om hello användaren inte är administratör avslutas hello processen.</span><span class="sxs-lookup"><span data-stu-id="495f4-161">If hello user is not an administrator, hello process is terminated.</span></span>
3. <span data-ttu-id="495f4-162">hello anslutningen genererar en certifikatbegäran för klienten och skickar den, tillsammans med hello token, toohello Application Proxy-tjänsten.</span><span class="sxs-lookup"><span data-stu-id="495f4-162">hello connector generates a client certificate request and passes it, along with hello token, toohello Application Proxy service.</span></span> <span data-ttu-id="495f4-163">hello-tjänsten i sin tur verifierar hello token och loggar hello klienten certifikatbegäran.</span><span class="sxs-lookup"><span data-stu-id="495f4-163">hello service in turn verifies hello token and signs hello client certificate request.</span></span>
4. <span data-ttu-id="495f4-164">hello-anslutningen använder hello klientcertifikatet för framtida kommunikation med hello Application Proxy-tjänsten.</span><span class="sxs-lookup"><span data-stu-id="495f4-164">hello connector uses hello client certificate for future communication with hello Application Proxy service.</span></span>
5. <span data-ttu-id="495f4-165">hello connector utför en inledande pull av hello systemkonfigurationsdata från hello-tjänsten med hjälp av dess klientcertifikatet och är nu redo tootake begäranden.</span><span class="sxs-lookup"><span data-stu-id="495f4-165">hello connector performs an initial pull of hello system configuration data from hello service using its client certificate, and it is now ready tootake requests.</span></span>

### <a name="updating-hello-configuration-settings"></a><span data-ttu-id="495f4-166">Konfigurationsinställningarna för hello</span><span class="sxs-lookup"><span data-stu-id="495f4-166">Updating hello configuration settings</span></span>

<span data-ttu-id="495f4-167">När hello Application Proxy-tjänsten uppdaterar hello konfigurationsinställningar, äga rum hello följande flödet händelser:</span><span class="sxs-lookup"><span data-stu-id="495f4-167">Whenever hello Application Proxy service updates hello configuration settings, hello following flow events take place:</span></span>

1. <span data-ttu-id="495f4-168">hello connector ansluter toohello configuration slutpunkten inom hello Application Proxy-tjänsten med hjälp av dess klientcertifikat.</span><span class="sxs-lookup"><span data-stu-id="495f4-168">hello connector connects toohello configuration endpoint within hello Application Proxy service by using its client certificate.</span></span>
2. <span data-ttu-id="495f4-169">När hello Klientcertifikatet har verifierats, hello Application Proxy-tjänsten returnerar configuration data toohello anslutningen (till exempel hello connector grupp som hello anslutningen ska vara en del av).</span><span class="sxs-lookup"><span data-stu-id="495f4-169">After hello client certificate has been validated, hello Application Proxy service returns configuration data toohello connector (for example, hello connector group that hello connector should be part of).</span></span>
3. <span data-ttu-id="495f4-170">Om hello aktuella certifikatet är mer än 180 dagar, genererar hello connector en ny certifikatbegäran som effektivt uppdaterar hello klientcertifikat varje 180 dagar.</span><span class="sxs-lookup"><span data-stu-id="495f4-170">If hello current certificate is more than 180 days old, hello connector generates a new certificate request, which effectively updates hello client certificate every 180 days.</span></span>

### <a name="accessing-published-applications"></a><span data-ttu-id="495f4-171">Åtkomst till publicerade program</span><span class="sxs-lookup"><span data-stu-id="495f4-171">Accessing published applications</span></span>

<span data-ttu-id="495f4-172">När användare har åtkomst till ett publicerat program äger hello följande händelser rum mellan hello Application Proxy-tjänsten och hello Application Proxy connector:</span><span class="sxs-lookup"><span data-stu-id="495f4-172">When users access a published application, hello following events take place between hello Application Proxy service and hello Application Proxy connector:</span></span>

1. [<span data-ttu-id="495f4-173">hello tjänsten autentiserar hello användare för hello app</span><span class="sxs-lookup"><span data-stu-id="495f4-173">hello service authenticates hello user for hello app</span></span>](#the-service-checks-the-configuration-settings-for-the-app)
2. [<span data-ttu-id="495f4-174">hello tjänsten placerar en begäran i kö för hello-koppling</span><span class="sxs-lookup"><span data-stu-id="495f4-174">hello service places a request in hello connector queue</span></span>](#The-service-places-a-request-in-the-connector-queue)
3. [<span data-ttu-id="495f4-175">En koppling behandlar hello begäran från hello kö</span><span class="sxs-lookup"><span data-stu-id="495f4-175">A connector processes hello request from hello queue</span></span>](#the-connector-receives-the-request-from-the-queue)
4. [<span data-ttu-id="495f4-176">hello anslutningen väntar på svar</span><span class="sxs-lookup"><span data-stu-id="495f4-176">hello connector waits for a response</span></span>](#the-connector-waits-for-a-response)
5. [<span data-ttu-id="495f4-177">hello dataströmmar data toohello tjänstanvändaren</span><span class="sxs-lookup"><span data-stu-id="495f4-177">hello service streams data toohello user</span></span>](#the-service-streams-data-to-the-user)

<span data-ttu-id="495f4-178">toolearn mer information om vad sker i var och en av de här stegen att läsa.</span><span class="sxs-lookup"><span data-stu-id="495f4-178">toolearn more about what takes place in each of these steps, keep reading.</span></span>


#### <a name="1-hello-service-authenticates-hello-user-for-hello-app"></a><span data-ttu-id="495f4-179">1. hello tjänsten autentiserar hello användare för hello app</span><span class="sxs-lookup"><span data-stu-id="495f4-179">1. hello service authenticates hello user for hello app</span></span>

<span data-ttu-id="495f4-180">Om du har konfigurerat hello app toouse genomströmning som dess förautentiseringsmetoden hello stegen i det här avsnittet är hoppas över.</span><span class="sxs-lookup"><span data-stu-id="495f4-180">If you configured hello app toouse Passthrough as its preauthentication method, hello steps in this section are skipped.</span></span>

<span data-ttu-id="495f4-181">Om du har konfigurerat hello app toopreauthenticate med Azure AD omdirigerade toohello Azure AD STS tooauthenticate användare, och hello följande steg utföras:</span><span class="sxs-lookup"><span data-stu-id="495f4-181">If you configured hello app toopreauthenticate with Azure AD, users are redirected toohello Azure AD STS tooauthenticate, and hello following steps take place:</span></span>

1. <span data-ttu-id="495f4-182">Application Proxy kontrollerar alla krav på villkorlig åtkomst för hello specifika program.</span><span class="sxs-lookup"><span data-stu-id="495f4-182">Application Proxy checks for any conditional access policy requirements for hello specific application.</span></span> <span data-ttu-id="495f4-183">Det här steget säkerställer att hello-användaren har tilldelats toohello program.</span><span class="sxs-lookup"><span data-stu-id="495f4-183">This step ensures that hello user has been assigned toohello application.</span></span> <span data-ttu-id="495f4-184">Om tvåstegsverifiering krävs frågar hello autentisering sekvens hello användaren efter en andra autentiseringsmetod.</span><span class="sxs-lookup"><span data-stu-id="495f4-184">If two-step verification is required, hello authentication sequence prompts hello user for a second authentication method.</span></span>

2. <span data-ttu-id="495f4-185">När alla kontroller har klarat hello Azure AD-STS utfärdar en signerade token för programmet hello och omdirigerar hello användaren tillbaka toohello Application Proxy-tjänsten.</span><span class="sxs-lookup"><span data-stu-id="495f4-185">After all checks have passed, hello Azure AD STS issues a signed token for hello application and redirects hello user back toohello Application Proxy service.</span></span>

3. <span data-ttu-id="495f4-186">Programproxy verifierar den hello-token har utfärdats toocorrect hello program.</span><span class="sxs-lookup"><span data-stu-id="495f4-186">Application Proxy verifies that hello token was issued toocorrect hello application.</span></span> <span data-ttu-id="495f4-187">Den genomför också andra kontroller, till exempel att säkerställa att hello token har signerats av Azure AD och att det finns fortfarande i hello giltig fönster.</span><span class="sxs-lookup"><span data-stu-id="495f4-187">It performs other checks also, such as ensuring that hello token was signed by Azure AD, and that it is still within hello valid window.</span></span>

4. <span data-ttu-id="495f4-188">Application Proxy anger en krypterad autentisering cookie tooindicate som autentisering toohello program har inträffat.</span><span class="sxs-lookup"><span data-stu-id="495f4-188">Application Proxy sets an encrypted authentication cookie tooindicate that authentication toohello application has occurred.</span></span> <span data-ttu-id="495f4-189">hello innehåller cookie ett förfallodatum tidsstämpel som baseras på hello-token från Azure AD och andra data som hello användarnamn som hello autentisering baseras på.</span><span class="sxs-lookup"><span data-stu-id="495f4-189">hello cookie includes an expiration timestamp that's based on hello token from Azure AD and other data, such as hello user name that hello authentication is based on.</span></span> <span data-ttu-id="495f4-190">hello cookien krypteras med en privat nyckel kända endast toohello Application Proxy-tjänsten.</span><span class="sxs-lookup"><span data-stu-id="495f4-190">hello cookie is encrypted with a private key known only toohello Application Proxy service.</span></span>

5. <span data-ttu-id="495f4-191">Application Proxy omdirigeringar hello användaren tillbaka toohello ursprungligen begärde URL.</span><span class="sxs-lookup"><span data-stu-id="495f4-191">Application Proxy redirects hello user back toohello originally requested URL.</span></span>

<span data-ttu-id="495f4-192">Om någon del av hello förautentisering steg misslyckas, hello användarens begäran nekas och hello användare visas ett meddelande som anger hello källan hello problemet.</span><span class="sxs-lookup"><span data-stu-id="495f4-192">If any part of hello preauthentication steps fails, hello user’s request is denied, and hello user is shown a message indicating hello source of hello problem.</span></span>


#### <a name="2-hello-service-places-a-request-in-hello-connector-queue"></a><span data-ttu-id="495f4-193">2. hello tjänsten placerar en begäran i kö för hello-koppling</span><span class="sxs-lookup"><span data-stu-id="495f4-193">2. hello service places a request in hello connector queue</span></span>

<span data-ttu-id="495f4-194">Kopplingar håller en utgående anslutning öppen toohello Application Proxy-tjänsten.</span><span class="sxs-lookup"><span data-stu-id="495f4-194">Connectors keep an outbound connection open toohello Application Proxy service.</span></span> <span data-ttu-id="495f4-195">När en begäran kommer, köar hello service in hello begäran på en av hello öppna anslutningar för hello connector toopick upp.</span><span class="sxs-lookup"><span data-stu-id="495f4-195">When a request comes in, hello service queues up hello request on one of hello open connections for hello connector toopick up.</span></span>

<span data-ttu-id="495f4-196">hello-begäran innehåller objekt från hello program, till exempel hello begärandehuvuden, data från hello krypterad cookie, hello användaren gör hello begäran och hello be-ID.</span><span class="sxs-lookup"><span data-stu-id="495f4-196">hello request includes items from hello application, such as hello request headers, data from hello encrypted cookie, hello user making hello request, and hello request ID.</span></span> <span data-ttu-id="495f4-197">Även om data från hello krypterad cookie skickas med hello-begäran är inte hello autentiseringscookien sig själv.</span><span class="sxs-lookup"><span data-stu-id="495f4-197">Although data from hello encrypted cookie is sent with hello request, hello authentication cookie itself is not.</span></span>

#### <a name="3-hello-connector-processes-hello-request-from-hello-queue"></a><span data-ttu-id="495f4-198">3. hello connector processer hello begäran från hello kö.</span><span class="sxs-lookup"><span data-stu-id="495f4-198">3. hello connector processes hello request from hello queue.</span></span> 

<span data-ttu-id="495f4-199">Application Proxy utför på hello begäran en hello följande åtgärder:</span><span class="sxs-lookup"><span data-stu-id="495f4-199">Based on hello request, Application Proxy performs one of hello following actions:</span></span>

* <span data-ttu-id="495f4-200">Om hello-begäran är en enkel åtgärd (t.ex, det finns inga data inom hello brödtext som med en RESTful *hämta* begäran), hello connector gör en anslutning toohello interna målresurs och sedan väntar på svar.</span><span class="sxs-lookup"><span data-stu-id="495f4-200">If hello request is a simple operation (for example, there is no data within hello body as is with a RESTful *GET* request), hello connector makes a connection toohello target internal resource and then waits for a response.</span></span>

* <span data-ttu-id="495f4-201">Om hello begäran har data som är associerade med den i hello brödtext (till exempel en RESTful *POST* åtgärden), hello connector gör en utgående anslutning med hjälp av hello klienten certifikatet toohello Application Proxy instans.</span><span class="sxs-lookup"><span data-stu-id="495f4-201">If hello request has data associated with it in hello body (for example, a RESTful *POST* operation), hello connector makes an outbound connection by using hello client certificate toohello Application Proxy instance.</span></span> <span data-ttu-id="495f4-202">Den gör den här anslutningen toorequest hello data och öppna en anslutning toohello interna resurs.</span><span class="sxs-lookup"><span data-stu-id="495f4-202">It makes this connection toorequest hello data and open a connection toohello internal resource.</span></span> <span data-ttu-id="495f4-203">När den tar emot hello begäran från hello kopplingen hello Application Proxy-tjänsten börjar ta emot innehåll från hello användaren och vidarebefordrar toohello dataanslutning.</span><span class="sxs-lookup"><span data-stu-id="495f4-203">After it receives hello request from hello connector, hello Application Proxy service begins accepting content from hello user and forwards data toohello connector.</span></span> <span data-ttu-id="495f4-204">hello koppling vidarebefordrar i sin tur hello data toohello interna resurser.</span><span class="sxs-lookup"><span data-stu-id="495f4-204">hello connector, in turn, forwards hello data toohello internal resource.</span></span>

#### <a name="4-hello-connector-waits-for-a-response"></a><span data-ttu-id="495f4-205">4. hello anslutningen väntar på svar.</span><span class="sxs-lookup"><span data-stu-id="495f4-205">4. hello connector waits for a response.</span></span>

<span data-ttu-id="495f4-206">När hello begäran och överföring av allt innehåll toohello tillbaka slutet är klar, hello anslutningen väntar på svar.</span><span class="sxs-lookup"><span data-stu-id="495f4-206">After hello request and transmission of all content toohello back end is complete, hello connector waits for a response.</span></span>

<span data-ttu-id="495f4-207">När den tar emot ett svar hello connector gör en utgående anslutning toohello Application Proxy-tjänst, tooreturn hello sidhuvud information och börja strömning hello returnerade data.</span><span class="sxs-lookup"><span data-stu-id="495f4-207">After it receives a response, hello connector makes an outbound connection toohello Application Proxy service, tooreturn hello header details and begin streaming hello return data.</span></span>

#### <a name="5-hello-service-streams-data-toohello-user"></a><span data-ttu-id="495f4-208">5. hello dataströmmar data toohello tjänstanvändaren.</span><span class="sxs-lookup"><span data-stu-id="495f4-208">5. hello service streams data toohello user.</span></span> 

<span data-ttu-id="495f4-209">Vissa bearbetningen av programmet hello kan inträffa här.</span><span class="sxs-lookup"><span data-stu-id="495f4-209">Some processing of hello application may occur here.</span></span> <span data-ttu-id="495f4-210">Om du har konfigurerat Application Proxy tootranslate huvuden eller URL: er i ditt program sker bearbetningen som behövs för det här steget.</span><span class="sxs-lookup"><span data-stu-id="495f4-210">If you configured Application Proxy tootranslate headers or URLs in your application, that processing happens as needed during this step.</span></span>


## <a name="next-steps"></a><span data-ttu-id="495f4-211">Nästa steg</span><span class="sxs-lookup"><span data-stu-id="495f4-211">Next steps</span></span>

[<span data-ttu-id="495f4-212">Topologiöverväganden nätverk när du använder Azure AD Application Proxy</span><span class="sxs-lookup"><span data-stu-id="495f4-212">Network topology considerations when using Azure AD Application Proxy</span></span>](application-proxy-network-topology-considerations.md)

[<span data-ttu-id="495f4-213">Förstå Azure AD Application Proxy-kopplingar</span><span class="sxs-lookup"><span data-stu-id="495f4-213">Understand Azure AD Application Proxy connectors</span></span>](application-proxy-understand-connectors.md)
