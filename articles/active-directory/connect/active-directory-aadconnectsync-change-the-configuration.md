---
title: "Azure AD Connect-synkronisering: gjort en konfigurationsändring i Azure AD Connect-synkronisering | Microsoft Docs"
description: "Vägleder dig igenom hur du gör en ändring i konfigurationen i Azure AD Connect-synkronisering."
services: active-directory
documentationcenter: 
author: andkjell
manager: femila
editor: 
ms.assetid: 7b9df836-e8a5-4228-97da-2faec9238b31
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/12/2017
ms.author: billmath
ms.openlocfilehash: 63a7ae9d39e1a74294637172efd607ee41b2d69b
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 08/03/2017
---
# <a name="azure-ad-connect-sync-how-to-make-a-change-to-the-default-configuration"></a><span data-ttu-id="bea9c-103">Azure AD Connect-synkronisering: hur du gör en ändring i standardkonfigurationen</span><span class="sxs-lookup"><span data-stu-id="bea9c-103">Azure AD Connect sync: How to make a change to the default configuration</span></span>
<span data-ttu-id="bea9c-104">Syftet med det här avsnittet är leder dig igenom hur du gör ändringar i standardkonfigurationen i Azure AD Connect-synkronisering.</span><span class="sxs-lookup"><span data-stu-id="bea9c-104">The purpose of this topic is to walk you through how to make changes to the default configuration in Azure AD Connect sync.</span></span> <span data-ttu-id="bea9c-105">Den innehåller steg för några vanliga scenarier.</span><span class="sxs-lookup"><span data-stu-id="bea9c-105">It provides steps for some common scenarios.</span></span> <span data-ttu-id="bea9c-106">Med denna kunskap kan ska du kunna göra några enkla förändringar i din egen konfiguration baserat på dina egna regler.</span><span class="sxs-lookup"><span data-stu-id="bea9c-106">With this knowledge, you should be able to make some simple changes to your own configuration based on your own business rules.</span></span>

## <a name="synchronization-rules-editor"></a><span data-ttu-id="bea9c-107">Redigeraren för regler för synkronisering</span><span class="sxs-lookup"><span data-stu-id="bea9c-107">Synchronization Rules Editor</span></span>
<span data-ttu-id="bea9c-108">Redigeraren för regler för synkronisering används för att se och ändra standardkonfigurationen.</span><span class="sxs-lookup"><span data-stu-id="bea9c-108">The Synchronization Rules Editor is used to see and change the default configuration.</span></span> <span data-ttu-id="bea9c-109">Du hittar i Start-menyn under den **Azure AD Connect** grupp.</span><span class="sxs-lookup"><span data-stu-id="bea9c-109">You can find it in the Start Menu under the **Azure AD Connect** group.</span></span>  
<span data-ttu-id="bea9c-110">![Start-menyn med synkronisering Rule Editor](./media/active-directory-aadconnectsync-change-the-configuration/startmenu2.png)</span><span class="sxs-lookup"><span data-stu-id="bea9c-110">![Start Menu with Sync Rule Editor](./media/active-directory-aadconnectsync-change-the-configuration/startmenu2.png)</span></span>

<span data-ttu-id="bea9c-111">När du öppnar den ser du standardregler för out-of-box.</span><span class="sxs-lookup"><span data-stu-id="bea9c-111">When you open it, you see the default out-of-box rules.</span></span>

![Synkronisera Rule Editor](./media/active-directory-aadconnectsync-change-the-configuration/sre2.png)

### <a name="navigating-in-the-editor"></a><span data-ttu-id="bea9c-113">Navigera i Redigeraren</span><span class="sxs-lookup"><span data-stu-id="bea9c-113">Navigating in the editor</span></span>
<span data-ttu-id="bea9c-114">Listrutor längst upp i Redigeraren för kan du snabbt hitta en viss regel.</span><span class="sxs-lookup"><span data-stu-id="bea9c-114">The drop-downs at the top of the editor allow you to quickly find a particular rule.</span></span> <span data-ttu-id="bea9c-115">Om du vill visa reglerna där attributet proxyAddresses ingår ändrar du till exempel av listrutorna för följande:</span><span class="sxs-lookup"><span data-stu-id="bea9c-115">For example, if you want to see the rules where the attribute proxyAddresses is included, you would change the drop-downs to the following:</span></span>  
<span data-ttu-id="bea9c-116">![SRE filtrering](./media/active-directory-aadconnectsync-change-the-configuration/filtering.png)</span><span class="sxs-lookup"><span data-stu-id="bea9c-116">![SRE filtering](./media/active-directory-aadconnectsync-change-the-configuration/filtering.png)</span></span>  
<span data-ttu-id="bea9c-117">Om du vill återställa filtrering och läsa in en ny konfiguration, trycker du på **F5** på tangentbordet.</span><span class="sxs-lookup"><span data-stu-id="bea9c-117">To reset filtering and load a fresh configuration, press **F5** on the keyboard.</span></span>

<span data-ttu-id="bea9c-118">Upp till höger, du har en knapp **Lägg till ny regel**.</span><span class="sxs-lookup"><span data-stu-id="bea9c-118">To the top right, you have a button **Add new rule**.</span></span> <span data-ttu-id="bea9c-119">Den här knappen används för att skapa en egen anpassad regel.</span><span class="sxs-lookup"><span data-stu-id="bea9c-119">This button is used to create your own custom rule.</span></span>

<span data-ttu-id="bea9c-120">Längst ned ha knappar för agerar på valda synkroniseringsregel.</span><span class="sxs-lookup"><span data-stu-id="bea9c-120">At the bottom, you have buttons for acting on a selected sync rule.</span></span> <span data-ttu-id="bea9c-121">**Redigera** och **ta bort** göra vad du förväntade dig.</span><span class="sxs-lookup"><span data-stu-id="bea9c-121">**Edit** and **Delete** do what you expect them to.</span></span> <span data-ttu-id="bea9c-122">**Exportera** genererar ett PowerShell-skript för att återskapa regeln synkronisering.</span><span class="sxs-lookup"><span data-stu-id="bea9c-122">**Export** produces a PowerShell script for recreating the sync rule.</span></span> <span data-ttu-id="bea9c-123">Den här proceduren kan du flytta en synkroniseringsregel från en server till en annan.</span><span class="sxs-lookup"><span data-stu-id="bea9c-123">This procedure allows you to move a sync rule from one server to another.</span></span>

## <a name="create-your-first-custom-rule"></a><span data-ttu-id="bea9c-124">Skapa din första anpassad regel</span><span class="sxs-lookup"><span data-stu-id="bea9c-124">Create your first custom rule</span></span>
<span data-ttu-id="bea9c-125">Ändringar av attributflöden är de vanligaste ändringen.</span><span class="sxs-lookup"><span data-stu-id="bea9c-125">The most common change is changes to the attribute flows.</span></span> <span data-ttu-id="bea9c-126">Data i källkatalogen kanske inte som Azure AD.</span><span class="sxs-lookup"><span data-stu-id="bea9c-126">The data in your source directory might not be as in Azure AD.</span></span> <span data-ttu-id="bea9c-127">I exemplet i det här avsnittet, som du vill kontrollera att det angivna namnet för en användare är alltid i **rätt skiftläge**.</span><span class="sxs-lookup"><span data-stu-id="bea9c-127">In the example in this section, you want to make sure the given name of a user is always in **Proper case**.</span></span>

### <a name="disable-the-scheduler"></a><span data-ttu-id="bea9c-128">Inaktivera Schemaläggaren</span><span class="sxs-lookup"><span data-stu-id="bea9c-128">Disable the scheduler</span></span>
<span data-ttu-id="bea9c-129">Den [scheduler](active-directory-aadconnectsync-feature-scheduler.md) körs var 30: e minut som standard.</span><span class="sxs-lookup"><span data-stu-id="bea9c-129">The [scheduler](active-directory-aadconnectsync-feature-scheduler.md) runs every 30 minutes by default.</span></span> <span data-ttu-id="bea9c-130">Du vill kontrollera att den inte startar när du gör ändringar och felsöka din nya regler.</span><span class="sxs-lookup"><span data-stu-id="bea9c-130">You want to make sure it is not starting while you are making changes and troubleshoot your new rules.</span></span> <span data-ttu-id="bea9c-131">För att tillfälligt inaktivera Schemaläggaren, starta PowerShell och kör`Set-ADSyncScheduler -SyncCycleEnabled $false`</span><span class="sxs-lookup"><span data-stu-id="bea9c-131">To temporarily disable the scheduler, start PowerShell, and run `Set-ADSyncScheduler -SyncCycleEnabled $false`</span></span>

![Inaktivera Schemaläggaren](./media/active-directory-aadconnectsync-change-the-configuration/schedulerdisable.png)  

### <a name="create-the-rule"></a><span data-ttu-id="bea9c-133">Skapa regel</span><span class="sxs-lookup"><span data-stu-id="bea9c-133">Create the rule</span></span>
1. <span data-ttu-id="bea9c-134">Klicka på **Lägg till ny regel**.</span><span class="sxs-lookup"><span data-stu-id="bea9c-134">Click **Add new rule**.</span></span>
2. <span data-ttu-id="bea9c-135">På den **beskrivning** sidan anger du följande:</span><span class="sxs-lookup"><span data-stu-id="bea9c-135">On the **Description** page enter the following:</span></span>  
   <span data-ttu-id="bea9c-136">![Inkommande regel filtrering](./media/active-directory-aadconnectsync-change-the-configuration/description2.png)</span><span class="sxs-lookup"><span data-stu-id="bea9c-136">![Inbound rule filtering](./media/active-directory-aadconnectsync-change-the-configuration/description2.png)</span></span>  
   * <span data-ttu-id="bea9c-137">Namn: Ge regeln ett beskrivande namn.</span><span class="sxs-lookup"><span data-stu-id="bea9c-137">Name: Give the rule a descriptive name.</span></span>
   * <span data-ttu-id="bea9c-138">Beskrivning: Vissa förtydligande så att någon annan kan förstå vad regeln för.</span><span class="sxs-lookup"><span data-stu-id="bea9c-138">Description: Some clarification so someone else can understand what the rule is for.</span></span>
   * <span data-ttu-id="bea9c-139">Anslutna system: objektet finns i systemet.</span><span class="sxs-lookup"><span data-stu-id="bea9c-139">Connected system: The system the object can be found in.</span></span> <span data-ttu-id="bea9c-140">I det här fallet, Välj den Active Directory-koppling.</span><span class="sxs-lookup"><span data-stu-id="bea9c-140">In this case, select the Active Directory Connector.</span></span>
   * <span data-ttu-id="bea9c-141">Anslutna System/metaversum-objekttyp: Välj **användare** och **Person** respektive.</span><span class="sxs-lookup"><span data-stu-id="bea9c-141">Connected System/Metaverse Object Type: Select **User** and **Person** respectively.</span></span>
   * <span data-ttu-id="bea9c-142">Länktypen: Ändra värdet till **ansluta**.</span><span class="sxs-lookup"><span data-stu-id="bea9c-142">Link Type: Change this value to **Join**.</span></span>
   * <span data-ttu-id="bea9c-143">Prioritet: Ange ett värde som är unikt i systemet.</span><span class="sxs-lookup"><span data-stu-id="bea9c-143">Precedence: Provide a value that is unique in the system.</span></span> <span data-ttu-id="bea9c-144">Ett lägre numeriskt värde anger högre prioritet.</span><span class="sxs-lookup"><span data-stu-id="bea9c-144">A lower numeric value indicates higher precedence.</span></span>
   * <span data-ttu-id="bea9c-145">Tagg: Lämna tomt.</span><span class="sxs-lookup"><span data-stu-id="bea9c-145">Tag: Leave empty.</span></span> <span data-ttu-id="bea9c-146">Endast out-of-box regler från Microsoft ska ha den här rutan fylls i med ett värde.</span><span class="sxs-lookup"><span data-stu-id="bea9c-146">Only out-of-box rules from Microsoft should have this box populated with a value.</span></span>
3. <span data-ttu-id="bea9c-147">På den **Scoping filter** anger **givenName ISNOTNULL**.</span><span class="sxs-lookup"><span data-stu-id="bea9c-147">On the **Scoping filter** page, enter **givenName ISNOTNULL**.</span></span>  
   <span data-ttu-id="bea9c-148">![Regel för inkommande trafik Omfångsfilter](./media/active-directory-aadconnectsync-change-the-configuration/scopingfilter.png)</span><span class="sxs-lookup"><span data-stu-id="bea9c-148">![Inbound rule scoping filter](./media/active-directory-aadconnectsync-change-the-configuration/scopingfilter.png)</span></span>  
   <span data-ttu-id="bea9c-149">Det här avsnittet används för att definiera vilka objekt som regeln ska gälla för.</span><span class="sxs-lookup"><span data-stu-id="bea9c-149">This section is used to define which objects the rule should apply to.</span></span> <span data-ttu-id="bea9c-150">Om den lämnas tom skulle regeln gälla för alla användarobjekt.</span><span class="sxs-lookup"><span data-stu-id="bea9c-150">If left empty, the rule would apply to all user objects.</span></span> <span data-ttu-id="bea9c-151">Men som även konferensrum, tjänstkonton och andra icke personer användarobjekt.</span><span class="sxs-lookup"><span data-stu-id="bea9c-151">But that would include conference rooms, service accounts, and other non-people user objects.</span></span>
4. <span data-ttu-id="bea9c-152">På den **ansluta regler**, lämna det tomt.</span><span class="sxs-lookup"><span data-stu-id="bea9c-152">On the **Join rules**, leave it empty.</span></span>
5. <span data-ttu-id="bea9c-153">På den **transformationer** ändrar ExchangeRate för FlowType till **uttryck**.</span><span class="sxs-lookup"><span data-stu-id="bea9c-153">On the **Transformations** page, change the FlowType to **Expression**.</span></span> <span data-ttu-id="bea9c-154">Välj målattribut **givenName**, och ange i källan `PCase([givenName])`.</span><span class="sxs-lookup"><span data-stu-id="bea9c-154">Select the Target Attribute **givenName**, and in Source enter `PCase([givenName])`.</span></span>
   <span data-ttu-id="bea9c-155">![Regel för inkommande trafik omvandlingar](./media/active-directory-aadconnectsync-change-the-configuration/transformations.png)</span><span class="sxs-lookup"><span data-stu-id="bea9c-155">![Inbound rule transformations](./media/active-directory-aadconnectsync-change-the-configuration/transformations.png)</span></span>  
   <span data-ttu-id="bea9c-156">Synkroniseringsmotorn är skiftlägeskänslig både funktionsnamnet och namnet på attributet.</span><span class="sxs-lookup"><span data-stu-id="bea9c-156">The sync engine is case-sensitive both on the function name and the name of the attribute.</span></span> <span data-ttu-id="bea9c-157">Om du skriver något fel, se en varning när du lägger till regeln.</span><span class="sxs-lookup"><span data-stu-id="bea9c-157">If you type something wrong, you see a warning when you add the rule.</span></span> <span data-ttu-id="bea9c-158">Redigeraren för kan du spara och fortsätta, så du måste öppna regeln och rätta till regeln.</span><span class="sxs-lookup"><span data-stu-id="bea9c-158">The editor allows you to save and continue, so you would have to reopen the rule and correct the rule.</span></span>
6. <span data-ttu-id="bea9c-159">Klicka på **Lägg till** spara regeln.</span><span class="sxs-lookup"><span data-stu-id="bea9c-159">Click **Add** to save the rule.</span></span>

<span data-ttu-id="bea9c-160">Den nya anpassa regeln ska visas med andra regler för synkronisering i systemet.</span><span class="sxs-lookup"><span data-stu-id="bea9c-160">Your new custom rule should be visible with the other sync rules in the system.</span></span>

### <a name="verify-the-change"></a><span data-ttu-id="bea9c-161">Bekräfta ändringen</span><span class="sxs-lookup"><span data-stu-id="bea9c-161">Verify the change</span></span>
<span data-ttu-id="bea9c-162">Med den här nya ändringar som du vill kontrollera att den fungerar som väntat och inte som utlöste eventuella fel.</span><span class="sxs-lookup"><span data-stu-id="bea9c-162">With this new change, you want to make sure it is working as expected and is not throwing any errors.</span></span> <span data-ttu-id="bea9c-163">Beroende på antalet objekt som du har, finns det två sätt att göra det här steget.</span><span class="sxs-lookup"><span data-stu-id="bea9c-163">Depending on the number of objects you have, there are two different ways to do this step.</span></span>

1. <span data-ttu-id="bea9c-164">Kör en fullständig synkronisering för alla objekt</span><span class="sxs-lookup"><span data-stu-id="bea9c-164">Run a full sync on all objects</span></span>
2. <span data-ttu-id="bea9c-165">Kör en förhandsgranskning och en fullständig synkronisering på ett objekt</span><span class="sxs-lookup"><span data-stu-id="bea9c-165">Run a preview and full sync on a single object</span></span>

<span data-ttu-id="bea9c-166">Starta **synkroniseringstjänsten** från start-menyn.</span><span class="sxs-lookup"><span data-stu-id="bea9c-166">Start **Synchronization Service** from the start menu.</span></span> <span data-ttu-id="bea9c-167">Stegen i det här avsnittet finns i det här verktyget.</span><span class="sxs-lookup"><span data-stu-id="bea9c-167">The steps in this section are all in this tool.</span></span>

1. <span data-ttu-id="bea9c-168">**Fullständig synkronisering för alla objekt**</span><span class="sxs-lookup"><span data-stu-id="bea9c-168">**Full sync on all objects**</span></span>  
   <span data-ttu-id="bea9c-169">Välj **kopplingar** längst upp.</span><span class="sxs-lookup"><span data-stu-id="bea9c-169">Select **Connectors** at the top.</span></span> <span data-ttu-id="bea9c-170">Identifiera kopplingen du har gjort en ändring i föregående avsnitt i det här fallet Active Directory Domain Services och markera den.</span><span class="sxs-lookup"><span data-stu-id="bea9c-170">Identify the Connector you made a change to in the previous section, in this case the Active Directory Domain Services, and select it.</span></span> <span data-ttu-id="bea9c-171">Välj **kör** åtgärder och välj **fullständig synkronisering** och **OK**.</span><span class="sxs-lookup"><span data-stu-id="bea9c-171">Select **Run** from Actions and select **Full Synchronization** and **OK**.</span></span>
   <span data-ttu-id="bea9c-172">![Fullständig synkronisering](./media/active-directory-aadconnectsync-change-the-configuration/fullsync.png)</span><span class="sxs-lookup"><span data-stu-id="bea9c-172">![Full sync](./media/active-directory-aadconnectsync-change-the-configuration/fullsync.png)</span></span>  
   <span data-ttu-id="bea9c-173">Objekt har uppdaterats i metaversum.</span><span class="sxs-lookup"><span data-stu-id="bea9c-173">The objects are now updated in the metaverse.</span></span> <span data-ttu-id="bea9c-174">Nu vill du titta på objektet i metaversum.</span><span class="sxs-lookup"><span data-stu-id="bea9c-174">You now want to look at the object in the metaverse.</span></span>
2. <span data-ttu-id="bea9c-175">**Förhandsgranskning och fullständig synkronisering på ett objekt**</span><span class="sxs-lookup"><span data-stu-id="bea9c-175">**Preview and full sync on a single object**</span></span>  
   <span data-ttu-id="bea9c-176">Välj **kopplingar** längst upp.</span><span class="sxs-lookup"><span data-stu-id="bea9c-176">Select **Connectors** at the top.</span></span> <span data-ttu-id="bea9c-177">Identifiera kopplingen du har gjort en ändring i föregående avsnitt i det här fallet Active Directory Domain Services och markera den.</span><span class="sxs-lookup"><span data-stu-id="bea9c-177">Identify the Connector you made a change to in the previous section, in this case the Active Directory Domain Services, and select it.</span></span> <span data-ttu-id="bea9c-178">Välj **söka Anslutarplats**.</span><span class="sxs-lookup"><span data-stu-id="bea9c-178">Select **Search Connector Space**.</span></span> <span data-ttu-id="bea9c-179">Använd scope för att hitta ett objekt som du vill använda för att testa ändringen.</span><span class="sxs-lookup"><span data-stu-id="bea9c-179">Use scope to find an object you want to use to test the change.</span></span> <span data-ttu-id="bea9c-180">Markera objektet och klicka på **Preview**.</span><span class="sxs-lookup"><span data-stu-id="bea9c-180">Select the object and click **Preview**.</span></span> <span data-ttu-id="bea9c-181">I det nya fönstret Välj **genomför Preview**.</span><span class="sxs-lookup"><span data-stu-id="bea9c-181">In the new screen, select **Commit Preview**.</span></span>  
   <span data-ttu-id="bea9c-182">![Genomför preview](./media/active-directory-aadconnectsync-change-the-configuration/commitpreview.png)</span><span class="sxs-lookup"><span data-stu-id="bea9c-182">![Commit preview](./media/active-directory-aadconnectsync-change-the-configuration/commitpreview.png)</span></span>  
   <span data-ttu-id="bea9c-183">Ändringen genomförs nu till metaversum.</span><span class="sxs-lookup"><span data-stu-id="bea9c-183">The change is now committed to the metaverse.</span></span>

<span data-ttu-id="bea9c-184">**Titta på objektet i metaversum**</span><span class="sxs-lookup"><span data-stu-id="bea9c-184">**Look at the object in the metaverse**</span></span>  
<span data-ttu-id="bea9c-185">Nu vill du plocka några exempel objekt för att kontrollera att värdet är förväntat och att regeln tillämpas.</span><span class="sxs-lookup"><span data-stu-id="bea9c-185">You now want to pick a few sample objects to make sure the value is expected and that the rule applied.</span></span> <span data-ttu-id="bea9c-186">Välj **metaversumsökningen** från början.</span><span class="sxs-lookup"><span data-stu-id="bea9c-186">Select **Metaverse Search** from the top.</span></span> <span data-ttu-id="bea9c-187">Lägg till eventuella filter som du behöver för att hitta relevanta objekt.</span><span class="sxs-lookup"><span data-stu-id="bea9c-187">Add any filter you need to find the relevant objects.</span></span> <span data-ttu-id="bea9c-188">Öppna ett objekt i sökresultatet.</span><span class="sxs-lookup"><span data-stu-id="bea9c-188">From the search result, open an object.</span></span> <span data-ttu-id="bea9c-189">Titta på attributvärdena och Kontrollera också i den **Sync regler** kolumn som regeln tillämpas som förväntat.</span><span class="sxs-lookup"><span data-stu-id="bea9c-189">Look at the attribute values and also verify in the **Sync Rules** column that the rule applied as expected.</span></span>  
<span data-ttu-id="bea9c-190">![Metaversumsökning](./media/active-directory-aadconnectsync-change-the-configuration/mvsearch.png)</span><span class="sxs-lookup"><span data-stu-id="bea9c-190">![Metaverse search](./media/active-directory-aadconnectsync-change-the-configuration/mvsearch.png)</span></span>  

### <a name="enable-the-scheduler"></a><span data-ttu-id="bea9c-191">Aktivera Schemaläggaren</span><span class="sxs-lookup"><span data-stu-id="bea9c-191">Enable the scheduler</span></span>
<span data-ttu-id="bea9c-192">Om allt är som förväntat, kan du aktivera Schemaläggaren igen.</span><span class="sxs-lookup"><span data-stu-id="bea9c-192">If everything is as expected, you can enable the scheduler again.</span></span> <span data-ttu-id="bea9c-193">Kör från PowerShell `Set-ADSyncScheduler -SyncCycleEnabled $true`.</span><span class="sxs-lookup"><span data-stu-id="bea9c-193">From PowerShell, run `Set-ADSyncScheduler -SyncCycleEnabled $true`.</span></span>

## <a name="other-common-attribute-flow-changes"></a><span data-ttu-id="bea9c-194">Andra vanliga flödet attributändringar</span><span class="sxs-lookup"><span data-stu-id="bea9c-194">Other common attribute flow changes</span></span>
<span data-ttu-id="bea9c-195">I föregående avsnitt beskrivs hur du gör ändringar i ett attributflöde.</span><span class="sxs-lookup"><span data-stu-id="bea9c-195">The previous section described how to make changes to an attribute flow.</span></span> <span data-ttu-id="bea9c-196">I det här avsnittet finns ytterligare exempel.</span><span class="sxs-lookup"><span data-stu-id="bea9c-196">In this section, some additional examples are provided.</span></span> <span data-ttu-id="bea9c-197">Anvisningar att skapa regeln sync förkortas, men du kan hitta fullständig stegen i föregående avsnitt.</span><span class="sxs-lookup"><span data-stu-id="bea9c-197">The steps for how to create the sync rule is abbreviated, but you can find the full steps in the previous section.</span></span>

### <a name="use-another-attribute-than-the-default"></a><span data-ttu-id="bea9c-198">Använd ett annat attribut än standardvärdet</span><span class="sxs-lookup"><span data-stu-id="bea9c-198">Use another attribute than the default</span></span>
<span data-ttu-id="bea9c-199">Det finns en skog där lokala alfabetet används för förnamn, efternamn och namn på Fabrikam.</span><span class="sxs-lookup"><span data-stu-id="bea9c-199">At Fabrikam, there is a forest where the local alphabet is used for given name, surname, and display name.</span></span> <span data-ttu-id="bea9c-200">Latinska teckenrepresentation av dessa attribut finns i tilläggsattribut.</span><span class="sxs-lookup"><span data-stu-id="bea9c-200">The Latin character representation of these attributes can be found in the extension attributes.</span></span> <span data-ttu-id="bea9c-201">När du skapar den globala adresslistan i Azure AD och Office 365 organisationen vill dessa attribut som ska användas i stället.</span><span class="sxs-lookup"><span data-stu-id="bea9c-201">When building the global address list in Azure AD and Office 365, the organization wants these attributes to be used instead.</span></span>

<span data-ttu-id="bea9c-202">Med en standardkonfiguration ett objekt från den lokala skogen som ser ut så här:</span><span class="sxs-lookup"><span data-stu-id="bea9c-202">With a default configuration, an object from the local forest looks like this:</span></span>  
![Attributflöde 1](./media/active-directory-aadconnectsync-change-the-configuration/attributeflowjp1.png)

<span data-ttu-id="bea9c-204">Om du vill skapa en regel med andra attributflöden, gör du följande:</span><span class="sxs-lookup"><span data-stu-id="bea9c-204">To create a rule with other attribute flows, do the following:</span></span>

* <span data-ttu-id="bea9c-205">Starta **Synchronization Rule Editor** från start-menyn.</span><span class="sxs-lookup"><span data-stu-id="bea9c-205">Start **Synchronization Rule Editor** from the start menu.</span></span>
* <span data-ttu-id="bea9c-206">Med **inkommande** fortfarande markerat till vänster, klicka på knappen **Lägg till ny regel**.</span><span class="sxs-lookup"><span data-stu-id="bea9c-206">With **Inbound** still selected to the left, click the button **Add new rule**.</span></span>
* <span data-ttu-id="bea9c-207">Ge regeln ett namn och beskrivning.</span><span class="sxs-lookup"><span data-stu-id="bea9c-207">Give the rule a name and description.</span></span> <span data-ttu-id="bea9c-208">Välj den lokala Active Directory och de relevanta objekttyperna.</span><span class="sxs-lookup"><span data-stu-id="bea9c-208">Select the on-premises Active Directory and the relevant object types.</span></span> <span data-ttu-id="bea9c-209">I **länktypen**väljer **ansluta**.</span><span class="sxs-lookup"><span data-stu-id="bea9c-209">In **Link Type**, select **Join**.</span></span> <span data-ttu-id="bea9c-210">Välj ett värde som inte används av en annan regel för prioritet.</span><span class="sxs-lookup"><span data-stu-id="bea9c-210">For precedence, pick a number that is not used by another rule.</span></span> <span data-ttu-id="bea9c-211">Out-of-box-regler som börjar med 100, så värdet 50 kan användas i det här exemplet.</span><span class="sxs-lookup"><span data-stu-id="bea9c-211">The out-of-box rules start with 100, so the value 50 can be used in this example.</span></span>
  <span data-ttu-id="bea9c-212">![Attributflöde 2](./media/active-directory-aadconnectsync-change-the-configuration/attributeflowjp2.png)</span><span class="sxs-lookup"><span data-stu-id="bea9c-212">![Attribute flow 2](./media/active-directory-aadconnectsync-change-the-configuration/attributeflowjp2.png)</span></span>
* <span data-ttu-id="bea9c-213">Lämna det tomt omfång (det vill säga ska gälla för alla användarobjekt i skogen).</span><span class="sxs-lookup"><span data-stu-id="bea9c-213">Leave scope empty (that is, should apply to all user objects in the forest).</span></span>
* <span data-ttu-id="bea9c-214">Lämna det tomt koppling regler (det vill säga att out-of-box regeln hanterar alla kopplingar).</span><span class="sxs-lookup"><span data-stu-id="bea9c-214">Leave join rules empty (that is, let the out-of-box rule handle any joins).</span></span>
* <span data-ttu-id="bea9c-215">Skapa följande flödena i omvandlingar:</span><span class="sxs-lookup"><span data-stu-id="bea9c-215">In Transformations, create the following flows:</span></span>  
  ![Attributflöde 3](./media/active-directory-aadconnectsync-change-the-configuration/attributeflowjp3.png)
* <span data-ttu-id="bea9c-217">Klicka på **Lägg till** spara regeln.</span><span class="sxs-lookup"><span data-stu-id="bea9c-217">Click **Add** to save the rule.</span></span>
* <span data-ttu-id="bea9c-218">Gå till **Synchronization Service Manager**.</span><span class="sxs-lookup"><span data-stu-id="bea9c-218">Go to **Synchronization Service Manager**.</span></span> <span data-ttu-id="bea9c-219">På **kopplingar**, Välj den anslutning där vi har lagt till regeln.</span><span class="sxs-lookup"><span data-stu-id="bea9c-219">On **Connectors**, select the Connector where we added the rule.</span></span> <span data-ttu-id="bea9c-220">Välj **kör**, och **fullständig synkronisering**.</span><span class="sxs-lookup"><span data-stu-id="bea9c-220">Select **Run**, and **Full Synchronization**.</span></span> <span data-ttu-id="bea9c-221">En fullständig synkronisering beräknar alla objekt med de aktuella reglerna.</span><span class="sxs-lookup"><span data-stu-id="bea9c-221">A Full Synchronization recalculates all objects using the current rules.</span></span>

<span data-ttu-id="bea9c-222">Det är resultatet för samma objekt med den här anpassade regeln:</span><span class="sxs-lookup"><span data-stu-id="bea9c-222">This is the result for the same object with this custom rule:</span></span>  
![Attributflöde 4](./media/active-directory-aadconnectsync-change-the-configuration/attributeflowjp4.png)

### <a name="length-of-attributes"></a><span data-ttu-id="bea9c-224">Längden på attribut</span><span class="sxs-lookup"><span data-stu-id="bea9c-224">Length of attributes</span></span>
<span data-ttu-id="bea9c-225">Attribut för anslutningssträngen är som standard till att indexeras och den maximala längden är 448 tecken.</span><span class="sxs-lookup"><span data-stu-id="bea9c-225">String attributes are by default set to be indexable and the maximum length is 448 characters.</span></span> <span data-ttu-id="bea9c-226">Om du arbetar med string-attribut som kan innehålla fler sedan måste du ta följande i attributflöde:</span><span class="sxs-lookup"><span data-stu-id="bea9c-226">If you are working with string attributes that might contain more, then make sure to include the following in the attribute flow:</span></span>  
`attributeName` <- `Left([attributeName],448)`

### <a name="changing-the-userprincipalsuffix"></a><span data-ttu-id="bea9c-227">Ändra userPrincipalSuffix</span><span class="sxs-lookup"><span data-stu-id="bea9c-227">Changing the userPrincipalSuffix</span></span>
<span data-ttu-id="bea9c-228">Attributet userPrincipalName i Active Directory inte alltid är känt av användarna och kanske inte är lämpligt som inloggnings-ID.</span><span class="sxs-lookup"><span data-stu-id="bea9c-228">The userPrincipalName attribute in Active Directory is not always known by the users and might not be suitable as the sign-in ID.</span></span> <span data-ttu-id="bea9c-229">I Azure AD Connect sync-installationsguiden kan välja ett annat attribut, till exempel e-post.</span><span class="sxs-lookup"><span data-stu-id="bea9c-229">The Azure AD Connect sync installation wizard allows picking a different attribute, for example mail.</span></span> <span data-ttu-id="bea9c-230">Men i vissa fall attributet måste beräknas.</span><span class="sxs-lookup"><span data-stu-id="bea9c-230">But in some cases the attribute must be calculated.</span></span> <span data-ttu-id="bea9c-231">Företaget Contoso har till exempel två Azure AD-kataloger, en för produktion och en för testning.</span><span class="sxs-lookup"><span data-stu-id="bea9c-231">For example, the company Contoso has two Azure AD directories, one for production and one for testing.</span></span> <span data-ttu-id="bea9c-232">Användare i testklienten att använda en annan suffix i inloggnings-ID.</span><span class="sxs-lookup"><span data-stu-id="bea9c-232">They want the users in their test tenant to use another suffix in the sign-in ID.</span></span>  
`userPrincipalName` <- `Word([userPrincipalName],1,"@") & "@contosotest.com"`

<span data-ttu-id="bea9c-233">Ta allt i det här uttrycket till vänster i först @-sign (Word) och sammanfoga med en fast sträng.</span><span class="sxs-lookup"><span data-stu-id="bea9c-233">In this expression, take everything left of the first @-sign (Word) and concatenate with a fixed string.</span></span>

### <a name="convert-a-multi-value-to-a-single-value"></a><span data-ttu-id="bea9c-234">Konvertera flera värden till ett enda värde</span><span class="sxs-lookup"><span data-stu-id="bea9c-234">Convert a multi-value to a single-value</span></span>
<span data-ttu-id="bea9c-235">Vissa attribut i Active Directory är flera värden i schemat, även om de letar enda värden i Active Directory-användare och datorer.</span><span class="sxs-lookup"><span data-stu-id="bea9c-235">Some attributes in Active Directory are multi-valued in the schema even though they look single valued in Active Directory Users and Computers.</span></span> <span data-ttu-id="bea9c-236">Ett exempel är Beskrivningsattributet.</span><span class="sxs-lookup"><span data-stu-id="bea9c-236">An example is the description attribute.</span></span>  
`description` <- `IIF(IsNullOrEmpty([description]),NULL,Left(Trim(Item([description],1)),448))`

<span data-ttu-id="bea9c-237">I det här uttrycket om attributet har ett värde, tar det första objektet (objekt) i attributet, ta bort inledande och avslutande blanksteg (Trim), och sedan hålla först 448 tecken (till vänster) i strängen.</span><span class="sxs-lookup"><span data-stu-id="bea9c-237">In this expression in case the attribute has a value, take the first item (Item) in the attribute, remove leading and trailing spaces (Trim), and then keep the first 448 characters (Left) in the string.</span></span>

### <a name="do-not-flow-an-attribute"></a><span data-ttu-id="bea9c-238">Flöda inte ett attribut</span><span class="sxs-lookup"><span data-stu-id="bea9c-238">Do not flow an attribute</span></span>
<span data-ttu-id="bea9c-239">Bakgrundsinformation om scenariot för det här avsnittet finns [kontrollera attributet flödet processen](active-directory-aadconnectsync-understanding-declarative-provisioning.md#control-the-attribute-flow-process).</span><span class="sxs-lookup"><span data-stu-id="bea9c-239">For background on the scenario for this section, see [Control the attribute flow process](active-directory-aadconnectsync-understanding-declarative-provisioning.md#control-the-attribute-flow-process).</span></span>

<span data-ttu-id="bea9c-240">Det finns två sätt att flöda inte ett attribut.</span><span class="sxs-lookup"><span data-stu-id="bea9c-240">There are two ways to not flow an attribute.</span></span> <span data-ttu-id="bea9c-241">Först är tillgänglig i installationsguiden och låter dig [ta bort markerade attributen](active-directory-aadconnect-get-started-custom.md#azure-ad-app-and-attribute-filtering).</span><span class="sxs-lookup"><span data-stu-id="bea9c-241">The first is available in the installation wizard and allows you to [remove selected attributes](active-directory-aadconnect-get-started-custom.md#azure-ad-app-and-attribute-filtering).</span></span> <span data-ttu-id="bea9c-242">Det här alternativet fungerar om du inte har synkroniserat attribut innan.</span><span class="sxs-lookup"><span data-stu-id="bea9c-242">This option works if you have never synchronized the attribute before.</span></span> <span data-ttu-id="bea9c-243">Om du har startat att synkronisera det här attributet och tar bort med den här funktionen kan lämnas sync motorn stannar hantera attributet och befintliga värden i Azure AD.</span><span class="sxs-lookup"><span data-stu-id="bea9c-243">However, if you have started to synchronize this attribute and later remove it with this feature, then the sync engine stops managing the attribute and the existing values are left in Azure AD.</span></span>

<span data-ttu-id="bea9c-244">Om du vill ta bort värdet för ett attribut och kontrollera att den inte flödar i framtiden måste du skapa en anpassad regel i stället.</span><span class="sxs-lookup"><span data-stu-id="bea9c-244">If you want to remove the value of an attribute and make sure it does not flow in the future, you need create a custom rule instead.</span></span>

<span data-ttu-id="bea9c-245">På Fabrikam, har vi insåg att vissa av de attribut som vi synkronisera till molnet inte får vara det.</span><span class="sxs-lookup"><span data-stu-id="bea9c-245">At Fabrikam, we have realized that some of the attributes we synchronize to the cloud should not be there.</span></span> <span data-ttu-id="bea9c-246">Vi vill se till att dessa attribut tas bort från Azure AD.</span><span class="sxs-lookup"><span data-stu-id="bea9c-246">We want to make sure these attributes are removed from Azure AD.</span></span>  
![Felaktig tilläggsattribut](./media/active-directory-aadconnectsync-change-the-configuration/badextensionattribute.png)

* <span data-ttu-id="bea9c-248">Skapa en ny regel för inkommande synkronisering och fylla i beskrivningen ![beskrivningar](./media/active-directory-aadconnectsync-change-the-configuration/syncruledescription.png)</span><span class="sxs-lookup"><span data-stu-id="bea9c-248">Create a new inbound Synchronization Rule and populate the description ![Descriptions](./media/active-directory-aadconnectsync-change-the-configuration/syncruledescription.png)</span></span>
* <span data-ttu-id="bea9c-249">Skapa attributflöden av typen **uttryck** och med källan **AuthoritativeNull**.</span><span class="sxs-lookup"><span data-stu-id="bea9c-249">Create attribute flows of type **Expression** and with the source **AuthoritativeNull**.</span></span> <span data-ttu-id="bea9c-250">Literalen **AuthoritativeNull** anger att värdet ska vara tomt i MV även om en lägre prioritet synkroniseringsregel försöker fylla värdet.</span><span class="sxs-lookup"><span data-stu-id="bea9c-250">The literal **AuthoritativeNull** indicates that the value should be empty in the MV even if a lower precedence sync rule tries to populate the value.</span></span>
  <span data-ttu-id="bea9c-251">![Omvandlingen för tilläggsattribut](./media/active-directory-aadconnectsync-change-the-configuration/syncruletransformations.png)</span><span class="sxs-lookup"><span data-stu-id="bea9c-251">![Transformation for Extension Attributes](./media/active-directory-aadconnectsync-change-the-configuration/syncruletransformations.png)</span></span>
* <span data-ttu-id="bea9c-252">Spara regeln synkronisering.</span><span class="sxs-lookup"><span data-stu-id="bea9c-252">Save the Sync Rule.</span></span> <span data-ttu-id="bea9c-253">Starta **synkroniseringstjänsten**, hitta kopplingen, väljer **kör**, och **fullständig synkronisering**.</span><span class="sxs-lookup"><span data-stu-id="bea9c-253">Start **Synchronization Service**, find the Connector, select **Run**, and **Full Synchronization**.</span></span> <span data-ttu-id="bea9c-254">Det här steget beräknar alla attributflöden.</span><span class="sxs-lookup"><span data-stu-id="bea9c-254">This step recalculates all attribute flows.</span></span>
* <span data-ttu-id="bea9c-255">Kontrollera att de avsedda ändringarna är på väg att exporteras genom att söka anslutningsplatsen.</span><span class="sxs-lookup"><span data-stu-id="bea9c-255">Verify that the intended changes are about to be exported by searching the connector space.</span></span>
  <span data-ttu-id="bea9c-256">![Stegvis ta bort](./media/active-directory-aadconnectsync-change-the-configuration/deletetobeexported.png)</span><span class="sxs-lookup"><span data-stu-id="bea9c-256">![Staged delete](./media/active-directory-aadconnectsync-change-the-configuration/deletetobeexported.png)</span></span>

## <a name="create-rules-with-powershell"></a><span data-ttu-id="bea9c-257">Skapa regler med PowerShell</span><span class="sxs-lookup"><span data-stu-id="bea9c-257">Create rules with PowerShell</span></span>
<span data-ttu-id="bea9c-258">Med hjälp av sync regeln editor fungerar bra när du har bara göra några ändringar.</span><span class="sxs-lookup"><span data-stu-id="bea9c-258">Using the sync rule editor works fine when you only have a few changes to make.</span></span> <span data-ttu-id="bea9c-259">Om du behöver göra ändringar av kan PowerShell vara ett bättre alternativ.</span><span class="sxs-lookup"><span data-stu-id="bea9c-259">If you need to make many changes, then PowerShell might be a better option.</span></span> <span data-ttu-id="bea9c-260">Vissa avancerade funktioner är bara tillgängliga med PowerShell.</span><span class="sxs-lookup"><span data-stu-id="bea9c-260">Some advanced features are only available with PowerShell.</span></span>

### <a name="get-the-powershell-script-for-an-out-of-box-rule"></a><span data-ttu-id="bea9c-261">Hämta PowerShell-skriptet för en out-of-box-regel</span><span class="sxs-lookup"><span data-stu-id="bea9c-261">Get the PowerShell script for an out-of-box rule</span></span>
<span data-ttu-id="bea9c-262">Se PowerShell-skript som skapats av en regel för out-of-box, väljer du regeln i Redigeraren för regler för synkronisering och klicka på **exportera**.</span><span class="sxs-lookup"><span data-stu-id="bea9c-262">To see the PowerShell script that created an out-of-box rule, select the rule in the sync rules editor and click **Export**.</span></span> <span data-ttu-id="bea9c-263">Den här åtgärden ger PowerShell-skript som skapade regeln.</span><span class="sxs-lookup"><span data-stu-id="bea9c-263">This action gives you the PowerShell script that created the rule.</span></span>

### <a name="advanced-precedence"></a><span data-ttu-id="bea9c-264">Avancerade prioritet</span><span class="sxs-lookup"><span data-stu-id="bea9c-264">Advanced precedence</span></span>
<span data-ttu-id="bea9c-265">Regler för synkronisering av out-of-box börja med högre prioriteringsvärdet 100.</span><span class="sxs-lookup"><span data-stu-id="bea9c-265">The out-of-box sync rules start with a precedence value of 100.</span></span> <span data-ttu-id="bea9c-266">Om du har många skogar och du behöver göra många anpassade ändringar sedan kanske 99 sync regler inte finns tillräckligt med.</span><span class="sxs-lookup"><span data-stu-id="bea9c-266">If you have many forests and you need to make many custom changes, then 99 sync rules might not be enough.</span></span>

<span data-ttu-id="bea9c-267">Du kan instruera Synkroniseringsmotorn som du vill att ytterligare regler som infogas innan out-of-box-regler.</span><span class="sxs-lookup"><span data-stu-id="bea9c-267">You can instruct the Sync Engine that you want additional rules inserted before the out-of-box rules.</span></span> <span data-ttu-id="bea9c-268">Följ dessa steg för att få det här problemet:</span><span class="sxs-lookup"><span data-stu-id="bea9c-268">To get this behavior, follow these steps:</span></span>

1. <span data-ttu-id="bea9c-269">Markera den första regeln i out-of-box sync (den här regeln är den **i från AD-användare ansluta**) i Redigeraren för synkronisering av regeln och välj **exportera**.</span><span class="sxs-lookup"><span data-stu-id="bea9c-269">Mark the first out-of-box sync rule (this rule is the **In from AD-User Join**) in the sync rule editor and select **Export**.</span></span> <span data-ttu-id="bea9c-270">Kopiera värdet SR identifierare.</span><span class="sxs-lookup"><span data-stu-id="bea9c-270">Copy the SR Identifier value.</span></span>  
<span data-ttu-id="bea9c-271">![PowerShell före ändringen](./media/active-directory-aadconnectsync-change-the-configuration/powershell1.png)</span><span class="sxs-lookup"><span data-stu-id="bea9c-271">![PowerShell before change](./media/active-directory-aadconnectsync-change-the-configuration/powershell1.png)</span></span>  
2. <span data-ttu-id="bea9c-272">Skapa ny synkroniseringsregel.</span><span class="sxs-lookup"><span data-stu-id="bea9c-272">Create the new sync rule.</span></span> <span data-ttu-id="bea9c-273">Du kan använda redigeraren för regel för synkronisering för att skapa den.</span><span class="sxs-lookup"><span data-stu-id="bea9c-273">You can use the sync rule editor to create it.</span></span> <span data-ttu-id="bea9c-274">Exportera regeln till ett PowerShell-skript.</span><span class="sxs-lookup"><span data-stu-id="bea9c-274">Export the rule to a PowerShell script.</span></span>
3. <span data-ttu-id="bea9c-275">I egenskapen **PrecedenceBefore**, infoga ID-värde från regeln för out-of-box.</span><span class="sxs-lookup"><span data-stu-id="bea9c-275">In the property **PrecedenceBefore**, insert the identifier value from the out-of-box rule.</span></span> <span data-ttu-id="bea9c-276">Ange den **prioritet** till **0**.</span><span class="sxs-lookup"><span data-stu-id="bea9c-276">Set the **Precedence** to **0**.</span></span> <span data-ttu-id="bea9c-277">Kontrollera att attributet ID är unikt och du inte återanvänder en GUID från en annan regel.</span><span class="sxs-lookup"><span data-stu-id="bea9c-277">Make sure the Identifier attribute is unique and you are not reusing a GUID from another rule.</span></span> <span data-ttu-id="bea9c-278">Också kontrollera att den **ImmutableTag** anges inte egenskapen; den här egenskapen får endast anges för en out-of-box-regel.</span><span class="sxs-lookup"><span data-stu-id="bea9c-278">Also make sure that the **ImmutableTag** property is not set; this property should only be set for an out-of-box rule.</span></span> <span data-ttu-id="bea9c-279">Spara PowerShell-skriptet och kör den.</span><span class="sxs-lookup"><span data-stu-id="bea9c-279">Save the PowerShell script and run it.</span></span> <span data-ttu-id="bea9c-280">Resultatet är att en anpassad regel är tilldelad prioritet värde på 100 och alla andra regler i out-of-box ökas.</span><span class="sxs-lookup"><span data-stu-id="bea9c-280">The result is that your custom rule is assigned the precedence value of 100 and all other out-of-box rules are incremented.</span></span>  
<span data-ttu-id="bea9c-281">![PowerShell efter ändring](./media/active-directory-aadconnectsync-change-the-configuration/powershell2.png)</span><span class="sxs-lookup"><span data-stu-id="bea9c-281">![PowerShell after change](./media/active-directory-aadconnectsync-change-the-configuration/powershell2.png)</span></span>  

<span data-ttu-id="bea9c-282">Du kan ha många anpassade sync-regler som använder samma **PrecedenceBefore** värdet vid behov.</span><span class="sxs-lookup"><span data-stu-id="bea9c-282">You can have many custom sync rules using the same **PrecedenceBefore** value when needed.</span></span>


## <a name="enable-synchronization-of-preferreddatalocation"></a><span data-ttu-id="bea9c-283">Aktivera synkroniseringen av PreferredDataLocation</span><span class="sxs-lookup"><span data-stu-id="bea9c-283">Enable synchronization of PreferredDataLocation</span></span>
<span data-ttu-id="bea9c-284">Azure AD Connect har stöd för synkronisering av den **PreferredDataLocation** attribut för **användaren** objekt i version 1.1.524.0 och efter.</span><span class="sxs-lookup"><span data-stu-id="bea9c-284">Azure AD Connect supports synchronization of the **PreferredDataLocation** attribute for **User** objects in version 1.1.524.0 and after.</span></span> <span data-ttu-id="bea9c-285">Följande ändringar har införts mer specifikt:</span><span class="sxs-lookup"><span data-stu-id="bea9c-285">More specifically, following changes have been introduced:</span></span>

* <span data-ttu-id="bea9c-286">Schemat för objekttypen **användaren** i Azure AD-koppling har utökats för att inkludera PreferredDataLocation attribut som är av typen string och enkelvärdesattribut.</span><span class="sxs-lookup"><span data-stu-id="bea9c-286">The schema of the object type **User** in the Azure AD Connector is extended to include PreferredDataLocation attribute, which is of type string and is single-valued.</span></span>

* <span data-ttu-id="bea9c-287">Schemat för objekttypen **Person** i metaversum utökas för att inkludera PreferredDataLocation attribut som är av typen string och enkelvärdesattribut.</span><span class="sxs-lookup"><span data-stu-id="bea9c-287">The schema of the object type **Person** in the Metaverse is extended to include PreferredDataLocation attribute, which is of type string and is single-valued.</span></span>

<span data-ttu-id="bea9c-288">Som standard aktiveras inte attributet PreferredDataLocation för synkronisering eftersom det inte finns något motsvarande attribut för PreferredDataLocation i lokala Active Directory.</span><span class="sxs-lookup"><span data-stu-id="bea9c-288">By default, the PreferredDataLocation attribute is not enabled for synchronization because there is no corresponding PreferredDataLocation attribute in on-premises Active Directory.</span></span> <span data-ttu-id="bea9c-289">Du måste manuellt Aktivera synkronisering.</span><span class="sxs-lookup"><span data-stu-id="bea9c-289">You must manually enable synchronization.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="bea9c-290">Azure AD kan för närvarande attributet PreferredDataLocation på både synkroniserade objekt och i molnet användaren objekt för att vara direkt konfigureras med Azure AD PowerShell.</span><span class="sxs-lookup"><span data-stu-id="bea9c-290">Currently, Azure AD allows the PreferredDataLocation attribute on both synchronized User objects and cloud User objects to be directly configured using Azure AD PowerShell.</span></span> <span data-ttu-id="bea9c-291">När du har aktiverat synkronisering av attributet PreferredDataLocation, måste du sluta använda Azure AD PowerShell för att konfigurera attributet på **synkroniseras användarobjekt** som Azure AD Connect åsidosätter dem baserat på käll-attributvärden i lokala Active Directory.</span><span class="sxs-lookup"><span data-stu-id="bea9c-291">Once you have enabled synchronization of the PreferredDataLocation attribute, you must stop using Azure AD PowerShell to configure the attribute on **synchronized User objects** as Azure AD Connect will override them based on the source attribute values in on-premises Active Directory.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="bea9c-292">I September 1 2017, Azure AD inte längre att tillåta attributet PreferredDataLocation på **synkroniseras användarobjekt** konfigureras direkt med hjälp av Azure AD PowerShell.</span><span class="sxs-lookup"><span data-stu-id="bea9c-292">On September 1 2017, Azure AD will no longer allow the PreferredDataLocation attribute on **synchronized User objects** to be directly configured using Azure AD PowerShell.</span></span> <span data-ttu-id="bea9c-293">Om du vill konfigurera PreferredLocation attribut synkroniserade objekt, måste du använda Azure AD Connect endast.</span><span class="sxs-lookup"><span data-stu-id="bea9c-293">To configure PreferredLocation attribute on synchronized User objects, you must use Azure AD Connect only.</span></span>

<span data-ttu-id="bea9c-294">Innan du aktiverar synkronisering av attributet PreferredDataLocation, måste du:</span><span class="sxs-lookup"><span data-stu-id="bea9c-294">Before enabling synchronization of the PreferredDataLocation attribute, you must:</span></span>

 * <span data-ttu-id="bea9c-295">Bestäm vilka lokala Active Directory-attribut som ska användas som källattributet först.</span><span class="sxs-lookup"><span data-stu-id="bea9c-295">First, decide which on-premises Active Directory attribute to be used as the source attribute.</span></span> <span data-ttu-id="bea9c-296">Det ska vara av typen **sträng** och **enstaka**.</span><span class="sxs-lookup"><span data-stu-id="bea9c-296">It should be of type **string** and is **single-valued**.</span></span>

 * <span data-ttu-id="bea9c-297">Om du tidigare har konfigurerat attributet PreferredDataLocation på befintliga synkroniseras användarobjekt i Azure AD med hjälp av Azure AD PowerShell, måste du **backport** attributvärden till motsvarande användarobjekt i lokala Active Directory.</span><span class="sxs-lookup"><span data-stu-id="bea9c-297">If you have previously configured the PreferredDataLocation attribute on existing synchronized User objects in Azure AD using Azure AD PowerShell, you must **backport** the attribute values to the corresponding User objects in on-premises Active Directory.</span></span>
 
    > [!IMPORTANT]
    > <span data-ttu-id="bea9c-298">Om du gör inte backport attributvärden till motsvarande användarobjekt i lokala Active Directory, tar Azure AD Connect bort de befintliga attributvärdena i Azure AD när synkronisering för attributet PreferredDataLocation har aktiverats.</span><span class="sxs-lookup"><span data-stu-id="bea9c-298">If you do not backport the attribute values to the corresponding User objects in on-premises Active Directory, Azure AD Connect will remove the existing attribute values in Azure AD when synchronization for the PreferredDataLocation attribute is enabled.</span></span>

 * <span data-ttu-id="bea9c-299">Bör du konfigurera källattributet på minst några lokala AD-användare objekt nu, som kan användas för verifiering senare.</span><span class="sxs-lookup"><span data-stu-id="bea9c-299">It is recommended you configure the source attribute on at least a couple of on-premises AD User objects now, which can be used for verification later.</span></span>
 
<span data-ttu-id="bea9c-300">Stegen för att aktivera synkronisering för attributet PreferredDataLocation kan sammanfattas som:</span><span class="sxs-lookup"><span data-stu-id="bea9c-300">The steps to enable synchronization of the PreferredDataLocation attribute can be summarized as:</span></span>

1. <span data-ttu-id="bea9c-301">Inaktivera sync scheduler och kontrollera att det finns ingen synkronisering pågår</span><span class="sxs-lookup"><span data-stu-id="bea9c-301">Disable sync scheduler and verify there is no synchronization in progress</span></span>

2. <span data-ttu-id="bea9c-302">Lägg till källattributet för lokalt AD-koppling schema</span><span class="sxs-lookup"><span data-stu-id="bea9c-302">Add the source attribute to the on-premises AD Connector schema</span></span>

3. <span data-ttu-id="bea9c-303">Lägga till PreferredDataLocation i Azure AD Connector-schema</span><span class="sxs-lookup"><span data-stu-id="bea9c-303">Add PreferredDataLocation to the Azure AD Connector schema</span></span>

4. <span data-ttu-id="bea9c-304">Skapa en regel för inkommande synkronisering för att flöda attributvärdet från lokala Active Directory</span><span class="sxs-lookup"><span data-stu-id="bea9c-304">Create an inbound synchronization rule to flow the attribute value from on-premises Active Directory</span></span>

5. <span data-ttu-id="bea9c-305">Skapa en synkroniseringsregel för utgående för att flöda attributvärdet till Azure AD</span><span class="sxs-lookup"><span data-stu-id="bea9c-305">Create an outbound synchronization rule to flow the attribute value to Azure AD</span></span>

6. <span data-ttu-id="bea9c-306">Kör fullständig synkroniseringscykel</span><span class="sxs-lookup"><span data-stu-id="bea9c-306">Run Full Synchronization cycle</span></span>

7. <span data-ttu-id="bea9c-307">Aktivera sync scheduler</span><span class="sxs-lookup"><span data-stu-id="bea9c-307">Enable sync scheduler</span></span>

> [!NOTE]
> <span data-ttu-id="bea9c-308">Resten av det här avsnittet beskriver de här stegen i information.</span><span class="sxs-lookup"><span data-stu-id="bea9c-308">The rest of this section covers these steps in details.</span></span> <span data-ttu-id="bea9c-309">De beskrivs i kontexten för en Azure AD-distribution med en skog topologi och utan anpassade Synkroniseringsregler.</span><span class="sxs-lookup"><span data-stu-id="bea9c-309">They are described in the context of an Azure AD deployment with single-forest topology and without custom synchronization rules.</span></span> <span data-ttu-id="bea9c-310">Om du har flera skogar topologi anpassade Synkroniseringsregler konfigurerats eller har en fristående server, måste du anpassa stegen i enlighet med detta.</span><span class="sxs-lookup"><span data-stu-id="bea9c-310">If you have multi-forest topology, custom synchronization rules configured or have a staging server, you need to adjust the steps accordingly.</span></span>

### <a name="step-1-disable-sync-scheduler-and-verify-there-is-no-synchronization-in-progress"></a><span data-ttu-id="bea9c-311">Steg 1: Inaktivera sync scheduler och kontrollera att det finns ingen synkronisering pågår</span><span class="sxs-lookup"><span data-stu-id="bea9c-311">Step 1: Disable sync scheduler and verify there is no synchronization in progress</span></span>
<span data-ttu-id="bea9c-312">Kontrollera sker ingen synkronisering när du arbetar på att uppdatera Synkroniseringsregler för att undvika oväntade ändringar exporteras till Azure AD.</span><span class="sxs-lookup"><span data-stu-id="bea9c-312">Ensure no synchronization takes place while you are in the middle of updating synchronization rules to avoid unintended changes being exported to Azure AD.</span></span> <span data-ttu-id="bea9c-313">Inaktivera inbyggda sync scheduler:</span><span class="sxs-lookup"><span data-stu-id="bea9c-313">To disable the built-in sync scheduler:</span></span>

 1. <span data-ttu-id="bea9c-314">Starta PowerShell-session på Azure AD Connect-servern.</span><span class="sxs-lookup"><span data-stu-id="bea9c-314">Start PowerShell session on the Azure AD Connect server.</span></span>

 2. <span data-ttu-id="bea9c-315">Inaktivera schemalagda synkroniseringen genom att köra cmdlet:`Set-ADSyncScheduler -SyncCycleEnabled $false`</span><span class="sxs-lookup"><span data-stu-id="bea9c-315">Disable scheduled synchronization by running cmdlet: `Set-ADSyncScheduler -SyncCycleEnabled $false`</span></span>
 
 3. <span data-ttu-id="bea9c-316">Starta den **Synchronization Service Manager** genom att gå till START → synkroniseringstjänsten.</span><span class="sxs-lookup"><span data-stu-id="bea9c-316">Start the **Synchronization Service Manager** by going to START → Synchronization Service.</span></span>
 
 4. <span data-ttu-id="bea9c-317">Gå till den **Operations** fliken och bekräfta att ingen åtgärd vars status är *”pågår”.*</span><span class="sxs-lookup"><span data-stu-id="bea9c-317">Go to the **Operations** tab and confirm there is no operation whose status is *“in progress.”*</span></span>

![Synchronization Service Manager - Kontrollera att inga åtgärder pågår](./media/active-directory-aadconnectsync-change-the-configuration/preferredDataLocation-step1.png)

### <a name="step-2-add-the-source-attribute-to-the-on-premises-ad-connector-schema"></a><span data-ttu-id="bea9c-319">Steg 2: Lägg till källattributet för lokalt AD-koppling schema</span><span class="sxs-lookup"><span data-stu-id="bea9c-319">Step 2: Add the source attribute to the on-premises AD Connector schema</span></span>
<span data-ttu-id="bea9c-320">Inte alla AD-attribut har importerats till lokalt AD-anslutningsplatsen.</span><span class="sxs-lookup"><span data-stu-id="bea9c-320">Not all AD attributes are imported into the on-premises AD Connector Space.</span></span> <span data-ttu-id="bea9c-321">Lägga till källattributet i listan över importerade attribut:</span><span class="sxs-lookup"><span data-stu-id="bea9c-321">To add the source attribute to the list of the imported attributes:</span></span>

 1. <span data-ttu-id="bea9c-322">Gå till den **kopplingar** fliken i hanteraren för synkroniseringstjänsten.</span><span class="sxs-lookup"><span data-stu-id="bea9c-322">Go to the **Connectors** tab in the Synchronization Service Manager.</span></span>
 
 2. <span data-ttu-id="bea9c-323">Högerklicka på den **lokala AD-koppling** och välj **egenskaper**.</span><span class="sxs-lookup"><span data-stu-id="bea9c-323">Right-click on the **on-premises AD Connector** and select **Properties**.</span></span>
 
 3. <span data-ttu-id="bea9c-324">I popup-fönstret, går du till den **Välj attribut** fliken.</span><span class="sxs-lookup"><span data-stu-id="bea9c-324">In the pop-up dialog, go to the **Select Attributes** tab.</span></span>
 
 4. <span data-ttu-id="bea9c-325">Kontrollera att källattributet är markerat i attributlistan.</span><span class="sxs-lookup"><span data-stu-id="bea9c-325">Make sure the source attribute is checked in the attribute list.</span></span>
 
 5. <span data-ttu-id="bea9c-326">Klicka på **OK** att spara.</span><span class="sxs-lookup"><span data-stu-id="bea9c-326">Click **OK** to save.</span></span>

![Lägg till källattributet i lokala AD-koppling schema](./media/active-directory-aadconnectsync-change-the-configuration/preferredDataLocation-step2.png)

### <a name="step-3-add-preferreddatalocation-to-the-azure-ad-connector-schema"></a><span data-ttu-id="bea9c-328">Steg 3: Lägga till PreferredDataLocation i Azure AD Connector-schema</span><span class="sxs-lookup"><span data-stu-id="bea9c-328">Step 3: Add PreferredDataLocation to the Azure AD Connector schema</span></span>
<span data-ttu-id="bea9c-329">Som standard är PreferredDataLocation attributet inte importerad till Azure AD Connect utrymme.</span><span class="sxs-lookup"><span data-stu-id="bea9c-329">By default, the PreferredDataLocation attribute is not imported into the Azure AD Connect Space.</span></span> <span data-ttu-id="bea9c-330">Lägga till attributet PreferredDataLocation i listan över importerade attribut:</span><span class="sxs-lookup"><span data-stu-id="bea9c-330">To add the PreferredDataLocation attribute to the list of imported attributes:</span></span>

 1. <span data-ttu-id="bea9c-331">Gå till den **kopplingar** fliken i hanteraren för synkroniseringstjänsten.</span><span class="sxs-lookup"><span data-stu-id="bea9c-331">Go to the **Connectors** tab in the Synchronization Service Manager.</span></span>

 2. <span data-ttu-id="bea9c-332">Högerklicka på den **Azure AD Connector** och välj **egenskaper**.</span><span class="sxs-lookup"><span data-stu-id="bea9c-332">Right-click on the **Azure AD Connector** and select **Properties**.</span></span>

 3. <span data-ttu-id="bea9c-333">I popup-fönstret, går du till den **Välj attribut** fliken.</span><span class="sxs-lookup"><span data-stu-id="bea9c-333">In the pop-up dialog, go to the **Select Attributes** tab.</span></span>

 4. <span data-ttu-id="bea9c-334">Kontrollera att attributet PreferredDataLocation är markerat i attributlistan.</span><span class="sxs-lookup"><span data-stu-id="bea9c-334">Make sure the PreferredDataLocation attribute is checked in the attribute list.</span></span>

 5. <span data-ttu-id="bea9c-335">Klicka på **OK** att spara.</span><span class="sxs-lookup"><span data-stu-id="bea9c-335">Click **OK** to save.</span></span>

![Lägga till källattributet Azure AD Connector-schema](./media/active-directory-aadconnectsync-change-the-configuration/preferredDataLocation-step3.png)

### <a name="step-4-create-an-inbound-synchronization-rule-to-flow-the-attribute-value-from-on-premises-active-directory"></a><span data-ttu-id="bea9c-337">Steg 4: Skapa en regel för inkommande synkronisering för att flöda attributvärdet från lokala Active Directory</span><span class="sxs-lookup"><span data-stu-id="bea9c-337">Step 4: Create an inbound synchronization rule to flow the attribute value from on-premises Active Directory</span></span>
<span data-ttu-id="bea9c-338">Regel för inkommande synkronisering tillåter attributvärdet som ska flödas från källattributet från lokala Active Directory för metaversum:</span><span class="sxs-lookup"><span data-stu-id="bea9c-338">The inbound synchronization rule permits the attribute value to flow from the source attribute from on-premises Active Directory to the Metaverse:</span></span>

1. <span data-ttu-id="bea9c-339">Starta den **Synchronization regler Editor** genom att gå till START → Synchronization regler Editor.</span><span class="sxs-lookup"><span data-stu-id="bea9c-339">Start the **Synchronization Rules Editor** by going to START → Synchronization Rules Editor.</span></span>

2. <span data-ttu-id="bea9c-340">Ange sökfilter **riktning** ska **inkommande**.</span><span class="sxs-lookup"><span data-stu-id="bea9c-340">Set the search filter **Direction** to be **Inbound**.</span></span>

3. <span data-ttu-id="bea9c-341">Klicka på **Lägg till ny regel** för att skapa en ny inkommande regel.</span><span class="sxs-lookup"><span data-stu-id="bea9c-341">Click **Add new rule** button to create a new inbound rule.</span></span>

4. <span data-ttu-id="bea9c-342">Under den **beskrivning** fliken, ange följande konfiguration:</span><span class="sxs-lookup"><span data-stu-id="bea9c-342">Under the **Description** tab, provide the following configuration:</span></span>
 
    | <span data-ttu-id="bea9c-343">Attribut</span><span class="sxs-lookup"><span data-stu-id="bea9c-343">Attribute</span></span> | <span data-ttu-id="bea9c-344">Värde</span><span class="sxs-lookup"><span data-stu-id="bea9c-344">Value</span></span> | <span data-ttu-id="bea9c-345">Information</span><span class="sxs-lookup"><span data-stu-id="bea9c-345">Details</span></span> |
    | --- | --- | --- |
    | <span data-ttu-id="bea9c-346">Namn</span><span class="sxs-lookup"><span data-stu-id="bea9c-346">Name</span></span> | <span data-ttu-id="bea9c-347">*Ange ett namn*</span><span class="sxs-lookup"><span data-stu-id="bea9c-347">*Provide a name*</span></span> | <span data-ttu-id="bea9c-348">Till exempel *”i från AD-användaren PreferredDataLocation”*</span><span class="sxs-lookup"><span data-stu-id="bea9c-348">For example, *“In from AD – User PreferredDataLocation”*</span></span> |
    | <span data-ttu-id="bea9c-349">Beskrivning</span><span class="sxs-lookup"><span data-stu-id="bea9c-349">Description</span></span> | <span data-ttu-id="bea9c-350">*Ange en beskrivning*</span><span class="sxs-lookup"><span data-stu-id="bea9c-350">*Provide a description*</span></span> |  |
    | <span data-ttu-id="bea9c-351">Det anslutna systemet</span><span class="sxs-lookup"><span data-stu-id="bea9c-351">Connected System</span></span> | <span data-ttu-id="bea9c-352">*Välj lokalt AD-koppling*</span><span class="sxs-lookup"><span data-stu-id="bea9c-352">*Pick the on-premises AD connector*</span></span> |  |
    | <span data-ttu-id="bea9c-353">Anslutna System objekttyp</span><span class="sxs-lookup"><span data-stu-id="bea9c-353">Connected System Object Type</span></span> | <span data-ttu-id="bea9c-354">**Användaren**</span><span class="sxs-lookup"><span data-stu-id="bea9c-354">**User**</span></span> |  |
    | <span data-ttu-id="bea9c-355">Typ av Metaversumobjekt</span><span class="sxs-lookup"><span data-stu-id="bea9c-355">Metaverse Object Type</span></span> | <span data-ttu-id="bea9c-356">**Person**</span><span class="sxs-lookup"><span data-stu-id="bea9c-356">**Person**</span></span> |  |
    | <span data-ttu-id="bea9c-357">Länktypen</span><span class="sxs-lookup"><span data-stu-id="bea9c-357">Link Type</span></span> | <span data-ttu-id="bea9c-358">**Anslut dig**</span><span class="sxs-lookup"><span data-stu-id="bea9c-358">**Join**</span></span> |  |
    | <span data-ttu-id="bea9c-359">Prioritet</span><span class="sxs-lookup"><span data-stu-id="bea9c-359">Precedence</span></span> | <span data-ttu-id="bea9c-360">*Välj ett tal mellan 1 – 99*</span><span class="sxs-lookup"><span data-stu-id="bea9c-360">*Choose a number between 1 – 99*</span></span> | <span data-ttu-id="bea9c-361">1 – 99 är reserverat för synkronisering av anpassade regler.</span><span class="sxs-lookup"><span data-stu-id="bea9c-361">1 – 99 is reserved for custom sync rules.</span></span> <span data-ttu-id="bea9c-362">Välj inte ett värde som används av en annan regel för synkronisering.</span><span class="sxs-lookup"><span data-stu-id="bea9c-362">Do not pick a value that is used by another synchronization rule.</span></span> |

5. <span data-ttu-id="bea9c-363">Gå till den **Scoping filter** fliken och Lägg till en **målgrupp filter grupp med följande sats**:</span><span class="sxs-lookup"><span data-stu-id="bea9c-363">Go to the **Scoping filter** tab and add a **single scoping filter group with the following clause**:</span></span>
 
    | <span data-ttu-id="bea9c-364">Attribut</span><span class="sxs-lookup"><span data-stu-id="bea9c-364">Attribute</span></span> | <span data-ttu-id="bea9c-365">Operatorn</span><span class="sxs-lookup"><span data-stu-id="bea9c-365">Operator</span></span> | <span data-ttu-id="bea9c-366">Värde</span><span class="sxs-lookup"><span data-stu-id="bea9c-366">Value</span></span> |
    | --- | --- | --- |
    | <span data-ttu-id="bea9c-367">administratörsbeskrivning</span><span class="sxs-lookup"><span data-stu-id="bea9c-367">adminDescription</span></span> | <span data-ttu-id="bea9c-368">NOTSTARTWITH</span><span class="sxs-lookup"><span data-stu-id="bea9c-368">NOTSTARTWITH</span></span> | <span data-ttu-id="bea9c-369">Användaren\_</span><span class="sxs-lookup"><span data-stu-id="bea9c-369">User\_</span></span> | 
 
    <span data-ttu-id="bea9c-370">Målgrupp filter avgör vilka lokala AD-objekt den här regeln för inkommande synkronisering tillämpas på.</span><span class="sxs-lookup"><span data-stu-id="bea9c-370">Scoping filter determines which on-premises AD objects this inbound synchronization rule is applied to.</span></span> <span data-ttu-id="bea9c-371">I det här exemplet använder vi samma målgrupp filter som används som *”i från AD-användaren gemensamma”* OOB synkroniseringsregeln, vilket förhindrar att synkroniseringsregeln tillämpas på objekt som skapas via funktionen för tillbakaskrivning av Azure AD-användare.</span><span class="sxs-lookup"><span data-stu-id="bea9c-371">In this example, we use the same scoping filter used as *“In from AD – User Common”* OOB synchronization rule, which prevents the synchronization rule from being applied to User objects created through Azure AD User writeback feature.</span></span> <span data-ttu-id="bea9c-372">Du kan behöva justera filtret målgrupp enligt din Azure AD Connect-distribution.</span><span class="sxs-lookup"><span data-stu-id="bea9c-372">You may need to tweak the scoping filter according to your Azure AD Connect deployment.</span></span>

6. <span data-ttu-id="bea9c-373">Gå till den **omvandling fliken** och implementera följande omvandlingsregeln:</span><span class="sxs-lookup"><span data-stu-id="bea9c-373">Go to the **Transformation tab** and implement the following transformation rule:</span></span>
 
    | <span data-ttu-id="bea9c-374">Flöde</span><span class="sxs-lookup"><span data-stu-id="bea9c-374">Flow Type</span></span> | <span data-ttu-id="bea9c-375">Målattribut</span><span class="sxs-lookup"><span data-stu-id="bea9c-375">Target Attribute</span></span> | <span data-ttu-id="bea9c-376">Källa</span><span class="sxs-lookup"><span data-stu-id="bea9c-376">Source</span></span> | <span data-ttu-id="bea9c-377">Använda en gång</span><span class="sxs-lookup"><span data-stu-id="bea9c-377">Apply Once</span></span> | <span data-ttu-id="bea9c-378">Kopplingstyp</span><span class="sxs-lookup"><span data-stu-id="bea9c-378">Merge Type</span></span> |
    | --- | --- | --- | --- | --- |
    | <span data-ttu-id="bea9c-379">Direkt</span><span class="sxs-lookup"><span data-stu-id="bea9c-379">Direct</span></span> | <span data-ttu-id="bea9c-380">PreferredDataLocation</span><span class="sxs-lookup"><span data-stu-id="bea9c-380">PreferredDataLocation</span></span> | <span data-ttu-id="bea9c-381">Välj källattributet</span><span class="sxs-lookup"><span data-stu-id="bea9c-381">Pick the source attribute</span></span> | <span data-ttu-id="bea9c-382">Alternativet är avmarkerat</span><span class="sxs-lookup"><span data-stu-id="bea9c-382">Unchecked</span></span> | <span data-ttu-id="bea9c-383">Uppdatering</span><span class="sxs-lookup"><span data-stu-id="bea9c-383">Update</span></span> |

7. <span data-ttu-id="bea9c-384">Klicka på **Lägg till** att skapa regel för inkommande trafik.</span><span class="sxs-lookup"><span data-stu-id="bea9c-384">Click **Add** to create the inbound rule.</span></span>

![Skapa regel för inkommande synkronisering](./media/active-directory-aadconnectsync-change-the-configuration/preferredDataLocation-step4.png)

### <a name="step-5-create-an-outbound-synchronization-rule-to-flow-the-attribute-value-to-azure-ad"></a><span data-ttu-id="bea9c-386">Steg 5: Skapa en regel för utgående synkronisering för att flöda attributvärdet till Azure AD</span><span class="sxs-lookup"><span data-stu-id="bea9c-386">Step 5: Create an outbound synchronization rule to flow the attribute value to Azure AD</span></span>
<span data-ttu-id="bea9c-387">Utgående synkroniseringsregel tillåter attributvärdet som ska flödas från Metaversumsökning till attributet PreferredDataLocation i Azure AD:</span><span class="sxs-lookup"><span data-stu-id="bea9c-387">The outbound synchronization rule permits the attribute value to flow from the Metaverse to the PreferredDataLocation attribute in Azure AD:</span></span>

1. <span data-ttu-id="bea9c-388">Gå till den **Synkroniseringsregler** Editor.</span><span class="sxs-lookup"><span data-stu-id="bea9c-388">Go to the **Synchronization Rules** Editor.</span></span>

2. <span data-ttu-id="bea9c-389">Ange sökfilter **riktning** ska **utgående**.</span><span class="sxs-lookup"><span data-stu-id="bea9c-389">Set the search filter **Direction** to be **Outbound**.</span></span>

3. <span data-ttu-id="bea9c-390">Klicka på **Lägg till ny regel** knappen.</span><span class="sxs-lookup"><span data-stu-id="bea9c-390">Click **Add new rule** button.</span></span>

4. <span data-ttu-id="bea9c-391">Under den **beskrivning** fliken, ange följande konfiguration:</span><span class="sxs-lookup"><span data-stu-id="bea9c-391">Under the **Description** tab, provide the following configuration:</span></span>

    | <span data-ttu-id="bea9c-392">Attribut</span><span class="sxs-lookup"><span data-stu-id="bea9c-392">Attribute</span></span> | <span data-ttu-id="bea9c-393">Värde</span><span class="sxs-lookup"><span data-stu-id="bea9c-393">Value</span></span> | <span data-ttu-id="bea9c-394">Information</span><span class="sxs-lookup"><span data-stu-id="bea9c-394">Details</span></span> |
    | --- | --- | --- |
    | <span data-ttu-id="bea9c-395">Namn</span><span class="sxs-lookup"><span data-stu-id="bea9c-395">Name</span></span> | <span data-ttu-id="bea9c-396">*Ange ett namn*</span><span class="sxs-lookup"><span data-stu-id="bea9c-396">*Provide a name*</span></span> | <span data-ttu-id="bea9c-397">Till exempel ”ut till AAD – användaren PreferredDataLocation”</span><span class="sxs-lookup"><span data-stu-id="bea9c-397">For example, “Out to AAD – User PreferredDataLocation”</span></span> |
    | <span data-ttu-id="bea9c-398">Beskrivning</span><span class="sxs-lookup"><span data-stu-id="bea9c-398">Description</span></span> | <span data-ttu-id="bea9c-399">*Ange en beskrivning*</span><span class="sxs-lookup"><span data-stu-id="bea9c-399">*Provide a description*</span></span> |
    | <span data-ttu-id="bea9c-400">Det anslutna systemet</span><span class="sxs-lookup"><span data-stu-id="bea9c-400">Connected System</span></span> | <span data-ttu-id="bea9c-401">*Välj den AAD-kopplingen*</span><span class="sxs-lookup"><span data-stu-id="bea9c-401">*Select the AAD connector*</span></span> |
    | <span data-ttu-id="bea9c-402">Anslutna System objekttyp</span><span class="sxs-lookup"><span data-stu-id="bea9c-402">Connected System Object Type</span></span> | <span data-ttu-id="bea9c-403">Användare</span><span class="sxs-lookup"><span data-stu-id="bea9c-403">User</span></span> ||
    | <span data-ttu-id="bea9c-404">Typ av Metaversumobjekt</span><span class="sxs-lookup"><span data-stu-id="bea9c-404">Metaverse Object Type</span></span> | <span data-ttu-id="bea9c-405">**Person**</span><span class="sxs-lookup"><span data-stu-id="bea9c-405">**Person**</span></span> ||
    | <span data-ttu-id="bea9c-406">Länktypen</span><span class="sxs-lookup"><span data-stu-id="bea9c-406">Link Type</span></span> | <span data-ttu-id="bea9c-407">**Anslut dig**</span><span class="sxs-lookup"><span data-stu-id="bea9c-407">**Join**</span></span> ||
    | <span data-ttu-id="bea9c-408">Prioritet</span><span class="sxs-lookup"><span data-stu-id="bea9c-408">Precedence</span></span> | <span data-ttu-id="bea9c-409">*Välj ett tal mellan 1 – 99*</span><span class="sxs-lookup"><span data-stu-id="bea9c-409">*Choose a number between 1 – 99*</span></span> | <span data-ttu-id="bea9c-410">1 – 99 är reserverat för synkronisering av anpassade regler.</span><span class="sxs-lookup"><span data-stu-id="bea9c-410">1 – 99 is reserved for custom sync rules.</span></span> <span data-ttu-id="bea9c-411">YDo inte hämtar ett värde som används av en annan regel för synkronisering.</span><span class="sxs-lookup"><span data-stu-id="bea9c-411">YDo not pick a value that is used by another synchronization rule.</span></span> |

5. <span data-ttu-id="bea9c-412">Gå till den **Scoping filter** fliken och Lägg till en **målgrupp filter grupp med två klausuler**:</span><span class="sxs-lookup"><span data-stu-id="bea9c-412">Go to the **Scoping filter** tab and add a **single scoping filter group with two clauses**:</span></span>
 
    | <span data-ttu-id="bea9c-413">Attribut</span><span class="sxs-lookup"><span data-stu-id="bea9c-413">Attribute</span></span> | <span data-ttu-id="bea9c-414">Operatorn</span><span class="sxs-lookup"><span data-stu-id="bea9c-414">Operator</span></span> | <span data-ttu-id="bea9c-415">Värde</span><span class="sxs-lookup"><span data-stu-id="bea9c-415">Value</span></span> |
    | --- | --- | --- |
    | <span data-ttu-id="bea9c-416">sourceObjectType</span><span class="sxs-lookup"><span data-stu-id="bea9c-416">sourceObjectType</span></span> | <span data-ttu-id="bea9c-417">LIKA MED</span><span class="sxs-lookup"><span data-stu-id="bea9c-417">EQUAL</span></span> | <span data-ttu-id="bea9c-418">Användare</span><span class="sxs-lookup"><span data-stu-id="bea9c-418">User</span></span> |
    | <span data-ttu-id="bea9c-419">cloudMastered</span><span class="sxs-lookup"><span data-stu-id="bea9c-419">cloudMastered</span></span> | <span data-ttu-id="bea9c-420">NOTEQUAL</span><span class="sxs-lookup"><span data-stu-id="bea9c-420">NOTEQUAL</span></span> | <span data-ttu-id="bea9c-421">True</span><span class="sxs-lookup"><span data-stu-id="bea9c-421">True</span></span> |

    <span data-ttu-id="bea9c-422">Målgrupp filter avgör vilka Azure AD-objekt den här utgående synkroniseringsregeln tillämpas på.</span><span class="sxs-lookup"><span data-stu-id="bea9c-422">Scoping filter determines which Azure AD objects this outbound synchronization rule is applied to.</span></span> <span data-ttu-id="bea9c-423">I det här exemplet använder vi ”Out till AD-användaridentitet” samma målgrupp filtret OOB synkroniseringsregeln.</span><span class="sxs-lookup"><span data-stu-id="bea9c-423">In this example, we use the same scoping filter from “Out to AD – User Identity” OOB synchronization rule.</span></span> <span data-ttu-id="bea9c-424">Det förhindrar att synkroniseringsregeln tillämpas på objekt som inte synkroniseras från lokala Active Directory.</span><span class="sxs-lookup"><span data-stu-id="bea9c-424">It prevents the synchronization rule from being applied to User objects which are not synchronized from on-premises Active Directory.</span></span> <span data-ttu-id="bea9c-425">Du kan behöva justera filtret målgrupp enligt din Azure AD Connect-distribution.</span><span class="sxs-lookup"><span data-stu-id="bea9c-425">You may need to tweak the scoping filter according to your Azure AD Connect deployment.</span></span>
    
6. <span data-ttu-id="bea9c-426">Gå till den **omvandling** fliken och implementera följande omvandlingsregeln:</span><span class="sxs-lookup"><span data-stu-id="bea9c-426">Go to the **Transformation** tab and implement the following transformation rule:</span></span>

    | <span data-ttu-id="bea9c-427">Flöde</span><span class="sxs-lookup"><span data-stu-id="bea9c-427">Flow Type</span></span> | <span data-ttu-id="bea9c-428">Målattribut</span><span class="sxs-lookup"><span data-stu-id="bea9c-428">Target Attribute</span></span> | <span data-ttu-id="bea9c-429">Källa</span><span class="sxs-lookup"><span data-stu-id="bea9c-429">Source</span></span> | <span data-ttu-id="bea9c-430">Använda en gång</span><span class="sxs-lookup"><span data-stu-id="bea9c-430">Apply Once</span></span> | <span data-ttu-id="bea9c-431">Kopplingstyp</span><span class="sxs-lookup"><span data-stu-id="bea9c-431">Merge Type</span></span> |
    | --- | --- | --- | --- | --- |
    | <span data-ttu-id="bea9c-432">Direkt</span><span class="sxs-lookup"><span data-stu-id="bea9c-432">Direct</span></span> | <span data-ttu-id="bea9c-433">PreferredDataLocation</span><span class="sxs-lookup"><span data-stu-id="bea9c-433">PreferredDataLocation</span></span> | <span data-ttu-id="bea9c-434">PreferredDataLocation</span><span class="sxs-lookup"><span data-stu-id="bea9c-434">PreferredDataLocation</span></span> | <span data-ttu-id="bea9c-435">Alternativet är avmarkerat</span><span class="sxs-lookup"><span data-stu-id="bea9c-435">Unchecked</span></span> | <span data-ttu-id="bea9c-436">Uppdatering</span><span class="sxs-lookup"><span data-stu-id="bea9c-436">Update</span></span> |

7. <span data-ttu-id="bea9c-437">Stäng **Lägg till** att skapa regel för utgående trafik.</span><span class="sxs-lookup"><span data-stu-id="bea9c-437">Close **Add** to create the outbound rule.</span></span>

![Skapa regel för utgående synkronisering](./media/active-directory-aadconnectsync-change-the-configuration/preferredDataLocation-step5.png)

### <a name="step-6-run-full-synchronization-cycle"></a><span data-ttu-id="bea9c-439">Steg 6: Kör fullständig synkroniseringscykel</span><span class="sxs-lookup"><span data-stu-id="bea9c-439">Step 6: Run Full Synchronization cycle</span></span>
<span data-ttu-id="bea9c-440">I allmänhet fullständig synkroniseringscykel krävs eftersom vi har lagt till nya attribut i både AD och Azure AD Connector schemat och introducerades anpassade Synkroniseringsregler.</span><span class="sxs-lookup"><span data-stu-id="bea9c-440">In general, full synchronization cycle is required since we have added new attributes to both the AD and Azure AD Connector schema, and introduced custom synchronization rules.</span></span> <span data-ttu-id="bea9c-441">Vi rekommenderar att du kontrollerar ändringarna innan du exporterar dem till Azure AD.</span><span class="sxs-lookup"><span data-stu-id="bea9c-441">It is recommended that you verify the changes before exporting them to Azure AD.</span></span> <span data-ttu-id="bea9c-442">Du kan använda följande steg för att bekräfta ändringarna när du kör de steg som utgör en fullständig synkroniseringscykel manuellt.</span><span class="sxs-lookup"><span data-stu-id="bea9c-442">You can use the following steps to verify the changes while manually running the steps that make up a full synchronization cycle.</span></span> 

1. <span data-ttu-id="bea9c-443">Kör **fullständig import** steg på den **lokala AD-koppling**:</span><span class="sxs-lookup"><span data-stu-id="bea9c-443">Run **Full import** step on the **on-premises AD Connector**:</span></span>

   1. <span data-ttu-id="bea9c-444">Gå till den **Operations** fliken i hanteraren för synkroniseringstjänsten.</span><span class="sxs-lookup"><span data-stu-id="bea9c-444">Go to the **Operations** tab in the Synchronization Service Manager.</span></span>

   2. <span data-ttu-id="bea9c-445">Högerklicka på den **lokala AD-koppling** och välj **kör...**</span><span class="sxs-lookup"><span data-stu-id="bea9c-445">Right-click on the **on-premises AD Connector** and select **Run...**</span></span>

   3. <span data-ttu-id="bea9c-446">I popup-fönstret väljer **fullständig Import** och på **OK**.</span><span class="sxs-lookup"><span data-stu-id="bea9c-446">In the pop-up dialog, select **Full Import** and click **OK**.</span></span>
    
   4. <span data-ttu-id="bea9c-447">Vänta tills åtgärden har slutförts.</span><span class="sxs-lookup"><span data-stu-id="bea9c-447">Wait for operation to complete.</span></span>

    > [!NOTE]
    > <span data-ttu-id="bea9c-448">Du kan hoppa över fullständig Import på lokalt AD-koppling om källattributet ingår redan i listan över importerade attribut.</span><span class="sxs-lookup"><span data-stu-id="bea9c-448">You can skip Full Import on the on-premises AD Connector if the source attribute is already included in the list of imported attributes.</span></span> <span data-ttu-id="bea9c-449">Med andra ord du inte behöver göra några ändringar under [steg 2: Lägg till källattributet för lokalt AD-koppling schemat](#step-2-add-the-source-attribute-to-the-on-premises-ad-connector-schema).</span><span class="sxs-lookup"><span data-stu-id="bea9c-449">In other words, you did not have to make any change during [Step 2: Add the source attribute to the on-premises AD Connector schema](#step-2-add-the-source-attribute-to-the-on-premises-ad-connector-schema).</span></span>

2. <span data-ttu-id="bea9c-450">Kör **fullständig import** steg på den **Azure AD Connector**:</span><span class="sxs-lookup"><span data-stu-id="bea9c-450">Run **Full import** step on the **Azure AD Connector**:</span></span>

   1. <span data-ttu-id="bea9c-451">Högerklicka på den **Azure AD Connector** och välj **kör...**</span><span class="sxs-lookup"><span data-stu-id="bea9c-451">Right-click on the **Azure AD Connector** and select **Run...**</span></span>

   2. <span data-ttu-id="bea9c-452">I popup-fönstret väljer **fullständig Import** och på **OK**.</span><span class="sxs-lookup"><span data-stu-id="bea9c-452">In the pop-up dialog, select **Full Import** and click **OK**.</span></span>
   
   3. <span data-ttu-id="bea9c-453">Vänta tills åtgärden har slutförts.</span><span class="sxs-lookup"><span data-stu-id="bea9c-453">Wait for operation to complete.</span></span>

3. <span data-ttu-id="bea9c-454">Kontrollera synkronisering regeländringar på ett befintligt användarobjekt:</span><span class="sxs-lookup"><span data-stu-id="bea9c-454">Verify the synchronization rule changes on an existing User object:</span></span>

<span data-ttu-id="bea9c-455">Källattribut från en lokal Active Directory och PreferredDataLocation från Azure AD har importerats till området respektive anslutningen.</span><span class="sxs-lookup"><span data-stu-id="bea9c-455">The source attribute from on-premises Active Directory and PreferredDataLocation from Azure AD have been imported into the respective Connecter Space.</span></span> <span data-ttu-id="bea9c-456">Innan du fortsätter med fullständig synkronisering steg, bör du göra en **Preview** på en befintlig användares objekt i lokalt AD-anslutningsplatsen.</span><span class="sxs-lookup"><span data-stu-id="bea9c-456">Before proceeding with Full Synchronization step, it is recommended that you do a **Preview** on an existing User object in the on-premises AD Connector Space.</span></span> <span data-ttu-id="bea9c-457">Det objekt du valt bör ha källattributet fylls i.</span><span class="sxs-lookup"><span data-stu-id="bea9c-457">The object you picked should have the source attribute populated.</span></span> <span data-ttu-id="bea9c-458">En lyckad **Preview** med PreferredDataLocation i metaversum är en bra indikator som du har konfigurerat synkronisering regler på rätt sätt.</span><span class="sxs-lookup"><span data-stu-id="bea9c-458">A successful **Preview** with the PreferredDataLocation populated in the Metaverse is a good indicator that you have configured the synchronization rules correctly.</span></span> <span data-ttu-id="bea9c-459">Information om hur du gör en **Preview**, läser du avsnittet [bekräfta ändringen](#verify-the-change).</span><span class="sxs-lookup"><span data-stu-id="bea9c-459">For information about how to do a **Preview**, refer to section [Verify the change](#verify-the-change).</span></span>

4. <span data-ttu-id="bea9c-460">Kör **fullständig synkronisering** steg på den **lokala AD-koppling**:</span><span class="sxs-lookup"><span data-stu-id="bea9c-460">Run **Full Synchronization** step on the **on-premises AD Connector**:</span></span>

   1. <span data-ttu-id="bea9c-461">Högerklicka på den **lokala AD-koppling** och välj **kör...**</span><span class="sxs-lookup"><span data-stu-id="bea9c-461">Right-click on the **on-premises AD Connector** and select **Run...**</span></span>
  
   2. <span data-ttu-id="bea9c-462">I popup-fönstret väljer **fullständig synkronisering** och på **OK**.</span><span class="sxs-lookup"><span data-stu-id="bea9c-462">In the pop-up dialog, select **Full Synchronization** and click **OK**.</span></span>
   
   3. <span data-ttu-id="bea9c-463">Vänta tills åtgärden har slutförts.</span><span class="sxs-lookup"><span data-stu-id="bea9c-463">Wait for operation to complete.</span></span>

5. <span data-ttu-id="bea9c-464">Kontrollera **väntande exporter** till Azure AD:</span><span class="sxs-lookup"><span data-stu-id="bea9c-464">Verify **Pending Exports** to Azure AD:</span></span>

   1. <span data-ttu-id="bea9c-465">Högerklicka på den **Azure AD Connector** och välj **söka Anslutarplats**.</span><span class="sxs-lookup"><span data-stu-id="bea9c-465">Right-click on the **Azure AD Connector** and select **Search Connector Space**.</span></span>

   2. <span data-ttu-id="bea9c-466">I dialogrutan Sök anslutningsplatsen popup:</span><span class="sxs-lookup"><span data-stu-id="bea9c-466">In the Search Connector Space pop-up dialog:</span></span>

      1. <span data-ttu-id="bea9c-467">Ange **omfång** till **väntande Export**.</span><span class="sxs-lookup"><span data-stu-id="bea9c-467">Set **Scope** to **Pending Export**.</span></span>
      
      2. <span data-ttu-id="bea9c-468">Markera alla tre kryssrutorna, inklusive **lägga till, ändra och ta bort**.</span><span class="sxs-lookup"><span data-stu-id="bea9c-468">Check all three checkboxes, including **Add, Modify, and Delete**.</span></span>
      
      3. <span data-ttu-id="bea9c-469">Klicka på den **Sök** för att få en lista med objekt med ändringar som ska exporteras.</span><span class="sxs-lookup"><span data-stu-id="bea9c-469">Click the **Search** button to get the list of objects with changes to be exported.</span></span> <span data-ttu-id="bea9c-470">Dubbelklicka på objektet om du vill granska ändringarna för ett angivet objekt.</span><span class="sxs-lookup"><span data-stu-id="bea9c-470">To examine the changes for a given object, double-click the object.</span></span>
      
      4. <span data-ttu-id="bea9c-471">Kontrollera ändringarna förväntas.</span><span class="sxs-lookup"><span data-stu-id="bea9c-471">Verify the changes are expected.</span></span>

6. <span data-ttu-id="bea9c-472">Kör **exportera** steg på den **Azure AD-koppling**</span><span class="sxs-lookup"><span data-stu-id="bea9c-472">Run **Export** step on the **Azure AD Connector**</span></span>
      
   1. <span data-ttu-id="bea9c-473">Högerklicka på den **Azure AD Connector** och välj **kör...**</span><span class="sxs-lookup"><span data-stu-id="bea9c-473">Right-click the **Azure AD Connector** and select **Run...**</span></span>
   
   2. <span data-ttu-id="bea9c-474">Välj i dialogrutan Kör Connector popup- **exportera** och på **OK**.</span><span class="sxs-lookup"><span data-stu-id="bea9c-474">In the Run Connector pop-up dialog, select **Export** and click **OK**.</span></span>
   
   3. <span data-ttu-id="bea9c-475">Vänta tills exporten till Azure AD för att slutföra.</span><span class="sxs-lookup"><span data-stu-id="bea9c-475">Wait for Export to Azure AD to complete.</span></span>

> [!NOTE]
> <span data-ttu-id="bea9c-476">Det kan hända att steg som inte innehåller den fullständiga synkroniseringen steg och Export i Azure AD Connector.</span><span class="sxs-lookup"><span data-stu-id="bea9c-476">You may notice that the steps do not include the Full Synchronization step and Export step on the Azure AD Connector.</span></span> <span data-ttu-id="bea9c-477">Steg som krävs inte eftersom attributvärdena som flödar in från lokala Active Directory till Azure AD.</span><span class="sxs-lookup"><span data-stu-id="bea9c-477">The steps are not required since the attribute values are flowing from on-premises Active Directory to Azure AD only.</span></span>

### <a name="step-7-re-enable-sync-scheduler"></a><span data-ttu-id="bea9c-478">Steg 7: Återaktivera sync scheduler</span><span class="sxs-lookup"><span data-stu-id="bea9c-478">Step 7: Re-enable sync scheduler</span></span>
<span data-ttu-id="bea9c-479">Återaktivera inbyggda sync scheduler:</span><span class="sxs-lookup"><span data-stu-id="bea9c-479">Re-enable the built-in sync scheduler:</span></span>

1. <span data-ttu-id="bea9c-480">Starta PowerShell-session.</span><span class="sxs-lookup"><span data-stu-id="bea9c-480">Start PowerShell session.</span></span>

2. <span data-ttu-id="bea9c-481">Aktivera schemalagd synkronisering igen genom att köra cmdlet:`Set-ADSyncScheduler -SyncCycleEnabled $true`</span><span class="sxs-lookup"><span data-stu-id="bea9c-481">Re-enable scheduled synchronization by running cmdlet: `Set-ADSyncScheduler -SyncCycleEnabled $true`</span></span>



## <a name="next-steps"></a><span data-ttu-id="bea9c-482">Nästa steg</span><span class="sxs-lookup"><span data-stu-id="bea9c-482">Next steps</span></span>
* <span data-ttu-id="bea9c-483">Läs mer om Konfigurationsmodell i [förstå deklarativ etablering](active-directory-aadconnectsync-understanding-declarative-provisioning.md).</span><span class="sxs-lookup"><span data-stu-id="bea9c-483">Read more about the configuration model in [Understanding Declarative Provisioning](active-directory-aadconnectsync-understanding-declarative-provisioning.md).</span></span>
* <span data-ttu-id="bea9c-484">Läs mer om Uttrycksspråk i [förstå uttryck för deklarativ etablering](active-directory-aadconnectsync-understanding-declarative-provisioning-expressions.md).</span><span class="sxs-lookup"><span data-stu-id="bea9c-484">Read more about the expression language in [Understanding Declarative Provisioning Expressions](active-directory-aadconnectsync-understanding-declarative-provisioning-expressions.md).</span></span>

<span data-ttu-id="bea9c-485">**Översiktsavsnitt**</span><span class="sxs-lookup"><span data-stu-id="bea9c-485">**Overview topics**</span></span>

* [<span data-ttu-id="bea9c-486">Azure AD Connect-synkronisering: Förstå och anpassa synkronisering</span><span class="sxs-lookup"><span data-stu-id="bea9c-486">Azure AD Connect sync: Understand and customize synchronization</span></span>](active-directory-aadconnectsync-whatis.md)
* [<span data-ttu-id="bea9c-487">Integrera dina lokala identiteter med Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="bea9c-487">Integrating your on-premises identities with Azure Active Directory</span></span>](active-directory-aadconnect.md)
