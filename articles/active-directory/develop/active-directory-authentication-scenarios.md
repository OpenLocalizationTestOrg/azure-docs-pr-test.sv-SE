---
title: "aaaAuthentication scenarier för Azure AD | Microsoft Docs"
description: "En översikt över hello fem vanligaste autentiseringsscenarier för Azure Active Directory (AAD)"
services: active-directory
documentationcenter: dev-center-name
author: skwan
manager: mbaldwin
editor: 
ms.assetid: 0c84e7d0-16aa-4897-82f2-f53c6c990fd9
ms.service: active-directory
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: identity
ms.date: 04/27/2017
ms.author: skwan
ms.custom: aaddev
ms.openlocfilehash: 5b391e3f096fcb52934c4a8aff08688352bfd3dc
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 10/06/2017
---
# <a name="authentication-scenarios-for-azure-ad"></a><span data-ttu-id="6defd-103">Autentiseringsscenarier för Azure AD</span><span class="sxs-lookup"><span data-stu-id="6defd-103">Authentication Scenarios for Azure AD</span></span>
<span data-ttu-id="6defd-104">Azure Active Directory (AD Azure) förenklar autentisering för utvecklare genom att tillhandahålla identitet som en tjänst med stöd för standardiserade protokoll, till exempel OAuth 2.0 och OpenID Connect samt bibliotek med öppen källkod för olika plattformar toohelp du Börja koda snabbt.</span><span class="sxs-lookup"><span data-stu-id="6defd-104">Azure Active Directory (Azure AD) simplifies authentication for developers by providing identity as a service, with support for industry-standard protocols such as OAuth 2.0 and OpenID Connect, as well as open source libraries for different platforms toohelp you start coding quickly.</span></span> <span data-ttu-id="6defd-105">Det här dokumentet hjälper dig att du förstår hello har stöd för olika scenarier för Azure AD och visar hur tooget startas.</span><span class="sxs-lookup"><span data-stu-id="6defd-105">This document will help you understand hello various scenarios Azure AD supports and will show you how tooget started.</span></span> <span data-ttu-id="6defd-106">Den är uppdelad i hello följande avsnitt:</span><span class="sxs-lookup"><span data-stu-id="6defd-106">It’s divided into hello following sections:</span></span>

* [<span data-ttu-id="6defd-107">Grunderna för autentisering i Azure AD</span><span class="sxs-lookup"><span data-stu-id="6defd-107">Basics of Authentication in Azure AD</span></span>](#basics-of-authentication-in-azure-ad)
* [<span data-ttu-id="6defd-108">Anspråk i säkerhetstoken för Azure AD</span><span class="sxs-lookup"><span data-stu-id="6defd-108">Claims in Azure AD Security Tokens</span></span>](#claims-in-azure-ad-security-tokens)
* [<span data-ttu-id="6defd-109">Grunderna för att registrera ett program i Azure AD</span><span class="sxs-lookup"><span data-stu-id="6defd-109">Basics of Registering an Application in Azure AD</span></span>](#basics-of-registering-an-application-in-azure-ad)
* [<span data-ttu-id="6defd-110">Programtyper och scenarier</span><span class="sxs-lookup"><span data-stu-id="6defd-110">Application Types and Scenarios</span></span>](#application-types-and-scenarios)
  
  * [<span data-ttu-id="6defd-111">Web webbläsare tooWeb program</span><span class="sxs-lookup"><span data-stu-id="6defd-111">Web Browser tooWeb Application</span></span>](#web-browser-to-web-application)
  * [<span data-ttu-id="6defd-112">Sida program (SPA)</span><span class="sxs-lookup"><span data-stu-id="6defd-112">Single Page Application (SPA)</span></span>](#single-page-application-spa)
  * [<span data-ttu-id="6defd-113">Interna program tooWeb API</span><span class="sxs-lookup"><span data-stu-id="6defd-113">Native Application tooWeb API</span></span>](#native-application-to-web-api)
  * [<span data-ttu-id="6defd-114">Web Application tooWeb API</span><span class="sxs-lookup"><span data-stu-id="6defd-114">Web Application tooWeb API</span></span>](#web-application-to-web-api)
  * [<span data-ttu-id="6defd-115">Daemon eller serverprogrammet tooWeb API</span><span class="sxs-lookup"><span data-stu-id="6defd-115">Daemon or Server Application tooWeb API</span></span>](#daemon-or-server-application-to-web-api)

## <a name="basics-of-authentication-in-azure-ad"></a><span data-ttu-id="6defd-116">Grunderna för autentisering i Azure AD</span><span class="sxs-lookup"><span data-stu-id="6defd-116">Basics of Authentication in Azure AD</span></span>
<span data-ttu-id="6defd-117">Om du är bekant med grundläggande begrepp för autentisering i Azure AD kan läsa det här avsnittet.</span><span class="sxs-lookup"><span data-stu-id="6defd-117">If you are unfamiliar with basic concepts of authentication in Azure AD, read this section.</span></span> <span data-ttu-id="6defd-118">I annat fall kanske du tooskip ned för[programtyper och scenarier](#application-types-and-scenarios).</span><span class="sxs-lookup"><span data-stu-id="6defd-118">Otherwise, you may want tooskip down too[Application Types and Scenarios](#application-types-and-scenarios).</span></span>

<span data-ttu-id="6defd-119">Nu ska vi titta hello enklaste scenariot där identitet krävs: en användare i en webbläsare behöver tooauthenticate tooa webbprogram.</span><span class="sxs-lookup"><span data-stu-id="6defd-119">Let’s consider hello most basic scenario where identity is required: a user in a web browser needs tooauthenticate tooa web application.</span></span> <span data-ttu-id="6defd-120">Det här scenariot beskrivs mer detaljerat i hello [webbläsare tooWeb programmet](#web-browser-to-web-application) avsnitt, men det är användbart när du börjar punkt tooillustrate hello funktionerna i Azure AD och få en överblick hur hello scenariot fungerar.</span><span class="sxs-lookup"><span data-stu-id="6defd-120">This scenario is described in greater detail in hello [Web Browser tooWeb Application](#web-browser-to-web-application) section, but it’s a useful starting point tooillustrate hello capabilities of Azure AD and conceptualize how hello scenario works.</span></span> <span data-ttu-id="6defd-121">Överväg följande diagram i det här scenariot hello:</span><span class="sxs-lookup"><span data-stu-id="6defd-121">Consider hello following diagram for this scenario:</span></span>

![Översikt över inloggning tooweb program](./media/active-directory-authentication-scenarios/basics_of_auth_in_aad.png)

<span data-ttu-id="6defd-123">Med hello diagrammet ovan i åtanke, här är vad du behöver tooknow om dess olika komponenter:</span><span class="sxs-lookup"><span data-stu-id="6defd-123">With hello diagram above in mind, here’s what you need tooknow about its various components:</span></span>

* <span data-ttu-id="6defd-124">Azure AD är hello identitetsleverantör, ansvarar för att verifiera hello identiteten för användare och program som finns i en organisation directory och slutligen utfärdar säkerhetstoken vid autentisering av användare och program.</span><span class="sxs-lookup"><span data-stu-id="6defd-124">Azure AD is hello identity provider, responsible for verifying hello identity of users and applications that exist in an organization’s directory, and ultimately issuing security tokens upon successful authentication of those users and applications.</span></span>
* <span data-ttu-id="6defd-125">Ett program som vill toooutsource autentisering tooAzure AD måste registreras i Azure AD, som registrerar och som unikt identifierar hello app i hello directory.</span><span class="sxs-lookup"><span data-stu-id="6defd-125">An application that wants toooutsource authentication tooAzure AD must be registered in Azure AD, which registers and uniquely identifies hello app in hello directory.</span></span>
* <span data-ttu-id="6defd-126">Utvecklare kan använda hello öppen källkod Azure AD authentication bibliotek toomake autentisering enkelt genom att hantera hello protokollet information för dig.</span><span class="sxs-lookup"><span data-stu-id="6defd-126">Developers can use hello open source Azure AD authentication libraries toomake authentication easy by handling hello protocol details for you.</span></span> <span data-ttu-id="6defd-127">Se [Azure Active Directory-Autentiseringsbibliotek](active-directory-authentication-libraries.md) för mer information.</span><span class="sxs-lookup"><span data-stu-id="6defd-127">See [Azure Active Directory Authentication Libraries](active-directory-authentication-libraries.md) for more information.</span></span>

<span data-ttu-id="6defd-128">• När en användare har autentiserats, hello programmet måste verifiera hello användarens säkerhets-token tooensure att autentiseringen lyckades för hello avsedd parter.</span><span class="sxs-lookup"><span data-stu-id="6defd-128">• Once a user has been authenticated, hello application must validate hello user’s security token tooensure that authentication was successful for hello intended parties.</span></span> <span data-ttu-id="6defd-129">Utvecklare kan använda hello tillhandahålls autentisering bibliotek toohandle validering av en token från Azure AD, inklusive token JWT (JSON Web) eller SAML 2.0.</span><span class="sxs-lookup"><span data-stu-id="6defd-129">Developers can use hello provided authentication libraries toohandle validation of any token from Azure AD, including JSON Web Tokens (JWT) or SAML 2.0.</span></span> <span data-ttu-id="6defd-130">Om du vill tooperform validering manuellt finns hello [JWT-Token hanteraren](https://msdn.microsoft.com/library/dn205065.aspx) dokumentation.</span><span class="sxs-lookup"><span data-stu-id="6defd-130">If you want tooperform validation manually, see hello [JWT Token Handler](https://msdn.microsoft.com/library/dn205065.aspx) documentation.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="6defd-131">Azure AD använder kryptering med offentlig nyckel toosign token och verifiera att de är giltiga.</span><span class="sxs-lookup"><span data-stu-id="6defd-131">Azure AD uses public key cryptography toosign tokens and verify that they are valid.</span></span> <span data-ttu-id="6defd-132">Se [viktig Information om signering nyckeln förnyelse i Azure AD](active-directory-signing-key-rollover.md) mer information om nödvändiga logiken i hello måste du ha i dina program tooensure den alltid uppdateras med senaste hello-nycklar.</span><span class="sxs-lookup"><span data-stu-id="6defd-132">See [Important Information About Signing Key Rollover in Azure AD](active-directory-signing-key-rollover.md) for more information on hello necessary logic you must have in your application tooensure it’s always updated with hello latest keys.</span></span>
> 
> 

<span data-ttu-id="6defd-133">• hello flödet av begäranden och -svar för hello autentiseringsprocessen bestäms av hello autentiseringsprotokoll som används, till exempel OAuth 2.0, OpenID Connect WS-Federation och SAML 2.0.</span><span class="sxs-lookup"><span data-stu-id="6defd-133">• hello flow of requests and responses for hello authentication process is determined by hello authentication protocol that was used, such as OAuth 2.0, OpenID Connect, WS-Federation, or SAML 2.0.</span></span> <span data-ttu-id="6defd-134">Dessa protokoll beskrivs i detalj i hello [Azure Active Directory-autentiseringsprotokoll](active-directory-authentication-protocols.md) avsnittet och i hello avsnitten nedan.</span><span class="sxs-lookup"><span data-stu-id="6defd-134">These protocols are discussed in more detail in hello [Azure Active Directory Authentication Protocols](active-directory-authentication-protocols.md) topic and in hello sections below.</span></span>

> [!NOTE]
> <span data-ttu-id="6defd-135">Azure AD stöder hello OAuth 2.0 och OpenID Connect standarder som gör omfattande använder ägar-token, inklusive ägar-token som JWTs.</span><span class="sxs-lookup"><span data-stu-id="6defd-135">Azure AD supports hello OAuth 2.0 and OpenID Connect standards that make extensive use of bearer tokens, including bearer tokens represented as JWTs.</span></span> <span data-ttu-id="6defd-136">Ett ägartoken är en förenklad säkerhetstoken som ger hello ”ägar” åtkomst tooa skyddad resurs.</span><span class="sxs-lookup"><span data-stu-id="6defd-136">A bearer token is a lightweight security token that grants hello “bearer” access tooa protected resource.</span></span> <span data-ttu-id="6defd-137">På detta sätt är hello ”ägar” någon part som kan utgöra hello-token.</span><span class="sxs-lookup"><span data-stu-id="6defd-137">In this sense, hello “bearer” is any party that can present hello token.</span></span> <span data-ttu-id="6defd-138">Även om en part måste de först autentisera med Azure AD tooreceive hello ägar-token om hello krävs åtgärder inte vidtas toosecure hello token i överföringen och lagringen, kan de snappas upp och används av en oavsiktlig part.</span><span class="sxs-lookup"><span data-stu-id="6defd-138">Though a party must first authenticate with Azure AD tooreceive hello bearer token, if hello required steps are not taken toosecure hello token in transmission and storage, it can be intercepted and used by an unintended party.</span></span> <span data-ttu-id="6defd-139">Även om vissa säkerhetstoken har en inbyggd mekanism för att förhindra att obehöriga personer använder dem, ägar-token har inte den här mekanismen och måste transporteras i en säker kanal, till exempel transport layer security (HTTPS).</span><span class="sxs-lookup"><span data-stu-id="6defd-139">While some security tokens have a built-in mechanism for preventing unauthorized parties from using them, bearer tokens do not have this mechanism and must be transported in a secure channel such as transport layer security (HTTPS).</span></span> <span data-ttu-id="6defd-140">Om ett ägartoken överförs i hello rensa, en hello man i mitten-attack kan användas av skadliga tooacquire hello-token från en och använda det för en obehörig åtkomst tooa skyddad resurs.</span><span class="sxs-lookup"><span data-stu-id="6defd-140">If a bearer token is transmitted in hello clear, a man-in hello middle attack can be used by a malicious party tooacquire hello token and use it for an unauthorized access tooa protected resource.</span></span> <span data-ttu-id="6defd-141">hello tillämpas samma säkerhetsprinciper när lagring eller cachelagring ägar-token för senare användning.</span><span class="sxs-lookup"><span data-stu-id="6defd-141">hello same security principles apply when storing or caching bearer tokens for later use.</span></span> <span data-ttu-id="6defd-142">Se alltid till att ditt program överför och lagrar ägar-token på ett säkert sätt.</span><span class="sxs-lookup"><span data-stu-id="6defd-142">Always ensure that your application transmits and stores bearer tokens in a secure manner.</span></span> <span data-ttu-id="6defd-143">Flera säkerheten på ägar-token finns [RFC 6750 avsnitt 5](http://tools.ietf.org/html/rfc6750).</span><span class="sxs-lookup"><span data-stu-id="6defd-143">For more security considerations on bearer tokens, see [RFC 6750 Section 5](http://tools.ietf.org/html/rfc6750).</span></span>
> 
> 

<span data-ttu-id="6defd-144">Nu när du har en översikt över hello grunderna, Läs hello avsnitt nedan toounderstand hur etablering fungerar i Azure AD och har stöd för vanliga scenarier för hello Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6defd-144">Now that you have an overview of hello basics, read hello sections below toounderstand how provisioning works in Azure AD and hello common scenarios Azure AD supports.</span></span>

## <a name="claims-in-azure-ad-security-tokens"></a><span data-ttu-id="6defd-145">Anspråk i säkerhetstoken för Azure AD</span><span class="sxs-lookup"><span data-stu-id="6defd-145">Claims in Azure AD Security Tokens</span></span>
<span data-ttu-id="6defd-146">Säkerhetstoken som utfärdats av Azure AD innehåller anspråk eller intyg för information om hello ämne som har verifierats.</span><span class="sxs-lookup"><span data-stu-id="6defd-146">Security tokens issued by Azure AD contain claims, or assertions of information about hello subject that has been authenticated.</span></span> <span data-ttu-id="6defd-147">Dessa anspråk kan användas av hello program för olika aktiviteter.</span><span class="sxs-lookup"><span data-stu-id="6defd-147">These claims can be used by hello application for various tasks.</span></span> <span data-ttu-id="6defd-148">Exempelvis kan de använda toovalidate hello token, identifiera hello ämne directory-klient, användarinformation, fastställa hello ämne auktorisering och så vidare.</span><span class="sxs-lookup"><span data-stu-id="6defd-148">For example, they can be used toovalidate hello token, identify hello subject's directory tenant, display user information, determine hello subject's authorization, and so on.</span></span> <span data-ttu-id="6defd-149">hello anspråk finns i alla angivna säkerhetstoken är beroende av hello typ av token, hello typ av autentiseringsuppgifter som används för tooauthenticate hello användar- och hello tillämpningsprogrammets konfiguration.</span><span class="sxs-lookup"><span data-stu-id="6defd-149">hello claims present in any given security token are dependent upon hello type of token, hello type of credential used tooauthenticate hello user, and hello application configuration.</span></span> <span data-ttu-id="6defd-150">En kort beskrivning av varje typ av anspråk som orsakat av Azure AD har angetts i hello nedan.</span><span class="sxs-lookup"><span data-stu-id="6defd-150">A brief description of each type of claim emitted by Azure AD is provided in hello table below.</span></span> <span data-ttu-id="6defd-151">Mer information finns för[stöds Token och anspråkstyper](active-directory-token-and-claims.md).</span><span class="sxs-lookup"><span data-stu-id="6defd-151">For more information, refer too[Supported Token and Claim Types](active-directory-token-and-claims.md).</span></span>

| <span data-ttu-id="6defd-152">Begär</span><span class="sxs-lookup"><span data-stu-id="6defd-152">Claim</span></span> | <span data-ttu-id="6defd-153">Beskrivning</span><span class="sxs-lookup"><span data-stu-id="6defd-153">Description</span></span> |
| --- | --- |
| <span data-ttu-id="6defd-154">Program-ID:t</span><span class="sxs-lookup"><span data-stu-id="6defd-154">Application ID</span></span> |<span data-ttu-id="6defd-155">Identifierar hello-program som använder hello-token.</span><span class="sxs-lookup"><span data-stu-id="6defd-155">Identifies hello application that is using hello token.</span></span> |
| <span data-ttu-id="6defd-156">Målgrupp</span><span class="sxs-lookup"><span data-stu-id="6defd-156">Audience</span></span> |<span data-ttu-id="6defd-157">Identifierar hello mottagande resurs hello token är avsett för.</span><span class="sxs-lookup"><span data-stu-id="6defd-157">Identifies hello recipient resource hello token is intended for.</span></span> |
| <span data-ttu-id="6defd-158">Application Authentication Context Class Reference</span><span class="sxs-lookup"><span data-stu-id="6defd-158">Application Authentication Context Class Reference</span></span> |<span data-ttu-id="6defd-159">Anger hur hello-klienten har autentiserat (offentliga klient kontra konfidentiell klienten).</span><span class="sxs-lookup"><span data-stu-id="6defd-159">Indicates how hello client was authenticated (public client vs. confidential client).</span></span> |
| <span data-ttu-id="6defd-160">Autentisering snabbmeddelanden</span><span class="sxs-lookup"><span data-stu-id="6defd-160">Authentication Instant</span></span> |<span data-ttu-id="6defd-161">Poster hello datum och tid då hello autentisering inträffade.</span><span class="sxs-lookup"><span data-stu-id="6defd-161">Records hello date and time when hello authentication occurred.</span></span> |
| <span data-ttu-id="6defd-162">Autentiseringsmetod</span><span class="sxs-lookup"><span data-stu-id="6defd-162">Authentication Method</span></span> |<span data-ttu-id="6defd-163">Anger hur hello ämnet för hello token autentiserades (lösenord, certifikat, etc.).</span><span class="sxs-lookup"><span data-stu-id="6defd-163">Indicates how hello subject of hello token was authenticated (password, certificate, etc.).</span></span> |
| <span data-ttu-id="6defd-164">Förnamn</span><span class="sxs-lookup"><span data-stu-id="6defd-164">First Name</span></span> |<span data-ttu-id="6defd-165">Ger hello förnamn hello användaren som angetts i Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6defd-165">Provides hello given name of hello user as set in Azure AD.</span></span> |
| <span data-ttu-id="6defd-166">Grupper</span><span class="sxs-lookup"><span data-stu-id="6defd-166">Groups</span></span> |<span data-ttu-id="6defd-167">Innehåller objekt-ID: N för Azure AD-grupper hello användaren är medlem i.</span><span class="sxs-lookup"><span data-stu-id="6defd-167">Contains object Ids of Azure AD groups hello user is a member of.</span></span> |
| <span data-ttu-id="6defd-168">Identitetsprovider</span><span class="sxs-lookup"><span data-stu-id="6defd-168">Identity Provider</span></span> |<span data-ttu-id="6defd-169">Poster hello identitetsleverantör som autentiserats hello ämnet för hello-token.</span><span class="sxs-lookup"><span data-stu-id="6defd-169">Records hello identity provider that authenticated hello subject of hello token.</span></span> |
| <span data-ttu-id="6defd-170">Utfärdat till</span><span class="sxs-lookup"><span data-stu-id="6defd-170">Issued At</span></span> |<span data-ttu-id="6defd-171">Poster hello tid vid vilken hello token har utfärdats, används ofta för token dokumentens.</span><span class="sxs-lookup"><span data-stu-id="6defd-171">Records hello time at which hello token was issued, often used for token freshness.</span></span> |
| <span data-ttu-id="6defd-172">Utfärdaren</span><span class="sxs-lookup"><span data-stu-id="6defd-172">Issuer</span></span> |<span data-ttu-id="6defd-173">Identifierar hello STS som orsakat hello token samt hello Azure AD-klient.</span><span class="sxs-lookup"><span data-stu-id="6defd-173">Identifies hello STS that emitted hello token as well as hello Azure AD tenant.</span></span> |
| <span data-ttu-id="6defd-174">Efternamn</span><span class="sxs-lookup"><span data-stu-id="6defd-174">Last Name</span></span> |<span data-ttu-id="6defd-175">Ger hello efternamn hello användaren som angetts i Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6defd-175">Provides hello surname of hello user as set in Azure AD.</span></span> |
| <span data-ttu-id="6defd-176">Namn</span><span class="sxs-lookup"><span data-stu-id="6defd-176">Name</span></span> |<span data-ttu-id="6defd-177">Ger en mänsklig läsbar värde som identifierar hello ämnet för hello-token.</span><span class="sxs-lookup"><span data-stu-id="6defd-177">Provides a human readable value that identifies hello subject of hello token.</span></span> |
| <span data-ttu-id="6defd-178">Objekt-Id</span><span class="sxs-lookup"><span data-stu-id="6defd-178">Object Id</span></span> |<span data-ttu-id="6defd-179">Innehåller en ändras, unik identifierare för hello ämne i Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6defd-179">Contains an immutable, unique identifier of hello subject in Azure AD.</span></span> |
| <span data-ttu-id="6defd-180">Roller</span><span class="sxs-lookup"><span data-stu-id="6defd-180">Roles</span></span> |<span data-ttu-id="6defd-181">Innehåller eget namn för roller med Azure AD-programmet hello användaren har beviljats.</span><span class="sxs-lookup"><span data-stu-id="6defd-181">Contains friendly names of Azure AD Application Roles that hello user has been granted.</span></span> |
| <span data-ttu-id="6defd-182">Omfång</span><span class="sxs-lookup"><span data-stu-id="6defd-182">Scope</span></span> |<span data-ttu-id="6defd-183">Anger hello behörigheter beviljade toohello klientprogrammet.</span><span class="sxs-lookup"><span data-stu-id="6defd-183">Indicates hello permissions granted toohello client application.</span></span> |
| <span data-ttu-id="6defd-184">Ämne</span><span class="sxs-lookup"><span data-stu-id="6defd-184">Subject</span></span> |<span data-ttu-id="6defd-185">Anger hello principal om vilka hello Assert token information.</span><span class="sxs-lookup"><span data-stu-id="6defd-185">Indicates hello principal about which hello token asserts information.</span></span> |
| <span data-ttu-id="6defd-186">Klient-Id</span><span class="sxs-lookup"><span data-stu-id="6defd-186">Tenant Id</span></span> |<span data-ttu-id="6defd-187">Innehåller inte ändras, unik identifierare för hello directory-klient som utfärdade hello-token.</span><span class="sxs-lookup"><span data-stu-id="6defd-187">Contains an immutable, unique identifier of hello directory tenant that issued hello token.</span></span> |
| <span data-ttu-id="6defd-188">Livslängd för token</span><span class="sxs-lookup"><span data-stu-id="6defd-188">Token Lifetime</span></span> |<span data-ttu-id="6defd-189">Definierar hello tidsintervall inom vilket en token är giltig.</span><span class="sxs-lookup"><span data-stu-id="6defd-189">Defines hello time interval within which a token is valid.</span></span> |
| <span data-ttu-id="6defd-190">Användarens huvudnamn</span><span class="sxs-lookup"><span data-stu-id="6defd-190">User Principal Name</span></span> |<span data-ttu-id="6defd-191">Innehåller hello användarens huvudnamn hello ämne.</span><span class="sxs-lookup"><span data-stu-id="6defd-191">Contains hello user principal name of hello subject.</span></span> |
| <span data-ttu-id="6defd-192">Version</span><span class="sxs-lookup"><span data-stu-id="6defd-192">Version</span></span> |<span data-ttu-id="6defd-193">Innehåller hello versionsnumret för hello-token.</span><span class="sxs-lookup"><span data-stu-id="6defd-193">Contains hello version number of hello token.</span></span> |

## <a name="basics-of-registering-an-application-in-azure-ad"></a><span data-ttu-id="6defd-194">Grunderna för att registrera ett program i Azure AD</span><span class="sxs-lookup"><span data-stu-id="6defd-194">Basics of Registering an Application in Azure AD</span></span>
<span data-ttu-id="6defd-195">Alla program som outsources autentisering tooAzure AD måste registreras i en katalog.</span><span class="sxs-lookup"><span data-stu-id="6defd-195">Any application that outsources authentication tooAzure AD must be registered in a directory.</span></span> <span data-ttu-id="6defd-196">Det här steget handlar om Azure AD om ditt program, inklusive hello URL där det är placerad, hello URL toosend svarar efter autentisering hello URI tooidentify ditt program och mycket mer.</span><span class="sxs-lookup"><span data-stu-id="6defd-196">This step involves telling Azure AD about your application, including hello URL where it’s located, hello URL toosend replies after authentication, hello URI tooidentify your application, and more.</span></span> <span data-ttu-id="6defd-197">Den här informationen krävs för några viktiga orsaker:</span><span class="sxs-lookup"><span data-stu-id="6defd-197">This information is required for a few key reasons:</span></span>

* <span data-ttu-id="6defd-198">Azure AD måste koordinater toocommunicate med hello program när du arbetar med inloggning eller utbyte token.</span><span class="sxs-lookup"><span data-stu-id="6defd-198">Azure AD needs coordinates toocommunicate with hello application when handling sign-on or exchanging tokens.</span></span> <span data-ttu-id="6defd-199">Dessa omfattar hello följande:</span><span class="sxs-lookup"><span data-stu-id="6defd-199">These include hello following:</span></span>
  
  * <span data-ttu-id="6defd-200">Program-ID-URI: hello identifierare för ett program.</span><span class="sxs-lookup"><span data-stu-id="6defd-200">Application ID URI: hello identifier for an application.</span></span> <span data-ttu-id="6defd-201">Det här värdet skickas tooAzure AD under autentisering tooindicate vilka programmet hello anroparen vill en token för.</span><span class="sxs-lookup"><span data-stu-id="6defd-201">This value is sent tooAzure AD during authentication tooindicate which application hello caller wants a token for.</span></span> <span data-ttu-id="6defd-202">Det här värdet ingår dessutom i hello token så att programmet hello vet var hello avsedda mål.</span><span class="sxs-lookup"><span data-stu-id="6defd-202">Additionally, this value is included in hello token so that hello application knows it was hello intended target.</span></span>
  * <span data-ttu-id="6defd-203">Svara URL och omdirigerings-URI: hello gäller en webb-API eller ett webbprogram, hello Reply URL är hello plats toowhich Azure AD att skicka hello autentiseringssvar, inklusive en token om autentiseringen lyckades.</span><span class="sxs-lookup"><span data-stu-id="6defd-203">Reply URL and Redirect URI: In hello case of a web API or web application, hello Reply URL is hello location toowhich Azure AD will send hello authentication response, including a token if authentication was successful.</span></span> <span data-ttu-id="6defd-204">I det ursprungliga programmet hello fallet hello omdirigerings-URI är en unik identifierare toowhich Azure AD att omdirigera hello användaragent i en OAuth 2.0-begäran.</span><span class="sxs-lookup"><span data-stu-id="6defd-204">In hello case of a native application, hello Redirect URI is a unique identifier toowhich Azure AD will redirect hello user-agent in an OAuth 2.0 request.</span></span>
  * <span data-ttu-id="6defd-205">Program-ID: hello ID för ett program som genereras av Azure AD när programmet hello registreras.</span><span class="sxs-lookup"><span data-stu-id="6defd-205">Application ID: hello ID for an application, which is generated by Azure AD when hello application is registered.</span></span> <span data-ttu-id="6defd-206">När du begär en Auktoriseringskoden eller token, skickas hello program-ID och nyckel tooAzure AD under autentiseringen.</span><span class="sxs-lookup"><span data-stu-id="6defd-206">When requesting an authorization code or token, hello Application ID and key are sent tooAzure AD during authentication.</span></span>
  * <span data-ttu-id="6defd-207">: Hello nyckeln som skickas tillsammans med ett program-ID vid autentisering tooAzure AD toocall webb-API.</span><span class="sxs-lookup"><span data-stu-id="6defd-207">Key: hello key that is sent along with a Application ID when authenticating tooAzure AD toocall a web API.</span></span>
* <span data-ttu-id="6defd-208">Azure AD-behov tooensure hello programmet hello behörighet tooaccess dina katalogdata, andra program i din organisation, och så vidare</span><span class="sxs-lookup"><span data-stu-id="6defd-208">Azure AD needs tooensure hello application has hello required permissions tooaccess your directory data, other applications in your organization, and so on</span></span>

<span data-ttu-id="6defd-209">Etablering blir tydligare när du förstår att det finns två typer av program som utvecklats och integrerade med Azure AD:</span><span class="sxs-lookup"><span data-stu-id="6defd-209">Provisioning becomes clearer when you understand that there are two categories of applications that can be developed and integrated with Azure AD:</span></span>

* <span data-ttu-id="6defd-210">Enkel klient program: en enskild klient-programmet är avsett att användas i en organisation.</span><span class="sxs-lookup"><span data-stu-id="6defd-210">Single tenant application: A single tenant application is intended for use in one organization.</span></span> <span data-ttu-id="6defd-211">Detta är vanligtvis line-of-business (LoB)-appar som skrivits av en enterprise-utvecklare.</span><span class="sxs-lookup"><span data-stu-id="6defd-211">These are typically line-of-business (LoB) applications written by an enterprise developer.</span></span> <span data-ttu-id="6defd-212">En enskild klient räcker toobe nås av användare i en katalog och därför kan det bara behöver toobe etableras i en katalog.</span><span class="sxs-lookup"><span data-stu-id="6defd-212">A single tenant application only needs toobe accessed by users in one directory, and as a result, it only needs toobe provisioned in one directory.</span></span> <span data-ttu-id="6defd-213">Programmen registreras vanligtvis av en utvecklare i hello organisation.</span><span class="sxs-lookup"><span data-stu-id="6defd-213">These applications are typically registered by a developer in hello organization.</span></span>
* <span data-ttu-id="6defd-214">Flera innehavare program: ett program med flera innehavare är avsedd att användas i många organisationer är inte en organisation.</span><span class="sxs-lookup"><span data-stu-id="6defd-214">Multi-tenant application: A multi-tenant application is intended for use in many organizations, not just one organization.</span></span> <span data-ttu-id="6defd-215">Detta är vanligtvis programvara som en-tjänst (SaaS)-program som skrivits av en oberoende programvaruleverantör (ISV).</span><span class="sxs-lookup"><span data-stu-id="6defd-215">These are typically software-as-a-service (SaaS) applications written by an independent software vendor (ISV).</span></span> <span data-ttu-id="6defd-216">Program med flera klienter behöver toobe etablerad på varje katalog där de kommer att användas, vilket kräver att användaren eller administratören medgivande tooregister dem.</span><span class="sxs-lookup"><span data-stu-id="6defd-216">Multi-tenant applications need toobe provisioned in each directory where they will be used, which requires user or administrator consent tooregister them.</span></span> <span data-ttu-id="6defd-217">Medgivande processen startas när ett program som har registrerats i katalogen hello och ges åtkomst toohello Graph API eller kanske en annan webb-API.</span><span class="sxs-lookup"><span data-stu-id="6defd-217">This consent process starts when an application has been registered in hello directory and is given access toohello Graph API or perhaps another web API.</span></span> <span data-ttu-id="6defd-218">När en användare eller administratör från en annan organisation loggar du in toouse hello program, visas en dialogruta som visar hello behörigheter hello programmet kräver.</span><span class="sxs-lookup"><span data-stu-id="6defd-218">When a user or administrator from a different organization signs up toouse hello application, they are presented with a dialog that displays hello permissions hello application requires.</span></span> <span data-ttu-id="6defd-219">hello användaren eller administratören kan sedan medgivande toohello programmet, vilket ger hello programmet åtkomst toohello anges data och slutligen registren hello program i deras katalog.</span><span class="sxs-lookup"><span data-stu-id="6defd-219">hello user or administrator can then consent toohello application, which gives hello application access toohello stated data, and finally registers hello application in their directory.</span></span> <span data-ttu-id="6defd-220">Mer information finns i [översikt över hello medgivande Framework](active-directory-integrating-applications.md#overview-of-the-consent-framework).</span><span class="sxs-lookup"><span data-stu-id="6defd-220">For more information, see [Overview of hello Consent Framework](active-directory-integrating-applications.md#overview-of-the-consent-framework).</span></span>

<span data-ttu-id="6defd-221">Vissa ytterligare överväganden uppstå när du utvecklar ett program med flera innehavare i stället för en enskild klient-program.</span><span class="sxs-lookup"><span data-stu-id="6defd-221">Some additional considerations arise when developing a multi-tenant application instead of a single tenant application.</span></span> <span data-ttu-id="6defd-222">Till exempel om du gör dina program tillgängliga toousers i flera kataloger, måste en mekanism toodetermine vilken de inte finns i.</span><span class="sxs-lookup"><span data-stu-id="6defd-222">For example, if you are making your application available toousers in multiple directories, you need a mechanism toodetermine which tenant they’re in.</span></span> <span data-ttu-id="6defd-223">En enskild klient programmet måste bara toolook i en egen katalog för en användare när ett program med flera innehavare behöver tooidentify en viss användare från alla hello kataloger i Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6defd-223">A single tenant application only needs toolook in its own directory for a user, while a multi-tenant application needs tooidentify a specific user from all hello directories in Azure AD.</span></span> <span data-ttu-id="6defd-224">tooaccomplish den här uppgiften Azure AD innehåller en gemensam autentisering ändpunkt där alla program med flera innehavare kan dirigera inloggning-förfrågningar, i stället för en slutpunkt för innehavare.</span><span class="sxs-lookup"><span data-stu-id="6defd-224">tooaccomplish this task, Azure AD provides a common authentication endpoint where any multi-tenant application can direct sign-in requests, instead of a tenant-specific endpoint.</span></span> <span data-ttu-id="6defd-225">Den här slutpunkten är https://login.microsoftonline.com/common för alla kataloger i Azure AD, medan en slutpunkt för klient kan vara https://login.microsoftonline.com/contoso.onmicrosoft.com. vanliga hello-slutpunkten är särskilt viktigt tooconsider när du utvecklar programmet eftersom du behöver hello nödvändiga logiken toohandle flera innehavare under inloggning, utloggning, och token validering.</span><span class="sxs-lookup"><span data-stu-id="6defd-225">This endpoint is https://login.microsoftonline.com/common for all directories in Azure AD, whereas a tenant-specific endpoint might be https://login.microsoftonline.com/contoso.onmicrosoft.com. hello common endpoint is especially important tooconsider when developing your application because you’ll need hello necessary logic toohandle multiple tenants during sign-in, sign-out, and token validation.</span></span>

<span data-ttu-id="6defd-226">Om du utvecklar för närvarande en enskild klient programmet men vill toomake den tillgängliga toomany organisationer kan du enkelt göra ändringar toohello programmet och dess konfiguration i Azure AD toomake det flera klienter som är kompatibla.</span><span class="sxs-lookup"><span data-stu-id="6defd-226">If you are currently developing a single tenant application but want toomake it available toomany organizations, you can easily make changes toohello application and its configuration in Azure AD toomake it multi-tenant capable.</span></span> <span data-ttu-id="6defd-227">Dessutom använder Azure AD hello samma signeringsnyckel för alla token i alla kataloger, om du tillhandahåller autentisering i en enskild klient eller ett program för flera innehavare.</span><span class="sxs-lookup"><span data-stu-id="6defd-227">In addition, Azure AD uses hello same signing key for all tokens in all directories, whether you are providing authentication in a single tenant or multi-tenant application.</span></span>

<span data-ttu-id="6defd-228">Varje scenario som beskrivs i det här dokumentet innehåller en del som beskriver etablering krav.</span><span class="sxs-lookup"><span data-stu-id="6defd-228">Each scenario listed in this document includes a sub-section that describes its provisioning requirements.</span></span> <span data-ttu-id="6defd-229">Mer information om ett program i Azure AD-etablering och hello skillnaderna mellan enstaka och flera innehavare program, se [integrera program med Azure Active Directory](active-directory-integrating-applications.md) för mer information.</span><span class="sxs-lookup"><span data-stu-id="6defd-229">For more in-depth information about provisioning an application in Azure AD and hello differences between single and multi-tenant applications, see [Integrating Applications with Azure Active Directory](active-directory-integrating-applications.md) for more information.</span></span> <span data-ttu-id="6defd-230">Fortsätta att läsa toounderstand hello vanliga scenarier för program i Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6defd-230">Continue reading toounderstand hello common application scenarios in Azure AD.</span></span>

## <a name="application-types-and-scenarios"></a><span data-ttu-id="6defd-231">Programtyper och scenarier</span><span class="sxs-lookup"><span data-stu-id="6defd-231">Application Types and Scenarios</span></span>
<span data-ttu-id="6defd-232">Var och en av hello-scenarier som beskrivs i det här dokumentet kan utvecklats med olika språk och plattformar.</span><span class="sxs-lookup"><span data-stu-id="6defd-232">Each of hello scenarios described in this document can be developed using various languages and platforms.</span></span> <span data-ttu-id="6defd-233">De är alla backas upp av fullständig kodexempel som är tillgängliga i vår [kodexempel guide](active-directory-code-samples.md), eller direkt från hello motsvarande [GitHub-lagringsplatser som exempel](https://github.com/Azure-Samples?utf8=%E2%9C%93&query=active-directory).</span><span class="sxs-lookup"><span data-stu-id="6defd-233">They are all backed by complete code samples which are available in our [Code Samples guide](active-directory-code-samples.md), or directly from hello corresponding [GitHub sample repositories](https://github.com/Azure-Samples?utf8=%E2%9C%93&query=active-directory).</span></span> <span data-ttu-id="6defd-234">Dessutom, om ditt program måste en viss del eller segment i ett scenario för slutpunkt till slutpunkt, kan i de flesta fall funktionen läggas oberoende av varandra.</span><span class="sxs-lookup"><span data-stu-id="6defd-234">In addition, if your application needs a specific piece or segment of an end-to-end scenario, in most cases that functionality can be added independently.</span></span> <span data-ttu-id="6defd-235">Till exempel om du har en inbyggd program som anropar ett webb-API, du kan enkelt lägga till ett webbprogram som anropar också hello webb-API.</span><span class="sxs-lookup"><span data-stu-id="6defd-235">For example, if you have a native application that calls a web API, you can easily add a web application that also calls hello web API.</span></span> <span data-ttu-id="6defd-236">hello följande diagram illustrerar dessa scenarier och programtyper, och hur olika komponenter kan läggas till:</span><span class="sxs-lookup"><span data-stu-id="6defd-236">hello following diagram illustrates these scenarios and application types, and how different components can be added:</span></span>

![Programtyper och scenarier](./media/active-directory-authentication-scenarios/application_types_and_scenarios.png)

<span data-ttu-id="6defd-238">Dessa är hello fem primära programmet scenarier som stöds av Azure AD:</span><span class="sxs-lookup"><span data-stu-id="6defd-238">These are hello five primary application scenarios supported by Azure AD:</span></span>

* <span data-ttu-id="6defd-239">[Web webbläsare tooWeb programmet](#web-browser-to-web-application): en användare behöver toosign i tooa webbprogram som skyddas av Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6defd-239">[Web Browser tooWeb Application](#web-browser-to-web-application): A user needs toosign in tooa web application that is secured by Azure AD.</span></span>
* <span data-ttu-id="6defd-240">[Enkel sida program (SPA)](#single-page-application-spa): en användare behöver toosign i tooa sida program som skyddas av Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6defd-240">[Single Page Application (SPA)](#single-page-application-spa): A user needs toosign in tooa single page application that is secured by Azure AD.</span></span>
* <span data-ttu-id="6defd-241">[Interna program tooWeb API](#native-application-to-web-api): en intern program som körs på en mobiltelefon, surfplatta eller dator måste tooauthenticate en användare tooget resurser från ett webb-API som skyddas av Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6defd-241">[Native Application tooWeb API](#native-application-to-web-api): A native application that runs on a phone, tablet, or PC needs tooauthenticate a user tooget resources from a web API that is secured by Azure AD.</span></span>
* <span data-ttu-id="6defd-242">[Webb-API för programmet tooWeb](#web-application-to-web-api): ett webbprogram måste tooget resurser från ett webb-API som skyddas av Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6defd-242">[Web Application tooWeb API](#web-application-to-web-api): A web application needs tooget resources from a web API secured by Azure AD.</span></span>
* <span data-ttu-id="6defd-243">[Daemon eller serverprogrammet tooWeb API](#daemon-or-server-application-to-web-api): en daemon-program eller ett serverprogram utan användargränssnitt för web måste tooget resurser från ett webb-API som skyddas av Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6defd-243">[Daemon or Server Application tooWeb API](#daemon-or-server-application-to-web-api): A daemon application or a server application with no web user interface needs tooget resources from a web API secured by Azure AD.</span></span>

### <a name="web-browser-tooweb-application"></a><span data-ttu-id="6defd-244">Web webbläsare tooWeb program</span><span class="sxs-lookup"><span data-stu-id="6defd-244">Web Browser tooWeb Application</span></span>
<span data-ttu-id="6defd-245">Det här avsnittet beskrivs ett program som autentiserar användare i en webbläsare tooa web webbprogram.</span><span class="sxs-lookup"><span data-stu-id="6defd-245">This section describes an application that authenticates a user in a web browser tooa web application.</span></span> <span data-ttu-id="6defd-246">I det här scenariot hello webbprogrammet leder hello användarens webbläsare toosign dem i tooAzure AD.</span><span class="sxs-lookup"><span data-stu-id="6defd-246">In this scenario, hello web application directs hello user’s browser toosign them in tooAzure AD.</span></span> <span data-ttu-id="6defd-247">Azure AD returnerar ett svar via hello användarens webbläsare, som innehåller anspråk om hello användare i en säkerhetstoken.</span><span class="sxs-lookup"><span data-stu-id="6defd-247">Azure AD returns a sign-in response through hello user’s browser, which contains claims about hello user in a security token.</span></span> <span data-ttu-id="6defd-248">Det här scenariot stöder inloggning med hello WS-Federation, SAML 2.0 och OpenID Connect protokoll.</span><span class="sxs-lookup"><span data-stu-id="6defd-248">This scenario supports sign-on using hello WS-Federation, SAML 2.0, and OpenID Connect protocols.</span></span>

#### <a name="diagram"></a><span data-ttu-id="6defd-249">Diagram</span><span class="sxs-lookup"><span data-stu-id="6defd-249">Diagram</span></span>
![Autentiseringsflödet för tooweb webbläsare](./media/active-directory-authentication-scenarios/web_browser_to_web_api.png)

#### <a name="description-of-protocol-flow"></a><span data-ttu-id="6defd-251">Beskrivning av protokollet flöde</span><span class="sxs-lookup"><span data-stu-id="6defd-251">Description of Protocol Flow</span></span>
1. <span data-ttu-id="6defd-252">När en användare besöker hello programmet och behöver toosign i, omdirigeras via en begäran om inloggning toohello autentisering slutpunkt i Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6defd-252">When a user visits hello application and needs toosign in, they are redirected via a sign-in request toohello authentication endpoint in Azure AD.</span></span>
2. <span data-ttu-id="6defd-253">hello användare loggar in på hello-inloggningssida.</span><span class="sxs-lookup"><span data-stu-id="6defd-253">hello user signs in on hello sign-in page.</span></span>
3. <span data-ttu-id="6defd-254">Om autentiseringen lyckas skapar en autentiseringstoken Azure AD och returnerar ett inloggning svar toohello program Reply-URL som konfigurerades i hello Azure-portalen.</span><span class="sxs-lookup"><span data-stu-id="6defd-254">If authentication is successful, Azure AD creates an authentication token and returns a sign-in response toohello application’s Reply URL that was configured in hello Azure Portal.</span></span> <span data-ttu-id="6defd-255">För ett produktionsprogram vara svars-URL: en HTTPS.</span><span class="sxs-lookup"><span data-stu-id="6defd-255">For a production application, this Reply URL should be HTTPS.</span></span> <span data-ttu-id="6defd-256">hello returnerade token innehåller anspråk om hello användare och Azure AD som krävs av hello program toovalidate hello-token.</span><span class="sxs-lookup"><span data-stu-id="6defd-256">hello returned token includes claims about hello user and Azure AD that are required by hello application toovalidate hello token.</span></span>
4. <span data-ttu-id="6defd-257">programmet hello verifierar hello token med hjälp av en offentlig signeringsnyckel och utfärdaren information tillgänglig vid hello federationsdokument metadata för Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6defd-257">hello application validates hello token by using a public signing key and issuer information available at hello federation metadata document for Azure AD.</span></span> <span data-ttu-id="6defd-258">När programmet hello validerar hello token, startar Azure AD en ny session med hello användare.</span><span class="sxs-lookup"><span data-stu-id="6defd-258">After hello application validates hello token, Azure AD starts a new session with hello user.</span></span> <span data-ttu-id="6defd-259">Den här sessionen kan hello användaren tooaccess hello programmet tills den förfaller.</span><span class="sxs-lookup"><span data-stu-id="6defd-259">This session allows hello user tooaccess hello application until it expires.</span></span>

#### <a name="code-samples"></a><span data-ttu-id="6defd-260">Kodexempel</span><span class="sxs-lookup"><span data-stu-id="6defd-260">Code Samples</span></span>
<span data-ttu-id="6defd-261">Se hello kodexempel för webbläsare tooWeb Programscenarier.</span><span class="sxs-lookup"><span data-stu-id="6defd-261">See hello code samples for Web Browser tooWeb Application scenarios.</span></span> <span data-ttu-id="6defd-262">Och kom tillbaka ofta--vi lägga till nya prov alla hello tid.</span><span class="sxs-lookup"><span data-stu-id="6defd-262">And, check back frequently -- we add new samples all hello time.</span></span> <span data-ttu-id="6defd-263">[Web webbläsare tooWeb programmet](active-directory-code-samples.md#web-browser-to-web-application).</span><span class="sxs-lookup"><span data-stu-id="6defd-263">[Web Browser tooWeb Application](active-directory-code-samples.md#web-browser-to-web-application).</span></span>

#### <a name="registering"></a><span data-ttu-id="6defd-264">Registrera</span><span class="sxs-lookup"><span data-stu-id="6defd-264">Registering</span></span>
* <span data-ttu-id="6defd-265">Enskild klient: Om du skapar ett program för din organisation, den måste registreras i företagets katalog med hjälp av hello Azure-portalen.</span><span class="sxs-lookup"><span data-stu-id="6defd-265">Single Tenant: If you are building an application just for your organization, it must be registered in your company’s directory by using hello Azure Portal.</span></span>
* <span data-ttu-id="6defd-266">Flera innehavare: Om du skapar ett program som kan användas av användare utanför organisationen, den måste vara registrerat i företagets katalog, men även måste registreras i varje organisations katalog som kommer att använda programmet hello.</span><span class="sxs-lookup"><span data-stu-id="6defd-266">Multi-Tenant: If you are building an application that can be used by users outside your organization, it must be registered in your company’s directory, but also must be registered in each organization’s directory that will be using hello application.</span></span> <span data-ttu-id="6defd-267">toomake programmet finns i deras katalog, du kan inkludera en registreringsprocessen för kunderna att de kan tooconsent tooyour program.</span><span class="sxs-lookup"><span data-stu-id="6defd-267">toomake your application available in their directory, you can include a sign-up process for your customers that enables them tooconsent tooyour application.</span></span> <span data-ttu-id="6defd-268">När de registrerar sig för ditt program, kommer de att visas en dialogruta som visar hello behörigheter hello programmet krävs och hello alternativet tooconsent.</span><span class="sxs-lookup"><span data-stu-id="6defd-268">When they sign up for your application, they will be presented with a dialog that shows hello permissions hello application requires, and then hello option tooconsent.</span></span> <span data-ttu-id="6defd-269">Beroende på hello krävs behörighet kan en administratör i hello andra organisationen kanske krävs toogive medgivande.</span><span class="sxs-lookup"><span data-stu-id="6defd-269">Depending on hello required permissions, an administrator in hello other organization may be required toogive consent.</span></span> <span data-ttu-id="6defd-270">När hello användaren eller administratören godkänner, registreras hello program i deras directory.</span><span class="sxs-lookup"><span data-stu-id="6defd-270">When hello user or administrator consents, hello application is registered in their directory.</span></span> <span data-ttu-id="6defd-271">Mer information finns i [integrera program med Azure Active Directory](active-directory-integrating-applications.md).</span><span class="sxs-lookup"><span data-stu-id="6defd-271">For more information, see [Integrating Applications with Azure Active Directory](active-directory-integrating-applications.md).</span></span>

#### <a name="token-expiration"></a><span data-ttu-id="6defd-272">Token upphör att gälla</span><span class="sxs-lookup"><span data-stu-id="6defd-272">Token Expiration</span></span>
<span data-ttu-id="6defd-273">hello användarens session upphör att gälla när hello livstid hello-token som utfärdas av Azure AD upphör att gälla.</span><span class="sxs-lookup"><span data-stu-id="6defd-273">hello user’s session expires when hello lifetime of hello token issued by Azure AD expires.</span></span> <span data-ttu-id="6defd-274">Programmet kan förkorta denna tidsperiod om så önskas, till exempel logga ut användare baserat på en period av inaktivitet.</span><span class="sxs-lookup"><span data-stu-id="6defd-274">Your application can shorten this time period if desired, such as signing out users based on a period of inactivity.</span></span> <span data-ttu-id="6defd-275">När hello sessionen upphör att gälla måste hello användaren ange toosign i igen.</span><span class="sxs-lookup"><span data-stu-id="6defd-275">When hello session expires, hello user will be prompted toosign in again.</span></span>

### <a name="single-page-application-spa"></a><span data-ttu-id="6defd-276">Sida program (SPA)</span><span class="sxs-lookup"><span data-stu-id="6defd-276">Single Page Application (SPA)</span></span>
<span data-ttu-id="6defd-277">Det här avsnittet beskrivs autentisering för en enda sida program som använder Azure AD och hello OAuth 2.0 implicit auktorisering bevilja toosecure dess webb-API tillbaka avslutas.</span><span class="sxs-lookup"><span data-stu-id="6defd-277">This section describes authentication for a Single Page Application, that uses Azure AD and hello OAuth 2.0 implicit authorization grant toosecure its web API back end.</span></span> <span data-ttu-id="6defd-278">Den enda sidan program är vanligtvis strukturerade som ett JavaScript presentation lager (klientdel) som körs i hello webbläsaren och en serverdel för webb-API som körs på en server och implementerar hello programmets affärslogik.</span><span class="sxs-lookup"><span data-stu-id="6defd-278">Single Page Applications are typically structured as a JavaScript presentation layer (front end) that runs in hello browser and a Web API back end that runs on a server and implements hello application’s business logic.</span></span> <span data-ttu-id="6defd-279">toolearn mer om hello implicit authorization grant och hjälper dig att du bestämmer dig för om det är bäst för ditt program scenario finns [förstå hello OAuth2 implicit bevilja flödet i Azure Active Directory](active-directory-dev-understanding-oauth2-implicit-grant.md).</span><span class="sxs-lookup"><span data-stu-id="6defd-279">toolearn more about hello implicit authorization grant, and help you decide whether it's right for your application scenario, see [Understanding hello OAuth2 implicit grant flow in Azure Active Directory](active-directory-dev-understanding-oauth2-implicit-grant.md).</span></span>

<span data-ttu-id="6defd-280">I detta scenario när hello användaren loggar in, hello JavaScript front end använder [Active Directory Authentication Library för JavaScript (ADAL. JS)](https://github.com/AzureAD/azure-activedirectory-library-for-js/tree/dev) och hello implicit auktorisering bevilja tooobtain en ID-token (id_token) från Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6defd-280">In this scenario, when hello user signs in, hello JavaScript front end uses [Active Directory Authentication Library for JavaScript (ADAL.JS)](https://github.com/AzureAD/azure-activedirectory-library-for-js/tree/dev) and hello implicit authorization grant tooobtain an ID token (id_token) from Azure AD.</span></span> <span data-ttu-id="6defd-281">hello token cachelagras och hello klienten bifogar toohello begäran som hello ägar-token när du anropar tooits Web API serverdel som skyddas med hello OWIN mellanprogram.</span><span class="sxs-lookup"><span data-stu-id="6defd-281">hello token is cached and hello client attaches it toohello request as hello bearer token when making calls tooits Web API back end, which is secured using hello OWIN middleware.</span></span> 

#### <a name="diagram"></a><span data-ttu-id="6defd-282">Diagram</span><span class="sxs-lookup"><span data-stu-id="6defd-282">Diagram</span></span>
![Den enda Page Application diagram](./media/active-directory-authentication-scenarios/single_page_app.png)

#### <a name="description-of-protocol-flow"></a><span data-ttu-id="6defd-284">Beskrivning av protokollet flöde</span><span class="sxs-lookup"><span data-stu-id="6defd-284">Description of Protocol Flow</span></span>
1. <span data-ttu-id="6defd-285">hello användaren navigerar toohello webbprogram.</span><span class="sxs-lookup"><span data-stu-id="6defd-285">hello user navigates toohello web application.</span></span>
2. <span data-ttu-id="6defd-286">hello-programmet returnerar hello JavaScript klientdelen (presentation layer) toohello webbläsare.</span><span class="sxs-lookup"><span data-stu-id="6defd-286">hello application returns hello JavaScript front end (presentation layer) toohello browser.</span></span>
3. <span data-ttu-id="6defd-287">hello användare initierar inloggning, till exempel genom att klicka på ett tecken i länken.</span><span class="sxs-lookup"><span data-stu-id="6defd-287">hello user initiates sign in, for example by clicking a sign in link.</span></span> <span data-ttu-id="6defd-288">hello webbläsaren skickar en GET toohello Azure AD auktorisering endpoint toorequest en ID-token.</span><span class="sxs-lookup"><span data-stu-id="6defd-288">hello browser sends a GET toohello Azure AD authorization endpoint toorequest an ID token.</span></span> <span data-ttu-id="6defd-289">Denna begäran innehåller hello program-ID och reply URL i frågeparametrar Hej.</span><span class="sxs-lookup"><span data-stu-id="6defd-289">This request includes hello application ID and reply URL in hello query parameters.</span></span>
4. <span data-ttu-id="6defd-290">Azure AD verifierar hello Reply URL mot hello registrerad Reply-URL som konfigurerades i hello Azure-portalen.</span><span class="sxs-lookup"><span data-stu-id="6defd-290">Azure AD validates hello Reply URL against hello registered Reply URL that was configured in hello Azure Portal.</span></span>
5. <span data-ttu-id="6defd-291">hello användare loggar in på hello-inloggningssida.</span><span class="sxs-lookup"><span data-stu-id="6defd-291">hello user signs in on hello sign-in page.</span></span>
6. <span data-ttu-id="6defd-292">Om autentiseringen lyckas skapar en ID-token Azure AD och returnerar som en URL (#)-fragmentet toohello programmets Reply-URL.</span><span class="sxs-lookup"><span data-stu-id="6defd-292">If authentication is successful, Azure AD creates an ID token and returns it as a URL fragment (#) toohello application’s Reply URL.</span></span> <span data-ttu-id="6defd-293">För ett produktionsprogram vara svars-URL: en HTTPS.</span><span class="sxs-lookup"><span data-stu-id="6defd-293">For a production application, this Reply URL should be HTTPS.</span></span> <span data-ttu-id="6defd-294">hello returnerade token innehåller anspråk om hello användare och Azure AD som krävs av hello program toovalidate hello-token.</span><span class="sxs-lookup"><span data-stu-id="6defd-294">hello returned token includes claims about hello user and Azure AD that are required by hello application toovalidate hello token.</span></span>
7. <span data-ttu-id="6defd-295">hello JavaScript klientkod som körs i hello webbläsare extraherar hello-token från hello svar toouse på säkra anrop toohello programmets web API tillbaka avslutas.</span><span class="sxs-lookup"><span data-stu-id="6defd-295">hello JavaScript client code running in hello browser extracts hello token from hello response toouse in securing calls toohello application’s web API back end.</span></span>
8. <span data-ttu-id="6defd-296">Hej webbläsare anrop hello programmets web API tillbaka avslutas med hello åtkomst-token i hello authorization-huvud.</span><span class="sxs-lookup"><span data-stu-id="6defd-296">hello browser calls hello application’s web API back end with hello access token in hello authorization header.</span></span>

#### <a name="code-samples"></a><span data-ttu-id="6defd-297">Kodexempel</span><span class="sxs-lookup"><span data-stu-id="6defd-297">Code Samples</span></span>
<span data-ttu-id="6defd-298">Se hello kodexempel för scenarier med enda sidan program (SPA).</span><span class="sxs-lookup"><span data-stu-id="6defd-298">See hello code samples for Single Page Application (SPA) scenarios.</span></span> <span data-ttu-id="6defd-299">Vara säker på att toocheck tillbaka ofta--vi lägga till nya prov alla hello tid.</span><span class="sxs-lookup"><span data-stu-id="6defd-299">Be sure toocheck back frequently -- we add new samples all hello time.</span></span> <span data-ttu-id="6defd-300">[Enkel Page Application (SPA)](active-directory-code-samples.md#single-page-application-spa).</span><span class="sxs-lookup"><span data-stu-id="6defd-300">[Single Page Application (SPA)](active-directory-code-samples.md#single-page-application-spa).</span></span>

#### <a name="registering"></a><span data-ttu-id="6defd-301">Registrera</span><span class="sxs-lookup"><span data-stu-id="6defd-301">Registering</span></span>
* <span data-ttu-id="6defd-302">Enskild klient: Om du skapar ett program för din organisation, den måste registreras i företagets katalog med hjälp av hello Azure-portalen.</span><span class="sxs-lookup"><span data-stu-id="6defd-302">Single Tenant: If you are building an application just for your organization, it must be registered in your company’s directory by using hello Azure Portal.</span></span>
* <span data-ttu-id="6defd-303">Flera innehavare: Om du skapar ett program som kan användas av användare utanför organisationen, den måste vara registrerat i företagets katalog, men även måste registreras i varje organisations katalog som kommer att använda programmet hello.</span><span class="sxs-lookup"><span data-stu-id="6defd-303">Multi-Tenant: If you are building an application that can be used by users outside your organization, it must be registered in your company’s directory, but also must be registered in each organization’s directory that will be using hello application.</span></span> <span data-ttu-id="6defd-304">toomake programmet finns i deras katalog, du kan inkludera en registreringsprocessen för kunderna att de kan tooconsent tooyour program.</span><span class="sxs-lookup"><span data-stu-id="6defd-304">toomake your application available in their directory, you can include a sign-up process for your customers that enables them tooconsent tooyour application.</span></span> <span data-ttu-id="6defd-305">När de registrerar sig för ditt program, kommer de att visas en dialogruta som visar hello behörigheter hello programmet krävs och hello alternativet tooconsent.</span><span class="sxs-lookup"><span data-stu-id="6defd-305">When they sign up for your application, they will be presented with a dialog that shows hello permissions hello application requires, and then hello option tooconsent.</span></span> <span data-ttu-id="6defd-306">Beroende på hello krävs behörighet kan en administratör i hello andra organisationen kanske krävs toogive medgivande.</span><span class="sxs-lookup"><span data-stu-id="6defd-306">Depending on hello required permissions, an administrator in hello other organization may be required toogive consent.</span></span> <span data-ttu-id="6defd-307">När hello användaren eller administratören godkänner, registreras hello program i deras directory.</span><span class="sxs-lookup"><span data-stu-id="6defd-307">When hello user or administrator consents, hello application is registered in their directory.</span></span> <span data-ttu-id="6defd-308">Mer information finns i [integrera program med Azure Active Directory](active-directory-integrating-applications.md).</span><span class="sxs-lookup"><span data-stu-id="6defd-308">For more information, see [Integrating Applications with Azure Active Directory](active-directory-integrating-applications.md).</span></span>

<span data-ttu-id="6defd-309">När du har registrerat hello programmet måste det vara konfigurerade toouse Implicit bevilja för OAuth 2.0-protokollet.</span><span class="sxs-lookup"><span data-stu-id="6defd-309">After registering hello application, it must be configured toouse OAuth 2.0 Implicit Grant protocol.</span></span> <span data-ttu-id="6defd-310">Det här protokollet är inaktiverat för program som standard.</span><span class="sxs-lookup"><span data-stu-id="6defd-310">By default, this protocol is disabled for applications.</span></span> <span data-ttu-id="6defd-311">tooenable hello OAuth2 Implicit Grant-protokollet för programmet, redigera dess programmanifestet från hello Azure-portalen och ange hello ”oauth2AllowImplicitFlow” värdet tootrue.</span><span class="sxs-lookup"><span data-stu-id="6defd-311">tooenable hello OAuth2 Implicit Grant protocol for your application, edit its application manifest from hello Azure Portal and set hello “oauth2AllowImplicitFlow” value tootrue.</span></span> <span data-ttu-id="6defd-312">Detaljerade instruktioner finns [aktiverar OAuth 2.0 Implicit Grant för den enda sidan program](active-directory-integrating-applications.md).</span><span class="sxs-lookup"><span data-stu-id="6defd-312">For detailed instructions, see [Enabling OAuth 2.0 Implicit Grant for Single Page Applications](active-directory-integrating-applications.md).</span></span>

#### <a name="token-expiration"></a><span data-ttu-id="6defd-313">Token upphör att gälla</span><span class="sxs-lookup"><span data-stu-id="6defd-313">Token Expiration</span></span>
<span data-ttu-id="6defd-314">När du använder ADAL.js toomanage autentisering med Azure AD kan du dra nytta av flera funktioner som underlättar uppdatera en utgången token samt hämta token för ytterligare web API-resurser som kan anropas av hello program.</span><span class="sxs-lookup"><span data-stu-id="6defd-314">When you use ADAL.js toomanage authentication with Azure AD, you benefit from several features that facilitate refreshing an expired token as well as getting tokens for additional web API resources that may be called by hello application.</span></span> <span data-ttu-id="6defd-315">När hello användare autentiseras korrekt med Azure AD, upprätta en session som skyddas av en cookie för hello användare mellan hello webbläsare och Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6defd-315">When hello user successfully authenticates with Azure AD, a session secured by a cookie is established for hello user between hello browser and Azure AD.</span></span> <span data-ttu-id="6defd-316">Det är viktigt toonote som hello sessionen finns mellan hello användare och Azure AD och inte mellan hello användar- och hello webbprogram som körs på hello-servern.</span><span class="sxs-lookup"><span data-stu-id="6defd-316">It’s important toonote that hello session exists between hello user and Azure AD and not between hello user and hello web application running on hello server.</span></span> <span data-ttu-id="6defd-317">När en token upphör att gälla använder ADAL.js den här sessionen toosilently få en annan token.</span><span class="sxs-lookup"><span data-stu-id="6defd-317">When a token expires, ADAL.js uses this session toosilently obtain another token.</span></span> <span data-ttu-id="6defd-318">Den gör detta med hjälp av en dold iFrame toosend och ta emot hello-begäran med hello OAuth Implicit Grant-protokollet.</span><span class="sxs-lookup"><span data-stu-id="6defd-318">It does this by using a hidden iFrame toosend and receive hello request using hello OAuth Implicit Grant protocol.</span></span> <span data-ttu-id="6defd-319">ADAL.js kan också använda samma mekanism toosilently hämta åtkomsttoken från Azure AD för andra webb-API-resurser att hello programmet anrop så länge dessa resurser stöder resursdelning för korsande ursprung (CORS) är registrerade i hello användarens katalog och alla nödvändiga medgivande gavs av hello användaren under inloggning.</span><span class="sxs-lookup"><span data-stu-id="6defd-319">ADAL.js can also use this same mechanism toosilently obtain access tokens from Azure AD for other web API resources that hello application calls as long as these resources support cross-origin resource sharing (CORS), are registered in hello user’s directory, and any required consent was given by hello user during sign-in.</span></span>

### <a name="native-application-tooweb-api"></a><span data-ttu-id="6defd-320">Interna program tooWeb API</span><span class="sxs-lookup"><span data-stu-id="6defd-320">Native Application tooWeb API</span></span>
<span data-ttu-id="6defd-321">Det här avsnittet beskrivs en programspecifika som anropar ett webb-API för en användares räkning.</span><span class="sxs-lookup"><span data-stu-id="6defd-321">This section describes a native application that calls a web API on behalf of a user.</span></span> <span data-ttu-id="6defd-322">Det här scenariot bygger på hello OAuth 2.0 auktorisering kodtypen bevilja med en offentlig klient enligt beskrivningen i avsnittet 4.1 i hello [OAuth 2.0-specifikationen](http://tools.ietf.org/html/rfc6749).</span><span class="sxs-lookup"><span data-stu-id="6defd-322">This scenario is built on hello OAuth 2.0 authorization code grant type with a public client, as described in section 4.1 of hello [OAuth 2.0 specification](http://tools.ietf.org/html/rfc6749).</span></span> <span data-ttu-id="6defd-323">hello det ursprungliga programmet hämtar en åtkomst-token för hello användare med hjälp av hello OAuth 2.0-protokollet.</span><span class="sxs-lookup"><span data-stu-id="6defd-323">hello native application obtains an access token for hello user by using hello OAuth 2.0 protocol.</span></span> <span data-ttu-id="6defd-324">Åtkomsttoken som sedan skickas i hello begäran toohello webb-API, som ger användare hello och returnerar hello önskad resurs.</span><span class="sxs-lookup"><span data-stu-id="6defd-324">This access token is then sent in hello request toohello web API, which authorizes hello user and returns hello desired resource.</span></span>

#### <a name="diagram"></a><span data-ttu-id="6defd-325">Diagram</span><span class="sxs-lookup"><span data-stu-id="6defd-325">Diagram</span></span>
![Interna program tooWeb API-Diagram](./media/active-directory-authentication-scenarios/native_app_to_web_api.png)

#### <a name="authentication-flow-for-native-application-tooapi"></a><span data-ttu-id="6defd-327">Autentiseringsflödet för det ursprungliga programmet tooAPI</span><span class="sxs-lookup"><span data-stu-id="6defd-327">Authentication flow for native application tooAPI</span></span>
#### <a name="description-of-protocol-flow"></a><span data-ttu-id="6defd-328">Beskrivning av protokollet flöde</span><span class="sxs-lookup"><span data-stu-id="6defd-328">Description of Protocol Flow</span></span>
<span data-ttu-id="6defd-329">Om du använder hello AD-Autentiseringsbibliotek hanteras de flesta av hello protokolldetaljer som beskrivs nedan, till exempel hello webbläsare popup-fönster, tokencachelagring och hantering av uppdaterings-tokens.</span><span class="sxs-lookup"><span data-stu-id="6defd-329">If you are using hello AD Authentication Libraries, most of hello protocol details described below are handled for you, such as hello browser pop-up, token caching, and handling of refresh tokens.</span></span>

1. <span data-ttu-id="6defd-330">Med en webbläsare som popup-gör hello det ursprungliga programmet en begäran toohello autentiseringsslutpunkt i Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6defd-330">Using a browser pop-up, hello native application makes a request toohello authorization endpoint in Azure AD.</span></span> <span data-ttu-id="6defd-331">Denna begäran innehåller hello program-ID och hello omdirigerings-URI för hello det ursprungliga programmet som visas i hello Azure-portalen och hello program-ID URI för hello webb-API.</span><span class="sxs-lookup"><span data-stu-id="6defd-331">This request includes hello Application ID and hello redirect URI of hello native application as shown in hello Azure Portal, and hello application ID URI for hello web API.</span></span> <span data-ttu-id="6defd-332">Om hello användaren inte har redan är inloggad de inte ange toosign i igen</span><span class="sxs-lookup"><span data-stu-id="6defd-332">If hello user hasn’t already signed in, they are prompted toosign in again</span></span>
2. <span data-ttu-id="6defd-333">Azure AD autentiserar användaren hello.</span><span class="sxs-lookup"><span data-stu-id="6defd-333">Azure AD authenticates hello user.</span></span> <span data-ttu-id="6defd-334">Om det är ett program med flera innehavare och medgivande är obligatoriska toouse hello programmet kommer hello användaren att nödvändiga tooconsent om de inte redan gjort det..</span><span class="sxs-lookup"><span data-stu-id="6defd-334">If it is a multi-tenant application and consent is required toouse hello application, hello user will be required tooconsent if they haven’t already done so.</span></span> <span data-ttu-id="6defd-335">Efter att godkänna och vid autentiseringen, utfärdar Azure AD en auktorisering kod svar tillbaka toohello klientprogrammets omdirigerings-URI.</span><span class="sxs-lookup"><span data-stu-id="6defd-335">After granting consent and upon successful authentication, Azure AD issues an authorization code response back toohello client application’s redirect URI.</span></span>
3. <span data-ttu-id="6defd-336">När Azure AD utfärdar ett auktorisering kod svar tillbaka toohello omdirigerings-URI, hello klienten programmet slutar webbläsare interaktion och extrakt hello Auktoriseringskoden från hello svar.</span><span class="sxs-lookup"><span data-stu-id="6defd-336">When Azure AD issues an authorization code response back toohello redirect URI, hello client application stops browser interaction and extracts hello authorization code from hello response.</span></span> <span data-ttu-id="6defd-337">Med den här auktoriseringskod hello klientprogrammet skickar en begäran tooAzure Annonsens tokenslutpunkten som innehåller hello auktoriseringskod, information om hello klientprogram (program-ID och omdirigerings-URI) och hello resurs (program-ID URI för hello webb-API).</span><span class="sxs-lookup"><span data-stu-id="6defd-337">Using this authorization code, hello client application sends a request tooAzure AD’s token endpoint that includes hello authorization code, details about hello client application (Application ID and redirect URI), and hello desired resource (application ID URI for hello web API).</span></span>
4. <span data-ttu-id="6defd-338">hello auktoriseringskod och information om hello klientprogrammet och webb-API verifieras av Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6defd-338">hello authorization code and information about hello client application and web API are validated by Azure AD.</span></span> <span data-ttu-id="6defd-339">När valideringen har lyckats, Azure AD returnerar två token: en JWT-åtkomsttoken och en uppdatering JWT-token.</span><span class="sxs-lookup"><span data-stu-id="6defd-339">Upon successful validation, Azure AD returns two tokens: a JWT access token and a JWT refresh token.</span></span> <span data-ttu-id="6defd-340">Dessutom kan returnerar Azure AD grundläggande information om hello användare, till exempel deras visas namnet och klient-ID.</span><span class="sxs-lookup"><span data-stu-id="6defd-340">In addition, Azure AD returns basic information about hello user, such as their display name and tenant ID.</span></span>
5. <span data-ttu-id="6defd-341">Via HTTPS använder hello klientprogrammet hello returneras JWT åtkomst-token tooadd hello JWT sträng med en ”ägar” beteckning i hello Authorization-huvud för hello begäran toohello webb-API.</span><span class="sxs-lookup"><span data-stu-id="6defd-341">Over HTTPS, hello client application uses hello returned JWT access token tooadd hello JWT string with a “Bearer” designation in hello Authorization header of hello request toohello web API.</span></span> <span data-ttu-id="6defd-342">hello webb-API verifierar sedan hello JWT-token och om verifieringen lyckas returnerar hello önskad resurs.</span><span class="sxs-lookup"><span data-stu-id="6defd-342">hello web API then validates hello JWT token, and if validation is successful, returns hello desired resource.</span></span>
6. <span data-ttu-id="6defd-343">När hello åtkomst-token upphör att gälla kommer hello klientprogrammet ett felmeddelande som anger hello användare behöver tooauthenticate igen.</span><span class="sxs-lookup"><span data-stu-id="6defd-343">When hello access token expires, hello client application will receive an error that indicates hello user needs tooauthenticate again.</span></span> <span data-ttu-id="6defd-344">Om programmet hello har en giltig uppdateringstoken, kan det vara används tooacquire som en ny åtkomsttoken utan att fråga hello användaren toosign i igen.</span><span class="sxs-lookup"><span data-stu-id="6defd-344">If hello application has a valid refresh token, it can be used tooacquire a new access token without prompting hello user toosign in again.</span></span> <span data-ttu-id="6defd-345">Om hello uppdateringstoken upphör att gälla, måste programmet hello toointeractively autentisera hello användare igen.</span><span class="sxs-lookup"><span data-stu-id="6defd-345">If hello refresh token expires, hello application will need toointeractively authenticate hello user once again.</span></span>

> [!NOTE]
> <span data-ttu-id="6defd-346">Hej uppdateringstoken utfärdat av Azure AD kan använda tooaccess flera resurser.</span><span class="sxs-lookup"><span data-stu-id="6defd-346">hello refresh token issued by Azure AD can be used tooaccess multiple resources.</span></span> <span data-ttu-id="6defd-347">Om du har ett klientprogram som har behörigheten toocall två web API: er kan hello uppdateringstoken vara samt används tooget en åtkomst-token toohello andra webb-API.</span><span class="sxs-lookup"><span data-stu-id="6defd-347">For example, if you have a client application that has permission toocall two web APIs, hello refresh token can be used tooget an access token toohello other web API as well.</span></span>
> 
> 

#### <a name="code-samples"></a><span data-ttu-id="6defd-348">Kodexempel</span><span class="sxs-lookup"><span data-stu-id="6defd-348">Code Samples</span></span>
<span data-ttu-id="6defd-349">Se hello kodexempel för scenarier med det ursprungliga programmet tooWeb API.</span><span class="sxs-lookup"><span data-stu-id="6defd-349">See hello code samples for Native Application tooWeb API scenarios.</span></span> <span data-ttu-id="6defd-350">Och kom tillbaka ofta--vi lägga till nya prov alla hello tid.</span><span class="sxs-lookup"><span data-stu-id="6defd-350">And, check back frequently -- we add new samples all hello time.</span></span> <span data-ttu-id="6defd-351">[Interna program tooWeb API](active-directory-code-samples.md#native-application-to-web-api).</span><span class="sxs-lookup"><span data-stu-id="6defd-351">[Native Application tooWeb API](active-directory-code-samples.md#native-application-to-web-api).</span></span>

#### <a name="registering"></a><span data-ttu-id="6defd-352">Registrera</span><span class="sxs-lookup"><span data-stu-id="6defd-352">Registering</span></span>
* <span data-ttu-id="6defd-353">Enskild klient: Båda hello programspecifika och hello webb-API som måste registreras i hello samma katalog i Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6defd-353">Single Tenant: Both hello native application and hello web API must be registered in hello same directory in Azure AD.</span></span> <span data-ttu-id="6defd-354">hello webb-API kan vara konfigurerade tooexpose en uppsättning behörigheter som används toolimit hello interna programmets åtkomst tooits resurser.</span><span class="sxs-lookup"><span data-stu-id="6defd-354">hello web API can be configured tooexpose a set of permissions, which are used toolimit hello native application’s access tooits resources.</span></span> <span data-ttu-id="6defd-355">hello klientprogrammet sedan väljer hello önskade behörigheter hello ”behörigheter tooOther program” nedrullningsbara menyn i hello Azure-portalen.</span><span class="sxs-lookup"><span data-stu-id="6defd-355">hello client application then selects hello desired permissions from hello “Permissions tooOther Applications” drop-down menu in hello Azure Portal.</span></span>
* <span data-ttu-id="6defd-356">Flera innehavare: Först hello programspecifika bara registrerad i hello utvecklare eller utgivarens katalog.</span><span class="sxs-lookup"><span data-stu-id="6defd-356">Multi-Tenant: First, hello native application only ever registered in hello developer or publisher’s directory.</span></span> <span data-ttu-id="6defd-357">Andra är hello programspecifika konfigurerade tooindicate hello kräver toobe fungerar.</span><span class="sxs-lookup"><span data-stu-id="6defd-357">Second, hello native application is configured tooindicate hello permissions it requires toobe functional.</span></span> <span data-ttu-id="6defd-358">Den här listan med behörigheter som krävs visas i en dialogruta när en användare eller administratör i hello målkatalogen ger medgivande toohello program, vilket gör den tillgänglig tootheir organisation.</span><span class="sxs-lookup"><span data-stu-id="6defd-358">This list of required permissions is shown in a dialog when a user or administrator in hello destination directory gives consent toohello application, which makes it available tootheir organization.</span></span> <span data-ttu-id="6defd-359">Vissa program kräver bara användarnivå behörigheter, som alla användare i organisationen hello kan godkänna.</span><span class="sxs-lookup"><span data-stu-id="6defd-359">Some applications require just user-level permissions, which any user in hello organization can consent to.</span></span> <span data-ttu-id="6defd-360">Andra applikationer kräver på administratörsnivå som en användare i organisationen hello inte kan samtycka till.</span><span class="sxs-lookup"><span data-stu-id="6defd-360">Other applications require administrator-level permissions, which a user in hello organization cannot consent to.</span></span> <span data-ttu-id="6defd-361">Endast en directory-administratören kan ge medgivande tooapplications som kräver den här nivån av behörigheter.</span><span class="sxs-lookup"><span data-stu-id="6defd-361">Only a directory administrator can give consent tooapplications that require this level of permissions.</span></span> <span data-ttu-id="6defd-362">När hello användaren eller administratören godkänner, registreras endast hello webb-API i sina kataloger.</span><span class="sxs-lookup"><span data-stu-id="6defd-362">When hello user or administrator consents, only hello web API is registered in their directory.</span></span> <span data-ttu-id="6defd-363">Mer information finns i [integrera program med Azure Active Directory](active-directory-integrating-applications.md).</span><span class="sxs-lookup"><span data-stu-id="6defd-363">For more information, see [Integrating Applications with Azure Active Directory](active-directory-integrating-applications.md).</span></span>

#### <a name="token-expiration"></a><span data-ttu-id="6defd-364">Token upphör att gälla</span><span class="sxs-lookup"><span data-stu-id="6defd-364">Token Expiration</span></span>
<span data-ttu-id="6defd-365">När hello programspecifika använder dess tillstånd koden tooget en JWT-token för åtkomst, emot tas även en uppdatering JWT-token.</span><span class="sxs-lookup"><span data-stu-id="6defd-365">When hello native application uses its authorization code tooget a JWT access token, it also receives a JWT refresh token.</span></span> <span data-ttu-id="6defd-366">När hello åtkomst-token upphör att gälla hello uppdateringstoken kan vara används toore-autentisera hello användare utan att de toosign i igen.</span><span class="sxs-lookup"><span data-stu-id="6defd-366">When hello access token expires, hello refresh token can be used toore-authenticate hello user without requiring them toosign in again.</span></span> <span data-ttu-id="6defd-367">Den här uppdateringstoken är och sedan använda tooauthenticate hello användare, vilket resulterar i en ny åtkomst-token och uppdatera token.</span><span class="sxs-lookup"><span data-stu-id="6defd-367">This refresh token is then used tooauthenticate hello user, which results in a new access token and refresh token.</span></span>

### <a name="web-application-tooweb-api"></a><span data-ttu-id="6defd-368">Web Application tooWeb API</span><span class="sxs-lookup"><span data-stu-id="6defd-368">Web Application tooWeb API</span></span>
<span data-ttu-id="6defd-369">Det här avsnittet beskrivs ett webbprogram som behöver tooget resurser från ett webb-API.</span><span class="sxs-lookup"><span data-stu-id="6defd-369">This section describes a web application that needs tooget resources from a web API.</span></span> <span data-ttu-id="6defd-370">I det här scenariot, det finns två identitetstyper av som hello webbprogrammet kan använda tooauthenticate och anropa hello webb-API: en Programidentitet eller en delegerad användaridentitet.</span><span class="sxs-lookup"><span data-stu-id="6defd-370">In this scenario, there are two identity types that hello web application can use tooauthenticate and call hello web API: an application identity, or a delegated user identity.</span></span>

<span data-ttu-id="6defd-371">*Tillämpningsprogrammets identitet:* det här scenariot använder OAuth 2.0 klientens autentiseringsuppgifter bevilja tooauthenticate som programmet hello och åtkomst hello webb-API.</span><span class="sxs-lookup"><span data-stu-id="6defd-371">*Application identity:* This scenario uses OAuth 2.0 client credentials grant tooauthenticate as hello application and access hello web API.</span></span> <span data-ttu-id="6defd-372">När du använder en Programidentitet, hello web API kan endast upptäcka att anropar hello webbprogram, som hello får webb-API inte någon information om hello användare.</span><span class="sxs-lookup"><span data-stu-id="6defd-372">When using an application identity, hello web API can only detect that hello web application is calling it, as hello web API does not receive any information about hello user.</span></span> <span data-ttu-id="6defd-373">Om programmet hello tar emot information om hello användare, skickas via hello protokoll och den inte är signerad av Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6defd-373">If hello application receives information about hello user, it will be sent via hello application protocol, and it is not signed by Azure AD.</span></span> <span data-ttu-id="6defd-374">hello webb-API förtroenden att hello webbprogrammet autentiserade hello användare.</span><span class="sxs-lookup"><span data-stu-id="6defd-374">hello web API trusts that hello web application authenticated hello user.</span></span> <span data-ttu-id="6defd-375">Därför kan kallas det här mönstret betrodda undersystemet.</span><span class="sxs-lookup"><span data-stu-id="6defd-375">For this reason, this pattern is called a trusted subsystem.</span></span>

<span data-ttu-id="6defd-376">*Delegerad användaridentitet:* det här scenariot kan utföras på två sätt: OpenID Connect och OAuth 2.0 auktorisering kod bevilja en konfidentiell klient.</span><span class="sxs-lookup"><span data-stu-id="6defd-376">*Delegated user identity:* This scenario can be accomplished in two ways: OpenID Connect, and OAuth 2.0 authorization code grant with a confidential client.</span></span> <span data-ttu-id="6defd-377">hello webbprogrammet hämtar en åtkomst-token för hello användare, vilket bevisar toohello webb-API som hello användare autentiserats toohello webbprogram och hello webbprogrammet var. kan tooobtain en delegerad användare identitet toocall hello webb-API.</span><span class="sxs-lookup"><span data-stu-id="6defd-377">hello web application obtains an access token for hello user, which proves toohello web API that hello user successfully authenticated toohello web application and that hello web application was able tooobtain a delegated user identity toocall hello web API.</span></span> <span data-ttu-id="6defd-378">Åtkomsttoken skickas i hello begäran toohello webb-API, som ger användare hello och returnerar hello önskad resurs.</span><span class="sxs-lookup"><span data-stu-id="6defd-378">This access token is sent in hello request toohello web API, which authorizes hello user and returns hello desired resource.</span></span>

#### <a name="diagram"></a><span data-ttu-id="6defd-379">Diagram</span><span class="sxs-lookup"><span data-stu-id="6defd-379">Diagram</span></span>
![Web Application tooWeb API-diagram](./media/active-directory-authentication-scenarios/web_app_to_web_api.png)

#### <a name="description-of-protocol-flow"></a><span data-ttu-id="6defd-381">Beskrivning av protokollet flöde</span><span class="sxs-lookup"><span data-stu-id="6defd-381">Description of Protocol Flow</span></span>
<span data-ttu-id="6defd-382">Både hello Programidentitet och delegerade identitet användartyper diskuteras i hello flödet nedan.</span><span class="sxs-lookup"><span data-stu-id="6defd-382">Both hello application identity and delegated user identity types are discussed in hello flow below.</span></span> <span data-ttu-id="6defd-383">hello viktigaste skillnaden mellan dem är att hello delegerad användaridentitet först skaffa en auktoriseringskod innan hello användare kan logga in och få åtkomst till toohello webb-API.</span><span class="sxs-lookup"><span data-stu-id="6defd-383">hello key difference between them is that hello delegated user identity must first acquire an authorization code before hello user can sign-in and gain access toohello web API.</span></span>

##### <a name="application-identity-with-oauth-20-client-credentials-grant"></a><span data-ttu-id="6defd-384">Tillämpningsprogrammets identitet med OAuth 2.0-klienten autentiseringsuppgifter bevilja</span><span class="sxs-lookup"><span data-stu-id="6defd-384">Application Identity with OAuth 2.0 Client Credentials Grant</span></span>
1. <span data-ttu-id="6defd-385">En användare är inloggad i tooAzure AD i hello webbprogram (se hello [webbläsare tooWeb programmet](#web-browser-to-web-application) ovan).</span><span class="sxs-lookup"><span data-stu-id="6defd-385">A user is signed in tooAzure AD in hello web application (see hello [Web Browser tooWeb Application](#web-browser-to-web-application) above).</span></span>
2. <span data-ttu-id="6defd-386">hello webbprogrammet måste tooacquire en åtkomst-token så att den kan autentisera toohello webb-API och hämta hello önskad resurs.</span><span class="sxs-lookup"><span data-stu-id="6defd-386">hello web application needs tooacquire an access token so that it can authenticate toohello web API and retrieve hello desired resource.</span></span> <span data-ttu-id="6defd-387">Den gör en begäran tooAzure Annonsens tokenslutpunkten, hello autentiseringsuppgifter, program-ID och API: er webbprogrammet ID URI.</span><span class="sxs-lookup"><span data-stu-id="6defd-387">It makes a request tooAzure AD’s token endpoint, providing hello credential, Application ID, and web API’s application ID URI.</span></span>
3. <span data-ttu-id="6defd-388">Azure AD autentiserar hello program och returnerar en JWT åtkomst-token som används toocall hello webb-API.</span><span class="sxs-lookup"><span data-stu-id="6defd-388">Azure AD authenticates hello application and returns a JWT access token that is used toocall hello web API.</span></span>
4. <span data-ttu-id="6defd-389">Via HTTPS använder hello webbprogrammet hello returneras JWT åtkomst-token tooadd hello JWT sträng med en ”ägar” beteckning i hello Authorization-huvud för hello begäran toohello webb-API.</span><span class="sxs-lookup"><span data-stu-id="6defd-389">Over HTTPS, hello web application uses hello returned JWT access token tooadd hello JWT string with a “Bearer” designation in hello Authorization header of hello request toohello web API.</span></span> <span data-ttu-id="6defd-390">hello webb-API verifierar sedan hello JWT-token och om verifieringen lyckas returnerar hello önskad resurs.</span><span class="sxs-lookup"><span data-stu-id="6defd-390">hello web API then validates hello JWT token, and if validation is successful, returns hello desired resource.</span></span>

##### <a name="delegated-user-identity-with-openid-connect"></a><span data-ttu-id="6defd-391">Delegerad användaridentiteter med OpenID Connect</span><span class="sxs-lookup"><span data-stu-id="6defd-391">Delegated User Identity with OpenID Connect</span></span>
1. <span data-ttu-id="6defd-392">En användare är inloggad i tooa webbprogram med hjälp av Azure AD (se hello [webbläsare tooWeb programmet](#web-browser-to-web-application) ovan).</span><span class="sxs-lookup"><span data-stu-id="6defd-392">A user is signed in tooa web application using Azure AD (see hello [Web Browser tooWeb Application](#web-browser-to-web-application) section above).</span></span> <span data-ttu-id="6defd-393">Om hello användaren av hello webbprogrammet inte har ännu godkänt tooallowing hello web application toocall hello webb-API i dess ställe, måste hello användaren tooconsent.</span><span class="sxs-lookup"><span data-stu-id="6defd-393">If hello user of hello web application has not yet consented tooallowing hello web application toocall hello web API on its behalf, hello user will need tooconsent.</span></span> <span data-ttu-id="6defd-394">hello program visas hello behörigheter som krävs och om någon av dessa är på administratörsnivå normal användare i hello katalogen inte kan tooconsent.</span><span class="sxs-lookup"><span data-stu-id="6defd-394">hello application will display hello permissions it requires, and if any of these are administrator-level permissions, a normal user in hello directory will not be able tooconsent.</span></span> <span data-ttu-id="6defd-395">Medgivande processen gäller bara toomulti klient program, inte en organisation program som har redan hello programmet hello behörighet.</span><span class="sxs-lookup"><span data-stu-id="6defd-395">This consent process only applies toomulti-tenant applications, not single tenant applications, as hello application will already have hello necessary permissions.</span></span> <span data-ttu-id="6defd-396">När hello användaren inloggad, emot hello webbprogrammet en ID-token med information om hello användare, samt en Auktoriseringskoden.</span><span class="sxs-lookup"><span data-stu-id="6defd-396">When hello user signed in, hello web application received an ID token with information about hello user, as well as an authorization code.</span></span>
2. <span data-ttu-id="6defd-397">Använder hello auktoriseringskod som utfärdats av Azure AD, hello webbprogrammet skickar en begäran tooAzure Annonsens tokenslutpunkten som innehåller hello auktoriseringskod, information om hello klientprogram (program-ID och omdirigerings-URI) och hello önskad resurs ( program-ID URI för hello webb-API).</span><span class="sxs-lookup"><span data-stu-id="6defd-397">Using hello authorization code issued by Azure AD, hello web application sends a request tooAzure AD’s token endpoint that includes hello authorization code, details about hello client application (Application ID and redirect URI), and hello desired resource (application ID URI for hello web API).</span></span>
3. <span data-ttu-id="6defd-398">hello auktoriseringskod och information om hello webbprogram och webb-API verifieras av Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6defd-398">hello authorization code and information about hello web application and web API are validated by Azure AD.</span></span> <span data-ttu-id="6defd-399">När valideringen har lyckats, Azure AD returnerar två token: en JWT-åtkomsttoken och en uppdatering JWT-token.</span><span class="sxs-lookup"><span data-stu-id="6defd-399">Upon successful validation, Azure AD returns two tokens: a JWT access token and a JWT refresh token.</span></span>
4. <span data-ttu-id="6defd-400">Via HTTPS använder hello webbprogrammet hello returneras JWT åtkomst-token tooadd hello JWT sträng med en ”ägar” beteckning i hello Authorization-huvud för hello begäran toohello webb-API.</span><span class="sxs-lookup"><span data-stu-id="6defd-400">Over HTTPS, hello web application uses hello returned JWT access token tooadd hello JWT string with a “Bearer” designation in hello Authorization header of hello request toohello web API.</span></span> <span data-ttu-id="6defd-401">hello webb-API verifierar sedan hello JWT-token och om verifieringen lyckas returnerar hello önskad resurs.</span><span class="sxs-lookup"><span data-stu-id="6defd-401">hello web API then validates hello JWT token, and if validation is successful, returns hello desired resource.</span></span>

##### <a name="delegated-user-identity-with-oauth-20-authorization-code-grant"></a><span data-ttu-id="6defd-402">Delegerad användaridentiteter med OAuth 2.0 Authorization kod Grant</span><span class="sxs-lookup"><span data-stu-id="6defd-402">Delegated User Identity with OAuth 2.0 Authorization Code Grant</span></span>
1. <span data-ttu-id="6defd-403">En användare är redan inloggad tooa webbprogrammet, vars autentiseringsmekanism är oberoende av Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6defd-403">A user is already signed in tooa web application, whose authentication mechanism is independent of Azure AD.</span></span>
2. <span data-ttu-id="6defd-404">hello webbprogram kräver tillstånd code tooacquire ett åtkomsttoken, så att den skickar en begäran via hello webbläsare tooAzure Annonsens autentiseringsslutpunkt tillhandahåller hello program-ID och omdirigerings-URI för hello webbprogrammet efter lyckad autentisering.</span><span class="sxs-lookup"><span data-stu-id="6defd-404">hello web application requires an authorization code tooacquire an access token, so it issues a request through hello browser tooAzure AD’s authorization endpoint, providing hello Application ID and redirect URI for hello web application after successful authentication.</span></span> <span data-ttu-id="6defd-405">hello användare loggar in tooAzure AD.</span><span class="sxs-lookup"><span data-stu-id="6defd-405">hello user signs in tooAzure AD.</span></span>
3. <span data-ttu-id="6defd-406">Om hello användaren av hello webbprogrammet inte har ännu godkänt tooallowing hello web application toocall hello webb-API i dess ställe, måste hello användaren tooconsent.</span><span class="sxs-lookup"><span data-stu-id="6defd-406">If hello user of hello web application has not yet consented tooallowing hello web application toocall hello web API on its behalf, hello user will need tooconsent.</span></span> <span data-ttu-id="6defd-407">hello program visas hello behörigheter som krävs och om någon av dessa är på administratörsnivå normal användare i hello katalogen inte kan tooconsent.</span><span class="sxs-lookup"><span data-stu-id="6defd-407">hello application will display hello permissions it requires, and if any of these are administrator-level permissions, a normal user in hello directory will not be able tooconsent.</span></span> <span data-ttu-id="6defd-408">Den här medgivande gäller tooboth enkla och flera innehavare program.</span><span class="sxs-lookup"><span data-stu-id="6defd-408">This consent applies tooboth single and multi-tenant application.</span></span>  <span data-ttu-id="6defd-409">Hello enstaka klient om kan en administratör utföra admin medgivande tooconsent åt sina användare.</span><span class="sxs-lookup"><span data-stu-id="6defd-409">In hello single tenant case, an admin can perform admin consent tooconsent on behalf of their users.</span></span>  <span data-ttu-id="6defd-410">Detta kan göras med hjälp av hello `Grant Permissions` knapp i hello [Azure Portal](https://portal.azure.com).</span><span class="sxs-lookup"><span data-stu-id="6defd-410">This can be done using hello `Grant Permissions` button in hello [Azure Portal](https://portal.azure.com).</span></span> 
4. <span data-ttu-id="6defd-411">När hello användaren har godkänt får hello webbprogrammet hello auktoriseringskod måste tooacquire en åtkomst-token.</span><span class="sxs-lookup"><span data-stu-id="6defd-411">After hello user has consented, hello web application receives hello authorization code that it needs tooacquire an access token.</span></span>
5. <span data-ttu-id="6defd-412">Använder hello auktoriseringskod som utfärdats av Azure AD, hello webbprogrammet skickar en begäran tooAzure Annonsens tokenslutpunkten som innehåller hello auktoriseringskod, information om hello klientprogram (program-ID och omdirigerings-URI) och hello önskad resurs ( program-ID URI för hello webb-API).</span><span class="sxs-lookup"><span data-stu-id="6defd-412">Using hello authorization code issued by Azure AD, hello web application sends a request tooAzure AD’s token endpoint that includes hello authorization code, details about hello client application (Application ID and redirect URI), and hello desired resource (application ID URI for hello web API).</span></span>
6. <span data-ttu-id="6defd-413">hello auktoriseringskod och information om hello webbprogram och webb-API verifieras av Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6defd-413">hello authorization code and information about hello web application and web API are validated by Azure AD.</span></span> <span data-ttu-id="6defd-414">När valideringen har lyckats, Azure AD returnerar två token: en JWT-åtkomsttoken och en uppdatering JWT-token.</span><span class="sxs-lookup"><span data-stu-id="6defd-414">Upon successful validation, Azure AD returns two tokens: a JWT access token and a JWT refresh token.</span></span>
7. <span data-ttu-id="6defd-415">Via HTTPS använder hello webbprogrammet hello returneras JWT åtkomst-token tooadd hello JWT sträng med en ”ägar” beteckning i hello Authorization-huvud för hello begäran toohello webb-API.</span><span class="sxs-lookup"><span data-stu-id="6defd-415">Over HTTPS, hello web application uses hello returned JWT access token tooadd hello JWT string with a “Bearer” designation in hello Authorization header of hello request toohello web API.</span></span> <span data-ttu-id="6defd-416">hello webb-API verifierar sedan hello JWT-token och om verifieringen lyckas returnerar hello önskad resurs.</span><span class="sxs-lookup"><span data-stu-id="6defd-416">hello web API then validates hello JWT token, and if validation is successful, returns hello desired resource.</span></span>

#### <a name="code-samples"></a><span data-ttu-id="6defd-417">Kodexempel</span><span class="sxs-lookup"><span data-stu-id="6defd-417">Code Samples</span></span>
<span data-ttu-id="6defd-418">Se hello kodexempel för webbprogram tooWeb API scenarier.</span><span class="sxs-lookup"><span data-stu-id="6defd-418">See hello code samples for Web Application tooWeb API scenarios.</span></span> <span data-ttu-id="6defd-419">Och kom tillbaka ofta--vi lägga till nya prov alla hello tid.</span><span class="sxs-lookup"><span data-stu-id="6defd-419">And, check back frequently -- we add new samples all hello time.</span></span> <span data-ttu-id="6defd-420">Web [programmet tooWeb API](active-directory-code-samples.md#web-application-to-web-api).</span><span class="sxs-lookup"><span data-stu-id="6defd-420">Web [Application tooWeb API](active-directory-code-samples.md#web-application-to-web-api).</span></span>

#### <a name="registering"></a><span data-ttu-id="6defd-421">Registrera</span><span class="sxs-lookup"><span data-stu-id="6defd-421">Registering</span></span>
* <span data-ttu-id="6defd-422">Enskild klient: För både hello Programidentitet och delegerad användare identitet fall hello webbprogram och hello webb-API som måste registreras i hello samma katalog i Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6defd-422">Single Tenant: For both hello application identity and delegated user identity cases, hello web application and hello web API must be registered in hello same directory in Azure AD.</span></span> <span data-ttu-id="6defd-423">hello webb-API kan vara konfigurerade tooexpose en uppsättning behörigheter som används toolimit hello webbprogrammets åtkomst tooits resurser.</span><span class="sxs-lookup"><span data-stu-id="6defd-423">hello web API can be configured tooexpose a set of permissions, which are used toolimit hello web application’s access tooits resources.</span></span> <span data-ttu-id="6defd-424">Om en delegerad användaridentitetstypen används måste hello webbprogrammet tooselect hello önskade behörigheter hello ”behörigheter tooOther program” nedrullningsbara menyn i hello Azure-portalen.</span><span class="sxs-lookup"><span data-stu-id="6defd-424">If a delegated user identity type is being used, hello web application needs tooselect hello desired permissions from hello “Permissions tooOther Applications” drop-down menu in hello Azure Portal.</span></span> <span data-ttu-id="6defd-425">Det här steget är inte nödvändigt om hello programtyp identitet som används.</span><span class="sxs-lookup"><span data-stu-id="6defd-425">This step is not required if hello application identity type is being used.</span></span>
* <span data-ttu-id="6defd-426">Flera innehavare: Först hello webbprogram är konfigurerade tooindicate hello kräver toobe fungerar.</span><span class="sxs-lookup"><span data-stu-id="6defd-426">Multi-Tenant: First, hello web application is configured tooindicate hello permissions it requires toobe functional.</span></span> <span data-ttu-id="6defd-427">Den här listan med behörigheter som krävs visas i en dialogruta när en användare eller administratör i hello målkatalogen ger medgivande toohello program, vilket gör den tillgänglig tootheir organisation.</span><span class="sxs-lookup"><span data-stu-id="6defd-427">This list of required permissions is shown in a dialog when a user or administrator in hello destination directory gives consent toohello application, which makes it available tootheir organization.</span></span> <span data-ttu-id="6defd-428">Vissa program kräver bara användarnivå behörigheter, som alla användare i organisationen hello kan godkänna.</span><span class="sxs-lookup"><span data-stu-id="6defd-428">Some applications require just user-level permissions, which any user in hello organization can consent to.</span></span> <span data-ttu-id="6defd-429">Andra applikationer kräver på administratörsnivå som en användare i organisationen hello inte kan samtycka till.</span><span class="sxs-lookup"><span data-stu-id="6defd-429">Other applications require administrator-level permissions, which a user in hello organization cannot consent to.</span></span> <span data-ttu-id="6defd-430">Endast en directory-administratören kan ge medgivande tooapplications som kräver den här nivån av behörigheter.</span><span class="sxs-lookup"><span data-stu-id="6defd-430">Only a directory administrator can give consent tooapplications that require this level of permissions.</span></span> <span data-ttu-id="6defd-431">När hello användaren eller administratören medgivanden hello web application och hello web API registreras både i sina kataloger.</span><span class="sxs-lookup"><span data-stu-id="6defd-431">When hello user or administrator consents, hello web application and hello web API are both registered in their directory.</span></span>

#### <a name="token-expiration"></a><span data-ttu-id="6defd-432">Token upphör att gälla</span><span class="sxs-lookup"><span data-stu-id="6defd-432">Token Expiration</span></span>
<span data-ttu-id="6defd-433">När hello webbprogrammet använder dess tillstånd koden tooget en JWT-token för åtkomst, får den också en uppdatering JWT-token.</span><span class="sxs-lookup"><span data-stu-id="6defd-433">When hello web application uses its authorization code tooget a JWT access token, it also receives a JWT refresh token.</span></span> <span data-ttu-id="6defd-434">När hello åtkomst-token upphör att gälla hello uppdateringstoken kan vara används toore-autentisera hello användare utan att de toosign i igen.</span><span class="sxs-lookup"><span data-stu-id="6defd-434">When hello access token expires, hello refresh token can be used toore-authenticate hello user without requiring them toosign in again.</span></span> <span data-ttu-id="6defd-435">Den här uppdateringstoken är och sedan använda tooauthenticate hello användare, vilket resulterar i en ny åtkomst-token och uppdatera token.</span><span class="sxs-lookup"><span data-stu-id="6defd-435">This refresh token is then used tooauthenticate hello user, which results in a new access token and refresh token.</span></span>

### <a name="daemon-or-server-application-tooweb-api"></a><span data-ttu-id="6defd-436">Daemon eller serverprogrammet tooWeb API</span><span class="sxs-lookup"><span data-stu-id="6defd-436">Daemon or Server Application tooWeb API</span></span>
<span data-ttu-id="6defd-437">Det här avsnittet beskriver en daemon eller server-programmet som behöver tooget resurser från ett webb-API.</span><span class="sxs-lookup"><span data-stu-id="6defd-437">This section describes a daemon or server application that needs tooget resources from a web API.</span></span> <span data-ttu-id="6defd-438">Det finns två underordnade scenarier som gäller toothis avsnittet: en daemon som behöver toocall en webb-API som bygger på OAuth 2.0 autentiseringsuppgifter bevilja klienttyp; och ett serverprogram (till exempel ett webb-API) som behöver toocall ett webb-API, som bygger på OAuth 2.0 On-Behalf-Of utkast till en specifikation.</span><span class="sxs-lookup"><span data-stu-id="6defd-438">There are two sub-scenarios that apply toothis section: A daemon that needs toocall a web API, built on OAuth 2.0 client credentials grant type; and a server application (such as a web API) that needs toocall a web API, built on OAuth 2.0 On-Behalf-Of draft specification.</span></span>

<span data-ttu-id="6defd-439">Hello scenariot när en daemon-program behöver toocall webb-API är viktiga toounderstand några saker.</span><span class="sxs-lookup"><span data-stu-id="6defd-439">For hello scenario when a daemon application needs toocall a web API, it’s important toounderstand a few things.</span></span> <span data-ttu-id="6defd-440">Först är interaktion från användaren inte möjligt med ett daemon-program som kräver hello programmet toohave sin egen identitet.</span><span class="sxs-lookup"><span data-stu-id="6defd-440">First, user interaction is not possible with a daemon application, which requires hello application toohave its own identity.</span></span> <span data-ttu-id="6defd-441">Ett exempel på en daemon-program är batchjobb eller en tjänst i operativsystemet som körs i bakgrunden hello.</span><span class="sxs-lookup"><span data-stu-id="6defd-441">An example of a daemon application is a batch job, or an operating system service running in hello background.</span></span> <span data-ttu-id="6defd-442">Den här typen av program begär en åtkomst-token med hjälp av dess Programidentitet och presentera dess program-ID och autentiseringsuppgifter (lösenordet eller certifikatet) program-ID URI tooAzure AD.</span><span class="sxs-lookup"><span data-stu-id="6defd-442">This type of application requests an access token by using its application identity and presenting its Application ID, credential (password or certificate), and application ID URI tooAzure AD.</span></span> <span data-ttu-id="6defd-443">Efter en lyckad autentisering får hello daemon en åtkomst-token från Azure AD, som kan använda toocall hello webb-API.</span><span class="sxs-lookup"><span data-stu-id="6defd-443">After successful authentication, hello daemon receives an access token from Azure AD, which is then used toocall hello web API.</span></span>

<span data-ttu-id="6defd-444">Hello scenario när ett serverprogram måste toocall ett webb-API, är det bra toouse ett exempel.</span><span class="sxs-lookup"><span data-stu-id="6defd-444">For hello scenario when a server application needs toocall a web API, it’s helpful toouse an example.</span></span> <span data-ttu-id="6defd-445">Anta att en användare har autentiserats på det ursprungliga programmet och interna programmet måste toocall webb-API.</span><span class="sxs-lookup"><span data-stu-id="6defd-445">Imagine that a user has authenticated on a native application, and this native application needs toocall a web API.</span></span> <span data-ttu-id="6defd-446">Azure AD utfärdar en JWT åtkomst-token toocall hello webb-API.</span><span class="sxs-lookup"><span data-stu-id="6defd-446">Azure AD issues a JWT access token toocall hello web API.</span></span> <span data-ttu-id="6defd-447">Om hello webb-API måste toocall ett annat underordnat webb-API, kan som användas hello på-flöde toodelegate hello användarens identitet och autentisera toohello andra nivån webb-API.</span><span class="sxs-lookup"><span data-stu-id="6defd-447">If hello web API needs toocall another downstream web API, it can use hello on-behalf-of flow toodelegate hello user’s identity and authenticate toohello second-tier web API.</span></span>

#### <a name="diagram"></a><span data-ttu-id="6defd-448">Diagram</span><span class="sxs-lookup"><span data-stu-id="6defd-448">Diagram</span></span>
![Daemon eller serverprogrammet tooWeb API-diagram](./media/active-directory-authentication-scenarios/daemon_server_app_to_web_api.png)

#### <a name="description-of-protocol-flow"></a><span data-ttu-id="6defd-450">Beskrivning av protokollet flöde</span><span class="sxs-lookup"><span data-stu-id="6defd-450">Description of Protocol Flow</span></span>
##### <a name="application-identity-with-oauth-20-client-credentials-grant"></a><span data-ttu-id="6defd-451">Tillämpningsprogrammets identitet med OAuth 2.0-klienten autentiseringsuppgifter bevilja</span><span class="sxs-lookup"><span data-stu-id="6defd-451">Application Identity with OAuth 2.0 Client Credentials Grant</span></span>
1. <span data-ttu-id="6defd-452">Först måste hello serverprogrammet tooauthenticate med Azure AD som själva, utan att någon mänsklig interaktion, till exempel en dialogruta för interaktiv inloggning.</span><span class="sxs-lookup"><span data-stu-id="6defd-452">First, hello server application needs tooauthenticate with Azure AD as itself, without any human interaction such as an interactive sign-on dialog.</span></span> <span data-ttu-id="6defd-453">Den gör en begäran tooAzure Annonsens tokenslutpunkten, hello autentiseringsuppgifter, program-ID och program-ID-URI.</span><span class="sxs-lookup"><span data-stu-id="6defd-453">It makes a request tooAzure AD’s token endpoint, providing hello credential, Application ID, and application ID URI.</span></span>
2. <span data-ttu-id="6defd-454">Azure AD autentiserar hello program och returnerar en JWT åtkomst-token som används toocall hello webb-API.</span><span class="sxs-lookup"><span data-stu-id="6defd-454">Azure AD authenticates hello application and returns a JWT access token that is used toocall hello web API.</span></span>
3. <span data-ttu-id="6defd-455">Via HTTPS använder hello webbprogrammet hello returneras JWT åtkomst-token tooadd hello JWT sträng med en ”ägar” beteckning i hello Authorization-huvud för hello begäran toohello webb-API.</span><span class="sxs-lookup"><span data-stu-id="6defd-455">Over HTTPS, hello web application uses hello returned JWT access token tooadd hello JWT string with a “Bearer” designation in hello Authorization header of hello request toohello web API.</span></span> <span data-ttu-id="6defd-456">hello webb-API verifierar sedan hello JWT-token och om verifieringen lyckas returnerar hello önskad resurs.</span><span class="sxs-lookup"><span data-stu-id="6defd-456">hello web API then validates hello JWT token, and if validation is successful, returns hello desired resource.</span></span>

##### <a name="delegated-user-identity-with-oauth-20-on-behalf-of-draft-specification"></a><span data-ttu-id="6defd-457">Delegerad användaridentiteter med OAuth 2.0-specifikationen för On-Behalf-Of utkast</span><span class="sxs-lookup"><span data-stu-id="6defd-457">Delegated User Identity with OAuth 2.0 On-Behalf-Of Draft Specification</span></span>
<span data-ttu-id="6defd-458">hello flödet beskrivs nedan förutsätter att en användare har autentiserats på ett annat program (till exempel programspecifika) och deras användaridentitet har använt tooacquire en åtkomst-token toohello första nivån web API.</span><span class="sxs-lookup"><span data-stu-id="6defd-458">hello flow discussed below assumes that a user has been authenticated on another application (such as a native application), and their user identity has been used tooacquire an access token toohello first-tier web API.</span></span>

1. <span data-ttu-id="6defd-459">hello programspecifika skickar hello åtkomst-token toohello första nivån webb-API.</span><span class="sxs-lookup"><span data-stu-id="6defd-459">hello native application sends hello access token toohello first-tier web API.</span></span>
2. <span data-ttu-id="6defd-460">hello första nivån web API skickar en begäran tooAzure Annonsens tokenslutpunkten, att tillhandahålla sina program-ID och autentiseringsuppgifter, samt hello användarens åtkomsttoken.</span><span class="sxs-lookup"><span data-stu-id="6defd-460">hello first-tier web API sends a request tooAzure AD’s token endpoint, providing its Application ID and credentials, as well as hello user’s access token.</span></span> <span data-ttu-id="6defd-461">Dessutom hello-begäran skickas med en on_behalf_of parameter som anger hello web API begär en ny token toocall ett underordnat webb-API för hello ursprungliga användares räkning.</span><span class="sxs-lookup"><span data-stu-id="6defd-461">In addition, hello request is sent with an on_behalf_of parameter that indicates hello web API is requesting new tokens toocall a downstream web API on behalf of hello original user.</span></span>
3. <span data-ttu-id="6defd-462">Azure AD verifierar att hello första nivån webb-API har behörigheter tooaccess hello andra nivån web API och validerar hello-begäran returnerar en JWT-token för åtkomst och en JWT uppdatera token toohello första nivån web API.</span><span class="sxs-lookup"><span data-stu-id="6defd-462">Azure AD verifies that hello first-tier web API has permissions tooaccess hello second-tier web API and validates hello request, returning a JWT access token and a JWT refresh token toohello first-tier web API.</span></span>
4. <span data-ttu-id="6defd-463">Via HTTPS hello hello första nivån web API-anrop sedan andra nivån webb-API genom att lägga till hello token sträng i hello Authorization-huvud i hello-begäran.</span><span class="sxs-lookup"><span data-stu-id="6defd-463">Over HTTPS, hello first-tier web API then calls hello second-tier web API by appending hello token string in hello Authorization header in hello request.</span></span> <span data-ttu-id="6defd-464">hello första nivån webb-API kan fortsätta toocall hello andra nivån webb-API som hello åtkomst-token och uppdateringstoken är giltiga.</span><span class="sxs-lookup"><span data-stu-id="6defd-464">hello first-tier web API can continue toocall hello second-tier web API as long as hello access token and refresh tokens are valid.</span></span>

#### <a name="code-samples"></a><span data-ttu-id="6defd-465">Kodexempel</span><span class="sxs-lookup"><span data-stu-id="6defd-465">Code Samples</span></span>
<span data-ttu-id="6defd-466">Se hello kodexempel för Daemon eller serverprogrammet tooWeb API-scenarier.</span><span class="sxs-lookup"><span data-stu-id="6defd-466">See hello code samples for Daemon or Server Application tooWeb API scenarios.</span></span> <span data-ttu-id="6defd-467">Och kom tillbaka ofta--vi lägga till nya prov alla hello tid.</span><span class="sxs-lookup"><span data-stu-id="6defd-467">And, check back frequently -- we add new samples all hello time.</span></span> [<span data-ttu-id="6defd-468">Server eller Daemon program tooWeb API</span><span class="sxs-lookup"><span data-stu-id="6defd-468">Server or Daemon Application tooWeb API</span></span>](active-directory-code-samples.md#server-or-daemon-application-to-web-api)

#### <a name="registering"></a><span data-ttu-id="6defd-469">Registrera</span><span class="sxs-lookup"><span data-stu-id="6defd-469">Registering</span></span>
* <span data-ttu-id="6defd-470">Enskild klient: För både hello Programidentitet och delegerad användare identitet fall hello daemon eller server-programmet måste registreras i hello samma katalog i Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6defd-470">Single Tenant: For both hello application identity and delegated user identity cases, hello daemon or server application must be registered in hello same directory in Azure AD.</span></span> <span data-ttu-id="6defd-471">hello webb-API kan vara konfigurerade tooexpose en uppsättning behörigheter som används toolimit hello daemon eller åtkomst tooits serverresurser.</span><span class="sxs-lookup"><span data-stu-id="6defd-471">hello web API can be configured tooexpose a set of permissions, which are used toolimit hello daemon or server’s access tooits resources.</span></span> <span data-ttu-id="6defd-472">Om en delegerad användaridentitetstypen används måste hello serverprogrammet tooselect hello önskade behörigheter hello ”behörigheter tooOther program” nedrullningsbara menyn i hello Azure-portalen.</span><span class="sxs-lookup"><span data-stu-id="6defd-472">If a delegated user identity type is being used, hello server application needs tooselect hello desired permissions from hello “Permissions tooOther Applications” drop-down menu in hello Azure Portal.</span></span> <span data-ttu-id="6defd-473">Det här steget är inte nödvändigt om hello programtyp identitet som används.</span><span class="sxs-lookup"><span data-stu-id="6defd-473">This step is not required if hello application identity type is being used.</span></span>
* <span data-ttu-id="6defd-474">Flera innehavare: Först hello daemon eller server-programmet är konfigurerade tooindicate hello kräver toobe fungerar.</span><span class="sxs-lookup"><span data-stu-id="6defd-474">Multi-Tenant: First, hello daemon or server application is configured tooindicate hello permissions it requires toobe functional.</span></span> <span data-ttu-id="6defd-475">Den här listan med behörigheter som krävs visas i en dialogruta när en användare eller administratör i hello målkatalogen ger medgivande toohello program, vilket gör den tillgänglig tootheir organisation.</span><span class="sxs-lookup"><span data-stu-id="6defd-475">This list of required permissions is shown in a dialog when a user or administrator in hello destination directory gives consent toohello application, which makes it available tootheir organization.</span></span> <span data-ttu-id="6defd-476">Vissa program kräver bara användarnivå behörigheter, som alla användare i organisationen hello kan godkänna.</span><span class="sxs-lookup"><span data-stu-id="6defd-476">Some applications require just user-level permissions, which any user in hello organization can consent to.</span></span> <span data-ttu-id="6defd-477">Andra applikationer kräver på administratörsnivå som en användare i organisationen hello inte kan samtycka till.</span><span class="sxs-lookup"><span data-stu-id="6defd-477">Other applications require administrator-level permissions, which a user in hello organization cannot consent to.</span></span> <span data-ttu-id="6defd-478">Endast en directory-administratören kan ge medgivande tooapplications som kräver den här nivån av behörigheter.</span><span class="sxs-lookup"><span data-stu-id="6defd-478">Only a directory administrator can give consent tooapplications that require this level of permissions.</span></span> <span data-ttu-id="6defd-479">När hello användaren eller administratören godkänner, är både hello web API: er registrerade i sina kataloger.</span><span class="sxs-lookup"><span data-stu-id="6defd-479">When hello user or administrator consents, both of hello web APIs are registered in their directory.</span></span>

#### <a name="token-expiration"></a><span data-ttu-id="6defd-480">Token upphör att gälla</span><span class="sxs-lookup"><span data-stu-id="6defd-480">Token Expiration</span></span>
<span data-ttu-id="6defd-481">När hello första program använder dess tillstånd koden tooget en JWT-token för åtkomst, emot tas även en uppdatering JWT-token.</span><span class="sxs-lookup"><span data-stu-id="6defd-481">When hello first application uses its authorization code tooget a JWT access token, it also receives a JWT refresh token.</span></span> <span data-ttu-id="6defd-482">När hello åtkomst-token upphör att gälla hello uppdateringstoken kan vara används toore-autentisera hello användare utan att fråga efter autentiseringsuppgifter.</span><span class="sxs-lookup"><span data-stu-id="6defd-482">When hello access token expires, hello refresh token can be used toore-authenticate hello user without prompting for credentials.</span></span> <span data-ttu-id="6defd-483">Den här uppdateringstoken är och sedan använda tooauthenticate hello användare, vilket resulterar i en ny åtkomst-token och uppdatera token.</span><span class="sxs-lookup"><span data-stu-id="6defd-483">This refresh token is then used tooauthenticate hello user, which results in a new access token and refresh token.</span></span>

## <a name="see-also"></a><span data-ttu-id="6defd-484">Se även</span><span class="sxs-lookup"><span data-stu-id="6defd-484">See Also</span></span>
[<span data-ttu-id="6defd-485">Azure Active Directory-Guide för utvecklare</span><span class="sxs-lookup"><span data-stu-id="6defd-485">Azure Active Directory Developer's Guide</span></span>](active-directory-developers-guide.md)

[<span data-ttu-id="6defd-486">Azure Active Directory-kodexempel</span><span class="sxs-lookup"><span data-stu-id="6defd-486">Azure Active Directory Code Samples</span></span>](active-directory-code-samples.md)

[<span data-ttu-id="6defd-487">Viktig Information om att signera nyckelförnyelse i Azure AD</span><span class="sxs-lookup"><span data-stu-id="6defd-487">Important Information About Signing Key Rollover in Azure AD</span></span>](active-directory-signing-key-rollover.md)

[<span data-ttu-id="6defd-488">OAuth 2.0 i Azure AD</span><span class="sxs-lookup"><span data-stu-id="6defd-488">OAuth 2.0 in Azure AD</span></span>](https://msdn.microsoft.com/library/azure/dn645545.aspx)

