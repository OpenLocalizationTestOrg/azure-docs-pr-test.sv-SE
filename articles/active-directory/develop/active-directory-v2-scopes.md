---
title: "aaaAzure Active Directory v2.0-scope, behörigheter och medgivande | Microsoft Docs"
description: "En beskrivning av auktorisering hello Azure AD v2.0-slutpunkten, inklusive scope, behörigheter och samtycke."
services: active-directory
documentationcenter: 
author: dstrockis
manager: mbaldwin
editor: 
ms.assetid: 8f98cbf0-a71d-4e34-babf-e644ad9ff423
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 01/07/2017
ms.author: dastrock
ms.custom: aaddev
ms.openlocfilehash: 5721d368c435868bfb4ae91cff7fbb9bc4a79b66
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 10/06/2017
---
# <a name="scopes-permissions-and-consent-in-hello-azure-active-directory-v20-endpoint"></a><span data-ttu-id="598aa-103">Scope, behörigheter och medgivande i hello Azure Active Directory v2.0-slutpunkten</span><span class="sxs-lookup"><span data-stu-id="598aa-103">Scopes, permissions, and consent in hello Azure Active Directory v2.0 endpoint</span></span>
<span data-ttu-id="598aa-104">Appar som integreras med Azure Active Directory (AD Azure) följer en auktoriseringsmodell som ger användare kontroll över hur en app kan komma åt sina data.</span><span class="sxs-lookup"><span data-stu-id="598aa-104">Apps that integrate with Azure Active Directory (Azure AD) follow an authorization model that gives users control over how an app can access their data.</span></span> <span data-ttu-id="598aa-105">hello v2.0 implementering av hello auktoriseringsmodellen har uppdaterats och ändras hur en app måste interagera med Azure AD.</span><span class="sxs-lookup"><span data-stu-id="598aa-105">hello v2.0 implementation of hello authorization model has been updated, and it changes how an app must interact with Azure AD.</span></span> <span data-ttu-id="598aa-106">Den här artikeln beskriver hello grundläggande koncept för den här auktoriseringsmodellen, inklusive scope, behörigheter och samtycke.</span><span class="sxs-lookup"><span data-stu-id="598aa-106">This article covers hello basic concepts of this authorization model, including scopes, permissions, and consent.</span></span>

> [!NOTE]
> <span data-ttu-id="598aa-107">hello v2.0-slutpunkten har inte stöd för alla Azure Active Directory-scenarier och funktioner.</span><span class="sxs-lookup"><span data-stu-id="598aa-107">hello v2.0 endpoint does not support all Azure Active Directory scenarios and features.</span></span> <span data-ttu-id="598aa-108">toodetermine om du ska använda hello v2.0-slutpunkten Läs om [v2.0 begränsningar](active-directory-v2-limitations.md).</span><span class="sxs-lookup"><span data-stu-id="598aa-108">toodetermine whether you should use hello v2.0 endpoint, read about [v2.0 limitations](active-directory-v2-limitations.md).</span></span>
>
>

## <a name="scopes-and-permissions"></a><span data-ttu-id="598aa-109">Omfång och behörigheter</span><span class="sxs-lookup"><span data-stu-id="598aa-109">Scopes and permissions</span></span>
<span data-ttu-id="598aa-110">Azure AD implementerar hello [OAuth 2.0](active-directory-v2-protocols.md) authorization protocol.</span><span class="sxs-lookup"><span data-stu-id="598aa-110">Azure AD implements hello [OAuth 2.0](active-directory-v2-protocols.md) authorization protocol.</span></span> <span data-ttu-id="598aa-111">OAuth 2.0 är en metod som en app från tredje part kan komma åt webbaserat resurser för en användares räkning.</span><span class="sxs-lookup"><span data-stu-id="598aa-111">OAuth 2.0 is a method through which a third-party app can access web-hosted resources on behalf of a user.</span></span> <span data-ttu-id="598aa-112">Alla webbaserat resurser som kan integreras med Azure AD har ett resurs-ID eller *program-ID URI*.</span><span class="sxs-lookup"><span data-stu-id="598aa-112">Any web-hosted resource that integrates with Azure AD has a resource identifier, or *Application ID URI*.</span></span> <span data-ttu-id="598aa-113">Till exempel omfattar vissa av Microsofts webbaserat resurser:</span><span class="sxs-lookup"><span data-stu-id="598aa-113">For example, some of Microsoft's web-hosted resources include:</span></span>

* <span data-ttu-id="598aa-114">hello Office 365 Unified e-API:`https://outlook.office.com`</span><span class="sxs-lookup"><span data-stu-id="598aa-114">hello Office 365 Unified Mail API: `https://outlook.office.com`</span></span>
* <span data-ttu-id="598aa-115">hello Azure AD Graph API:`https://graph.windows.net`</span><span class="sxs-lookup"><span data-stu-id="598aa-115">hello Azure AD Graph API: `https://graph.windows.net`</span></span>
* <span data-ttu-id="598aa-116">Microsoft Graph:`https://graph.microsoft.com`</span><span class="sxs-lookup"><span data-stu-id="598aa-116">Microsoft Graph: `https://graph.microsoft.com`</span></span>

<span data-ttu-id="598aa-117">hello samma sak gäller för resurser från tredje part som har integrerat med Azure AD.</span><span class="sxs-lookup"><span data-stu-id="598aa-117">hello same is true for any third-party resources that have integrated with Azure AD.</span></span> <span data-ttu-id="598aa-118">Något av dessa resurser kan också definiera en uppsättning behörigheter som kan använda toodivide hello funktionerna i den här resursen i mindre delar.</span><span class="sxs-lookup"><span data-stu-id="598aa-118">Any of these resources also can define a set of permissions that can be used toodivide hello functionality of that resource into smaller chunks.</span></span> <span data-ttu-id="598aa-119">Exempelvis [Microsoft Graph](https://graph.microsoft.io) har definierat behörigheter toodo hello följande uppgifter, bland annat:</span><span class="sxs-lookup"><span data-stu-id="598aa-119">As an example, [Microsoft Graph](https://graph.microsoft.io) has defined permissions toodo hello following tasks, among others:</span></span>

* <span data-ttu-id="598aa-120">Läsa användarens kalender</span><span class="sxs-lookup"><span data-stu-id="598aa-120">Read a user's calendar</span></span>
* <span data-ttu-id="598aa-121">Skriva tooa användares kalender</span><span class="sxs-lookup"><span data-stu-id="598aa-121">Write tooa user's calendar</span></span>
* <span data-ttu-id="598aa-122">Skicka e-post som en användare</span><span class="sxs-lookup"><span data-stu-id="598aa-122">Send mail as a user</span></span>

<span data-ttu-id="598aa-123">Genom att definiera typerna av behörigheter har hello resursen detaljerad kontroll över dess data och hur hello data visas.</span><span class="sxs-lookup"><span data-stu-id="598aa-123">By defining these types of permissions, hello resource has fine-grained control over its data and how hello data is exposed.</span></span> <span data-ttu-id="598aa-124">En tredjeparts-app kan begära dessa behörigheter från en app-användare.</span><span class="sxs-lookup"><span data-stu-id="598aa-124">A third-party app can request these permissions from an app user.</span></span> <span data-ttu-id="598aa-125">hello app användare måste godkänna hello behörigheter innan hello appen kan fungera för hello användares räkning.</span><span class="sxs-lookup"><span data-stu-id="598aa-125">hello app user must approve hello permissions before hello app can act on hello user's behalf.</span></span> <span data-ttu-id="598aa-126">Genom att dela upp hello resursens funktioner i mindre behörighetsgrupper kan appar från tredje part vara inbyggda toorequest endast hello särskilda behörigheter de behöver tooperform deras funktion.</span><span class="sxs-lookup"><span data-stu-id="598aa-126">By chunking hello resource's functionality into smaller permission sets, third-party apps can be built toorequest only hello specific permissions that they need tooperform their function.</span></span> <span data-ttu-id="598aa-127">Användarna kan veta exakt hur en app använder sina data och de kan vara mer säker hello appen inte fungerar med skadliga åtgärder.</span><span class="sxs-lookup"><span data-stu-id="598aa-127">App users can know exactly how an app will use their data, and they can be more confident that hello app is not behaving with malicious intent.</span></span>

<span data-ttu-id="598aa-128">I Azure AD och OAuth dessa typer av behörigheter kallas *scope*.</span><span class="sxs-lookup"><span data-stu-id="598aa-128">In Azure AD and OAuth, these types of permissions are called *scopes*.</span></span> <span data-ttu-id="598aa-129">Ibland är refererad tooas *oAuth2Permissions*.</span><span class="sxs-lookup"><span data-stu-id="598aa-129">They also sometimes are referred tooas *oAuth2Permissions*.</span></span> <span data-ttu-id="598aa-130">Ett omfång representeras i Azure AD som ett strängvärde.</span><span class="sxs-lookup"><span data-stu-id="598aa-130">A scope is represented in Azure AD as a string value.</span></span> <span data-ttu-id="598aa-131">Fortsätter med hello Microsoft Graph exempel är hello scope-värde för varje behörighet:</span><span class="sxs-lookup"><span data-stu-id="598aa-131">Continuing with hello Microsoft Graph example, hello scope value for each permission is:</span></span>

* <span data-ttu-id="598aa-132">Läsa användarens kalender med hjälp av`Calendar.Read`</span><span class="sxs-lookup"><span data-stu-id="598aa-132">Read a user's calendar by using `Calendar.Read`</span></span>
* <span data-ttu-id="598aa-133">Skriva tooa användares kalender med hjälp av`Mail.ReadWrite`</span><span class="sxs-lookup"><span data-stu-id="598aa-133">Write tooa user's calendar by using `Mail.ReadWrite`</span></span>
* <span data-ttu-id="598aa-134">En användare med hjälp av genom att skicka e-post`Mail.Send`</span><span class="sxs-lookup"><span data-stu-id="598aa-134">Send mail as a user using by `Mail.Send`</span></span>

<span data-ttu-id="598aa-135">En app kan begära dessa behörigheter genom att ange hello scope i begäranden toohello v2.0-slutpunkten.</span><span class="sxs-lookup"><span data-stu-id="598aa-135">An app can request these permissions by specifying hello scopes in requests toohello v2.0 endpoint.</span></span>

## <a name="openid-connect-scopes"></a><span data-ttu-id="598aa-136">OpenID Connect scope</span><span class="sxs-lookup"><span data-stu-id="598aa-136">OpenID Connect scopes</span></span>
<span data-ttu-id="598aa-137">hello v2.0 implementering av OpenID Connect har några väldefinierade scope som inte gäller tooa specifik resurs: `openid`, `email`, `profile`, och `offline_access`.</span><span class="sxs-lookup"><span data-stu-id="598aa-137">hello v2.0 implementation of OpenID Connect has a few well-defined scopes that do not apply tooa specific resource: `openid`, `email`, `profile`, and `offline_access`.</span></span>

### <a name="openid"></a><span data-ttu-id="598aa-138">openid</span><span class="sxs-lookup"><span data-stu-id="598aa-138">openid</span></span>
<span data-ttu-id="598aa-139">Om en app utför logga in med hjälp av [OpenID Connect](active-directory-v2-protocols.md), den måste begära hello `openid` omfång.</span><span class="sxs-lookup"><span data-stu-id="598aa-139">If an app performs sign-in by using [OpenID Connect](active-directory-v2-protocols.md), it must request hello `openid` scope.</span></span> <span data-ttu-id="598aa-140">Hej `openid` scope visas på hello arbetskonto medgivande sida som hello ”logga in dig på” behörighet och godkännande sida på hello personligt Microsoft-konto som hello ”visa din profil och Anslut tooapps och tjänster med ditt Microsoft-konto” behörighet.</span><span class="sxs-lookup"><span data-stu-id="598aa-140">hello `openid` scope shows on hello work account consent page as hello "Sign you in" permission, and on hello personal Microsoft account consent page as hello "View your profile and connect tooapps and services using your Microsoft account" permission.</span></span> <span data-ttu-id="598aa-141">Med den här behörigheten kan en app kan ta emot en unik identifierare för hello användaren i hello form av hello `sub` anspråk.</span><span class="sxs-lookup"><span data-stu-id="598aa-141">With this permission, an app can receive a unique identifier for hello user in hello form of hello `sub` claim.</span></span> <span data-ttu-id="598aa-142">Det ger även hello app åtkomst toohello användarinformationen slutpunkt.</span><span class="sxs-lookup"><span data-stu-id="598aa-142">It also gives hello app access toohello UserInfo endpoint.</span></span> <span data-ttu-id="598aa-143">Hej `openid` omfång kan användas i hello v2.0 tokenslutpunkten tooacquire ID-token, som kan vara används toosecure HTTP-anrop mellan olika komponenter i en app.</span><span class="sxs-lookup"><span data-stu-id="598aa-143">hello `openid` scope can be used at hello v2.0 token endpoint tooacquire ID tokens, which can be used toosecure HTTP calls between different components of an app.</span></span>

### <a name="email"></a><span data-ttu-id="598aa-144">E-post</span><span class="sxs-lookup"><span data-stu-id="598aa-144">email</span></span>
<span data-ttu-id="598aa-145">Hej `email` omfång kan användas med hello `openid` scope och övriga.</span><span class="sxs-lookup"><span data-stu-id="598aa-145">hello `email` scope can be used with hello `openid` scope and any others.</span></span> <span data-ttu-id="598aa-146">Den ger hello app åtkomst toohello användarens primära e-postadress i formatet hello hello `email` anspråk.</span><span class="sxs-lookup"><span data-stu-id="598aa-146">It gives hello app access toohello user's primary email address in hello form of hello `email` claim.</span></span> <span data-ttu-id="598aa-147">Hej `email` anspråk ingår i en token endast om en e-postadress som är associerad med hello-användarkonto som inte är alltid fallet hello.</span><span class="sxs-lookup"><span data-stu-id="598aa-147">hello `email` claim is included in a token only if an email address is associated with hello user account, which is not always hello case.</span></span> <span data-ttu-id="598aa-148">Om det använder hello `email` omfång, din app ska vara förberedd toohandle ett ärende i vilka hello `email` anspråk finns inte i hello-token.</span><span class="sxs-lookup"><span data-stu-id="598aa-148">If it uses hello `email` scope, your app should be prepared toohandle a case in which hello `email` claim does not exist in hello token.</span></span>

### <a name="profile"></a><span data-ttu-id="598aa-149">Profil</span><span class="sxs-lookup"><span data-stu-id="598aa-149">profile</span></span>
<span data-ttu-id="598aa-150">Hej `profile` omfång kan användas med hello `openid` scope och övriga.</span><span class="sxs-lookup"><span data-stu-id="598aa-150">hello `profile` scope can be used with hello `openid` scope and any others.</span></span> <span data-ttu-id="598aa-151">Den ger hello app åtkomst tooa stor mängd information om hello användare.</span><span class="sxs-lookup"><span data-stu-id="598aa-151">It gives hello app access tooa substantial amount of information about hello user.</span></span> <span data-ttu-id="598aa-152">hello information som den kan komma åt inkluderar, men begränsat inte till, hello användarens förnamn, efternamn, prioriterade användarnamn och objekt-ID.</span><span class="sxs-lookup"><span data-stu-id="598aa-152">hello information it can access includes, but is not limited to, hello user's given name, surname, preferred username, and object ID.</span></span> <span data-ttu-id="598aa-153">En fullständig lista över hello profil anspråk som är tillgängliga i hello id_tokens parameter för en viss användare finns hello [v2.0 tokens referens](active-directory-v2-tokens.md).</span><span class="sxs-lookup"><span data-stu-id="598aa-153">For a complete list of hello profile claims available in hello id_tokens parameter for a specific user, see hello [v2.0 tokens reference](active-directory-v2-tokens.md).</span></span>

### <a name="offlineaccess"></a><span data-ttu-id="598aa-154">offline_access</span><span class="sxs-lookup"><span data-stu-id="598aa-154">offline_access</span></span>
<span data-ttu-id="598aa-155">Hej [ `offline_access` omfång](http://openid.net/specs/openid-connect-core-1_0.html#OfflineAccess) ger din app åtkomst tooresources hello användarens räkning som en längre tid.</span><span class="sxs-lookup"><span data-stu-id="598aa-155">hello [`offline_access` scope](http://openid.net/specs/openid-connect-core-1_0.html#OfflineAccess) gives your app access tooresources on behalf of hello user for an extended time.</span></span> <span data-ttu-id="598aa-156">Hello arbete konto medgivande på sidan visas detta scope som hello ”åtkomst till data när som helst” behörighet.</span><span class="sxs-lookup"><span data-stu-id="598aa-156">On hello work account consent page, this scope appears as hello "Access your data anytime" permission.</span></span> <span data-ttu-id="598aa-157">Hello personliga Microsoft-konto medgivande på sidan visas den som hello ”komma åt din information när som helst” behörighet.</span><span class="sxs-lookup"><span data-stu-id="598aa-157">On hello personal Microsoft account consent page, it appears as hello "Access your info anytime" permission.</span></span> <span data-ttu-id="598aa-158">När en användare godkänner hello `offline_access` omfång, din app kan ta emot uppdaterings-tokens från token hello v2.0-slutpunkten.</span><span class="sxs-lookup"><span data-stu-id="598aa-158">When a user approves hello `offline_access` scope, your app can receive refresh tokens from hello v2.0 token endpoint.</span></span> <span data-ttu-id="598aa-159">Uppdateringstoken är långlivade.</span><span class="sxs-lookup"><span data-stu-id="598aa-159">Refresh tokens are long-lived.</span></span> <span data-ttu-id="598aa-160">Din app kan få nya åtkomsttoken när äldsta upphör.</span><span class="sxs-lookup"><span data-stu-id="598aa-160">Your app can get new access tokens as older ones expire.</span></span>

<span data-ttu-id="598aa-161">Om din app inte begär hello `offline_access` omfång och kan den inte fick uppdaterings-tokens.</span><span class="sxs-lookup"><span data-stu-id="598aa-161">If your app does not request hello `offline_access` scope, it won't receive refresh tokens.</span></span> <span data-ttu-id="598aa-162">Detta innebär att när du lösa in en auktoriseringskod i hello [OAuth 2.0-auktoriseringskodflödet](active-directory-v2-protocols.md), får du endast en åtkomst-token från hello `/token` slutpunkt.</span><span class="sxs-lookup"><span data-stu-id="598aa-162">This means that when you redeem an authorization code in hello [OAuth 2.0 authorization code flow](active-directory-v2-protocols.md), you'll receive only an access token from hello `/token` endpoint.</span></span> <span data-ttu-id="598aa-163">hello åtkomst-token är giltig för en kort tid.</span><span class="sxs-lookup"><span data-stu-id="598aa-163">hello access token is valid for a short time.</span></span> <span data-ttu-id="598aa-164">hello åtkomst-token upphör vanligtvis på en timme.</span><span class="sxs-lookup"><span data-stu-id="598aa-164">hello access token usually expires in one hour.</span></span> <span data-ttu-id="598aa-165">Då din app måste tooredirect hello användaren tillbaka toohello `/authorize` endpoint tooget en ny auktoriseringskod.</span><span class="sxs-lookup"><span data-stu-id="598aa-165">At that point, your app needs tooredirect hello user back toohello `/authorize` endpoint tooget a new authorization code.</span></span> <span data-ttu-id="598aa-166">Under den här omdirigering, beroende på hello typen av app måste kanske hello användare behöver tooenter sina autentiseringsuppgifter igen eller medgivande igen toopermissions.</span><span class="sxs-lookup"><span data-stu-id="598aa-166">During this redirect, depending on hello type of app, hello user might need tooenter their credentials again or consent again toopermissions.</span></span>

<span data-ttu-id="598aa-167">Mer information om hur tooget och använda uppdatera token finns hello [protokollreferens för v2.0](active-directory-v2-protocols.md).</span><span class="sxs-lookup"><span data-stu-id="598aa-167">For more information about how tooget and use refresh tokens, see hello [v2.0 protocol reference](active-directory-v2-protocols.md).</span></span>

## <a name="requesting-individual-user-consent"></a><span data-ttu-id="598aa-168">Begära samtycke för enskilda användare</span><span class="sxs-lookup"><span data-stu-id="598aa-168">Requesting individual user consent</span></span>
<span data-ttu-id="598aa-169">I en [OpenID Connect och OAuth 2.0](active-directory-v2-protocols.md) auktorisering begär en app kan begära hello behörigheter som krävs med hjälp av hello `scope` Frågeparametern.</span><span class="sxs-lookup"><span data-stu-id="598aa-169">In an [OpenID Connect or OAuth 2.0](active-directory-v2-protocols.md) authorization request, an app can request hello permissions it needs by using hello `scope` query parameter.</span></span> <span data-ttu-id="598aa-170">När en användare loggar in tooan app, skickar hello appen en begäran som hello följande exempel (med radbrytningar som lagts till för läsbarhet):</span><span class="sxs-lookup"><span data-stu-id="598aa-170">For example, when a user signs in tooan app, hello app sends a request like hello following example (with line breaks added for legibility):</span></span>

```
GET https://login.microsoftonline.com/common/oauth2/v2.0/authorize?
client_id=6731de76-14a6-49ae-97bc-6eba6914391e
&response_type=code
&redirect_uri=http%3A%2F%2Flocalhost%2Fmyapp%2F
&response_mode=query
&scope=
https%3A%2F%2Fgraph.microsoft.com%2Fcalendar.read%20
https%3A%2F%2Fgraph.microsoft.com%2Fmail.send
&state=12345
```

<span data-ttu-id="598aa-171">Hej `scope` parametern är en blankstegsavgränsad lista över scope som hello app begär.</span><span class="sxs-lookup"><span data-stu-id="598aa-171">hello `scope` parameter is a space-separated list of scopes that hello app is requesting.</span></span> <span data-ttu-id="598aa-172">Varje område anges genom att lägga till hello scope värdet toohello resursens identifierare (hello program-ID URI).</span><span class="sxs-lookup"><span data-stu-id="598aa-172">Each scope is indicated by appending hello scope value toohello resource's identifier (hello Application ID URI).</span></span> <span data-ttu-id="598aa-173">I exemplet begäran hello måste hello appen behörighet tooread hello användarens kalender och skicka e-post som hello användare.</span><span class="sxs-lookup"><span data-stu-id="598aa-173">In hello request example, hello app needs permission tooread hello user's calendar and send mail as hello user.</span></span>

<span data-ttu-id="598aa-174">När hello användaren anger sina autentiseringsuppgifter hello v2.0-slutpunkten söker efter en matchande post av *användargodkännande*.</span><span class="sxs-lookup"><span data-stu-id="598aa-174">After hello user enters their credentials, hello v2.0 endpoint checks for a matching record of *user consent*.</span></span> <span data-ttu-id="598aa-175">Om hello användaren inte har godkänt tooany av hello begärt behörigheter i hello tidigare, hello v2.0-slutpunkten frågar hello användaren toogrant hello begärt behörigheter.</span><span class="sxs-lookup"><span data-stu-id="598aa-175">If hello user has not consented tooany of hello requested permissions in hello past, hello v2.0 endpoint asks hello user toogrant hello requested permissions.</span></span>

![Fungerar konto medgivande](../../media/active-directory-v2-flows/work_account_consent.png)

<span data-ttu-id="598aa-177">När hello användaren godkänner hello behörighet, registreras hello medgivande så att hello användaren inte har tooconsent igen på efterföljande kontoinloggningar.</span><span class="sxs-lookup"><span data-stu-id="598aa-177">When hello user approves hello permission, hello consent is recorded so that hello user doesn't have tooconsent again on subsequent account sign-ins.</span></span>

## <a name="requesting-consent-for-an-entire-tenant"></a><span data-ttu-id="598aa-178">Begäran om godkännande för en hel klient</span><span class="sxs-lookup"><span data-stu-id="598aa-178">Requesting consent for an entire tenant</span></span>
<span data-ttu-id="598aa-179">Ofta när organisationen köper en licens eller prenumeration för ett program, hello organisationen vill toofully etablera hello program till sina anställda.</span><span class="sxs-lookup"><span data-stu-id="598aa-179">Often, when an organization purchases a license or subscription for an application, hello organization wants toofully provision hello application for its employees.</span></span> <span data-ttu-id="598aa-180">Som en del av den här processen kan kan en administratör ge ditt medgivande för hello programmet tooact uppdrag anställda.</span><span class="sxs-lookup"><span data-stu-id="598aa-180">As part of this process, an administrator can grant consent for hello application tooact on behalf of any employee.</span></span> <span data-ttu-id="598aa-181">Om Hej administratör ger ditt medgivande för hela hello-klient, ser hello organisationens anställda en medgivande sida för hello program.</span><span class="sxs-lookup"><span data-stu-id="598aa-181">If hello admin grants consent for hello entire tenant, hello organization's employees won't see a consent page for hello application.</span></span>

<span data-ttu-id="598aa-182">toorequest medgivande för alla användare i en klient, din app kan använda hello adminslutpunkten medgivande.</span><span class="sxs-lookup"><span data-stu-id="598aa-182">toorequest consent for all users in a tenant, your app can use hello admin consent endpoint.</span></span>

## <a name="admin-restricted-scopes"></a><span data-ttu-id="598aa-183">Begränsat scope</span><span class="sxs-lookup"><span data-stu-id="598aa-183">Admin-restricted scopes</span></span>
<span data-ttu-id="598aa-184">Vissa höga behörigheter i hello Microsoft ekosystem kan anges för*begränsat*.</span><span class="sxs-lookup"><span data-stu-id="598aa-184">Some high-privilege permissions in hello Microsoft ecosystem can be set too*admin-restricted*.</span></span> <span data-ttu-id="598aa-185">Exempel på dessa typer av scope är hello följande behörigheter:</span><span class="sxs-lookup"><span data-stu-id="598aa-185">Examples of these kinds of scopes include hello following permissions:</span></span>

* <span data-ttu-id="598aa-186">Läsa katalogdata i en organisation med hjälp av`Directory.Read`</span><span class="sxs-lookup"><span data-stu-id="598aa-186">Read an organization's directory data by using `Directory.Read`</span></span>
* <span data-ttu-id="598aa-187">Skriva data tooan organisations katalog med hjälp av`Directory.ReadWrite`</span><span class="sxs-lookup"><span data-stu-id="598aa-187">Write data tooan organization's directory by using `Directory.ReadWrite`</span></span>
* <span data-ttu-id="598aa-188">Läsa säkerhetsgrupper i organisationens katalog med hjälp av`Groups.Read.All`</span><span class="sxs-lookup"><span data-stu-id="598aa-188">Read security groups in an organization's directory by using `Groups.Read.All`</span></span>

<span data-ttu-id="598aa-189">Även om en konsument-användare kan ge ett program åtkomst toothis typ av data, begränsad organisationens användare från att bevilja åtkomst toohello samma uppsättning känsliga företagsdata.</span><span class="sxs-lookup"><span data-stu-id="598aa-189">Although a consumer user might grant an application access toothis kind of data, organizational users are restricted from granting access toohello same set of sensitive company data.</span></span> <span data-ttu-id="598aa-190">Om ditt program begär åtkomst tooone dessa behörigheter från en organisations användare, får hello användaren ett felmeddelande som säger att de inte är auktoriserade tooconsent tooyour app-behörigheter.</span><span class="sxs-lookup"><span data-stu-id="598aa-190">If your application requests access tooone of these permissions from an organizational user, hello user receives an error message that says they are not authorized tooconsent tooyour app's permissions.</span></span>

<span data-ttu-id="598aa-191">Om din app kräver tooadmin begränsat scope för organisationer kan begära du dem direkt från en företagsadministratör också med hjälp av hello admin medgivande slutpunkt som beskrivs nedan.</span><span class="sxs-lookup"><span data-stu-id="598aa-191">If your app requires access tooadmin-restricted scopes for organizations, you should request them directly from a company administrator, also by using hello admin consent endpoint, described next.</span></span>

<span data-ttu-id="598aa-192">När en administratör ger dessa behörigheter via Hej administratör godkänna endpoint, beviljas medgivande för alla användare i hello-klient.</span><span class="sxs-lookup"><span data-stu-id="598aa-192">When an administrator grants these permissions via hello admin consent endpoint, consent is granted for all users in hello tenant.</span></span>

## <a name="using-hello-admin-consent-endpoint"></a><span data-ttu-id="598aa-193">Med hjälp av hello admin medgivande-slutpunkten</span><span class="sxs-lookup"><span data-stu-id="598aa-193">Using hello admin consent endpoint</span></span>
<span data-ttu-id="598aa-194">Om du gör följande appen kan samla in behörigheter för alla användare i en klient, inklusive begränsat scope.</span><span class="sxs-lookup"><span data-stu-id="598aa-194">If you follow these steps, your app can gather permissions for all users in a tenant, including admin-restricted scopes.</span></span> <span data-ttu-id="598aa-195">toosee kodexempel som implementerar hello steg finns hello [begränsat scope exempel](https://github.com/Azure-Samples/active-directory-dotnet-admin-restricted-scopes-v2).</span><span class="sxs-lookup"><span data-stu-id="598aa-195">toosee a code sample that implements hello steps, see hello [admin-restricted scopes sample](https://github.com/Azure-Samples/active-directory-dotnet-admin-restricted-scopes-v2).</span></span>

### <a name="request-hello-permissions-in-hello-app-registration-portal"></a><span data-ttu-id="598aa-196">Begär hello behörighet i portalen för registrering av hello-app</span><span class="sxs-lookup"><span data-stu-id="598aa-196">Request hello permissions in hello app registration portal</span></span>
1. <span data-ttu-id="598aa-197">Gå tooyour programmet hello [Programregistreringsportalen](https://apps.dev.microsoft.com/?referrer=https://azure.microsoft.com/documentation/articles&deeplink=/appList), eller [skapa en app](active-directory-v2-app-registration.md) om du inte redan har gjort.</span><span class="sxs-lookup"><span data-stu-id="598aa-197">Go tooyour application in hello [Application Registration Portal](https://apps.dev.microsoft.com/?referrer=https://azure.microsoft.com/documentation/articles&deeplink=/appList), or [create an app](active-directory-v2-app-registration.md) if you haven't already.</span></span>
2. <span data-ttu-id="598aa-198">Leta upp hello **Microsoft Graph behörigheter** avsnittet och Lägg sedan till hello behörigheter som krävs för din app.</span><span class="sxs-lookup"><span data-stu-id="598aa-198">Locate hello **Microsoft Graph Permissions** section, and then add hello permissions that your app requires.</span></span>
3. <span data-ttu-id="598aa-199">Se till att du **spara** hello appregistrering.</span><span class="sxs-lookup"><span data-stu-id="598aa-199">Make sure you **Save** hello app registration.</span></span>

### <a name="recommended-sign-hello-user-in-tooyour-app"></a><span data-ttu-id="598aa-200">Rekommenderat: Logga hello användaren i tooyour app</span><span class="sxs-lookup"><span data-stu-id="598aa-200">Recommended: Sign hello user in tooyour app</span></span>
<span data-ttu-id="598aa-201">Vanligtvis när du skapar ett program som använder hello adminslutpunkten medgivande, hello appen måste en sida eller en vy i vilka Hej administratör kan godkänna hello app-behörigheter.</span><span class="sxs-lookup"><span data-stu-id="598aa-201">Typically, when you build an application that uses hello admin consent endpoint, hello app needs a page or view in which hello admin can approve hello app's permissions.</span></span> <span data-ttu-id="598aa-202">Den här sidan kan vara en del av registreringen hello app-flöde, en del av hello app-inställningar, eller så kan vara ett dedikerat ”ansluta” flöde.</span><span class="sxs-lookup"><span data-stu-id="598aa-202">This page can be part of hello app's sign-up flow, part of hello app's settings, or it can be a dedicated "connect" flow.</span></span> <span data-ttu-id="598aa-203">I många fall klokt det för hello app tooshow detta ”ansluta” Visa endast när en användare har loggat in med ett arbets- eller skolkonto Microsoft-konto.</span><span class="sxs-lookup"><span data-stu-id="598aa-203">In many cases, it makes sense for hello app tooshow this "connect" view only after a user has signed in with a work or school Microsoft account.</span></span>

<span data-ttu-id="598aa-204">När du registrerar hello användaren i tooyour app kan du identifiera hello organisation toowhich Hej administratör tillhör innan ber dem tooapprove hello-behörighet.</span><span class="sxs-lookup"><span data-stu-id="598aa-204">When you sign hello user in tooyour app, you can identify hello organization toowhich hello admin belongs before asking them tooapprove hello necessary permissions.</span></span> <span data-ttu-id="598aa-205">Även om det inte är absolut nödvändigt, hjälper som dig att skapa en mer intuitiv upplevelse för din organisations användare.</span><span class="sxs-lookup"><span data-stu-id="598aa-205">Although not strictly necessary, it can help you create a more intuitive experience for your organizational users.</span></span> <span data-ttu-id="598aa-206">toosign hello användare i Följ våra [v2.0-protokollet självstudier](active-directory-v2-protocols.md).</span><span class="sxs-lookup"><span data-stu-id="598aa-206">toosign hello user in, follow our [v2.0 protocol tutorials](active-directory-v2-protocols.md).</span></span>

### <a name="request-hello-permissions-from-a-directory-admin"></a><span data-ttu-id="598aa-207">Begär hello behörighet från en katalogadministratör</span><span class="sxs-lookup"><span data-stu-id="598aa-207">Request hello permissions from a directory admin</span></span>
<span data-ttu-id="598aa-208">När du är klar toorequest behörigheter från din organisations administratör kan du omdirigera hello användaren toohello v2.0 *medgivande adminslutpunkten*.</span><span class="sxs-lookup"><span data-stu-id="598aa-208">When you're ready toorequest permissions from your organization's admin, you can redirect hello user toohello v2.0 *admin consent endpoint*.</span></span>

```
// Line breaks are for legibility only.

GET https://login.microsoftonline.com/{tenant}/adminconsent?
client_id=6731de76-14a6-49ae-97bc-6eba6914391e
&state=12345
&redirect_uri=http://localhost/myapp/permissions
```

```
// Pro tip: Try pasting hello below request in a browser!
```

```
https://login.microsoftonline.com/common/adminconsent?client_id=6731de76-14a6-49ae-97bc-6eba6914391e&state=12345&redirect_uri=http://localhost/myapp/permissions
```

| <span data-ttu-id="598aa-209">Parameter</span><span class="sxs-lookup"><span data-stu-id="598aa-209">Parameter</span></span> | <span data-ttu-id="598aa-210">Villkor</span><span class="sxs-lookup"><span data-stu-id="598aa-210">Condition</span></span> | <span data-ttu-id="598aa-211">Beskrivning</span><span class="sxs-lookup"><span data-stu-id="598aa-211">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="598aa-212">Klient</span><span class="sxs-lookup"><span data-stu-id="598aa-212">tenant</span></span> |<span data-ttu-id="598aa-213">Krävs</span><span class="sxs-lookup"><span data-stu-id="598aa-213">Required</span></span> |<span data-ttu-id="598aa-214">hello directory-klient som du vill toorequest tillstånd.</span><span class="sxs-lookup"><span data-stu-id="598aa-214">hello directory tenant that you want toorequest permission from.</span></span> <span data-ttu-id="598aa-215">Kan anges i GUID- eller format för eget namn.</span><span class="sxs-lookup"><span data-stu-id="598aa-215">Can be provided in GUID or friendly name format.</span></span> |
| <span data-ttu-id="598aa-216">client_id</span><span class="sxs-lookup"><span data-stu-id="598aa-216">client_id</span></span> |<span data-ttu-id="598aa-217">Krävs</span><span class="sxs-lookup"><span data-stu-id="598aa-217">Required</span></span> |<span data-ttu-id="598aa-218">hello program-ID som hello [Programregistreringsportalen](https://apps.dev.microsoft.com/?referrer=https://azure.microsoft.com/documentation/articles&deeplink=/appList) tilldelade tooyour app.</span><span class="sxs-lookup"><span data-stu-id="598aa-218">hello Application ID that hello [Application Registration Portal](https://apps.dev.microsoft.com/?referrer=https://azure.microsoft.com/documentation/articles&deeplink=/appList) assigned tooyour app.</span></span> |
| <span data-ttu-id="598aa-219">redirect_uri</span><span class="sxs-lookup"><span data-stu-id="598aa-219">redirect_uri</span></span> |<span data-ttu-id="598aa-220">Krävs</span><span class="sxs-lookup"><span data-stu-id="598aa-220">Required</span></span> |<span data-ttu-id="598aa-221">hello omdirigerings-URI där du vill att hello svar toobe skickas för din app toohandle.</span><span class="sxs-lookup"><span data-stu-id="598aa-221">hello redirect URI where you want hello response toobe sent for your app toohandle.</span></span> <span data-ttu-id="598aa-222">Den måste matcha en hello omdirigerings-URI: er som du har registrerat i portalen för registrering av hello-app.</span><span class="sxs-lookup"><span data-stu-id="598aa-222">It must exactly match one of hello redirect URIs that you registered in hello app registration portal.</span></span> |
| <span data-ttu-id="598aa-223">state</span><span class="sxs-lookup"><span data-stu-id="598aa-223">state</span></span> |<span data-ttu-id="598aa-224">Rekommenderas</span><span class="sxs-lookup"><span data-stu-id="598aa-224">Recommended</span></span> |<span data-ttu-id="598aa-225">Ett värde som ingår i hello-begäran som returneras också hello token svar.</span><span class="sxs-lookup"><span data-stu-id="598aa-225">A value included in hello request that will also be returned in hello token response.</span></span> <span data-ttu-id="598aa-226">Det kan vara en sträng med innehåll.</span><span class="sxs-lookup"><span data-stu-id="598aa-226">It can be a string of any content you want.</span></span> <span data-ttu-id="598aa-227">Du kan använda hello tooencode statusinformation om hello användarens tillstånd i hello app innan hello autentiseringsbegäran inträffade, exempelvis hello sida eller visa de befann sig i.</span><span class="sxs-lookup"><span data-stu-id="598aa-227">Use hello state tooencode information about hello user's state in hello app before hello authentication request occurred, such as hello page or view they were on.</span></span> |

<span data-ttu-id="598aa-228">Azure AD kräver nu en klient administratören toosign i toocomplete hello begäran.</span><span class="sxs-lookup"><span data-stu-id="598aa-228">At this point, Azure AD requires a tenant administrator toosign in toocomplete hello request.</span></span> <span data-ttu-id="598aa-229">Hej administratör uppmanas tooapprove alla hello behörigheter som du har begärt för din app i portalen för registrering av hello-app.</span><span class="sxs-lookup"><span data-stu-id="598aa-229">hello administrator is asked tooapprove all hello permissions that you have requested for your app in hello app registration portal.</span></span>

#### <a name="successful-response"></a><span data-ttu-id="598aa-230">Lyckat svar</span><span class="sxs-lookup"><span data-stu-id="598aa-230">Successful response</span></span>
<span data-ttu-id="598aa-231">Om Hej administratör godkänner hello behörigheter för din app, hello lyckat svar som ser ut så här:</span><span class="sxs-lookup"><span data-stu-id="598aa-231">If hello admin approves hello permissions for your app, hello successful response looks like this:</span></span>

```
GET http://localhost/myapp/permissions?tenant=a8990e1f-ff32-408a-9f8e-78d3b9139b95&state=state=12345&admin_consent=True
```

| <span data-ttu-id="598aa-232">Parameter</span><span class="sxs-lookup"><span data-stu-id="598aa-232">Parameter</span></span> | <span data-ttu-id="598aa-233">Beskrivning</span><span class="sxs-lookup"><span data-stu-id="598aa-233">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="598aa-234">Klient</span><span class="sxs-lookup"><span data-stu-id="598aa-234">tenant</span></span> |<span data-ttu-id="598aa-235">hello directory-klient som beviljats behörighet programmet hello det begäras, i GUID-format.</span><span class="sxs-lookup"><span data-stu-id="598aa-235">hello directory tenant that granted your application hello permissions it requested, in GUID format.</span></span> |
| <span data-ttu-id="598aa-236">state</span><span class="sxs-lookup"><span data-stu-id="598aa-236">state</span></span> |<span data-ttu-id="598aa-237">Ett värde som ingår i hello-begäran som också kommer att returneras i hello token svar.</span><span class="sxs-lookup"><span data-stu-id="598aa-237">A value included in hello request that also will be returned in hello token response.</span></span> <span data-ttu-id="598aa-238">Det kan vara en sträng med innehåll.</span><span class="sxs-lookup"><span data-stu-id="598aa-238">It can be a string of any content you want.</span></span> <span data-ttu-id="598aa-239">hello tillstånd är används tooencode information om hello användarens tillstånd i hello app innan hello autentiseringsbegäran inträffade, exempelvis hello sida eller vy som de var på.</span><span class="sxs-lookup"><span data-stu-id="598aa-239">hello state is used tooencode information about hello user's state in hello app before hello authentication request occurred, such as hello page or view they were on.</span></span> |
| <span data-ttu-id="598aa-240">admin_consent</span><span class="sxs-lookup"><span data-stu-id="598aa-240">admin_consent</span></span> |<span data-ttu-id="598aa-241">Ställs in för**SANT**.</span><span class="sxs-lookup"><span data-stu-id="598aa-241">Will be set too**true**.</span></span> |

#### <a name="error-response"></a><span data-ttu-id="598aa-242">Felsvar</span><span class="sxs-lookup"><span data-stu-id="598aa-242">Error response</span></span>
<span data-ttu-id="598aa-243">Om Hej administratör inte godkänner hello behörigheter för din app misslyckades hello svar ser ut så här:</span><span class="sxs-lookup"><span data-stu-id="598aa-243">If hello admin does not approve hello permissions for your app, hello failed response looks like this:</span></span>

```
GET http://localhost/myapp/permissions?error=permission_denied&error_description=The+admin+canceled+the+request
```

| <span data-ttu-id="598aa-244">Parameter</span><span class="sxs-lookup"><span data-stu-id="598aa-244">Parameter</span></span> | <span data-ttu-id="598aa-245">Beskrivning</span><span class="sxs-lookup"><span data-stu-id="598aa-245">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="598aa-246">fel</span><span class="sxs-lookup"><span data-stu-id="598aa-246">error</span></span> |<span data-ttu-id="598aa-247">Ett felkod sträng som kan använda tooclassify typer av fel som inträffar och kan vara används tooreact tooerrors.</span><span class="sxs-lookup"><span data-stu-id="598aa-247">An error code string that can be used tooclassify types of errors that occur, and can be used tooreact tooerrors.</span></span> |
| <span data-ttu-id="598aa-248">error_description</span><span class="sxs-lookup"><span data-stu-id="598aa-248">error_description</span></span> |<span data-ttu-id="598aa-249">Ett felmeddelande som kan hjälpa utvecklare identifiera hello orsaken till felet.</span><span class="sxs-lookup"><span data-stu-id="598aa-249">A specific error message that can help a developer identify hello root cause of an error.</span></span> |

<span data-ttu-id="598aa-250">När du har fått ett lyckat svar från hello adminslutpunkten medgivande, har din app fått hello behörigheter begärde.</span><span class="sxs-lookup"><span data-stu-id="598aa-250">After you've received a successful response from hello admin consent endpoint, your app has gained hello permissions it requested.</span></span> <span data-ttu-id="598aa-251">Därefter kan du begära en token för hello-resurs som du vill.</span><span class="sxs-lookup"><span data-stu-id="598aa-251">Next, you can request a token for hello resource you want.</span></span>

## <a name="using-permissions"></a><span data-ttu-id="598aa-252">Med behörigheter</span><span class="sxs-lookup"><span data-stu-id="598aa-252">Using permissions</span></span>
<span data-ttu-id="598aa-253">När hello användaren godkänner toopermissions för din app, kan din app hämta åtkomsttoken som representerar appens behörighet tooaccess en resurs i vissa kapacitet.</span><span class="sxs-lookup"><span data-stu-id="598aa-253">After hello user consents toopermissions for your app, your app can acquire access tokens that represent your app's permission tooaccess a resource in some capacity.</span></span> <span data-ttu-id="598aa-254">En åtkomst-token kan endast användas för en enskild resurs, men kodad i hello åtkomst-token är varje behörighet som din app har beviljats för den här resursen.</span><span class="sxs-lookup"><span data-stu-id="598aa-254">An access token can be used only for a single resource, but encoded inside hello access token is every permission that your app has been granted for that resource.</span></span> <span data-ttu-id="598aa-255">tooacquire en åtkomst-token appen kan göra en förfrågan toohello v2.0 tokenslutpunkten, så här:</span><span class="sxs-lookup"><span data-stu-id="598aa-255">tooacquire an access token, your app can make a request toohello v2.0 token endpoint, like this:</span></span>

```
POST common/oauth2/v2.0/token HTTP/1.1
Host: https://login.microsoftonline.com
Content-Type: application/json

{
    "grant_type": "authorization_code",
    "client_id": "6731de76-14a6-49ae-97bc-6eba6914391e",
    "scope": "https://outlook.office.com/mail.read https://outlook.office.com/mail.send",
    "code": "AwABAAAAvPM1KaPlrEqdFSBzjqfTGBCmLdgfSTLEMPGYuNHSUYBrq..."
    "redirect_uri": "https://localhost/myapp",
    "client_secret": "zc53fwe80980293klaj9823"  // NOTE: Only required for web apps
}
```

<span data-ttu-id="598aa-256">Du kan använda hello resulterande åtkomst-token i HTTP-begäranden toohello resursen.</span><span class="sxs-lookup"><span data-stu-id="598aa-256">You can use hello resulting access token in HTTP requests toohello resource.</span></span> <span data-ttu-id="598aa-257">På ett tillförlitligt sätt anger toohello resurs att din app har hello rätt behörighet tooperform en viss uppgift.</span><span class="sxs-lookup"><span data-stu-id="598aa-257">It reliably indicates toohello resource that your app has hello proper permission tooperform a specific task.</span></span>  

<span data-ttu-id="598aa-258">Mer information om hello OAuth 2.0-protokollet och hur tooget åtkomsttoken, se hello [protokollreferens för v2.0-slutpunkten](active-directory-v2-protocols.md).</span><span class="sxs-lookup"><span data-stu-id="598aa-258">For more information about hello OAuth 2.0 protocol and how tooget access tokens, see hello [v2.0 endpoint protocol reference](active-directory-v2-protocols.md).</span></span>
