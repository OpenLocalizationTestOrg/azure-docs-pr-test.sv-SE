---
title: "Kom igång med roller, behörigheter och säkerhet med Azure-Monitor | Microsoft Docs"
description: "Lär dig hur du använder Azure-Monitor inbyggda roller och behörigheter för att begränsa åtkomsten till övervakning resurser."
author: johnkemnetz
manager: orenr
editor: 
services: monitoring-and-diagnostics
documentationcenter: monitoring-and-diagnostics
ms.assetid: 2686e53b-72f0-4312-bcd3-3dc1b4a9b912
ms.service: monitoring-and-diagnostics
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 09/26/2016
ms.author: johnkem
ms.openlocfilehash: a28f971ae898ffdd1168550a909f2a48e1b3b652
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 08/18/2017
---
# <a name="get-started-with-roles-permissions-and-security-with-azure-monitor"></a><span data-ttu-id="87114-103">Kom igång med roller, behörigheter och säkerhet med Azure-Monitor</span><span class="sxs-lookup"><span data-stu-id="87114-103">Get started with roles, permissions, and security with Azure Monitor</span></span>
<span data-ttu-id="87114-104">Många grupper behöver strikt reglera åtkomst till övervakningsdata och inställningar.</span><span class="sxs-lookup"><span data-stu-id="87114-104">Many teams need to strictly regulate access to monitoring data and settings.</span></span> <span data-ttu-id="87114-105">Till exempel om du har gruppmedlemmar som arbetar enbart om hur du övervakar (supporttekniker, devops engineers) eller om du använder en leverantör av hanterade tjänster, kanske du vill bevilja dem åtkomst till endast övervakningsdata samtidigt begränsa deras möjlighet att skapa, ändra, eller ta bort resurser.</span><span class="sxs-lookup"><span data-stu-id="87114-105">For example, if you have team members who work exclusively on monitoring (support engineers, devops engineers) or if you use a managed service provider, you may want to grant them access to only monitoring data while restricting their ability to create, modify, or delete resources.</span></span> <span data-ttu-id="87114-106">Den här artikeln visar hur du snabbt vill använda en inbyggd övervakning RBAC roll till en användare i Azure eller skapa egna anpassade roll för en användare behöver begränsade behörigheter för övervakning.</span><span class="sxs-lookup"><span data-stu-id="87114-106">This article shows how to quickly apply a built-in monitoring RBAC role to a user in Azure or build your own custom role for a user who needs limited monitoring permissions.</span></span> <span data-ttu-id="87114-107">Sedan diskuterar det säkerhetsaspekter för dina Azure-Monitor-relaterade resurser och hur du kan begränsa åtkomst till de data som de innehåller.</span><span class="sxs-lookup"><span data-stu-id="87114-107">It then discusses security considerations for your Azure Monitor-related resources and how you can limit access to the data they contain.</span></span>

## <a name="built-in-monitoring-roles"></a><span data-ttu-id="87114-108">Inbyggda övervakning roller</span><span class="sxs-lookup"><span data-stu-id="87114-108">Built-in monitoring roles</span></span>
<span data-ttu-id="87114-109">Azure övervakaren inbyggda roller är utformade för att begränsa åtkomsten till resurser i en prenumeration samtidigt som de ansvariga för övervakning av infrastruktur för att hämta och konfigurera data de behöver.</span><span class="sxs-lookup"><span data-stu-id="87114-109">Azure Monitor’s built-in roles are designed to help limit access to resources in a subscription while still enabling those responsible for monitoring infrastructure to obtain and configure the data they need.</span></span> <span data-ttu-id="87114-110">Azure övervakning ger två out box-roller: en övervakning läsare och deltagare övervakning.</span><span class="sxs-lookup"><span data-stu-id="87114-110">Azure Monitor provides two out-of-the-box roles: A Monitoring Reader and a Monitoring Contributor.</span></span>

### <a name="monitoring-reader"></a><span data-ttu-id="87114-111">Övervaka läsare</span><span class="sxs-lookup"><span data-stu-id="87114-111">Monitoring Reader</span></span>
<span data-ttu-id="87114-112">Personer som har rollen som läsare övervakning kan visa alla övervakningsdata i en prenumeration men kan inte ändra en resurs eller redigera några inställningar som rör övervakning resurser.</span><span class="sxs-lookup"><span data-stu-id="87114-112">People assigned the Monitoring Reader role can view all monitoring data in a subscription but cannot modify any resource or edit any settings related to monitoring resources.</span></span> <span data-ttu-id="87114-113">Den här rollen är lämplig för användare i en organisation, till exempel support eller åtgärder tekniker, som behöver kunna:</span><span class="sxs-lookup"><span data-stu-id="87114-113">This role is appropriate for users in an organization, such as support or operations engineers, who need to be able to:</span></span>

* <span data-ttu-id="87114-114">Visa övervakning instrumentpaneler i portalen och skapa sina egna privata övervakning instrumentpaneler.</span><span class="sxs-lookup"><span data-stu-id="87114-114">View monitoring dashboards in the portal and create their own private monitoring dashboards.</span></span>
* <span data-ttu-id="87114-115">Frågan för mått med hjälp av den [REST-API för Azure-Monitor](https://msdn.microsoft.com/library/azure/dn931930.aspx), [PowerShell-cmdlets](insights-powershell-samples.md), eller [plattformsoberoende CLI](insights-cli-samples.md).</span><span class="sxs-lookup"><span data-stu-id="87114-115">Query for metrics using the [Azure Monitor REST API](https://msdn.microsoft.com/library/azure/dn931930.aspx), [PowerShell cmdlets](insights-powershell-samples.md), or [cross-platform CLI](insights-cli-samples.md).</span></span>
* <span data-ttu-id="87114-116">Fråga aktivitetsloggen med hjälp av portalen, Azure övervakaren REST API: et, PowerShell-cmdlets eller plattformsoberoende CLI.</span><span class="sxs-lookup"><span data-stu-id="87114-116">Query the Activity Log using the portal, Azure Monitor REST API, PowerShell cmdlets, or cross-platform CLI.</span></span>
* <span data-ttu-id="87114-117">Visa den [diagnostikinställningar](monitoring-overview-of-diagnostic-logs.md#resource-diagnostic-settings) för en resurs.</span><span class="sxs-lookup"><span data-stu-id="87114-117">View the [diagnostic settings](monitoring-overview-of-diagnostic-logs.md#resource-diagnostic-settings) for a resource.</span></span>
* <span data-ttu-id="87114-118">Visa den [logga profil](monitoring-overview-activity-logs.md#export-the-activity-log-with-a-log-profile) för en prenumeration.</span><span class="sxs-lookup"><span data-stu-id="87114-118">View the [log profile](monitoring-overview-activity-logs.md#export-the-activity-log-with-a-log-profile) for a subscription.</span></span>
* <span data-ttu-id="87114-119">Visa Autoskala inställningar.</span><span class="sxs-lookup"><span data-stu-id="87114-119">View autoscale settings.</span></span>
* <span data-ttu-id="87114-120">Visa avisering aktivitet och inställningar.</span><span class="sxs-lookup"><span data-stu-id="87114-120">View alert activity and settings.</span></span>
* <span data-ttu-id="87114-121">Åtkomst till Application Insights-data och visa data i AI Analytics.</span><span class="sxs-lookup"><span data-stu-id="87114-121">Access Application Insights data and view data in AI Analytics.</span></span>
* <span data-ttu-id="87114-122">Sök logganalys (OMS) arbetsytan data inklusive användningsdata för arbetsytan.</span><span class="sxs-lookup"><span data-stu-id="87114-122">Search Log Analytics (OMS) workspace data including usage data for the workspace.</span></span>
* <span data-ttu-id="87114-123">Visa hanteringsgrupper för logganalys (OMS).</span><span class="sxs-lookup"><span data-stu-id="87114-123">View Log Analytics (OMS) management groups.</span></span>
* <span data-ttu-id="87114-124">Hämta Sök schemat logganalys (OMS).</span><span class="sxs-lookup"><span data-stu-id="87114-124">Retrieve the Log Analytics (OMS) search schema.</span></span>
* <span data-ttu-id="87114-125">Lista över logganalys (OMS) intelligence Pack.</span><span class="sxs-lookup"><span data-stu-id="87114-125">List Log Analytics (OMS) intelligence packs.</span></span>
* <span data-ttu-id="87114-126">Hämta och köra logganalys (OMS) sparade sökningar.</span><span class="sxs-lookup"><span data-stu-id="87114-126">Retrieve and execute Log Analytics (OMS) saved searches.</span></span>
* <span data-ttu-id="87114-127">Hämta lagringskonfiguration logganalys (OMS).</span><span class="sxs-lookup"><span data-stu-id="87114-127">Retrieve the Log Analytics (OMS) storage configuration.</span></span>

> [!NOTE]
> <span data-ttu-id="87114-128">Den här rollen ger inte läsbehörighet till loggdata som strömmas till en händelsehubb eller lagras i ett lagringskonto.</span><span class="sxs-lookup"><span data-stu-id="87114-128">This role does not give read access to log data that has been streamed to an event hub or stored in a storage account.</span></span> <span data-ttu-id="87114-129">[Se nedan](#security-considerations-for-monitoring-data) information om hur du konfigurerar åtkomst till dessa resurser.</span><span class="sxs-lookup"><span data-stu-id="87114-129">[See below](#security-considerations-for-monitoring-data) for information on configuring access to these resources.</span></span>
> 
> 

### <a name="monitoring-contributor"></a><span data-ttu-id="87114-130">Övervakning av deltagare</span><span class="sxs-lookup"><span data-stu-id="87114-130">Monitoring Contributor</span></span>
<span data-ttu-id="87114-131">Personer som har tilldelats rollen övervakning deltagare kan visa alla övervakningsdata i en prenumeration och skapa eller ändra inställningar för övervakning, men det går inte att ändra andra resurser.</span><span class="sxs-lookup"><span data-stu-id="87114-131">People assigned the Monitoring Contributor role can view all monitoring data in a subscription and create or modify monitoring settings, but cannot modify any other resources.</span></span> <span data-ttu-id="87114-132">Den här rollen är en supermängd övervakning läsare och är lämplig för medlemmar i en organisation övervakning team eller hanterade tjänsteleverantörer, förutom behörigheterna som ovan, måste också kunna:</span><span class="sxs-lookup"><span data-stu-id="87114-132">This role is a superset of the Monitoring Reader role, and is appropriate for members of an organization’s monitoring team or managed service providers who, in addition to the permissions above, also need to be able to:</span></span>

* <span data-ttu-id="87114-133">Publicera övervakning instrumentpaneler som en delad instrumentpanel.</span><span class="sxs-lookup"><span data-stu-id="87114-133">Publish monitoring dashboards as a shared dashboard.</span></span>
* <span data-ttu-id="87114-134">Ange [diagnostikinställningar](monitoring-overview-of-diagnostic-logs.md#resource-diagnostic-settings) för en resource.*</span><span class="sxs-lookup"><span data-stu-id="87114-134">Set [diagnostic settings](monitoring-overview-of-diagnostic-logs.md#resource-diagnostic-settings) for a resource.*</span></span>
* <span data-ttu-id="87114-135">Ange den [logga profil](monitoring-overview-activity-logs.md#export-the-activity-log-with-a-log-profile) för en subscription.*</span><span class="sxs-lookup"><span data-stu-id="87114-135">Set the [log profile](monitoring-overview-activity-logs.md#export-the-activity-log-with-a-log-profile) for a subscription.*</span></span>
* <span data-ttu-id="87114-136">Ange varning aktivitet och inställningar.</span><span class="sxs-lookup"><span data-stu-id="87114-136">Set alert activity and settings.</span></span>
* <span data-ttu-id="87114-137">Skapa webbtester med Application Insights och komponenter.</span><span class="sxs-lookup"><span data-stu-id="87114-137">Create Application Insights web tests and components.</span></span>
* <span data-ttu-id="87114-138">Logganalys (OMS) arbetsyta delade nycklar.</span><span class="sxs-lookup"><span data-stu-id="87114-138">List Log Analytics (OMS) workspace shared keys.</span></span>
* <span data-ttu-id="87114-139">Aktivera eller inaktivera logganalys (OMS) intelligence Pack.</span><span class="sxs-lookup"><span data-stu-id="87114-139">Enable or disable Log Analytics (OMS) intelligence packs.</span></span>
* <span data-ttu-id="87114-140">Skapa och ta bort och köra logganalys (OMS) sparade sökningar.</span><span class="sxs-lookup"><span data-stu-id="87114-140">Create and delete and execute Log Analytics (OMS) saved searches.</span></span>
* <span data-ttu-id="87114-141">Skapa och ta bort konfigurationen av logganalys (OMS).</span><span class="sxs-lookup"><span data-stu-id="87114-141">Create and delete the Log Analytics (OMS) storage configuration.</span></span>

<span data-ttu-id="87114-142">* användaren måste också ha behörigheten ListKeys på målresursen (storage-konto eller händelse hubb namnområde) att ställa in en logg profil eller diagnostikinställningen.</span><span class="sxs-lookup"><span data-stu-id="87114-142">*user must also separately be granted ListKeys permission on the target resource (storage account or event hub namespace) to set a log profile or diagnostic setting.</span></span>

> [!NOTE]
> <span data-ttu-id="87114-143">Den här rollen ger inte läsbehörighet till loggdata som strömmas till en händelsehubb eller lagras i ett lagringskonto.</span><span class="sxs-lookup"><span data-stu-id="87114-143">This role does not give read access to log data that has been streamed to an event hub or stored in a storage account.</span></span> <span data-ttu-id="87114-144">[Se nedan](#security-considerations-for-monitoring-data) information om hur du konfigurerar åtkomst till dessa resurser.</span><span class="sxs-lookup"><span data-stu-id="87114-144">[See below](#security-considerations-for-monitoring-data) for information on configuring access to these resources.</span></span>
> 
> 

## <a name="monitoring-permissions-and-custom-rbac-roles"></a><span data-ttu-id="87114-145">Övervaka behörigheter och anpassade RBAC-roller</span><span class="sxs-lookup"><span data-stu-id="87114-145">Monitoring permissions and custom RBAC roles</span></span>
<span data-ttu-id="87114-146">Om ovanstående inbyggda roller inte passar exakt ditt team, kan du [skapa en anpassad roll RBAC](../active-directory/role-based-access-control-custom-roles.md) med mer detaljerade behörigheter.</span><span class="sxs-lookup"><span data-stu-id="87114-146">If the above built-in roles don’t meet the exact needs of your team, you can [create a custom RBAC role](../active-directory/role-based-access-control-custom-roles.md) with more granular permissions.</span></span> <span data-ttu-id="87114-147">Nedan visas vanliga Azure övervakaren RBAC-åtgärder med deras beskrivningar.</span><span class="sxs-lookup"><span data-stu-id="87114-147">Below are the common Azure Monitor RBAC operations with their descriptions.</span></span>

| <span data-ttu-id="87114-148">Åtgärd</span><span class="sxs-lookup"><span data-stu-id="87114-148">Operation</span></span> | <span data-ttu-id="87114-149">Beskrivning</span><span class="sxs-lookup"><span data-stu-id="87114-149">Description</span></span> |
| --- | --- |
| <span data-ttu-id="87114-150">Ta bort Microsoft.Insights/AlertRules/[Read, skriva]</span><span class="sxs-lookup"><span data-stu-id="87114-150">Microsoft.Insights/AlertRules/[Read, Write, Delete]</span></span> |<span data-ttu-id="87114-151">Läs/Skriv/ta bort Varningsregler.</span><span class="sxs-lookup"><span data-stu-id="87114-151">Read/write/delete alert rules.</span></span> |
| <span data-ttu-id="87114-152">Microsoft.Insights/AlertRules/Incidents/Read</span><span class="sxs-lookup"><span data-stu-id="87114-152">Microsoft.Insights/AlertRules/Incidents/Read</span></span> |<span data-ttu-id="87114-153">Lista över incidenter (historik över varningsregeln som utlöses) för Varningsregler.</span><span class="sxs-lookup"><span data-stu-id="87114-153">List incidents (history of the alert rule being triggered) for alert rules.</span></span> <span data-ttu-id="87114-154">Detta gäller endast för portalen.</span><span class="sxs-lookup"><span data-stu-id="87114-154">This only applies to the portal.</span></span> |
| <span data-ttu-id="87114-155">Ta bort Microsoft.Insights/AutoscaleSettings/[Read, skriva]</span><span class="sxs-lookup"><span data-stu-id="87114-155">Microsoft.Insights/AutoscaleSettings/[Read, Write, Delete]</span></span> |<span data-ttu-id="87114-156">Läs/Skriv/ta bort Autoskala inställningar.</span><span class="sxs-lookup"><span data-stu-id="87114-156">Read/write/delete autoscale settings.</span></span> |
| <span data-ttu-id="87114-157">Ta bort Microsoft.Insights/DiagnosticSettings/[Read, skriva]</span><span class="sxs-lookup"><span data-stu-id="87114-157">Microsoft.Insights/DiagnosticSettings/[Read, Write, Delete]</span></span> |<span data-ttu-id="87114-158">Diagnostikinställningar för Läs/Skriv/ta bort.</span><span class="sxs-lookup"><span data-stu-id="87114-158">Read/write/delete diagnostic settings.</span></span> |
| <span data-ttu-id="87114-159">Microsoft.Insights/eventtypes/digestevents/Read</span><span class="sxs-lookup"><span data-stu-id="87114-159">Microsoft.Insights/eventtypes/digestevents/Read</span></span> |<span data-ttu-id="87114-160">Den här behörigheten krävs för användare som behöver åtkomst till aktivitetsloggar via portalen.</span><span class="sxs-lookup"><span data-stu-id="87114-160">This permission is necessary for users who need access to Activity Logs via the portal.</span></span> |
| <span data-ttu-id="87114-161">Microsoft.Insights/eventtypes/values/Read</span><span class="sxs-lookup"><span data-stu-id="87114-161">Microsoft.Insights/eventtypes/values/Read</span></span> |<span data-ttu-id="87114-162">Lista över aktivitetsloggen händelser (management-händelser) i en prenumeration.</span><span class="sxs-lookup"><span data-stu-id="87114-162">List Activity Log events (management events) in a subscription.</span></span> <span data-ttu-id="87114-163">Den här behörigheten gäller både programmässiga och portal åtkomst till aktivitetsloggen.</span><span class="sxs-lookup"><span data-stu-id="87114-163">This permission is applicable to both programmatic and portal access to the Activity Log.</span></span> |
| <span data-ttu-id="87114-164">Microsoft.Insights/LogDefinitions/Read</span><span class="sxs-lookup"><span data-stu-id="87114-164">Microsoft.Insights/LogDefinitions/Read</span></span> |<span data-ttu-id="87114-165">Den här behörigheten krävs för användare som behöver åtkomst till aktivitetsloggar via portalen.</span><span class="sxs-lookup"><span data-stu-id="87114-165">This permission is necessary for users who need access to Activity Logs via the portal.</span></span> |
| <span data-ttu-id="87114-166">Microsoft.Insights/MetricDefinitions/Read</span><span class="sxs-lookup"><span data-stu-id="87114-166">Microsoft.Insights/MetricDefinitions/Read</span></span> |<span data-ttu-id="87114-167">Läs måttdefinitionerna (lista över tillgängliga mått typer för en resurs).</span><span class="sxs-lookup"><span data-stu-id="87114-167">Read metric definitions (list of available metric types for a resource).</span></span> |
| <span data-ttu-id="87114-168">Microsoft.Insights/Metrics/Read</span><span class="sxs-lookup"><span data-stu-id="87114-168">Microsoft.Insights/Metrics/Read</span></span> |<span data-ttu-id="87114-169">Läsa måtten för en resurs.</span><span class="sxs-lookup"><span data-stu-id="87114-169">Read metrics for a resource.</span></span> |

> [!NOTE]
> <span data-ttu-id="87114-170">Åtkomst till aviseringar, diagnostikinställningar och mått för en resurs som kräver att användaren har läsbehörighet till resurstyp och omfånget för den här resursen.</span><span class="sxs-lookup"><span data-stu-id="87114-170">Access to alerts, diagnostic settings, and metrics for a resource requires that the user has Read access to the resource type and scope of that resource.</span></span> <span data-ttu-id="87114-171">En inställning eller loggfil diagnostikprofil som arkiveras till ett lagringskonto eller dataströmmar i händelsehubbar kräver skapar (”write”) att användaren har behörighet att ListKeys även på målresursen.</span><span class="sxs-lookup"><span data-stu-id="87114-171">Creating (“write”) a diagnostic setting or log profile that archives to a storage account or streams to event hubs requires the user to also have ListKeys permission on the target resource.</span></span>
> 
> 

<span data-ttu-id="87114-172">Till exempel använder tabellen ovan som du kan skapa en anpassad RBAC-roll för en ”aktivitet Händelseloggläsare” så här:</span><span class="sxs-lookup"><span data-stu-id="87114-172">For example, using the above table you could create a custom RBAC role for an “Activity Log Reader” like this:</span></span>

```powershell
$role = Get-AzureRmRoleDefinition "Reader"
$role.Id = $null
$role.Name = "Activity Log Reader"
$role.Description = "Can view activity logs."
$role.Actions.Clear()
$role.Actions.Add("Microsoft.Insights/eventtypes/*")
$role.AssignableScopes.Clear()
$role.AssignableScopes.Add("/subscriptions/mySubscription")
New-AzureRmRoleDefinition -Role $role 
```

## <a name="security-considerations-for-monitoring-data"></a><span data-ttu-id="87114-173">Säkerhetsaspekter för övervakning av data</span><span class="sxs-lookup"><span data-stu-id="87114-173">Security considerations for monitoring data</span></span>
<span data-ttu-id="87114-174">Övervakningsdata – särskilt loggfiler, kan innehålla känslig information, till exempel IP-adresser eller användarnamn.</span><span class="sxs-lookup"><span data-stu-id="87114-174">Monitoring data—particularly log files—can contain sensitive information, such as IP addresses or user names.</span></span> <span data-ttu-id="87114-175">Övervakningsdata från Azure levereras i tre grundläggande formulär:</span><span class="sxs-lookup"><span data-stu-id="87114-175">Monitoring data from Azure comes in three basic forms:</span></span>

1. <span data-ttu-id="87114-176">Aktivitetsloggen, som beskriver alla kontroll-plan åtgärder på Azure-prenumerationen.</span><span class="sxs-lookup"><span data-stu-id="87114-176">The Activity Log, which describes all control-plane actions on your Azure subscription.</span></span>
2. <span data-ttu-id="87114-177">Diagnostikloggar som loggar som orsakat av en resurs.</span><span class="sxs-lookup"><span data-stu-id="87114-177">Diagnostic Logs, which are logs emitted by a resource.</span></span>
3. <span data-ttu-id="87114-178">Mått som orsakat av resurser.</span><span class="sxs-lookup"><span data-stu-id="87114-178">Metrics, which are emitted by resources.</span></span>

<span data-ttu-id="87114-179">Alla tre av följande datatyper kan lagras i ett lagringskonto eller strömmas till Event Hub, vilka båda allmänna Azure-resurser.</span><span class="sxs-lookup"><span data-stu-id="87114-179">All three of these data types can be stored in a storage account or streamed to Event Hub, both of which are general-purpose Azure resources.</span></span> <span data-ttu-id="87114-180">Eftersom de är allmänna resurser är att skapa, ta bort och att nå dem en privilegierad åtgärd som vanligtvis är reserverade för en administratör.</span><span class="sxs-lookup"><span data-stu-id="87114-180">Because these are general-purpose resources, creating, deleting, and accessing them is a privileged operation usually reserved for an administrator.</span></span> <span data-ttu-id="87114-181">Vi rekommenderar att du använder följande metoder för övervakning-relaterade resurser för att förhindra missbruk:</span><span class="sxs-lookup"><span data-stu-id="87114-181">We suggest that you use the following practices for monitoring-related resources to prevent misuse:</span></span>

* <span data-ttu-id="87114-182">Använd ett enda, särskilt storage-konto för övervakningsdata.</span><span class="sxs-lookup"><span data-stu-id="87114-182">Use a single, dedicated storage account for monitoring data.</span></span> <span data-ttu-id="87114-183">Om du behöver dela övervakningsdata i flera lagringskonton Dela aldrig användning av ett lagringskonto mellan övervakning och icke-övervakning av data, som det av misstag kan ge dem som bara behöver åtkomst till övervakningsdata (t.ex.</span><span class="sxs-lookup"><span data-stu-id="87114-183">If you need to separate monitoring data into multiple storage accounts, never share usage of a storage account between monitoring and non-monitoring data, as this may inadvertently give those who only need access to monitoring data (eg.</span></span> <span data-ttu-id="87114-184">en tredje parts SIEM) åtkomst till icke-övervakning av data.</span><span class="sxs-lookup"><span data-stu-id="87114-184">a third-party SIEM) access to non-monitoring data.</span></span>
* <span data-ttu-id="87114-185">Använd ett enda, särskilt Service Bus eller Event Hub namnområde i alla diagnostikinställningar av samma skäl som ovan.</span><span class="sxs-lookup"><span data-stu-id="87114-185">Use a single, dedicated Service Bus or Event Hub namespace across all diagnostic settings for the same reason as above.</span></span>
* <span data-ttu-id="87114-186">Begränsa åtkomsten till relaterade till prestandaövervakning storage-konton eller event hubs genom att hålla dem i en separat resursgrupp och [använda omfång](../active-directory/role-based-access-control-what-is.md#basics-of-access-management-in-azure) på din övervakning roller för att begränsa åtkomsten till endast resursgruppen.</span><span class="sxs-lookup"><span data-stu-id="87114-186">Limit access to monitoring-related storage accounts or event hubs by keeping them in a separate resource group, and [use scope](../active-directory/role-based-access-control-what-is.md#basics-of-access-management-in-azure) on your monitoring roles to limit access to only that resource group.</span></span>
* <span data-ttu-id="87114-187">Tilldela behörigheten ListKeys för storage-konton eller händelsehubbar definitionsområdet prenumerationen aldrig när en användare bara behöver åtkomst till övervakningsdata.</span><span class="sxs-lookup"><span data-stu-id="87114-187">Never grant the ListKeys permission for either storage accounts or event hubs at subscription scope when a user only needs access to monitoring data.</span></span> <span data-ttu-id="87114-188">I stället ge dessa behörigheter till användare på en resurs eller resursgrupp (om du har en särskild övervakning resursgrupp) omfång.</span><span class="sxs-lookup"><span data-stu-id="87114-188">Instead, give these permissions to the user at a resource or resource group (if you have a dedicated monitoring resource group) scope.</span></span>

### <a name="limiting-access-to-monitoring-related-storage-accounts"></a><span data-ttu-id="87114-189">Begränsa åtkomsten till relaterade till prestandaövervakning storage-konton</span><span class="sxs-lookup"><span data-stu-id="87114-189">Limiting access to monitoring-related storage accounts</span></span>
<span data-ttu-id="87114-190">När en användare eller ett program behöver tillgång till övervakningsdata i ett lagringskonto, bör du [Generera en konto-SAS](https://msdn.microsoft.com/library/azure/mt584140.aspx) på lagringskontot som innehåller övervakningsdata med servicenivåer skrivskyddad åtkomst till blob storage.</span><span class="sxs-lookup"><span data-stu-id="87114-190">When a user or application needs access to monitoring data in a storage account, you should [generate an Account SAS](https://msdn.microsoft.com/library/azure/mt584140.aspx) on the storage account that contains monitoring data with service-level read-only access to blob storage.</span></span> <span data-ttu-id="87114-191">Detta kan se ut i PowerShell:</span><span class="sxs-lookup"><span data-stu-id="87114-191">In PowerShell, this might look like:</span></span>

```powershell
$context = New-AzureStorageContext -ConnectionString "[connection string for your monitoring Storage Account]"
$token = New-AzureStorageAccountSASToken -ResourceType Service -Service Blob -Permission "rl" -Context $context
```

<span data-ttu-id="87114-192">Du kan ge token till entiteten att måste för att läsa från den lagringen konto och den kan listan och läsa från alla blobbar i det storage-kontot.</span><span class="sxs-lookup"><span data-stu-id="87114-192">You can then give the token to the entity that needs to read from that storage account, and it can list and read from all blobs in that storage account.</span></span>

<span data-ttu-id="87114-193">Alternativt, om du vill kontrollera den här behörigheten med RBAC du kan ge entiteten Microsoft.Storage/storageAccounts/listkeys/action behörighet för att viss storage-konto.</span><span class="sxs-lookup"><span data-stu-id="87114-193">Alternatively, if you need to control this permission with RBAC, you can grant that entity the Microsoft.Storage/storageAccounts/listkeys/action permission on that particular storage account.</span></span> <span data-ttu-id="87114-194">Detta är nödvändigt för användare som behöver för att kunna ställa in en diagnostiska inställning eller logga profilen för att arkivera till ett lagringskonto.</span><span class="sxs-lookup"><span data-stu-id="87114-194">This is necessary for users who need to be able to set a diagnostic setting or log profile to archive to a storage account.</span></span> <span data-ttu-id="87114-195">Du kan till exempel skapa följande anpassade RBAC roll för en användare eller program som behöver bara läsa från ett lagringskonto:</span><span class="sxs-lookup"><span data-stu-id="87114-195">For example, you could create the following custom RBAC role for a user or application that only needs to read from one storage account:</span></span>

```powershell
$role = Get-AzureRmRoleDefinition "Reader"
$role.Id = $null
$role.Name = "Monitoring Storage Account Reader"
$role.Description = "Can get the storage account keys for a monitoring storage account."
$role.Actions.Clear()
$role.Actions.Add("Microsoft.Storage/storageAccounts/listkeys/action")
$role.Actions.Add("Microsoft.Storage/storageAccounts/Read")
$role.AssignableScopes.Clear()
$role.AssignableScopes.Add("/subscriptions/mySubscription/resourceGroups/myResourceGroup/providers/Microsoft.Storage/storageAccounts/myMonitoringStorageAccount")
New-AzureRmRoleDefinition -Role $role 
```

> [!WARNING]
> <span data-ttu-id="87114-196">ListKeys tillåter användare att visa en lista med primära och sekundära lagringskontonycklar.</span><span class="sxs-lookup"><span data-stu-id="87114-196">The ListKeys permission enables the user to list the primary and secondary storage account keys.</span></span> <span data-ttu-id="87114-197">De här nycklarna bevilja användaren alla signerade behörigheter (läsa, skriva, skapa BLOB, ta bort blobbar osv) för alla signerade tjänster (blob, kön, tabell, fil) i detta lagringskonto.</span><span class="sxs-lookup"><span data-stu-id="87114-197">These keys grant the user all signed permissions (read, write, create blobs, delete blobs, etc.) across all signed services (blob, queue, table, file) in that storage account.</span></span> <span data-ttu-id="87114-198">Vi rekommenderar att du använder en konto-SAS ovan när det är möjligt.</span><span class="sxs-lookup"><span data-stu-id="87114-198">We recommend using an Account SAS described above when possible.</span></span>
> 
> 

### <a name="limiting-access-to-monitoring-related-event-hubs"></a><span data-ttu-id="87114-199">Begränsa åtkomsten till relaterade till prestandaövervakning händelsehubbar</span><span class="sxs-lookup"><span data-stu-id="87114-199">Limiting access to monitoring-related event hubs</span></span>
<span data-ttu-id="87114-200">Ett liknande mönster kan följas av händelsehubbar, men du måste först skapa en dedikerad lyssna auktoriseringsregeln.</span><span class="sxs-lookup"><span data-stu-id="87114-200">A similar pattern can be followed with event hubs, but first you need to create a dedicated Listen authorization rule.</span></span> <span data-ttu-id="87114-201">Om du vill bevilja åtkomst till ett program som endast ska lyssna på relaterade till prestandaövervakning händelsehubbar gör du följande:</span><span class="sxs-lookup"><span data-stu-id="87114-201">If you want to grant access to an application that only needs to listen to monitoring-related event hubs, do the following:</span></span>

1. <span data-ttu-id="87114-202">Skapa en princip för delad åtkomst på de händelse-nav som har skapats för strömning övervakningsdata med endast lyssna anspråk.</span><span class="sxs-lookup"><span data-stu-id="87114-202">Create a shared access policy on the event hub(s) that were created for streaming monitoring data with only Listen claims.</span></span> <span data-ttu-id="87114-203">Detta kan göras i portalen.</span><span class="sxs-lookup"><span data-stu-id="87114-203">This can be done in the portal.</span></span> <span data-ttu-id="87114-204">T.ex, kan du anropa den ”monitoringReadOnly”.</span><span class="sxs-lookup"><span data-stu-id="87114-204">For example, you might call it “monitoringReadOnly.”</span></span> <span data-ttu-id="87114-205">Om det är möjligt ska du ge nyckeln direkt till konsumenten och hoppa över nästa steg.</span><span class="sxs-lookup"><span data-stu-id="87114-205">If possible, you will want to give that key directly to the consumer and skip the next step.</span></span>
2. <span data-ttu-id="87114-206">Om klienten behöver för att kunna hämta den viktiga ad hoc-, bevilja användaren ListKeys åtgärd för att händelsehubb.</span><span class="sxs-lookup"><span data-stu-id="87114-206">If the consumer needs to be able to get the key ad-hoc, grant the user the ListKeys action for that event hub.</span></span> <span data-ttu-id="87114-207">Detta är också nödvändigt för användare som behöver för att kunna ställa in en diagnostiska inställning eller logga profil till en dataström i händelsehubbar.</span><span class="sxs-lookup"><span data-stu-id="87114-207">This is also necessary for users who need to be able to set a diagnostic setting or log profile to stream to event hubs.</span></span> <span data-ttu-id="87114-208">Du kan till exempel skapa en regel för RBAC:</span><span class="sxs-lookup"><span data-stu-id="87114-208">For example, you might create an RBAC rule:</span></span>
   
   ```powershell
   $role = Get-AzureRmRoleDefinition "Reader"
   $role.Id = $null
   $role.Name = "Monitoring Event Hub Listener"
   $role.Description = "Can get the key to listen to an event hub streaming monitoring data."
   $role.Actions.Clear()
   $role.Actions.Add("Microsoft.ServiceBus/namespaces/authorizationrules/listkeys/action")
   $role.Actions.Add("Microsoft.ServiceBus/namespaces/Read")
   $role.AssignableScopes.Clear()
   $role.AssignableScopes.Add("/subscriptions/mySubscription/resourceGroups/myResourceGroup/providers/Microsoft.ServiceBus/namespaces/mySBNameSpace")
   New-AzureRmRoleDefinition -Role $role 
   ```

## <a name="next-steps"></a><span data-ttu-id="87114-209">Nästa steg</span><span class="sxs-lookup"><span data-stu-id="87114-209">Next steps</span></span>
* [<span data-ttu-id="87114-210">Läs mer om RBAC och behörigheter i Resource Manager</span><span class="sxs-lookup"><span data-stu-id="87114-210">Read about RBAC and permissions in Resource Manager</span></span>](../active-directory/role-based-access-control-what-is.md)
* [<span data-ttu-id="87114-211">Läs översikt över övervakning i Azure</span><span class="sxs-lookup"><span data-stu-id="87114-211">Read the overview of monitoring in Azure</span></span>](monitoring-overview.md)

