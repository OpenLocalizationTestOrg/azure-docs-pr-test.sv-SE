---
title: "aaaBest praxis för Autoskala | Microsoft Docs"
description: "Autoskala mönster i Azure för Web Apps, skaluppsättningar för den virtuella datorn och molntjänster"
author: anirudhcavale
manager: orenr
editor: 
services: monitoring-and-diagnostics
documentationcenter: monitoring-and-diagnostics
ms.assetid: 9fa2b94b-dfa5-4106-96ff-74fd1fba4657
ms.service: monitoring-and-diagnostics
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/07/2017
ms.author: ancav
ms.openlocfilehash: eb731c15e440af93a2675210583878814d0d8818
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 10/06/2017
---
# <a name="best-practices-for-autoscale"></a><span data-ttu-id="5ce11-103">Bästa metoder för autoskalning</span><span class="sxs-lookup"><span data-stu-id="5ce11-103">Best practices for Autoscale</span></span>
<span data-ttu-id="5ce11-104">Den här artikeln lär du den bästa praxis tooautoscale i Azure.</span><span class="sxs-lookup"><span data-stu-id="5ce11-104">This article teaches best practices tooautoscale in Azure.</span></span> <span data-ttu-id="5ce11-105">Azure övervakaren Autoskala gäller endast för[Skalningsuppsättningar i virtuella](https://azure.microsoft.com/services/virtual-machine-scale-sets/), [molntjänster](https://azure.microsoft.com/services/cloud-services/), och [App Service - Webbappar](https://azure.microsoft.com/services/app-service/web/).</span><span class="sxs-lookup"><span data-stu-id="5ce11-105">Azure Monitor autoscale applies only too[Virtual Machine Scale Sets](https://azure.microsoft.com/services/virtual-machine-scale-sets/), [Cloud Services](https://azure.microsoft.com/services/cloud-services/), and [App Service - Web Apps](https://azure.microsoft.com/services/app-service/web/).</span></span> <span data-ttu-id="5ce11-106">Andra Azure-tjänster använda olika metoder för skalning.</span><span class="sxs-lookup"><span data-stu-id="5ce11-106">Other Azure services use different scaling methods.</span></span>

## <a name="autoscale-concepts"></a><span data-ttu-id="5ce11-107">Autoskala begrepp</span><span class="sxs-lookup"><span data-stu-id="5ce11-107">Autoscale concepts</span></span>
* <span data-ttu-id="5ce11-108">En resurs kan bara ha *en* autoskalningsinställning</span><span class="sxs-lookup"><span data-stu-id="5ce11-108">A resource can have only *one* autoscale setting</span></span>
* <span data-ttu-id="5ce11-109">En autoskalningsinställning kan ha en eller flera profiler och varje profil kan ha en eller flera Autoskala regler.</span><span class="sxs-lookup"><span data-stu-id="5ce11-109">An autoscale setting can have one or more profiles and each profile can have one or more autoscale rules.</span></span>
* <span data-ttu-id="5ce11-110">En autoskalningsinställning skalas instanser vågrätt, vilket är *ut* genom att öka hello instanser och *i* genom att minska hello antal instanser.</span><span class="sxs-lookup"><span data-stu-id="5ce11-110">An autoscale setting scales instances horizontally, which is *out* by increasing hello instances and *in* by decreasing hello number of instances.</span></span>
  <span data-ttu-id="5ce11-111">En autoskalningsinställning har en högsta och lägsta standardvärdet instanser.</span><span class="sxs-lookup"><span data-stu-id="5ce11-111">An autoscale setting has a maximum, minimum, and default value of instances.</span></span>
* <span data-ttu-id="5ce11-112">Ett jobb Autoskala alltid hello associerade mått tooscale av kontrollerar om den har passerat hello konfigurerade tröskeln för skalbar eller skala i.</span><span class="sxs-lookup"><span data-stu-id="5ce11-112">An autoscale job always reads hello associated metric tooscale by, checking if it has crossed hello configured threshold for scale-out or scale-in.</span></span> <span data-ttu-id="5ce11-113">Du kan visa en lista av mätvärden som autoskalning kan skala genom på [Azure-Monitor autoskalning vanliga mått](insights-autoscale-common-metrics.md).</span><span class="sxs-lookup"><span data-stu-id="5ce11-113">You can view a list of metrics that autoscale can scale by at [Azure Monitor autoscaling common metrics](insights-autoscale-common-metrics.md).</span></span>
* <span data-ttu-id="5ce11-114">Alla tröskelvärden beräknas på en instansnivå.</span><span class="sxs-lookup"><span data-stu-id="5ce11-114">All thresholds are calculated at an instance level.</span></span> <span data-ttu-id="5ce11-115">Till exempel ”skala ut med 1 instans när Genomsnittlig CPU > 80% när instansantalet är 2”, innebär att skalbar när hello Genomsnittlig CPU i alla instanser som är större än 80%.</span><span class="sxs-lookup"><span data-stu-id="5ce11-115">For example, "scale out by 1 instance when average CPU > 80% when instance count is 2", means scale-out when hello average CPU across all instances is greater than 80%.</span></span>
* <span data-ttu-id="5ce11-116">Du får alltid meddelanden via e-post.</span><span class="sxs-lookup"><span data-stu-id="5ce11-116">You always receive failure notifications via email.</span></span> <span data-ttu-id="5ce11-117">Mer specifikt får hello ägare, deltagare och läsare av hello målresurs e-post.</span><span class="sxs-lookup"><span data-stu-id="5ce11-117">Specifically, hello owner, contributor, and readers of hello target resource receive email.</span></span> <span data-ttu-id="5ce11-118">Du får alltid en *recovery* e-post när Autoskala återställer från ett fel och startar fungerar normalt.</span><span class="sxs-lookup"><span data-stu-id="5ce11-118">You also always receive a *recovery* email when autoscale recovers from a failure and starts functioning normally.</span></span>
* <span data-ttu-id="5ce11-119">Du kan anmäla sig tooreceive en lyckad skala åtgärd avisering via e-post och webhooks.</span><span class="sxs-lookup"><span data-stu-id="5ce11-119">You can opt-in tooreceive a successful scale action notification via email and webhooks.</span></span>

## <a name="autoscale-best-practices"></a><span data-ttu-id="5ce11-120">Autoskala bästa praxis</span><span class="sxs-lookup"><span data-stu-id="5ce11-120">Autoscale best practices</span></span>
<span data-ttu-id="5ce11-121">Använd följande metodtips när du använder Autoskala hello.</span><span class="sxs-lookup"><span data-stu-id="5ce11-121">Use hello following best practices as you use autoscale.</span></span>

### <a name="ensure-hello-maximum-and-minimum-values-are-different-and-have-an-adequate-margin-between-them"></a><span data-ttu-id="5ce11-122">Kontrollera hello högsta och lägsta värdena är olika och har en tillräcklig marginal mellan dem.</span><span class="sxs-lookup"><span data-stu-id="5ce11-122">Ensure hello maximum and minimum values are different and have an adequate margin between them</span></span>
<span data-ttu-id="5ce11-123">Om du har en inställning som har minst = 2, maximalt = 2 och hello aktuella standardinstansantalet är 2, ingen skalningsåtgärd kan uppstå.</span><span class="sxs-lookup"><span data-stu-id="5ce11-123">If you have a setting that has minimum=2, maximum=2 and hello current instance count is 2, no scale action can occur.</span></span> <span data-ttu-id="5ce11-124">Behåll en tillräcklig marginal mellan hello högsta och lägsta antalet instanser, vilket är inklusiva.</span><span class="sxs-lookup"><span data-stu-id="5ce11-124">Keep an adequate margin between hello maximum and minimum instance counts, which are inclusive.</span></span> <span data-ttu-id="5ce11-125">Autoskala skalas alltid mellan dessa gränser.</span><span class="sxs-lookup"><span data-stu-id="5ce11-125">Autoscale always scales between these limits.</span></span>

### <a name="manual-scaling-is-reset-by-autoscale-min-and-max"></a><span data-ttu-id="5ce11-126">Manuell skalning återställs av Autoskala min och max</span><span class="sxs-lookup"><span data-stu-id="5ce11-126">Manual scaling is reset by autoscale min and max</span></span>
<span data-ttu-id="5ce11-127">Om du manuellt uppdatera hello instans tooa värdet för antal ovan eller nedan hello maximalt hello Autoskala motorn automatiskt skalas tillbaka toohello minsta (om nedan) eller hello maximala (om ovan).</span><span class="sxs-lookup"><span data-stu-id="5ce11-127">If you manually update hello instance count tooa value above or below hello maximum, hello autoscale engine automatically scales back toohello minimum (if below) or hello maximum (if above).</span></span> <span data-ttu-id="5ce11-128">Exempelvis kan du ange hello intervallet mellan 3 och 6.</span><span class="sxs-lookup"><span data-stu-id="5ce11-128">For example, you set hello range between 3 and 6.</span></span> <span data-ttu-id="5ce11-129">Om du har en instans som körs kan skalas hello Autoskala motorn too3 instanser på dess nästa körning.</span><span class="sxs-lookup"><span data-stu-id="5ce11-129">If you have one running instance, hello autoscale engine scales too3 instances on its next run.</span></span> <span data-ttu-id="5ce11-130">På samma sätt är det skulle skala in 8 instanser tillbaka too6 nästa körs.</span><span class="sxs-lookup"><span data-stu-id="5ce11-130">Likewise, it would scale-in 8 instances back too6 on its next run.</span></span>  <span data-ttu-id="5ce11-131">Manuell skalning är mycket tillfällig om du återställer hello Autoskala samt regler.</span><span class="sxs-lookup"><span data-stu-id="5ce11-131">Manual scaling is very temporary unless you reset hello autoscale rules as well.</span></span>

### <a name="always-use-a-scale-out-and-scale-in-rule-combination-that-performs-an-increase-and-decrease"></a><span data-ttu-id="5ce11-132">Använd alltid en skalbar och skala i regel kombination som utför en ökning och minskning</span><span class="sxs-lookup"><span data-stu-id="5ce11-132">Always use a scale-out and scale-in rule combination that performs an increase and decrease</span></span>
<span data-ttu-id="5ce11-133">Om du använder endast en del av hello kombination har Autoskala skala in att enkel, eller i en, tills hello högsta eller lägsta, nåtts.</span><span class="sxs-lookup"><span data-stu-id="5ce11-133">If you use only one part of hello combination, autoscale scale-in that single out, or in, until hello maximum, or minimum, is reached.</span></span>

### <a name="do-not-switch-between-hello-azure-portal-and-hello-azure-classic-portal-when-managing-autoscale"></a><span data-ttu-id="5ce11-134">Växla inte mellan hello Azure-portalen och hello klassiska Azure-portalen när du hanterar Autoskala</span><span class="sxs-lookup"><span data-stu-id="5ce11-134">Do not switch between hello Azure portal and hello Azure classic portal when managing Autoscale</span></span>
<span data-ttu-id="5ce11-135">Använd hello Azure-portalen (portal.azure.com) toocreate och hantera Autoskala inställningar för molntjänster och Apptjänster (webbprogram).</span><span class="sxs-lookup"><span data-stu-id="5ce11-135">For Cloud Services and App Services (Web Apps), use hello Azure portal (portal.azure.com) toocreate and manage autoscale settings.</span></span> <span data-ttu-id="5ce11-136">Använd PowerShell, CLI eller REST API toocreate för Skalningsuppsättningar i virtuella datorer och hantera autoskalningsinställning.</span><span class="sxs-lookup"><span data-stu-id="5ce11-136">For Virtual Machine Scale Sets use PowerShell, CLI or REST API toocreate and manage autoscale setting.</span></span> <span data-ttu-id="5ce11-137">Växla inte mellan hello klassiska Azure-portalen (manage.windowsazure.com) och hello Azure-portalen (portal.azure.com) när du hanterar Autoskala konfigurationer.</span><span class="sxs-lookup"><span data-stu-id="5ce11-137">Do not switch between hello Azure classic portal (manage.windowsazure.com) and hello Azure portal (portal.azure.com) when managing autoscale configurations.</span></span> <span data-ttu-id="5ce11-138">Hej klassiska Azure-portalen och dess underliggande backend har begränsningar.</span><span class="sxs-lookup"><span data-stu-id="5ce11-138">hello Azure classic portal and its underlying backend has limitations.</span></span> <span data-ttu-id="5ce11-139">Flytta toohello Azure portal toomanage Autoskala med ett grafiskt användargränssnitt.</span><span class="sxs-lookup"><span data-stu-id="5ce11-139">Move toohello Azure portal toomanage autoscale using a graphical user interface.</span></span> <span data-ttu-id="5ce11-140">hello alternativ är toouse hello Autoskala PowerShell, CLI eller REST API (via resursutforskaren i Azure).</span><span class="sxs-lookup"><span data-stu-id="5ce11-140">hello options are toouse hello autoscale PowerShell, CLI or REST API (via Azure Resource Explorer).</span></span>

### <a name="choose-hello-appropriate-statistic-for-your-diagnostics-metric"></a><span data-ttu-id="5ce11-141">Välj lämplig hello-statistiken för diagnostik-mått</span><span class="sxs-lookup"><span data-stu-id="5ce11-141">Choose hello appropriate statistic for your diagnostics metric</span></span>
<span data-ttu-id="5ce11-142">För diagnostik statistik, kan du välja mellan *genomsnittlig*, *minsta*, *maximala* och *totala* som ett mått tooscale av.</span><span class="sxs-lookup"><span data-stu-id="5ce11-142">For diagnostics metrics, you can choose among *Average*, *Minimum*, *Maximum* and *Total* as a metric tooscale by.</span></span> <span data-ttu-id="5ce11-143">hello vanligaste statistiken är *genomsnittlig*.</span><span class="sxs-lookup"><span data-stu-id="5ce11-143">hello most common statistic is *Average*.</span></span>

### <a name="choose-hello-thresholds-carefully-for-all-metric-types"></a><span data-ttu-id="5ce11-144">Välj hello tröskelvärden noggrant för alla typer av mått</span><span class="sxs-lookup"><span data-stu-id="5ce11-144">Choose hello thresholds carefully for all metric types</span></span>
<span data-ttu-id="5ce11-145">Vi rekommenderar att du noggrant välja olika tröskelvärden för skalbar och skala in baserat på praktiska situationer.</span><span class="sxs-lookup"><span data-stu-id="5ce11-145">We recommend carefully choosing different thresholds for scale-out and scale-in based on practical situations.</span></span>

<span data-ttu-id="5ce11-146">Vi *rekommenderar inte* Autoskala inställningar som hello exemplen nedan med hello samma eller mycket lik tröskelvärden för ut och villkor:</span><span class="sxs-lookup"><span data-stu-id="5ce11-146">We *do not recommend* autoscale settings like hello examples below with hello same or very similar threshold values for out and in conditions:</span></span>

* <span data-ttu-id="5ce11-147">Öka instanser av 1 räkna när antal trådar < = 600</span><span class="sxs-lookup"><span data-stu-id="5ce11-147">Increase instances by 1 count when Thread Count <= 600</span></span>
* <span data-ttu-id="5ce11-148">Minska instanser med 1 räkna när antal trådar > = 600</span><span class="sxs-lookup"><span data-stu-id="5ce11-148">Decrease instances by 1 count when Thread Count >= 600</span></span>

<span data-ttu-id="5ce11-149">Nu ska vi titta på ett exempel på vad kan leda tooa beteende som kan verka förvirrande.</span><span class="sxs-lookup"><span data-stu-id="5ce11-149">Let's look at an example of what can lead tooa behavior that may seem confusing.</span></span> <span data-ttu-id="5ce11-150">Överväg att hello följande sekvens.</span><span class="sxs-lookup"><span data-stu-id="5ce11-150">Consider hello following sequence.</span></span>

1. <span data-ttu-id="5ce11-151">Anta att det finns 2 instanser toobegin med och sedan hello Genomsnittligt antal trådar per instans växer too625.</span><span class="sxs-lookup"><span data-stu-id="5ce11-151">Assume there are 2 instances toobegin with and then hello average number of threads per instance grows too625.</span></span>
2. <span data-ttu-id="5ce11-152">Autoskala skalas ut lägger till en 3-instans.</span><span class="sxs-lookup"><span data-stu-id="5ce11-152">Autoscale scales out adding a 3rd instance.</span></span>
3. <span data-ttu-id="5ce11-153">Därefter förutsätter att hello genomsnittlig trådar över instans hamnar too575.</span><span class="sxs-lookup"><span data-stu-id="5ce11-153">Next, assume that hello average thread count across instance falls too575.</span></span>
4. <span data-ttu-id="5ce11-154">Innan du skala försöker Autoskala tooestimate vilka hello sluttillstånd kommer att om den anpassas i.</span><span class="sxs-lookup"><span data-stu-id="5ce11-154">Before scaling down, autoscale tries tooestimate what hello final state will be if it scaled in.</span></span> <span data-ttu-id="5ce11-155">Till exempel 575 x 3 (aktuella standardinstansantalet) = 1,725 / 2 (sista antal instanser när skala) = 862.5 trådar.</span><span class="sxs-lookup"><span data-stu-id="5ce11-155">For example, 575 x  3 (current instance count) = 1,725 / 2 (final number of instances when scaled down) = 862.5 threads.</span></span> <span data-ttu-id="5ce11-156">Detta innebär att Autoskala skulle ha tooimmediately skalbar igen trots att det skalas, om hello genomsnittlig tråd antal förblir hello samma eller även hamnar bara en liten del.</span><span class="sxs-lookup"><span data-stu-id="5ce11-156">This means autoscale would have tooimmediately scale-out again even after it scaled in, if hello average thread count remains hello same or even falls only a small amount.</span></span> <span data-ttu-id="5ce11-157">Men om det som skalats ut igen, hello hela processen skulle upprepa inledande tooan oändlig loop.</span><span class="sxs-lookup"><span data-stu-id="5ce11-157">However, if it scaled up again, hello whole process would repeat, leading tooan infinite loop.</span></span>
5. <span data-ttu-id="5ce11-158">tooavoid i den här situationen (som kallas ”flapping”) Autoskala skalas inte alls.</span><span class="sxs-lookup"><span data-stu-id="5ce11-158">tooavoid this situation (termed "flapping"), autoscale does not scale down at all.</span></span> <span data-ttu-id="5ce11-159">I stället hoppar över och reevaluates hello villkoret igen hello nästa gång hello tjänstens jobbet körs.</span><span class="sxs-lookup"><span data-stu-id="5ce11-159">Instead, it skips and reevaluates hello condition again hello next time hello service's job executes.</span></span> <span data-ttu-id="5ce11-160">Detta kan förvirrande många eftersom Autoskala inte visas då toowork när hello genomsnittlig trådar 575.</span><span class="sxs-lookup"><span data-stu-id="5ce11-160">This could confuse many people because autoscale wouldn't appear toowork when hello average thread count was 575.</span></span>

<span data-ttu-id="5ce11-161">Beräkning av under en skala i är avsedda tooavoid ”växlar” situationer där skala i och skalbar åtgärder kontinuerligt gå fram och tillbaka.</span><span class="sxs-lookup"><span data-stu-id="5ce11-161">Estimation during a scale-in is intended tooavoid "flapping" situations, where scale-in and scale-out actions continually go back and forth.</span></span> <span data-ttu-id="5ce11-162">Kom ihåg detta beteende när du väljer hello samma tröskelvärden för skalbar och i.</span><span class="sxs-lookup"><span data-stu-id="5ce11-162">Keep this behavior in mind when you choose hello same thresholds for scale-out and in.</span></span>

<span data-ttu-id="5ce11-163">Vi rekommenderar att du väljer en tillräcklig marginal mellan hello skalbar och tröskelvärden.</span><span class="sxs-lookup"><span data-stu-id="5ce11-163">We recommend choosing an adequate margin between hello scale-out and in thresholds.</span></span> <span data-ttu-id="5ce11-164">Exempelvis bör du hello efter bättre regeln kombination.</span><span class="sxs-lookup"><span data-stu-id="5ce11-164">As an example, consider hello following better rule combination.</span></span>

* <span data-ttu-id="5ce11-165">Öka instanser av 1 räkna när CPU i % > = 80</span><span class="sxs-lookup"><span data-stu-id="5ce11-165">Increase instances by 1 count when CPU%  >= 80</span></span>
* <span data-ttu-id="5ce11-166">Minska instanser med 1 räkna när CPU i % < = 60</span><span class="sxs-lookup"><span data-stu-id="5ce11-166">Decrease instances by 1 count when CPU% <= 60</span></span>

<span data-ttu-id="5ce11-167">I det här fallet</span><span class="sxs-lookup"><span data-stu-id="5ce11-167">In this case</span></span>  

1. <span data-ttu-id="5ce11-168">Anta att det finns 2 instanser toostart med.</span><span class="sxs-lookup"><span data-stu-id="5ce11-168">Assume there are 2 instances toostart with.</span></span>
2. <span data-ttu-id="5ce11-169">Om hello Genomsnittlig CPU i % över instanser går too80 kan skalas Autoskala lägga till en tredje instans.</span><span class="sxs-lookup"><span data-stu-id="5ce11-169">If hello average CPU% across instances goes too80, autoscale scales out adding a third instance.</span></span>
3. <span data-ttu-id="5ce11-170">Anta nu att % hamnar too60 över tid hello CPU.</span><span class="sxs-lookup"><span data-stu-id="5ce11-170">Now assume that over time hello CPU% falls too60.</span></span>
4. <span data-ttu-id="5ce11-171">Autoskalas skala i regeln beräknar hello sluttillstånd om det vore tooscale i.</span><span class="sxs-lookup"><span data-stu-id="5ce11-171">Autoscale's scale-in rule estimates hello final state if it were tooscale-in.</span></span> <span data-ttu-id="5ce11-172">Till exempel 60 x 3 (aktuella standardinstansantalet) = 180 / 2 (sista antal instanser när skala) = 90.</span><span class="sxs-lookup"><span data-stu-id="5ce11-172">For example, 60 x 3 (current instance count) = 180 / 2 (final number of instances when scaled down) = 90.</span></span> <span data-ttu-id="5ce11-173">Så Autoskala inte skala in eftersom den skulle ha tooscale ut igen omedelbart.</span><span class="sxs-lookup"><span data-stu-id="5ce11-173">So autoscale does not scale-in because it would have tooscale-out again immediately.</span></span> <span data-ttu-id="5ce11-174">I stället hoppas över och skala.</span><span class="sxs-lookup"><span data-stu-id="5ce11-174">Instead, it skips scaling down.</span></span>
5. <span data-ttu-id="5ce11-175">hello nästa gång Autoskala kontrollerar hello CPU fortsätter toofall too50.</span><span class="sxs-lookup"><span data-stu-id="5ce11-175">hello next time autoscale checks, hello CPU continues toofall too50.</span></span> <span data-ttu-id="5ce11-176">Beräknar igen - 50 x 3, instans = 150 / 2 instanser = 75, vilket är hello skalbar tröskelvärdet 80, så att det skalas in har too2 instanser.</span><span class="sxs-lookup"><span data-stu-id="5ce11-176">It estimates again -  50 x 3 instance = 150 / 2 instances = 75, which is below hello scale-out threshold of 80, so it scales in successfully too2 instances.</span></span>

### <a name="considerations-for-scaling-threshold-values-for-special-metrics"></a><span data-ttu-id="5ce11-177">Överväganden för skalning tröskelvärden för särskilda mått</span><span class="sxs-lookup"><span data-stu-id="5ce11-177">Considerations for scaling threshold values for special metrics</span></span>
 <span data-ttu-id="5ce11-178">För särskilda mätvärden, till exempel lagrings- och Service Bus-kö längd mått är hello tröskelvärdet hello Genomsnittligt antal meddelanden som är tillgängliga per aktuellt antal instanser.</span><span class="sxs-lookup"><span data-stu-id="5ce11-178">For special metrics such as Storage or Service Bus Queue length metric, hello threshold is hello average number of messages available per current number of instances.</span></span> <span data-ttu-id="5ce11-179">Välj noga hello väljer hello tröskelvärde för det här måttet.</span><span class="sxs-lookup"><span data-stu-id="5ce11-179">Carefully choose hello choose hello threshold value for this metric.</span></span>

<span data-ttu-id="5ce11-180">Vi illustrerar den med ett exempel tooensure du hur hello fungerar bättre.</span><span class="sxs-lookup"><span data-stu-id="5ce11-180">Let's illustrate it with an example tooensure you understand hello behavior better.</span></span>

* <span data-ttu-id="5ce11-181">Öka instanser av 1 antal när lagring kön meddelandet antal > = 50</span><span class="sxs-lookup"><span data-stu-id="5ce11-181">Increase instances by 1 count when Storage Queue message count >= 50</span></span>
* <span data-ttu-id="5ce11-182">Minska instanser av 1 antal när lagring kön meddelandet antal < = 10</span><span class="sxs-lookup"><span data-stu-id="5ce11-182">Decrease instances by 1 count when Storage Queue message count <= 10</span></span>

<span data-ttu-id="5ce11-183">Överväg följande sekvens hello:</span><span class="sxs-lookup"><span data-stu-id="5ce11-183">Consider hello following sequence:</span></span>

1. <span data-ttu-id="5ce11-184">Det finns 2 lagring kön instanser.</span><span class="sxs-lookup"><span data-stu-id="5ce11-184">There are 2 storage queue instances.</span></span>
2. <span data-ttu-id="5ce11-185">Meddelanden fortfarande och när du granskar hello storage-kö hello totala antalet läser 50.</span><span class="sxs-lookup"><span data-stu-id="5ce11-185">Messages keep coming and when you review hello storage queue, hello total count reads 50.</span></span> <span data-ttu-id="5ce11-186">Du kan anta att Autoskala ska starta en skalbar-åtgärd.</span><span class="sxs-lookup"><span data-stu-id="5ce11-186">You might assume that autoscale should start a scale-out action.</span></span> <span data-ttu-id="5ce11-187">Observera dock att det fortfarande är 50/2 = 25 meddelanden per instans.</span><span class="sxs-lookup"><span data-stu-id="5ce11-187">However, note that it is still 50/2 = 25 messages per instance.</span></span> <span data-ttu-id="5ce11-188">Därför uppstår inte skalbar.</span><span class="sxs-lookup"><span data-stu-id="5ce11-188">So, scale-out does not occur.</span></span> <span data-ttu-id="5ce11-189">För hello första skalbar toohappen vara hello totala antalet meddelanden i kö för lagring av hello 100.</span><span class="sxs-lookup"><span data-stu-id="5ce11-189">For hello first scale-out toohappen, hello total message count in hello storage queue should be 100.</span></span>
3. <span data-ttu-id="5ce11-190">Därefter förutsätter att hello totala meddelandemängd når 100.</span><span class="sxs-lookup"><span data-stu-id="5ce11-190">Next, assume that hello total message count reaches 100.</span></span>
4. <span data-ttu-id="5ce11-191">En 3 lagring kön instans läggs till på grund av tooa skalbar åtgärd.</span><span class="sxs-lookup"><span data-stu-id="5ce11-191">A 3rd storage queue instance is added due tooa scale-out action.</span></span>  <span data-ttu-id="5ce11-192">hello nästa skalbar åtgärd sker inte förrän hello totala antalet meddelanden i kö för hello når 150 eftersom 150/3 = 50.</span><span class="sxs-lookup"><span data-stu-id="5ce11-192">hello next scale-out action will not happen until hello total message count in hello queue reaches 150 because 150/3 = 50.</span></span>
5. <span data-ttu-id="5ce11-193">Nu blir hello antal meddelanden i kö för hello mindre.</span><span class="sxs-lookup"><span data-stu-id="5ce11-193">Now hello number of messages in hello queue gets smaller.</span></span> <span data-ttu-id="5ce11-194">Med 3 instanser hello första skala i åtgärden händer när hello Totalt antal meddelanden i alla köer summera too30 eftersom 30/3 = 10 meddelanden per instans som är hello skala i tröskelvärdet.</span><span class="sxs-lookup"><span data-stu-id="5ce11-194">With 3 instances, hello first scale-in action happens when hello total messages in all queues add up too30 because 30/3 = 10 messages per instance, which is hello scale-in threshold.</span></span>

### <a name="considerations-for-scaling-when-multiple-profiles-are-configured-in-an-autoscale-setting"></a><span data-ttu-id="5ce11-195">Överväganden för skalning när flera profiler har konfigurerats i en autoskalningsinställning</span><span class="sxs-lookup"><span data-stu-id="5ce11-195">Considerations for scaling when multiple profiles are configured in an autoscale setting</span></span>
<span data-ttu-id="5ce11-196">Du kan välja en standardprofil som används alltid utan några beroende av schemat eller tid, i en autoskalningsinställning eller kan du välja en återkommande profil eller för en viss period med datum och tid.</span><span class="sxs-lookup"><span data-stu-id="5ce11-196">In an autoscale setting, you can choose a default profile, which is always applied without any dependency on schedule or time, or you can choose a recurring profile or a profile for a fixed period with a date and time range.</span></span>

<span data-ttu-id="5ce11-197">När Autoskala tjänsten bearbetar dem, kontrollerar den alltid i hello följande ordning:</span><span class="sxs-lookup"><span data-stu-id="5ce11-197">When autoscale service processes them, it always checks in hello following order:</span></span>

1. <span data-ttu-id="5ce11-198">Fast datum-profil</span><span class="sxs-lookup"><span data-stu-id="5ce11-198">Fixed Date profile</span></span>
2. <span data-ttu-id="5ce11-199">Återkommande profil</span><span class="sxs-lookup"><span data-stu-id="5ce11-199">Recurring profile</span></span>
3. <span data-ttu-id="5ce11-200">Standardprofil (”Always”)</span><span class="sxs-lookup"><span data-stu-id="5ce11-200">Default ("Always") profile</span></span>

<span data-ttu-id="5ce11-201">Om en profil är uppfyllt, kontrollerar inte Autoskala hello nästa profil villkor under den.</span><span class="sxs-lookup"><span data-stu-id="5ce11-201">If a profile condition is met, autoscale does not check hello next profile condition below it.</span></span> <span data-ttu-id="5ce11-202">Autoskala bearbetar endast en profil i taget.</span><span class="sxs-lookup"><span data-stu-id="5ce11-202">Autoscale only processes one profile at a time.</span></span> <span data-ttu-id="5ce11-203">Detta betyder att om du vill tooalso innehåller ett bearbetningsvillkor från en lägre nivå profil, måste du också inkludera regler i hello aktuella profilen.</span><span class="sxs-lookup"><span data-stu-id="5ce11-203">This means if you want tooalso include a processing condition from a lower-tier profile, you must include those rules as well in hello current profile.</span></span>

<span data-ttu-id="5ce11-204">Nu ska vi se detta med hjälp av ett exempel:</span><span class="sxs-lookup"><span data-stu-id="5ce11-204">Let's review this using an example:</span></span>

<span data-ttu-id="5ce11-205">hello bilden nedan visar ett autoskalningsinställning med en standardprofil minsta instanser = 2 och högsta förekomster = 10.</span><span class="sxs-lookup"><span data-stu-id="5ce11-205">hello image below shows an autoscale setting with a default profile of minimum instances = 2 and maximum instances = 10.</span></span> <span data-ttu-id="5ce11-206">I det här exemplet är regler konfigurerade tooscale ut när hello meddelandet i kön för hello är större än 10 och skala i när antalet för hello-meddelanden i kö för hello är mindre än 3.</span><span class="sxs-lookup"><span data-stu-id="5ce11-206">In this example, rules are configured tooscale-out when hello message count in hello queue is greater than 10 and scale-in when hello message count in hello queue is less than 3.</span></span> <span data-ttu-id="5ce11-207">Hello resurs kan nu skala mellan 2 och 10 instanser.</span><span class="sxs-lookup"><span data-stu-id="5ce11-207">So now hello resource can scale between 2 and 10 instances.</span></span>

<span data-ttu-id="5ce11-208">Dessutom är en återkommande profil som angetts för måndag.</span><span class="sxs-lookup"><span data-stu-id="5ce11-208">In addition, there is a recurring profile set for Monday.</span></span> <span data-ttu-id="5ce11-209">Den värdet för minsta instanser = 2 och högsta förekomster = 12.</span><span class="sxs-lookup"><span data-stu-id="5ce11-209">It is set for minimum instances = 2 and maximum instances = 12.</span></span> <span data-ttu-id="5ce11-210">Detta innebär måndag, hello första gången Autoskala söker efter det här villkoret om hello instansantalet 2 skalningen toohello nya minst 3.</span><span class="sxs-lookup"><span data-stu-id="5ce11-210">This means on Monday, hello first time autoscale checks for this condition, if hello instance count is 2, it scales toohello new minimum of 3.</span></span> <span data-ttu-id="5ce11-211">Så länge Autoskala kvarstår toofind felet profil matchade (måndag) bearbetas bara hello processorbaserad scale-out/i reglerna som konfigurerats för den här profilen.</span><span class="sxs-lookup"><span data-stu-id="5ce11-211">As long as autoscale continues toofind this profile condition matched (Monday), it only processes hello CPU-based scale-out/in rules configured for this profile.</span></span> <span data-ttu-id="5ce11-212">Just nu är kontrollerar den inte om hello kölängd.</span><span class="sxs-lookup"><span data-stu-id="5ce11-212">At this time, it does not check for hello queue length.</span></span> <span data-ttu-id="5ce11-213">Men om du även vill hello kön längd villkoret toobe markerad bör du ta regler från hello standardprofil samt i profilen för måndag.</span><span class="sxs-lookup"><span data-stu-id="5ce11-213">However, if you also want hello queue length condition toobe checked, you should include those rules from hello default profile as well in your Monday profile.</span></span>

<span data-ttu-id="5ce11-214">På liknande sätt när Autoskala växlar tillbaka toohello standardprofil, kontrollerar först den om hello lägsta och högsta villkor är uppfyllda.</span><span class="sxs-lookup"><span data-stu-id="5ce11-214">Similarly, when autoscale switches back toohello default profile, it first checks if hello minimum and maximum conditions are met.</span></span> <span data-ttu-id="5ce11-215">Om hello antalet instanser hello för närvarande är 12, växer den i too10, hello maximalt tillåtet för hello standardprofil.</span><span class="sxs-lookup"><span data-stu-id="5ce11-215">If hello number of instances at hello time is 12, it scales in too10, hello maximum allowed for hello default profile.</span></span>

![Autoskala inställningar](./media/insights-autoscale-best-practices/insights-autoscale-best-practices-2.png)

### <a name="considerations-for-scaling-when-multiple-rules-are-configured-in-a-profile"></a><span data-ttu-id="5ce11-217">Överväganden för skalning när flera regler är konfigurerade i en profil</span><span class="sxs-lookup"><span data-stu-id="5ce11-217">Considerations for scaling when multiple rules are configured in a profile</span></span>
<span data-ttu-id="5ce11-218">Finns det fall där du kan ha tooset flera regler i en profil.</span><span class="sxs-lookup"><span data-stu-id="5ce11-218">There are cases where you may have tooset multiple rules in a profile.</span></span> <span data-ttu-id="5ce11-219">hello följande uppsättning Autoskala regler som används av tjänster använder när flera regler har angetts.</span><span class="sxs-lookup"><span data-stu-id="5ce11-219">hello following set of autoscale rules are used by services use when multiple rules are set.</span></span>

<span data-ttu-id="5ce11-220">På *skala ut*, Autoskala körs om någon regel uppfylls.</span><span class="sxs-lookup"><span data-stu-id="5ce11-220">On *scale out*, autoscale runs if any rule is met.</span></span>
<span data-ttu-id="5ce11-221">På *skala i*, Autoskala kräver alla regler toobe uppfylls.</span><span class="sxs-lookup"><span data-stu-id="5ce11-221">On *scale-in*, autoscale require all rules toobe met.</span></span>

<span data-ttu-id="5ce11-222">tooillustrate, förutsätter att du har följande 4 Autoskala regler hello:</span><span class="sxs-lookup"><span data-stu-id="5ce11-222">tooillustrate, assume that you have hello following 4 autoscale rules:</span></span>

* <span data-ttu-id="5ce11-223">Om CPU < 30% skala i med 1</span><span class="sxs-lookup"><span data-stu-id="5ce11-223">If CPU < 30 %, scale-in by 1</span></span>
* <span data-ttu-id="5ce11-224">Om minnet < 50% skala i med 1</span><span class="sxs-lookup"><span data-stu-id="5ce11-224">If Memory < 50%, scale-in by 1</span></span>
* <span data-ttu-id="5ce11-225">Om CPU > 75%, skala ut med 1</span><span class="sxs-lookup"><span data-stu-id="5ce11-225">If CPU > 75%, scale-out by 1</span></span>
* <span data-ttu-id="5ce11-226">Om minnet > 75%, skala ut med 1</span><span class="sxs-lookup"><span data-stu-id="5ce11-226">If Memory > 75%, scale-out by 1</span></span>

<span data-ttu-id="5ce11-227">Hello följande inträffar:</span><span class="sxs-lookup"><span data-stu-id="5ce11-227">Then hello follow occurs:</span></span>

* <span data-ttu-id="5ce11-228">Om Processorn är 76% och minne är 50%, vi skala ut.</span><span class="sxs-lookup"><span data-stu-id="5ce11-228">If CPU is 76% and Memory is 50%, we scale-out.</span></span>
* <span data-ttu-id="5ce11-229">Om Processorn är 50% minne är 76% vi skala ut.</span><span class="sxs-lookup"><span data-stu-id="5ce11-229">If CPU is 50% and Memory is 76% we scale-out.</span></span>

<span data-ttu-id="5ce11-230">Hej på andra sidan om är 25 procent för processor och minne är % av 51 Autoskala finns **inte** skala i.</span><span class="sxs-lookup"><span data-stu-id="5ce11-230">On hello other hand, if CPU is 25% and memory is 51% autoscale does **not** scale-in.</span></span> <span data-ttu-id="5ce11-231">I ordning tooscale i måste CPU vara 29% och minne 49%.</span><span class="sxs-lookup"><span data-stu-id="5ce11-231">In order tooscale-in, CPU must be 29% and Memory 49%.</span></span>

### <a name="always-select-a-safe-default-instance-count"></a><span data-ttu-id="5ce11-232">Välj alltid en säker standardinstansantalet</span><span class="sxs-lookup"><span data-stu-id="5ce11-232">Always select a safe default instance count</span></span>
<span data-ttu-id="5ce11-233">Hej standardinstansantalet är viktigt Autoskala skalas service toothat beräkningen när mått inte är tillgängliga.</span><span class="sxs-lookup"><span data-stu-id="5ce11-233">hello default instance count is important autoscale scales your service toothat count when metrics are not available.</span></span> <span data-ttu-id="5ce11-234">Därför ska du välja en standard-instanser som är acceptabel för dina arbetsbelastningar.</span><span class="sxs-lookup"><span data-stu-id="5ce11-234">Therefore, select a default instance count that's safe for your workloads.</span></span>

### <a name="configure-autoscale-notifications"></a><span data-ttu-id="5ce11-235">Konfigurera meddelanden om autoskalning</span><span class="sxs-lookup"><span data-stu-id="5ce11-235">Configure autoscale notifications</span></span>
<span data-ttu-id="5ce11-236">Autoskala meddelar hello administratörer och deltagare hello resurs via e-post om något av följande villkor hello inträffar:</span><span class="sxs-lookup"><span data-stu-id="5ce11-236">Autoscale notifies hello administrators and contributors of hello resource by email if any of hello following conditions occur:</span></span>

* <span data-ttu-id="5ce11-237">Autoskala tjänst inte tootake en åtgärd.</span><span class="sxs-lookup"><span data-stu-id="5ce11-237">autoscale service fails tootake an action.</span></span>
* <span data-ttu-id="5ce11-238">Mått är inte tillgängliga för Autoskala service toomake skala beslut.</span><span class="sxs-lookup"><span data-stu-id="5ce11-238">Metrics are not available for autoscale service toomake a scale decision.</span></span>
* <span data-ttu-id="5ce11-239">Mått är tillgängliga (återställning) igen toomake skala beslut.</span><span class="sxs-lookup"><span data-stu-id="5ce11-239">Metrics are available (recovery) again toomake a scale decision.</span></span>
  <span data-ttu-id="5ce11-240">Dessutom toohello villkoren ovan, du kan konfigurera e-post eller webhook meddelanden tooget för lyckade skalningsåtgärder meddelas.</span><span class="sxs-lookup"><span data-stu-id="5ce11-240">In addition toohello conditions above, you can configure email or webhook notifications tooget notified for successful scale actions.</span></span>
  
<span data-ttu-id="5ce11-241">Du kan också använda en aktivitetsloggen avisering toomonitor hello hälsotillstånd hello Autoskala motorn.</span><span class="sxs-lookup"><span data-stu-id="5ce11-241">You can also use an Activity Log alert toomonitor hello health of hello autoscale engine.</span></span> <span data-ttu-id="5ce11-242">Här följer exempel för[och skapa en aktivitet loggen avisering toomonitor alla Autoskala motorn åtgärder för din prenumeration](https://github.com/Azure/azure-quickstart-templates/tree/master/monitor-autoscale-alert) eller för[skapa en aktivitet loggen avisering toomonitor alla misslyckades Autoskala skalan i / skala åtgärder din prenumeration](https://github.com/Azure/azure-quickstart-templates/tree/master/monitor-autoscale-failed-alert).</span><span class="sxs-lookup"><span data-stu-id="5ce11-242">Here are examples too[create an Activity Log Alert toomonitor all autoscale engine operations on your subscription](https://github.com/Azure/azure-quickstart-templates/tree/master/monitor-autoscale-alert) or too[create an Activity Log Alert toomonitor all failed autoscale scale in/scale out operations on your subscription](https://github.com/Azure/azure-quickstart-templates/tree/master/monitor-autoscale-failed-alert).</span></span>

## <a name="next-steps"></a><span data-ttu-id="5ce11-243">Nästa steg</span><span class="sxs-lookup"><span data-stu-id="5ce11-243">Next Steps</span></span>
- [<span data-ttu-id="5ce11-244">Skapa en aktivitet loggen avisering toomonitor alla Autoskala motorn åtgärder för din prenumeration.</span><span class="sxs-lookup"><span data-stu-id="5ce11-244">Create an Activity Log Alert toomonitor all autoscale engine operations on your subscription.</span></span>](https://github.com/Azure/azure-quickstart-templates/tree/master/monitor-autoscale-alert)
- [<span data-ttu-id="5ce11-245">Skapa en aktivitet loggen avisering toomonitor alla misslyckades Autoskala skalan i / skala ut åtgärder för din prenumeration</span><span class="sxs-lookup"><span data-stu-id="5ce11-245">Create an Activity Log Alert toomonitor all failed autoscale scale in/scale out operations on your subscription</span></span>](https://github.com/Azure/azure-quickstart-templates/tree/master/monitor-autoscale-failed-alert)
