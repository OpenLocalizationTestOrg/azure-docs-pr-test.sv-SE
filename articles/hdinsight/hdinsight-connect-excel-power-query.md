---
title: Ansluta Excel till Hadoop med Power Query - Azure HDInsight | Microsoft Docs
description: "Lär dig att dra nytta av business intelligence-komponenter och använda Power Query för Excel för att komma åt data som lagras i Hadoop i HDInsight."
services: hdinsight
documentationcenter: 
tags: azure-portal
author: mumian
manager: jhubbard
editor: cgronlun
ms.assetid: 01ad2f90-7520-44d9-8c16-4d936faaff9b
ms.service: hdinsight
ms.custom: hdinsightactive
ms.workload: big-data
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/11/2017
ms.author: jgao
ms.openlocfilehash: 6a15efb091b4faaa7305bb8faa362c62fac595cb
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 08/03/2017
---
# <a name="connect-excel-to-hadoop-by-using-power-query"></a><span data-ttu-id="6f831-103">Ansluta Excel till Hadoop med Power Query</span><span class="sxs-lookup"><span data-stu-id="6f831-103">Connect Excel to Hadoop by using Power Query</span></span>
<span data-ttu-id="6f831-104">En nyckelfunktion i Microsofts lösning för stora data är integreringen av Microsoft business intelligence (BI)-komponenter med Hadoop-kluster i Azure HDInsight.</span><span class="sxs-lookup"><span data-stu-id="6f831-104">One key feature of the Microsoft big-data solution is the integration of Microsoft business intelligence (BI) components with Hadoop clusters in Azure HDInsight.</span></span> <span data-ttu-id="6f831-105">En primär exempel är möjligheten att ansluta Excel till Azure Storage-konto som innehåller data som är associerade med Hadoop-kluster med hjälp av Microsoft Power Query för Excel-tillägg.</span><span class="sxs-lookup"><span data-stu-id="6f831-105">A primary example is the ability to connect Excel to the Azure Storage account that contains the data associated with your Hadoop cluster by using the Microsoft Power Query for Excel add-in.</span></span> <span data-ttu-id="6f831-106">Den här artikeln vägleder dig genom att ställa in och använda Power Query att fråga efter data som är associerade med ett Hadoop-kluster som hanteras med HDInsight.</span><span class="sxs-lookup"><span data-stu-id="6f831-106">This article walks you through how to set up and use Power Query to query data associated with a Hadoop cluster managed with HDInsight.</span></span>

### <a name="prerequisites"></a><span data-ttu-id="6f831-107">Krav</span><span class="sxs-lookup"><span data-stu-id="6f831-107">Prerequisites</span></span>
<span data-ttu-id="6f831-108">Innan du börjar den här artikeln, måste du ha följande:</span><span class="sxs-lookup"><span data-stu-id="6f831-108">Before you begin this article, you must have the following items:</span></span>

* <span data-ttu-id="6f831-109">**Ett HDInsight-kluster**.</span><span class="sxs-lookup"><span data-stu-id="6f831-109">**An HDInsight cluster**.</span></span> <span data-ttu-id="6f831-110">Om du vill konfigurera en finns [komma igång med Azure HDInsight][hdinsight-get-started].</span><span class="sxs-lookup"><span data-stu-id="6f831-110">To configure one, see [Get started with Azure HDInsight][hdinsight-get-started].</span></span>
* <span data-ttu-id="6f831-111">**En arbetsstation** som kör Windows 7, Windows Server 2008 R2 eller senare operativsystem.</span><span class="sxs-lookup"><span data-stu-id="6f831-111">**A workstation** that is running Windows 7, Windows Server 2008 R2, or a later operating system.</span></span>
* <span data-ttu-id="6f831-112">**Office 2016, Office 2013 Professional Plus Office 365 ProPlus, fristående för Excel 2013 eller Office Professional Plus 2010**.</span><span class="sxs-lookup"><span data-stu-id="6f831-112">**Office 2016, Office 2013 Professional Plus, Office 365 ProPlus, Excel 2013 Standalone, or Office 2010 Professional Plus**.</span></span>

## <a name="install-power-query"></a><span data-ttu-id="6f831-113">Installera Power Query</span><span class="sxs-lookup"><span data-stu-id="6f831-113">Install Power Query</span></span>
<span data-ttu-id="6f831-114">Power Query kan importera data som har tagits ut eller som har genererats av ett Hadoop-jobb som körs på ett HDInsight-kluster.</span><span class="sxs-lookup"><span data-stu-id="6f831-114">Power Query can import data that has been output or that has been generated by a Hadoop job running on an HDInsight cluster.</span></span>

<span data-ttu-id="6f831-115">Power Query har integrerats i menyfliksområdet under avsnittet Get och transformera Data i Excel 2016.</span><span class="sxs-lookup"><span data-stu-id="6f831-115">In Excel 2016, Power Query has been integrated into the Data ribbon under the Get & Transform section.</span></span> <span data-ttu-id="6f831-116">För äldre versioner av Excel, ladda ned Microsoft Power Query för Excel från den [Microsoft Download Center] [ powerquery-download] och installera den.</span><span class="sxs-lookup"><span data-stu-id="6f831-116">For older Excel versions, download Microsoft Power Query for Excel from the [Microsoft Download Center][powerquery-download] and install it.</span></span>

## <a name="import-hdinsight-data-into-excel"></a><span data-ttu-id="6f831-117">Importera HDInsight data till Excel</span><span class="sxs-lookup"><span data-stu-id="6f831-117">Import HDInsight data into Excel</span></span>
<span data-ttu-id="6f831-118">Power Query-tillägget för Excel gör det enkelt att importera data från ditt HDInsight-kluster i Excel där BI-verktyg som PowerPivot och Power mappning kan användas för att inspektera, analysera och presentera informationen.</span><span class="sxs-lookup"><span data-stu-id="6f831-118">The Power Query add-in for Excel makes it easy to import data from your HDInsight cluster into Excel, where BI tools such as PowerPivot and Power Map can be used to inspect, analyze, and present the data.</span></span>

<span data-ttu-id="6f831-119">**Importera data från ett HDInsight-kluster**</span><span class="sxs-lookup"><span data-stu-id="6f831-119">**To import data from an HDInsight cluster**</span></span>

1. <span data-ttu-id="6f831-120">Öppna Excel.</span><span class="sxs-lookup"><span data-stu-id="6f831-120">Open Excel.</span></span>
2. <span data-ttu-id="6f831-121">Skapa en ny tom arbetsbok.</span><span class="sxs-lookup"><span data-stu-id="6f831-121">Create a new blank workbook.</span></span>
3. <span data-ttu-id="6f831-122">Utför följande steg beroende på vilken version av Excel:</span><span class="sxs-lookup"><span data-stu-id="6f831-122">Perform the following steps based on the Excel version:</span></span>

    - <span data-ttu-id="6f831-123">Excel 2016</span><span class="sxs-lookup"><span data-stu-id="6f831-123">Excel 2016</span></span>

        - <span data-ttu-id="6f831-124">Klicka på den **Data** -menyn klickar du på **hämta Data** från den **Hämta & transformera Data** band klickar du på **från Azure**, och klicka sedan på **Från Azure HDInsight(HDFS)**.</span><span class="sxs-lookup"><span data-stu-id="6f831-124">Click the **Data** menu, click **Get Data** from the **Get & Transform Data** ribbon, click **From Azure**, and then click **From Azure HDInsight(HDFS)**.</span></span>

        ![HDI. PowerQuery.SelectHdiSource](./media/hdinsight-connect-excel-power-query/hdi.powerquery.selecthdisource.excel2016.png)

    - <span data-ttu-id="6f831-126">Excel 2013/2010</span><span class="sxs-lookup"><span data-stu-id="6f831-126">Excel 2013/2010</span></span>

        - <span data-ttu-id="6f831-127">Klicka på den **Power Query** -menyn klickar du på **från Azure**, och klicka sedan på **från Microsoft Azure HDInsight**.</span><span class="sxs-lookup"><span data-stu-id="6f831-127">Click the **Power Query** menu, click **From Azure**, and then click **From Microsoft Azure HDInsight**.</span></span>
   
        ![HDI. PowerQuery.SelectHdiSource][image-hdi-powerquery-hdi-source]
       
        <span data-ttu-id="6f831-129">**Obs:** om du inte ser den **Power Query** gå till menyn **filen** > **alternativ** > **tillägg**, och välj **COM-tillägg** från listrutan **hantera** rutan längst ned på sidan.</span><span class="sxs-lookup"><span data-stu-id="6f831-129">**Note:** If you don't see the **Power Query** menu, go to **File** > **Options** > **Add-Ins**, and select **COM Add-ins** from the drop-down **Manage** box at the bottom of the page.</span></span> <span data-ttu-id="6f831-130">Välj den **gå...**  knappen och kontrollera att kryssrutan för Power Query för Excel-tillägget har kontrollerats.</span><span class="sxs-lookup"><span data-stu-id="6f831-130">Select the **Go...** button and verify that the box for the Power Query for Excel add-in has been checked.</span></span>
       
        <span data-ttu-id="6f831-131">**Obs:** Power Query kan du importera data från HDFS genom att klicka på **från andra källor**.</span><span class="sxs-lookup"><span data-stu-id="6f831-131">**Note:** Power Query also allows you to import data from HDFS by clicking **From Other Sources**.</span></span>
4. <span data-ttu-id="6f831-132">För **kontonamn**, ange namnet på Azure Blob storage-konto som är associerade med klustret och klicka sedan på **OK**.</span><span class="sxs-lookup"><span data-stu-id="6f831-132">For **Account Name**, enter the name of the Azure Blob storage account associated with your cluster, and then click **OK**.</span></span> <span data-ttu-id="6f831-133">Det här kontot kan vara den [standard lagringskonto](hdinsight-administer-use-management-portal.md#find-the-default-storage-account) eller ett länkade storage-konto.</span><span class="sxs-lookup"><span data-stu-id="6f831-133">This account can be the [default storage account](hdinsight-administer-use-management-portal.md#find-the-default-storage-account) or a linked storage account.</span></span>  <span data-ttu-id="6f831-134">Formatet är *https://&lt;StorageAccountName >.blob.core.windows.net/*.</span><span class="sxs-lookup"><span data-stu-id="6f831-134">The format is *https://&lt;StorageAccountName>.blob.core.windows.net/*.</span></span>
5. <span data-ttu-id="6f831-135">För **Kontonyckel**ange nyckel för Blob storage-konto och klicka sedan på **spara**.</span><span class="sxs-lookup"><span data-stu-id="6f831-135">For **Account Key**, enter the key for the Blob storage account, and then click **Save**.</span></span> <span data-ttu-id="6f831-136">(Du måste ange konto information endast första tid som du har åtkomst till den här butiken.)</span><span class="sxs-lookup"><span data-stu-id="6f831-136">(You need to enter the account information only the first time you access this store.)</span></span>
6. <span data-ttu-id="6f831-137">I den **Navigator** fönstret till vänster för frågeredigeraren Dubbelklicka på Blob storage behållarens namn.</span><span class="sxs-lookup"><span data-stu-id="6f831-137">In the **Navigator** pane on the left of the Query Editor, double-click the Blob storage container name.</span></span> <span data-ttu-id="6f831-138">Behållarens namn är samma namn som klusternamnet som standard.</span><span class="sxs-lookup"><span data-stu-id="6f831-138">By default, the container name is the same name as the cluster name.</span></span>
7. <span data-ttu-id="6f831-139">Leta upp **HiveSampleData.txt** i den **namn** kolumn (mappsökvägen är **... / hive/datalager/hivesampletable/**), och klicka sedan på **binära** till vänster om HiveSampleData.txt.</span><span class="sxs-lookup"><span data-stu-id="6f831-139">Locate **HiveSampleData.txt** in the **Name** column (the folder path is **../hive/warehouse/hivesampletable/**), and then click **Binary** on the left of HiveSampleData.txt.</span></span> <span data-ttu-id="6f831-140">HiveSampleData.txt ingår i klustret.</span><span class="sxs-lookup"><span data-stu-id="6f831-140">HiveSampleData.txt comes with all the cluster.</span></span> <span data-ttu-id="6f831-141">Du kan använda en egen fil.</span><span class="sxs-lookup"><span data-stu-id="6f831-141">Optionally, you can use your own file.</span></span>
   
    ![HDI. PowerQuery.ImportData][image-hdi-powerquery-importdata]
8. <span data-ttu-id="6f831-143">Om du vill kan du byta namn på kolumnnamn.</span><span class="sxs-lookup"><span data-stu-id="6f831-143">If you want, you can rename the column names.</span></span> <span data-ttu-id="6f831-144">När du är klar klickar du på **Stäng & ladda**.</span><span class="sxs-lookup"><span data-stu-id="6f831-144">When you are ready, click **Close & Load**.</span></span>  <span data-ttu-id="6f831-145">Data har lästs in till din arbetsbok:</span><span class="sxs-lookup"><span data-stu-id="6f831-145">The data has been loaded to your workbook:</span></span>
   
    ![HDI. PowerQuery.ImportedTable][image-hdi-powerquery-imported-table]

## <a name="next-steps"></a><span data-ttu-id="6f831-147">Nästa steg</span><span class="sxs-lookup"><span data-stu-id="6f831-147">Next steps</span></span>
<span data-ttu-id="6f831-148">I den här artikeln har du lärt dig hur du använder Power Query för att hämta data från HDInsight till Excel.</span><span class="sxs-lookup"><span data-stu-id="6f831-148">In this article, you learned how to use Power Query to retrieve data from HDInsight into Excel.</span></span> <span data-ttu-id="6f831-149">På liknande sätt kan du hämta data från HDInsight till Azure SQL Database.</span><span class="sxs-lookup"><span data-stu-id="6f831-149">Similarly, you can retrieve data from HDInsight into Azure SQL Database.</span></span> <span data-ttu-id="6f831-150">Det är också möjligt att överföra data till HDInsight.</span><span class="sxs-lookup"><span data-stu-id="6f831-150">It is also possible to upload data into HDInsight.</span></span> <span data-ttu-id="6f831-151">Mer information finns i följande artiklar:</span><span class="sxs-lookup"><span data-stu-id="6f831-151">To learn more, see the following articles:</span></span>

* <span data-ttu-id="6f831-152">[Anslut Excel till HDInsight med Microsoft Hive ODBC-drivrutin][hdinsight-ODBC]</span><span class="sxs-lookup"><span data-stu-id="6f831-152">[Connect Excel to HDInsight with the Microsoft Hive ODBC Driver][hdinsight-ODBC]</span></span>
* <span data-ttu-id="6f831-153">[Överföra Data till HDInsight][hdinsight-upload-data]</span><span class="sxs-lookup"><span data-stu-id="6f831-153">[Upload Data to HDInsight][hdinsight-upload-data]</span></span>

[hdinsight-ODBC]: hdinsight-connect-excel-hive-odbc-driver.md
[hdinsight-get-started]: hdinsight-hadoop-linux-tutorial-get-started.md
[hdinsight-upload-data]: hdinsight-upload-data.md

[image-hdi-powerquery-hdi-source]: ./media/hdinsight-connect-excel-power-query/hdi.powerquery.selecthdisource.png
[image-hdi-powerquery-importdata]: ./media/hdinsight-connect-excel-power-query/hdi.powerquery.importdata.png
[image-hdi-powerquery-imported-table]: ./media/hdinsight-connect-excel-power-query/hdi.powerquery.importedtable.PNG

[powerquery-download]: http://go.microsoft.com/fwlink/?LinkID=286689
