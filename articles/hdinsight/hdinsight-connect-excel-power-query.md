---
title: aaaConnect Excel tooHadoop med Power Query - Azure HDInsight | Microsoft Docs
description: "Lär dig hur tootake nytta av business intelligence-komponenter och använda Power Query för Excel tooaccess data lagras i Hadoop i HDInsight."
services: hdinsight
documentationcenter: 
tags: azure-portal
author: mumian
manager: jhubbard
editor: cgronlun
ms.assetid: 01ad2f90-7520-44d9-8c16-4d936faaff9b
ms.service: hdinsight
ms.custom: hdinsightactive
ms.workload: big-data
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/11/2017
ms.author: jgao
ms.openlocfilehash: 1213849f1bc04e0ed206750b80766ff2268664b4
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 10/06/2017
---
# <a name="connect-excel-toohadoop-by-using-power-query"></a><span data-ttu-id="caa44-103">Ansluta Excel tooHadoop med Power Query</span><span class="sxs-lookup"><span data-stu-id="caa44-103">Connect Excel tooHadoop by using Power Query</span></span>
<span data-ttu-id="caa44-104">En nyckelfunktion i hello Microsoft stordata lösning är hello integrering av Microsoft business intelligence (BI)-komponenter med Hadoop-kluster i Azure HDInsight.</span><span class="sxs-lookup"><span data-stu-id="caa44-104">One key feature of hello Microsoft big-data solution is hello integration of Microsoft business intelligence (BI) components with Hadoop clusters in Azure HDInsight.</span></span> <span data-ttu-id="caa44-105">En primär exempel är hello möjlighet tooconnect Excel toohello Azure Storage-konto som innehåller hello data som är associerade med Hadoop-kluster med hjälp av hello Microsoft Power Query för Excel-tillägg.</span><span class="sxs-lookup"><span data-stu-id="caa44-105">A primary example is hello ability tooconnect Excel toohello Azure Storage account that contains hello data associated with your Hadoop cluster by using hello Microsoft Power Query for Excel add-in.</span></span> <span data-ttu-id="caa44-106">Den här artikeln får du veta hur tooset in och använda Power Query tooquery data som är associerade med ett Hadoop-kluster hanteras med HDInsight.</span><span class="sxs-lookup"><span data-stu-id="caa44-106">This article walks you through how tooset up and use Power Query tooquery data associated with a Hadoop cluster managed with HDInsight.</span></span>

### <a name="prerequisites"></a><span data-ttu-id="caa44-107">Krav</span><span class="sxs-lookup"><span data-stu-id="caa44-107">Prerequisites</span></span>
<span data-ttu-id="caa44-108">Innan du börjar den här artikeln, måste du ha hello följande objekt:</span><span class="sxs-lookup"><span data-stu-id="caa44-108">Before you begin this article, you must have hello following items:</span></span>

* <span data-ttu-id="caa44-109">**Ett HDInsight-kluster**.</span><span class="sxs-lookup"><span data-stu-id="caa44-109">**An HDInsight cluster**.</span></span> <span data-ttu-id="caa44-110">tooconfigure, se [komma igång med Azure HDInsight][hdinsight-get-started].</span><span class="sxs-lookup"><span data-stu-id="caa44-110">tooconfigure one, see [Get started with Azure HDInsight][hdinsight-get-started].</span></span>
* <span data-ttu-id="caa44-111">**En arbetsstation** som kör Windows 7, Windows Server 2008 R2 eller senare operativsystem.</span><span class="sxs-lookup"><span data-stu-id="caa44-111">**A workstation** that is running Windows 7, Windows Server 2008 R2, or a later operating system.</span></span>
* <span data-ttu-id="caa44-112">**Office 2016, Office 2013 Professional Plus Office 365 ProPlus, fristående för Excel 2013 eller Office Professional Plus 2010**.</span><span class="sxs-lookup"><span data-stu-id="caa44-112">**Office 2016, Office 2013 Professional Plus, Office 365 ProPlus, Excel 2013 Standalone, or Office 2010 Professional Plus**.</span></span>

## <a name="install-power-query"></a><span data-ttu-id="caa44-113">Installera Power Query</span><span class="sxs-lookup"><span data-stu-id="caa44-113">Install Power Query</span></span>
<span data-ttu-id="caa44-114">Power Query kan importera data som har tagits ut eller som har genererats av ett Hadoop-jobb som körs på ett HDInsight-kluster.</span><span class="sxs-lookup"><span data-stu-id="caa44-114">Power Query can import data that has been output or that has been generated by a Hadoop job running on an HDInsight cluster.</span></span>

<span data-ttu-id="caa44-115">Power Query har integrerats i hello Data menyfliksområdet under hello Get & Transform-avsnitt i Excel 2016.</span><span class="sxs-lookup"><span data-stu-id="caa44-115">In Excel 2016, Power Query has been integrated into hello Data ribbon under hello Get & Transform section.</span></span> <span data-ttu-id="caa44-116">För äldre versioner av Excel, ladda ned Microsoft Power Query för Excel från hello [Microsoft Download Center] [ powerquery-download] och installera den.</span><span class="sxs-lookup"><span data-stu-id="caa44-116">For older Excel versions, download Microsoft Power Query for Excel from hello [Microsoft Download Center][powerquery-download] and install it.</span></span>

## <a name="import-hdinsight-data-into-excel"></a><span data-ttu-id="caa44-117">Importera HDInsight data till Excel</span><span class="sxs-lookup"><span data-stu-id="caa44-117">Import HDInsight data into Excel</span></span>
<span data-ttu-id="caa44-118">hello Power Query-tillägget för Excel gör det enkelt tooimport data från ditt HDInsight-kluster i Excel där BI-verktyg som PowerPivot och Power mappar kan använda tooinspect, analysera och presentera hello data.</span><span class="sxs-lookup"><span data-stu-id="caa44-118">hello Power Query add-in for Excel makes it easy tooimport data from your HDInsight cluster into Excel, where BI tools such as PowerPivot and Power Map can be used tooinspect, analyze, and present hello data.</span></span>

<span data-ttu-id="caa44-119">**tooimport data från ett HDInsight-kluster**</span><span class="sxs-lookup"><span data-stu-id="caa44-119">**tooimport data from an HDInsight cluster**</span></span>

1. <span data-ttu-id="caa44-120">Öppna Excel.</span><span class="sxs-lookup"><span data-stu-id="caa44-120">Open Excel.</span></span>
2. <span data-ttu-id="caa44-121">Skapa en ny tom arbetsbok.</span><span class="sxs-lookup"><span data-stu-id="caa44-121">Create a new blank workbook.</span></span>
3. <span data-ttu-id="caa44-122">Utför följande utifrån hello Excel version hello:</span><span class="sxs-lookup"><span data-stu-id="caa44-122">Perform hello following steps based on hello Excel version:</span></span>

    - <span data-ttu-id="caa44-123">Excel 2016</span><span class="sxs-lookup"><span data-stu-id="caa44-123">Excel 2016</span></span>

        - <span data-ttu-id="caa44-124">Klicka på hello **Data** -menyn klickar du på **hämta Data** från hello **Hämta & transformera Data** band klickar du på **från Azure**, och klicka sedan på  **Från Azure HDInsight(HDFS)**.</span><span class="sxs-lookup"><span data-stu-id="caa44-124">Click hello **Data** menu, click **Get Data** from hello **Get & Transform Data** ribbon, click **From Azure**, and then click **From Azure HDInsight(HDFS)**.</span></span>

        ![HDI. PowerQuery.SelectHdiSource](./media/hdinsight-connect-excel-power-query/hdi.powerquery.selecthdisource.excel2016.png)

    - <span data-ttu-id="caa44-126">Excel 2013/2010</span><span class="sxs-lookup"><span data-stu-id="caa44-126">Excel 2013/2010</span></span>

        - <span data-ttu-id="caa44-127">Klicka på hello **Power Query** -menyn klickar du på **från Azure**, och klicka sedan på **från Microsoft Azure HDInsight**.</span><span class="sxs-lookup"><span data-stu-id="caa44-127">Click hello **Power Query** menu, click **From Azure**, and then click **From Microsoft Azure HDInsight**.</span></span>
   
        ![HDI. PowerQuery.SelectHdiSource][image-hdi-powerquery-hdi-source]
       
        <span data-ttu-id="caa44-129">**Obs:** om du inte ser hello **Power Query** menyn Gå för**filen** > **alternativ** > **tillägg**, och välj **COM-tillägg** hello listrutan **hantera** rutan på hello hello sidans nederkant.</span><span class="sxs-lookup"><span data-stu-id="caa44-129">**Note:** If you don't see hello **Power Query** menu, go too**File** > **Options** > **Add-Ins**, and select **COM Add-ins** from hello drop-down **Manage** box at hello bottom of hello page.</span></span> <span data-ttu-id="caa44-130">Välj hello **gå...**  knappen och kontrollera hello rutan hello Power Query för Excel-tillägget har kontrollerats.</span><span class="sxs-lookup"><span data-stu-id="caa44-130">Select hello **Go...** button and verify that hello box for hello Power Query for Excel add-in has been checked.</span></span>
       
        <span data-ttu-id="caa44-131">**Obs:** Power Query kan du också tooimport data från HDFS genom att klicka på **från andra källor**.</span><span class="sxs-lookup"><span data-stu-id="caa44-131">**Note:** Power Query also allows you tooimport data from HDFS by clicking **From Other Sources**.</span></span>
4. <span data-ttu-id="caa44-132">För **kontonamn**anger hello namnet på hello Azure Blob storage-konto som är associerade med klustret och klicka sedan på **OK**.</span><span class="sxs-lookup"><span data-stu-id="caa44-132">For **Account Name**, enter hello name of hello Azure Blob storage account associated with your cluster, and then click **OK**.</span></span> <span data-ttu-id="caa44-133">Det här kontot kan vara hello [standard lagringskonto](hdinsight-administer-use-management-portal.md#find-the-default-storage-account) eller ett länkade storage-konto.</span><span class="sxs-lookup"><span data-stu-id="caa44-133">This account can be hello [default storage account](hdinsight-administer-use-management-portal.md#find-the-default-storage-account) or a linked storage account.</span></span>  <span data-ttu-id="caa44-134">hello-formatet är *https://&lt;StorageAccountName >.blob.core.windows.net/*.</span><span class="sxs-lookup"><span data-stu-id="caa44-134">hello format is *https://&lt;StorageAccountName>.blob.core.windows.net/*.</span></span>
5. <span data-ttu-id="caa44-135">För **Kontonyckel**RETUR hello hello Blob storage-konto och klicka sedan på **spara**.</span><span class="sxs-lookup"><span data-stu-id="caa44-135">For **Account Key**, enter hello key for hello Blob storage account, and then click **Save**.</span></span> <span data-ttu-id="caa44-136">(Du måste tooenter hello konto information endast hello första gången du öppnar den här butiken.)</span><span class="sxs-lookup"><span data-stu-id="caa44-136">(You need tooenter hello account information only hello first time you access this store.)</span></span>
6. <span data-ttu-id="caa44-137">I hello **Navigator** rutan på hello vänsterkant hello frågeredigeraren genom att dubbelklicka på hello Blob storage-behållarnamn.</span><span class="sxs-lookup"><span data-stu-id="caa44-137">In hello **Navigator** pane on hello left of hello Query Editor, double-click hello Blob storage container name.</span></span> <span data-ttu-id="caa44-138">Som standard är hello behållarnamn hello samma namn som hello klusternamnet.</span><span class="sxs-lookup"><span data-stu-id="caa44-138">By default, hello container name is hello same name as hello cluster name.</span></span>
7. <span data-ttu-id="caa44-139">Leta upp **HiveSampleData.txt** i hello **namn** kolumn (hello mappsökväg **... / hive/datalager/hivesampletable/**), och klicka sedan på **binära** hello till vänster i HiveSampleData.txt.</span><span class="sxs-lookup"><span data-stu-id="caa44-139">Locate **HiveSampleData.txt** in hello **Name** column (hello folder path is **../hive/warehouse/hivesampletable/**), and then click **Binary** on hello left of HiveSampleData.txt.</span></span> <span data-ttu-id="caa44-140">HiveSampleData.txt innehåller alla hello-klustret.</span><span class="sxs-lookup"><span data-stu-id="caa44-140">HiveSampleData.txt comes with all hello cluster.</span></span> <span data-ttu-id="caa44-141">Du kan använda en egen fil.</span><span class="sxs-lookup"><span data-stu-id="caa44-141">Optionally, you can use your own file.</span></span>
   
    ![HDI. PowerQuery.ImportData][image-hdi-powerquery-importdata]
8. <span data-ttu-id="caa44-143">Om du vill kan du byta namn på hello kolumnnamn.</span><span class="sxs-lookup"><span data-stu-id="caa44-143">If you want, you can rename hello column names.</span></span> <span data-ttu-id="caa44-144">När du är klar klickar du på **Stäng & ladda**.</span><span class="sxs-lookup"><span data-stu-id="caa44-144">When you are ready, click **Close & Load**.</span></span>  <span data-ttu-id="caa44-145">hello data har lästs in tooyour arbetsboken:</span><span class="sxs-lookup"><span data-stu-id="caa44-145">hello data has been loaded tooyour workbook:</span></span>
   
    ![HDI. PowerQuery.ImportedTable][image-hdi-powerquery-imported-table]

## <a name="next-steps"></a><span data-ttu-id="caa44-147">Nästa steg</span><span class="sxs-lookup"><span data-stu-id="caa44-147">Next steps</span></span>
<span data-ttu-id="caa44-148">I den här artikeln har du lärt dig hur toouse Power Query tooretrieve data från HDInsight till Excel.</span><span class="sxs-lookup"><span data-stu-id="caa44-148">In this article, you learned how toouse Power Query tooretrieve data from HDInsight into Excel.</span></span> <span data-ttu-id="caa44-149">På liknande sätt kan du hämta data från HDInsight till Azure SQL Database.</span><span class="sxs-lookup"><span data-stu-id="caa44-149">Similarly, you can retrieve data from HDInsight into Azure SQL Database.</span></span> <span data-ttu-id="caa44-150">Det är också möjligt tooupload data till HDInsight.</span><span class="sxs-lookup"><span data-stu-id="caa44-150">It is also possible tooupload data into HDInsight.</span></span> <span data-ttu-id="caa44-151">toolearn se fler hello följande artiklar:</span><span class="sxs-lookup"><span data-stu-id="caa44-151">toolearn more, see hello following articles:</span></span>

* <span data-ttu-id="caa44-152">[Ansluta Excel tooHDInsight med hello Microsoft Hive ODBC-drivrutinen][hdinsight-ODBC]</span><span class="sxs-lookup"><span data-stu-id="caa44-152">[Connect Excel tooHDInsight with hello Microsoft Hive ODBC Driver][hdinsight-ODBC]</span></span>
* <span data-ttu-id="caa44-153">[Ladda upp Data tooHDInsight][hdinsight-upload-data]</span><span class="sxs-lookup"><span data-stu-id="caa44-153">[Upload Data tooHDInsight][hdinsight-upload-data]</span></span>

[hdinsight-ODBC]: hdinsight-connect-excel-hive-odbc-driver.md
[hdinsight-get-started]: hdinsight-hadoop-linux-tutorial-get-started.md
[hdinsight-upload-data]: hdinsight-upload-data.md

[image-hdi-powerquery-hdi-source]: ./media/hdinsight-connect-excel-power-query/hdi.powerquery.selecthdisource.png
[image-hdi-powerquery-importdata]: ./media/hdinsight-connect-excel-power-query/hdi.powerquery.importdata.png
[image-hdi-powerquery-imported-table]: ./media/hdinsight-connect-excel-power-query/hdi.powerquery.importedtable.PNG

[powerquery-download]: http://go.microsoft.com/fwlink/?LinkID=286689
