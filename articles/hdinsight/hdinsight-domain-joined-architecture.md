---
title: aaaDomain anslutna Azure HDInsight-arkitektur | Microsoft Docs
description: "Lär dig hur tooplan domänanslutna HDInsight."
services: hdinsight
documentationcenter: 
author: saurinsh
manager: jhubbard
editor: cgronlun
tags: azure-portal
ms.assetid: 7dc6847d-10d4-4b5c-9c83-cc513cf91965
ms.service: hdinsight
ms.custom: hdinsightactive
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: big-data
ms.date: 02/03/2017
ms.author: saurinsh
ms.openlocfilehash: 1c3ecedf3739b4f8fa54160225be9c1d6e2ca6cc
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 10/06/2017
---
# <a name="plan-azure-domain-joined-hadoop-clusters-in-hdinsight"></a><span data-ttu-id="83935-103">Planera Azure-domänanslutna Hadoop-kluster i HDInsight</span><span class="sxs-lookup"><span data-stu-id="83935-103">Plan Azure domain-joined Hadoop clusters in HDInsight</span></span>

<span data-ttu-id="83935-104">hello är traditionella Hadoop ett kluster med en användare.</span><span class="sxs-lookup"><span data-stu-id="83935-104">hello traditional Hadoop is a single-user cluster.</span></span> <span data-ttu-id="83935-105">Det passar för de flesta företag som har små applikationsteam som bygger stordataarbetsbelastningar.</span><span class="sxs-lookup"><span data-stu-id="83935-105">It is suitable for most companies that have smaller application teams building large data workloads.</span></span> <span data-ttu-id="83935-106">Hadoop ökar i popularitet och många företag går mot en modell där kluster hanteras av IT-team, och flera applikationsteam delar kluster.</span><span class="sxs-lookup"><span data-stu-id="83935-106">As Hadoop gains popularity, many enterprises are moving toward a model in which clusters are managed by IT teams and multiple application teams share clusters.</span></span> <span data-ttu-id="83935-107">Funktioner som rör fleranvändar-kluster är bland hello därför mest begärda funktionaliteten i Azure HDInsight.</span><span class="sxs-lookup"><span data-stu-id="83935-107">Thus, functionalities involving multiuser clusters are among hello most requested functionalities in Azure HDInsight.</span></span>

<span data-ttu-id="83935-108">I stället för att skapa flera användare autentisering och auktorisering, använder HDInsight hello populäraste identitetsleverantör--Active Directory (AD).</span><span class="sxs-lookup"><span data-stu-id="83935-108">Instead of building its own multiuser authentication and authorization, HDInsight relies on hello most popular identity provider--Active Directory (AD).</span></span> <span data-ttu-id="83935-109">hello kraftfulla säkerhetsfunktionerna i AD kan vara används toomanage fleranvändar auktorisering i HDInsight.</span><span class="sxs-lookup"><span data-stu-id="83935-109">hello powerful security functionality in AD can be used toomanage multiuser authorization in HDInsight.</span></span> <span data-ttu-id="83935-110">Genom att integrera HDInsight med AD kan du kommunicera med hello kluster med hjälp av AD-autentiseringsuppgifter.</span><span class="sxs-lookup"><span data-stu-id="83935-110">By integrating HDInsight with AD, you can communicate with hello clusters by using your AD credentials.</span></span> <span data-ttu-id="83935-111">HDInsight mappar en AD användaren tooa lokala Hadoop-användare, så alla hello tjänster som körs på HDInsight (Ambari, Hive server Ranger Spark thrift-servern och andra) fungerar sömlöst för hello autentiserade användare.</span><span class="sxs-lookup"><span data-stu-id="83935-111">HDInsight maps an AD user tooa local Hadoop user, so all hello services running on HDInsight (Ambari, Hive server, Ranger, Spark thrift server, and others) work seamlessly for hello authenticated user.</span></span>

## <a name="integrate-hdinsight-with-ad-and-ad-on-iaas-vm"></a><span data-ttu-id="83935-112">Integrera HDInsight med AD och AD på IaaS-VM</span><span class="sxs-lookup"><span data-stu-id="83935-112">Integrate HDInsight with AD and AD on IaaS VM</span></span>

<span data-ttu-id="83935-113">Genom att integrera HDInsight med Azure AD eller AD på Iaas-VM är hello HDInsight-klusternoder domänanslutna tooa domän.</span><span class="sxs-lookup"><span data-stu-id="83935-113">By integrating HDInsight with Azure AD or AD on Iaas VM, hello HDInsight cluster nodes are domain-joined tooa domain.</span></span> <span data-ttu-id="83935-114">HDInsight skapar tjänstens huvudnamn för hello Hadoop-tjänster som körs på klustret hello och placerar dem i en angiven organisationsenhet (OU) i Azure AD eller AD på IaaS-VM.</span><span class="sxs-lookup"><span data-stu-id="83935-114">HDInsight creates service principals for hello Hadoop services running on hello cluster and places them within a specified organizational unit (OU) in Azure AD or AD on IaaS VM.</span></span> <span data-ttu-id="83935-115">HDInsight skapas också omvänd DNS-mappningar i hello domän för hello IP-adresser för hello-noder som är kopplade toohello domän.</span><span class="sxs-lookup"><span data-stu-id="83935-115">HDInsight also creates reverse DNS mappings in hello domain for hello IP addresses of hello nodes that are joined toohello domain.</span></span>

<span data-ttu-id="83935-116">Det finns flera olika arkitekturer som du kan använda för att uppnå den här konfigurationen.</span><span class="sxs-lookup"><span data-stu-id="83935-116">You can achieve this setup by using multiple architectures.</span></span> <span data-ttu-id="83935-117">Du kan välja mellan följande arkitekturer hello.</span><span class="sxs-lookup"><span data-stu-id="83935-117">You can choose from hello following architectures.</span></span>

<span data-ttu-id="83935-118">**HDInsight integrerad med AD som körs på Azure IaaS**</span><span class="sxs-lookup"><span data-stu-id="83935-118">**HDInsight integrated with AD running on Azure IaaS**</span></span>

<span data-ttu-id="83935-119">Detta är hello enklaste arkitektur för att integrera HDInsight med Active Directory.</span><span class="sxs-lookup"><span data-stu-id="83935-119">This is hello simplest architecture for integrating HDInsight with Active Directory.</span></span> <span data-ttu-id="83935-120">hello AD-domänkontrollant som körs på en (eller flera) virtuella datorer (VM) i Azure.</span><span class="sxs-lookup"><span data-stu-id="83935-120">hello AD domain controller runs on one (or multiple) virtual machines (VMs) in Azure.</span></span> <span data-ttu-id="83935-121">Dessa virtuella datorer finns vanligtvis i ett virtuellt nätverk.</span><span class="sxs-lookup"><span data-stu-id="83935-121">These VMs are usually in a virtual network.</span></span> <span data-ttu-id="83935-122">Du kan konfigurera ett annat virtuellt nätverk för hello HDInsight-kluster.</span><span class="sxs-lookup"><span data-stu-id="83935-122">You set up another virtual network for hello HDInsight cluster.</span></span> <span data-ttu-id="83935-123">För HDInsight toohave en fri tooActive Directory måste toopeer dessa virtuella nätverk med hjälp av [VNet-till-VNet-peering](../virtual-network/virtual-network-create-peering.md).</span><span class="sxs-lookup"><span data-stu-id="83935-123">For HDInsight toohave a line of sight tooActive Directory, you need toopeer these virtual networks by using [VNet-to-VNet peering](../virtual-network/virtual-network-create-peering.md).</span></span> <span data-ttu-id="83935-124">Om du skapar hello Active Directory i ARM, och du kan skapa hello Active Directory och HDInsight i hello samma virtuella nätverk och du behöver inte toodo peering.</span><span class="sxs-lookup"><span data-stu-id="83935-124">If you create hello Active Directory in ARM, then you can create hello Active Directory and HDInsight in hello same VNet and you don't need toodo peering.</span></span> 

![Domänansluten HDInsight-klustertopologi](./media/hdinsight-domain-joined-architecture/hdinsight-domain-joined-architecture_1.png)

> [!NOTE]
> <span data-ttu-id="83935-126">Du kan inte använda Azure Data Lake Store med hello HDInsight-kluster i den här arkitekturen.</span><span class="sxs-lookup"><span data-stu-id="83935-126">In this architecture, you cannot use Azure Data Lake Store with hello HDInsight cluster.</span></span>


<span data-ttu-id="83935-127">Krav för Active Directory:</span><span class="sxs-lookup"><span data-stu-id="83935-127">Prerequisites for Active Directory:</span></span>

* <span data-ttu-id="83935-128">En [organisationsenhet](../active-directory-domain-services/active-directory-ds-admin-guide-create-ou.md) måste skapas inom du placera hello HDInsight-klustrets virtuella datorer och hello tjänstens huvudnamn som används av hello klustret.</span><span class="sxs-lookup"><span data-stu-id="83935-128">An [organizational unit](../active-directory-domain-services/active-directory-ds-admin-guide-create-ou.md) must be created, within which you place hello HDInsight cluster VMs and hello service principals used by hello cluster.</span></span>
* <span data-ttu-id="83935-129">[Protokoll för Lightweight Directory Access](../active-directory-domain-services/active-directory-ds-admin-guide-configure-secure-ldap.md) (LDAPs) måste ställas in för att kommunicera med AD.</span><span class="sxs-lookup"><span data-stu-id="83935-129">[Lightweight Directory Access Protocols](../active-directory-domain-services/active-directory-ds-admin-guide-configure-secure-ldap.md) (LDAPs) must be set up for communicating with AD.</span></span> <span data-ttu-id="83935-130">hello certifikatet som används för tooset in LDAPS måste vara en verklig certifikat (inte ett självsignerat certifikat).</span><span class="sxs-lookup"><span data-stu-id="83935-130">hello certificate used tooset up LDAPS must be a real certificate (not a self-signed certificate).</span></span>
* <span data-ttu-id="83935-131">Omvänd DNS-zoner måste skapas på hello domän för hello IP-adressintervall hello HDInsight undernät (till exempel 10.2.0.0/24 i hello föregående bild).</span><span class="sxs-lookup"><span data-stu-id="83935-131">Reverse DNS zones must be created on hello domain for hello IP address range of hello HDInsight subnet (for example, 10.2.0.0/24 in hello previous picture).</span></span>
* <span data-ttu-id="83935-132">Ett tjänstkonto eller ett användarkonto krävs.</span><span class="sxs-lookup"><span data-stu-id="83935-132">A service account or a user account is needed.</span></span> <span data-ttu-id="83935-133">Använd det här kontot toocreate hello HDInsight-kluster.</span><span class="sxs-lookup"><span data-stu-id="83935-133">Use this account toocreate hello HDInsight cluster.</span></span> <span data-ttu-id="83935-134">Det här kontot måste ha hello följande behörigheter:</span><span class="sxs-lookup"><span data-stu-id="83935-134">This account must have hello following permissions:</span></span>

    - <span data-ttu-id="83935-135">Behörigheter toocreate service principal och datorobjekt inom hello organisationsenhet</span><span class="sxs-lookup"><span data-stu-id="83935-135">Permissions toocreate service principal objects and machine objects within hello organizational unit</span></span>
    - <span data-ttu-id="83935-136">Behörigheter toocreate omvänd DNS-proxy regler</span><span class="sxs-lookup"><span data-stu-id="83935-136">Permissions toocreate reverse DNS proxy rules</span></span>
    - <span data-ttu-id="83935-137">Behörigheter toojoin datorer toohello Active Directory-domän</span><span class="sxs-lookup"><span data-stu-id="83935-137">Permissions toojoin machines toohello Active Directory domain</span></span>

<span data-ttu-id="83935-138">**HDInsight integrerad med endast molnbaserad Azure AD**</span><span class="sxs-lookup"><span data-stu-id="83935-138">**HDInsight integrated with cloud-only Azure AD**</span></span>

<span data-ttu-id="83935-139">För endast molnbaserad Azure AD måste du konfigurera en domänkontrollant så att HDInsight kan integreras med Azure AD.</span><span class="sxs-lookup"><span data-stu-id="83935-139">For cloud-only Azure AD, configure a domain controller so that HDInsight can be integrated with Azure AD.</span></span> <span data-ttu-id="83935-140">Detta uppnås med hjälp av [Azure Active Directory Domain Services](../active-directory-domain-services/active-directory-ds-overview.md) (Azure AD DS).</span><span class="sxs-lookup"><span data-stu-id="83935-140">This is achieved by using [Azure Active Directory Domain Services](../active-directory-domain-services/active-directory-ds-overview.md) (Azure AD DS).</span></span> <span data-ttu-id="83935-141">Azure AD DS skapar domän domänkontroller-datorer på hello molnet och tillhandahåller IP-adresser för dessa.</span><span class="sxs-lookup"><span data-stu-id="83935-141">Azure AD DS creates domain controller machines on hello cloud and provides IP addresses for them.</span></span> <span data-ttu-id="83935-142">Två domänkontrollanter skapas för hög tillgänglighet.</span><span class="sxs-lookup"><span data-stu-id="83935-142">It creates two domain controllers for high availability.</span></span>

<span data-ttu-id="83935-143">Azure AD DS finns för närvarande bara i klassiska virtuella nätverk.</span><span class="sxs-lookup"><span data-stu-id="83935-143">Currently, Azure AD DS exists only in classic virtual networks.</span></span> <span data-ttu-id="83935-144">Det är bara tillgänglig med hello klassiska Azure-portalen.</span><span class="sxs-lookup"><span data-stu-id="83935-144">It is only accessible by using hello Azure classic portal.</span></span> <span data-ttu-id="83935-145">Hej HDInsight virtuella nätverk finns i hello Azure-portalen som måste toobe peerkopplat med hello klassiskt virtuellt nätverk med hjälp av VNet-till-VNet-peering.</span><span class="sxs-lookup"><span data-stu-id="83935-145">hello HDInsight virtual network exists in hello Azure portal, which needs toobe peered with hello classic virtual network by using VNet-to-VNet peering.</span></span>

> [!NOTE]
> <span data-ttu-id="83935-146">Peering mellan ett klassiskt virtuellt nätverk och en Azure Resource Manager-virtuella nätverk som kräver att båda virtuella nätverken är i samma region hello och hello under samma Azure-prenumeration.</span><span class="sxs-lookup"><span data-stu-id="83935-146">Peering between a classic virtual network and an Azure Resource Manager virtual network requires that both virtual networks are in hello same region and under hello same Azure subscription.</span></span>

![Domänansluten HDInsight-klustertopologi](./media/hdinsight-domain-joined-architecture/hdinsight-domain-joined-architecture_2.png)

<span data-ttu-id="83935-148">Krav för Azure AD:</span><span class="sxs-lookup"><span data-stu-id="83935-148">Prerequisites for Azure AD:</span></span>

* <span data-ttu-id="83935-149">En [organisationsenhet](../active-directory-domain-services/active-directory-ds-admin-guide-create-ou.md) måste skapas inom du placera hello HDInsight-klustrets virtuella datorer och hello tjänstens huvudnamn som används av hello klustret.</span><span class="sxs-lookup"><span data-stu-id="83935-149">An [organizational unit](../active-directory-domain-services/active-directory-ds-admin-guide-create-ou.md) must be created within which you place hello HDInsight cluster VMs and hello service principals used by hello cluster.</span></span>
* <span data-ttu-id="83935-150">[LDAPS](../active-directory-domain-services/active-directory-ds-admin-guide-configure-secure-ldap.md) måste konfigureras när du konfigurerar Azure AD DS.</span><span class="sxs-lookup"><span data-stu-id="83935-150">[LDAPS](../active-directory-domain-services/active-directory-ds-admin-guide-configure-secure-ldap.md) must be set up when you configure Azure AD DS.</span></span> <span data-ttu-id="83935-151">hello certifikatet som används för tooset in LDAPS måste vara en verklig certifikat (inte ett självsignerat certifikat).</span><span class="sxs-lookup"><span data-stu-id="83935-151">hello certificate used tooset up LDAPS must be a real certificate (not a self-signed certificate).</span></span>
* <span data-ttu-id="83935-152">Omvänd DNS-zoner måste skapas på hello domän för hello IP-adressintervall hello HDInsight undernät (till exempel 10.2.0.0/24 i hello föregående bild).</span><span class="sxs-lookup"><span data-stu-id="83935-152">Reverse DNS zones must be created on hello domain for hello IP address range of hello HDInsight subnet (for example, 10.2.0.0/24 in hello previous picture).</span></span>
* <span data-ttu-id="83935-153">[Lösenordshashvärden](../active-directory-domain-services/active-directory-ds-getting-started-password-sync.md) måste synkroniseras från Azure AD tooAzure AD DS.</span><span class="sxs-lookup"><span data-stu-id="83935-153">[Password hashes](../active-directory-domain-services/active-directory-ds-getting-started-password-sync.md) must be synced from Azure AD tooAzure AD DS.</span></span>
* <span data-ttu-id="83935-154">Ett tjänstkonto eller ett användarkonto krävs.</span><span class="sxs-lookup"><span data-stu-id="83935-154">A service account or a user account is needed.</span></span> <span data-ttu-id="83935-155">Använd det här kontot toocreate hello HDInsight-kluster.</span><span class="sxs-lookup"><span data-stu-id="83935-155">Use this account toocreate hello HDInsight cluster.</span></span> <span data-ttu-id="83935-156">Det här kontot måste ha hello följande behörigheter:</span><span class="sxs-lookup"><span data-stu-id="83935-156">This account must have hello following permissions:</span></span>

    - <span data-ttu-id="83935-157">Behörigheter toocreate service principal och datorobjekt inom hello organisationsenhet</span><span class="sxs-lookup"><span data-stu-id="83935-157">Permissions toocreate service principal objects and machine objects within hello organizational unit</span></span>
    - <span data-ttu-id="83935-158">Behörigheter toocreate omvänd DNS-proxy regler</span><span class="sxs-lookup"><span data-stu-id="83935-158">Permissions toocreate reverse DNS proxy rules</span></span>
    - <span data-ttu-id="83935-159">Behörigheter toojoin datorer toohello Azure AD-domän</span><span class="sxs-lookup"><span data-stu-id="83935-159">Permissions toojoin machines toohello Azure AD domain</span></span>

## <a name="next-steps"></a><span data-ttu-id="83935-160">Nästa steg</span><span class="sxs-lookup"><span data-stu-id="83935-160">Next steps</span></span>
* <span data-ttu-id="83935-161">tooconfigure ett domänanslutna HDInsight-kluster, se [konfigurera domänanslutna HDInsight-kluster](hdinsight-domain-joined-configure.md).</span><span class="sxs-lookup"><span data-stu-id="83935-161">tooconfigure a domain-joined HDInsight cluster, see [Configure domain-joined HDInsight clusters](hdinsight-domain-joined-configure.md).</span></span>
* <span data-ttu-id="83935-162">toomanage domänanslutna HDInsight-kluster, se [hantera domänanslutna HDInsight-kluster](hdinsight-domain-joined-manage.md).</span><span class="sxs-lookup"><span data-stu-id="83935-162">toomanage domain-joined HDInsight clusters, see [Manage domain-joined HDInsight clusters](hdinsight-domain-joined-manage.md).</span></span>
* <span data-ttu-id="83935-163">tooconfigure Hive och kör Hive-frågor, se [konfigurera Hive principer för domänanslutna HDInsight-kluster](hdinsight-domain-joined-run-hive.md).</span><span class="sxs-lookup"><span data-stu-id="83935-163">tooconfigure Hive policies and run Hive queries, see [Configure Hive policies for domain-joined HDInsight clusters](hdinsight-domain-joined-run-hive.md).</span></span>
* <span data-ttu-id="83935-164">toorun Hive-frågor med hjälp av SSH på domänanslutna HDInsight-kluster, se [använda SSH med HDInsight](hdinsight-hadoop-linux-use-ssh-unix.md).</span><span class="sxs-lookup"><span data-stu-id="83935-164">toorun Hive queries by using SSH on domain-joined HDInsight clusters, see [Use SSH with HDInsight](hdinsight-hadoop-linux-use-ssh-unix.md).</span></span>
