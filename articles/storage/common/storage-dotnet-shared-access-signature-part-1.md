---
title: "aaaUsing signaturer för delad åtkomst (SAS) i Azure Storage | Microsoft Docs"
description: "Lär dig toouse delad åtkomst signaturer (SAS) toodelegate åtkomst tooAzure lagringsresurser, inklusive blobbar, köer, tabeller och filer."
services: storage
documentationcenter: 
author: mmacy
manager: timlt
editor: tysonn
ms.assetid: 46fd99d7-36b3-4283-81e3-f214b29f1152
ms.service: storage
ms.workload: storage
ms.tgt_pltfrm: na
ms.devlang: dotnet
ms.topic: article
ms.date: 04/18/2017
ms.author: marsma
ms.openlocfilehash: 5b75a3c25bcfb9f1ceb81f31dc2d42376bd105cb
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 10/06/2017
---
# <a name="using-shared-access-signatures-sas"></a><span data-ttu-id="5f113-103">Använda signaturer för delad åtkomst (SAS)</span><span class="sxs-lookup"><span data-stu-id="5f113-103">Using shared access signatures (SAS)</span></span>

<span data-ttu-id="5f113-104">En signatur för delad åtkomst (SAS) ger dig ett sätt toogrant begränsad åtkomst tooobjects i ditt lagringskonto tooother klienter utan att utsätta din kontonyckel.</span><span class="sxs-lookup"><span data-stu-id="5f113-104">A shared access signature (SAS) provides you with a way toogrant limited access tooobjects in your storage account tooother clients, without exposing your account key.</span></span> <span data-ttu-id="5f113-105">I den här artikeln vi ger en översikt över hello SAS-modellen, metodtips för SAS och titta på några exempel.</span><span class="sxs-lookup"><span data-stu-id="5f113-105">In this article, we provide an overview of hello SAS model, review SAS best practices, and look at some examples.</span></span>

<span data-ttu-id="5f113-106">För ytterligare kodexempel med hjälp av SAS utöver de som presenteras här, se [komma igång med Azure Blob Storage i .NET](https://azure.microsoft.com/documentation/samples/storage-blob-dotnet-getting-started/) och andra hello-exempel [Azure kodexempel](https://azure.microsoft.com/documentation/samples/?service=storage) bibliotek.</span><span class="sxs-lookup"><span data-stu-id="5f113-106">For additional code examples using SAS beyond those presented here, see [Getting Started with Azure Blob Storage in .NET](https://azure.microsoft.com/documentation/samples/storage-blob-dotnet-getting-started/) and other samples available in hello [Azure Code Samples](https://azure.microsoft.com/documentation/samples/?service=storage) library.</span></span> <span data-ttu-id="5f113-107">Du kan hämta hello exempelprogram och köra dem eller bläddra hello koden på GitHub.</span><span class="sxs-lookup"><span data-stu-id="5f113-107">You can download hello sample applications and run them, or browse hello code on GitHub.</span></span>

## <a name="what-is-a-shared-access-signature"></a><span data-ttu-id="5f113-108">Vad är en signatur för delad åtkomst?</span><span class="sxs-lookup"><span data-stu-id="5f113-108">What is a shared access signature?</span></span>
<span data-ttu-id="5f113-109">En signatur för delad åtkomst ger delegerad åtkomst tooresources i ditt lagringskonto.</span><span class="sxs-lookup"><span data-stu-id="5f113-109">A shared access signature provides delegated access tooresources in your storage account.</span></span> <span data-ttu-id="5f113-110">Du kan ge klienter åtkomst till tooresources i ditt lagringskonto, utan att dela dina nycklar med en SAS.</span><span class="sxs-lookup"><span data-stu-id="5f113-110">With a SAS, you can grant clients access tooresources in your storage account, without sharing your account keys.</span></span> <span data-ttu-id="5f113-111">Detta är hello nyckel använder signaturer för delad åtkomst i dina program – en SAS är ett säkert sätt tooshare dina lagringsresurser utan att kompromissa med dina nycklar för kontot.</span><span class="sxs-lookup"><span data-stu-id="5f113-111">This is hello key point of using shared access signatures in your applications--a SAS is a secure way tooshare your storage resources without compromising your account keys.</span></span>

[!INCLUDE [storage-account-key-note-include](../../../includes/storage-account-key-note-include.md)]

<span data-ttu-id="5f113-112">En SAS ger detaljerad kontroll över hello typ av åtkomst du bevilja tooclients som har hello SAS, inklusive:</span><span class="sxs-lookup"><span data-stu-id="5f113-112">A SAS gives you granular control over hello type of access you grant tooclients who have hello SAS, including:</span></span>

* <span data-ttu-id="5f113-113">hello intervall över vilka hello SAS är giltiga, inklusive hello starttid och hello förfallotiden.</span><span class="sxs-lookup"><span data-stu-id="5f113-113">hello interval over which hello SAS is valid, including hello start time and hello expiry time.</span></span>
* <span data-ttu-id="5f113-114">hello behörigheterna av hello SAS.</span><span class="sxs-lookup"><span data-stu-id="5f113-114">hello permissions granted by hello SAS.</span></span> <span data-ttu-id="5f113-115">Till exempel kan en SAS för en blob bevilja läsbehörighet och skriva behörigheter toothat blob, men inte att ta bort behörigheter.</span><span class="sxs-lookup"><span data-stu-id="5f113-115">For example, a SAS for a blob might grant read and write permissions toothat blob, but not delete permissions.</span></span>
* <span data-ttu-id="5f113-116">En valfri IP-adress eller intervall av IP-adresser som Azure Storage godkänner hello SAS.</span><span class="sxs-lookup"><span data-stu-id="5f113-116">An optional IP address or range of IP addresses from which Azure Storage will accept hello SAS.</span></span> <span data-ttu-id="5f113-117">Du kan till exempel ange ett intervall IP-adresser som tillhör tooyour organisation.</span><span class="sxs-lookup"><span data-stu-id="5f113-117">For example, you might specify a range of IP addresses belonging tooyour organization.</span></span>
* <span data-ttu-id="5f113-118">hello protokoll som du ska ta emot hello SAS Azure Storage.</span><span class="sxs-lookup"><span data-stu-id="5f113-118">hello protocol over which Azure Storage will accept hello SAS.</span></span> <span data-ttu-id="5f113-119">Du kan använda den här valfria parametern toorestrict åtkomst tooclients med hjälp av HTTPS.</span><span class="sxs-lookup"><span data-stu-id="5f113-119">You can use this optional parameter toorestrict access tooclients using HTTPS.</span></span>

## <a name="when-should-you-use-a-shared-access-signature"></a><span data-ttu-id="5f113-120">När bör du använda en signatur för delad åtkomst?</span><span class="sxs-lookup"><span data-stu-id="5f113-120">When should you use a shared access signature?</span></span>
<span data-ttu-id="5f113-121">Du kan använda en SAS när du vill tooprovide åtkomst tooresources i storage-konto tooany klienten inte har åtkomstnycklarna för ditt lagringskonto.</span><span class="sxs-lookup"><span data-stu-id="5f113-121">You can use a SAS when you want tooprovide access tooresources in your storage account tooany client not possessing your storage account's access keys.</span></span> <span data-ttu-id="5f113-122">Ditt lagringskonto innehåller både en primär och sekundär snabbtangent, som båda bevilja administratörsbehörighet tooyour konto och alla resurser i den.</span><span class="sxs-lookup"><span data-stu-id="5f113-122">Your storage account includes both a primary and secondary access key, both of which grant administrative access tooyour account, and all resources within it.</span></span> <span data-ttu-id="5f113-123">Ditt konto toohello möjligheten att skadlig eller bristande öppnas exponering av någon av dessa nycklar.</span><span class="sxs-lookup"><span data-stu-id="5f113-123">Exposing either of these keys opens your account toohello possibility of malicious or negligent use.</span></span> <span data-ttu-id="5f113-124">Signaturer för delad åtkomst är en säker alternativ som tillåter klienter tooread, skriva och ta bort data i ditt lagringskonto enligt toohello behörigheter som du uttryckligen har beviljat utan behovet av att någon kontonyckel.</span><span class="sxs-lookup"><span data-stu-id="5f113-124">Shared access signatures provide a safe alternative that allows clients tooread, write, and delete data in your storage account according toohello permissions you've explicitly granted, and without need for an account key.</span></span>

<span data-ttu-id="5f113-125">Ett vanligt scenario där en SAS är användbar är en tjänst där användare läsa och skriva sina egna data tooyour storage-konto.</span><span class="sxs-lookup"><span data-stu-id="5f113-125">A common scenario where a SAS is useful is a service where users read and write their own data tooyour storage account.</span></span> <span data-ttu-id="5f113-126">Det finns två vanliga designmönster i ett scenario där ett lagringskonto lagrar användardata:</span><span class="sxs-lookup"><span data-stu-id="5f113-126">In a scenario where a storage account stores user data, there are two typical design patterns:</span></span>

1. <span data-ttu-id="5f113-127">Klienter ladda upp och hämta data via en frontend-proxytjänst som utför autentisering.</span><span class="sxs-lookup"><span data-stu-id="5f113-127">Clients upload and download data via a front-end proxy service, which performs authentication.</span></span> <span data-ttu-id="5f113-128">Den här tjänsten frontend proxy har hello fördelen att det tillåter validering av affärsregler, men för stora mängder data eller omfattande transaktioner, skapa en tjänst som kan skalas toomatch begäran kan vara dyra eller svårt.</span><span class="sxs-lookup"><span data-stu-id="5f113-128">This front-end proxy service has hello advantage of allowing validation of business rules, but for large amounts of data or high-volume transactions, creating a service that can scale toomatch demand may be expensive or difficult.</span></span>

  ![Scenariot diagram: frontend-proxytjänst](./media/storage-dotnet-shared-access-signature-part-1/sas-storage-fe-proxy-service.png)   

1. <span data-ttu-id="5f113-130">En förenklad tjänst autentiserar hello klienten efter behov och genererar en SAS.</span><span class="sxs-lookup"><span data-stu-id="5f113-130">A lightweight service authenticates hello client as needed and then generates a SAS.</span></span> <span data-ttu-id="5f113-131">När hello klienten tar emot hello SAS kan de komma åt kontot lagringsresurser direkt med hello behörigheter har definierats av hello SAS och för hello-intervall som tillåts av hello SAS.</span><span class="sxs-lookup"><span data-stu-id="5f113-131">Once hello client receives hello SAS, they can access storage account resources directly with hello permissions defined by hello SAS and for hello interval allowed by hello SAS.</span></span> <span data-ttu-id="5f113-132">hello SAS minskar hello behovet för omdirigering av alla data via hello frontend proxy-tjänst.</span><span class="sxs-lookup"><span data-stu-id="5f113-132">hello SAS mitigates hello need for routing all data through hello front-end proxy service.</span></span>

  ![Scenariot diagram: SAS-providertjänst](./media/storage-dotnet-shared-access-signature-part-1/sas-storage-provider-service.png)   

<span data-ttu-id="5f113-134">Många verkliga tjänster kan använda en kombination av dessa två sätt.</span><span class="sxs-lookup"><span data-stu-id="5f113-134">Many real-world services may use a hybrid of these two approaches.</span></span> <span data-ttu-id="5f113-135">Vissa data kan till exempel bearbetas och godkänts via hello frontend proxy, medan andra data är sparade och/eller läsa med hjälp av SAS.</span><span class="sxs-lookup"><span data-stu-id="5f113-135">For example, some data might be processed and validated via hello front-end proxy, while other data is saved and/or read directly using SAS.</span></span>

<span data-ttu-id="5f113-136">Dessutom behöver du toouse ett SAS tooauthenticate hello källobjekt i en kopieringsåtgärd i vissa scenarier:</span><span class="sxs-lookup"><span data-stu-id="5f113-136">Additionally, you will need toouse a SAS tooauthenticate hello source object in a copy operation in certain scenarios:</span></span>

* <span data-ttu-id="5f113-137">När du kopierar en blob tooanother blob som finns i ett annat lagringskonto, måste du använda en SAS tooauthenticate hello käll-blob.</span><span class="sxs-lookup"><span data-stu-id="5f113-137">When you copy a blob tooanother blob that resides in a different storage account, you must use a SAS tooauthenticate hello source blob.</span></span> <span data-ttu-id="5f113-138">Du kan eventuellt använda en SAS tooauthenticate hello mål-blob samt.</span><span class="sxs-lookup"><span data-stu-id="5f113-138">You can optionally use a SAS tooauthenticate hello destination blob as well.</span></span>
* <span data-ttu-id="5f113-139">När du kopierar en fil tooanother som finns i ett annat lagringskonto, måste du använda en SAS tooauthenticate hello källfil.</span><span class="sxs-lookup"><span data-stu-id="5f113-139">When you copy a file tooanother file that resides in a different storage account, you must use a SAS tooauthenticate hello source file.</span></span> <span data-ttu-id="5f113-140">Du kan eventuellt använda en SAS tooauthenticate hello målfil samt.</span><span class="sxs-lookup"><span data-stu-id="5f113-140">You can optionally use a SAS tooauthenticate hello destination file as well.</span></span>
* <span data-ttu-id="5f113-141">När du kopierar en tooa blob-fil eller en fil tooa blob, måste du använda en SAS tooauthenticate hello källobjektet, även om hello käll- och objekt som finns inom hello samma lagringskonto.</span><span class="sxs-lookup"><span data-stu-id="5f113-141">When you copy a blob tooa file, or a file tooa blob, you must use a SAS tooauthenticate hello source object, even if hello source and destination objects reside within hello same storage account.</span></span>

## <a name="types-of-shared-access-signatures"></a><span data-ttu-id="5f113-142">Typer av signaturer för delad åtkomst</span><span class="sxs-lookup"><span data-stu-id="5f113-142">Types of shared access signatures</span></span>
<span data-ttu-id="5f113-143">Du kan skapa två typer av signaturer för delad åtkomst:</span><span class="sxs-lookup"><span data-stu-id="5f113-143">You can create two types of shared access signatures:</span></span>

* <span data-ttu-id="5f113-144">**Tjänst-SAS.**</span><span class="sxs-lookup"><span data-stu-id="5f113-144">**Service SAS.**</span></span> <span data-ttu-id="5f113-145">hello service SAS delegater åtkomst tooa resursen i en av hello lagringstjänster: hello Blob, kön, tabell eller fil-tjänsten.</span><span class="sxs-lookup"><span data-stu-id="5f113-145">hello service SAS delegates access tooa resource in just one of hello storage services: hello Blob, Queue, Table, or File service.</span></span> <span data-ttu-id="5f113-146">Se [hur du skapar en tjänst-SAS](https://msdn.microsoft.com/library/dn140255.aspx) och [Service SAS exempel](https://msdn.microsoft.com/library/dn140256.aspx) för detaljerad information om hur du skapar hello service SAS-token.</span><span class="sxs-lookup"><span data-stu-id="5f113-146">See [Constructing a Service SAS](https://msdn.microsoft.com/library/dn140255.aspx) and [Service SAS Examples](https://msdn.microsoft.com/library/dn140256.aspx) for in-depth information about constructing hello service SAS token.</span></span>
* <span data-ttu-id="5f113-147">**Konto-SAS.**</span><span class="sxs-lookup"><span data-stu-id="5f113-147">**Account SAS.**</span></span> <span data-ttu-id="5f113-148">hello konto SAS delegater komma åt tooresources i en eller flera hello lagringstjänster.</span><span class="sxs-lookup"><span data-stu-id="5f113-148">hello account SAS delegates access tooresources in one or more of hello storage services.</span></span> <span data-ttu-id="5f113-149">Alla hello-åtgärder som är tillgängliga via en tjänst-SAS finns också tillgängliga via en konto-SAS.</span><span class="sxs-lookup"><span data-stu-id="5f113-149">All of hello operations available via a service SAS are also available via an account SAS.</span></span> <span data-ttu-id="5f113-150">Dessutom med hello konto SAS, du kan delegera åtkomst toooperations som gäller tooa beroende tjänst, t.ex **Get/Set-tjänstegenskaper** och **få statistik för tjänsten**. Du kan också delegera åtkomst tooread-, Skriv- och delete-åtgärder på blob-behållare, tabeller, köer och filresurser som inte tillåts med en tjänst-SAS.</span><span class="sxs-lookup"><span data-stu-id="5f113-150">Additionally, with hello account SAS, you can delegate access toooperations that apply tooa given service, such as **Get/Set Service Properties** and **Get Service Stats**. You can also delegate access tooread, write, and delete operations on blob containers, tables, queues, and file shares that are not permitted with a service SAS.</span></span> <span data-ttu-id="5f113-151">Se [hur du skapar ett konto-SAS](https://msdn.microsoft.com/library/mt584140.aspx) för detaljerad information om hur du skapar hello konto SAS-token.</span><span class="sxs-lookup"><span data-stu-id="5f113-151">See [Constructing an Account SAS](https://msdn.microsoft.com/library/mt584140.aspx) for in-depth information about constructing hello account SAS token.</span></span>

## <a name="how-a-shared-access-signature-works"></a><span data-ttu-id="5f113-152">Så här fungerar en signatur för delad åtkomst</span><span class="sxs-lookup"><span data-stu-id="5f113-152">How a shared access signature works</span></span>
<span data-ttu-id="5f113-153">En signatur för delad åtkomst är en signerad URI pekar tooone eller mer lagringsresurser som innehåller en token som innehåller en särskild uppsättning Frågeparametrar.</span><span class="sxs-lookup"><span data-stu-id="5f113-153">A shared access signature is a signed URI that points tooone or more storage resources and includes a token that contains a special set of query parameters.</span></span> <span data-ttu-id="5f113-154">hello token anger hur hello resurser kan användas av hello-klienten.</span><span class="sxs-lookup"><span data-stu-id="5f113-154">hello token indicates how hello resources may be accessed by hello client.</span></span> <span data-ttu-id="5f113-155">En hello frågeparametrar Hej signatur, är konstrueras utifrån hello SAS parametrar och signerad med hello kontonyckel.</span><span class="sxs-lookup"><span data-stu-id="5f113-155">One of hello query parameters, hello signature, is constructed from hello SAS parameters and signed with hello account key.</span></span> <span data-ttu-id="5f113-156">Den här signaturen används av Azure Storage tooauthenticate hello SAS.</span><span class="sxs-lookup"><span data-stu-id="5f113-156">This signature is used by Azure Storage tooauthenticate hello SAS.</span></span>

<span data-ttu-id="5f113-157">Här är ett exempel på en SAS-URI, som visar hello resurs-URI och hello SAS-token:</span><span class="sxs-lookup"><span data-stu-id="5f113-157">Here's an example of a SAS URI, showing hello resource URI and hello SAS token:</span></span>

![Komponenter för en SAS-URI](./media/storage-dotnet-shared-access-signature-part-1/sas-storage-uri.png)   

<span data-ttu-id="5f113-159">hello SAS-token är en sträng som du skapar på hello *klienten* sida (se hello [SAS exempel](#sas-examples) avsnittet kodexempel).</span><span class="sxs-lookup"><span data-stu-id="5f113-159">hello SAS token is a string you generate on hello *client* side (see hello [SAS examples](#sas-examples) section for code examples).</span></span> <span data-ttu-id="5f113-160">En SAS-token som du skapar med hello storage-klientbibliotek, till exempel spåras inte av Azure Storage på något sätt.</span><span class="sxs-lookup"><span data-stu-id="5f113-160">A SAS token you generate with hello storage client library, for example, is not tracked by Azure Storage in any way.</span></span> <span data-ttu-id="5f113-161">Du kan skapa ett obegränsat antal SAS-token på hello på klientsidan.</span><span class="sxs-lookup"><span data-stu-id="5f113-161">You can create an unlimited number of SAS tokens on hello client side.</span></span>

<span data-ttu-id="5f113-162">När en klient innehåller SAS-URI-tooAzure lagring som en del av en begäran, kontrollerar hello-tjänsten hello SAS parametrar och signatur tooverify om den är giltig för att autentisera hello-begäran.</span><span class="sxs-lookup"><span data-stu-id="5f113-162">When a client provides a SAS URI tooAzure Storage as part of a request, hello service checks hello SAS parameters and signature tooverify that it is valid for authenticating hello request.</span></span> <span data-ttu-id="5f113-163">Om hello tjänsten kontrollerar hello signaturen är giltig, autentisera hello-begäran.</span><span class="sxs-lookup"><span data-stu-id="5f113-163">If hello service verifies that hello signature is valid, then hello request is authenticated.</span></span> <span data-ttu-id="5f113-164">Annars har hello begäran nekats med felkoden 403 (förbjuden).</span><span class="sxs-lookup"><span data-stu-id="5f113-164">Otherwise, hello request is declined with error code 403 (Forbidden).</span></span>

## <a name="shared-access-signature-parameters"></a><span data-ttu-id="5f113-165">Parametrar för signatur för delad åtkomst</span><span class="sxs-lookup"><span data-stu-id="5f113-165">Shared access signature parameters</span></span>
<span data-ttu-id="5f113-166">hello konto-SAS service SAS-token innehåller några vanliga parametrar och också tar några parametrar som är olika.</span><span class="sxs-lookup"><span data-stu-id="5f113-166">hello account SAS and service SAS tokens include some common parameters, and also take a few parameters that that are different.</span></span>

### <a name="parameters-common-tooaccount-sas-and-service-sas-tokens"></a><span data-ttu-id="5f113-167">Parametrarna vanliga tooaccount SAS och tjänsten SAS-token</span><span class="sxs-lookup"><span data-stu-id="5f113-167">Parameters common tooaccount SAS and service SAS tokens</span></span>
* <span data-ttu-id="5f113-168">**API-versionen** en valfri parameter som anger hello lagring version toouse tooexecute hello tjänstbegäran.</span><span class="sxs-lookup"><span data-stu-id="5f113-168">**Api version** An optional parameter that specifies hello storage service version toouse tooexecute hello request.</span></span>
* <span data-ttu-id="5f113-169">**Service-version** en obligatorisk parameter som anger hello lagring version toouse tooauthenticate hello tjänstbegäran.</span><span class="sxs-lookup"><span data-stu-id="5f113-169">**Service version** A required parameter that specifies hello storage service version toouse tooauthenticate hello request.</span></span>
* <span data-ttu-id="5f113-170">**Starttid.**</span><span class="sxs-lookup"><span data-stu-id="5f113-170">**Start time.**</span></span> <span data-ttu-id="5f113-171">Detta är hello tid vid vilken hello SAS börjar gälla.</span><span class="sxs-lookup"><span data-stu-id="5f113-171">This is hello time at which hello SAS becomes valid.</span></span> <span data-ttu-id="5f113-172">hello starttiden för en signatur för delad åtkomst är valfritt.</span><span class="sxs-lookup"><span data-stu-id="5f113-172">hello start time for a shared access signature is optional.</span></span> <span data-ttu-id="5f113-173">Om en starttid utelämnas är hello SAS gälla omedelbart.</span><span class="sxs-lookup"><span data-stu-id="5f113-173">If a start time is omitted, hello SAS is effective immediately.</span></span> <span data-ttu-id="5f113-174">hello starttid måste anges i UTC (Coordinated Universal Time) med en särskild UTC beteckning (”Z”), till exempel `1994-11-05T13:15:30Z`.</span><span class="sxs-lookup"><span data-stu-id="5f113-174">hello start time must be expressed in UTC (Coordinated Universal Time), with a special UTC designator ("Z"), for example `1994-11-05T13:15:30Z`.</span></span>
* <span data-ttu-id="5f113-175">**Förfallotiden.**</span><span class="sxs-lookup"><span data-stu-id="5f113-175">**Expiry time.**</span></span> <span data-ttu-id="5f113-176">Detta är Hej då efter vilken hello SAS är inte längre giltig.</span><span class="sxs-lookup"><span data-stu-id="5f113-176">This is hello time after which hello SAS is no longer valid.</span></span> <span data-ttu-id="5f113-177">Bästa praxis rekommenderar att du antingen ange en förfallotiden för en SAS eller koppla den till en princip för lagrade åtkomst.</span><span class="sxs-lookup"><span data-stu-id="5f113-177">Best practices recommend that you either specify an expiry time for a SAS, or associate it with a stored access policy.</span></span> <span data-ttu-id="5f113-178">hello förfallotiden måste anges i UTC (Coordinated Universal Time) med en särskild UTC beteckning (”Z”), till exempel `1994-11-05T13:15:30Z` (se mer nedan).</span><span class="sxs-lookup"><span data-stu-id="5f113-178">hello expiry time must be expressed in UTC (Coordinated Universal Time), with a special UTC designator ("Z"), for example `1994-11-05T13:15:30Z` (see more below).</span></span>
* <span data-ttu-id="5f113-179">**Behörigheter.**</span><span class="sxs-lookup"><span data-stu-id="5f113-179">**Permissions.**</span></span> <span data-ttu-id="5f113-180">hello behörigheter anges på hello SAS visar vilka åtgärder som hello klienten kan utföra mot hello storage-resursen med hjälp av hello SAS.</span><span class="sxs-lookup"><span data-stu-id="5f113-180">hello permissions specified on hello SAS indicate what operations hello client can perform against hello storage resource using hello SAS.</span></span> <span data-ttu-id="5f113-181">Tillgängliga behörigheter skiljer sig för en konto-SAS och en tjänst-SAS.</span><span class="sxs-lookup"><span data-stu-id="5f113-181">Available permissions differ for an account SAS and a service SAS.</span></span>
* <span data-ttu-id="5f113-182">**IP-ADRESSEN.**</span><span class="sxs-lookup"><span data-stu-id="5f113-182">**IP.**</span></span> <span data-ttu-id="5f113-183">En valfri parameter som anger en IP-adress eller ett intervall med IP-adresser utanför Azure (hello i avsnittet [konfiguration av Routning sessionstillstånd](../../expressroute/expressroute-workflows.md#routing-session-configuration-state) för Express Route) från vilka tooaccept begäranden.</span><span class="sxs-lookup"><span data-stu-id="5f113-183">An optional parameter that specifies an IP address or a range of IP addresses outside of Azure (see hello section [Routing session configuration state](../../expressroute/expressroute-workflows.md#routing-session-configuration-state) for Express Route) from which tooaccept requests.</span></span>
* <span data-ttu-id="5f113-184">**Protokoll.**</span><span class="sxs-lookup"><span data-stu-id="5f113-184">**Protocol.**</span></span> <span data-ttu-id="5f113-185">En valfri parameter som anger hello protokoll tillåts för en begäran.</span><span class="sxs-lookup"><span data-stu-id="5f113-185">An optional parameter that specifies hello protocol permitted for a request.</span></span> <span data-ttu-id="5f113-186">Möjliga värden är HTTPS- och HTTP (`https,http`), vilket är standardvärdet för hello eller HTTPS endast (`https`).</span><span class="sxs-lookup"><span data-stu-id="5f113-186">Possible values are both HTTPS and HTTP (`https,http`), which is hello default value, or HTTPS only (`https`).</span></span> <span data-ttu-id="5f113-187">Observera att HTTP endast inte är tillåtna värdet.</span><span class="sxs-lookup"><span data-stu-id="5f113-187">Note that HTTP only is not a permitted value.</span></span>
* <span data-ttu-id="5f113-188">**Signatur.**</span><span class="sxs-lookup"><span data-stu-id="5f113-188">**Signature.**</span></span> <span data-ttu-id="5f113-189">hello signatur konstrueras utifrån hello andra parametrar som angetts som en del token och sedan krypteras.</span><span class="sxs-lookup"><span data-stu-id="5f113-189">hello signature is constructed from hello other parameters specified as part token and then encrypted.</span></span> <span data-ttu-id="5f113-190">Den används tooauthenticate hello SAS.</span><span class="sxs-lookup"><span data-stu-id="5f113-190">It's used tooauthenticate hello SAS.</span></span>

### <a name="parameters-for-a-service-sas-token"></a><span data-ttu-id="5f113-191">Parametrar för en tjänst-SAS-token</span><span class="sxs-lookup"><span data-stu-id="5f113-191">Parameters for a service SAS token</span></span>
* <span data-ttu-id="5f113-192">**Storage-resursen.**</span><span class="sxs-lookup"><span data-stu-id="5f113-192">**Storage resource.**</span></span> <span data-ttu-id="5f113-193">Storage-resurser som du kan delegera åtkomst med en tjänst SAS inkluderar:</span><span class="sxs-lookup"><span data-stu-id="5f113-193">Storage resources for which you can delegate access with a service SAS include:</span></span>
  * <span data-ttu-id="5f113-194">Behållare och blobbar</span><span class="sxs-lookup"><span data-stu-id="5f113-194">Containers and blobs</span></span>
  * <span data-ttu-id="5f113-195">Filresurser och filer</span><span class="sxs-lookup"><span data-stu-id="5f113-195">File shares and files</span></span>
  * <span data-ttu-id="5f113-196">Köer</span><span class="sxs-lookup"><span data-stu-id="5f113-196">Queues</span></span>
  * <span data-ttu-id="5f113-197">Tabeller och intervallen för tabellentiteter.</span><span class="sxs-lookup"><span data-stu-id="5f113-197">Tables and ranges of table entities.</span></span>

### <a name="parameters-for-an-account-sas-token"></a><span data-ttu-id="5f113-198">Parametrar för ett konto SAS-token</span><span class="sxs-lookup"><span data-stu-id="5f113-198">Parameters for an account SAS token</span></span>
* <span data-ttu-id="5f113-199">**Tjänsten eller tjänster.**</span><span class="sxs-lookup"><span data-stu-id="5f113-199">**Service or services.**</span></span> <span data-ttu-id="5f113-200">En konto-SAS kan delegera åtkomst tooone eller flera av hello lagringstjänster.</span><span class="sxs-lookup"><span data-stu-id="5f113-200">An account SAS can delegate access tooone or more of hello storage services.</span></span> <span data-ttu-id="5f113-201">Du kan till exempel skapa ett konto SAS som ombud för dataåtkomsttjänsten toohello Blob och fil.</span><span class="sxs-lookup"><span data-stu-id="5f113-201">For example, you can create an account SAS that delegates access toohello Blob and File service.</span></span> <span data-ttu-id="5f113-202">Eller så kan du skapa en SAS att delegater åtkomst till tooall fyra tjänster (Blob, kön, tabell och filen).</span><span class="sxs-lookup"><span data-stu-id="5f113-202">Or you can create a SAS that delegates access tooall four services (Blob, Queue, Table, and File).</span></span>
* <span data-ttu-id="5f113-203">**Typer av lagring.**</span><span class="sxs-lookup"><span data-stu-id="5f113-203">**Storage resource types.**</span></span> <span data-ttu-id="5f113-204">En konto-SAS gäller tooone eller flera klasser av lagringsresurser, i stället för en viss resurs.</span><span class="sxs-lookup"><span data-stu-id="5f113-204">An account SAS applies tooone or more classes of storage resources, rather than a specific resource.</span></span> <span data-ttu-id="5f113-205">Du kan skapa ett konto SAS toodelegate åtkomst till:</span><span class="sxs-lookup"><span data-stu-id="5f113-205">You can create an account SAS toodelegate access to:</span></span>
  * <span data-ttu-id="5f113-206">Servicenivå API: er, som kallas mot hello lagringsresurs för kontot.</span><span class="sxs-lookup"><span data-stu-id="5f113-206">Service-level APIs, which are called against hello storage account resource.</span></span> <span data-ttu-id="5f113-207">Exempel inkluderar **Get/Set-tjänstegenskaper**, **få statistik för tjänsten**, och **lista behållare/köer/tabeller/resurser**.</span><span class="sxs-lookup"><span data-stu-id="5f113-207">Examples include **Get/Set Service Properties**, **Get Service Stats**, and **List Containers/Queues/Tables/Shares**.</span></span>
  * <span data-ttu-id="5f113-208">Behållare på objektnivå API: er, som kallas mot hello behållarobjekt för varje tjänst: blob-behållare, köer, tabeller och filresurser.</span><span class="sxs-lookup"><span data-stu-id="5f113-208">Container-level APIs, which are called against hello container objects for each service: blob containers, queues, tables, and file shares.</span></span> <span data-ttu-id="5f113-209">Exempel inkluderar **skapa/ta bort behållaren**, **skapa/ta bort kön**, **skapa/ta bort tabellen**, **skapa/ta bort resursen**, och  **Lista över BLOB-filer och kataloger**.</span><span class="sxs-lookup"><span data-stu-id="5f113-209">Examples include **Create/Delete Container**, **Create/Delete Queue**, **Create/Delete Table**, **Create/Delete Share**, and **List Blobs/Files and Directories**.</span></span>
  * <span data-ttu-id="5f113-210">På objektnivå API: er, som kallas mot BLOB, Kömeddelanden, tabellentiteter och filer.</span><span class="sxs-lookup"><span data-stu-id="5f113-210">Object-level APIs, which are called against blobs, queue messages, table entities, and files.</span></span> <span data-ttu-id="5f113-211">Till exempel **placera Blob**, **frågan entiteten**, **få meddelanden**, och **Create File**.</span><span class="sxs-lookup"><span data-stu-id="5f113-211">For example, **Put Blob**, **Query Entity**, **Get Messages**, and **Create File**.</span></span>

## <a name="examples-of-sas-uris"></a><span data-ttu-id="5f113-212">Exempel på SAS URI: er</span><span class="sxs-lookup"><span data-stu-id="5f113-212">Examples of SAS URIs</span></span>

### <a name="service-sas-uri-example"></a><span data-ttu-id="5f113-213">Tjänsten SAS-URI-exempel</span><span class="sxs-lookup"><span data-stu-id="5f113-213">Service SAS URI example</span></span>

<span data-ttu-id="5f113-214">Här är ett exempel på en SAS-URI som innehåller läsa och skriva behörigheter tooa blob-tjänst.</span><span class="sxs-lookup"><span data-stu-id="5f113-214">Here is an example of a service SAS URI that provides read and write permissions tooa blob.</span></span> <span data-ttu-id="5f113-215">hello tabell uppdelad varje del av hello URI toounderstand hur det bidrar toohello SAS:</span><span class="sxs-lookup"><span data-stu-id="5f113-215">hello table breaks down each part of hello URI toounderstand how it contributes toohello SAS:</span></span>

```
https://myaccount.blob.core.windows.net/sascontainer/sasblob.txt?sv=2015-04-05&st=2015-04-29T22%3A18%3A26Z&se=2015-04-30T02%3A23%3A26Z&sr=b&sp=rw&sip=168.1.5.60-168.1.5.70&spr=https&sig=Z%2FRHIX5Xcg0Mq2rqI3OlWTjEg2tYkboXr1P9ZUXDtkk%3D
```

| <span data-ttu-id="5f113-216">Namn</span><span class="sxs-lookup"><span data-stu-id="5f113-216">Name</span></span> | <span data-ttu-id="5f113-217">SAS-delen</span><span class="sxs-lookup"><span data-stu-id="5f113-217">SAS portion</span></span> | <span data-ttu-id="5f113-218">Beskrivning</span><span class="sxs-lookup"><span data-stu-id="5f113-218">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="5f113-219">BLOB-URI</span><span class="sxs-lookup"><span data-stu-id="5f113-219">Blob URI</span></span> |`https://myaccount.blob.core.windows.net/sascontainer/sasblob.txt` |<span data-ttu-id="5f113-220">hello adress hello-blob.</span><span class="sxs-lookup"><span data-stu-id="5f113-220">hello address of hello blob.</span></span> <span data-ttu-id="5f113-221">Observera att med hjälp av HTTPS rekommenderas starkt.</span><span class="sxs-lookup"><span data-stu-id="5f113-221">Note that using HTTPS is highly recommended.</span></span> |
| <span data-ttu-id="5f113-222">Storage services version</span><span class="sxs-lookup"><span data-stu-id="5f113-222">Storage services version</span></span> |`sv=2015-04-05` |<span data-ttu-id="5f113-223">För lagringstjänster version 12-02-2012 och senare kan den här parametern anger hello version toouse.</span><span class="sxs-lookup"><span data-stu-id="5f113-223">For storage services version 2012-02-12 and later, this parameter indicates hello version toouse.</span></span> |
| <span data-ttu-id="5f113-224">Starttid</span><span class="sxs-lookup"><span data-stu-id="5f113-224">Start time</span></span> |`st=2015-04-29T22%3A18%3A26Z` |<span data-ttu-id="5f113-225">Angivet i UTC-tid.</span><span class="sxs-lookup"><span data-stu-id="5f113-225">Specified in UTC time.</span></span> <span data-ttu-id="5f113-226">Om du vill hello SAS toobe giltig omedelbart utelämna hello starttid.</span><span class="sxs-lookup"><span data-stu-id="5f113-226">If you want hello SAS toobe valid immediately, omit hello start time.</span></span> |
| <span data-ttu-id="5f113-227">Förfallotiden</span><span class="sxs-lookup"><span data-stu-id="5f113-227">Expiry time</span></span> |`se=2015-04-30T02%3A23%3A26Z` |<span data-ttu-id="5f113-228">Angivet i UTC-tid.</span><span class="sxs-lookup"><span data-stu-id="5f113-228">Specified in UTC time.</span></span> |
| <span data-ttu-id="5f113-229">Resurs</span><span class="sxs-lookup"><span data-stu-id="5f113-229">Resource</span></span> |`sr=b` |<span data-ttu-id="5f113-230">hello resursen är en blob.</span><span class="sxs-lookup"><span data-stu-id="5f113-230">hello resource is a blob.</span></span> |
| <span data-ttu-id="5f113-231">Behörigheter</span><span class="sxs-lookup"><span data-stu-id="5f113-231">Permissions</span></span> |`sp=rw` |<span data-ttu-id="5f113-232">hello behörigheterna av hello SAS omfattar Read (r) och skriva (b).</span><span class="sxs-lookup"><span data-stu-id="5f113-232">hello permissions granted by hello SAS include Read (r) and Write (w).</span></span> |
| <span data-ttu-id="5f113-233">IP-intervall</span><span class="sxs-lookup"><span data-stu-id="5f113-233">IP range</span></span> |`sip=168.1.5.60-168.1.5.70` |<span data-ttu-id="5f113-234">hello intervall av IP-adresser som en begäran kommer att accepteras.</span><span class="sxs-lookup"><span data-stu-id="5f113-234">hello range of IP addresses from which a request will be accepted.</span></span> |
| <span data-ttu-id="5f113-235">Protokoll</span><span class="sxs-lookup"><span data-stu-id="5f113-235">Protocol</span></span> |`spr=https` |<span data-ttu-id="5f113-236">Endast de begäranden som använder HTTPS tillåts.</span><span class="sxs-lookup"><span data-stu-id="5f113-236">Only requests using HTTPS are permitted.</span></span> |
| <span data-ttu-id="5f113-237">Signatur</span><span class="sxs-lookup"><span data-stu-id="5f113-237">Signature</span></span> |`sig=Z%2FRHIX5Xcg0Mq2rqI3OlWTjEg2tYkboXr1P9ZUXDtkk%3D` |<span data-ttu-id="5f113-238">Använda tooauthenticate åtkomst toohello blob.</span><span class="sxs-lookup"><span data-stu-id="5f113-238">Used tooauthenticate access toohello blob.</span></span> <span data-ttu-id="5f113-239">hello signaturen är en HMAC beräknas över ett sträng-inloggning och nyckeln med hjälp av hello SHA256-algoritmen och sedan kodad med Base64-kodning.</span><span class="sxs-lookup"><span data-stu-id="5f113-239">hello signature is an HMAC computed over a string-to-sign and key using hello SHA256 algorithm, and then encoded using Base64 encoding.</span></span> |

### <a name="account-sas-uri-example"></a><span data-ttu-id="5f113-240">Kontot SAS-URI-exempel</span><span class="sxs-lookup"><span data-stu-id="5f113-240">Account SAS URI example</span></span>

<span data-ttu-id="5f113-241">Här är ett exempel på en konto-SAS att hello använder samma gemensamma parametrar för hello-token.</span><span class="sxs-lookup"><span data-stu-id="5f113-241">Here is an example of an account SAS that uses hello same common parameters on hello token.</span></span> <span data-ttu-id="5f113-242">Eftersom dessa parametrar beskrivs ovan, beskrivs de inte här.</span><span class="sxs-lookup"><span data-stu-id="5f113-242">Since these parameters are described above, they are not described here.</span></span> <span data-ttu-id="5f113-243">Hello-parametrar som är specifika tooaccount SAS beskrivs i hello nedan.</span><span class="sxs-lookup"><span data-stu-id="5f113-243">Only hello parameters that are specific tooaccount SAS are described in hello table below.</span></span>

```
https://myaccount.blob.core.windows.net/?restype=service&comp=properties&sv=2015-04-05&ss=bf&srt=s&st=2015-04-29T22%3A18%3A26Z&se=2015-04-30T02%3A23%3A26Z&sr=b&sp=rw&sip=168.1.5.60-168.1.5.70&spr=https&sig=F%6GRVAZ5Cdj2Pw4tgU7IlSTkWgn7bUkkAg8P6HESXwmf%4B
```

| <span data-ttu-id="5f113-244">Namn</span><span class="sxs-lookup"><span data-stu-id="5f113-244">Name</span></span> | <span data-ttu-id="5f113-245">SAS-delen</span><span class="sxs-lookup"><span data-stu-id="5f113-245">SAS portion</span></span> | <span data-ttu-id="5f113-246">Beskrivning</span><span class="sxs-lookup"><span data-stu-id="5f113-246">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="5f113-247">Resurs-URI</span><span class="sxs-lookup"><span data-stu-id="5f113-247">Resource URI</span></span> |`https://myaccount.blob.core.windows.net/?restype=service&comp=properties` |<span data-ttu-id="5f113-248">hello Blob-tjänstens slutpunkt, med parametrar för att hämta tjänstegenskaper (när den anropas med GET) eller ange tjänstegenskaper (när den anropas med).</span><span class="sxs-lookup"><span data-stu-id="5f113-248">hello Blob service endpoint, with parameters for getting service properties (when called with GET) or setting service properties (when called with SET).</span></span> |
| <span data-ttu-id="5f113-249">Tjänster</span><span class="sxs-lookup"><span data-stu-id="5f113-249">Services</span></span> |`ss=bf` |<span data-ttu-id="5f113-250">hello SAS gäller toohello Blob- och Filtjänster</span><span class="sxs-lookup"><span data-stu-id="5f113-250">hello SAS applies toohello Blob and File services</span></span> |
| <span data-ttu-id="5f113-251">Typer av resurser</span><span class="sxs-lookup"><span data-stu-id="5f113-251">Resource types</span></span> |`srt=s` |<span data-ttu-id="5f113-252">hello SAS gäller tooservice nivå åtgärder.</span><span class="sxs-lookup"><span data-stu-id="5f113-252">hello SAS applies tooservice-level operations.</span></span> |
| <span data-ttu-id="5f113-253">Behörigheter</span><span class="sxs-lookup"><span data-stu-id="5f113-253">Permissions</span></span> |`sp=rw` |<span data-ttu-id="5f113-254">hello behörigheter bevilja åtkomst tooread- och skrivåtgärder.</span><span class="sxs-lookup"><span data-stu-id="5f113-254">hello permissions grant access tooread and write operations.</span></span> |

<span data-ttu-id="5f113-255">Med hänsyn till att behörigheterna är begränsad toohello servicenivå, tillgängliga åtgärder med den här SAS är **hämta egenskaper för Blob-tjänsten** (läsa) och **ange egenskaper för Blob-tjänsten** (Skriv).</span><span class="sxs-lookup"><span data-stu-id="5f113-255">Given that permissions are restricted toohello service level, accessible operations with this SAS are **Get Blob Service Properties** (read) and **Set Blob Service Properties** (write).</span></span> <span data-ttu-id="5f113-256">Med en annan resurs URI hello samma SAS-token kan dock också vara används toodelegate åtkomst för**få statistik för Blob-tjänsten** (läsa).</span><span class="sxs-lookup"><span data-stu-id="5f113-256">However, with a different resource URI, hello same SAS token could also be used toodelegate access too**Get Blob Service Stats** (read).</span></span>

## <a name="controlling-a-sas-with-a-stored-access-policy"></a><span data-ttu-id="5f113-257">Kontrollera en SAS med en princip lagrade åtkomst</span><span class="sxs-lookup"><span data-stu-id="5f113-257">Controlling a SAS with a stored access policy</span></span>
<span data-ttu-id="5f113-258">En signatur för delad åtkomst kan göra något av två typer:</span><span class="sxs-lookup"><span data-stu-id="5f113-258">A shared access signature can take one of two forms:</span></span>

* <span data-ttu-id="5f113-259">**Ad hoc-SAS:** när du skapar en ad hoc-SAS, hello starttid, förfallotiden och behörigheter för hello SAS anges i hello SAS-URI (eller underförstådda, i hello fall där starttiden utelämnas).</span><span class="sxs-lookup"><span data-stu-id="5f113-259">**Ad hoc SAS:** When you create an ad hoc SAS, hello start time, expiry time, and permissions for hello SAS are all specified in hello SAS URI (or implied, in hello case where start time is omitted).</span></span> <span data-ttu-id="5f113-260">Den här typen av SAS kan skapas som ett konto SAS eller en tjänst-SAS.</span><span class="sxs-lookup"><span data-stu-id="5f113-260">This type of SAS can be created as an account SAS or a service SAS.</span></span>
* <span data-ttu-id="5f113-261">**SAS med lagrade åtkomstprincip:** lagrade åtkomstprincip har definierats för en resurs behållare – en blob-behållare, tabell, kö, eller filresurs-- och kan vara används toomanage begränsningarna för en eller flera signaturer för delad åtkomst.</span><span class="sxs-lookup"><span data-stu-id="5f113-261">**SAS with stored access policy:** A stored access policy is defined on a resource container--a blob container, table, queue, or file share--and can be used toomanage constraints for one or more shared access signatures.</span></span> <span data-ttu-id="5f113-262">När du kopplar en SAS med en lagrad till ärver hello SAS hello begränsningar--hello starttid och förfallotiden behörigheter--har definierats för hello lagras åtkomstprincip.</span><span class="sxs-lookup"><span data-stu-id="5f113-262">When you associate a SAS with a stored access policy, hello SAS inherits hello constraints--hello start time, expiry time, and permissions--defined for hello stored access policy.</span></span>

> [!NOTE]
> <span data-ttu-id="5f113-263">För närvarande måste en konto-SAS vara en ad hoc-SAS.</span><span class="sxs-lookup"><span data-stu-id="5f113-263">Currently, an account SAS must be an ad hoc SAS.</span></span> <span data-ttu-id="5f113-264">Lagrade åtkomst principer ännu inte stöds för konto-SAS.</span><span class="sxs-lookup"><span data-stu-id="5f113-264">Stored access policies are not yet supported for account SAS.</span></span>

<span data-ttu-id="5f113-265">hello skillnaden mellan hello två formulär är viktigt för ett key-scenario: återkallade certifikat.</span><span class="sxs-lookup"><span data-stu-id="5f113-265">hello difference between hello two forms is important for one key scenario: revocation.</span></span> <span data-ttu-id="5f113-266">Eftersom en SAS-URI är en URL, alla som erhåller hello SAS kan använda det, oavsett vem som skapade den.</span><span class="sxs-lookup"><span data-stu-id="5f113-266">Because a SAS URI is a URL, anyone that obtains hello SAS can use it, regardless of who originally created it.</span></span> <span data-ttu-id="5f113-267">Om en SAS publiceras offentligt, kan den användas av alla i hälsningsmeddelande.</span><span class="sxs-lookup"><span data-stu-id="5f113-267">If a SAS is published publicly, it can be used by anyone in hello world.</span></span> <span data-ttu-id="5f113-268">En SAS beviljar åtkomst tooresources tooanyone innehar den tills något av följande händer:</span><span class="sxs-lookup"><span data-stu-id="5f113-268">A SAS grants access tooresources tooanyone possessing it until one of four things happens:</span></span>

1. <span data-ttu-id="5f113-269">hello förfallotiden anges på hello SAS har uppnåtts.</span><span class="sxs-lookup"><span data-stu-id="5f113-269">hello expiry time specified on hello SAS is reached.</span></span>
2. <span data-ttu-id="5f113-270">hello förfallotiden har angetts på hello lagras åtkomstprincip som refereras av hello SAS har uppnåtts (om en lagrad åtkomstprincip refereras, och det anger en förfallotiden).</span><span class="sxs-lookup"><span data-stu-id="5f113-270">hello expiry time specified on hello stored access policy referenced by hello SAS is reached (if a stored access policy is referenced, and if it specifies an expiry time).</span></span> <span data-ttu-id="5f113-271">Detta kan inträffa eftersom hello intervall långa eller eftersom du har ändrat hello lagras åtkomstprincip med en förfallotiden i hello tidigare, vilket är ett sätt toorevoke hello SAS.</span><span class="sxs-lookup"><span data-stu-id="5f113-271">This can occur either because hello interval elapses, or because you've modified hello stored access policy with an expiry time in hello past, which is one way toorevoke hello SAS.</span></span>
3. <span data-ttu-id="5f113-272">hello lagras åtkomstprincip som refereras av hello SAS tas bort, vilket är ett annat sätt toorevoke hello SAS.</span><span class="sxs-lookup"><span data-stu-id="5f113-272">hello stored access policy referenced by hello SAS is deleted, which is another way toorevoke hello SAS.</span></span> <span data-ttu-id="5f113-273">Observera att om du återskapa hello lagras åtkomstprincip med exakt hello samma namn, alla befintliga SAS-token kommer igen giltig bl.a toohello behörigheter associeras med den lagrade åtkomstprincip (förutsatt att hello förfallotiden på hello SAS inte har passerats).</span><span class="sxs-lookup"><span data-stu-id="5f113-273">Note that if you recreate hello stored access policy with exactly hello same name, all existing SAS tokens will again be valid according toohello permissions associated with that stored access policy (assuming that hello expiry time on hello SAS has not passed).</span></span> <span data-ttu-id="5f113-274">Om du har för avsikt toorevoke hello SAS, vara säker på att toouse ett annat namn om du återskapa hello åtkomstprincip med en förfallotiden i hello framtida.</span><span class="sxs-lookup"><span data-stu-id="5f113-274">If you are intending toorevoke hello SAS, be sure toouse a different name if you recreate hello access policy with an expiry time in hello future.</span></span>
4. <span data-ttu-id="5f113-275">Hej kontonyckel som har använt toocreate hello SAS genereras.</span><span class="sxs-lookup"><span data-stu-id="5f113-275">hello account key that was used toocreate hello SAS is regenerated.</span></span> <span data-ttu-id="5f113-276">Återskapande av någon kontonyckel gör att alla programkomponenter med hjälp av den viktiga toofail tooauthenticate förrän de har uppdaterats toouse antingen hello andra giltig kontonyckel eller hello nyligen återskapats kontonyckel.</span><span class="sxs-lookup"><span data-stu-id="5f113-276">Regenerating an account key will cause all application components using that key toofail tooauthenticate until they're updated toouse either hello other valid account key or hello newly regenerated account key.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="5f113-277">En signatur för delad åtkomst URI är associerad med hello konto nyckel används toocreate hello signatur och hello associerad lagrade åtkomstprincip (eventuella).</span><span class="sxs-lookup"><span data-stu-id="5f113-277">A shared access signature URI is associated with hello account key used toocreate hello signature, and hello associated stored access policy (if any).</span></span> <span data-ttu-id="5f113-278">Om inga lagrade åtkomstprincip anges är hello endast sätt toorevoke en signatur för delad åtkomst toochange hello kontonyckel.</span><span class="sxs-lookup"><span data-stu-id="5f113-278">If no stored access policy is specified, hello only way toorevoke a shared access signature is toochange hello account key.</span></span>

## <a name="authenticating-from-a-client-application-with-a-sas"></a><span data-ttu-id="5f113-279">Autentisering från ett klientprogram med en SAS</span><span class="sxs-lookup"><span data-stu-id="5f113-279">Authenticating from a client application with a SAS</span></span>
<span data-ttu-id="5f113-280">En klient som innehar en SAS kan använda hello SAS tooauthenticate en begäran mot ett lagringskonto som de inte har hello nycklar.</span><span class="sxs-lookup"><span data-stu-id="5f113-280">A client who is in possession of a SAS can use hello SAS tooauthenticate a request against a storage account for which they do not possess hello account keys.</span></span> <span data-ttu-id="5f113-281">En SAS kan ingå i en anslutningssträng eller användas direkt från hello lämplig konstruktor eller metod.</span><span class="sxs-lookup"><span data-stu-id="5f113-281">A SAS can be included in a connection string, or used directly from hello appropriate constructor or method.</span></span>

### <a name="using-a-sas-in-a-connection-string"></a><span data-ttu-id="5f113-282">Med hjälp av en SAS i en anslutningssträng</span><span class="sxs-lookup"><span data-stu-id="5f113-282">Using a SAS in a connection string</span></span>
[!INCLUDE [storage-use-sas-in-connection-string-include](../../../includes/storage-use-sas-in-connection-string-include.md)]

### <a name="using-a-sas-in-a-constructor-or-method"></a><span data-ttu-id="5f113-283">Med hjälp av en SAS i en konstruktor eller metod</span><span class="sxs-lookup"><span data-stu-id="5f113-283">Using a SAS in a constructor or method</span></span>
<span data-ttu-id="5f113-284">Flera Azure Storage client biblioteket konstruktorer och metoden överlagringar erbjuder en SAS-parameter, så att du kan autentisera en begäran toohello tjänst med en SAS.</span><span class="sxs-lookup"><span data-stu-id="5f113-284">Several Azure Storage client library constructors and method overloads offer a SAS parameter, so that you can authenticate a request toohello service with a SAS.</span></span>

<span data-ttu-id="5f113-285">Till exempel är här SAS-URI används toocreate en referens tooa block-blob.</span><span class="sxs-lookup"><span data-stu-id="5f113-285">For example, here a SAS URI is used toocreate a reference tooa block blob.</span></span> <span data-ttu-id="5f113-286">hello SAS innehåller hello endast autentiseringsuppgifter som krävs för hello-begäran.</span><span class="sxs-lookup"><span data-stu-id="5f113-286">hello SAS provides hello only credentials needed for hello request.</span></span> <span data-ttu-id="5f113-287">Hej blockblobben används sedan för en skrivåtgärd:</span><span class="sxs-lookup"><span data-stu-id="5f113-287">hello block blob reference is then used for a write operation:</span></span>

```csharp
string sasUri = "https://storagesample.blob.core.windows.net/sample-container/" +
    "sampleBlob.txt?sv=2015-07-08&sr=b&sig=39Up9JzHkxhUIhFEjEH9594DJxe7w6cIRCg0V6lCGSo%3D" +
    "&se=2016-10-18T21%3A51%3A37Z&sp=rcw";

CloudBlockBlob blob = new CloudBlockBlob(new Uri(sasUri));

// Create operation: Upload a blob with hello specified name toohello container.
// If hello blob does not exist, it will be created. If it does exist, it will be overwritten.
try
{
    MemoryStream msWrite = new MemoryStream(Encoding.UTF8.GetBytes(blobContent));
    msWrite.Position = 0;
    using (msWrite)
    {
        await blob.UploadFromStreamAsync(msWrite);
    }

    Console.WriteLine("Create operation succeeded for SAS {0}", sasUri);
    Console.WriteLine();
}
catch (StorageException e)
{
    if (e.RequestInformation.HttpStatusCode == 403)
    {
        Console.WriteLine("Create operation failed for SAS {0}", sasUri);
        Console.WriteLine("Additional error information: " + e.Message);
        Console.WriteLine();
    }
    else
    {
        Console.WriteLine(e.Message);
        Console.ReadLine();
        throw;
    }
}

```

## <a name="best-practices-when-using-sas"></a><span data-ttu-id="5f113-288">Bästa metoder när du med hjälp av SAS</span><span class="sxs-lookup"><span data-stu-id="5f113-288">Best practices when using SAS</span></span>
<span data-ttu-id="5f113-289">När du använder signaturer för delad åtkomst i dina program, måste du toobe medveten om två potentiella risker:</span><span class="sxs-lookup"><span data-stu-id="5f113-289">When you use shared access signatures in your applications, you need toobe aware of two potential risks:</span></span>

* <span data-ttu-id="5f113-290">Om en SAS har läckts kan den användas av alla som erhåller, vilket potentiellt kan påverka ditt lagringskonto.</span><span class="sxs-lookup"><span data-stu-id="5f113-290">If a SAS is leaked, it can be used by anyone who obtains it, which can potentially compromise your storage account.</span></span>
* <span data-ttu-id="5f113-291">Om en SAS tooa klientprogrammet upphör att gälla och hello programmet är tooretrieve en ny SAS från din tjänst kan hello programfunktionen hindras.</span><span class="sxs-lookup"><span data-stu-id="5f113-291">If a SAS provided tooa client application expires and hello application is unable tooretrieve a new SAS from your service, then hello application's functionality may be hindered.</span></span>

<span data-ttu-id="5f113-292">hello kan följande rekommendationer för att använda signaturer för delad åtkomst minska riskerna:</span><span class="sxs-lookup"><span data-stu-id="5f113-292">hello following recommendations for using shared access signatures can help mitigate these risks:</span></span>

1. <span data-ttu-id="5f113-293">**Använder alltid HTTPS** toocreate eller distribuera en SAS.</span><span class="sxs-lookup"><span data-stu-id="5f113-293">**Always use HTTPS** toocreate or distribute a SAS.</span></span> <span data-ttu-id="5f113-294">Om en SAS skickas via HTTP och snappas upp, en obehörig som utför en man-in-the-middle-attack kan tooread hello SAS och sedan använda den precis som hello avsedd användare kan ha kompromettera potentiellt känsliga data eller tillåta för skadade data av hello skadliga användare.</span><span class="sxs-lookup"><span data-stu-id="5f113-294">If a SAS is passed over HTTP and intercepted, an attacker performing a man-in-the-middle attack is able tooread hello SAS and then use it just as hello intended user could have, potentially compromising sensitive data or allowing for data corruption by hello malicious user.</span></span>
2. <span data-ttu-id="5f113-295">**Referens lagrad åtkomstprinciper där det är möjligt.**</span><span class="sxs-lookup"><span data-stu-id="5f113-295">**Reference stored access policies where possible.**</span></span> <span data-ttu-id="5f113-296">Lagrade åtkomst principer ger du hello alternativet toorevoke behörigheter utan tooregenerate hello lagringskontonycklar.</span><span class="sxs-lookup"><span data-stu-id="5f113-296">Stored access policies give you hello option toorevoke permissions without having tooregenerate hello storage account keys.</span></span> <span data-ttu-id="5f113-297">Ställa in ett utgångsdatum för hello på dessa mycket långt i hello framtida (eller oändlig) och kontrollera att den regelbundet har uppdaterats toomove längre till hello framtida.</span><span class="sxs-lookup"><span data-stu-id="5f113-297">Set hello expiration on these very far in hello future (or infinite) and make sure it's regularly updated toomove it farther into hello future.</span></span>
3. <span data-ttu-id="5f113-298">**Använd kortsiktig giltighetstid gånger på en ad hoc-SAS.**</span><span class="sxs-lookup"><span data-stu-id="5f113-298">**Use near-term expiration times on an ad hoc SAS.**</span></span> <span data-ttu-id="5f113-299">På så sätt kan även om en SAS äventyras, är det bara giltig för en kort tid.</span><span class="sxs-lookup"><span data-stu-id="5f113-299">In this way, even if a SAS is compromised, it's valid only for a short time.</span></span> <span data-ttu-id="5f113-300">Den här övningen är särskilt viktigt om du inte kan referera till en princip för lagrade åtkomst.</span><span class="sxs-lookup"><span data-stu-id="5f113-300">This practice is especially important if you cannot reference a stored access policy.</span></span> <span data-ttu-id="5f113-301">Kortsiktig giltighetstid gånger också begränsa hello mängden data som kan skrivas tooa blob genom att begränsa hello tid tillgänglig tooupload tooit.</span><span class="sxs-lookup"><span data-stu-id="5f113-301">Near-term expiration times also limit hello amount of data that can be written tooa blob by limiting hello time available tooupload tooit.</span></span>
4. <span data-ttu-id="5f113-302">**Ha klienter automatiskt förnya hello SAS om det behövs.**</span><span class="sxs-lookup"><span data-stu-id="5f113-302">**Have clients automatically renew hello SAS if necessary.**</span></span> <span data-ttu-id="5f113-303">Klienter måste förnya hello SAS innan hello förfallodatum, i ordning tooallow tid för återförsök om hello-tjänst som tillhandahåller hello SAS är inte tillgänglig.</span><span class="sxs-lookup"><span data-stu-id="5f113-303">Clients should renew hello SAS well before hello expiration, in order tooallow time for retries if hello service providing hello SAS is unavailable.</span></span> <span data-ttu-id="5f113-304">Om din SAS är avsedd för ett litet antal omedelbara toobe, tillfällig åtgärder som är förväntat toobe slutföras inom hello förfalloperiod och detta kan vara onödiga hello SAS inte är korrekt toobe förnyas.</span><span class="sxs-lookup"><span data-stu-id="5f113-304">If your SAS is meant toobe used for a small number of immediate, short-lived operations that are expected toobe completed within hello expiration period, then this may be unnecessary as hello SAS is not expected toobe renewed.</span></span> <span data-ttu-id="5f113-305">Men om du har klienten som regelbundet göra begäranden via SAS kommer sedan hello möjligheten att upphör att gälla in i play.</span><span class="sxs-lookup"><span data-stu-id="5f113-305">However, if you have client that is routinely making requests via SAS, then hello possibility of expiration comes into play.</span></span> <span data-ttu-id="5f113-306">hello nyckelfaktor är toobalance hello behovet för hello SAS toobe tillfällig (som tidigare nämnts anger) med hello måste tooensure som hello klienten begär förnyelse tidigt tillräckligt med (tooavoid avbrott på grund av toohello SAS utgående tidigare toosuccessful förnyelse).</span><span class="sxs-lookup"><span data-stu-id="5f113-306">hello key consideration is toobalance hello need for hello SAS toobe short-lived (as previously stated) with hello need tooensure that hello client is requesting renewal early enough (tooavoid disruption due toohello SAS expiring prior toosuccessful renewal).</span></span>
5. <span data-ttu-id="5f113-307">**Var försiktig med SAS starttiden.**</span><span class="sxs-lookup"><span data-stu-id="5f113-307">**Be careful with SAS start time.**</span></span> <span data-ttu-id="5f113-308">Om du anger hello starttiden för en SAS för**nu**, och klicka sedan på grund av tooclock förskjutning (skillnader i aktuell tid enligt toodifferent datorer) fel kan observeras periodvis för hello första några minuter.</span><span class="sxs-lookup"><span data-stu-id="5f113-308">If you set hello start time for a SAS too**now**, then due tooclock skew (differences in current time according toodifferent machines), failures may be observed intermittently for hello first few minutes.</span></span> <span data-ttu-id="5f113-309">I allmänhet ange hello start tid toobe minst 15 minuter i hello tidigare.</span><span class="sxs-lookup"><span data-stu-id="5f113-309">In general, set hello start time toobe at least 15 minutes in hello past.</span></span> <span data-ttu-id="5f113-310">Eller inte anger den, vilket gör det giltiga omedelbart i samtliga fall.</span><span class="sxs-lookup"><span data-stu-id="5f113-310">Or, don't set it at all, which will make it valid immediately in all cases.</span></span> <span data-ttu-id="5f113-311">hello samma gäller vanligtvis tooexpiry tid samt--Kom ihåg att du kan se in too15 minuter klockan skeva i vardera riktning på varje begäran.</span><span class="sxs-lookup"><span data-stu-id="5f113-311">hello same generally applies tooexpiry time as well--remember that you may observe up too15 minutes of clock skew in either direction on any request.</span></span> <span data-ttu-id="5f113-312">För klienter som använder en REST version tidigare too2012-02-12, är hello maximal varaktighet för en Signatur som inte refererar till en lagrad åtkomstprincip 1 timme och policyer för att ange längre sikt än vad som kommer att misslyckas.</span><span class="sxs-lookup"><span data-stu-id="5f113-312">For clients using a REST version prior too2012-02-12, hello maximum duration for a SAS that does not reference a stored access policy is 1 hour, and any policies specifying longer term than that will fail.</span></span>
6. <span data-ttu-id="5f113-313">**Måste vara specifikt med hello resurs toobe nås.**</span><span class="sxs-lookup"><span data-stu-id="5f113-313">**Be specific with hello resource toobe accessed.**</span></span> <span data-ttu-id="5f113-314">Av säkerhetsskäl är tooprovide en användare med hello lägsta behörighet som krävs.</span><span class="sxs-lookup"><span data-stu-id="5f113-314">A security best practice is tooprovide a user with hello minimum required privileges.</span></span> <span data-ttu-id="5f113-315">Om en användare behöver bara läsbehörighet tooa enhet, ge dem läsbehörighet toothat enda entitet och inte läsa/skriva och ta bort åtkomst tooall entiteter.</span><span class="sxs-lookup"><span data-stu-id="5f113-315">If a user only needs read access tooa single entity, then grant them read access toothat single entity, and not read/write/delete access tooall entities.</span></span> <span data-ttu-id="5f113-316">Det hjälper även minska hello skada om en SAS äventyras eftersom hello SAS har mindre ström i hello händer för att en angripare.</span><span class="sxs-lookup"><span data-stu-id="5f113-316">This also helps lessen hello damage if a SAS is compromised because hello SAS has less power in hello hands of an attacker.</span></span>
7. <span data-ttu-id="5f113-317">**Förstå att ditt konto kommer att debiteras för användning, inklusive göra med SAS.**</span><span class="sxs-lookup"><span data-stu-id="5f113-317">**Understand that your account will be billed for any usage, including that done with SAS.**</span></span> <span data-ttu-id="5f113-318">Om du tillhandahåller skrivbehörighet tooa blob, kan användaren välja tooupload 200GB-blob.</span><span class="sxs-lookup"><span data-stu-id="5f113-318">If you provide write access tooa blob, a user may choose tooupload a 200GB blob.</span></span> <span data-ttu-id="5f113-319">Om du har gett dem samt läsbehörighet, kan de välja toodownload den 10 gånger ta upp 2 TB utgång kostnader för dig.</span><span class="sxs-lookup"><span data-stu-id="5f113-319">If you've given them read access as well, they may choose toodownload it 10 times, incurring 2 TB in egress costs for you.</span></span> <span data-ttu-id="5f113-320">Igen, ange begränsade behörigheter toohelp minimera hello potentiella åtgärder av obehöriga användare.</span><span class="sxs-lookup"><span data-stu-id="5f113-320">Again, provide limited permissions toohelp mitigate hello potential actions of malicious users.</span></span> <span data-ttu-id="5f113-321">Använd tillfällig SAS tooreduce hotet (men Tänk också på klockavvikelser på hello sluttid).</span><span class="sxs-lookup"><span data-stu-id="5f113-321">Use short-lived SAS tooreduce this threat (but be mindful of clock skew on hello end time).</span></span>
8. <span data-ttu-id="5f113-322">**Validera data som skrivs med hjälp av SAS.**</span><span class="sxs-lookup"><span data-stu-id="5f113-322">**Validate data written using SAS.**</span></span> <span data-ttu-id="5f113-323">När ett klientprogram skriver data tooyour storage-konto, Kom ihåg att det kan finnas problem med dessa data.</span><span class="sxs-lookup"><span data-stu-id="5f113-323">When a client application writes data tooyour storage account, keep in mind that there can be problems with that data.</span></span> <span data-ttu-id="5f113-324">Om ditt program kräver att data kan verifieras eller behörighet innan den är klar toouse, utför den här verifieringen när hello data skrivs och innan den används av ditt program.</span><span class="sxs-lookup"><span data-stu-id="5f113-324">If your application requires that that data be validated or authorized before it is ready toouse, you should perform this validation after hello data is written and before it is used by your application.</span></span> <span data-ttu-id="5f113-325">Den här övningen även skyddar mot skadad eller skadliga data skrivs tooyour konto, antingen av en användare som korrekt förvärvade hello SAS eller av en användare som utnyttjar en känd SAS.</span><span class="sxs-lookup"><span data-stu-id="5f113-325">This practice also protects against corrupt or malicious data being written tooyour account, either by a user who properly acquired hello SAS, or by a user exploiting a leaked SAS.</span></span>
9. <span data-ttu-id="5f113-326">**Inte alltid att använda SAS.**</span><span class="sxs-lookup"><span data-stu-id="5f113-326">**Don't always use SAS.**</span></span> <span data-ttu-id="5f113-327">Ibland uppväger hello risker associerade med en viss åtgärd mot ditt lagringskonto hello fördelarna med SAS.</span><span class="sxs-lookup"><span data-stu-id="5f113-327">Sometimes hello risks associated with a particular operation against your storage account outweigh hello benefits of SAS.</span></span> <span data-ttu-id="5f113-328">Skapa en mellannivå-tjänst som skriver tooyour storage-konto när du utför företag för dessa åtgärder regel verifiering, autentisering och granskning.</span><span class="sxs-lookup"><span data-stu-id="5f113-328">For such operations, create a middle-tier service that writes tooyour storage account after performing business rule validation, authentication, and auditing.</span></span> <span data-ttu-id="5f113-329">Ibland kan enklare toomanage åtkomst på annat sätt.</span><span class="sxs-lookup"><span data-stu-id="5f113-329">Also, sometimes it's simpler toomanage access in other ways.</span></span> <span data-ttu-id="5f113-330">Till exempel om du vill toomake alla blobbar i en behållare kan läsas offentligt, kan du hello behållaren allmänheten, i stället för att tillhandahålla en tooevery SAS-klient för åtkomst.</span><span class="sxs-lookup"><span data-stu-id="5f113-330">For example, if you want toomake all blobs in a container publically readable, you can make hello container Public, rather than providing a SAS tooevery client for access.</span></span>
10. <span data-ttu-id="5f113-331">**Använd Storage Analytics toomonitor ditt program.**</span><span class="sxs-lookup"><span data-stu-id="5f113-331">**Use Storage Analytics toomonitor your application.**</span></span> <span data-ttu-id="5f113-332">Du kan använda loggning och mått tooobserve någon ökar i autentiseringsfel på grund av tooan avbrott i din SAS-providern tjänsten eller toohello oavsiktlig borttagning av en lagrade åtkomstprincip.</span><span class="sxs-lookup"><span data-stu-id="5f113-332">You can use logging and metrics tooobserve any spike in authentication failures due tooan outage in your SAS provider service or toohello inadvertent removal of a stored access policy.</span></span> <span data-ttu-id="5f113-333">Se hello [Azure Storage-teamets blogg](http://blogs.msdn.com/b/windowsazurestorage/archive/2011/08/03/windows-azure-storage-logging-using-logs-to-track-storage-requests.aspx) för ytterligare information.</span><span class="sxs-lookup"><span data-stu-id="5f113-333">See hello [Azure Storage Team Blog](http://blogs.msdn.com/b/windowsazurestorage/archive/2011/08/03/windows-azure-storage-logging-using-logs-to-track-storage-requests.aspx) for additional information.</span></span>

## <a name="sas-examples"></a><span data-ttu-id="5f113-334">SAS-exempel</span><span class="sxs-lookup"><span data-stu-id="5f113-334">SAS examples</span></span>
<span data-ttu-id="5f113-335">Nedan följer några exempel på båda typerna av signaturer för delad åtkomst, konto-SAS och tjänst-SAS.</span><span class="sxs-lookup"><span data-stu-id="5f113-335">Below are some examples of both types of shared access signatures, account SAS and service SAS.</span></span>

<span data-ttu-id="5f113-336">toorun exemplen C# måste tooreference hello följande NuGet-paket i projektet:</span><span class="sxs-lookup"><span data-stu-id="5f113-336">toorun these C# examples, you need tooreference hello following NuGet packages in your project:</span></span>

* <span data-ttu-id="5f113-337">[Azure Storage-klientbibliotek för .NET](http://www.nuget.org/packages/WindowsAzure.Storage), version 6.x eller senare (toouse konto SAS).</span><span class="sxs-lookup"><span data-stu-id="5f113-337">[Azure Storage Client Library for .NET](http://www.nuget.org/packages/WindowsAzure.Storage), version 6.x or later (toouse account SAS).</span></span>
* [<span data-ttu-id="5f113-338">Azure Configuration Manager</span><span class="sxs-lookup"><span data-stu-id="5f113-338">Azure Configuration Manager</span></span>](http://www.nuget.org/packages/Microsoft.WindowsAzure.ConfigurationManager)

<span data-ttu-id="5f113-339">Ytterligare exempel som visar hur toocreate och testa en SAS finns [Azure kodexempel för lagring](https://azure.microsoft.com/documentation/samples/?service=storage).</span><span class="sxs-lookup"><span data-stu-id="5f113-339">For additional examples that show how toocreate and test a SAS, see [Azure Code Samples for Storage](https://azure.microsoft.com/documentation/samples/?service=storage).</span></span>

### <a name="example-create-and-use-an-account-sas"></a><span data-ttu-id="5f113-340">Exempel: Skapa och använda en konto-SAS</span><span class="sxs-lookup"><span data-stu-id="5f113-340">Example: Create and use an account SAS</span></span>
<span data-ttu-id="5f113-341">hello följande exempel skapar en konto-SAS som gäller för hello Blob- och Filtjänster och ger hello klienten behörigheterna Läs-, Skriv- och listbehörigheter tooaccess servicenivå API: er.</span><span class="sxs-lookup"><span data-stu-id="5f113-341">hello following code example creates an account SAS that is valid for hello Blob and File services, and gives hello client permissions read, write, and list permissions tooaccess service-level APIs.</span></span> <span data-ttu-id="5f113-342">hello konto-SAS begränsar hello protokollet tooHTTPS så hello begäran måste göras med HTTPS.</span><span class="sxs-lookup"><span data-stu-id="5f113-342">hello account SAS restricts hello protocol tooHTTPS, so hello request must be made with HTTPS.</span></span>

```csharp
static string GetAccountSASToken()
{
    // toocreate hello account SAS, you need toouse your shared key credentials. Modify for your account.
    const string ConnectionString = "DefaultEndpointsProtocol=https;AccountName=account-name;AccountKey=account-key";
    CloudStorageAccount storageAccount = CloudStorageAccount.Parse(ConnectionString);

    // Create a new access policy for hello account.
    SharedAccessAccountPolicy policy = new SharedAccessAccountPolicy()
        {
            Permissions = SharedAccessAccountPermissions.Read | SharedAccessAccountPermissions.Write | SharedAccessAccountPermissions.List,
            Services = SharedAccessAccountServices.Blob | SharedAccessAccountServices.File,
            ResourceTypes = SharedAccessAccountResourceTypes.Service,
            SharedAccessExpiryTime = DateTime.UtcNow.AddHours(24),
            Protocols = SharedAccessProtocol.HttpsOnly
        };

    // Return hello SAS token.
    return storageAccount.GetSharedAccessSignature(policy);
}
```

<span data-ttu-id="5f113-343">toouse hello konto SAS tooaccess servicenivå API: er för hello Blob-tjänsten, skapa ett objekt för Blob med hello SAS och hello slutpunkt för Blob-lagring för ditt lagringskonto.</span><span class="sxs-lookup"><span data-stu-id="5f113-343">toouse hello account SAS tooaccess service-level APIs for hello Blob service, construct a Blob client object using hello SAS and hello Blob storage endpoint for your storage account.</span></span>

```csharp
static void UseAccountSAS(string sasToken)
{
    // Create new storage credentials using hello SAS token.
    StorageCredentials accountSAS = new StorageCredentials(sasToken);
    // Use these credentials and hello account name toocreate a Blob service client.
    CloudStorageAccount accountWithSAS = new CloudStorageAccount(accountSAS, "account-name", endpointSuffix: null, useHttps: true);
    CloudBlobClient blobClientWithSAS = accountWithSAS.CreateCloudBlobClient();

    // Now set hello service properties for hello Blob client created with hello SAS.
    blobClientWithSAS.SetServiceProperties(new ServiceProperties()
    {
        HourMetrics = new MetricsProperties()
        {
            MetricsLevel = MetricsLevel.ServiceAndApi,
            RetentionDays = 7,
            Version = "1.0"
        },
        MinuteMetrics = new MetricsProperties()
        {
            MetricsLevel = MetricsLevel.ServiceAndApi,
            RetentionDays = 7,
            Version = "1.0"
        },
        Logging = new LoggingProperties()
        {
            LoggingOperations = LoggingOperations.All,
            RetentionDays = 14,
            Version = "1.0"
        }
    });

    // hello permissions granted by hello account SAS also permit you tooretrieve service properties.
    ServiceProperties serviceProperties = blobClientWithSAS.GetServiceProperties();
    Console.WriteLine(serviceProperties.HourMetrics.MetricsLevel);
    Console.WriteLine(serviceProperties.HourMetrics.RetentionDays);
    Console.WriteLine(serviceProperties.HourMetrics.Version);
}
```

### <a name="example-create-a-stored-access-policy"></a><span data-ttu-id="5f113-344">Exempel: Skapa en princip för lagrade åtkomst</span><span class="sxs-lookup"><span data-stu-id="5f113-344">Example: Create a stored access policy</span></span>
<span data-ttu-id="5f113-345">hello skapar följande kod en åtkomstprincip som är lagrade på en behållare.</span><span class="sxs-lookup"><span data-stu-id="5f113-345">hello following code creates a stored access policy on a container.</span></span> <span data-ttu-id="5f113-346">Du kan använda hello åtkomst toospecify principbegränsningar för en tjänst-SAS hello behållare eller dess blobbar.</span><span class="sxs-lookup"><span data-stu-id="5f113-346">You can use hello access policy toospecify constraints for a service SAS on hello container or its blobs.</span></span>

```csharp
private static async Task CreateSharedAccessPolicyAsync(CloudBlobContainer container, string policyName)
{
    // Create a new shared access policy and define its constraints.
    // hello access policy provides create, write, read, list, and delete permissions.
    SharedAccessBlobPolicy sharedPolicy = new SharedAccessBlobPolicy()
    {
        // When hello start time for hello SAS is omitted, hello start time is assumed toobe hello time when hello storage service receives hello request.
        // Omitting hello start time for a SAS that is effective immediately helps tooavoid clock skew.
        SharedAccessExpiryTime = DateTime.UtcNow.AddHours(24),
        Permissions = SharedAccessBlobPermissions.Read | SharedAccessBlobPermissions.List |
            SharedAccessBlobPermissions.Write | SharedAccessBlobPermissions.Create | SharedAccessBlobPermissions.Delete
    };

    // Get hello container's existing permissions.
    BlobContainerPermissions permissions = await container.GetPermissionsAsync();

    // Add hello new policy toohello container's permissions, and set hello container's permissions.
    permissions.SharedAccessPolicies.Add(policyName, sharedPolicy);
    await container.SetPermissionsAsync(permissions);
}
```

### <a name="example-create-a-service-sas-on-a-container"></a><span data-ttu-id="5f113-347">Exempel: Skapa en tjänst-SAS på en behållare</span><span class="sxs-lookup"><span data-stu-id="5f113-347">Example: Create a service SAS on a container</span></span>
<span data-ttu-id="5f113-348">hello följande kod skapar en SAS för en behållare.</span><span class="sxs-lookup"><span data-stu-id="5f113-348">hello following code creates a SAS on a container.</span></span> <span data-ttu-id="5f113-349">Om hello namnet på en befintlig lagrade åtkomstprincip får är principen associerad med hello SAS.</span><span class="sxs-lookup"><span data-stu-id="5f113-349">If hello name of an existing stored access policy is provided, that policy is associated with hello SAS.</span></span> <span data-ttu-id="5f113-350">Om inga lagrade åtkomstprincip skapar hello koden en ad hoc-SAS hello behållaren.</span><span class="sxs-lookup"><span data-stu-id="5f113-350">If no stored access policy is provided, then hello code creates an ad-hoc SAS on hello container.</span></span>

```csharp
private static string GetContainerSasUri(CloudBlobContainer container, string storedPolicyName = null)
{
    string sasContainerToken;

    // If no stored policy is specified, create a new access policy and define its constraints.
    if (storedPolicyName == null)
    {
        // Note that hello SharedAccessBlobPolicy class is used both toodefine hello parameters of an ad-hoc SAS, and
        // tooconstruct a shared access policy that is saved toohello container's shared access policies.
        SharedAccessBlobPolicy adHocPolicy = new SharedAccessBlobPolicy()
        {
            // When hello start time for hello SAS is omitted, hello start time is assumed toobe hello time when hello storage service receives hello request.
            // Omitting hello start time for a SAS that is effective immediately helps tooavoid clock skew.
            SharedAccessExpiryTime = DateTime.UtcNow.AddHours(24),
            Permissions = SharedAccessBlobPermissions.Write | SharedAccessBlobPermissions.List
        };

        // Generate hello shared access signature on hello container, setting hello constraints directly on hello signature.
        sasContainerToken = container.GetSharedAccessSignature(adHocPolicy, null);

        Console.WriteLine("SAS for blob container (ad hoc): {0}", sasContainerToken);
        Console.WriteLine();
    }
    else
    {
        // Generate hello shared access signature on hello container. In this case, all of hello constraints for the
        // shared access signature are specified on hello stored access policy, which is provided by name.
        // It is also possible toospecify some constraints on an ad-hoc SAS and others on hello stored access policy.
        sasContainerToken = container.GetSharedAccessSignature(null, storedPolicyName);

        Console.WriteLine("SAS for blob container (stored access policy): {0}", sasContainerToken);
        Console.WriteLine();
    }

    // Return hello URI string for hello container, including hello SAS token.
    return container.Uri + sasContainerToken;
}
```

### <a name="example-create-a-service-sas-on-a-blob"></a><span data-ttu-id="5f113-351">Exempel: Skapa en tjänst-SAS på en blob</span><span class="sxs-lookup"><span data-stu-id="5f113-351">Example: Create a service SAS on a blob</span></span>
<span data-ttu-id="5f113-352">hello följande kod skapar en SAS för en blob.</span><span class="sxs-lookup"><span data-stu-id="5f113-352">hello following code creates a SAS on a blob.</span></span> <span data-ttu-id="5f113-353">Om hello namnet på en befintlig lagrade åtkomstprincip får är principen associerad med hello SAS.</span><span class="sxs-lookup"><span data-stu-id="5f113-353">If hello name of an existing stored access policy is provided, that policy is associated with hello SAS.</span></span> <span data-ttu-id="5f113-354">Om inga lagrade åtkomstprincip skapar hello koden en ad hoc-SAS på hello-blob.</span><span class="sxs-lookup"><span data-stu-id="5f113-354">If no stored access policy is provided, then hello code creates an ad-hoc SAS on hello blob.</span></span>

```csharp
private static string GetBlobSasUri(CloudBlobContainer container, string blobName, string policyName = null)
{
    string sasBlobToken;

    // Get a reference tooa blob within hello container.
    // Note that hello blob may not exist yet, but a SAS can still be created for it.
    CloudBlockBlob blob = container.GetBlockBlobReference(blobName);

    if (policyName == null)
    {
        // Create a new access policy and define its constraints.
        // Note that hello SharedAccessBlobPolicy class is used both toodefine hello parameters of an ad-hoc SAS, and
        // tooconstruct a shared access policy that is saved toohello container's shared access policies.
        SharedAccessBlobPolicy adHocSAS = new SharedAccessBlobPolicy()
        {
            // When hello start time for hello SAS is omitted, hello start time is assumed toobe hello time when hello storage service receives hello request.
            // Omitting hello start time for a SAS that is effective immediately helps tooavoid clock skew.
            SharedAccessExpiryTime = DateTime.UtcNow.AddHours(24),
            Permissions = SharedAccessBlobPermissions.Read | SharedAccessBlobPermissions.Write | SharedAccessBlobPermissions.Create
        };

        // Generate hello shared access signature on hello blob, setting hello constraints directly on hello signature.
        sasBlobToken = blob.GetSharedAccessSignature(adHocSAS);

        Console.WriteLine("SAS for blob (ad hoc): {0}", sasBlobToken);
        Console.WriteLine();
    }
    else
    {
        // Generate hello shared access signature on hello blob. In this case, all of hello constraints for the
        // shared access signature are specified on hello container's stored access policy.
        sasBlobToken = blob.GetSharedAccessSignature(null, policyName);

        Console.WriteLine("SAS for blob (stored access policy): {0}", sasBlobToken);
        Console.WriteLine();
    }

    // Return hello URI string for hello container, including hello SAS token.
    return blob.Uri + sasBlobToken;
}
```

## <a name="conclusion"></a><span data-ttu-id="5f113-355">Slutsats</span><span class="sxs-lookup"><span data-stu-id="5f113-355">Conclusion</span></span>
<span data-ttu-id="5f113-356">Signaturer för delad åtkomst är användbara för att tillhandahålla begränsade behörigheter tooyour storage-konto tooclients som inte ska ha hello kontonyckel.</span><span class="sxs-lookup"><span data-stu-id="5f113-356">Shared access signatures are useful for providing limited permissions tooyour storage account tooclients that should not have hello account key.</span></span> <span data-ttu-id="5f113-357">Därför att de är en viktig del av hello säkerhetsmodell för alla program som använder Azure-lagring.</span><span class="sxs-lookup"><span data-stu-id="5f113-357">As such, they are a vital part of hello security model for any application using Azure Storage.</span></span> <span data-ttu-id="5f113-358">Om du följer hello bästa praxis som anges här använda du SAS tooprovide större flexibilitet av åtkomst tooresources i ditt lagringskonto, utan att kompromissa med hello säkerheten för ditt program.</span><span class="sxs-lookup"><span data-stu-id="5f113-358">If you follow hello best practices listed here, you can use SAS tooprovide greater flexibility of access tooresources in your storage account, without compromising hello security of your application.</span></span>

## <a name="next-steps"></a><span data-ttu-id="5f113-359">Nästa steg</span><span class="sxs-lookup"><span data-stu-id="5f113-359">Next Steps</span></span>
* [<span data-ttu-id="5f113-360">Hantera anonym läsbehörighet toocontainers och blobbar</span><span class="sxs-lookup"><span data-stu-id="5f113-360">Manage anonymous read access toocontainers and blobs</span></span>](../blobs/storage-manage-access-to-resources.md)
* [<span data-ttu-id="5f113-361">Delegera åtkomst med signatur för delad åtkomst</span><span class="sxs-lookup"><span data-stu-id="5f113-361">Delegating Access with a Shared Access Signature</span></span>](http://msdn.microsoft.com/library/azure/ee395415.aspx)
* [<span data-ttu-id="5f113-362">Introduktion till tabellen och kön SAS</span><span class="sxs-lookup"><span data-stu-id="5f113-362">Introducing Table and Queue SAS</span></span>](http://blogs.msdn.com/b/windowsazurestorage/archive/2012/06/12/introducing-table-sas-shared-access-signature-queue-sas-and-update-to-blob-sas.aspx)
