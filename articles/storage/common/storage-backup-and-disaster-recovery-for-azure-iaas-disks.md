---
title: "aaaBackup och disaster recovery för Azure IaaS-diskar | Microsoft Docs"
description: "I den här artikeln förklarar vi hur tooplan för säkerhetskopiering och Disaster Recovery (DR) för IaaS-virtuella maskiner (VMs) och diskarna i Azure. Det här dokumentet beskriver både hanterade och ohanterade diskar"
services: storage
cloud: Azure
documentationcenter: na
author: luywang
manager: kavithag
ms.assetid: 
ms.service: storage
ms.workload: storage
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/19/2017
ms.author: luywang
ms.openlocfilehash: 49b0e7732d6df9407e1e44d9af2500c99a85b37e
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 10/06/2017
---
# <a name="backup-and-disaster-recovery-for-azure-iaas-disks"></a><span data-ttu-id="48590-104">Säkerhetskopiering och katastrofåterställning återställning för Azure IaaS-diskar</span><span class="sxs-lookup"><span data-stu-id="48590-104">Backup and disaster recovery for Azure IaaS disks</span></span>

<span data-ttu-id="48590-105">I den här artikeln förklarar vi hur tooplan för säkerhetskopiering och Disaster Recovery (DR) för IaaS-virtuella maskiner (VMs) och diskarna i Azure.</span><span class="sxs-lookup"><span data-stu-id="48590-105">In this article, we will explain how tooplan for Backup and Disaster Recovery (DR) of IaaS virtual machines (VMs) and Disks in Azure.</span></span> <span data-ttu-id="48590-106">Det här dokumentet beskriver både hanterade och ohanterade diskar.</span><span class="sxs-lookup"><span data-stu-id="48590-106">This document covers both Managed and Unmanaged Disks.</span></span>

<span data-ttu-id="48590-107">Först ska vi tala om hello inbyggda feltolerans i hello Azure-plattformen som bidrar till att skydda dig mot lokala fel.</span><span class="sxs-lookup"><span data-stu-id="48590-107">We’ll first talk about hello built-in fault tolerance capabilities in hello Azure platform which help guard against local failures.</span></span> <span data-ttu-id="48590-108">Sedan kommer vi att diskutera hello katastrofåterställning scenarier som inte omfattas av inbyggda funktioner för hello, vilket är hello hjälpavsnittet beskrivs i det här dokumentet.</span><span class="sxs-lookup"><span data-stu-id="48590-108">We’ll then discuss hello disaster scenarios not fully covered by hello built-in capabilities, which is hello main topic addressed by this document.</span></span> <span data-ttu-id="48590-109">Dessutom lär flera exempel på arbetsbelastningsscenarier där olika överväganden för säkerhetskopiering och Katastrofåterställning kan tillkomma.</span><span class="sxs-lookup"><span data-stu-id="48590-109">We’ll also show several examples of workload scenarios where different Backup and DR considerations may apply.</span></span> <span data-ttu-id="48590-110">Vi ska granska möjliga lösningar för Katastrofåterställning för IaaS-diskar.</span><span class="sxs-lookup"><span data-stu-id="48590-110">We’ll then review possible solutions for DR of IaaS Disks.</span></span> 

## <a name="introduction"></a><span data-ttu-id="48590-111">Introduktion</span><span class="sxs-lookup"><span data-stu-id="48590-111">Introduction</span></span>

<span data-ttu-id="48590-112">hello Azure-plattformen använder olika metoder för redundans och feltolerans tolerans toohelp skydda kunder från lokaliserade maskinvarufel som kan uppstå.</span><span class="sxs-lookup"><span data-stu-id="48590-112">hello Azure platform uses various methods for redundancy and fault tolerance toohelp protect customers from localized hardware failures that can occur.</span></span> <span data-ttu-id="48590-113">Lokala fel kan omfatta problem med en Azure storage server-dator på servern som innehåller en del av hello data för en virtuell disk eller fel i en SSD och HDD.</span><span class="sxs-lookup"><span data-stu-id="48590-113">Local failures may include problems with an Azure storage server machine that stores part of hello data for a virtual disk or failures of an SSD or HDD on that server.</span></span> <span data-ttu-id="48590-114">Sådana isolerade maskinvarufel för komponenten kan inträffa under normal drift och hello plattformen är utformad toobe flexibel toothese fel.</span><span class="sxs-lookup"><span data-stu-id="48590-114">Such isolated hardware component failures can happen during normal operations and hello platform is designed toobe resilient toothese failures.</span></span> <span data-ttu-id="48590-115">Större katastrofer kan resultera i fel eller inaccessibility av stora mängder lagringsservrar eller ett helt datacenter.</span><span class="sxs-lookup"><span data-stu-id="48590-115">Major disasters can result in failures or inaccessibility of a large numbers of storage servers or a whole datacenter.</span></span> <span data-ttu-id="48590-116">Normalt dina virtuella datorer och diskar skyddas från lokaliserade fel ytterligare steg är nödvändiga tooprotect din arbetsbelastning från region hela katastrofalt fel (till exempel en större katastrof) kan påverka den virtuella datorn och diskar.</span><span class="sxs-lookup"><span data-stu-id="48590-116">While your VMs and disks are normally protected from localized failures, additional steps are necessary tooprotect your workload from region-wide catastrophic failures (such as a major disaster) that can affect your VM and disks.</span></span>

<span data-ttu-id="48590-117">Dessutom toohello möjlighet att plattform fel uppstå problem med hello kunden program eller data kan.</span><span class="sxs-lookup"><span data-stu-id="48590-117">In addition toohello possibility of platform failures, problems with hello customer application or data can occur.</span></span> <span data-ttu-id="48590-118">En ny version av programmet kan till exempel oavsiktligen gör en ny ändra toohello data.</span><span class="sxs-lookup"><span data-stu-id="48590-118">For example, a new version of your application may inadvertently make a breaking change toohello data.</span></span> <span data-ttu-id="48590-119">I så fall kanske du vill toorevert hello program och hello data tooa tidigare version som innehåller hello senaste fungerande tillstånd.</span><span class="sxs-lookup"><span data-stu-id="48590-119">In that case, you may want toorevert hello application and hello data tooa prior version containing hello last known good state.</span></span> <span data-ttu-id="48590-120">Detta kräver att underhålla regelbundna säkerhetskopieringar.</span><span class="sxs-lookup"><span data-stu-id="48590-120">This requires maintaining regular backups.</span></span>

<span data-ttu-id="48590-121">För regional katastrofåterställning, måste du säkerhetskopiera din IaaS VM diskar tooa annan region.</span><span class="sxs-lookup"><span data-stu-id="48590-121">For regional disaster recovery, you must backup your IaaS VM disks tooa different region.</span></span> 

<span data-ttu-id="48590-122">Innan vi tittar på alternativ för säkerhetskopiering och Katastrofåterställning Sammanfattningsvis vi några metoder för att hantera lokaliserade fel.</span><span class="sxs-lookup"><span data-stu-id="48590-122">Before we look at Backup and DR options, let’s recap a few methods available for handling localized failures.</span></span>

### <a name="azure-iaas-resiliency"></a><span data-ttu-id="48590-123">Azure IaaS återhämtning</span><span class="sxs-lookup"><span data-stu-id="48590-123">Azure IaaS Resiliency</span></span>

<span data-ttu-id="48590-124">*Återhämtning* refererar toohello tolerans för vanliga fel som uppstår i maskinvarukomponenter.</span><span class="sxs-lookup"><span data-stu-id="48590-124">*Resiliency* refers toohello tolerance for normal failures that occur in hardware components.</span></span> <span data-ttu-id="48590-125">Återhämtning är hello möjlighet toorecover från fel och fortsätta toofunction.</span><span class="sxs-lookup"><span data-stu-id="48590-125">Resiliency is hello ability toorecover from failures and continue toofunction.</span></span> <span data-ttu-id="48590-126">Det är inte om att undvika fel, men svarar toofailures på ett sätt som förhindrar avbrott eller dataförlust.</span><span class="sxs-lookup"><span data-stu-id="48590-126">It's not about avoiding failures, but responding toofailures in a way that avoids downtime or data loss.</span></span> <span data-ttu-id="48590-127">hello målet för återhämtning är tooreturn hello tooa fullt fungerande programtillstånd efter ett fel.</span><span class="sxs-lookup"><span data-stu-id="48590-127">hello goal of resiliency is tooreturn hello application tooa fully functioning state following a failure.</span></span> <span data-ttu-id="48590-128">Azure virtuella datorer och diskar är utformad toobe flexibel toocommon maskinvarufel.</span><span class="sxs-lookup"><span data-stu-id="48590-128">Azure Virtual Machines and Disks are designed toobe resilient toocommon hardware faults.</span></span> <span data-ttu-id="48590-129">Låt oss titta på hur hello Azure IaaS-plattformen ger den här återhämtning.</span><span class="sxs-lookup"><span data-stu-id="48590-129">Let us look at how hello Azure IaaS platform provides this resiliency.</span></span>

<span data-ttu-id="48590-130">En virtuell dator består i huvudsak av två delar: (1) A compute-servern och (2) hello beständiga diskar.</span><span class="sxs-lookup"><span data-stu-id="48590-130">A virtual machine consists mainly of two parts: (1) A compute server, and (2) hello persistent disks.</span></span> <span data-ttu-id="48590-131">Både påverkar hello feltolerans för en virtuell dator.</span><span class="sxs-lookup"><span data-stu-id="48590-131">Both affect hello fault tolerance of a virtual machine.</span></span>

<span data-ttu-id="48590-132">Om hello Azure compute-värdserver som innehåller den virtuella datorn får ett maskinvarufel (som är ovanligt), är utformad tooautomatically återställning hello VM på en annan server i Azure.</span><span class="sxs-lookup"><span data-stu-id="48590-132">If hello Azure compute host server that houses your VM experiences a hardware failure (which is rare), Azure is designed tooautomatically restore hello VM on another server.</span></span> <span data-ttu-id="48590-133">Om det händer, blir det en omstart och hello VM kommer att säkerhetskopiera en stund.</span><span class="sxs-lookup"><span data-stu-id="48590-133">If this happens, you will experience a reboot, and hello VM will be back up after some time.</span></span> <span data-ttu-id="48590-134">Azure automatiskt identifierar sådana maskinvarufel och kör återställningar toohelp kontrollerar hello kunden VM tillgängligt så snart som möjligt.</span><span class="sxs-lookup"><span data-stu-id="48590-134">Azure automatically detects such hardware failures and executes recoveries toohelp ensure hello customer VM will be available as soon as possible.</span></span>

<span data-ttu-id="48590-135">Om IaaS-diskar hållbarhet av data som är viktig för hello beständig lagring plattform.</span><span class="sxs-lookup"><span data-stu-id="48590-135">Regarding IaaS disks, durability of data is critical for hello persistent storage platform.</span></span> <span data-ttu-id="48590-136">Azure-kunder har viktiga business-program körs med IaaS och de är beroende av hello persistence för hello data.</span><span class="sxs-lookup"><span data-stu-id="48590-136">Azure customers have important business applications running on IaaS and they depend on hello persistence of hello data.</span></span> <span data-ttu-id="48590-137">Azure Designer skydd för dessa IaaS-diskar med tre redundanta kopior av data som lagras lokalt, ger hög hållbarhet mot lokala fel.</span><span class="sxs-lookup"><span data-stu-id="48590-137">Azure designs protection for these IaaS disks with three redundant copies of data stored locally, providing high durability against local failures.</span></span> <span data-ttu-id="48590-138">Om en hello maskinvarukomponenter som innehåller disken misslyckas, påverkas inte den virtuella datorn eftersom det finns två ytterligare kopior toosupport disk begäranden.</span><span class="sxs-lookup"><span data-stu-id="48590-138">If one of hello hardware components that holds your disk fails, your VM is not impacted because there are two additional copies toosupport disk requests.</span></span> <span data-ttu-id="48590-139">Den fungerar även om två olika maskinvarukomponenter som stöd för en disk inte vid hello samma tid (som skulle vara mycket sällsynt).</span><span class="sxs-lookup"><span data-stu-id="48590-139">It works fine even if two different hardware components supporting a disk fail at hello same time (which would be very rare).</span></span> <span data-ttu-id="48590-140">toohelp se till att vi alltid har tre repliker, hello Azure Storage-tjänst skapas automatiskt en ny kopia av data i bakgrunden hello om något av tre kopior av hello blir otillgänglig.</span><span class="sxs-lookup"><span data-stu-id="48590-140">toohelp ensure we always maintain three replicas, hello Azure Storage service automatically spawns a new copy of data in hello background if one of hello three copies becomes unavailable.</span></span> <span data-ttu-id="48590-141">Det bör därför inte nödvändigt toouse RAID med Azure-diskar för feltolerans.</span><span class="sxs-lookup"><span data-stu-id="48590-141">Therefore, it should not be necessary toouse RAID with Azure disks for fault tolerance.</span></span> <span data-ttu-id="48590-142">En enkel RAID 0-konfigurationen ska vara tillräcklig för striping hello diskar om nödvändigt toocreate större volymer.</span><span class="sxs-lookup"><span data-stu-id="48590-142">A simple RAID 0 configuration should be sufficient for striping hello disks if necessary toocreate larger volumes.</span></span>

<span data-ttu-id="48590-143">På grund av den här arkitekturen **Azure har konsekvent levereras företagsklass hållbarhet för IaaS-diskar, med ett branschledande noll % [medel Felintervall](https://en.wikipedia.org/wiki/Annualized_failure_rate).**</span><span class="sxs-lookup"><span data-stu-id="48590-143">Because of this architecture, **Azure has consistently delivered enterprise-grade durability for IaaS disks, with an industry-leading ZERO % [Annualized Failure Rate](https://en.wikipedia.org/wiki/Annualized_failure_rate).**</span></span>

<span data-ttu-id="48590-144">Lokaliserade maskinvarufel på hello compute-värd eller i hello lagring plattform ibland kan leda till tillfällig otillgänglighet för hello VM som omfattas av hello [Azure-serviceavtalet](https://azure.microsoft.com/support/legal/sla/virtual-machines/) för VM-tillgänglighet.</span><span class="sxs-lookup"><span data-stu-id="48590-144">Localized hardware faults on hello compute host or in hello storage platform can sometimes result in temporary unavailability for hello VM which is covered by hello [Azure SLA](https://azure.microsoft.com/support/legal/sla/virtual-machines/) for VM Availability.</span></span> <span data-ttu-id="48590-145">Azure tillhandahåller också ett branschledande serviceavtal för enskild VM-instanser som använder Premiumlagring diskar.</span><span class="sxs-lookup"><span data-stu-id="48590-145">Azure also provides an industry-leading SLA for single VM instances that use Premium Storage disks.</span></span>

<span data-ttu-id="48590-146">toosafeguard programbelastningar driftstoppet på grund av toohello temporär otillgänglighet en disk eller en VM, kunder kan utnyttja [Tillgänglighetsuppsättningar](../../virtual-machines/windows/manage-availability.md).</span><span class="sxs-lookup"><span data-stu-id="48590-146">toosafeguard application workloads from downtime due toohello temporary unavailability of a disk or VM, customers can leverage [Availability Sets](../../virtual-machines/windows/manage-availability.md).</span></span> <span data-ttu-id="48590-147">Två eller flera virtuella datorer i en tillgänglighetsuppsättning ger redundans för hello program.</span><span class="sxs-lookup"><span data-stu-id="48590-147">Two or more virtual machines in an availability set provides redundancy for hello application.</span></span> <span data-ttu-id="48590-148">Azure skapar sedan dessa virtuella datorer och diskar i separata feldomäner med olika ström, nätverk och server-komponenter.</span><span class="sxs-lookup"><span data-stu-id="48590-148">Azure then creates these VMs and disks in separate fault domains with different power, network, and server components.</span></span> <span data-ttu-id="48590-149">Därför lokaliserade maskinvarufel vanligtvis inte påverkar flera virtuella datorer i hello på hello samtidigt, vilket ger hög tillgänglighet för ditt program.</span><span class="sxs-lookup"><span data-stu-id="48590-149">Thus, localized hardware failures typically do not affect multiple VMs in hello set at hello same time, providing high availability for your application.</span></span> <span data-ttu-id="48590-150">Anses det en bra idé toouse tillgänglighetsuppsättningar när hög tillgänglighet krävs.</span><span class="sxs-lookup"><span data-stu-id="48590-150">It is considered a good practice toouse availability sets when high availability is required.</span></span> <span data-ttu-id="48590-151">Mer information finns i hello katastrofåterställning aspekter beskrivs nedan.</span><span class="sxs-lookup"><span data-stu-id="48590-151">For more information, see hello Disaster Recovery aspects detailed below.</span></span>

### <a name="backup-and-disaster-recovery"></a><span data-ttu-id="48590-152">Säkerhetskopiering och katastrofåterställning</span><span class="sxs-lookup"><span data-stu-id="48590-152">Backup and Disaster Recovery</span></span>

<span data-ttu-id="48590-153">Katastrofåterställning (DR) är hello möjlighet toorecover från sällsynt men större incidenter: uppstod, storskaligt fel, till exempel avbrott i tjänsten som påverkar en hel region.</span><span class="sxs-lookup"><span data-stu-id="48590-153">Disaster recovery (DR) is hello ability toorecover from rare but major incidents: non-transient, wide-scale failures, such as service disruption that affects an entire region.</span></span> <span data-ttu-id="48590-154">Katastrofåterställning innehåller säkerhetskopiering och arkivering och kan innehålla manuella ingripanden, till exempel återställa en databas från en säkerhetskopia.</span><span class="sxs-lookup"><span data-stu-id="48590-154">Disaster recovery includes data backup and archiving, and may include manual intervention, such as restoring a database from backup.</span></span>

<span data-ttu-id="48590-155">hello kanske Azure plattform inbyggt skydd mot fel på lokaliserade skyddar inte helt hello virtuella datorer/diskar hello gäller större katastrofer vilket kan orsaka stora avbrott.</span><span class="sxs-lookup"><span data-stu-id="48590-155">hello Azure platform’s built-in protection against localized failures may not fully protect hello VMs/disks in hello case of major disasters which can cause large-scale outages.</span></span> <span data-ttu-id="48590-156">Detta inkluderar katastrofer, till exempel ett datacenter som träffas av en orkan jordbävning, fire eller stor skala enhet maskinvarufel.</span><span class="sxs-lookup"><span data-stu-id="48590-156">This includes catastrophic events such as a data center being hit by a hurricane, earthquake, fire, or large scale hardware unit failures.</span></span> <span data-ttu-id="48590-157">Dessutom kan det uppstå fel på grund av problem med tooapplication eller data.</span><span class="sxs-lookup"><span data-stu-id="48590-157">In addition, you may encounter failures due tooapplication or data issues.</span></span>

<span data-ttu-id="48590-158">toohelp skydda IaaS-arbetsbelastningar från avbrott, bör du planera för redundans och säkerhetskopiering tooenable återställning.</span><span class="sxs-lookup"><span data-stu-id="48590-158">toohelp protect your IaaS workloads from outages, you should plan for redundancy and backups tooenable recovery.</span></span> <span data-ttu-id="48590-159">Du bör planera redundans och säkerhetskopiering på en annan geografisk plats från hello primär plats för katastrofåterställning.</span><span class="sxs-lookup"><span data-stu-id="48590-159">For disaster recovery, you should plan redundancy and backup in a different geographic location away from hello primary site.</span></span> <span data-ttu-id="48590-160">Detta säkerställer säkerhetskopian inte påverkas av hello samma händelse som ursprungligen påverkas hello VM eller diskar.</span><span class="sxs-lookup"><span data-stu-id="48590-160">This helps ensure your backup is not affected by hello same event that originally impacted hello VM or disks.</span></span> <span data-ttu-id="48590-161">Mer information finns i [katastrofåterställning för program som bygger på Azure](https://docs.microsoft.com/azure/architecture/resiliency/disaster-recovery-azure-applications).</span><span class="sxs-lookup"><span data-stu-id="48590-161">For more information, see [Disaster Recovery for Applications built on Azure](https://docs.microsoft.com/azure/architecture/resiliency/disaster-recovery-azure-applications).</span></span>

<span data-ttu-id="48590-162">DR-överväganden kan inkludera hello följande aspekter:</span><span class="sxs-lookup"><span data-stu-id="48590-162">Your DR considerations may include hello following aspects:</span></span>

1. <span data-ttu-id="48590-163">Hög tillgänglighet är hello möjligheten för hello programmet toocontinue körs i ett felfritt tillstånd utan betydande driftavbrott.</span><span class="sxs-lookup"><span data-stu-id="48590-163">High Availability (HA) is hello ability of hello application toocontinue running in a healthy state, without significant downtime.</span></span> <span data-ttu-id="48590-164">Med ”felfritt tillstånd”, menar vi hello program är känslig och användare kan ansluta toohello program och interagera med den.</span><span class="sxs-lookup"><span data-stu-id="48590-164">By "healthy state," we mean hello application is responsive, and users can connect toohello application and interact with it.</span></span> <span data-ttu-id="48590-165">Vissa verksamhetskritiska program och databaser kanske krävs toobe tillgängliga alltid, även om det finns fel i hello-plattformen.</span><span class="sxs-lookup"><span data-stu-id="48590-165">Certain mission-critical applications and databases may be required toobe available always, even when there are failures in hello platform.</span></span> <span data-ttu-id="48590-166">Du kanske måste tooplan redundans för programmet hello samt hello data för dessa arbetsbelastningar.</span><span class="sxs-lookup"><span data-stu-id="48590-166">For these workloads, you may need tooplan redundancy for hello application as well as hello data.</span></span>

2. <span data-ttu-id="48590-167">Data hållbarhet: I vissa fall hello huvudsakliga övervägande är att säkerställa att hello data bevaras i hello skiftläget för en katastrofåterställning.</span><span class="sxs-lookup"><span data-stu-id="48590-167">Data Durability: In some cases, hello main consideration is ensuring hello data is preserved in hello case of a disaster.</span></span> <span data-ttu-id="48590-168">Du måste därför kan en säkerhetskopia av dina data i en annan plats.</span><span class="sxs-lookup"><span data-stu-id="48590-168">Therefore, you may need a backup of your data in a different site.</span></span> <span data-ttu-id="48590-169">För dessa arbetsbelastningar, kanske du inte behöver fullständig redundans för hello program, men en regelbunden säkerhetskopiering av hello diskar.</span><span class="sxs-lookup"><span data-stu-id="48590-169">For such workloads, you may not need full redundancy for hello application, but a regular backup of hello disks.</span></span>

## <a name="backup-and-dr-scenarios"></a><span data-ttu-id="48590-170">Säkerhetskopiering och Katastrofåterställning scenarier</span><span class="sxs-lookup"><span data-stu-id="48590-170">Backup and DR Scenarios</span></span>

<span data-ttu-id="48590-171">Nu ska vi titta på några exempel på arbetsbelastning Programscenarier och hello överväganden för planering av Disaster Recovery.</span><span class="sxs-lookup"><span data-stu-id="48590-171">Let’s look at a few typical examples of application workload scenarios and hello considerations for planning Disaster Recovery.</span></span>

### <a name="scenario-1-major-database-solutions"></a><span data-ttu-id="48590-172">Scenario 1: Större databas lösningar</span><span class="sxs-lookup"><span data-stu-id="48590-172">Scenario 1: Major Database Solutions</span></span>

<span data-ttu-id="48590-173">Överväg att en produktionsserver databasen som SQL Server eller Oracle som har stöd för hög tillgänglighet.</span><span class="sxs-lookup"><span data-stu-id="48590-173">Consider a production database server like SQL Server or Oracle that can support High Availability.</span></span> <span data-ttu-id="48590-174">Kritiska produktionsprogram och användare beror på den här databasen.</span><span class="sxs-lookup"><span data-stu-id="48590-174">Critical production applications and users depend on this database.</span></span> <span data-ttu-id="48590-175">hello Disaster Recovery-plan för det här systemet behöver toosupport hello följande krav:</span><span class="sxs-lookup"><span data-stu-id="48590-175">hello Disaster Recovery plan for this system may need toosupport hello following requirements:</span></span>

1. <span data-ttu-id="48590-176">Data måste vara skyddade och återställas.</span><span class="sxs-lookup"><span data-stu-id="48590-176">Data must be protected and recoverable.</span></span>
2.  <span data-ttu-id="48590-177">Servern måste vara tillgängliga för användning.</span><span class="sxs-lookup"><span data-stu-id="48590-177">Server must be available for use.</span></span>

<span data-ttu-id="48590-178">Du kan behöva underhålla en replik av hello databas i en annan region som en säkerhetskopia.</span><span class="sxs-lookup"><span data-stu-id="48590-178">This may require maintaining a replica of hello database in a different region as a backup.</span></span> <span data-ttu-id="48590-179">Beroende på hello krav för servertillgänglighet och återställning av data, kan hello-lösning röra sig om en aktiv-aktiv eller aktivt-passivt replik plats tooperiodic offlinesäkerhetskopiering av hello data.</span><span class="sxs-lookup"><span data-stu-id="48590-179">Depending on hello requirements for server availability and data recovery, hello solution could range from an Active-Active or Active-Passive replica site tooperiodic offline backups of hello data.</span></span> <span data-ttu-id="48590-180">Relationsdatabaser, till exempel SQL Server och Oracle ger olika alternativ för replikering.</span><span class="sxs-lookup"><span data-stu-id="48590-180">Relational databases such as SQL Server and Oracle provide various options for replication.</span></span> <span data-ttu-id="48590-181">För SQL Server [SQL Server alltid på Tillgänglighetsgrupper](https://msdn.microsoft.com/library/hh510230.aspx) kan användas för hög tillgänglighet.</span><span class="sxs-lookup"><span data-stu-id="48590-181">For SQL Server, [SQL Server Always On Availability Groups](https://msdn.microsoft.com/library/hh510230.aspx) can be used for high availability.</span></span>

<span data-ttu-id="48590-182">Det stöder också NoSQL-databaser som MongoDB [repliker](https://docs.mongodb.com/manual/replication/) för redundans.</span><span class="sxs-lookup"><span data-stu-id="48590-182">NoSQL databases like MongoDB also support [replicas](https://docs.mongodb.com/manual/replication/) for redundancy.</span></span> <span data-ttu-id="48590-183">Du kan använda hello repliker för hög tillgänglighet.</span><span class="sxs-lookup"><span data-stu-id="48590-183">hello replicas for high availability can be used.</span></span>

### <a name="scenario-2-a-cluster-of-redundant-vms"></a><span data-ttu-id="48590-184">Scenario 2: Ett kluster med redundanta virtuella datorer</span><span class="sxs-lookup"><span data-stu-id="48590-184">Scenario 2: A cluster of redundant VMs</span></span>

<span data-ttu-id="48590-185">Överväg att en arbetsbelastning hanteras av ett kluster för virtuella datorer som ger redundans och belastningsutjämning.</span><span class="sxs-lookup"><span data-stu-id="48590-185">Consider a workload handled by a cluster of VMs that provide redundancy and load balancing.</span></span> <span data-ttu-id="48590-186">Ett exempel är ett Cassandra kluster som distribueras i en region.</span><span class="sxs-lookup"><span data-stu-id="48590-186">One example would be a Cassandra cluster deployed in a region.</span></span> <span data-ttu-id="48590-187">Den här typen av arkitekturen innehåller redan en hög nivå av redundans i detta område.</span><span class="sxs-lookup"><span data-stu-id="48590-187">This type of architecture already provides a high level of redundancy within that region.</span></span> <span data-ttu-id="48590-188">Dock tooprotect hello arbetsbelastning från ett regionalt nivån fel, bör du sprida hello kluster mellan två regioner eller göra regelbundna säkerhetskopior tooanother region.</span><span class="sxs-lookup"><span data-stu-id="48590-188">However, tooprotect hello workload from a regional level failure, you should consider spreading hello cluster across two regions or making periodic backups tooanother region.</span></span>

### <a name="scenario-3-iaas-application-workload"></a><span data-ttu-id="48590-189">Scenario 3: IaaS programmet arbetsbelastning</span><span class="sxs-lookup"><span data-stu-id="48590-189">Scenario 3: IaaS Application Workload</span></span>

<span data-ttu-id="48590-190">Detta kan vara en produktionsögonblicksbild vid arbetsbelastningar som körs på en virtuell dator i Azure.</span><span class="sxs-lookup"><span data-stu-id="48590-190">This could be a typical production workload running on an Azure VM.</span></span> <span data-ttu-id="48590-191">Det kan till exempel vara en webbserver eller filserver hålla hello innehåll och andra resurser för en plats.</span><span class="sxs-lookup"><span data-stu-id="48590-191">For example, it could be a web server or file server holding hello content and other resources of a site.</span></span> <span data-ttu-id="48590-192">Det kan också vara ett specialbyggt affärsprogram som körs på en virtuell dator som lagras dess data, resurser och programtillstånd på hello Virtuella diskar.</span><span class="sxs-lookup"><span data-stu-id="48590-192">It could also be a custom-built business application running on a VM that stored its data, resources, and application state on hello VM disks.</span></span> <span data-ttu-id="48590-193">I det här fallet är det viktigt att du kan göra säkerhetskopior regelbundet toomake.</span><span class="sxs-lookup"><span data-stu-id="48590-193">In this case, it is important toomake sure you take backups on a regular basis.</span></span> <span data-ttu-id="48590-194">Frekvens för säkerhetskopiering ska baseras på hello uppbyggnad hello VM arbetsbelastning.</span><span class="sxs-lookup"><span data-stu-id="48590-194">Backup frequency should be based on hello nature of hello VM workload.</span></span> <span data-ttu-id="48590-195">Till exempel om programmet hello körs varje dag och ändrar data, bör sedan hello säkerhetskopiering tas varje timme.</span><span class="sxs-lookup"><span data-stu-id="48590-195">For example, if hello application runs every day and modifies data, then hello backup should be taken every hour.</span></span>

<span data-ttu-id="48590-196">Ett annat exempel är en rapportserver som hämtar data från andra källor och genererar aggregerade rapporter.</span><span class="sxs-lookup"><span data-stu-id="48590-196">Another example is a reporting server that pull data from other sources and generates aggregated reports.</span></span> <span data-ttu-id="48590-197">Förlust av den här virtuella datorn eller diskar leder toohello förlust av hello rapporter.</span><span class="sxs-lookup"><span data-stu-id="48590-197">Loss of this VM or disks will lead toohello loss of hello reports.</span></span> <span data-ttu-id="48590-198">Det kan dock vara möjligt toorerun hello reporting processen och generera hello utdata.</span><span class="sxs-lookup"><span data-stu-id="48590-198">However, it may be possible toorerun hello reporting process and regenerate hello output.</span></span> <span data-ttu-id="48590-199">I så fall kan du verkligen inte förlust av data även om hello rapporteringsservern är träffa med katastrofåterställning, så du kan ha en högre nivå av feltolerans för att förlora en del av hello data på hello reporting-servern.</span><span class="sxs-lookup"><span data-stu-id="48590-199">In that case, you don’t really have a loss of data even if hello reporting server is hit with a disaster, so you could have a higher level of tolerance for losing part of hello data on hello reporting server.</span></span> <span data-ttu-id="48590-200">I så fall säkerhetskopiera mindre ofta är en alternativ tooreduce hello kostnad.</span><span class="sxs-lookup"><span data-stu-id="48590-200">In that case, less frequent backups is an option tooreduce hello cost.</span></span>

### <a name="scenario-4-iaas-application-data-issues"></a><span data-ttu-id="48590-201">Scenario 4: IaaS data programproblem</span><span class="sxs-lookup"><span data-stu-id="48590-201">Scenario 4: IaaS Application data issues</span></span>

<span data-ttu-id="48590-202">Du har ett program som beräknar, underhåller och levererar kritiska affärsdata, till exempel information om priser.</span><span class="sxs-lookup"><span data-stu-id="48590-202">You have an application that computes, maintains, and serves critical commercial data such as pricing information.</span></span> <span data-ttu-id="48590-203">En ny version av programmet hade ett programfel för programvara som felaktigt beräknade hello priser och skadad hello befintliga commerce data som hanteras av hello-plattformen.</span><span class="sxs-lookup"><span data-stu-id="48590-203">A new version of your application had a software bug which incorrectly computed hello pricing and corrupted hello existing commerce data served by hello platform.</span></span> <span data-ttu-id="48590-204">Här hello bästa erhåller skulle vara toorevert toohello tidigare version av programmet hello och hello data första.</span><span class="sxs-lookup"><span data-stu-id="48590-204">Here, hello best course of action would be toorevert toohello earlier version of hello application and hello data first.</span></span> <span data-ttu-id="48590-205">tooenable detta, vidta periodiska säkerhetskopieringar av systemet.</span><span class="sxs-lookup"><span data-stu-id="48590-205">tooenable this, take periodic backups of your system.</span></span>

## <a name="disaster-recovery-solution-azure-backup-service"></a><span data-ttu-id="48590-206">Lösning för katastrofåterställning: Azure Backup-tjänsten</span><span class="sxs-lookup"><span data-stu-id="48590-206">Disaster Recovery Solution: Azure Backup Service</span></span>

<span data-ttu-id="48590-207">[Azure Backup-tjänsten](https://azure.microsoft.com/services/backup/) är kan användas för säkerhetskopiering och Katastrofåterställning och den fungerar med [hanterade diskar](../../virtual-machines/windows/managed-disks-overview.md) samt [ohanterade diskar](../../virtual-machines/windows/about-disks-and-vhds.md#unmanaged-disks).</span><span class="sxs-lookup"><span data-stu-id="48590-207">[Azure Backup Service](https://azure.microsoft.com/services/backup/) is can be used for Backup and DR, and it works with [Managed Disks](../../virtual-machines/windows/managed-disks-overview.md) as well as [Unmanaged Disks](../../virtual-machines/windows/about-disks-and-vhds.md#unmanaged-disks).</span></span> <span data-ttu-id="48590-208">Du kan skapa en säkerhetskopiering med tidsbaserade säkerhetskopieringar, enkelt VM-återställning och säkerhetskopiering bevarandeprinciper.</span><span class="sxs-lookup"><span data-stu-id="48590-208">You can create a backup job with time-based backups, easy VM restoration and backup retention policies.</span></span> 

<span data-ttu-id="48590-209">Om du använder [Premium lagringsdiskar](storage-premium-storage.md), [hanterade diskar](../../virtual-machines/windows/managed-disks-overview.md), eller andra disktyper med hello [lokalt redundant lagring (LRS)](storage-redundancy.md#locally-redundant-storage) alternativet, det är särskilt viktigt tooleverage periodiska DR-säkerhetskopieringar.</span><span class="sxs-lookup"><span data-stu-id="48590-209">If you use [Premium Storage disks](storage-premium-storage.md), [Managed Disks](../../virtual-machines/windows/managed-disks-overview.md), or other disk types with hello [locally redundant storage (LRS)](storage-redundancy.md#locally-redundant-storage) option, it is especially important tooleverage periodic DR backups.</span></span> <span data-ttu-id="48590-210">Azure Backup lagras hello data i Recovery Services-valvet för långsiktig kvarhållning.</span><span class="sxs-lookup"><span data-stu-id="48590-210">Azure Backup stores hello data in your Recovery Services vault for long term retention.</span></span> <span data-ttu-id="48590-211">Välj hello [Geo-redundant lagring (GRS)](storage-redundancy.md#geo-redundant-storage) alternativ för hello säkerhetskopiering Recovery Services-valvet.</span><span class="sxs-lookup"><span data-stu-id="48590-211">Choose hello [Geo-redundant storage (GRS)](storage-redundancy.md#geo-redundant-storage) option for hello Backup Recovery Services vault.</span></span> <span data-ttu-id="48590-212">Som säkerställer säkerhetskopior är replikerade tooa olika Azure-region för att skydda från regionala katastrofer.</span><span class="sxs-lookup"><span data-stu-id="48590-212">That will ensure backups are replicated tooa different Azure region for safeguarding from regional disasters.</span></span>

<span data-ttu-id="48590-213">För [ohanterade diskar](../../virtual-machines/windows/about-disks-and-vhds.md#unmanaged-disks), du kan använda hello LRS lagringstyp för IaaS-diskar, men kontrollera att Azure Backup är aktiverad med hello GRS alternativ för hello Recovery Services-valvet.</span><span class="sxs-lookup"><span data-stu-id="48590-213">For [Unmanaged Disks](../../virtual-machines/windows/about-disks-and-vhds.md#unmanaged-disks), you can use hello LRS storage type for IaaS disks, but ensure that Azure Backup is enabled with hello GRS option for hello Recovery Services Vault.</span></span>

<span data-ttu-id="48590-214">**Om du använder hello [GRS](storage-redundancy.md#geo-redundant-storage)/[RA-GRS](storage-redundancy.md#read-access-geo-redundant-storage) alternativet för ohanterade diskar kan du fortfarande behöver programkonsekventa ögonblicksbilder för säkerhetskopiering och Katastrofåterställning.**</span><span class="sxs-lookup"><span data-stu-id="48590-214">**If you use hello [GRS](storage-redundancy.md#geo-redundant-storage)/[RA-GRS](storage-redundancy.md#read-access-geo-redundant-storage) option for your Unmanaged Disks, you still need consistent snapshots for Backup and DR.**</span></span> <span data-ttu-id="48590-215">Du måste använda antingen [Azure Backup-tjänsten](https://azure.microsoft.com/services/backup/) eller [programkonsekventa ögonblicksbilder](#alternative-solution-consistent-snapshots).</span><span class="sxs-lookup"><span data-stu-id="48590-215">You must use either [Azure Backup Service](https://azure.microsoft.com/services/backup/) or [consistent snapshots](#alternative-solution-consistent-snapshots).</span></span>

<span data-ttu-id="48590-216">hello följande är en sammanfattning av lösningar för Katastrofåterställning.</span><span class="sxs-lookup"><span data-stu-id="48590-216">hello following is a summary of solutions for DR.</span></span>

| <span data-ttu-id="48590-217">Scenario</span><span class="sxs-lookup"><span data-stu-id="48590-217">Scenario</span></span> | <span data-ttu-id="48590-218">Automatisk replikering</span><span class="sxs-lookup"><span data-stu-id="48590-218">Automatic Replication</span></span> | <span data-ttu-id="48590-219">Lösning för Katastrofåterställning</span><span class="sxs-lookup"><span data-stu-id="48590-219">DR Solution</span></span> |
| --- | --- | --- |
| <span data-ttu-id="48590-220">*Premium-lagringsdiskar*</span><span class="sxs-lookup"><span data-stu-id="48590-220">*Premium Storage Disks*</span></span> | <span data-ttu-id="48590-221">Lokala ([LRS](storage-redundancy.md#locally-redundant-storage))</span><span class="sxs-lookup"><span data-stu-id="48590-221">Local ([LRS](storage-redundancy.md#locally-redundant-storage))</span></span> | [<span data-ttu-id="48590-222">Azure Backup</span><span class="sxs-lookup"><span data-stu-id="48590-222">Azure Backup</span></span>](https://azure.microsoft.com/services/backup/) |
| <span data-ttu-id="48590-223">*Managed Disks*</span><span class="sxs-lookup"><span data-stu-id="48590-223">*Managed Disks*</span></span> | <span data-ttu-id="48590-224">Lokala ([LRS](storage-redundancy.md#locally-redundant-storage))</span><span class="sxs-lookup"><span data-stu-id="48590-224">Local ([LRS](storage-redundancy.md#locally-redundant-storage))</span></span> | [<span data-ttu-id="48590-225">Azure Backup</span><span class="sxs-lookup"><span data-stu-id="48590-225">Azure Backup</span></span>](https://azure.microsoft.com/services/backup/) |
| <span data-ttu-id="48590-226">*Ohanterad LRS diskar*</span><span class="sxs-lookup"><span data-stu-id="48590-226">*Unmanaged LRS Disks*</span></span> | <span data-ttu-id="48590-227">Lokala ([LRS](storage-redundancy.md#locally-redundant-storage))</span><span class="sxs-lookup"><span data-stu-id="48590-227">Local ([LRS](storage-redundancy.md#locally-redundant-storage))</span></span> | [<span data-ttu-id="48590-228">Azure Backup</span><span class="sxs-lookup"><span data-stu-id="48590-228">Azure Backup</span></span>](https://azure.microsoft.com/services/backup/) |
| <span data-ttu-id="48590-229">*Ohanterad GRS diskar*</span><span class="sxs-lookup"><span data-stu-id="48590-229">*Unmanaged GRS Disks*</span></span> | <span data-ttu-id="48590-230">Mellan region ([GRS](storage-redundancy.md#geo-redundant-storage))</span><span class="sxs-lookup"><span data-stu-id="48590-230">Cross region ([GRS](storage-redundancy.md#geo-redundant-storage))</span></span> | [<span data-ttu-id="48590-231">Azure Backup</span><span class="sxs-lookup"><span data-stu-id="48590-231">Azure Backup</span></span>](https://azure.microsoft.com/services/backup/)<br/>[<span data-ttu-id="48590-232">Programkonsekventa ögonblicksbilder</span><span class="sxs-lookup"><span data-stu-id="48590-232">Consistent snapshots</span></span>](#alternative-solution-consistent-snapshots) |
| <span data-ttu-id="48590-233">*Ohanterad RA-GRS-diskar*</span><span class="sxs-lookup"><span data-stu-id="48590-233">*Unmanaged RA-GRS Disks*</span></span> | <span data-ttu-id="48590-234">Mellan region ([RA-GRS](storage-redundancy.md#read-access-geo-redundant-storage))</span><span class="sxs-lookup"><span data-stu-id="48590-234">Cross region ([RA-GRS](storage-redundancy.md#read-access-geo-redundant-storage))</span></span> | [<span data-ttu-id="48590-235">Azure Backup</span><span class="sxs-lookup"><span data-stu-id="48590-235">Azure Backup</span></span>](https://azure.microsoft.com/services/backup/)<br/>[<span data-ttu-id="48590-236">Programkonsekventa ögonblicksbilder</span><span class="sxs-lookup"><span data-stu-id="48590-236">Consistent snapshots</span></span>](#alternative-solution-consistent-snapshots) |

<span data-ttu-id="48590-237">Hög tillgänglighet kan bäst av uppfylls via hello hanterade diskar i en Tillgänglighetsuppsättning tillsammans med Azure Backup.</span><span class="sxs-lookup"><span data-stu-id="48590-237">High availability can best by met through hello use of Managed Disks in an Availability Set along with Azure Backup.</span></span> <span data-ttu-id="48590-238">Om du använder ohanterade diskar, kan du fortfarande använda Azure Backup för Katastrofåterställning.</span><span class="sxs-lookup"><span data-stu-id="48590-238">If you are using Unmanaged Disks, you can still  use Azure Backup for DR.</span></span> <span data-ttu-id="48590-239">Om du toouse Azure Backup kan sedan ta [programkonsekventa ögonblicksbilder](#alternative-solution-consistent-snapshots) enligt beskrivningen i ett senare avsnitt är en alternativ lösning för säkerhetskopiering och Katastrofåterställning.</span><span class="sxs-lookup"><span data-stu-id="48590-239">If you are unable toouse Azure Backup, then taking [consistent snapshots](#alternative-solution-consistent-snapshots) as described in a later section is an alternative solution for Backup and DR.</span></span>

<span data-ttu-id="48590-240">Dina val för hög tillgänglighet, säkerhetskopiering och Katastrofåterställning på programmet eller infrastrukturen kan representeras som nedan:</span><span class="sxs-lookup"><span data-stu-id="48590-240">Your choices for high availability, backup and DR at Application or Infrastructure levels can be represented as below:</span></span>

| <span data-ttu-id="48590-241">*Nivå*</span><span class="sxs-lookup"><span data-stu-id="48590-241">*Level*</span></span> | <span data-ttu-id="48590-242">Hög tillgänglighet</span><span class="sxs-lookup"><span data-stu-id="48590-242">High Availability</span></span>   | <span data-ttu-id="48590-243">Säkerhetskopiering / DR</span><span class="sxs-lookup"><span data-stu-id="48590-243">Backup / DR</span></span> |
| --- | --- | --- |
| <span data-ttu-id="48590-244">*Programmet*</span><span class="sxs-lookup"><span data-stu-id="48590-244">*Application*</span></span> | <span data-ttu-id="48590-245">SQL Always On</span><span class="sxs-lookup"><span data-stu-id="48590-245">SQL Always On</span></span> | <span data-ttu-id="48590-246">Azure Backup</span><span class="sxs-lookup"><span data-stu-id="48590-246">Azure Backup</span></span> |
| <span data-ttu-id="48590-247">*Infrastruktur*</span><span class="sxs-lookup"><span data-stu-id="48590-247">*Infrastructure*</span></span>  | <span data-ttu-id="48590-248">Tillgänglighetsuppsättning</span><span class="sxs-lookup"><span data-stu-id="48590-248">Availability Set</span></span>  | <span data-ttu-id="48590-249">GRS med programkonsekventa ögonblicksbilder</span><span class="sxs-lookup"><span data-stu-id="48590-249">GRS with consistent snapshots</span></span> |

### <a name="using-hello-azure-backup-service"></a><span data-ttu-id="48590-250">Med hjälp av hello Azure Backup-tjänsten</span><span class="sxs-lookup"><span data-stu-id="48590-250">Using hello Azure Backup Service</span></span>

<span data-ttu-id="48590-251">[Azure-säkerhetskopiering](../../backup/backup-azure-vms-introduction.md) kan säkerhetskopiera dina virtuella datorer som kör Windows eller Linux toohello Azure Recovery Services-valvet.</span><span class="sxs-lookup"><span data-stu-id="48590-251">[Azure Backup](../../backup/backup-azure-vms-introduction.md) can backup your VMs running Windows or Linux toohello Azure Recovery Services Vault.</span></span> <span data-ttu-id="48590-252">Säkerhetskopiera och återställa affärskritiska data är komplicerade av hello faktum att verksamhetskritiska data måste säkerhetskopieras när hello program producerar hello data körs.</span><span class="sxs-lookup"><span data-stu-id="48590-252">Backing up and restoring business-critical data is complicated by hello fact that business-critical data must be backed up while hello applications that produce hello data are running.</span></span> <span data-ttu-id="48590-253">tooaddress, Azure Backup innehåller programkonsekvent säkerhetskopiering för Microsoft-arbetsbelastningar med hello Volume Shadow Service (VSS) tooensure att data skrivs korrekt toostorage.</span><span class="sxs-lookup"><span data-stu-id="48590-253">tooaddress this, Azure Backup provides application-consistent backups for Microsoft workloads by using hello Volume Shadow Service (VSS) tooensure that data is written correctly toostorage.</span></span> <span data-ttu-id="48590-254">Endast filkonsekventa säkerhetskopior är möjligt för Linux virtuella datorer, eftersom Linux saknar motsvarande tooVSS för funktioner.</span><span class="sxs-lookup"><span data-stu-id="48590-254">For Linux VMs, only file-consistent backups are possible, since Linux does not have functionality equivalent tooVSS.</span></span>

![](./media/storage-backup-and-disaster-recovery-for-azure-iaas-disks/backup-and-disaster-recovery-for-azure-iaas-disks-1.png)   

<span data-ttu-id="48590-255">När Azure Backup initierar ett säkerhetskopieringsjobb hello schemalagda tidpunkt, utlöser hello reservanknytning installerats i hello VM tootake en tidpunkt i ögonblicksbild.</span><span class="sxs-lookup"><span data-stu-id="48590-255">When Azure Backup initiates a backup job at hello scheduled time, it triggers hello backup extension installed in hello VM tootake a point-in-time snapshot.</span></span> <span data-ttu-id="48590-256">En ögonblicksbild tas tillsammans med VSS-tooget en programkonsekvent ögonblicksbild diskars hello hello virtuell dator utan att behöva tooshut den ned.</span><span class="sxs-lookup"><span data-stu-id="48590-256">A snapshot is taken in coordination with VSS tooget a consistent snapshot of hello disks in hello virtual machine without having tooshut it down.</span></span> <span data-ttu-id="48590-257">hello säkerhetskopiering tillägget hello VM tömmer alla skrivningar innan du tar hello programkonsekvent ögonblicksbild av alla hello-diskar.</span><span class="sxs-lookup"><span data-stu-id="48590-257">hello backup extension in hello VM flushes all writes before taking hello consistent snapshot of all hello disks.</span></span> <span data-ttu-id="48590-258">När hello ögonblicksbild tas, överförs hello data med Azure Backup toohello säkerhetskopieringsvalvet.</span><span class="sxs-lookup"><span data-stu-id="48590-258">After hello snapshot is taken, hello data is transferred by Azure Backup toohello backup vault.</span></span> <span data-ttu-id="48590-259">toomake hello säkerhetskopieringsprocessen mer effektivt hello-tjänsten identifierar och överför bara hello datablock som har ändrats sedan den senaste säkerhetskopieringen av hello.</span><span class="sxs-lookup"><span data-stu-id="48590-259">toomake hello backup process more efficient, hello service identifies and transfers only hello blocks of data that have changed since hello last backup.</span></span>


<span data-ttu-id="48590-260">toorestore, kan du visa hello tillgängliga säkerhetskopieringar via Azure Backup och starta en återställning.</span><span class="sxs-lookup"><span data-stu-id="48590-260">toorestore, you can view hello available backups through Azure Backup and then initiate a restore.</span></span> <span data-ttu-id="48590-261">Du kan skapa och återställa Azure-säkerhetskopieringar via hello [Azure-portalen](https://portal.azure.com/), [med hjälp av PowerShell](../../backup/backup-azure-vms-automation.md ), eller med hjälp av hello [Azure CLI](https://docs.microsoft.com/azure/xplat-cli-install).</span><span class="sxs-lookup"><span data-stu-id="48590-261">You can create and restore Azure backups through hello [Azure portal](https://portal.azure.com/), [using PowerShell](../../backup/backup-azure-vms-automation.md ), or using hello [Azure CLI](https://docs.microsoft.com/azure/xplat-cli-install).</span></span> <span data-ttu-id="48590-262">Mer information finns i Azure Backup.</span><span class="sxs-lookup"><span data-stu-id="48590-262">For more information, see Azure Backup.</span></span>

### <a name="steps-tooenable-backup"></a><span data-ttu-id="48590-263">Steg tooEnable säkerhetskopiering</span><span class="sxs-lookup"><span data-stu-id="48590-263">Steps tooEnable Backup</span></span>

<span data-ttu-id="48590-264">hello följande steg är brukar användas tooenable säkerhetskopior av dina virtuella datorer med hjälp av hello [Azure Portal](https://portal.azure.com/).</span><span class="sxs-lookup"><span data-stu-id="48590-264">hello following steps are typically used tooenable backups of your VMs using hello [Azure Portal](https://portal.azure.com/).</span></span> <span data-ttu-id="48590-265">Det blir vissa varianter beroende på exakt scenario.</span><span class="sxs-lookup"><span data-stu-id="48590-265">There will be some variations depending on your exact scenario.</span></span> <span data-ttu-id="48590-266">Se toohello [Azure Backup](../../backup/backup-azure-vms-introduction.md) dokumentationen för fullständig information.</span><span class="sxs-lookup"><span data-stu-id="48590-266">Refer toohello [Azure Backup](../../backup/backup-azure-vms-introduction.md) documentation for full details.</span></span> <span data-ttu-id="48590-267">Azure Backup också [stöder virtuella datorer med hanterade diskar](https://azure.microsoft.com/blog/azure-managed-disk-backup/).</span><span class="sxs-lookup"><span data-stu-id="48590-267">Azure Backup also [supports VMs with Managed Disks](https://azure.microsoft.com/blog/azure-managed-disk-backup/).</span></span>

1.  <span data-ttu-id="48590-268">Skapa ett recovery services-valv för en virtuell dator med hjälp av hello följande steg:</span><span class="sxs-lookup"><span data-stu-id="48590-268">Create a recovery services vault for a VM using hello following steps:</span></span>

    <span data-ttu-id="48590-269">a.</span><span class="sxs-lookup"><span data-stu-id="48590-269">a.</span></span>  <span data-ttu-id="48590-270">Med hjälp av hello [Azure-portalen](https://portal.azure.com/), bläddra alla resurser och hittar ”Recovery Services-valv”.</span><span class="sxs-lookup"><span data-stu-id="48590-270">Using hello [Azure portal](https://portal.azure.com/), browse all resources and find “Recovery Services vaults”.</span></span>

    <span data-ttu-id="48590-271">b.</span><span class="sxs-lookup"><span data-stu-id="48590-271">b.</span></span>  <span data-ttu-id="48590-272">På hello Recovery Services-valv menyn, klicka på Lägg till och följ hello steg toocreate ett nytt valv i hello samma region som hello VM.</span><span class="sxs-lookup"><span data-stu-id="48590-272">On hello Recovery Services vaults menu, click Add and follow hello steps toocreate a new vault in hello same region as hello VM.</span></span> <span data-ttu-id="48590-273">Till exempel om den virtuella datorn finns i USA, västra region, Välj västra USA för hello-valvet.</span><span class="sxs-lookup"><span data-stu-id="48590-273">For example, if your VM is in West US region, pick West US for hello vault.</span></span>

2.  <span data-ttu-id="48590-274">Kontrollera hello Storage-replikering för hello nyskapad valvet.</span><span class="sxs-lookup"><span data-stu-id="48590-274">Verify hello Storage replication for hello newly created vault.</span></span> <span data-ttu-id="48590-275">toodo, åtkomst hello valvet från hello återställningstjänster valv bladet och gå toohello inställningar/säkerhetskopia konfiguration.</span><span class="sxs-lookup"><span data-stu-id="48590-275">toodo this, access hello vault from hello Recovery Services vaults blade and go toohello settings/Backup Configuration.</span></span> <span data-ttu-id="48590-276">Kontrollera hello GRS alternativet är markerat som standard.</span><span class="sxs-lookup"><span data-stu-id="48590-276">Ensure hello GRS option is selected by default.</span></span> <span data-ttu-id="48590-277">Se till att ditt valv är automatiskt replikerade tooa sekundärt datacenter.</span><span class="sxs-lookup"><span data-stu-id="48590-277">This will ensure that your vault is automatically replicated tooa secondary data center.</span></span> <span data-ttu-id="48590-278">Till exempel blir ditt valv i USA, västra automatiskt replikerade tooEast USA.</span><span class="sxs-lookup"><span data-stu-id="48590-278">For example, your vault in West US will be automatically replicated tooEast US.</span></span>

3.  <span data-ttu-id="48590-279">Konfigurera hello säkerhetskopieringsprincip och välj hello VM hello samma användargränssnitt.</span><span class="sxs-lookup"><span data-stu-id="48590-279">Configure hello backup policy and select hello VM from hello same UI.</span></span>

4.  <span data-ttu-id="48590-280">Se till att hello Backup-agenten är installerad på hello VM.</span><span class="sxs-lookup"><span data-stu-id="48590-280">Make sure hello Backup Agent is installed on hello VM.</span></span> <span data-ttu-id="48590-281">Om den virtuella datorn skapas med hjälp av en Azure-galleriet bild, installerat hello Backup-agenten redan.</span><span class="sxs-lookup"><span data-stu-id="48590-281">If your VM is created using an Azure gallery image, then hello Backup agent is already installed.</span></span> <span data-ttu-id="48590-282">Annars (om du använder en anpassad avbildning), Använd instruktioner för[installera hello VM-agenten på den virtuella datorn hello](../../backup/backup-azure-arm-vms-prepare.md#install-the-vm-agent-on-the-virtual-machine).</span><span class="sxs-lookup"><span data-stu-id="48590-282">Otherwise (that is, if you are using a custom image), use instructions too[Install hello VM Agent on hello virtual machine](../../backup/backup-azure-arm-vms-prepare.md#install-the-vm-agent-on-the-virtual-machine).</span></span>

5.  <span data-ttu-id="48590-283">Kontrollera att hello VM tillåter nätverksanslutningar för hello säkerhetskopieringstjänsten toofunction.</span><span class="sxs-lookup"><span data-stu-id="48590-283">Make sure that hello VM allows network connectivity for hello backup service toofunction.</span></span> <span data-ttu-id="48590-284">Följ dessa instruktioner för [nätverksanslutningar](../../backup/backup-azure-arm-vms-prepare.md#network-connectivity).</span><span class="sxs-lookup"><span data-stu-id="48590-284">Follow these instructions for [Network connectivity](../../backup/backup-azure-arm-vms-prepare.md#network-connectivity).</span></span>

6.  <span data-ttu-id="48590-285">När hello senare steg har slutförts, körs hello säkerhetskopiering med jämna mellanrum enligt hello säkerhetskopieringsprincip.</span><span class="sxs-lookup"><span data-stu-id="48590-285">Once hello above steps are completed, hello backup will run at regular intervals as specified in hello backup policy.</span></span> <span data-ttu-id="48590-286">Om det behövs kan du utlösa hello första säkerhetskopieringen manuellt från hello valvet instrumentpanelen på hello Azure-portalen.</span><span class="sxs-lookup"><span data-stu-id="48590-286">If necessary, you can trigger hello first backup manually from hello vault dashboard on hello Azure portal.</span></span>

<span data-ttu-id="48590-287">För att automatisera Azure Backup med hjälp av skript, se för[PowerShell-cmdletar för säkerhetskopiering](../../backup/backup-azure-vms-automation.md).</span><span class="sxs-lookup"><span data-stu-id="48590-287">For automating Azure Backup using scripts, please refer too[PowerShell cmdlets for VM backup](../../backup/backup-azure-vms-automation.md).</span></span>

### <a name="steps-for-recovery"></a><span data-ttu-id="48590-288">Steg för återställning</span><span class="sxs-lookup"><span data-stu-id="48590-288">Steps for Recovery</span></span>

<span data-ttu-id="48590-289">Om du behöver toorepair eller återskapa en virtuell dator kan återställa du hello VM från någon av hello Återställningspunkter för säkerhetskopiering i hello-valvet.</span><span class="sxs-lookup"><span data-stu-id="48590-289">If you need toorepair or rebuild a VM, you can restore hello VM from any of hello backup recovery points in hello vault.</span></span> <span data-ttu-id="48590-290">Det finns ett par olika alternativ för hur du utför hello:</span><span class="sxs-lookup"><span data-stu-id="48590-290">There are a couple of different options for performing hello recovery:</span></span>

1.  <span data-ttu-id="48590-291">Du kan skapa en ny virtuell dator som en tidpunkt i representation av den virtuella datorn med säkerhetskopierade.</span><span class="sxs-lookup"><span data-stu-id="48590-291">You can create a new VM as a point-in-time representation of your backed-up VM.</span></span>

2.  <span data-ttu-id="48590-292">Du kan återställa hello diskar och sedan använda hello mall för hello VM toocustomize och återskapa hello återställas VM.</span><span class="sxs-lookup"><span data-stu-id="48590-292">You can restore hello disks and then use hello template for hello VM toocustomize and rebuild hello restored VM.</span></span> 

<span data-ttu-id="48590-293">Se anvisningar för[Använd Azure portal toorestore virtuella datorer](../../backup/backup-azure-arm-restore-vms.md#restoring-a-vm-during-azure-datacenter-disaster).</span><span class="sxs-lookup"><span data-stu-id="48590-293">See instructions too[Use Azure portal toorestore virtual machines](../../backup/backup-azure-arm-restore-vms.md#restoring-a-vm-during-azure-datacenter-disaster).</span></span> <span data-ttu-id="48590-294">hello dokumentet förklarar också hello särskilda åtgärder för att återställa säkerhetskopierade VMs toohello parad datacenter med hjälp av din geo-redundant säkerhetskopieringsvalvet hello gäller en katastrof på hello primära datacenter.</span><span class="sxs-lookup"><span data-stu-id="48590-294">hello document also explains hello specific steps for restoring backed-up VMs toohello paired data center using your geo-redundant backup vault in hello case of a disaster at hello primary data center.</span></span> <span data-ttu-id="48590-295">I så fall använder Azure Backup hello beräkning tjänst från hello sekundär region toocreate hello återställts virtuell dator.</span><span class="sxs-lookup"><span data-stu-id="48590-295">In that case, Azure Backup uses hello Compute service from hello secondary region toocreate hello restored virtual machine.</span></span>

<span data-ttu-id="48590-296">Du kan också använda PowerShell för [återställa en virtuell dator](../../backup/backup-azure-vms-automation.md#restore-an-azure-vm) eller för [skapar en ny virtuell dator från återställts diskar](../../backup/backup-azure-vms-automation.md#create-a-vm-from-restored-disks).</span><span class="sxs-lookup"><span data-stu-id="48590-296">You can also use PowerShell for [restoring a VM](../../backup/backup-azure-vms-automation.md#restore-an-azure-vm) or for [creating a new VM from restored disks](../../backup/backup-azure-vms-automation.md#create-a-vm-from-restored-disks).</span></span>

## <a name="alternative-solution-consistent-snapshots"></a><span data-ttu-id="48590-297">Alternativa lösningen: Programkonsekventa ögonblicksbilder</span><span class="sxs-lookup"><span data-stu-id="48590-297">Alternative Solution: Consistent Snapshots</span></span>

<span data-ttu-id="48590-298">Om du toouse hello Azure Backup Service kan implementera du ditt eget mekanism för säkerhetskopiering med hjälp av ögonblicksbilder.</span><span class="sxs-lookup"><span data-stu-id="48590-298">If you are unable toouse hello Azure Backup Service, you can implement your own backup mechanism using snapshots.</span></span> <span data-ttu-id="48590-299">Det är komplicerat toocreate programkonsekventa ögonblicksbilder för alla diskar som används av en virtuell dator och replikera dessa ögonblicksbilder tooanother region.</span><span class="sxs-lookup"><span data-stu-id="48590-299">It is complicated toocreate consistent snapshots for all disks used by a VM and then replicate those snapshots tooanother region.</span></span> <span data-ttu-id="48590-300">Därför överväger Azure användning hello Backup-tjänsten ett bättre alternativ än att skapa en anpassad lösning.</span><span class="sxs-lookup"><span data-stu-id="48590-300">For this reason, Azure considers leveraging hello Backup Service a better option than building a custom solution.</span></span> <span data-ttu-id="48590-301">Om du använder GRS-RA-GRS-lagring för diskar är ögonblicksbilder automatiskt replikerade tooa sekundärt datacenter.</span><span class="sxs-lookup"><span data-stu-id="48590-301">If you use RA-GRS/GRS storage for disks, snapshots are automatically replicated tooa secondary data center.</span></span> <span data-ttu-id="48590-302">Om du använder LRS lagring för diskar, behöver du tooreplicate hello data själv.</span><span class="sxs-lookup"><span data-stu-id="48590-302">If you use LRS storage for disks, you will need tooreplicate hello data yourself.</span></span> <span data-ttu-id="48590-303">Mer information finns i [säkerhetskopiera Azure ohanterade Virtuella diskar med inkrementell ögonblicksbilder](../../virtual-machines/windows/incremental-snapshots.md).</span><span class="sxs-lookup"><span data-stu-id="48590-303">For more information, see [Back up Azure unmanaged VM disks with incremental snapshots](../../virtual-machines/windows/incremental-snapshots.md).</span></span>

<span data-ttu-id="48590-304">En ögonblicksbild är en representation av ett objekt vid en viss tidpunkt.</span><span class="sxs-lookup"><span data-stu-id="48590-304">A snapshot is a representation of an object at a specific point in time.</span></span> <span data-ttu-id="48590-305">En ögonblicksbild påförs fakturering för hello inkrementell storleken på hello data den innehåller.</span><span class="sxs-lookup"><span data-stu-id="48590-305">A snapshot will incur billing for hello incremental size of hello data it holds.</span></span> <span data-ttu-id="48590-306">Mer information finns i [skapa en ögonblicksbild av blob](../blobs/storage-blob-snapshots.md).</span><span class="sxs-lookup"><span data-stu-id="48590-306">For more information, see [Create a blob snapshot](../blobs/storage-blob-snapshots.md).</span></span>

### <a name="creating-snapshots-while-hello-vm-is-running"></a><span data-ttu-id="48590-307">Skapa ögonblicksbilder när hello körs virtuella datorn</span><span class="sxs-lookup"><span data-stu-id="48590-307">Creating snapshots while hello VM is running</span></span>

<span data-ttu-id="48590-308">Medan du kan ta en ögonblicksbild när som helst om hello virtuella datorn körs, fortfarande är data som strömmas toohello diskar och hello ögonblicksbilder kan innehålla delvis åtgärder som rör sig.</span><span class="sxs-lookup"><span data-stu-id="48590-308">While you can take a snapshot at any time, if hello VM is running, there is still data being streamed toohello disks, and hello snapshots may contain partial operations that were in flight.</span></span> <span data-ttu-id="48590-309">Även om det finns flera diskar, kan hello ögonblicksbilder av olika diskar ha uppstått vid olika tidpunkter, vilket innebär att dessa ögonblicksbilder inte kan samordnas.</span><span class="sxs-lookup"><span data-stu-id="48590-309">Also, if there are several disks involved, hello snapshots of different disks may have occurred at different times, which means these snapshots may not be coordinated.</span></span> <span data-ttu-id="48590-310">Detta är särskilt problematiskt för stripe-volymer vars filer kan skadas om ändringar som gjordes under säkerhetskopieringen.</span><span class="sxs-lookup"><span data-stu-id="48590-310">This is especially problematic for striped volumes whose files can be corrupted if changes were being made during backup.</span></span>

<span data-ttu-id="48590-311">tooavoid i den här situationen hello säkerhetskopieringen måste implementera hello följande steg:</span><span class="sxs-lookup"><span data-stu-id="48590-311">tooavoid this situation, hello backup process must implement hello following steps:</span></span>

1.  <span data-ttu-id="48590-312">Låsa alla hello-diskar</span><span class="sxs-lookup"><span data-stu-id="48590-312">Freeze all hello disks</span></span>

2.  <span data-ttu-id="48590-313">Rensa alla hello väntande skrivningar</span><span class="sxs-lookup"><span data-stu-id="48590-313">Flush all hello pending writes</span></span>

3.  <span data-ttu-id="48590-314">Sedan [skapa en ögonblicksbild av blob](../blobs/storage-blob-snapshots.md) för alla hello diskar</span><span class="sxs-lookup"><span data-stu-id="48590-314">Then, [create a blob snapshot](../blobs/storage-blob-snapshots.md) for all hello disks</span></span>

<span data-ttu-id="48590-315">Vissa Windows-program som SQL Server tillhandahåller en mekanism för samordnade säkerhetskopiering via VSS toocreate programkonsekvent säkerhetskopiering.</span><span class="sxs-lookup"><span data-stu-id="48590-315">Some Windows applications like SQL Server provide a coordinated backup mechanism via VSS toocreate application-consistent backups.</span></span> <span data-ttu-id="48590-316">Du kan använda ett verktyg som fsfreeze för att samordna hello-diskar, som ger filkonsekventa säkerhetskopieringar, men inte programkonsekventa ögonblicksbilder i Linux.</span><span class="sxs-lookup"><span data-stu-id="48590-316">On Linux, you can use a tool like fsfreeze for coordinating hello disks, which will provide file-consistent backups, but not application-consistent snapshots.</span></span> <span data-ttu-id="48590-317">Den här processen är komplicerad, så och du bör använda [Azure Backup](../../backup/backup-azure-vms-introduction.md) eller en lösning för säkerhetskopiering från tredje part som redan implementerar det här.</span><span class="sxs-lookup"><span data-stu-id="48590-317">This process is complicated, so and you should consider using [Azure Backup](../../backup/backup-azure-vms-introduction.md) or a third-party backup solution which already implement this.</span></span>

<span data-ttu-id="48590-318">hello ovan processen resulterar i en samling samordnade ögonblicksbilder för alla hello Virtuella diskar, som representerar en viss tidpunkt i vy över hello VM.</span><span class="sxs-lookup"><span data-stu-id="48590-318">hello above process will result in a collection of coordinated snapshots for all hello VM disks, representing a specific point-in-time view of hello VM.</span></span> <span data-ttu-id="48590-319">Det här är en återställningspunkt för säkerhetskopiering för hello VM.</span><span class="sxs-lookup"><span data-stu-id="48590-319">This is a backup restore point for hello VM.</span></span> <span data-ttu-id="48590-320">Du kan upprepa processen hello vid schemalagda intervall toocreate periodiska säkerhetskopieringar.</span><span class="sxs-lookup"><span data-stu-id="48590-320">You can repeat hello process at scheduled intervals toocreate periodic backups.</span></span> <span data-ttu-id="48590-321">Nedan finns hello steg för[kopiera hello säkerhetskopieringar tooanother region](#copy-the-snapshots-to-another-region) för Katastrofåterställning.</span><span class="sxs-lookup"><span data-stu-id="48590-321">See below for hello steps too[copy hello backups tooanother region](#copy-the-snapshots-to-another-region) for DR.</span></span>

### <a name="creating-snapshots-while-hello-vm-is-offline"></a><span data-ttu-id="48590-322">Att skapa ögonblicksbilder när hello är VM offline</span><span class="sxs-lookup"><span data-stu-id="48590-322">Creating snapshots while hello VM is offline</span></span>

<span data-ttu-id="48590-323">Ett annat alternativ toocreate konsekvent säkerhetskopiering stängs av hello VM och blob ta ögonblicksbilder av varje disk.</span><span class="sxs-lookup"><span data-stu-id="48590-323">Another option toocreate consistent backups is shutting down hello VM and taking blob snapshots of each disk.</span></span> <span data-ttu-id="48590-324">Detta är enklare än koordinerande ögonblicksbilder av en aktiv virtuell dator, men det krävs några minuter stillestånd.</span><span class="sxs-lookup"><span data-stu-id="48590-324">This is easier than coordinating snapshots of a running VM, but it requires a few minutes of downtime.</span></span> <span data-ttu-id="48590-325">Följ dessa steg för den här processen:</span><span class="sxs-lookup"><span data-stu-id="48590-325">For this process, follow these steps:</span></span>

1. <span data-ttu-id="48590-326">Stäng hello VM.</span><span class="sxs-lookup"><span data-stu-id="48590-326">Shut down hello VM.</span></span>

2. <span data-ttu-id="48590-327">Skapa en ögonblicksbild av varje VHD-blobben som tar bara några sekunder.</span><span class="sxs-lookup"><span data-stu-id="48590-327">Create a snapshot of each VHD blob, which only takes a few seconds.</span></span>

    <span data-ttu-id="48590-328">toocreate en ögonblicksbild som du kan använda [PowerShell](storage-powershell-guide-full.md#how-to-manage-azure-blob-snapshots), hello [Azure Storage Rest API](https://msdn.microsoft.com/library/azure/ee691971.aspx), [Azure CLI](https://docs.microsoft.com/azure/xplat-cli-install), eller en av hello Azure Storage, Klientbiblioteken som [ hello Storage-klientbibliotek för .NET](https://msdn.microsoft.com/library/azure/hh488361.aspx).</span><span class="sxs-lookup"><span data-stu-id="48590-328">toocreate a snapshot, you can use [PowerShell](storage-powershell-guide-full.md#how-to-manage-azure-blob-snapshots), hello [Azure Storage Rest API](https://msdn.microsoft.com/library/azure/ee691971.aspx), [Azure CLI](https://docs.microsoft.com/azure/xplat-cli-install), or one of hello Azure Storage Client Libraries such as [hello Storage client library for .NET](https://msdn.microsoft.com/library/azure/hh488361.aspx).</span></span>

3. <span data-ttu-id="48590-329">Starta hello VM, vilket avslutar hello driftstopp.</span><span class="sxs-lookup"><span data-stu-id="48590-329">Start hello VM, which ends hello downtime.</span></span> <span data-ttu-id="48590-330">Vanligtvis hello hela processen har slutförts inom några minuter.</span><span class="sxs-lookup"><span data-stu-id="48590-330">Typically hello entire process completes within a few minutes.</span></span>

<span data-ttu-id="48590-331">Den här processen ger en uppsättning programkonsekventa ögonblicksbilder för alla hello-diskar, vilket ger en återställningspunkt för säkerhetskopiering för hello VM.</span><span class="sxs-lookup"><span data-stu-id="48590-331">This process yields a collection of consistent snapshots for all hello disks, providing a backup restore point for hello VM.</span></span> <span data-ttu-id="48590-332">Nedan visas hello steg toocopy hello ögonblicksbilder tooanother region för Katastrofåterställning.</span><span class="sxs-lookup"><span data-stu-id="48590-332">See below for hello steps toocopy hello snapshots tooanother region for DR.</span></span>

### <a name="copy-hello-snapshots-tooanother-region"></a><span data-ttu-id="48590-333">Kopiera hello ögonblicksbilder tooanother region</span><span class="sxs-lookup"><span data-stu-id="48590-333">Copy hello snapshots tooanother region</span></span>

<span data-ttu-id="48590-334">Genereringen av hello ögonblicksbilder enbart räcker inte för Katastrofåterställning.</span><span class="sxs-lookup"><span data-stu-id="48590-334">Creation of hello snapshots alone may not be sufficient for DR.</span></span> <span data-ttu-id="48590-335">Du måste också replikera hello ögonblicksbild säkerhetskopieringar tooanother region.</span><span class="sxs-lookup"><span data-stu-id="48590-335">You must also replicate hello snapshot backups tooanother region.</span></span>

<span data-ttu-id="48590-336">Om du använder GRS eller RA-GRS för diskarna sedan hello ögonblicksbilder är replikerade toohello sekundär region automatiskt.</span><span class="sxs-lookup"><span data-stu-id="48590-336">If you are using GRS or RA-GRS for your disks, then hello snapshots are replicated toohello secondary region automatically.</span></span> <span data-ttu-id="48590-337">Det kan finnas några minuter på fördröjningen före hello replikering och om hello primära Datacenter kraschar innan hello ögonblicksbilder Slutför replikerar du kommer inte att kunna tooaccess hello ögonblicksbilder från hello sekundärt datacenter.</span><span class="sxs-lookup"><span data-stu-id="48590-337">There can be a few minutes of lag before hello replication, and if hello primary data center goes down before hello snapshots finish replicating, you will not be able tooaccess hello snapshots from hello secondary data center.</span></span> <span data-ttu-id="48590-338">hello sannolikheten för det här är liten.</span><span class="sxs-lookup"><span data-stu-id="48590-338">hello likelihood of this is small.</span></span>

> [!Note] 
> <span data-ttu-id="48590-339">Endast med hello diskar i ett GRS eller RA-GRS-konto skyddar inte hello VM från katastrofer.</span><span class="sxs-lookup"><span data-stu-id="48590-339">Only having hello disks in a GRS or RA-GRS account does not protect hello VM from disasters.</span></span> <span data-ttu-id="48590-340">Du måste också skapa samordnade ögonblicksbilder eller använda Azure Backup.</span><span class="sxs-lookup"><span data-stu-id="48590-340">You must also create coordinated snapshots or use Azure Backup.</span></span> <span data-ttu-id="48590-341">Detta är obligatorisk toorecover ett konsekvent tillstånd för VM-tooa.</span><span class="sxs-lookup"><span data-stu-id="48590-341">This is required toorecover a VM tooa consistent state.</span></span>

<span data-ttu-id="48590-342">Om du använder LRS, måste du kopiera hello ögonblicksbilder tooa olika storage-konto omedelbart efter att skapa hello ögonblicksbilder.</span><span class="sxs-lookup"><span data-stu-id="48590-342">If you are using LRS, you must copy hello snapshots tooa different storage account immediately after creating hello snapshot.</span></span> <span data-ttu-id="48590-343">hello kopiera mål kan vara ett LRS-lagringskonto i en annan region, vilket resulterar i hello kopia som i en fjärransluten region.</span><span class="sxs-lookup"><span data-stu-id="48590-343">hello copy target could be an LRS storage account in a different region, resulting in hello copy being in a remote region.</span></span> <span data-ttu-id="48590-344">Du kan också kopiera hello ögonblicksbild tooan RA-GRS-lagringskonto i hello samma region.</span><span class="sxs-lookup"><span data-stu-id="48590-344">You can also copy hello snapshot tooan RA-GRS storage account in hello same region.</span></span> <span data-ttu-id="48590-345">I det här fallet blir hello ögonblicksbild lazy replikerade toohello remote sekundär region.</span><span class="sxs-lookup"><span data-stu-id="48590-345">In this case, hello snapshot will be lazily replicated toohello remote secondary region.</span></span> <span data-ttu-id="48590-346">Säkerhetskopian är skyddat från katastrofer på hello primär plats när hello kopiera och replikeringen är klar.</span><span class="sxs-lookup"><span data-stu-id="48590-346">Your backup is protected from disasters at hello primary site once hello copying and replication is complete.</span></span>

<span data-ttu-id="48590-347">toocopy din inkrementell ögonblicksbilder för DR effektivt, granska hello instruktionerna i [säkerhetskopiera Azure ohanterade Virtuella diskar med inkrementell ögonblicksbilder](../../virtual-machines/windows/incremental-snapshots.md).</span><span class="sxs-lookup"><span data-stu-id="48590-347">toocopy your incremental snapshots for DR efficiently, review hello instructions in [Back up Azure unmanaged VM disks with incremental snapshots](../../virtual-machines/windows/incremental-snapshots.md).</span></span>

![](./media/storage-backup-and-disaster-recovery-for-azure-iaas-disks/backup-and-disaster-recovery-for-azure-iaas-disks-2.png)   

### <a name="recovery-from-snapshots"></a><span data-ttu-id="48590-348">Återställning från ögonblicksbilder</span><span class="sxs-lookup"><span data-stu-id="48590-348">Recovery from Snapshots</span></span>

<span data-ttu-id="48590-349">tooretrieve en ögonblicksbild, kopiera den toomake en ny blob.</span><span class="sxs-lookup"><span data-stu-id="48590-349">tooretrieve a snapshot, copy it toomake a new blob.</span></span> <span data-ttu-id="48590-350">Om du kopierar hello ögonblicksbild från hello primära konto, kan du kopiera hello ögonblicksbild över toohello grundläggande blob hello ögonblicksbilder, vilket Återför hello disk toohello ögonblicksbild; Detta kallas befordrar hello ögonblicksbild.</span><span class="sxs-lookup"><span data-stu-id="48590-350">If you are copying hello snapshot from hello primary account, you can copy hello snapshot over toohello base blob of hello snapshot, thus reverting hello disk toohello snapshot; this is known as promoting hello snapshot.</span></span> <span data-ttu-id="48590-351">Om du kopierar hello säkerhetskopian från ett sekundärt konto (i hello skiftläget för RA-GRS), måste den vara kopieras tooa primära konto.</span><span class="sxs-lookup"><span data-stu-id="48590-351">If you are copying hello snapshot backup from a secondary account (in hello case of RA-GRS), it must be copied tooa primary account.</span></span> <span data-ttu-id="48590-352">Du kan kopiera en ögonblicksbild [med hjälp av PowerShell](storage-powershell-guide-full.md#how-to-copy-a-snapshot-of-a-blob) eller med hello AzCopy-verktyget.</span><span class="sxs-lookup"><span data-stu-id="48590-352">You can copy a snapshot [using PowerShell](storage-powershell-guide-full.md#how-to-copy-a-snapshot-of-a-blob) or using hello AzCopy utility.</span></span> <span data-ttu-id="48590-353">Mer information finns i [överföra data med kommandoradsverktyget Azcopy hello](storage-use-azcopy.md).</span><span class="sxs-lookup"><span data-stu-id="48590-353">For more information, see [Transfer data with hello AzCopy Command-Line Utility](storage-use-azcopy.md).</span></span>

<span data-ttu-id="48590-354">Hello gäller virtuella datorer med flera diskar, måste du kopiera alla hello ögonblicksbilder som ingår i samma koordineras hello återställningspunkt.</span><span class="sxs-lookup"><span data-stu-id="48590-354">In hello case of VMs with multiple disks, you must copy all hello snapshots that are part of hello same coordinated restore point.</span></span> <span data-ttu-id="48590-355">När du kopierar hello ögonblicksbilder toowritable VHD-blobbar, kan du använda hello blobbar toorecreate den virtuella datorn med hjälp av hello mall för hello VM.</span><span class="sxs-lookup"><span data-stu-id="48590-355">Once you copy hello snapshots toowritable VHD blobs, you can use hello blobs toorecreate your VM using hello template for hello VM.</span></span>

## <a name="other-options"></a><span data-ttu-id="48590-356">Andra alternativ</span><span class="sxs-lookup"><span data-stu-id="48590-356">Other options</span></span>

### <a name="sql-server"></a><span data-ttu-id="48590-357">SQL Server</span><span class="sxs-lookup"><span data-stu-id="48590-357">SQL Server</span></span>

<span data-ttu-id="48590-358">SQL Server som körs på en virtuell dator har sin egen inbyggda funktioner toobackup Blob storage för tooAzure din SQL Server-databas eller en filresurs.</span><span class="sxs-lookup"><span data-stu-id="48590-358">SQL Server running in a VM has its own built-in capabilities toobackup your SQL Server database tooAzure Blob storage or a file share.</span></span> <span data-ttu-id="48590-359">Om hello storage-konto är GRS eller RA-GRS, kan du använda dessa säkerhetskopieringar i hello lagringskontots sekundära datacenter i hello händelsen för katastrofåterställning, med hello samma begränsningar som beskrivits tidigare.</span><span class="sxs-lookup"><span data-stu-id="48590-359">If hello storage account is GRS or RA-GRS, you can access those backups in hello storage account’s secondary data center in hello event of a disaster, with hello same restrictions as discussed previously.</span></span> <span data-ttu-id="48590-360">Mer information finns i [säkerhetskopiering och återställning av SQL Server i Azure Virtual Machines](../../virtual-machines/windows/sql/virtual-machines-windows-sql-backup-recovery.md).</span><span class="sxs-lookup"><span data-stu-id="48590-360">For more information, see [Backup and Restore for SQL Server in Azure Virtual Machines](../../virtual-machines/windows/sql/virtual-machines-windows-sql-backup-recovery.md).</span></span> <span data-ttu-id="48590-361">I tillägg toobackup och återställning, [SQL Server alltid på Tillgänglighetsgrupper](../../virtual-machines/windows/sql/virtual-machines-windows-sql-high-availability-dr.md) kan upprätthålla sekundära repliker för databaser toogreatly minska tiden för hello disaster recovery.</span><span class="sxs-lookup"><span data-stu-id="48590-361">In addition toobackup and restore, [SQL Server Always On Availability Groups](../../virtual-machines/windows/sql/virtual-machines-windows-sql-high-availability-dr.md) can maintain secondary replicas of databases toogreatly reduce hello disaster recovery time.</span></span>

## <a name="other-considerations"></a><span data-ttu-id="48590-362">Andra överväganden</span><span class="sxs-lookup"><span data-stu-id="48590-362">Other considerations</span></span>

<span data-ttu-id="48590-363">Den här artikeln har beskrivs hur toobackup eller ta ögonblicksbilder av dina virtuella datorer och deras diskar toosupport katastrofåterställning, och hur toouse dessa toorecover.</span><span class="sxs-lookup"><span data-stu-id="48590-363">This article has discussed how toobackup or take snapshots of your VMs and their disks toosupport disaster recovery, and how toouse those toorecover.</span></span> <span data-ttu-id="48590-364">Med hello Azure Resource Manager-modellen, flera personer använder mallar toocreate deras virtuella datorer och annan infrastruktur i Azure.</span><span class="sxs-lookup"><span data-stu-id="48590-364">With hello Azure Resource Manager model, many people use templates toocreate their VMs and other infrastructure in Azure.</span></span> <span data-ttu-id="48590-365">Du kan använda en mall toocreate en virtuell dator som har hello samma konfiguration varje gång.</span><span class="sxs-lookup"><span data-stu-id="48590-365">You can use a template toocreate a VM that has hello same configuration every time.</span></span> <span data-ttu-id="48590-366">Om du använder anpassade avbildningar för att skapa din virtuella dator du måste också kontrollera bilderna skyddas med hjälp av en RA-GRS-konto toostore dem.</span><span class="sxs-lookup"><span data-stu-id="48590-366">If you use custom images for creating your VMs, you must also make sure your images are protected by using an RA-GRS account toostore them.</span></span>

<span data-ttu-id="48590-367">Säkerhetskopieringsprocessen kan därför vara en kombination av två saker:</span><span class="sxs-lookup"><span data-stu-id="48590-367">Consequently, your backup process may be a combination of two things:</span></span>

1. <span data-ttu-id="48590-368">Säkerhetskopiering hello data (diskar)</span><span class="sxs-lookup"><span data-stu-id="48590-368">Backup hello data (disks)</span></span>
2. <span data-ttu-id="48590-369">Säkerhetskopiering hello-konfiguration (mallar, anpassade avbildningar)</span><span class="sxs-lookup"><span data-stu-id="48590-369">Backup hello configuration (templates, custom images)</span></span>

<span data-ttu-id="48590-370">Beroende på hello säkerhetskopiering alternativ du väljer du kanske toohandle hello säkerhetskopiering av både hello data och hello konfiguration eller hello säkerhetskopieringstjänsten kan hantera all som du.</span><span class="sxs-lookup"><span data-stu-id="48590-370">Depending on hello backup option you choose, you may have toohandle hello backup of both hello data and hello configuration, or hello backup service may handle all of that for you.</span></span>

## <a name="appendix---understanding-hello-impact-of-lrs-grs-and-ra-grs"></a><span data-ttu-id="48590-371">Tillägg – förstå hur hello effekten av LRS-, GRS- och RA-GRS</span><span class="sxs-lookup"><span data-stu-id="48590-371">Appendix - Understanding hello impact of LRS, GRS, and RA-GRS</span></span>

<span data-ttu-id="48590-372">Det finns tre typer av dataredundans som du bör tänka på avseende katastrofåterställning – lokalt redundant (LRS), geo-redundant (GRS), för storage-konton i Azure, eller geo-redundant med läsa åtkomst (RA-GRS).</span><span class="sxs-lookup"><span data-stu-id="48590-372">For storage accounts in Azure, there are three types of data redundancy that you should consider regarding disaster recovery – locally redundant (LRS), geo-redundant (GRS), or geo-redundant with read access (RA-GRS).</span></span> 

<span data-ttu-id="48590-373">Lokalt Redundant lagring (LRS) behåller tre kopior av hello data i hello samma datacenter.</span><span class="sxs-lookup"><span data-stu-id="48590-373">Locally Redundant Storage (LRS) retains three copies of hello data in hello same data center.</span></span> <span data-ttu-id="48590-374">När du skriver hello data uppdateras alla tre kopior innan lyckas returneras toohello anroparen så att du vet att de är identiska.</span><span class="sxs-lookup"><span data-stu-id="48590-374">When writing hello data, all three copies are updated before success is returned toohello caller, so you know they are identical.</span></span> <span data-ttu-id="48590-375">Disken är skyddat från lokala fel eftersom det är mycket troligt att alla tre kopior skulle påverkas vid hello samtidigt.</span><span class="sxs-lookup"><span data-stu-id="48590-375">Your disk is protected from local failures, since it is extremely unlikely that all three copies would be impacted at hello same time.</span></span> <span data-ttu-id="48590-376">Hello gäller LRS finns det ingen geo-redundans, hello disk inte skyddas från katastrofalt fel som kan påverka en hela data center eller lagring enhet.</span><span class="sxs-lookup"><span data-stu-id="48590-376">In hello case of LRS, there is no geo-redundancy, so hello disk is not protected from catastrophic failures that can impact an entire data center or storage unit.</span></span>

<span data-ttu-id="48590-377">Med GRS och RA-GRS tre kopior av dina data finns kvar i hello primär region (valt) och tre fler kopior av dina data bevaras i en motsvarande sekundär region (anges av Azure).</span><span class="sxs-lookup"><span data-stu-id="48590-377">With GRS and RA-GRS, three copies of your data are retained in hello primary region (selected by you), and three more copies of your data are retained in a corresponding secondary region (set by Azure).</span></span> <span data-ttu-id="48590-378">Om du lagrar data i USA, västra kommer hello data att replikerade tooEast USA.</span><span class="sxs-lookup"><span data-stu-id="48590-378">For example, if you store data in West US, hello data will be replicated tooEast US.</span></span> <span data-ttu-id="48590-379">Detta görs asynkront, och det finns en kort fördröjning mellan uppdateringar toohello primära och sekundära.</span><span class="sxs-lookup"><span data-stu-id="48590-379">This is done asynchronously, and there is a small delay between updates toohello primary and secondary.</span></span> <span data-ttu-id="48590-380">Repliker hello diskar på hello sekundär plats är konsekvent på grundval av per disk (med hello fördröjning) men repliker av flera aktiva diskar är inte synkroniserade **med varandra**.</span><span class="sxs-lookup"><span data-stu-id="48590-380">Replicas of hello disks on hello secondary site are consistent on a per-disk basis (with hello delay), but replicas of multiple active disks may not be in sync **with each other**.</span></span> <span data-ttu-id="48590-381">toohave konsekvent repliker över flera diskar, programkonsekventa ögonblicksbilder behövs.</span><span class="sxs-lookup"><span data-stu-id="48590-381">toohave consistent replicas across multiple disks, consistent snapshots are needed.</span></span>

<span data-ttu-id="48590-382">hello största skillnaden mellan GRS och RA-GRS är med RA-GRS, du kan läsa hello sekundär kopia när som helst.</span><span class="sxs-lookup"><span data-stu-id="48590-382">hello main difference between GRS and RA-GRS is that with RA-GRS, you can read hello secondary copy at any time.</span></span> <span data-ttu-id="48590-383">Om det finns ett problem som återger hello data i hello primära region som är tillgänglig, gör hello Azure-teamet varje arbete toorestore åtkomst.</span><span class="sxs-lookup"><span data-stu-id="48590-383">If there is a problem that renders hello data in hello primary region inaccessible, hello Azure team will make every effort toorestore access.</span></span> <span data-ttu-id="48590-384">Medan primära hello är nere, om du har aktiverat RA-GRS kan du komma åt hello data i hello sekundärt datacenter.</span><span class="sxs-lookup"><span data-stu-id="48590-384">While hello primary is down, if you have RA-GRS enabled, you can access hello data in hello secondary data center.</span></span> <span data-ttu-id="48590-385">Därför, om du planerar tooread från hello repliken när hello primära inte är tillgänglig, sedan RA-GRS bör övervägas.</span><span class="sxs-lookup"><span data-stu-id="48590-385">Therefore, if you plan tooread from hello replica while hello primary is inaccessible, then RA-GRS should be considered.</span></span>

<span data-ttu-id="48590-386">Om det visar sig toobe betydande avbrott, kan hello Azure-teamet utlösa en geo-redundans och ändra hello primära DNS-poster toopoint toosecondary lagring.</span><span class="sxs-lookup"><span data-stu-id="48590-386">If it turns out toobe a significant outage, hello Azure team may trigger a geo-failover and change hello primary DNS entries toopoint toosecondary storage.</span></span> <span data-ttu-id="48590-387">Om du har antingen GRS eller RA-GRS aktiverad måste använder du nu hello data i hello region som används för toobe hello sekundär.</span><span class="sxs-lookup"><span data-stu-id="48590-387">At this point, if you have either GRS or RA-GRS enabled, you can access hello data in hello region that used toobe hello secondary.</span></span> <span data-ttu-id="48590-388">Med andra ord, om ditt lagringskonto är GRS och det finns ett problem, du kan komma åt hello sekundär lagring om det finns en geo-redundans.</span><span class="sxs-lookup"><span data-stu-id="48590-388">In other words, if your storage account is GRS and there is a problem, you can access hello secondary storage only if there is a geo-failover.</span></span>

<span data-ttu-id="48590-389">Mer information finns i [vilka toodo om ett Azure Storage-avbrott inträffar](storage-disaster-recovery-guidance.md).</span><span class="sxs-lookup"><span data-stu-id="48590-389">For more information, see [What toodo if an Azure Storage outage occurs](storage-disaster-recovery-guidance.md).</span></span> 

<span data-ttu-id="48590-390">Observera att Microsoft kontrollerar om det uppstår redundans.</span><span class="sxs-lookup"><span data-stu-id="48590-390">Note that Microsoft controls whether a failover occurs.</span></span> <span data-ttu-id="48590-391">Redundans inte styrs per lagringskonto, därför fattas inte av enskilda kunder.</span><span class="sxs-lookup"><span data-stu-id="48590-391">Failover is not controlled per storage account, therefore it is not decided by individual customers.</span></span> <span data-ttu-id="48590-392">tooimplement katastrofåterställning för specifika storage-konton eller virtuella diskar, måste du använda hello tekniker som beskrivs tidigare i den här artikeln.</span><span class="sxs-lookup"><span data-stu-id="48590-392">tooimplement Disaster Recovery for specific storage accounts or virtual machine disks, you must use hello techniques described previously in this article.</span></span>
