---
title: Arbeta med Node.js-moduler
description: "Lär dig hur du arbetar med Node.js-moduler när du använder Azure App Service eller molntjänster."
services: 
documentationcenter: nodejs
author: TomArcher
manager: routlaw
editor: 
ms.assetid: c0e6cd3d-932d-433e-b72d-e513e23b4eb6
ms.service: multiple
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: nodejs
ms.topic: article
ms.date: 08/17/2016
ms.author: tarcher
ms.openlocfilehash: 1418c19594f19a15402d494880514298826445df
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 08/18/2017
---
# <a name="using-nodejs-modules-with-azure-applications"></a><span data-ttu-id="558a4-103">Använda Node.js-moduler med Azure-program</span><span class="sxs-lookup"><span data-stu-id="558a4-103">Using Node.js Modules with Azure applications</span></span>
<span data-ttu-id="558a4-104">Detta dokument ger vägledning om hur du använder Node.js-moduler med program i Azure.</span><span class="sxs-lookup"><span data-stu-id="558a4-104">This document provides guidance on using Node.js modules with applications hosted on Azure.</span></span> <span data-ttu-id="558a4-105">Det innehåller vägledning om hur du säkerställer att ditt program använder en viss version av en modul eller någon av Azures egna moduler.</span><span class="sxs-lookup"><span data-stu-id="558a4-105">It provides guidance on ensuring that your application uses a specific version of module as well as using native modules with Azure.</span></span>

<span data-ttu-id="558a4-106">Om du redan är bekant med Node.js-moduler **package.json** och **npm shrinkwrap.json** filer, följande information ger en snabb sammanfattning av vad som beskrivs i den här artikeln:</span><span class="sxs-lookup"><span data-stu-id="558a4-106">If you are already familiar with using Node.js modules, **package.json** and **npm-shrinkwrap.json** files, the following information provides a quick summary of what is discussed in this article:</span></span>

* <span data-ttu-id="558a4-107">Azure Apptjänst förstår **package.json** och **npm shrinkwrap.json** filer och kan installera moduler baserat på informationen i de här filerna.</span><span class="sxs-lookup"><span data-stu-id="558a4-107">Azure App Service understands **package.json** and **npm-shrinkwrap.json** files and can install modules based on entries in these files.</span></span>

* <span data-ttu-id="558a4-108">Azure Cloud Services räknar alla moduler som ska installeras på development environment och **nod\_moduler** katalog som ska inkluderas som en del av distributionspaketet.</span><span class="sxs-lookup"><span data-stu-id="558a4-108">Azure Cloud Services expect all modules to be installed on the development environment, and the **node\_modules** directory to be included as part of the deployment package.</span></span> <span data-ttu-id="558a4-109">Det är möjligt att aktivera stöd för installation av moduler med **package.json** eller **npm shrinkwrap.json** filer på Cloud Services, men den här konfigurationen kräver anpassning av standard skript som används av Cloud Service-projekt.</span><span class="sxs-lookup"><span data-stu-id="558a4-109">It is possible to enable support for installing modules using **package.json** or **npm-shrinkwrap.json** files on Cloud Services; however, this configuration requires customization of the default scripts used by Cloud Service projects.</span></span> <span data-ttu-id="558a4-110">Ett exempel på hur du konfigurerar den här miljön finns [Azure startåtgärd för att köra npm-installationen för att undvika att distribuera nod moduler](https://github.com/woloski/nodeonazure-blog/blob/master/articles/startup-task-to-run-npm-in-azure.markdown)</span><span class="sxs-lookup"><span data-stu-id="558a4-110">For an example of how to configure this environment, see [Azure Startup task to run npm install to avoid deploying node modules](https://github.com/woloski/nodeonazure-blog/blob/master/articles/startup-task-to-run-npm-in-azure.markdown)</span></span>

> [!NOTE]
> <span data-ttu-id="558a4-111">Virtuella Azure-datorer beskrivs inte i den här artikeln som distributionsupplevelse på en virtuell dator beror på operativsystemet hos den virtuella datorn.</span><span class="sxs-lookup"><span data-stu-id="558a4-111">Azure Virtual Machines are not discussed in this article, as the deployment experience in a VM is dependent on the operating system hosted by the Virtual Machine.</span></span>
> 
> 

## <a name="nodejs-modules"></a><span data-ttu-id="558a4-112">Node.js-moduler</span><span class="sxs-lookup"><span data-stu-id="558a4-112">Node.js Modules</span></span>
<span data-ttu-id="558a4-113">Moduler är inläsningsbar JavaScript-paket som tillhandahåller funktioner för ditt program.</span><span class="sxs-lookup"><span data-stu-id="558a4-113">Modules are loadable JavaScript packages that provide specific functionality for your application.</span></span> <span data-ttu-id="558a4-114">Moduler installeras vanligtvis under den **npm** kommandoradsverktyget verktyget, men vissa moduler (t.ex http-modul) tillhandahålls som en del av core Node.js-paketet.</span><span class="sxs-lookup"><span data-stu-id="558a4-114">Modules are usually installed using the **npm** command-line tool, however some modules (such as the http module) are provided as part of the core Node.js package.</span></span>

<span data-ttu-id="558a4-115">När moduler installeras de lagras i den **nod\_moduler** katalogen i roten för ditt program katalogstruktur.</span><span class="sxs-lookup"><span data-stu-id="558a4-115">When modules are installed, they are stored in the **node\_modules** directory at the root of your application directory structure.</span></span> <span data-ttu-id="558a4-116">Varje modul i den **nod\_moduler** directory hanterar en egen **nod\_moduler** katalog som innehåller alla moduler som den är beroende av och problemet upprepas för varje modul ända ned beroendekedjan.</span><span class="sxs-lookup"><span data-stu-id="558a4-116">Each module within the **node\_modules** directory maintains its own **node\_modules** directory that contains any modules that it depends on, and this behavior repeats for every module all the way down the dependency chain.</span></span> <span data-ttu-id="558a4-117">Den här miljön kan varje modul installerat för att få sin egen versionskraven för modulerna som den beroende, men det kan resultera i en stor katalogstruktur.</span><span class="sxs-lookup"><span data-stu-id="558a4-117">This environment allows each module installed to have its own version requirements for the modules it depends on, however it can result in quite a large directory structure.</span></span>

<span data-ttu-id="558a4-118">Distribuera den **nod\_moduler** katalogen som en del av ditt program ökar storleken på distributionen jämfört med en **package.json** eller  **npm shrinkwrap.json** filen; men den garanterar att versionerna av moduler som används i produktionen är samma som de moduler som används under utveckling.</span><span class="sxs-lookup"><span data-stu-id="558a4-118">Deploying the **node\_modules** directory as part of your application increases the size of the deployment when compared to using a **package.json** or **npm-shrinkwrap.json** file; however, it does guarantee that the versions of the modules used in production are the same as the modules used in development.</span></span>

### <a name="native-modules"></a><span data-ttu-id="558a4-119">Inbyggda moduler</span><span class="sxs-lookup"><span data-stu-id="558a4-119">Native Modules</span></span>
<span data-ttu-id="558a4-120">De flesta moduler är helt enkelt klartext JavaScript-filer, är vissa moduler plattformsspecifika binära avbildningar.</span><span class="sxs-lookup"><span data-stu-id="558a4-120">While most modules are simply plain-text JavaScript files, some modules are platform-specific binary images.</span></span> <span data-ttu-id="558a4-121">Dessa moduler kompileras under installationen, vanligtvis med hjälp av Python och nod-gyp.</span><span class="sxs-lookup"><span data-stu-id="558a4-121">These modules are compiled at install time, usually by using Python and node-gyp.</span></span> <span data-ttu-id="558a4-122">Eftersom Azure Cloud Services är beroende av den **nod\_moduler** mapp som distribueras som en del av ett program, alla egna modulen ingår som en del av de installera modulerna bör fungera i en molntjänst så länge den har installerats och kompilerade under Windows-utveckling.</span><span class="sxs-lookup"><span data-stu-id="558a4-122">Since Azure Cloud Services rely on the **node\_modules** folder being deployed as part of the application, any native module included as part of the installed modules should work in a cloud service as long as it was installed and compiled on a Windows development system.</span></span>

<span data-ttu-id="558a4-123">Azure Apptjänst har inte stöd för alla interna moduler och kan misslyckas vid kompilering av moduler med specifika krav.</span><span class="sxs-lookup"><span data-stu-id="558a4-123">Azure App Service does not support all native modules, and might fail when compiling modules with specific prerequisites.</span></span> <span data-ttu-id="558a4-124">Även om vissa populära moduler som MongoDB har valfria inbyggda beroenden och fungerar utan dem., visat två lösningar lyckas med nästan alla interna moduler som är tillgängliga i dag:</span><span class="sxs-lookup"><span data-stu-id="558a4-124">While some popular modules like MongoDB have optional native dependencies and work fine without them, two workarounds proved successful with almost all native modules available today:</span></span>

* <span data-ttu-id="558a4-125">Kör **npm installera** på en Windows-dator som har den inbyggda modulens nödvändiga komponenter installeras.</span><span class="sxs-lookup"><span data-stu-id="558a4-125">Run **npm install** on a Windows machine that has all the native module's prerequisites installed.</span></span> <span data-ttu-id="558a4-126">Sedan kan du distribuera den skapade **nod\_moduler** mappen som en del av programmet till Azure App Service.</span><span class="sxs-lookup"><span data-stu-id="558a4-126">Then, deploy the created **node\_modules** folder as part of the application to Azure App Service.</span></span>

  * <span data-ttu-id="558a4-127">Innan du kompilerar, kontrollera att den lokala Node.js-installationen har motsvarande arkitektur och versionen är så nära som möjligt till den som används i Azure (aktuella värden kan kontrolleras på runtime från egenskaperna för **process.arch** och **process.version**).</span><span class="sxs-lookup"><span data-stu-id="558a4-127">Before compiling, check that your local Node.js installation has matching architecture and the version is as close as possible to the one used in Azure (the current values can be checked on runtime from properties **process.arch** and **process.version**).</span></span>

* <span data-ttu-id="558a4-128">Azure Apptjänst kan konfigureras för att köra anpassade bash eller kommandoskript under distributionen, vilket ger dig möjlighet att köra anpassade kommandon och konfigurera exakt hur **installera npm** körs.</span><span class="sxs-lookup"><span data-stu-id="558a4-128">Azure App Service can be configured to execute custom bash or shell scripts during deployment, giving you the opportunity to execute custom commands and precisely configure the way **npm install** is being run.</span></span> <span data-ttu-id="558a4-129">Se en video som visar hur du konfigurerar den miljön [anpassad webbplats distribution skript med Kudu].</span><span class="sxs-lookup"><span data-stu-id="558a4-129">For a video showing how to configure that environment, see [Custom Website Deployment Scripts with Kudu].</span></span>

### <a name="using-a-packagejson-file"></a><span data-ttu-id="558a4-130">Med hjälp av en package.json-fil</span><span class="sxs-lookup"><span data-stu-id="558a4-130">Using a package.json file</span></span>
<span data-ttu-id="558a4-131">Den **package.json** filen är ett sätt att ange översta beroenden som krävs för ditt program så att Värdplattformen kan installera beroenden i stället för att kräva att du inkluderar den **noden\_ paket** mappen som en del av distributionen.</span><span class="sxs-lookup"><span data-stu-id="558a4-131">The **package.json** file is a way to specify the top-level dependencies your application requires so that the hosting platform can install the dependencies, rather than requiring you to include the **node\_packages** folder as part of the deployment.</span></span> <span data-ttu-id="558a4-132">När programmet har distribuerats på **installera npm** kommando som används för att parsa den **package.json** filen och installera alla beroenden i listan.</span><span class="sxs-lookup"><span data-stu-id="558a4-132">After the application has been deployed, the **npm install** command is used to parse the **package.json** file and install all the dependencies listed.</span></span>

<span data-ttu-id="558a4-133">Under utveckling, kan du använda den **--spara**, **--spara dev**, eller **--spara valfria** parametrar när du installerar moduler för att lägga till en post för modulen din **package.json** filen automatiskt.</span><span class="sxs-lookup"><span data-stu-id="558a4-133">During development, you can use the **--save**, **--save-dev**, or **--save-optional** parameters when installing modules to add an entry for the module to your **package.json** file automatically.</span></span> <span data-ttu-id="558a4-134">Mer information finns i [npm-installera](https://docs.npmjs.com/cli/install).</span><span class="sxs-lookup"><span data-stu-id="558a4-134">For more information, see [npm-install](https://docs.npmjs.com/cli/install).</span></span>

<span data-ttu-id="558a4-135">Ett möjligt problem med den **package.json** filen är det endast anger versionen för översta beroenden.</span><span class="sxs-lookup"><span data-stu-id="558a4-135">One potential problem with the **package.json** file is that it only specifies the version for top-level dependencies.</span></span> <span data-ttu-id="558a4-136">Varje modul som installerats kan eller kan inte ange version för moduler som den är beroende av och så är det möjligt att du kan det sluta med en annan beroendekedjan än det som används under utveckling.</span><span class="sxs-lookup"><span data-stu-id="558a4-136">Each module installed may or may not specify the version of the modules it depends on, and so it is possible that you may end up with a different dependency chain than the one used in development.</span></span>

> [!NOTE]
> <span data-ttu-id="558a4-137">När du distribuerar till Azure App Service din <b>package.json</b> filen refererar till en ursprunglig modul som du kan se ett fel som liknar följande exempel när du publicerar program med Git:</span><span class="sxs-lookup"><span data-stu-id="558a4-137">When deploying to Azure App Service, if your <b>package.json</b> file references a native module you might see an error similar to the following example when publishing the application using Git:</span></span>
> 
> <span data-ttu-id="558a4-138">npm fel!</span><span class="sxs-lookup"><span data-stu-id="558a4-138">npm ERR!</span></span> <span data-ttu-id="558a4-139">module-name@0.6.0installera: ”nod gyp konfigurera build'</span><span class="sxs-lookup"><span data-stu-id="558a4-139">module-name@0.6.0 install: 'node-gyp configure build'</span></span>
> 
> <span data-ttu-id="558a4-140">npm fel!</span><span class="sxs-lookup"><span data-stu-id="558a4-140">npm ERR!</span></span> <span data-ttu-id="558a4-141">' cmd ”/ c” ”nod gyp konfigurera build” ' misslyckades med 1</span><span class="sxs-lookup"><span data-stu-id="558a4-141">'cmd "/c" "node-gyp configure build"' failed with 1</span></span>
> 
> 

### <a name="using-a-npm-shrinkwrapjson-file"></a><span data-ttu-id="558a4-142">Med hjälp av en npm-shrinkwrap.json-fil</span><span class="sxs-lookup"><span data-stu-id="558a4-142">Using a npm-shrinkwrap.json file</span></span>
<span data-ttu-id="558a4-143">Den **npm shrinkwrap.json** filen är ett försök att åtgärda modulen versionshantering begränsningar i **package.json** fil.</span><span class="sxs-lookup"><span data-stu-id="558a4-143">The **npm-shrinkwrap.json** file is an attempt to address the module versioning limitations of the **package.json** file.</span></span> <span data-ttu-id="558a4-144">När den **package.json** filen endast innehåller versioner för översta moduler i **npm shrinkwrap.json** filen innehåller versionskraven för hela modulen beroendekedjan.</span><span class="sxs-lookup"><span data-stu-id="558a4-144">While the **package.json** file only includes versions for the top-level modules, the **npm-shrinkwrap.json** file contains the version requirements for the full module dependency chain.</span></span>

<span data-ttu-id="558a4-145">När ditt program är klar för produktion, låsa versionskraven och skapa en **npm shrinkwrap.json** filen med hjälp av den **npm förpackningsplasten** kommando.</span><span class="sxs-lookup"><span data-stu-id="558a4-145">When your application is ready for production, you can lock down version requirements and create an **npm-shrinkwrap.json** file by using the **npm shrinkwrap** command.</span></span> <span data-ttu-id="558a4-146">Det här kommandot ska använda de versioner som är installerade i den **nod\_moduler** mapp, och registrera dessa versioner till den **npm shrinkwrap.json** fil.</span><span class="sxs-lookup"><span data-stu-id="558a4-146">This command will use the versions currently installed in the **node\_modules** folder, and record these versions to the **npm-shrinkwrap.json** file.</span></span> <span data-ttu-id="558a4-147">När programmet har distribuerats till värdmiljön den **installera npm** kommando som används för att parsa den **npm shrinkwrap.json** filen och installera alla beroenden i listan.</span><span class="sxs-lookup"><span data-stu-id="558a4-147">After the application has been deployed to the hosting environment, the **npm install** command is used to parse the **npm-shrinkwrap.json** file and install all the dependencies listed.</span></span> <span data-ttu-id="558a4-148">Mer information finns i [npm förpackningsplasten](https://docs.npmjs.com/cli/shrinkwrap).</span><span class="sxs-lookup"><span data-stu-id="558a4-148">For more information, see [npm-shrinkwrap](https://docs.npmjs.com/cli/shrinkwrap).</span></span>

> [!NOTE]
> <span data-ttu-id="558a4-149">När du distribuerar till Azure App Service din <b>npm shrinkwrap.json</b> filen refererar till en ursprunglig modul som du kan se ett fel som liknar följande exempel när du publicerar program med Git:</span><span class="sxs-lookup"><span data-stu-id="558a4-149">When deploying to Azure App Service, if your <b>npm-shrinkwrap.json</b> file references a native module you might see an error similar to the following example when publishing the application using Git:</span></span>
> 
> <span data-ttu-id="558a4-150">npm fel!</span><span class="sxs-lookup"><span data-stu-id="558a4-150">npm ERR!</span></span> <span data-ttu-id="558a4-151">module-name@0.6.0installera: ”nod gyp konfigurera build'</span><span class="sxs-lookup"><span data-stu-id="558a4-151">module-name@0.6.0 install: 'node-gyp configure build'</span></span>
> 
> <span data-ttu-id="558a4-152">npm fel!</span><span class="sxs-lookup"><span data-stu-id="558a4-152">npm ERR!</span></span> <span data-ttu-id="558a4-153">' cmd ”/ c” ”nod gyp konfigurera build” ' misslyckades med 1</span><span class="sxs-lookup"><span data-stu-id="558a4-153">'cmd "/c" "node-gyp configure build"' failed with 1</span></span>
> 
> 

## <a name="next-steps"></a><span data-ttu-id="558a4-154">Nästa steg</span><span class="sxs-lookup"><span data-stu-id="558a4-154">Next steps</span></span>
<span data-ttu-id="558a4-155">Nu när du vet hur du använder Node.js-moduler med Azure lär du dig hur du [ange Node.js-version], [skapa och distribuera en Node.js-webbapp](app-service-web/app-service-web-get-started-nodejs.md), och [hur du använder Azure kommandoraden Gränssnitt för Mac- och Linux].</span><span class="sxs-lookup"><span data-stu-id="558a4-155">Now that you understand how to use Node.js modules with Azure, learn how to [specify the Node.js version], [build and deploy a Node.js web app](app-service-web/app-service-web-get-started-nodejs.md), and [How to use the Azure Command-Line Interface for Mac and Linux].</span></span>

<span data-ttu-id="558a4-156">Mer information finns i [Node.js Developer Center](/nodejs/azure/).</span><span class="sxs-lookup"><span data-stu-id="558a4-156">For more information, see the [Node.js Developer Center](/nodejs/azure/).</span></span>

<span data-ttu-id="558a4-157">[ange Node.js-version]: nodejs-specify-node-version-azure-apps.md</span><span class="sxs-lookup"><span data-stu-id="558a4-157">[specify the Node.js version]: nodejs-specify-node-version-azure-apps.md</span></span>
<span data-ttu-id="558a4-158">[hur du använder Azure kommandoraden Gränssnitt för Mac- och Linux]:cli-install-nodejs.md</span><span class="sxs-lookup"><span data-stu-id="558a4-158">[How to use the Azure Command-Line Interface for Mac and Linux]:cli-install-nodejs.md</span></span>
<span data-ttu-id="558a4-159">[anpassad webbplats distribution skript med Kudu]: https://channel9.msdn.com/Shows/Azure-Friday/Custom-Web-Site-Deployment-Scripts-with-Kudu-with-David-Ebbo</span><span class="sxs-lookup"><span data-stu-id="558a4-159">[Custom Website Deployment Scripts with Kudu]: https://channel9.msdn.com/Shows/Azure-Friday/Custom-Web-Site-Deployment-Scripts-with-Kudu-with-David-Ebbo</span></span>
