---
title: aaaChild runbooks i Azure Automation | Microsoft Docs
description: "Beskriver hello olika metoder för att starta en runbook i Azure Automation från en annan runbook och dela information med varandra."
services: automation
documentationcenter: 
author: mgoedtel
manager: jwhit
editor: tysonn
ms.assetid: 919887b9-43e2-4c16-883c-f81807fe37db
ms.service: automation
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 02/02/2017
ms.author: magoedte;bwren
ms.openlocfilehash: d3d06818d344b565d53cc4f4705b41dcfcf9a376
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 10/06/2017
---
# <a name="child-runbooks-in-azure-automation"></a><span data-ttu-id="fdda7-103">Underordnade runbooks i Azure Automation</span><span class="sxs-lookup"><span data-stu-id="fdda7-103">Child runbooks in Azure Automation</span></span>
<span data-ttu-id="fdda7-104">Det är ett metodtips i Azure Automation toowrite återanvändningsbara, modulbaserade runbooks med en diskret funktion som kan användas av andra runbooks.</span><span class="sxs-lookup"><span data-stu-id="fdda7-104">It is a best practice in Azure Automation toowrite reusable, modular runbooks with a discrete function that can be used by other runbooks.</span></span> <span data-ttu-id="fdda7-105">En överordnad runbook anropar ofta en eller flera underordnade runbooks tooperform som krävs för funktioner.</span><span class="sxs-lookup"><span data-stu-id="fdda7-105">A parent runbook will often call one or more child runbooks tooperform required functionality.</span></span> <span data-ttu-id="fdda7-106">Det finns två sätt toocall en underordnad runbook och var och en har tydliga skillnader som du bör känna till så att du kan bestämma vilket som är bäst för dina olika scenarier.</span><span class="sxs-lookup"><span data-stu-id="fdda7-106">There are two ways toocall a child runbook, and each has distinct differences that you should understand so that you can determine which will be best for your different scenarios.</span></span>

## <a name="invoking-a-child-runbook-using-inline-execution"></a><span data-ttu-id="fdda7-107">Anropa en underordnad runbook med infogad körning</span><span class="sxs-lookup"><span data-stu-id="fdda7-107">Invoking a child runbook using inline execution</span></span>
<span data-ttu-id="fdda7-108">tooinvoke en infogad runbook från en annan runbook du använder hello namnet på hello runbook och ange värden för parametrarna exakt samma sätt som du använder en aktivitet eller cmdlet.</span><span class="sxs-lookup"><span data-stu-id="fdda7-108">tooinvoke a runbook inline from another runbook, you use hello name of hello runbook and provide values for its parameters exactly like you would use an activity or cmdlet.</span></span>  <span data-ttu-id="fdda7-109">Alla runbooks i hello samma Automation-konto är tillgängliga tooall andra toobe används i det här sättet.</span><span class="sxs-lookup"><span data-stu-id="fdda7-109">All runbooks in hello same Automation account are available tooall others toobe used in this manner.</span></span> <span data-ttu-id="fdda7-110">hello överordnad runbook väntar hello underordnade runbook toocomplete innan du flyttar toohello nästa rad och eventuella utdata returneras direkt toohello överordnade.</span><span class="sxs-lookup"><span data-stu-id="fdda7-110">hello parent runbook will wait for hello child runbook toocomplete before moving toohello next line, and any output is returned directly toohello parent.</span></span>

<span data-ttu-id="fdda7-111">När du aktiverar en infogad runbook körs den i hello samma jobb som hello överordnad runbook.</span><span class="sxs-lookup"><span data-stu-id="fdda7-111">When you invoke a runbook inline, it runs in hello same job as hello parent runbook.</span></span> <span data-ttu-id="fdda7-112">Det kommer inte att visa hello jobbhistorik för hello underordnad runbook som kördes.</span><span class="sxs-lookup"><span data-stu-id="fdda7-112">There will be no indication in hello job history of hello child runbook that it ran.</span></span> <span data-ttu-id="fdda7-113">Eventuella undantag och strömmad utdata från hello underordnade runbooken kommer att associeras med hello överordnade.</span><span class="sxs-lookup"><span data-stu-id="fdda7-113">Any exceptions and any stream output from hello child runbook will be associated with hello parent.</span></span> <span data-ttu-id="fdda7-114">Detta innebär färre jobb och gör dem lättare tootrack och tootroubleshoot eftersom alla undantag från hello underordnad runbook och alla strömmad utdata är associerade med hello överordnade jobb.</span><span class="sxs-lookup"><span data-stu-id="fdda7-114">This results in fewer jobs and makes them easier tootrack and tootroubleshoot since any exceptions thrown by hello child runbook and any of its stream output are associated with hello parent job.</span></span>

<span data-ttu-id="fdda7-115">När en runbook publiceras måste alla underordnade runbooks som anropas redan publiceras.</span><span class="sxs-lookup"><span data-stu-id="fdda7-115">When a runbook is published, any child runbooks that it calls must already be published.</span></span> <span data-ttu-id="fdda7-116">Det beror på att Azure Automation bygger en association med någon av underordnade runbooks när en runbook kompileras.</span><span class="sxs-lookup"><span data-stu-id="fdda7-116">This is because Azure Automation builds an association with any child runbooks when a runbook is compiled.</span></span> <span data-ttu-id="fdda7-117">Om de inte är hello överordnad runbook visas toopublish korrekt, men genererar ett undantag när den startas.</span><span class="sxs-lookup"><span data-stu-id="fdda7-117">If they aren’t, hello parent runbook will appear toopublish properly, but will generate an exception when it’s started.</span></span> <span data-ttu-id="fdda7-118">Om det händer kan publicera du hello överordnad runbook i ordning tooproperly referens hello underordnade runbooks.</span><span class="sxs-lookup"><span data-stu-id="fdda7-118">If this happens, you can republish hello parent runbook in order tooproperly reference hello child runbooks.</span></span> <span data-ttu-id="fdda7-119">Du behöver inte toorepublish hello överordnade runbooken om någon av hello underordnade runbooks ändras eftersom hello association kommer redan har skapats.</span><span class="sxs-lookup"><span data-stu-id="fdda7-119">You do not need toorepublish hello parent runbook if any of hello child runbooks are changed because hello association will have already been created.</span></span>

<span data-ttu-id="fdda7-120">hello parametrar för en underordnad runbook som anropas internt kan vara en datatyp som inkluderar komplexa objekt och det finns inga [JSON-serialisering](automation-starting-a-runbook.md#runbook-parameters) eftersom det inte finns när du startar hello runbook med hello Azure-hanteringsportalen eller med hello Start-AzureRmAutomationRunbook cmdlet.</span><span class="sxs-lookup"><span data-stu-id="fdda7-120">hello parameters of a child runbook called inline can be any data type including complex objects, and there is no [JSON serialization](automation-starting-a-runbook.md#runbook-parameters) as there is when you start hello runbook using hello Azure Management Portal or with hello Start-AzureRmAutomationRunbook cmdlet.</span></span>

### <a name="runbook-types"></a><span data-ttu-id="fdda7-121">Runbook-typer</span><span class="sxs-lookup"><span data-stu-id="fdda7-121">Runbook types</span></span>
<span data-ttu-id="fdda7-122">Vilka typer kan anropa varandra:</span><span class="sxs-lookup"><span data-stu-id="fdda7-122">Which types can call each other:</span></span>

* <span data-ttu-id="fdda7-123">En [PowerShell-runbook](automation-runbook-types.md#powershell-runbooks) och [grafiska runbook-flöden](automation-runbook-types.md#graphical-runbooks) kan anropa varje infogad som (båda är PowerShell-baserat).</span><span class="sxs-lookup"><span data-stu-id="fdda7-123">A [PowerShell runbook](automation-runbook-types.md#powershell-runbooks) and [Graphical runbooks](automation-runbook-types.md#graphical-runbooks) can call each other inline (both are PowerShell based).</span></span>
* <span data-ttu-id="fdda7-124">En [PowerShell-arbetsflödesrunbook](automation-runbook-types.md#powershell-workflow-runbooks) och grafisk PowerShell-arbetsflöde runbooks kan anropa varje infogad som (båda är PowerShell-arbetsflöde baserat)</span><span class="sxs-lookup"><span data-stu-id="fdda7-124">A [PowerShell Workflow runbook](automation-runbook-types.md#powershell-workflow-runbooks) and Graphical PowerShell Workflow runbooks can call each other inline (both are PowerShell Workflow based)</span></span>
* <span data-ttu-id="fdda7-125">Hej PowerShell typer och hello PowerShell-arbetsflöde typer kan inte anropa varandra infogade och måste använda Start AzureRmAutomationRunbook.</span><span class="sxs-lookup"><span data-stu-id="fdda7-125">hello PowerShell types and hello PowerShell Workflow types can’t call each other inline, and must use Start-AzureRmAutomationRunbook.</span></span>

<span data-ttu-id="fdda7-126">När du publicera ordning frågan:</span><span class="sxs-lookup"><span data-stu-id="fdda7-126">When does publish order matter:</span></span>

* <span data-ttu-id="fdda7-127">hello publicera ordningen för runbooks som endast är viktigt för PowerShell-arbetsflödet och grafisk PowerShell-arbetsflöde runbooks.</span><span class="sxs-lookup"><span data-stu-id="fdda7-127">hello publish order of runbooks only matters for PowerShell Workflow and Graphical PowerShell Workflow runbooks.</span></span>

<span data-ttu-id="fdda7-128">När du anropar en grafisk eller PowerShell-arbetsflöde underordnad runbook med infogad körning, använder du bara hello namnet på hello runbook.</span><span class="sxs-lookup"><span data-stu-id="fdda7-128">When you call a Graphical or PowerShell Workflow child runbook using inline execution, you just use hello name of hello runbook.</span></span>  <span data-ttu-id="fdda7-129">När du anropar en underordnad runbook som PowerShell, du måste föregås namnet med *.\\*  toospecify som hello skript finns i hello lokala katalog.</span><span class="sxs-lookup"><span data-stu-id="fdda7-129">When you call a PowerShell child runbook, you must preceded its name with *.\\* toospecify that hello script is located in hello local directory.</span></span> 

### <a name="example"></a><span data-ttu-id="fdda7-130">Exempel</span><span class="sxs-lookup"><span data-stu-id="fdda7-130">Example</span></span>
<span data-ttu-id="fdda7-131">hello följande exempel anropar ett test en underordnad runbook som accepterar tre parametrar, ett komplext objekt, ett heltal och ett booleskt värde.</span><span class="sxs-lookup"><span data-stu-id="fdda7-131">hello following example invokes a test child runbook that accepts three parameters, a complex object, an integer, and a boolean.</span></span> <span data-ttu-id="fdda7-132">hello utdata från hello underordnade runbooken tilldelas tooa variabeln.</span><span class="sxs-lookup"><span data-stu-id="fdda7-132">hello output of hello child runbook is assigned tooa variable.</span></span>  <span data-ttu-id="fdda7-133">I det här fallet är hello underordnad runbook ett PowerShell-arbetsflödesrunbook</span><span class="sxs-lookup"><span data-stu-id="fdda7-133">In this case, hello child runbook is a PowerShell Workflow runbook</span></span>

    $vm = Get-AzureRmVM –ResourceGroupName "LabRG" –Name "MyVM"
    $output = PSWF-ChildRunbook –VM $vm –RepeatCount 2 –Restart $true

<span data-ttu-id="fdda7-134">Följande är hello samma exempel med hjälp av en PowerShell-runbook som hello underordnad.</span><span class="sxs-lookup"><span data-stu-id="fdda7-134">Following is hello same example using a PowerShell runbook as hello child.</span></span>

    $vm = Get-AzureRmVM –ResourceGroupName "LabRG" –Name "MyVM"
    $output = .\PS-ChildRunbook.ps1 –VM $vm –RepeatCount 2 –Restart $true


## <a name="starting-a-child-runbook-using-cmdlet"></a><span data-ttu-id="fdda7-135">Starta en underordnad runbook med hjälp av cmdlet</span><span class="sxs-lookup"><span data-stu-id="fdda7-135">Starting a child runbook using cmdlet</span></span>
<span data-ttu-id="fdda7-136">Du kan använda hello [Start AzureRmAutomationRunbook](https://msdn.microsoft.com/library/mt603661.aspx) cmdlet toostart en runbook enligt beskrivningen i [toostart en runbook med Windows PowerShell](automation-starting-a-runbook.md#starting-a-runbook-with-windows-powershell).</span><span class="sxs-lookup"><span data-stu-id="fdda7-136">You can use hello [Start-AzureRmAutomationRunbook](https://msdn.microsoft.com/library/mt603661.aspx) cmdlet toostart a runbook as described in [toostart a runbook with Windows PowerShell](automation-starting-a-runbook.md#starting-a-runbook-with-windows-powershell).</span></span> <span data-ttu-id="fdda7-137">Det finns två lägen för användning av denna cmdlet.</span><span class="sxs-lookup"><span data-stu-id="fdda7-137">There are two modes of use for this cmdlet.</span></span>  <span data-ttu-id="fdda7-138">I ett läge returnerar hello cmdlet hello jobb-id som hello underordnade jobb skapas för hello underordnad runbook.</span><span class="sxs-lookup"><span data-stu-id="fdda7-138">In one mode, hello cmdlet returns hello job id as soon as hello child job is created for hello child runbook.</span></span>  <span data-ttu-id="fdda7-139">Hej i andra läge, som du aktiverar genom att ange hello **-vänta** parametern hello cmdlet ska vänta tills hello underordnade jobbet har slutförts och returnerar hello utdata från hello underordnad runbook.</span><span class="sxs-lookup"><span data-stu-id="fdda7-139">In hello other mode, which you enable by specifying hello **-wait** parameter, hello cmdlet will wait until hello child job finishes and will return hello output from hello child runbook.</span></span>

<span data-ttu-id="fdda7-140">hello jobb från en underordnad runbook som startas med en cmdlet kommer att köras i ett separat jobb från hello överordnad runbook.</span><span class="sxs-lookup"><span data-stu-id="fdda7-140">hello job from a child runbook started with a cmdlet will run in a separate job from hello parent runbook.</span></span> <span data-ttu-id="fdda7-141">Detta innebär fler jobb än anropas infogad för hello runbook och gör dem svårare tootrack.</span><span class="sxs-lookup"><span data-stu-id="fdda7-141">This results in more jobs than invoking hello runbook inline and makes them more difficult tootrack.</span></span> <span data-ttu-id="fdda7-142">hello överordnade kan starta flera underordnade runbooks asynkront utan att vänta på varje toocomplete.</span><span class="sxs-lookup"><span data-stu-id="fdda7-142">hello parent can start multiple child runbooks asynchronously without waiting for each toocomplete.</span></span> <span data-ttu-id="fdda7-143">För att få samma typ av parallell körning vid anrop av infogade för hello underordnade runbooks, hello överordnad runbook måste toouse hello [parallellt nyckelord](automation-powershell-workflow.md#parallel-processing).</span><span class="sxs-lookup"><span data-stu-id="fdda7-143">For that same kind of parallel execution calling hello child runbooks inline, hello parent runbook would need toouse hello [parallel keyword](automation-powershell-workflow.md#parallel-processing).</span></span>

<span data-ttu-id="fdda7-144">Parametrar för en underordnad runbook som startas med en cmdlet tillhandahålls som en hash-tabell enligt beskrivningen i [Runbookparametrar](automation-starting-a-runbook.md#runbook-parameters).</span><span class="sxs-lookup"><span data-stu-id="fdda7-144">Parameters for a child runbook started with a cmdlet are provided as a hashtable as described in [Runbook Parameters](automation-starting-a-runbook.md#runbook-parameters).</span></span> <span data-ttu-id="fdda7-145">Endast enkla datatyper kan användas.</span><span class="sxs-lookup"><span data-stu-id="fdda7-145">Only simple data types can be used.</span></span> <span data-ttu-id="fdda7-146">Om hello runbook har en parameter med en komplex datatyp, det måste den anropas infogad.</span><span class="sxs-lookup"><span data-stu-id="fdda7-146">If hello runbook has a parameter with a complex data type, then it must be called inline.</span></span>

### <a name="example"></a><span data-ttu-id="fdda7-147">Exempel</span><span class="sxs-lookup"><span data-stu-id="fdda7-147">Example</span></span>
<span data-ttu-id="fdda7-148">hello följande exempel startas en underordnad runbook med parametrar och sedan väntar toocomplete med hello Start AzureRmAutomationRunbook-vänta parametern.</span><span class="sxs-lookup"><span data-stu-id="fdda7-148">hello following example starts a child runbook with parameters and then waits for it toocomplete using hello Start-AzureRmAutomationRunbook -wait parameter.</span></span> <span data-ttu-id="fdda7-149">När slutförd samlas utdata från hello underordnad runbook.</span><span class="sxs-lookup"><span data-stu-id="fdda7-149">Once completed, its output is collected from hello child runbook.</span></span>

    $params = @{"VMName"="MyVM";"RepeatCount"=2;"Restart"=$true} 
    $joboutput = Start-AzureRmAutomationRunbook –AutomationAccountName "MyAutomationAccount" –Name "Test-ChildRunbook" -ResourceGroupName "LabRG" –Parameters $params –wait


## <a name="comparison-of-methods-for-calling-a-child-runbook"></a><span data-ttu-id="fdda7-150">Jämförelse av metoder för att anropa en underordnad runbook</span><span class="sxs-lookup"><span data-stu-id="fdda7-150">Comparison of methods for calling a child runbook</span></span>
<span data-ttu-id="fdda7-151">hello sammanfattas följande tabell hello skillnaderna mellan hello två metoder för att anropa en runbook från en annan runbook.</span><span class="sxs-lookup"><span data-stu-id="fdda7-151">hello following table summarizes hello differences between hello two methods for calling a runbook from another runbook.</span></span>

|  | <span data-ttu-id="fdda7-152">Infogade</span><span class="sxs-lookup"><span data-stu-id="fdda7-152">Inline</span></span> | <span data-ttu-id="fdda7-153">Cmdlet</span><span class="sxs-lookup"><span data-stu-id="fdda7-153">Cmdlet</span></span> |
|:--- |:--- |:--- |
| <span data-ttu-id="fdda7-154">Jobb</span><span class="sxs-lookup"><span data-stu-id="fdda7-154">Job</span></span> |<span data-ttu-id="fdda7-155">Underordnade runbooks körs i samma jobb som överordnade hello hello.</span><span class="sxs-lookup"><span data-stu-id="fdda7-155">Child runbooks run in hello same job as hello parent.</span></span> |<span data-ttu-id="fdda7-156">Ett separat jobb skapas för hello underordnad runbook.</span><span class="sxs-lookup"><span data-stu-id="fdda7-156">A separate job is created for hello child runbook.</span></span> |
| <span data-ttu-id="fdda7-157">Körning</span><span class="sxs-lookup"><span data-stu-id="fdda7-157">Execution</span></span> |<span data-ttu-id="fdda7-158">Överordnad runbook väntar hello underordnade runbook toocomplete innan du fortsätter.</span><span class="sxs-lookup"><span data-stu-id="fdda7-158">Parent runbook waits for hello child runbook toocomplete before continuing.</span></span> |<span data-ttu-id="fdda7-159">Överordnad runbook fortsätter omedelbart efter att underordnad runbook startas *eller* överordnad runbook väntar hello underordnade jobbet toofinish.</span><span class="sxs-lookup"><span data-stu-id="fdda7-159">Parent runbook continues immediately after child runbook is started *or* parent runbook waits for hello child job toofinish.</span></span> |
| <span data-ttu-id="fdda7-160">Resultat</span><span class="sxs-lookup"><span data-stu-id="fdda7-160">Output</span></span> |<span data-ttu-id="fdda7-161">Överordnad runbook kan hämta utdata direkt från underordnad runbook.</span><span class="sxs-lookup"><span data-stu-id="fdda7-161">Parent runbook can directly get output from child runbook.</span></span> |<span data-ttu-id="fdda7-162">Överordnad runbook måste hämta utdata från underordnat runbook-jobb *eller* överordnad runbook kan hämta utdata direkt från underordnad runbook.</span><span class="sxs-lookup"><span data-stu-id="fdda7-162">Parent runbook must retrieve output from child runbook job *or* parent runbook can directly get output from child runbook.</span></span> |
| <span data-ttu-id="fdda7-163">Parametrar</span><span class="sxs-lookup"><span data-stu-id="fdda7-163">Parameters</span></span> |<span data-ttu-id="fdda7-164">Värden för parametrar som hello underordnad runbook anges separat och kan använda alla datatyper.</span><span class="sxs-lookup"><span data-stu-id="fdda7-164">Values for hello child runbook parameters are specified separately and can use any data type.</span></span> |<span data-ttu-id="fdda7-165">Värdena för hello underordnad runbook parametrar måste kombineras i en enda hash-tabell och får bara innehålla enkla, matris och objekt-datatyper som använder JSON-serialisering.</span><span class="sxs-lookup"><span data-stu-id="fdda7-165">Values for hello child runbook parameters must be combined into a single hashtable and can only include simple, array, and object data types that leverage JSON serialization.</span></span> |
| <span data-ttu-id="fdda7-166">Automation-konto</span><span class="sxs-lookup"><span data-stu-id="fdda7-166">Automation Account</span></span> |<span data-ttu-id="fdda7-167">Överordnad runbook kan bara använda underordnad runbook i hello samma automation-konto.</span><span class="sxs-lookup"><span data-stu-id="fdda7-167">Parent runbook can only use child runbook in hello same automation account.</span></span> |<span data-ttu-id="fdda7-168">Överordnad runbook kan använda underordnad runbook från en automation-konto från hello samma Azure-prenumeration och en annan prenumeration även om du har en anslutning tooit.</span><span class="sxs-lookup"><span data-stu-id="fdda7-168">Parent runbook can use child runbook from any automation account from hello same Azure subscription and even a different subscription if you have a connection tooit.</span></span> |
| <span data-ttu-id="fdda7-169">Publicering</span><span class="sxs-lookup"><span data-stu-id="fdda7-169">Publishing</span></span> |<span data-ttu-id="fdda7-170">Underordnad runbook måste publiceras innan överordnad runbook publiceras.</span><span class="sxs-lookup"><span data-stu-id="fdda7-170">Child runbook must be published before parent runbook is published.</span></span> |<span data-ttu-id="fdda7-171">Underordnad runbook måste publiceras innan överordnad runbook startas.</span><span class="sxs-lookup"><span data-stu-id="fdda7-171">Child runbook must be published any time before parent runbook is started.</span></span> |

## <a name="next-steps"></a><span data-ttu-id="fdda7-172">Nästa steg</span><span class="sxs-lookup"><span data-stu-id="fdda7-172">Next steps</span></span>
* [<span data-ttu-id="fdda7-173">Starta en runbook i Azure Automation</span><span class="sxs-lookup"><span data-stu-id="fdda7-173">Starting a runbook in Azure Automation</span></span>](automation-starting-a-runbook.md)
* [<span data-ttu-id="fdda7-174">Runbook-utdata och meddelanden i Azure Automation</span><span class="sxs-lookup"><span data-stu-id="fdda7-174">Runbook output and messages in Azure Automation</span></span>](automation-runbook-output-and-messages.md)

