---
title: aaaError hantering i Azure Automation grafiska runbook | Microsoft Docs
description: "Den här artikeln beskriver hur tooimplement felhantering logiken i Azure Automation grafisk runbook."
services: automation
documentationcenter: 
author: mgoedtel
manager: jwhit
editor: tysonn
ms.assetid: 
ms.service: automation
ms.workload: tbd
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: get-started-article
ms.date: 12/26/2016
ms.author: magoedte
ms.openlocfilehash: b9ff01361d2ebd9c0174b074a7a290b1cc2fd1c8
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 10/06/2017
---
# <a name="error-handling-in-azure-automation-graphical-runbooks"></a><span data-ttu-id="33660-103">Felhantering i Azure Automation grafiska runbooks</span><span class="sxs-lookup"><span data-stu-id="33660-103">Error handling in Azure Automation graphical runbooks</span></span>

<span data-ttu-id="33660-104">En nyckel runbook design huvudnamn tooconsider identifierar olika problem som kan uppstå i en runbook.</span><span class="sxs-lookup"><span data-stu-id="33660-104">A key runbook design principal tooconsider is identifying different issues that a runbook might experience.</span></span> <span data-ttu-id="33660-105">De här problemen kan omfatta lyckade åtgärder, förväntade feltillstånd och oväntade feltillstånd.</span><span class="sxs-lookup"><span data-stu-id="33660-105">These issues can include success, expected error states, and unexpected error conditions.</span></span>

<span data-ttu-id="33660-106">Runbooks bör inkludera felhantering.</span><span class="sxs-lookup"><span data-stu-id="33660-106">Runbooks should include error handling.</span></span> <span data-ttu-id="33660-107">toovalidate hello utdata för en aktivitet eller hantera ett fel med grafiska runbook-flöden, du kan använda en aktivitet för Windows PowerShell-koden, definiera villkorlig logik på hello utdata länk hello aktivitet eller använda en annan metod.</span><span class="sxs-lookup"><span data-stu-id="33660-107">toovalidate hello output of an activity or handle an error with graphical runbooks, you could use a Windows PowerShell code activity, define conditional logic on hello output link of hello activity, or apply another method.</span></span>          

<span data-ttu-id="33660-108">Om det finns ett icke avslutar fel som uppstår vid en runbook-aktivitet, bearbetas alla aktiviteter som följer ofta, oavsett hello-fel.</span><span class="sxs-lookup"><span data-stu-id="33660-108">Often, if there is a non-terminating error that occurs with a runbook activity, any activity that follows is processed regardless of hello error.</span></span> <span data-ttu-id="33660-109">hello fel är sannolikt toogenerate ett undantag, men hello nästa aktivitet har fortfarande beviljad toorun.</span><span class="sxs-lookup"><span data-stu-id="33660-109">hello error is likely toogenerate an exception, but hello next activity is still allowed toorun.</span></span> <span data-ttu-id="33660-110">Detta är hello sättet att PowerShell är utformad toohandle fel.</span><span class="sxs-lookup"><span data-stu-id="33660-110">This is hello way that PowerShell is designed toohandle errors.</span></span>    

<span data-ttu-id="33660-111">hello typer av PowerShell-fel som kan uppstå under körningen avbryts eller inte avslutas.</span><span class="sxs-lookup"><span data-stu-id="33660-111">hello types of PowerShell errors that can occur during execution are terminating or non-terminating.</span></span> <span data-ttu-id="33660-112">hello skillnaderna mellan avslutande och icke-avslutande fel är följande:</span><span class="sxs-lookup"><span data-stu-id="33660-112">hello differences between terminating and non-terminating errors are as follows:</span></span>

* <span data-ttu-id="33660-113">**Avslutar fel**: ett allvarligt fel vid körning som stoppar hello kommando (eller skriptkörningen) helt.</span><span class="sxs-lookup"><span data-stu-id="33660-113">**Terminating error**: A serious error during execution that halts hello command (or script execution) completely.</span></span> <span data-ttu-id="33660-114">Exempel på detta är obefintliga cmdlet:ar, syntaxfel som förhindrar att en cmdlet körs eller andra allvarliga fel.</span><span class="sxs-lookup"><span data-stu-id="33660-114">Examples include non-existent cmdlets, syntax errors that prevent a cmdlet from running, or other fatal errors.</span></span>

* <span data-ttu-id="33660-115">**Icke-avslutande fel**: ett icke-allvarligt fel som tillåter körning av toocontinue trots hello-fel.</span><span class="sxs-lookup"><span data-stu-id="33660-115">**Non-terminating error**: A non-serious error that allows execution toocontinue despite hello failure.</span></span> <span data-ttu-id="33660-116">Exempel på detta är operativa fel som att en fil inte gick att hitta och behörighetsproblem.</span><span class="sxs-lookup"><span data-stu-id="33660-116">Examples include operational errors such as file not found errors and permissions problems.</span></span>

<span data-ttu-id="33660-117">Azure Automation-grafiska runbooks har förbättrats med hello kapaciteten tooinclude felhantering.</span><span class="sxs-lookup"><span data-stu-id="33660-117">Azure Automation graphical runbooks have been improved with hello capability tooinclude error handling.</span></span> <span data-ttu-id="33660-118">Du kan nu omvandla undantag till icke-avslutande fel och skapa fellänkar mellan aktiviteter.</span><span class="sxs-lookup"><span data-stu-id="33660-118">You can now turn exceptions into non-terminating errors and create error links between activities.</span></span> <span data-ttu-id="33660-119">Den här processen kan en runbook-redigerare toocatch fel och hantera realiserad eller oväntat villkor.</span><span class="sxs-lookup"><span data-stu-id="33660-119">This process allows a runbook author toocatch errors and manage realized or unexpected conditions.</span></span>  

## <a name="when-toouse-error-handling"></a><span data-ttu-id="33660-120">När toouse felhantering</span><span class="sxs-lookup"><span data-stu-id="33660-120">When toouse error handling</span></span>

<span data-ttu-id="33660-121">När det är en kritisk aktivitet som genererar ett fel eller ett undantag, är det viktigt tooprevent hello nästa aktivitet i din runbook från bearbetning och toohandle hello-fel på lämpligt sätt.</span><span class="sxs-lookup"><span data-stu-id="33660-121">Whenever there is a critical activity that throws an error or exception, it's important tooprevent hello next activity in your runbook from processing and toohandle hello error appropriately.</span></span> <span data-ttu-id="33660-122">Detta är särskilt viktigt när runbooks stöder en företags- eller tjänståtgärdsprocess.</span><span class="sxs-lookup"><span data-stu-id="33660-122">This is especially critical when your runbooks are supporting a business or service operations process.</span></span>

<span data-ttu-id="33660-123">För varje aktivitet som kan producera ett fel, hello runbook-redigerare lägga till ett fel länk tooany andra aktiviteter.</span><span class="sxs-lookup"><span data-stu-id="33660-123">For each activity that can produce an error, hello runbook author can add an error link pointing tooany other activity.</span></span>  <span data-ttu-id="33660-124">hello målaktiviteten kan vara av valfri typ, inklusive kod aktiviteter, anropar en cmdlet anropar en annan runbook och så vidare.</span><span class="sxs-lookup"><span data-stu-id="33660-124">hello destination activity can be of any type, including code activities, invoking a cmdlet, invoking another runbook, and so on.</span></span>

<span data-ttu-id="33660-125">Hello målaktiviteten kan dessutom också ha utgående länkar.</span><span class="sxs-lookup"><span data-stu-id="33660-125">In addition, hello destination activity can also have outgoing links.</span></span> <span data-ttu-id="33660-126">Dessa länkar kan vara vanliga länkar eller fellänkar.</span><span class="sxs-lookup"><span data-stu-id="33660-126">These links can be regular links or error links.</span></span> <span data-ttu-id="33660-127">Det innebär att hello runbook-redigerare kan implementera komplex logik för felhantering utan sortera tooa code aktivitet.</span><span class="sxs-lookup"><span data-stu-id="33660-127">This means hello runbook author can implement complex error-handling logic without resorting tooa code activity.</span></span> <span data-ttu-id="33660-128">hello rekommenderas praxis toocreate en dedikerad felhantering runbook med vanliga funktioner, men det är inte obligatoriskt.</span><span class="sxs-lookup"><span data-stu-id="33660-128">hello recommended practice is toocreate a dedicated error-handling runbook with common functionality, but it's not mandatory.</span></span> <span data-ttu-id="33660-129">Felhantering logiken i en aktivitet för PowerShell-kod som inte hello endast alternativet.</span><span class="sxs-lookup"><span data-stu-id="33660-129">Error-handling logic in a PowerShell code activity it isn't hello only option.</span></span>  

<span data-ttu-id="33660-130">Till exempel att du en runbook som försöker toostart en virtuell dator och installera ett program på den.</span><span class="sxs-lookup"><span data-stu-id="33660-130">For example, consider a runbook that tries toostart a VM and install an application on it.</span></span> <span data-ttu-id="33660-131">Om hello VM inte startas på rätt sätt, genomför två åtgärder:</span><span class="sxs-lookup"><span data-stu-id="33660-131">If hello VM doesn't start correctly, it performs two actions:</span></span>

1. <span data-ttu-id="33660-132">Den skickar ett meddelande om det här problemet.</span><span class="sxs-lookup"><span data-stu-id="33660-132">It sends a notification about this problem.</span></span>
2. <span data-ttu-id="33660-133">Den startar en annan runbook som automatiskt etablerar en ny virtuell dator i stället.</span><span class="sxs-lookup"><span data-stu-id="33660-133">It starts another runbook that automatically provisions a new VM instead.</span></span>

<span data-ttu-id="33660-134">En lösning är toohave fel pekar tooan aktivitet som hanterar steg ett.</span><span class="sxs-lookup"><span data-stu-id="33660-134">One solution is toohave an error link pointing tooan activity that handles step one.</span></span> <span data-ttu-id="33660-135">Du kan till exempel ansluta hello **Write-Warningg** cmdlet tooan aktivitet för steg två, till exempel hello **Start AzureRmAutomationRunbook** cmdlet.</span><span class="sxs-lookup"><span data-stu-id="33660-135">For example, you could connect hello **Write-Warning** cmdlet tooan activity for step two, such as hello **Start-AzureRmAutomationRunbook** cmdlet.</span></span>

<span data-ttu-id="33660-136">Du kan också generalisera beteendet för användning i många runbooks genom att dessa två aktiviteter i en separat hantering runbook och hello vägledningen förslag tidigare.</span><span class="sxs-lookup"><span data-stu-id="33660-136">You could also generalize this behavior for use in many runbooks by putting these two activities in a separate error handling runbook and following hello guidance suggested earlier.</span></span> <span data-ttu-id="33660-137">Innan du anropar den här felhantering runbook du skapar ett anpassat meddelande från hello data i hello ursprungliga runbook och skickar den sedan som en parameter toohello felhantering runbook.</span><span class="sxs-lookup"><span data-stu-id="33660-137">Before calling this error-handling runbook, you could construct a custom message from hello data in hello original runbook, and then pass it as a parameter toohello error-handling runbook.</span></span>

## <a name="how-toouse-error-handling"></a><span data-ttu-id="33660-138">Hur toouse felhantering</span><span class="sxs-lookup"><span data-stu-id="33660-138">How toouse error handling</span></span>

<span data-ttu-id="33660-139">Varje aktivitet har en konfigurationsinställning som omvandlar undantag till icke-avslutande fel.</span><span class="sxs-lookup"><span data-stu-id="33660-139">Each activity has a configuration setting that turns exceptions into non-terminating errors.</span></span> <span data-ttu-id="33660-140">Som standard är denna inställning inaktiverad.</span><span class="sxs-lookup"><span data-stu-id="33660-140">By default, this setting is disabled.</span></span> <span data-ttu-id="33660-141">Vi rekommenderar att du aktiverar den här inställningen på alla aktiviteter där du vill att toohandle fel.</span><span class="sxs-lookup"><span data-stu-id="33660-141">We recommend that you enable this setting on any activity where you want toohandle errors.</span></span>  

<span data-ttu-id="33660-142">Genom att aktivera den här konfigurationen, du säkerställa att både avslutande och icke-avslutande fel i hello aktivitet hanteras som ej avslutande fel och kan hanteras med en fel-länk.</span><span class="sxs-lookup"><span data-stu-id="33660-142">By enabling this configuration, you are assuring that both terminating and non-terminating errors in hello activity are handled as non-terminating errors, and can be handled with an error link.</span></span>  

<span data-ttu-id="33660-143">När du har konfigurerat den här inställningen kan du skapa en aktivitet som hanterar hello-fel.</span><span class="sxs-lookup"><span data-stu-id="33660-143">After configuring this setting, you create an activity that handles hello error.</span></span> <span data-ttu-id="33660-144">Om en aktivitet producerar något fel, hello utgående fel länkar följs och hello reguljära länkar som inte även om hello aktivitet producerar samt regelbundna utdata.</span><span class="sxs-lookup"><span data-stu-id="33660-144">If an activity produces any error, then hello outgoing error links are followed, and hello regular links are not, even if hello activity produces regular output as well.</span></span><br><br> ![Fellänksexempel för Automation Runbook](media/automation-runbook-graphical-error-handling/error-link-example.png)

<span data-ttu-id="33660-146">I följande exempel hello, hämtar en variabel som innehåller hello datornamnet för en virtuell dator i en runbook.</span><span class="sxs-lookup"><span data-stu-id="33660-146">In hello following example, a runbook retrieves a variable that contains hello computer name of a virtual machine.</span></span> <span data-ttu-id="33660-147">Sedan försöker den toostart hello virtuell dator med hello nästa aktivitet.</span><span class="sxs-lookup"><span data-stu-id="33660-147">It then attempts toostart hello virtual machine with hello next activity.</span></span><br><br> ![Felhanteringsexempel för Automation Runbook](media/automation-runbook-graphical-error-handling/runbook-example-error-handling.png)<br><br>      

<span data-ttu-id="33660-149">Hej **Get-automationvariable,** aktivitet och **Start AzureRmVm** är konfigurerade tooconvert undantag tooerrors.</span><span class="sxs-lookup"><span data-stu-id="33660-149">hello **Get-AutomationVariable** activity and **Start-AzureRmVm** are configured tooconvert exceptions tooerrors.</span></span>  <span data-ttu-id="33660-150">Om det finns problem med hello variabel eller första hello VM sedan fel genereras.</span><span class="sxs-lookup"><span data-stu-id="33660-150">If there are problems getting hello variable or starting hello VM, then errors are generated.</span></span><br><br> <span data-ttu-id="33660-151">![Felhantering i Automation Runbook, aktivitetsinställningar](media/automation-runbook-graphical-error-handling/activity-blade-convertexception-option.png)</span><span class="sxs-lookup"><span data-stu-id="33660-151">![Automation runbook error-handling activity settings](media/automation-runbook-graphical-error-handling/activity-blade-convertexception-option.png)</span></span>

<span data-ttu-id="33660-152">Fel länkar flödar från dessa aktiviteter tooa enda **fel management** aktivitet (en kod aktivitet).</span><span class="sxs-lookup"><span data-stu-id="33660-152">Error links flow from these activities tooa single **error management** activity (a code activity).</span></span> <span data-ttu-id="33660-153">Den här aktiviteten är konfigurerad med ett enkelt PowerShell-uttryck som använder hello *utlösa* nyckelordet toostop bearbetning, tillsammans med *$Error.Exception.Message* tooget hello-meddelande som beskriver hello aktuella undantaget.</span><span class="sxs-lookup"><span data-stu-id="33660-153">This activity is configured with a simple PowerShell expression that uses hello *Throw* keyword toostop processing, along with *$Error.Exception.Message* tooget hello message that describes hello current exception.</span></span><br><br> <span data-ttu-id="33660-154">![Automation Runbook-felhantering, kodexempel](media/automation-runbook-graphical-error-handling/runbook-example-error-handling-code.png)</span><span class="sxs-lookup"><span data-stu-id="33660-154">![Automation runbook error-handling code example](media/automation-runbook-graphical-error-handling/runbook-example-error-handling-code.png)</span></span>


## <a name="next-steps"></a><span data-ttu-id="33660-155">Nästa steg</span><span class="sxs-lookup"><span data-stu-id="33660-155">Next steps</span></span>

* <span data-ttu-id="33660-156">toolearn mer om länkar och länktyper i grafiska runbooks finns [grafiska redigering i Azure Automation](automation-graphical-authoring-intro.md#links-and-workflow).</span><span class="sxs-lookup"><span data-stu-id="33660-156">toolearn more about links and link types in graphical runbooks, see [Graphical authoring in Azure Automation](automation-graphical-authoring-intro.md#links-and-workflow).</span></span>

* <span data-ttu-id="33660-157">Mer om runbook-körningen hur toomonitor runbook-jobb och annan teknisk information finns i toolearn [spåra en runbook-jobbet](automation-runbook-execution.md).</span><span class="sxs-lookup"><span data-stu-id="33660-157">toolearn more about runbook execution, how toomonitor runbook jobs, and other technical details, see [Track a runbook job](automation-runbook-execution.md).</span></span>
