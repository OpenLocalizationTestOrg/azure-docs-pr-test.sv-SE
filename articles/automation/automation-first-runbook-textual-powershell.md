---
title: "aaaMy första PowerShell-runbook i Azure Automation | Microsoft Docs"
description: "Självstudiekurs med stegvisa hello skapa, testa och publicering av en enkel PowerShell-runbook."
services: automation
documentationcenter: 
author: mgoedtel
manager: jwhit
editor: 
keywords: "azure powershell, självstudier i powershell-skript, powershell-automation"
ms.assetid: a43b395a-e740-41a3-ae62-40eac9d0ec00
ms.service: automation
ms.workload: tbd
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: get-started-article
ms.date: 03/26/2017
ms.author: magoedte;sngun
ms.openlocfilehash: abff94abe666cd8423c35b970b4162ba9247bcf8
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 10/06/2017
---
# <a name="my-first-powershell-runbook"></a><span data-ttu-id="3cf06-104">Min första PowerShell-runbook</span><span class="sxs-lookup"><span data-stu-id="3cf06-104">My first PowerShell runbook</span></span>

> [!div class="op_single_selector"]
> * [<span data-ttu-id="3cf06-105">Grafisk</span><span class="sxs-lookup"><span data-stu-id="3cf06-105">Graphical</span></span>](automation-first-runbook-graphical.md)
> * [<span data-ttu-id="3cf06-106">PowerShell</span><span class="sxs-lookup"><span data-stu-id="3cf06-106">PowerShell</span></span>](automation-first-runbook-textual-powershell.md)
> * [<span data-ttu-id="3cf06-107">PowerShell-arbetsflöde</span><span class="sxs-lookup"><span data-stu-id="3cf06-107">PowerShell Workflow</span></span>](automation-first-runbook-textual.md)
> 
> 

<span data-ttu-id="3cf06-108">Den här självstudiekursen vägleder dig genom hello skapandet av en [PowerShell-runbook](automation-runbook-types.md#powershell-runbooks) i Azure Automation.</span><span class="sxs-lookup"><span data-stu-id="3cf06-108">This tutorial walks you through hello creation of a [PowerShell runbook](automation-runbook-types.md#powershell-runbooks) in Azure Automation.</span></span> <span data-ttu-id="3cf06-109">Vi börjar med en enkel runbook som vi testa och publicera medan vi förklarar hur tootrack hello hello runbook jobbets status.</span><span class="sxs-lookup"><span data-stu-id="3cf06-109">We start with a simple runbook that we test and publish while we explain how tootrack hello status of hello runbook job.</span></span> <span data-ttu-id="3cf06-110">Vi ändra hello runbook tooactually hantera Azure-resurser, i det här fallet startar en virtuell Azure-dator.</span><span class="sxs-lookup"><span data-stu-id="3cf06-110">Then we modify hello runbook tooactually manage Azure resources, in this case starting an Azure virtual machine.</span></span> <span data-ttu-id="3cf06-111">Slutligen kan göra vi hello runbook stabilare genom att lägga till runbook-parametrar.</span><span class="sxs-lookup"><span data-stu-id="3cf06-111">Lastly, we make hello runbook more robust by adding runbook parameters.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="3cf06-112">Krav</span><span class="sxs-lookup"><span data-stu-id="3cf06-112">Prerequisites</span></span>
<span data-ttu-id="3cf06-113">toocomplete den här kursen behöver du hello följande:</span><span class="sxs-lookup"><span data-stu-id="3cf06-113">toocomplete this tutorial, you need hello following:</span></span>

* <span data-ttu-id="3cf06-114">En Azure-prenumeration.</span><span class="sxs-lookup"><span data-stu-id="3cf06-114">Azure subscription.</span></span> <span data-ttu-id="3cf06-115">Om du inte redan har ett konto kan du [aktivera dina MSDN-prenumerantförmåner](https://azure.microsoft.com/pricing/member-offers/msdn-benefits-details/) eller <a href="/pricing/free-account/" target="_blank">[registrera dig för ett kostnadsfritt konto](https://azure.microsoft.com/free/).</span><span class="sxs-lookup"><span data-stu-id="3cf06-115">If you don't have one yet, you can [activate your MSDN subscriber benefits](https://azure.microsoft.com/pricing/member-offers/msdn-benefits-details/) or <a href="/pricing/free-account/" target="_blank">[sign up for a free account](https://azure.microsoft.com/free/).</span></span>
* <span data-ttu-id="3cf06-116">[Automation-konto](automation-sec-configure-azure-runas-account.md) toohold hello runbook och autentisera tooAzure resurser.</span><span class="sxs-lookup"><span data-stu-id="3cf06-116">[Automation account](automation-sec-configure-azure-runas-account.md) toohold hello runbook and authenticate tooAzure resources.</span></span>  <span data-ttu-id="3cf06-117">Det här kontot måste ha behörighet toostart och stoppa hello virtuella datorn.</span><span class="sxs-lookup"><span data-stu-id="3cf06-117">This account must have permission toostart and stop hello virtual machine.</span></span>
* <span data-ttu-id="3cf06-118">En virtuell dator i Azure.</span><span class="sxs-lookup"><span data-stu-id="3cf06-118">An Azure virtual machine.</span></span> <span data-ttu-id="3cf06-119">Eftersom vi ska stoppa och starta den här datorn bör det inte vara en virtuell dator som finns i produktionsmiljön.</span><span class="sxs-lookup"><span data-stu-id="3cf06-119">We stop and start this machine so it should not be a production VM.</span></span>

## <a name="step-1---create-new-runbook"></a><span data-ttu-id="3cf06-120">Steg 1 – Skapa en ny runbook</span><span class="sxs-lookup"><span data-stu-id="3cf06-120">Step 1 - Create new runbook</span></span>
<span data-ttu-id="3cf06-121">Vi börjar med att skapa en enkel runbook som matar ut hello text *Hello World*.</span><span class="sxs-lookup"><span data-stu-id="3cf06-121">We'll start by creating a simple runbook that outputs hello text *Hello World*.</span></span>

1. <span data-ttu-id="3cf06-122">Hello Azure-portalen, öppna ditt Automation-konto.</span><span class="sxs-lookup"><span data-stu-id="3cf06-122">In hello Azure portal, open your Automation account.</span></span>  
   <span data-ttu-id="3cf06-123">sidan för hello Automation-konto får du en snabb överblick över hello resurser i det här kontot.</span><span class="sxs-lookup"><span data-stu-id="3cf06-123">hello Automation account page gives you a quick view of hello resources in this account.</span></span> <span data-ttu-id="3cf06-124">Du bör redan ha vissa tillgångar.</span><span class="sxs-lookup"><span data-stu-id="3cf06-124">You should already have some assets.</span></span> <span data-ttu-id="3cf06-125">De flesta av dessa är hello-moduler som ingår automatiskt i ett nytt Automation-konto.</span><span class="sxs-lookup"><span data-stu-id="3cf06-125">Most of those are hello modules that are automatically included in a new Automation account.</span></span> <span data-ttu-id="3cf06-126">Du bör också ha hello autentiseringsuppgiftstillgång som nämns i hello [krav](#prerequisites).</span><span class="sxs-lookup"><span data-stu-id="3cf06-126">You should also have hello Credential asset that's mentioned in hello [prerequisites](#prerequisites).</span></span>
2. <span data-ttu-id="3cf06-127">Klicka på hello **Runbooks** panelen tooopen hello lista över runbooks.</span><span class="sxs-lookup"><span data-stu-id="3cf06-127">Click hello **Runbooks** tile tooopen hello list of runbooks.</span></span><br><br> <span data-ttu-id="3cf06-128">![RunbooksControl](media/automation-first-runbook-textual-powershell/runbooks-control-tiles.png)</span><span class="sxs-lookup"><span data-stu-id="3cf06-128">![RunbooksControl](media/automation-first-runbook-textual-powershell/runbooks-control-tiles.png)</span></span>  
3. <span data-ttu-id="3cf06-129">Skapa en ny runbook genom att klicka på hello **lägga till en runbook** knappen och sedan **skapa en ny runbook**.</span><span class="sxs-lookup"><span data-stu-id="3cf06-129">Create a new runbook by clicking hello **Add a runbook** button and then **Create a new runbook**.</span></span>
4. <span data-ttu-id="3cf06-130">Namnge hello runbook hello *MyFirstRunbook PowerShell*.</span><span class="sxs-lookup"><span data-stu-id="3cf06-130">Give hello runbook hello name *MyFirstRunbook-PowerShell*.</span></span>
5. <span data-ttu-id="3cf06-131">I det här fallet ska vi toocreate en [PowerShell-runbook](automation-runbook-types.md#powershell-runbooks) så väljer **Powershell** för **runbooktyp**.</span><span class="sxs-lookup"><span data-stu-id="3cf06-131">In this case, we're going toocreate a [PowerShell runbook](automation-runbook-types.md#powershell-runbooks) so select **Powershell** for **Runbook type**.</span></span><br><br> <span data-ttu-id="3cf06-132">![Typ av runbook](media/automation-first-runbook-textual-powershell/automation-runbook-type.png)</span><span class="sxs-lookup"><span data-stu-id="3cf06-132">![Runbook Type](media/automation-first-runbook-textual-powershell/automation-runbook-type.png)</span></span>  
6. <span data-ttu-id="3cf06-133">Klicka på **skapa** toocreate hello runbook och öppna hello textrepresentation editor.</span><span class="sxs-lookup"><span data-stu-id="3cf06-133">Click **Create** toocreate hello runbook and open hello textual editor.</span></span>

## <a name="step-2---add-code-toohello-runbook"></a><span data-ttu-id="3cf06-134">Steg 2 – Lägg till kod toohello runbook</span><span class="sxs-lookup"><span data-stu-id="3cf06-134">Step 2 - Add code toohello runbook</span></span>
<span data-ttu-id="3cf06-135">Du kan antingen Typkod direkt i hello runbook eller kan du välja cmdlets, runbooks och tillgångar från hello biblioteket kontroll och har dem lagt till toohello runbook med eventuella relaterade parametrar.</span><span class="sxs-lookup"><span data-stu-id="3cf06-135">You can either type code directly into hello runbook, or you can select cmdlets, runbooks, and assets from hello Library control and have them added toohello runbook with any related parameters.</span></span> <span data-ttu-id="3cf06-136">Den här genomgången skriver direkt i hello runbook.</span><span class="sxs-lookup"><span data-stu-id="3cf06-136">For this walkthrough, we type directly in hello runbook.</span></span>

1. <span data-ttu-id="3cf06-137">Vår runbook är tom än så länge. Skriv *Write-Output "Hello World."*.</span><span class="sxs-lookup"><span data-stu-id="3cf06-137">Our runbook is currently empty, type *Write-Output "Hello World."*.</span></span><br><br> <span data-ttu-id="3cf06-138">![Hello World](media/automation-first-runbook-textual-powershell/automation-helloworld.png)</span><span class="sxs-lookup"><span data-stu-id="3cf06-138">![Hello World](media/automation-first-runbook-textual-powershell/automation-helloworld.png)</span></span>  
2. <span data-ttu-id="3cf06-139">Spara hello runbook genom att klicka på **spara**.</span><span class="sxs-lookup"><span data-stu-id="3cf06-139">Save hello runbook by clicking **Save**.</span></span><br><br> <span data-ttu-id="3cf06-140">![Knappen Spara](media/automation-first-runbook-textual-powershell/automation-runbook-edit-controls-save.png)</span><span class="sxs-lookup"><span data-stu-id="3cf06-140">![Save Button](media/automation-first-runbook-textual-powershell/automation-runbook-edit-controls-save.png)</span></span>  

## <a name="step-3---test-hello-runbook"></a><span data-ttu-id="3cf06-141">Steg 3 – runbook-testet hello</span><span class="sxs-lookup"><span data-stu-id="3cf06-141">Step 3 - Test hello runbook</span></span>
<span data-ttu-id="3cf06-142">Innan vi publicerar hello runbook toomake den tillgänglig i produktion, vi vill tootest den toomake till att den fungerar korrekt.</span><span class="sxs-lookup"><span data-stu-id="3cf06-142">Before we publish hello runbook toomake it available in production, we want tootest it toomake sure that it works properly.</span></span> <span data-ttu-id="3cf06-143">När du testar en runbook kör du dess **utkastversion** och visar dess utdata interaktivt.</span><span class="sxs-lookup"><span data-stu-id="3cf06-143">When you test a runbook, you run its **Draft** version and view its output interactively.</span></span>

1. <span data-ttu-id="3cf06-144">Klicka på **Test fönstret** tooopen hello Test fönstret.</span><span class="sxs-lookup"><span data-stu-id="3cf06-144">Click **Test pane** tooopen hello Test pane.</span></span><br><br> <span data-ttu-id="3cf06-145">![Testfönster](media/automation-first-runbook-textual-powershell/automation-runbook-edit-controls-test.png)</span><span class="sxs-lookup"><span data-stu-id="3cf06-145">![Test Pane](media/automation-first-runbook-textual-powershell/automation-runbook-edit-controls-test.png)</span></span>  
2. <span data-ttu-id="3cf06-146">Klicka på **starta** toostart hello test.</span><span class="sxs-lookup"><span data-stu-id="3cf06-146">Click **Start** toostart hello test.</span></span> <span data-ttu-id="3cf06-147">Detta bör vara hello endast aktiverade alternativet.</span><span class="sxs-lookup"><span data-stu-id="3cf06-147">This should be hello only enabled option.</span></span>
3. <span data-ttu-id="3cf06-148">Ett [runbook-jobb](automation-runbook-execution.md) skapas och dess status visas.</span><span class="sxs-lookup"><span data-stu-id="3cf06-148">A [runbook job](automation-runbook-execution.md) is created and its status displayed.</span></span>  
   <span data-ttu-id="3cf06-149">hello jobbstatus startar som *i kö* som anger att den väntar på en runbook worker i hello molnet toocome tillgängliga.</span><span class="sxs-lookup"><span data-stu-id="3cf06-149">hello job status starts as *Queued* indicating that it is waiting for a runbook worker in hello cloud toocome available.</span></span> <span data-ttu-id="3cf06-150">Sedan flyttas för*Start* när en arbetsprocess anspråk hello jobb, och sedan *kör* när hello runbook faktiskt börjar köras.</span><span class="sxs-lookup"><span data-stu-id="3cf06-150">It will then move too*Starting* when a worker claims hello job, and then *Running* when hello runbook actually starts running.</span></span>  
4. <span data-ttu-id="3cf06-151">När hello runbook-jobbet är klart visas dess utdata.</span><span class="sxs-lookup"><span data-stu-id="3cf06-151">When hello runbook job completes, its output is displayed.</span></span> <span data-ttu-id="3cf06-152">I detta fall bör du se *Hello World*.</span><span class="sxs-lookup"><span data-stu-id="3cf06-152">In our case, we should see *Hello World*.</span></span><br><br> <span data-ttu-id="3cf06-153">![Utdata i testfönstret](media/automation-first-runbook-textual-powershell/automation-testpane-output.png)</span><span class="sxs-lookup"><span data-stu-id="3cf06-153">![Test Pane Output](media/automation-first-runbook-textual-powershell/automation-testpane-output.png)</span></span>  
5. <span data-ttu-id="3cf06-154">Stäng hello Test fönstret tooreturn toohello arbetsytan.</span><span class="sxs-lookup"><span data-stu-id="3cf06-154">Close hello Test pane tooreturn toohello canvas.</span></span>

## <a name="step-4---publish-and-start-hello-runbook"></a><span data-ttu-id="3cf06-155">Steg 4 – publicera och starta hello runbook</span><span class="sxs-lookup"><span data-stu-id="3cf06-155">Step 4 - Publish and start hello runbook</span></span>
<span data-ttu-id="3cf06-156">hello-runbook som vi skapade är fortfarande i utkastläge.</span><span class="sxs-lookup"><span data-stu-id="3cf06-156">hello runbook that we created is still in Draft mode.</span></span> <span data-ttu-id="3cf06-157">Vi behöver toopublish den innan vi kan köra den i produktion.</span><span class="sxs-lookup"><span data-stu-id="3cf06-157">We need toopublish it before we can run it in production.</span></span>  <span data-ttu-id="3cf06-158">När du publicerar en runbook kan du skriva över hello befintliga publicerade versionen med hello utkastet.</span><span class="sxs-lookup"><span data-stu-id="3cf06-158">When you publish a runbook, you overwrite hello existing Published version with hello Draft version.</span></span>  <span data-ttu-id="3cf06-159">I vårt fall har vi inte en publicerad version ännu eftersom vi just skapade hello runbook.</span><span class="sxs-lookup"><span data-stu-id="3cf06-159">In our case, we don't have a Published version yet because we just created hello runbook.</span></span>

1. <span data-ttu-id="3cf06-160">Klicka på **publicera** toopublish hello runbook och sedan **Ja** när du tillfrågas.</span><span class="sxs-lookup"><span data-stu-id="3cf06-160">Click **Publish** toopublish hello runbook and then **Yes** when prompted.</span></span><br><br> <span data-ttu-id="3cf06-161">![Knappen Publicera](media/automation-first-runbook-textual-powershell/automation-runbook-edit-controls-publish.png)</span><span class="sxs-lookup"><span data-stu-id="3cf06-161">![Publish button](media/automation-first-runbook-textual-powershell/automation-runbook-edit-controls-publish.png)</span></span>  
2. <span data-ttu-id="3cf06-162">Om du bläddrar vänstra tooview hello runbook i hello **Runbooks** fönstret nu visas en **redigering Status** av **publicerade**.</span><span class="sxs-lookup"><span data-stu-id="3cf06-162">If you scroll left tooview hello runbook in hello **Runbooks** pane now, it will show an **Authoring Status** of **Published**.</span></span>
3. <span data-ttu-id="3cf06-163">Rulla tillbaka toohello rätt tooview hello fönstret för **MyFirstRunbook PowerShell**.</span><span class="sxs-lookup"><span data-stu-id="3cf06-163">Scroll back toohello right tooview hello pane for **MyFirstRunbook-PowerShell**.</span></span>  
   <span data-ttu-id="3cf06-164">hello alternativ överst hello kan vi toostart hello runbook, visa hello runbook, schemalägga toostart någon gång hello framtida eller skapa en [webhook](automation-webhooks.md) så att den kan startas via en HTTP-anrop.</span><span class="sxs-lookup"><span data-stu-id="3cf06-164">hello options across hello top allow us toostart hello runbook, view hello runbook, schedule it toostart at some time in hello future, or create a [webhook](automation-webhooks.md) so it can be started through an HTTP call.</span></span>
4. <span data-ttu-id="3cf06-165">Vi vill toostart hello runbook, så klicka på **starta** och klicka sedan på **Ok** när hello starta Runbook-bladet öppnas.</span><span class="sxs-lookup"><span data-stu-id="3cf06-165">We want toostart hello runbook, so click **Start** and then click **Ok** when hello Start Runbook blade opens.</span></span><br><br> <span data-ttu-id="3cf06-166">![Knappen Starta](media/automation-first-runbook-textual-powershell/automation-runbook-controls-start.png)</span><span class="sxs-lookup"><span data-stu-id="3cf06-166">![Start button](media/automation-first-runbook-textual-powershell/automation-runbook-controls-start.png)</span></span><br>    
5. <span data-ttu-id="3cf06-167">Ett jobb-fönstret har öppnats med hello runbook-jobb som vi skapade.</span><span class="sxs-lookup"><span data-stu-id="3cf06-167">A job pane is opened for hello runbook job that we created.</span></span> <span data-ttu-id="3cf06-168">Du kan stänga det här fönstret, men i det här fallet vi lämna den öppen så att vi kan titta på hello jobb pågår.</span><span class="sxs-lookup"><span data-stu-id="3cf06-168">We can close this pane, but in this case we leave it open so we can watch hello job's progress.</span></span>
6. <span data-ttu-id="3cf06-169">hello jobbstatus visas i **jobbsammanfattning** och matchar hello status som vi såg när vi testade hello runbook.</span><span class="sxs-lookup"><span data-stu-id="3cf06-169">hello job status is shown in **Job Summary** and matches hello statuses that we saw when we tested hello runbook.</span></span><br><br> <span data-ttu-id="3cf06-170">![Jobbsammanfattning](media/automation-first-runbook-textual-powershell/job-pane-status-blade-jobsummary.png)</span><span class="sxs-lookup"><span data-stu-id="3cf06-170">![Job Summary](media/automation-first-runbook-textual-powershell/job-pane-status-blade-jobsummary.png)</span></span><br>  
7. <span data-ttu-id="3cf06-171">En gång hello runbook status visas *slutförd*, klickar du på **utdata**.</span><span class="sxs-lookup"><span data-stu-id="3cf06-171">Once hello runbook status shows *Completed*, click **Output**.</span></span> <span data-ttu-id="3cf06-172">hello utdatafönstret har öppnats och kan vi se vår *Hello World*.</span><span class="sxs-lookup"><span data-stu-id="3cf06-172">hello Output pane is opened, and we can see our *Hello World*.</span></span><br><br> <span data-ttu-id="3cf06-173">![Jobbutdata](media/automation-first-runbook-textual-powershell/job-pane-status-blade-outputtile.png)</span><span class="sxs-lookup"><span data-stu-id="3cf06-173">![Job Output](media/automation-first-runbook-textual-powershell/job-pane-status-blade-outputtile.png)</span></span><br> 
8. <span data-ttu-id="3cf06-174">Stäng hello utdatafönstret.</span><span class="sxs-lookup"><span data-stu-id="3cf06-174">Close hello Output pane.</span></span>
9. <span data-ttu-id="3cf06-175">Klicka på **alla loggar** tooopen hello dataströmmar fönstret för hello runbook-jobbet.</span><span class="sxs-lookup"><span data-stu-id="3cf06-175">Click **All Logs** tooopen hello Streams pane for hello runbook job.</span></span> <span data-ttu-id="3cf06-176">Vi ska bara se *Hello World* i hello utdata stream, men detta kan du visa andra dataströmmar för en runbook-jobb, till exempel utförlig och fel om hello runbook skriver toothem.</span><span class="sxs-lookup"><span data-stu-id="3cf06-176">We should only see *Hello World* in hello output stream, but this can show other streams for a runbook job such as Verbose and Error if hello runbook writes toothem.</span></span><br><br> <span data-ttu-id="3cf06-177">![Alla loggar](media/automation-first-runbook-textual-powershell/job-pane-status-blade-alllogstile.png)</span><span class="sxs-lookup"><span data-stu-id="3cf06-177">![All Logs](media/automation-first-runbook-textual-powershell/job-pane-status-blade-alllogstile.png)</span></span><br>   
10. <span data-ttu-id="3cf06-178">Stäng hello dataströmmar och hello jobbet fönstret tooreturn toohello MyFirstRunbook PowerShell.</span><span class="sxs-lookup"><span data-stu-id="3cf06-178">Close hello Streams pane and hello Job pane tooreturn toohello MyFirstRunbook-PowerShell pane.</span></span>
11. <span data-ttu-id="3cf06-179">Klicka på **jobb** tooopen hello jobb-fönstret för runbook.</span><span class="sxs-lookup"><span data-stu-id="3cf06-179">Click **Jobs** tooopen hello Jobs pane for this runbook.</span></span> <span data-ttu-id="3cf06-180">Detta visar alla hello jobben som skapats av denna runbook.</span><span class="sxs-lookup"><span data-stu-id="3cf06-180">This lists all of hello jobs created by this runbook.</span></span> <span data-ttu-id="3cf06-181">Vi ska bara se ett jobb visas eftersom vi bara körde hello jobbet en gång.</span><span class="sxs-lookup"><span data-stu-id="3cf06-181">We should only see one job listed since we only ran hello job once.</span></span><br><br> <span data-ttu-id="3cf06-182">![Jobblista](media/automation-first-runbook-textual-powershell/runbook-control-job-tile.png)</span><span class="sxs-lookup"><span data-stu-id="3cf06-182">![Job List](media/automation-first-runbook-textual-powershell/runbook-control-job-tile.png)</span></span>  
12. <span data-ttu-id="3cf06-183">Du kan klicka på det här jobbet tooopen hello samma jobb-fönstret som vi visas när vi startade hello runbook.</span><span class="sxs-lookup"><span data-stu-id="3cf06-183">You can click this job tooopen hello same Job pane that we viewed when we started hello runbook.</span></span> <span data-ttu-id="3cf06-184">Detta ger dig toogo bakåt i tiden och visa hello-information för alla jobb som har skapats för en viss runbook.</span><span class="sxs-lookup"><span data-stu-id="3cf06-184">This allows you toogo back in time and view hello details of any job that was created for a particular runbook.</span></span>

## <a name="step-5---add-authentication-toomanage-azure-resources"></a><span data-ttu-id="3cf06-185">Steg 5 – Lägg till autentisering toomanage Azure-resurser</span><span class="sxs-lookup"><span data-stu-id="3cf06-185">Step 5 - Add authentication toomanage Azure resources</span></span>
<span data-ttu-id="3cf06-186">Vi har testat och publicerat vår runbook, men hittills gör den egentligen inget användbart.</span><span class="sxs-lookup"><span data-stu-id="3cf06-186">We've tested and published our runbook, but so far it doesn't do anything useful.</span></span> <span data-ttu-id="3cf06-187">Vi vill toohave den hantera Azure-resurser.</span><span class="sxs-lookup"><span data-stu-id="3cf06-187">We want toohave it manage Azure resources.</span></span> <span data-ttu-id="3cf06-188">Du kommer inte att kunna toodo med hello-autentiseringsuppgifter som är att om vi inte autentisera kallas tooin hello [krav](#prerequisites).</span><span class="sxs-lookup"><span data-stu-id="3cf06-188">It won't be able toodo that though unless we have it authenticate using hello credentials that are referred tooin hello [prerequisites](#prerequisites).</span></span> <span data-ttu-id="3cf06-189">Vi kan göra det med hello **Add-AzureRmAccount** cmdlet.</span><span class="sxs-lookup"><span data-stu-id="3cf06-189">We do that with hello **Add-AzureRmAccount** cmdlet.</span></span>

1. <span data-ttu-id="3cf06-190">Öppna hello textrepresentation editor genom att klicka på **redigera** i hello MyFirstRunbook PowerShell-fönstret.</span><span class="sxs-lookup"><span data-stu-id="3cf06-190">Open hello textual editor by clicking **Edit** on hello MyFirstRunbook-PowerShell pane.</span></span><br><br> <span data-ttu-id="3cf06-191">![Redigera runbook](media/automation-first-runbook-textual-powershell/automation-runbook-controls-edit.png)</span><span class="sxs-lookup"><span data-stu-id="3cf06-191">![Edit Runbook](media/automation-first-runbook-textual-powershell/automation-runbook-controls-edit.png)</span></span><br>   
2. <span data-ttu-id="3cf06-192">Vi behöver inte hello **Write-Output** rad längre, och nu måste du ta bort den.</span><span class="sxs-lookup"><span data-stu-id="3cf06-192">We don't need hello **Write-Output** line anymore, so go ahead and delete it.</span></span>
3. <span data-ttu-id="3cf06-193">Skriv eller kopiera och klistra in följande kod som hanterar hello autentisering med ditt Automation kör som-konto hello:</span><span class="sxs-lookup"><span data-stu-id="3cf06-193">Type or copy and paste hello following code that handles hello authentication with your Automation Run As account:</span></span>
   
   ```
   $Conn = Get-AutomationConnection -Name AzureRunAsConnection
   Add-AzureRMAccount -ServicePrincipal -Tenant $Conn.TenantID `
   -ApplicationId $Conn.ApplicationID -CertificateThumbprint $Conn.CertificateThumbprint
   ```
   <br>
4. <span data-ttu-id="3cf06-194">Klicka på **Test fönstret** så att vi kan testa hello runbook.</span><span class="sxs-lookup"><span data-stu-id="3cf06-194">Click **Test pane** so that we can test hello runbook.</span></span>
5. <span data-ttu-id="3cf06-195">Klicka på **starta** toostart hello test.</span><span class="sxs-lookup"><span data-stu-id="3cf06-195">Click **Start** toostart hello test.</span></span> <span data-ttu-id="3cf06-196">När den är klar bör du få utdata liknande toohello efter, visa grundläggande information från ditt konto.</span><span class="sxs-lookup"><span data-stu-id="3cf06-196">Once it completes, you should receive output similar toohello following, displaying basic information from your account.</span></span> <span data-ttu-id="3cf06-197">Det här bekräftar att hello-autentiseringsuppgifter är giltiga.</span><span class="sxs-lookup"><span data-stu-id="3cf06-197">This confirms that hello credential is valid.</span></span><br><br> <span data-ttu-id="3cf06-198">![Autentisera](media/automation-first-runbook-textual-powershell/runbook-auth-output.png)</span><span class="sxs-lookup"><span data-stu-id="3cf06-198">![Authenticate](media/automation-first-runbook-textual-powershell/runbook-auth-output.png)</span></span>

## <a name="step-6---add-code-toostart-a-virtual-machine"></a><span data-ttu-id="3cf06-199">Steg 6 – Lägg till kod toostart en virtuell dator</span><span class="sxs-lookup"><span data-stu-id="3cf06-199">Step 6 - Add code toostart a virtual machine</span></span>
<span data-ttu-id="3cf06-200">Nu när våra runbook autentiseras tooour Azure-prenumeration, hanterar vi resurser.</span><span class="sxs-lookup"><span data-stu-id="3cf06-200">Now that our runbook is authenticating tooour Azure subscription, we can manage resources.</span></span> <span data-ttu-id="3cf06-201">Vi lägga till ett kommando toostart en virtuell dator.</span><span class="sxs-lookup"><span data-stu-id="3cf06-201">We add a command toostart a virtual machine.</span></span> <span data-ttu-id="3cf06-202">Du kan välja en virtuell dator i din Azure-prenumeration och nu vi kommer hårdkoda det namnet i hello runbook.</span><span class="sxs-lookup"><span data-stu-id="3cf06-202">You can pick any virtual machine in your Azure subscription, and for now we will hardcode that name in hello runbook.</span></span>

1. <span data-ttu-id="3cf06-203">Efter *Add-AzureRmAccount*, typen *Start AzureRmVM-namnet 'VMName' - ResourceGroupName 'NameofResourceGroup'* tillhandahåller hello namn och resursgruppen på hello virtuella toostart.</span><span class="sxs-lookup"><span data-stu-id="3cf06-203">After *Add-AzureRmAccount*, type *Start-AzureRmVM -Name 'VMName' -ResourceGroupName 'NameofResourceGroup'* providing hello name and Resource Group name of hello virtual machine toostart.</span></span>  
   
   ```
   $Conn = Get-AutomationConnection -Name AzureRunAsConnection
   Add-AzureRMAccount -ServicePrincipal -Tenant $Conn.TenantID `
   -ApplicationID $Conn.ApplicationID -CertificateThumbprint $Conn.CertificateThumbprint
   Start-AzureRmVM -Name 'VMName' -ResourceGroupName 'ResourceGroupName'
   ```
   <br>
2. <span data-ttu-id="3cf06-204">Spara hello runbook och klicka sedan på **Test fönstret** så att vi kan testa den.</span><span class="sxs-lookup"><span data-stu-id="3cf06-204">Save hello runbook and then click **Test pane** so that we can test it.</span></span>
3. <span data-ttu-id="3cf06-205">Klicka på **starta** toostart hello test.</span><span class="sxs-lookup"><span data-stu-id="3cf06-205">Click **Start** toostart hello test.</span></span> <span data-ttu-id="3cf06-206">När den är klar kan du kontrollera att hello den virtuella datorn har startats.</span><span class="sxs-lookup"><span data-stu-id="3cf06-206">Once it completes, check that hello virtual machine was started.</span></span>

## <a name="step-7---add-an-input-parameter-toohello-runbook"></a><span data-ttu-id="3cf06-207">Steg 7 – Lägg till en indataparameter toohello runbook</span><span class="sxs-lookup"><span data-stu-id="3cf06-207">Step 7 - Add an input parameter toohello runbook</span></span>
<span data-ttu-id="3cf06-208">Vår runbook startar hello virtuella datorn som vi hårdkodad i hello runbook, men det är mer användbar om vi ange hello virtuell dator när hello runbook startas.</span><span class="sxs-lookup"><span data-stu-id="3cf06-208">Our runbook currently starts hello virtual machine that we hardcoded in hello runbook, but it would be more useful if we specify hello virtual machine when hello runbook is started.</span></span> <span data-ttu-id="3cf06-209">Vi ska nu lägga till indataparametrar toohello runbook tooprovide funktionen.</span><span class="sxs-lookup"><span data-stu-id="3cf06-209">We will now add input parameters toohello runbook tooprovide that functionality.</span></span>

1. <span data-ttu-id="3cf06-210">Lägga till parametrar för *VMName* och *ResourceGroupName* toohello runbook och använda dessa variabler med hello **Start AzureRmVM** cmdlet som hello exemplet nedan.</span><span class="sxs-lookup"><span data-stu-id="3cf06-210">Add parameters for *VMName* and *ResourceGroupName* toohello runbook and use these variables with hello **Start-AzureRmVM** cmdlet as in hello example below.</span></span>  
   
   ```
   Param(
    [string]$VMName,
    [string]$ResourceGroupName
   )
   $Conn = Get-AutomationConnection -Name AzureRunAsConnection
   Add-AzureRMAccount -ServicePrincipal -Tenant $Conn.TenantID `
   -ApplicationID $Conn.ApplicationID -CertificateThumbprint $Conn.CertificateThumbprint
   Start-AzureRmVM -Name $VMName -ResourceGroupName $ResourceGroupName
   ```
   <br>
2. <span data-ttu-id="3cf06-211">Spara hello runbook och öppna hello Test.</span><span class="sxs-lookup"><span data-stu-id="3cf06-211">Save hello runbook and open hello Test pane.</span></span> <span data-ttu-id="3cf06-212">Du kan nu ange värden för hello två inkommande variabler som används i hello test.</span><span class="sxs-lookup"><span data-stu-id="3cf06-212">You can now provide values for hello two input variables that are used in hello test.</span></span>
3. <span data-ttu-id="3cf06-213">Stäng hello Test-fönstret.</span><span class="sxs-lookup"><span data-stu-id="3cf06-213">Close hello Test pane.</span></span>
4. <span data-ttu-id="3cf06-214">Klicka på **publicera** toopublish hello ny version av hello runbook.</span><span class="sxs-lookup"><span data-stu-id="3cf06-214">Click **Publish** toopublish hello new version of hello runbook.</span></span>
5. <span data-ttu-id="3cf06-215">Stoppa hello virtuell dator som du startade i hello föregående steg.</span><span class="sxs-lookup"><span data-stu-id="3cf06-215">Stop hello virtual machine that you started in hello previous step.</span></span>
6. <span data-ttu-id="3cf06-216">Klicka på **starta** toostart hello runbook.</span><span class="sxs-lookup"><span data-stu-id="3cf06-216">Click **Start** toostart hello runbook.</span></span> <span data-ttu-id="3cf06-217">Typen i hello **VMName** och **ResourceGroupName** för hello virtuell dator som du ska toostart.</span><span class="sxs-lookup"><span data-stu-id="3cf06-217">Type in hello **VMName** and **ResourceGroupName** for hello virtual machine that you're going toostart.</span></span><br><br> <span data-ttu-id="3cf06-218">![Skicka parameter](media/automation-first-runbook-textual-powershell/automation-pass-params.png)</span><span class="sxs-lookup"><span data-stu-id="3cf06-218">![Pass Parameter](media/automation-first-runbook-textual-powershell/automation-pass-params.png)</span></span><br>  
7. <span data-ttu-id="3cf06-219">När hello runbook är klar kontrollerar du att hello den virtuella datorn har startats.</span><span class="sxs-lookup"><span data-stu-id="3cf06-219">When hello runbook completes, check that hello virtual machine was started.</span></span>

## <a name="differences-from-powershell-workflow"></a><span data-ttu-id="3cf06-220">Skillnader från PowerShell Workflow</span><span class="sxs-lookup"><span data-stu-id="3cf06-220">Differences from PowerShell Workflow</span></span>
<span data-ttu-id="3cf06-221">PowerShell-runbooks har hello samma livscykel, funktioner och hantering av runbooks med PowerShell-arbetsflöde, men det finns vissa skillnader och begränsningar:</span><span class="sxs-lookup"><span data-stu-id="3cf06-221">PowerShell runbooks have hello same lifecycle, capabilities, and management as PowerShell Workflow runbooks but there are some differences and limitations:</span></span>

1. <span data-ttu-id="3cf06-222">PowerShell-runbooks körs snabb förhållande tooPowerShell arbetsflöde runbooks eftersom de inte har en sammanställning steg.</span><span class="sxs-lookup"><span data-stu-id="3cf06-222">PowerShell runbooks run fast compared tooPowerShell Workflow runbooks as they don’t have compilation step.</span></span>
2. <span data-ttu-id="3cf06-223">PowerShell-arbetsflöde runbooks stöd kontrollpunkter, med kontrollpunkter, PowerShell-arbetsflöde runbooks kan återupptas från valfri punkt i hello runbook medan PowerShell-runbooks kan bara återuppta från hello början.</span><span class="sxs-lookup"><span data-stu-id="3cf06-223">PowerShell Workflow runbooks support checkpoints, using checkpoints, PowerShell Workflow runbooks can resume from any point in hello runbook whereas PowerShell runbooks can only resume from hello beginning.</span></span>
3. <span data-ttu-id="3cf06-224">PowerShell Workflow-runbooks stöder parallell och seriell körning medan PowerShell-runbooks endast kan köra kommandon seriellt.</span><span class="sxs-lookup"><span data-stu-id="3cf06-224">PowerShell Workflow runbooks support parallel and serial execution whereas PowerShell runbooks can only execute commands serially.</span></span>
4. <span data-ttu-id="3cf06-225">I ett runbookflöde för ett PowerShell-arbetsflöde kan en aktivitet, ett kommando eller ett skriptblock ha sitt eget körningsutrymme, men i ett PowerShell-runbookflöde körs allt i ett skript i ett enda körningsutrymme.</span><span class="sxs-lookup"><span data-stu-id="3cf06-225">In a PowerShell Workflow runbook, an activity, a command, or a script block can have its own runspace whereas in a PowerShell runbook, everything in a script runs in a single runspace.</span></span> <span data-ttu-id="3cf06-226">Det finns även vissa [syntaktiska skillnader](https://technet.microsoft.com/magazine/dn151046.aspx) mellan en intern PowerShell-runbook och en PowerShell Workflow-runbook.</span><span class="sxs-lookup"><span data-stu-id="3cf06-226">There are also some [syntactic differences](https://technet.microsoft.com/magazine/dn151046.aspx) between a native PowerShell runbook and a PowerShell Workflow runbook.</span></span>

## <a name="next-steps"></a><span data-ttu-id="3cf06-227">Nästa steg</span><span class="sxs-lookup"><span data-stu-id="3cf06-227">Next steps</span></span>
* <span data-ttu-id="3cf06-228">tooget igång med grafiska runbooks finns [min första grafisk runbook](automation-first-runbook-graphical.md)</span><span class="sxs-lookup"><span data-stu-id="3cf06-228">tooget started with Graphical runbooks, see [My first graphical runbook](automation-first-runbook-graphical.md)</span></span>
* <span data-ttu-id="3cf06-229">tooget igång med PowerShell arbetsflöde runbooks finns [min första PowerShell-arbetsflödesrunbook](automation-first-runbook-textual.md)</span><span class="sxs-lookup"><span data-stu-id="3cf06-229">tooget started with PowerShell workflow runbooks, see [My first PowerShell workflow runbook](automation-first-runbook-textual.md)</span></span>
* <span data-ttu-id="3cf06-230">tooknow mer om runbook-typer, fördelar och begränsningar finns [typer för Azure Automation-runbook](automation-runbook-types.md)</span><span class="sxs-lookup"><span data-stu-id="3cf06-230">tooknow more about runbook types, their advantages and limitations, see [Azure Automation runbook types](automation-runbook-types.md)</span></span>
* <span data-ttu-id="3cf06-231">Mer information om PowerShell-skriptstöd finns i [Inbyggt PowerShell-skriptstöd i Azure Automation](https://azure.microsoft.com/blog/announcing-powershell-script-support-azure-automation-2/)</span><span class="sxs-lookup"><span data-stu-id="3cf06-231">For more information on PowerShell script support feature, see [Native PowerShell script support in Azure Automation](https://azure.microsoft.com/blog/announcing-powershell-script-support-azure-automation-2/)</span></span>

