---
title: aaaAzure Automation DSC kontinuerlig distribution med Chocolatey | Microsoft Docs
description: "DevOps kontinuerlig distribution med Azure Automation DSC och Chocolatey Pakethanteraren.  Exempel med fullständig JSON ARM-mallen och PowerShell-källa."
services: automation
documentationcenter: 
author: eslesar
manager: carmonm
editor: tysonn
ms.assetid: c0baa411-eb76-4f91-8d14-68f68b4805b6
ms.service: automation
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: vm-windows
ms.workload: na
ms.date: 10/29/2016
ms.author: golive
ms.openlocfilehash: 60af52af5f834fd48e3a0dc4677919397b53f0f4
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 10/06/2017
---
# <a name="usage-example-continuous-deployment-toovirtual-machines-using-automation-dsc-and-chocolatey"></a><span data-ttu-id="4417d-104">Exempel på användning: Kontinuerlig distribution tooVirtual datorer med hjälp av Automation DSC och Chocolatey</span><span class="sxs-lookup"><span data-stu-id="4417d-104">Usage Example: Continuous deployment tooVirtual Machines using Automation DSC and Chocolatey</span></span>
<span data-ttu-id="4417d-105">Det finns många verktyg tooassist med olika punkter i hello kontinuerlig Integration pipeline i en DevOps-värld.</span><span class="sxs-lookup"><span data-stu-id="4417d-105">In a DevOps world there are many tools tooassist with various points in hello Continuous Integration pipeline.</span></span>  <span data-ttu-id="4417d-106">Konfigurationen för Azure Automation önskade tillstånd (DSC) är en Välkommen nya tillägg toohello alternativ DevOps team kan använda.</span><span class="sxs-lookup"><span data-stu-id="4417d-106">Azure Automation Desired State Configuration (DSC) is a welcome new addition toohello options that DevOps teams can employ.</span></span>  <span data-ttu-id="4417d-107">Den här artikeln visar inställningen in kontinuerlig distribution (CD) för en Windows-dator.</span><span class="sxs-lookup"><span data-stu-id="4417d-107">This article demonstrates setting up Continuous Deployment (CD) for a Windows computer.</span></span>  <span data-ttu-id="4417d-108">Du kan enkelt utöka hello tekniken tooinclude så många Windows-datorer som behövs i hello roll (till exempel en webbplats) och från tooadditional roller samt.</span><span class="sxs-lookup"><span data-stu-id="4417d-108">You can easily extend hello technique tooinclude as many Windows computers as necessary in hello role (a web site, for example), and from there tooadditional roles as well.</span></span>

![Kontinuerlig distribution för IaaS-VM](./media/automation-dsc-cd-chocolatey/cdforiaasvm.png)

## <a name="at-a-high-level"></a><span data-ttu-id="4417d-110">På en hög nivå</span><span class="sxs-lookup"><span data-stu-id="4417d-110">At a high level</span></span>
<span data-ttu-id="4417d-111">Det finns lite som pågår, men som tur är det kan delas i två huvudsakliga processer:</span><span class="sxs-lookup"><span data-stu-id="4417d-111">There is quite a bit going on here, but fortunately it can be broken into two main processes:</span></span> 

* <span data-ttu-id="4417d-112">Skriva kod och testa det, skapar och publicerar installationspaket för högre och lägre version av hello system.</span><span class="sxs-lookup"><span data-stu-id="4417d-112">Writing code and testing it, then creating and publishing installation packages for major and minor versions of hello system.</span></span> 
* <span data-ttu-id="4417d-113">Skapa och hantera virtuella datorer som ska installera och köra hello kod i hello-paket.</span><span class="sxs-lookup"><span data-stu-id="4417d-113">Creating and managing VMs that will install and execute hello code in hello packages.</span></span>  

<span data-ttu-id="4417d-114">När båda dessa kärnprocesser är på plats är det ett kort steg tooautomatically hello uppdateringspaket som körs på en viss VM nya versioner skapas och distribueras.</span><span class="sxs-lookup"><span data-stu-id="4417d-114">Once both of these core processes are in place, it’s a short step tooautomatically update hello package running on any particular VM as new versions are created and deployed.</span></span>

## <a name="component-overview"></a><span data-ttu-id="4417d-115">Översikt över komponenten</span><span class="sxs-lookup"><span data-stu-id="4417d-115">Component overview</span></span>
<span data-ttu-id="4417d-116">Paketet chefer som [lgh get](https://en.wikipedia.org/wiki/Advanced_Packaging_Tool) är ganska välkända i Linux hälsningsmeddelande, men inte så mycket i Windows hälsningsmeddelande.</span><span class="sxs-lookup"><span data-stu-id="4417d-116">Package managers such as [apt-get](https://en.wikipedia.org/wiki/Advanced_Packaging_Tool) are pretty well known in hello Linux world, but not so much in hello Windows world.</span></span>  <span data-ttu-id="4417d-117">[Chocolatey](https://chocolatey.org/) sådana sak och Scott Hanselman [blogg](http://www.hanselman.com/blog/IsTheWindowsUserReadyForAptget.aspx) på hello avsnittet är en bra introduktion.</span><span class="sxs-lookup"><span data-stu-id="4417d-117">[Chocolatey](https://chocolatey.org/) is such a thing, and Scott Hanselman’s [blog](http://www.hanselman.com/blog/IsTheWindowsUserReadyForAptget.aspx) on hello topic is a great intro.</span></span>  <span data-ttu-id="4417d-118">I kort sagt kan kan Chocolatey du tooinstall paket från en central databas av paket i en Windows-dator med hjälp av kommandoraden hello.</span><span class="sxs-lookup"><span data-stu-id="4417d-118">In a nutshell, Chocolatey allows you tooinstall packages from a central repository of packages into a Windows system using hello command line.</span></span>  <span data-ttu-id="4417d-119">Du kan skapa och hantera egna databasen och Chocolatey kan installera paket från valfritt antal databaser som du har angett.</span><span class="sxs-lookup"><span data-stu-id="4417d-119">You can create and manage your own repository, and Chocolatey can install packages from any number of repositories that you designate.</span></span>

<span data-ttu-id="4417d-120">Desired Configuration tillstånd (DSC) ([översikt](https://technet.microsoft.com/library/dn249912.aspx)) är ett PowerShell-verktyg som gör att du toodeclare hello konfiguration som du vill använda för en dator.</span><span class="sxs-lookup"><span data-stu-id="4417d-120">Desired State Configuration (DSC) ([overview](https://technet.microsoft.com/library/dn249912.aspx)) is a PowerShell tool that allows you toodeclare hello configuration that you want for a machine.</span></span>  <span data-ttu-id="4417d-121">Anta exempelvis att du kan, ”jag vill Chocolatey installerad, jag vill att IIS har installerats, jag vill öppna port 80, jag vill 1.0.0 på webbplatsen installerade versionen”.</span><span class="sxs-lookup"><span data-stu-id="4417d-121">For example, you can say, “I want Chocolatey installed, I want IIS installed, I want port 80 opened, I want version 1.0.0 of my website installed.”</span></span>  <span data-ttu-id="4417d-122">hello DSC Local Configuration Manager implementerar (MGM) denna konfiguration.</span><span class="sxs-lookup"><span data-stu-id="4417d-122">hello DSC Local Configuration Manager (LCM) implements that configuration.</span></span> <span data-ttu-id="4417d-123">En DSC Pull-Server innehåller en databas av konfigurationer för dina datorer.</span><span class="sxs-lookup"><span data-stu-id="4417d-123">A DSC Pull Server holds a repository of configurations for your machines.</span></span> <span data-ttu-id="4417d-124">hello MGM på varje dator kontrollerar i regelbundet toosee om dess konfiguration matchar hello lagrade konfigurationen.</span><span class="sxs-lookup"><span data-stu-id="4417d-124">hello LCM on each machine checks in periodically toosee if its configuration matches hello stored configuration.</span></span> <span data-ttu-id="4417d-125">Det kan rapportera status eller försök toobring hello datorn tillbaka till anpassningen hello lagrade konfigurationen.</span><span class="sxs-lookup"><span data-stu-id="4417d-125">It can either report status or attempt toobring hello machine back into alignment with hello stored configuration.</span></span> <span data-ttu-id="4417d-126">Du kan redigera hello lagrade konfigurationen på hello pull server toocause en dator eller en uppsättning datorer toocome till justering med hello ändrat konfigurationen.</span><span class="sxs-lookup"><span data-stu-id="4417d-126">You can edit hello stored configuration on hello pull server toocause a machine or set of machines toocome into alignment with hello changed configuration.</span></span>

<span data-ttu-id="4417d-127">Azure Automation är en hanterad tjänst i Microsoft Azure som gör att du tooautomate olika uppgifter med hjälp av runbooks, noder, autentiseringsuppgifter, resurser och resurser, t.ex scheman och globala variabler.</span><span class="sxs-lookup"><span data-stu-id="4417d-127">Azure Automation is a managed service in Microsoft Azure that allows you tooautomate various tasks using runbooks, nodes, credentials, resources and assets such as schedules and global variables.</span></span> <span data-ttu-id="4417d-128">Azure Automation DSC utökar denna automatisering kapaciteten tooinclude PowerShell DSC-verktyg.</span><span class="sxs-lookup"><span data-stu-id="4417d-128">Azure Automation DSC extends this automation capability tooinclude PowerShell DSC tools.</span></span>  <span data-ttu-id="4417d-129">Här är en bra [översikt](automation-dsc-overview.md).</span><span class="sxs-lookup"><span data-stu-id="4417d-129">Here’s a great [overview](automation-dsc-overview.md).</span></span>

<span data-ttu-id="4417d-130">En DSC-resurs är en modul av kod som har specifika funktioner, t.ex hantering av nätverk, Active Directory eller SQL Server.</span><span class="sxs-lookup"><span data-stu-id="4417d-130">A DSC Resource is a module of code that has specific capabilities, such as managing networking, Active Directory, or SQL Server.</span></span>  <span data-ttu-id="4417d-131">Hej Chocolatey DSC-resurs vet hur tooaccess en NuGet-Server (bland annat) ladda ned paket, installera paket och så vidare.</span><span class="sxs-lookup"><span data-stu-id="4417d-131">hello Chocolatey DSC Resource knows how tooaccess a NuGet Server (among others), download packages, install packages, and so on.</span></span>  <span data-ttu-id="4417d-132">Det finns många andra DSC-resurser i hello [PowerShell-galleriet](http://www.powershellgallery.com/packages?q=dsc+resources&prerelease=&sortOrder=package-title).</span><span class="sxs-lookup"><span data-stu-id="4417d-132">There are many other DSC Resources in hello [PowerShell Gallery](http://www.powershellgallery.com/packages?q=dsc+resources&prerelease=&sortOrder=package-title).</span></span>  <span data-ttu-id="4417d-133">Dessa moduler är installerade i Azure Automation DSC Pull-servern (av du) så att de kan användas av dina konfigurationer.</span><span class="sxs-lookup"><span data-stu-id="4417d-133">These modules are installed into your Azure Automation DSC Pull Server (by you) so they can be used by your configurations.</span></span>

<span data-ttu-id="4417d-134">Resource Manager-mallar tillhandahåller en deklarativ metod för att skapa din infrastruktur – till exempel nätverk, undernät, nätverkssäkerhet och routning, läsa in belastningsutjämning, nätverkskort, virtuella datorer och så vidare.</span><span class="sxs-lookup"><span data-stu-id="4417d-134">Resource Manager templates provide a declarative way of generating your infrastructure - things like networks, subnets, network security and routing, load balancers, NICs, VMs, and so on.</span></span>  <span data-ttu-id="4417d-135">Här är en [artikel](../azure-resource-manager/resource-manager-deployment-model.md) att jämför hello Resource Manager-modellen (deklarativ) med hello Azure Service Management (ASM eller klassisk) distribution modellen (tvingande) och beskriver hello core resurs providers, beräkning, lagring och nätverk.</span><span class="sxs-lookup"><span data-stu-id="4417d-135">Here’s an [article](../azure-resource-manager/resource-manager-deployment-model.md) that compares hello Resource Manager deployment model (declarative) with hello Azure Service Management (ASM, or classic) deployment model (imperative), and discusses hello core resource providers, compute, storage and network.</span></span>

<span data-ttu-id="4417d-136">En nyckelfunktion i Resource Manager-mall är dess möjlighet tooinstall VM-tillägget i hello VM eftersom den har etablerats.</span><span class="sxs-lookup"><span data-stu-id="4417d-136">One key feature of an Resource Manager template is its ability tooinstall a VM extension into hello VM as it’s provisioned.</span></span>  <span data-ttu-id="4417d-137">En VM-tillägget har specifika funktioner, till exempel använda ett anpassat skript, installera antivirusprogram eller ett DSC-konfigurationsskript.</span><span class="sxs-lookup"><span data-stu-id="4417d-137">A VM extension has specific capabilities such as running a custom script, installing anti-virus software, or running a DSC configuration script.</span></span>  <span data-ttu-id="4417d-138">Det finns många andra typer av VM-tillägg.</span><span class="sxs-lookup"><span data-stu-id="4417d-138">There are many other types of VM extensions.</span></span>

## <a name="quick-trip-around-hello-diagram"></a><span data-ttu-id="4417d-139">Snabb kommunikation runt hello diagram</span><span class="sxs-lookup"><span data-stu-id="4417d-139">Quick trip around hello diagram</span></span>
<span data-ttu-id="4417d-140">Startar hello överst du skriva koden, skapa, testa och sedan skapa ett installationspaket.</span><span class="sxs-lookup"><span data-stu-id="4417d-140">Starting at hello top, you write your code, build and test, then create an installation package.</span></span>  <span data-ttu-id="4417d-141">Chocolatey kan hantera olika typer av installationspaket, till exempel MSI MSU, ZIP.</span><span class="sxs-lookup"><span data-stu-id="4417d-141">Chocolatey can handle various types of installation packages, such as MSI, MSU, ZIP.</span></span>  <span data-ttu-id="4417d-142">Och du har hello alla fördelar med PowerShell toodo hello verklig installation om Chocolateys inbyggda funktioner som inte är helt upp tooit.</span><span class="sxs-lookup"><span data-stu-id="4417d-142">And you have hello full power of PowerShell toodo hello actual installation if Chocolatey’s native capabilities aren’t quite up tooit.</span></span>  <span data-ttu-id="4417d-143">Placera hello paketet i okänd nås – en paket-databas.</span><span class="sxs-lookup"><span data-stu-id="4417d-143">Put hello package into someplace reachable – a package repository.</span></span>  <span data-ttu-id="4417d-144">Det här exemplet användning använder en offentlig mapp i ett Azure blob storage-konto, men det kan finnas var som helst.</span><span class="sxs-lookup"><span data-stu-id="4417d-144">This usage example uses a public folder in an Azure blob storage account, but it can be anywhere.</span></span>  <span data-ttu-id="4417d-145">Chocolatey fungerar internt med NuGet-servrar och några andra för hantering av paketmetadata.</span><span class="sxs-lookup"><span data-stu-id="4417d-145">Chocolatey works natively with NuGet servers and a few others for management of package metadata.</span></span>  <span data-ttu-id="4417d-146">[Den här artikeln](https://github.com/chocolatey/choco/wiki/How-To-Host-Feed) beskrivs hello alternativ.</span><span class="sxs-lookup"><span data-stu-id="4417d-146">[This article](https://github.com/chocolatey/choco/wiki/How-To-Host-Feed) describes hello options.</span></span>  <span data-ttu-id="4417d-147">Det här exemplet användning använder NuGet.</span><span class="sxs-lookup"><span data-stu-id="4417d-147">This usage example uses NuGet.</span></span>  <span data-ttu-id="4417d-148">En Nuspec är metadata om dina paket.</span><span class="sxs-lookup"><span data-stu-id="4417d-148">A Nuspec is metadata about your packages.</span></span>  <span data-ttu-id="4417d-149">Hej Nuspec ”kompileras” till Nupkgs och lagras i en NuGet-server.</span><span class="sxs-lookup"><span data-stu-id="4417d-149">hello Nuspec’s are “compiled” into NuPkg’s and stored in a NuGet server.</span></span>  <span data-ttu-id="4417d-150">När konfigurationen av begäranden i ett paket med namnet och refererar till en NuGet-server, hämtar hello paketet hello Chocolatey DSC-resurs (nu på hello VM) och installerar du.</span><span class="sxs-lookup"><span data-stu-id="4417d-150">When your configuration requests a package by name, and references a NuGet server, hello Chocolatey DSC Resource (now on hello VM) grabs hello package and installs it for you.</span></span>  <span data-ttu-id="4417d-151">Du kan också begära en viss version av ett paket.</span><span class="sxs-lookup"><span data-stu-id="4417d-151">You can also request a specific version of a package.</span></span>

<span data-ttu-id="4417d-152">Hello nedre vänstra hörnet i hello bild finns det en mall för Azure Resource Manager (ARM).</span><span class="sxs-lookup"><span data-stu-id="4417d-152">In hello bottom left portion of hello picture, there is an Azure Resource Manager (ARM) template.</span></span>  <span data-ttu-id="4417d-153">I det här exemplet användning registrerar hello VM-tillägget hello VM med hello Hämtningsservern för Azure Automation DSC (det vill säga en pull-server) som en nod.</span><span class="sxs-lookup"><span data-stu-id="4417d-153">In this usage example, hello VM extension registers hello VM with hello Azure Automation DSC Pull Server (that is, a pull server) as a Node.</span></span>  <span data-ttu-id="4417d-154">hello konfigurationen lagras i hello pull-server.</span><span class="sxs-lookup"><span data-stu-id="4417d-154">hello configuration is stored in hello pull server.</span></span>  <span data-ttu-id="4417d-155">Faktiskt, lagras två gånger: en gång i klartext och när kompilerats som en MOF-fil (för de vet om sådant.)  Hello-portalen är hello MOF ”nodkonfiguration” (som skillnad från toosimply ”configuration”).</span><span class="sxs-lookup"><span data-stu-id="4417d-155">Actually, it’s stored twice: once as plain text and once compiled as an MOF file (for those that know about such things.)  In hello portal, hello MOF is a “node configuration” (as opposed toosimply “configuration”).</span></span>  <span data-ttu-id="4417d-156">Dess hello artefakt som är associerad med en nod så hello nod vet dess konfiguration.</span><span class="sxs-lookup"><span data-stu-id="4417d-156">It’s hello artifact that’s associated with a Node so hello node will know its configuration.</span></span>  <span data-ttu-id="4417d-157">Informationen nedan visar hur tooassign hello nod configuration toohello nod.</span><span class="sxs-lookup"><span data-stu-id="4417d-157">Details below show how tooassign hello node configuration toohello node.</span></span>

<span data-ttu-id="4417d-158">Förmodligen gör du redan hello bitars hello överst eller de flesta av den.</span><span class="sxs-lookup"><span data-stu-id="4417d-158">Presumably you’re already doing hello bit at hello top, or most of it.</span></span>  <span data-ttu-id="4417d-159">Skapa hello nuspec, kompilering och lagra det i en NuGet-server är en liten sak.</span><span class="sxs-lookup"><span data-stu-id="4417d-159">Creating hello nuspec, compiling and storing it in a NuGet server is a small thing.</span></span>  <span data-ttu-id="4417d-160">Och du hanterar redan virtuella datorer.</span><span class="sxs-lookup"><span data-stu-id="4417d-160">And you’re already managing VMs.</span></span>  <span data-ttu-id="4417d-161">Tar hello nästa steg toocontinuous distribution kräver ställer in hello pull-server (en gång), registrerar noderna med den (en gång), och skapa och lagra det hello-konfiguration (först).</span><span class="sxs-lookup"><span data-stu-id="4417d-161">Taking hello next step toocontinuous deployment requires setting up hello pull server (once), registering your nodes with it (once), and creating and storing hello configuration there (initially).</span></span>  <span data-ttu-id="4417d-162">Uppdatera sedan som paket som uppgraderas och distribueras toohello databasen hello konfiguration och konfiguration av noden i hello pull-server (Upprepa efter behov).</span><span class="sxs-lookup"><span data-stu-id="4417d-162">Then as packages are upgraded and deployed toohello repository, refresh hello Configuration and Node Configuration in hello pull server (repeat as needed).</span></span>

<span data-ttu-id="4417d-163">Om du inte behöver börja med en ARM-mall, är det också OK.</span><span class="sxs-lookup"><span data-stu-id="4417d-163">If you’re not starting with an ARM template, that’s also OK.</span></span>  <span data-ttu-id="4417d-164">Det finns PowerShell cmdlets som är utformade toohelp du registrera dina virtuella datorer med hello pull-server och alla hello rest.</span><span class="sxs-lookup"><span data-stu-id="4417d-164">There are PowerShell cmdlets designed toohelp you register your VMs with hello pull server and all of hello rest.</span></span> <span data-ttu-id="4417d-165">Mer information finns i den här artikeln: [Onboarding datorer för hantering av Azure Automation DSC](automation-dsc-onboarding.md)</span><span class="sxs-lookup"><span data-stu-id="4417d-165">For more details, see this article: [Onboarding machines for management by Azure Automation DSC](automation-dsc-onboarding.md)</span></span>

## <a name="step-1-setting-up-hello-pull-server-and-automation-account"></a><span data-ttu-id="4417d-166">Steg 1: Konfigurera hello pull-servern och automation-konto</span><span class="sxs-lookup"><span data-stu-id="4417d-166">Step 1: Setting up hello pull server and automation account</span></span>
<span data-ttu-id="4417d-167">Vid en autentiserad (Add-AzureRmAccount) PowerShell-kommandorad: (kan ta några minuter innan hello pull-server har konfigurerats)</span><span class="sxs-lookup"><span data-stu-id="4417d-167">At an authenticated (Add-AzureRmAccount) PowerShell command line:  (can take a few minutes while hello pull server is set up)</span></span>

    New-AzureRmResourceGroup –Name MY-AUTOMATION-RG –Location MY-RG-LOCATION-IN-QUOTES
    New-AzureRmAutomationAccount –ResourceGroupName MY-AUTOMATION-RG –Location MY-RG-LOCATION-IN-QUOTES –Name MY-AUTOMATION-ACCOUNT 

<span data-ttu-id="4417d-168">Du kan placera ditt automation-konto till någon av hello följande regioner (aka plats): östra USA 2, södra centrala USA, oss Gov Virginia, Västeuropa, Sydostasien, östra, centrala Indien och Australien-sydost, Kanada Central, Norra Europa.</span><span class="sxs-lookup"><span data-stu-id="4417d-168">You can put your automation account into any of hello following regions (aka location):  East US 2, South Central US, US Gov Virginia, West Europe, Southeast Asia, Japan East, Central India and Australia Southeast, Canada Central, North Europe.</span></span>

## <a name="step-2-vm-extension-tweaks-toohello-arm-template"></a><span data-ttu-id="4417d-169">Steg 2: VM-tillägget justeringar toohello ARM-mall</span><span class="sxs-lookup"><span data-stu-id="4417d-169">Step 2: VM extension tweaks toohello ARM template</span></span>
<span data-ttu-id="4417d-170">Information för VM-registrering (med hello PowerShell DSC VM-tillägget) i det här [Azure Quickstart mallen](https://github.com/Azure/azure-quickstart-templates/tree/master/dsc-extension-azure-automation-pullserver).</span><span class="sxs-lookup"><span data-stu-id="4417d-170">Details for VM registration (using hello PowerShell DSC VM extension) provided in this [Azure Quickstart Template](https://github.com/Azure/azure-quickstart-templates/tree/master/dsc-extension-azure-automation-pullserver).</span></span>  <span data-ttu-id="4417d-171">Det här steget registrerar den nya virtuella datorn med hello hämtningsservern i hello lista över DSC-noder.</span><span class="sxs-lookup"><span data-stu-id="4417d-171">This step registers your new VM with hello pull server in hello list of DSC Nodes.</span></span>  <span data-ttu-id="4417d-172">En del av denna registrering är att ange hello nod configuration toobe tillämpas toohello nod.</span><span class="sxs-lookup"><span data-stu-id="4417d-172">Part of this registration is specifying hello node configuration toobe applied toohello node.</span></span>  <span data-ttu-id="4417d-173">Konfiguration av den här noden inte redan har tooexist i hello pull-servern så att det är OK steg 4 är där detta är klar för hello första gången.</span><span class="sxs-lookup"><span data-stu-id="4417d-173">This node configuration doesn't have tooexist yet in hello pull server, so it's OK that Step 4 is where this is done for hello first time.</span></span>  <span data-ttu-id="4417d-174">Men här i steg 2 behöver toohave bestämt hello namn för hello nod och hello på hello konfiguration.</span><span class="sxs-lookup"><span data-stu-id="4417d-174">But here in Step 2 you do need toohave decided hello name of hello node and hello name of hello configuration.</span></span>  <span data-ttu-id="4417d-175">I det här exemplet användning hello nod är 'isvbox' och hello konfigurationen är 'ISVBoxConfig'.</span><span class="sxs-lookup"><span data-stu-id="4417d-175">In this usage example, hello node is 'isvbox' and hello configuration is 'ISVBoxConfig'.</span></span>  <span data-ttu-id="4417d-176">Hej nodkonfigurationsnamnet (toobe anges i DeploymentTemplate.json) är därför 'ISVBoxConfig.isvbox'.</span><span class="sxs-lookup"><span data-stu-id="4417d-176">So hello node configuration name (toobe specified in DeploymentTemplate.json) is 'ISVBoxConfig.isvbox'.</span></span>  

## <a name="step-3-adding-required-dsc-resources-toohello-pull-server"></a><span data-ttu-id="4417d-177">Steg 3: Lägga till nödvändiga resurser toohello hämtningsservern DSC</span><span class="sxs-lookup"><span data-stu-id="4417d-177">Step 3: Adding required DSC resources toohello pull server</span></span>
<span data-ttu-id="4417d-178">hello PowerShell-galleriet är instrumenterade tooinstall DSC-resurser i Azure Automation-konto.</span><span class="sxs-lookup"><span data-stu-id="4417d-178">hello PowerShell Gallery is instrumented tooinstall DSC resources into your Azure Automation account.</span></span>  <span data-ttu-id="4417d-179">Navigera toohello resurs du vill använda och klicka på hello ”distribuera tooAzure Automation”.</span><span class="sxs-lookup"><span data-stu-id="4417d-179">Navigate toohello resource you want and click hello “Deploy tooAzure Automation” button.</span></span>

![PowerShell-galleriet exempel](./media/automation-dsc-cd-chocolatey/xNetworking.PNG)

<span data-ttu-id="4417d-181">En annan metod nyligen lagt till toohello Azure-portalen kan du toopull i nya moduler eller uppdatera befintliga moduler.</span><span class="sxs-lookup"><span data-stu-id="4417d-181">Another technique recently added toohello Azure Portal allows you toopull in new modules or update existing modules.</span></span> <span data-ttu-id="4417d-182">Klicka dig igenom hello Automation-konto resurs hello tillgångar panelen och slutligen hello moduler panelen.</span><span class="sxs-lookup"><span data-stu-id="4417d-182">Click through hello Automation Account resource, hello Assets tile, and finally hello Modules tile.</span></span>  <span data-ttu-id="4417d-183">hello Bläddra galleriet ikonen kan du toosee hello lista med moduler i hello-galleriet, detaljnivån information och slutligen importera till ditt Automation-konto.</span><span class="sxs-lookup"><span data-stu-id="4417d-183">hello Browse Gallery icon allows you toosee hello list of modules in hello gallery, drill down into details and ultimately import into your Automation Account.</span></span> <span data-ttu-id="4417d-184">Detta är ett bra sätt tookeep modulerna in toodate från tid tootime.</span><span class="sxs-lookup"><span data-stu-id="4417d-184">This is a great way tookeep your modules up toodate from time tootime.</span></span> <span data-ttu-id="4417d-185">Och hello importfunktionen kontrollerar beroenden med andra moduler tooensure ingenting hämtar synkroniserad.</span><span class="sxs-lookup"><span data-stu-id="4417d-185">And, hello import feature checks dependencies with other modules tooensure nothing gets out of sync.</span></span>

<span data-ttu-id="4417d-186">Eller så har hello manuell metod.</span><span class="sxs-lookup"><span data-stu-id="4417d-186">Or, there’s hello manual approach.</span></span>  <span data-ttu-id="4417d-187">hello mappstruktur för en PowerShell-modul för integrering för en Windows-dator skiljer sig något från hello mappstrukturen förväntades av hello Azure Automation.</span><span class="sxs-lookup"><span data-stu-id="4417d-187">hello folder structure of a PowerShell Integration Module for a Windows computer is a little different from hello folder structure expected by hello Azure Automation.</span></span>  <span data-ttu-id="4417d-188">Detta kräver lite modifiera från din sida.</span><span class="sxs-lookup"><span data-stu-id="4417d-188">This requires a little tweaking on your part.</span></span>  <span data-ttu-id="4417d-189">Men det är inte svårt och det görs bara en gång per resurs (såvida du inte vill tooupgrade den i framtiden.)  Mer information om redigering av PowerShell integreringsmoduler finns i den här artikeln: [redigering integreringsmoduler för Azure Automation](https://azure.microsoft.com/blog/authoring-integration-modules-for-azure-automation/)</span><span class="sxs-lookup"><span data-stu-id="4417d-189">But it’s not hard, and it’s done only once per resource (unless you want tooupgrade it in future.)  For more information on authoring PowerShell Integration Modules, see this article: [Authoring Integration Modules for Azure Automation](https://azure.microsoft.com/blog/authoring-integration-modules-for-azure-automation/)</span></span>

* <span data-ttu-id="4417d-190">Installera hello-modul som du behöver på din arbetsstation, enligt följande:</span><span class="sxs-lookup"><span data-stu-id="4417d-190">Install hello module that you need on your workstation, as follows:</span></span>
  * <span data-ttu-id="4417d-191">Installera [Windows Management Framework, v5](http://aka.ms/wmf5latest) (behövs inte för Windows 10)</span><span class="sxs-lookup"><span data-stu-id="4417d-191">Install [Windows Management Framework, v5](http://aka.ms/wmf5latest) (not needed for Windows 10)</span></span>
  * <span data-ttu-id="4417d-192">`Install-Module –Name MODULE-NAME`< – grabs hello modul från hello PowerShell-galleriet</span><span class="sxs-lookup"><span data-stu-id="4417d-192">`Install-Module –Name MODULE-NAME`    <—grabs hello module from hello PowerShell Gallery</span></span> 
* <span data-ttu-id="4417d-193">Kopiera hello modulen mapp från `c:\Program Files\WindowsPowerShell\Modules\MODULE-NAME` tooa tillfällig mapp</span><span class="sxs-lookup"><span data-stu-id="4417d-193">Copy hello module folder from `c:\Program Files\WindowsPowerShell\Modules\MODULE-NAME` tooa temp folder</span></span> 
* <span data-ttu-id="4417d-194">Ta bort exempel och dokumentation från hello huvudsakliga mappen</span><span class="sxs-lookup"><span data-stu-id="4417d-194">Delete samples and documentation from hello main folder</span></span> 
* <span data-ttu-id="4417d-195">Komprimerad hello huvudsakliga mapp hello naming hello ZIP-filen exakt samma som hello mapp</span><span class="sxs-lookup"><span data-stu-id="4417d-195">Zip hello main folder, naming hello ZIP file exactly hello same as hello folder</span></span> 
* <span data-ttu-id="4417d-196">Placera hello ZIP-filen i en HTTP-plats som kan nås, till exempel blob-lagring i Azure Storage-konto.</span><span class="sxs-lookup"><span data-stu-id="4417d-196">Put hello ZIP file into a reachable HTTP location, such as blob storage in an Azure Storage Account.</span></span>
* <span data-ttu-id="4417d-197">Kör följande PowerShell:</span><span class="sxs-lookup"><span data-stu-id="4417d-197">Run this PowerShell:</span></span>
  
      New-AzureRmAutomationModule `
          -ResourceGroupName MY-AUTOMATION-RG -AutomationAccountName MY-AUTOMATION-ACCOUNT `
          -Name MODULE-NAME –ContentLink "https://STORAGE-URI/CONTAINERNAME/MODULE-NAME.zip"

<span data-ttu-id="4417d-198">hello ingår exempel utför de här stegen för cChoco och xNetworking.</span><span class="sxs-lookup"><span data-stu-id="4417d-198">hello included example performs these steps for cChoco and xNetworking.</span></span> <span data-ttu-id="4417d-199">Se hello [anteckningar](#notes) för särskild hantering för cChoco.</span><span class="sxs-lookup"><span data-stu-id="4417d-199">See hello [Notes](#notes) for special handling for cChoco.</span></span>

## <a name="step-4-adding-hello-node-configuration-toohello-pull-server"></a><span data-ttu-id="4417d-200">Steg 4: Lägga till hello nod configuration toohello pull-server</span><span class="sxs-lookup"><span data-stu-id="4417d-200">Step 4: Adding hello node configuration toohello pull server</span></span>
<span data-ttu-id="4417d-201">Det finns inget särskilt om hello första gången du importera konfigurationen till hello hämtningsservern och kompilering.</span><span class="sxs-lookup"><span data-stu-id="4417d-201">There’s nothing special about hello first time you import your configuration into hello pull server and compile.</span></span>  <span data-ttu-id="4417d-202">Alla efterföljande import/kompilerar av hello samma konfiguration utseende exakt hello samma.</span><span class="sxs-lookup"><span data-stu-id="4417d-202">All subsequent import/compiles of hello same configuration look exactly hello same.</span></span>  <span data-ttu-id="4417d-203">Varje gång du uppdaterar paketet och behöver toopush ut tooproduction du göra det här steget när du har säkerställt hello konfigurationsfilen är korrekt – inklusive hello ny version av paketet.</span><span class="sxs-lookup"><span data-stu-id="4417d-203">Each time you update your package and need toopush it out tooproduction you do this step after ensuring hello configuration file is correct – including hello new version of your package.</span></span>  <span data-ttu-id="4417d-204">Här är hello konfigurationsfilen och PowerShell:</span><span class="sxs-lookup"><span data-stu-id="4417d-204">Here’s hello configuration file and PowerShell:</span></span>

<span data-ttu-id="4417d-205">ISVBoxConfig.ps1:</span><span class="sxs-lookup"><span data-stu-id="4417d-205">ISVBoxConfig.ps1:</span></span>

    Configuration ISVBoxConfig 
    { 
        Import-DscResource -ModuleName cChoco 
        Import-DscResource -ModuleName xNetworking

        Node "isvbox" {   

            cChocoInstaller installChoco 
            { 
                InstallDir = "C:\choco" 
            }

            WindowsFeature installIIS 
            { 
                Ensure="Present" 
                Name="Web-Server" 
            }

            xFirewall WebFirewallRule 
            { 
                Direction = "Inbound" 
                Name = "Web-Server-TCP-In" 
                DisplayName = "Web Server (TCP-In)" 
                Description = "IIS allow incoming web site traffic." 
                DisplayGroup = "IIS Incoming Traffic" 
                State = "Enabled" 
                Access = "Allow" 
                Protocol = "TCP" 
                LocalPort = "80" 
                Ensure = "Present" 
            }

            cChocoPackageInstaller trivialWeb 
            {            
                Name = "trivialweb" 
                Version = "1.0.0" 
                Source = “MY-NUGET-V2-SERVER-ADDRESS” 
                DependsOn = "[cChocoInstaller]installChoco", 
                "[WindowsFeature]installIIS" 
            } 
        }    
    }

<span data-ttu-id="4417d-206">Nya-ConfigurationScript.ps1:</span><span class="sxs-lookup"><span data-stu-id="4417d-206">New-ConfigurationScript.ps1:</span></span>

    Import-AzureRmAutomationDscConfiguration ` 
        -ResourceGroupName MY-AUTOMATION-RG –AutomationAccountName MY-AUTOMATION-ACCOUNT ` 
        -SourcePath C:\temp\AzureAutomationDsc\ISVBoxConfig.ps1 ` 
        -Published –Force

    $jobData = Start-AzureRmAutomationDscCompilationJob ` 
        -ResourceGroupName MY-AUTOMATION-RG –AutomationAccountName MY-AUTOMATION-ACCOUNT ` 
        -ConfigurationName ISVBoxConfig 

    $compilationJobId = $jobData.Id

    Get-AzureRmAutomationDscCompilationJob ` 
        -ResourceGroupName MY-AUTOMATION-RG –AutomationAccountName MY-AUTOMATION-ACCOUNT ` 
        -Id $compilationJobId

<span data-ttu-id="4417d-207">Dessa steg resultera i en ny konfiguration av noden med namnet ”ISVBoxConfig.isvbox” Hej hämtningsservern placeras.</span><span class="sxs-lookup"><span data-stu-id="4417d-207">These steps result in a new node configuration named “ISVBoxConfig.isvbox” being placed on hello pull server.</span></span>  <span data-ttu-id="4417d-208">namn på konfigurationsnod hello bygger som ”configurationName.nodeName”.</span><span class="sxs-lookup"><span data-stu-id="4417d-208">hello node configuration name is built as “configurationName.nodeName”.</span></span>

## <a name="step-5-creating-and-maintaining-package-metadata"></a><span data-ttu-id="4417d-209">Steg 5: Skapa och underhålla paketmetadata</span><span class="sxs-lookup"><span data-stu-id="4417d-209">Step 5: Creating and maintaining package metadata</span></span>
<span data-ttu-id="4417d-210">För varje paket du föra in hello paketdatabasen, behöver du en nuspec som beskriver den.</span><span class="sxs-lookup"><span data-stu-id="4417d-210">For each package that you put into hello package repository, you need a nuspec that describes it.</span></span>  <span data-ttu-id="4417d-211">Den nuspec måste kompileras och lagras i NuGet-server.</span><span class="sxs-lookup"><span data-stu-id="4417d-211">That nuspec must be compiled and stored in your NuGet server.</span></span> <span data-ttu-id="4417d-212">Den här processen beskrivs [här](http://docs.nuget.org/create/creating-and-publishing-a-package).</span><span class="sxs-lookup"><span data-stu-id="4417d-212">This process is described [here](http://docs.nuget.org/create/creating-and-publishing-a-package).</span></span>  <span data-ttu-id="4417d-213">Du kan använda MyGet.org som en NuGet-server.</span><span class="sxs-lookup"><span data-stu-id="4417d-213">You can use MyGet.org as a NuGet server.</span></span>  <span data-ttu-id="4417d-214">De sälja den här tjänsten, men har en starter SKU som är ledigt.</span><span class="sxs-lookup"><span data-stu-id="4417d-214">They sell this service, but have a starter SKU that’s free.</span></span>  <span data-ttu-id="4417d-215">Vid NuGet.org hittar du anvisningar om hur du installerar en egen NuGet-server för dina privata paket.</span><span class="sxs-lookup"><span data-stu-id="4417d-215">At NuGet.org you’ll find instructions on installing your own NuGet server for your private packages.</span></span>

## <a name="step-6-tying-it-all-together"></a><span data-ttu-id="4417d-216">Steg 6: Binda alla ihop</span><span class="sxs-lookup"><span data-stu-id="4417d-216">Step 6: Tying it all together</span></span>
<span data-ttu-id="4417d-217">Varje gång en version skickar QA och har godkänts för distribution, hello paketet skapas, nuspec och nupkg uppdateras och distribuerat toohello NuGet-servern.</span><span class="sxs-lookup"><span data-stu-id="4417d-217">Each time a version passes QA and is approved for deployment, hello package is created, nuspec and nupkg updated and deployed toohello NuGet server.</span></span>  <span data-ttu-id="4417d-218">Hello konfigurationen (steg 4 ovan) måste dessutom vara uppdaterade tooagree med hello nytt versionsnummer.</span><span class="sxs-lookup"><span data-stu-id="4417d-218">In addition, hello configuration (Step 4 above) must be updated tooagree with hello new version number.</span></span>  <span data-ttu-id="4417d-219">Det måste skickas toohello hämtningsservern och kompileras.</span><span class="sxs-lookup"><span data-stu-id="4417d-219">It must be sent toohello pull server and compiled.</span></span>  <span data-ttu-id="4417d-220">Från den punkten på är det toohello virtuella datorer som är beroende av att konfigurationen toopull hello update och installera den.</span><span class="sxs-lookup"><span data-stu-id="4417d-220">From that point on, it's up toohello VMs that depend on that configuration toopull hello update and install it.</span></span>  <span data-ttu-id="4417d-221">Var och en av de här uppdateringarna är enkla - bara en eller två rader i PowerShell.</span><span class="sxs-lookup"><span data-stu-id="4417d-221">Each of these updates are simple - just a line or two of PowerShell.</span></span>  <span data-ttu-id="4417d-222">Några av dem är inkapslade i build-uppgifter som kan sammankopplas i en version i Visual Studio Team Services hello fallet.</span><span class="sxs-lookup"><span data-stu-id="4417d-222">In hello case of Visual Studio Team Services, some of them are encapsulated in build tasks that can be chained together in a build.</span></span>  <span data-ttu-id="4417d-223">Detta [artikel](https://www.visualstudio.com/en-us/docs/alm-devops-feature-index#continuous-delivery) innehåller mer information.</span><span class="sxs-lookup"><span data-stu-id="4417d-223">This [article](https://www.visualstudio.com/en-us/docs/alm-devops-feature-index#continuous-delivery) provides more details.</span></span>  <span data-ttu-id="4417d-224">Detta [GitHub-repo-](https://github.com/Microsoft/vso-agent-tasks) information hello olika tillgängliga build-uppgifter.</span><span class="sxs-lookup"><span data-stu-id="4417d-224">This [GitHub repo](https://github.com/Microsoft/vso-agent-tasks) details hello various available build tasks.</span></span>

## <a name="notes"></a><span data-ttu-id="4417d-225">Anteckningar</span><span class="sxs-lookup"><span data-stu-id="4417d-225">Notes</span></span>
<span data-ttu-id="4417d-226">Det här exemplet för användning som börjar med en virtuell dator från en allmän Windows Server 2012 R2-avbildning från hello Azure-galleriet.</span><span class="sxs-lookup"><span data-stu-id="4417d-226">This usage example starts with a VM from a generic Windows Server 2012 R2 image from hello Azure gallery.</span></span>  <span data-ttu-id="4417d-227">Du kan starta från en lagrad bild och sedan justera därifrån med hello DSC-konfigurationen.</span><span class="sxs-lookup"><span data-stu-id="4417d-227">You can start from any stored image and then tweak from there with hello DSC configuration.</span></span>  <span data-ttu-id="4417d-228">Ändra konfiguration som är inbyggd i en bild är dock mycket svårare än hello-konfiguration som använder DSC uppdateras dynamiskt.</span><span class="sxs-lookup"><span data-stu-id="4417d-228">However, changing configuration that is baked into an image is much harder than dynamically updating hello configuration using DSC.</span></span>

<span data-ttu-id="4417d-229">Du har inte toouse en ARM-mall och hello VM-tillägget toouse den här tekniken med dina virtuella datorer.</span><span class="sxs-lookup"><span data-stu-id="4417d-229">You don’t have toouse an ARM template and hello VM extension toouse this technique with your VMs.</span></span>  <span data-ttu-id="4417d-230">Och dina virtuella datorer har inte toobe på Azure toobe CD: N hanteras.</span><span class="sxs-lookup"><span data-stu-id="4417d-230">And your VMs don’t have toobe on Azure toobe under CD management.</span></span>  <span data-ttu-id="4417d-231">Allt som krävs är att Chocolatey installeras och hello MGM konfigurerats på hello VM så att den vet var hello hämtningsservern finns.</span><span class="sxs-lookup"><span data-stu-id="4417d-231">All that’s necessary is that Chocolatey be installed and hello LCM configured on hello VM so it knows where hello pull server is.</span></span>  

<span data-ttu-id="4417d-232">Naturligtvis när du uppdaterar ett paket på en virtuell dator som är i produktion, måste tootake den virtuella datorn utanför rotation medan hello uppdateringen är installerad.</span><span class="sxs-lookup"><span data-stu-id="4417d-232">Of course, when you update a package on a VM that’s in production, you need tootake that VM out of rotation while hello update is installed.</span></span>  <span data-ttu-id="4417d-233">Hur du gör detta varierar mycket.</span><span class="sxs-lookup"><span data-stu-id="4417d-233">How you do this varies widely.</span></span>  <span data-ttu-id="4417d-234">Till exempel med en virtuell dator bakom en belastningsutjämnare i Azure, du kan lägga till en anpassad avsökning.</span><span class="sxs-lookup"><span data-stu-id="4417d-234">For example, with a VM behind an Azure Load Balancer, you can add a Custom Probe.</span></span>  <span data-ttu-id="4417d-235">När du uppdaterar hello VM har hello avsökningen endpoint returnera en 400.</span><span class="sxs-lookup"><span data-stu-id="4417d-235">While updating hello VM, have hello probe endpoint return a 400.</span></span>  <span data-ttu-id="4417d-236">hello justera nödvändiga toocause den här ändringen kan vara i din konfiguration som kan hello justera tooswitch tillbaka tooreturning en 200 när hello uppdateringen är klar.</span><span class="sxs-lookup"><span data-stu-id="4417d-236">hello tweak necessary toocause this change can be inside your configuration, as can hello tweak tooswitch it back tooreturning a 200 once hello update is complete.</span></span>

<span data-ttu-id="4417d-237">Fullständig källan för det här exemplet för användning finns i [Visual Studio-projekt](https://github.com/sebastus/ARM/tree/master/CDIaaSVM) på GitHub.</span><span class="sxs-lookup"><span data-stu-id="4417d-237">Full source for this usage example is in [this Visual Studio project](https://github.com/sebastus/ARM/tree/master/CDIaaSVM) on GitHub.</span></span>

## <a name="related-articles"></a><span data-ttu-id="4417d-238">Relaterade artiklar</span><span class="sxs-lookup"><span data-stu-id="4417d-238">Related Articles</span></span>
* [<span data-ttu-id="4417d-239">Azure Automation DSC-översikt</span><span class="sxs-lookup"><span data-stu-id="4417d-239">Azure Automation DSC Overview</span></span>](automation-dsc-overview.md)
* [<span data-ttu-id="4417d-240">Azure Automation DSC-cmdlets</span><span class="sxs-lookup"><span data-stu-id="4417d-240">Azure Automation DSC cmdlets</span></span>](https://msdn.microsoft.com/library/mt244122.aspx)
* [<span data-ttu-id="4417d-241">Onboarding-datorer för hantering av Azure Automation DSC</span><span class="sxs-lookup"><span data-stu-id="4417d-241">Onboarding machines for management by Azure Automation DSC</span></span>](automation-dsc-onboarding.md)

