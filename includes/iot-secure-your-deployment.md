# <a name="secure-your-iot-deployment"></a><span data-ttu-id="3d381-101">Skydda distributionen av IoT</span><span class="sxs-lookup"><span data-stu-id="3d381-101">Secure your IoT deployment</span></span>
<span data-ttu-id="3d381-102">Den här artikeln innehåller nästa detaljnivå för att skydda Azure IoT-baserade Sakernas Internet (IoT)-infrastruktur.</span><span class="sxs-lookup"><span data-stu-id="3d381-102">This article provides the next level of detail for securing the Azure IoT-based Internet of Things (IoT) infrastructure.</span></span> <span data-ttu-id="3d381-103">Den länkar till implementeringsinformation för att konfigurera och distribuera varje komponent.</span><span class="sxs-lookup"><span data-stu-id="3d381-103">It links to implementation level details for configuring and deploying each component.</span></span> <span data-ttu-id="3d381-104">Det ger också jämförelser och val mellan olika konkurrerande metoder.</span><span class="sxs-lookup"><span data-stu-id="3d381-104">It also provides comparisons and choices between various competing methods.</span></span>

<span data-ttu-id="3d381-105">Säkra Azure IoT-distributionen kan delas in i följande tre områden:</span><span class="sxs-lookup"><span data-stu-id="3d381-105">Securing the Azure IoT deployment can be divided into the following three security areas:</span></span>

* <span data-ttu-id="3d381-106">**Enheternas säkerhet**: skydda IoT-enhet när den har distribuerats i jokertecken.</span><span class="sxs-lookup"><span data-stu-id="3d381-106">**Device Security**: Securing the IoT device while it is deployed in the wild.</span></span>
* <span data-ttu-id="3d381-107">**Anslutningssäkerhet**: säkerställer att alla data som överförs mellan IoT-enhet och IoT-hubben är konfidentiellt och förfalska.</span><span class="sxs-lookup"><span data-stu-id="3d381-107">**Connection Security**: Ensuring all data transmitted between the IoT device and IoT Hub is confidential and tamper-proof.</span></span>
* <span data-ttu-id="3d381-108">**Cloud Security**: ge möjligheter att säkra data medan den går genom och lagras i molnet.</span><span class="sxs-lookup"><span data-stu-id="3d381-108">**Cloud Security**: Providing a means to secure data while it moves through, and is stored in the cloud.</span></span>

![Tre säkerhetsområden][img-overview]

## <a name="secure-device-provisioning-and-authentication"></a><span data-ttu-id="3d381-110">Säker enhetsetableringen och autentisering</span><span class="sxs-lookup"><span data-stu-id="3d381-110">Secure device provisioning and authentication</span></span>
<span data-ttu-id="3d381-111">Azure IoT Suite skyddar IoT-enheter med hjälp av följande två metoder:</span><span class="sxs-lookup"><span data-stu-id="3d381-111">The Azure IoT Suite secures IoT devices by the following two methods:</span></span>

* <span data-ttu-id="3d381-112">Genom att tillhandahålla en unik identitetsnyckel (säkerhetstoken) för varje enhet som kan användas av enheten kommunicerar med IoT-hubben.</span><span class="sxs-lookup"><span data-stu-id="3d381-112">By providing a unique identity key (security tokens) for each device, which can be used by the device to communicate with the IoT Hub.</span></span>
* <span data-ttu-id="3d381-113">Med hjälp av en på enhet [X.509-certifikat] [ lnk-x509] och den privata nyckeln som ett sätt att autentisera enheten till IoT-hubben.</span><span class="sxs-lookup"><span data-stu-id="3d381-113">By using an on-device [X.509 certificate][lnk-x509] and private key as a means to authenticate the device to the IoT Hub.</span></span> <span data-ttu-id="3d381-114">Den här autentiseringsmetoden garanterar att den privata nyckeln på enheten inte är känd utanför enheten när som helst, vilket ger en högre säkerhetsnivå.</span><span class="sxs-lookup"><span data-stu-id="3d381-114">This authentication method ensures that the private key on the device is not known outside the device at any time, providing a higher level of security.</span></span>

<span data-ttu-id="3d381-115">Token säkerhetsmetod ger autentisering för varje anrop som görs av enheten IoT-hubb genom att associera den symmetriska nyckeln till varje anrop.</span><span class="sxs-lookup"><span data-stu-id="3d381-115">The security token method provides authentication for each call made by the device to IoT Hub by associating the symmetric key to each call.</span></span> <span data-ttu-id="3d381-116">X.509-baserad autentisering tillåter autentisering för en IoT-enhet på det fysiska skiktet som en del av TLS-anslutningen upprättas.</span><span class="sxs-lookup"><span data-stu-id="3d381-116">X.509-based authentication allows authentication of an IoT device at the physical layer as part of the TLS connection establishment.</span></span> <span data-ttu-id="3d381-117">Säkerhets-token-baserade-metoden kan användas utan X.509-autentisering som är ett mindre säkert mönster.</span><span class="sxs-lookup"><span data-stu-id="3d381-117">The security-token-based method can be used without the X.509 authentication which is a less secure pattern.</span></span> <span data-ttu-id="3d381-118">Valet mellan de två metoderna beror i första hand hur säker enhet autentisering måste vara och tillgänglighet för säker lagring på enheten (för att lagra den privata nyckeln säkert).</span><span class="sxs-lookup"><span data-stu-id="3d381-118">The choice between the two methods is primarily dictated by how secure the device authentication needs to be, and availability of secure storage on the device (to store the private key securely).</span></span>

## <a name="iot-hub-security-tokens"></a><span data-ttu-id="3d381-119">Säkerhetstoken i IoT Hub</span><span class="sxs-lookup"><span data-stu-id="3d381-119">IoT Hub security tokens</span></span>
<span data-ttu-id="3d381-120">IoT-hubb använder säkerhetstoken för att autentisera enheter och tjänster för att undvika att skicka nycklar i nätverket.</span><span class="sxs-lookup"><span data-stu-id="3d381-120">IoT Hub uses security tokens to authenticate devices and services to avoid sending keys on the network.</span></span> <span data-ttu-id="3d381-121">Dessutom är säkerhetstoken begränsad giltighetstid och omfång.</span><span class="sxs-lookup"><span data-stu-id="3d381-121">Additionally, security tokens are limited in time validity and scope.</span></span> <span data-ttu-id="3d381-122">Azure IoT-SDK: er generera automatiskt token utan någon specialkonfiguration.</span><span class="sxs-lookup"><span data-stu-id="3d381-122">Azure IoT SDKs automatically generate tokens without requiring any special configuration.</span></span> <span data-ttu-id="3d381-123">Vissa scenarier, men användaren att skapa och använda säkerhetstoken direkt.</span><span class="sxs-lookup"><span data-stu-id="3d381-123">Some scenarios, however, require the user to generate and use security tokens directly.</span></span> <span data-ttu-id="3d381-124">Dessa inkluderar direkt användning av de MQTT, AMQP och HTTP- eller implementeringen av tokentjänsten mönstret.</span><span class="sxs-lookup"><span data-stu-id="3d381-124">These include the direct use of the MQTT, AMQP, or HTTP surfaces, or the implementation of the token service pattern.</span></span>

<span data-ttu-id="3d381-125">Mer information om strukturen för säkerhetstoken och användning finns i följande artiklar:</span><span class="sxs-lookup"><span data-stu-id="3d381-125">More details on the structure of the security token and its usage can be found in the following articles:</span></span>

* <span data-ttu-id="3d381-126">[Säkerhet token struktur][lnk-security-tokens]</span><span class="sxs-lookup"><span data-stu-id="3d381-126">[Security token structure][lnk-security-tokens]</span></span>
* <span data-ttu-id="3d381-127">[Med hjälp av SAS-token som en enhet][lnk-sas-tokens]</span><span class="sxs-lookup"><span data-stu-id="3d381-127">[Using SAS tokens as a device][lnk-sas-tokens]</span></span>

<span data-ttu-id="3d381-128">Varje IoT-hubben har en [identitetsregistret] [ lnk-identity-registry] som kan användas för att skapa per enhet resurser i tjänsten, till exempel en kö som innehåller relä moln till enhet meddelanden och att tillåta åtkomst till enheten riktade slutpunkter.</span><span class="sxs-lookup"><span data-stu-id="3d381-128">Each IoT Hub has an [identity registry][lnk-identity-registry] that can be used to create per-device resources in the service, such as a queue that contains in-flight cloud-to-device messages, and to allow access to the device-facing endpoints.</span></span> <span data-ttu-id="3d381-129">IoT-hubb identitetsregistret ger säker lagring av enheten identiteter och säkerhetsnycklar för en lösning.</span><span class="sxs-lookup"><span data-stu-id="3d381-129">The IoT Hub identity registry provides secure storage of device identities and security keys for a solution.</span></span> <span data-ttu-id="3d381-130">En eller flera enheter identiteter kan läggas till en lista över tillåtna eller blockerade webbplatser, aktivera fullständig kontroll över enheten.</span><span class="sxs-lookup"><span data-stu-id="3d381-130">Individual or groups of device identities can be added to an allow list, or a block list, enabling complete control over device access.</span></span> <span data-ttu-id="3d381-131">I följande artiklar innehåller mer information om strukturen i identitetsregistret och de åtgärder som stöds.</span><span class="sxs-lookup"><span data-stu-id="3d381-131">The following articles provide more details on the structure of the identity registry and supported operations.</span></span>

<span data-ttu-id="3d381-132">[IoT-hubb stöder till exempel MQTT, AMQP och HTTP-protokoll][lnk-protocols].</span><span class="sxs-lookup"><span data-stu-id="3d381-132">[IoT Hub supports protocols such as MQTT, AMQP, and HTTP][lnk-protocols].</span></span> <span data-ttu-id="3d381-133">Var och en av dessa protokoll använder säkerhetstoken från IoT-enhet till IoT-hubb på olika sätt:</span><span class="sxs-lookup"><span data-stu-id="3d381-133">Each of these protocols use security tokens from the IoT device to IoT Hub differently:</span></span>

* <span data-ttu-id="3d381-134">AMQP: SASL vanlig AMQP anspråksbaserad säkerhet och ({policyName}@sas.root. { iothubName} för IoT-hubb-nivå token; {deviceId} vid enheten omfång token).</span><span class="sxs-lookup"><span data-stu-id="3d381-134">AMQP: SASL PLAIN and AMQP Claims-based security ({policyName}@sas.root.{iothubName} in the case of IoT hub-level tokens; {deviceId} in case of device-scoped tokens).</span></span>
* <span data-ttu-id="3d381-135">MQTT: Anslut paket använder {deviceId} som {ClientId}, {IoThubhostname} / {deviceId} i den **användarnamn** fältet och en SAS-token i den **lösenord** fältet.</span><span class="sxs-lookup"><span data-stu-id="3d381-135">MQTT: CONNECT packet uses {deviceId} as the {ClientId}, {IoThubhostname}/{deviceId} in the **Username** field and a SAS token in the **Password** field.</span></span>
* <span data-ttu-id="3d381-136">HTTP: Är giltig token i auktoriseringshuvudet för begäran.</span><span class="sxs-lookup"><span data-stu-id="3d381-136">HTTP: Valid token is in the authorization request header.</span></span>

<span data-ttu-id="3d381-137">IoT-hubb identitetsregistret kan användas för att konfigurera per enhet säkerhetsreferenser och åtkomstkontroll.</span><span class="sxs-lookup"><span data-stu-id="3d381-137">IoT Hub identity registry can be used to configure per-device security credentials and access control.</span></span> <span data-ttu-id="3d381-138">Men om en IoT-lösningen har redan en betydande investering i en [anpassade identitet registret och/eller autentisering schemat][lnk-custom-auth], kan integreras i en befintlig infrastruktur med IoT-hubben genom att skapa en token tjänst.</span><span class="sxs-lookup"><span data-stu-id="3d381-138">However, if an IoT solution already has a significant investment in a [custom device identity registry and/or authentication scheme][lnk-custom-auth], it can be integrated into an existing infrastructure with IoT Hub by creating a token service.</span></span>

### <a name="x509-certificate-based-device-authentication"></a><span data-ttu-id="3d381-139">X.509 certifikatbaserad autentisering</span><span class="sxs-lookup"><span data-stu-id="3d381-139">X.509 certificate-based device authentication</span></span>
<span data-ttu-id="3d381-140">Användning av en [enhetsbaserad X.509-certifikat] [ lnk-use-x509] och dess associerade privata och offentliga nyckelpar tillåter ytterligare autentisering på det fysiska skiktet.</span><span class="sxs-lookup"><span data-stu-id="3d381-140">The use of a [device-based X.509 certificate][lnk-use-x509] and its associated private and public key pair allows additional authentication at the physical layer.</span></span> <span data-ttu-id="3d381-141">Den privata nyckeln lagras på ett säkert sätt i enheten och är inte kan upptäckas utanför enheten.</span><span class="sxs-lookup"><span data-stu-id="3d381-141">The private key is stored securely in the device and is not discoverable outside the device.</span></span> <span data-ttu-id="3d381-142">X.509-certifikat innehåller information om enhet, till exempel enhets-ID och andra organisatoriska information.</span><span class="sxs-lookup"><span data-stu-id="3d381-142">The X.509 certificate contains information about the device, such as device ID, and other organizational details.</span></span> <span data-ttu-id="3d381-143">En signatur för certifikatet skapas med hjälp av den privata nyckeln.</span><span class="sxs-lookup"><span data-stu-id="3d381-143">A signature of the certificate is generated by using the private key.</span></span>

<span data-ttu-id="3d381-144">Övergripande enheten etablering flöde:</span><span class="sxs-lookup"><span data-stu-id="3d381-144">High-level device provisioning flow:</span></span>

* <span data-ttu-id="3d381-145">Associera en identifierare för en fysisk enhet – enhetsidentitet och/eller X.509-certifikat som är kopplade till enheten under enhet tillverkar eller idriftsättning.</span><span class="sxs-lookup"><span data-stu-id="3d381-145">Associate an identifier to a physical device – device identity and/or X.509 certificate associated to the device during device manufacturing or commissioning.</span></span>
* <span data-ttu-id="3d381-146">Skapa en motsvarande identity-transaktion i IoT-hubb – enhetsidentitet och associerade enhetsinformation i IoT-hubb identitetsregistret.</span><span class="sxs-lookup"><span data-stu-id="3d381-146">Create a corresponding identity entry in IoT Hub – device identity and associated device information in the IoT Hub identity registry.</span></span>
* <span data-ttu-id="3d381-147">Tumavtrycket för X.509-certifikatet lagras säkert i IoT-hubb identitetsregistret.</span><span class="sxs-lookup"><span data-stu-id="3d381-147">Securely store X.509 certificate thumbprint in IoT Hub identity registry.</span></span>

### <a name="root-certificate-on-device"></a><span data-ttu-id="3d381-148">Rotcertifikatet på enheter</span><span class="sxs-lookup"><span data-stu-id="3d381-148">Root certificate on device</span></span>
<span data-ttu-id="3d381-149">När du upprättar en säker TLS-anslutning med IoT-hubben autentiserar IoT-enhet IoT-hubb med ett rotcertifikat som är en del av enheten SDK.</span><span class="sxs-lookup"><span data-stu-id="3d381-149">While establishing a secure TLS connection with IoT Hub, the IoT device authenticates IoT Hub using a root certificate which is part of the device SDK.</span></span> <span data-ttu-id="3d381-150">För C klient-SDK certifikatet finns i mappen ”\\c\\certifikat” under roten av lagringsplatsen.</span><span class="sxs-lookup"><span data-stu-id="3d381-150">For the C client SDK the certificate is located under the folder "\\c\\certs" under the root of the repo.</span></span> <span data-ttu-id="3d381-151">Även om dessa rotcertifikat är långlivade, kan de fortfarande eller upphöra att gälla.</span><span class="sxs-lookup"><span data-stu-id="3d381-151">Though these root certificates are long-lived, they still may expire or be revoked.</span></span> <span data-ttu-id="3d381-152">Om det inte går att uppdatera certifikatet på enheten, kan enheten inte därefter ansluta till IoT-hubb (eller någon annan molntjänst).</span><span class="sxs-lookup"><span data-stu-id="3d381-152">If there is no way of updating the certificate on the device, the device may not be able to subsequently connect to the IoT Hub (or any other cloud service).</span></span> <span data-ttu-id="3d381-153">Med ett sätt att uppdatera rotcertifikatet när IoT-enhet har distribuerats kommer ett effektivt sätt att minska denna risk.</span><span class="sxs-lookup"><span data-stu-id="3d381-153">Having a means to update the root certificate once the IoT device is deployed will effectively mitigate this risk.</span></span>

## <a name="securing-the-connection"></a><span data-ttu-id="3d381-154">Att säkra anslutningen</span><span class="sxs-lookup"><span data-stu-id="3d381-154">Securing the connection</span></span>
<span data-ttu-id="3d381-155">Internet-anslutning mellan IoT-enhet och IoT-hubb skyddas med Transport Layer Security (TLS)-standard.</span><span class="sxs-lookup"><span data-stu-id="3d381-155">Internet connection between the IoT device and IoT Hub is secured using the Transport Layer Security (TLS) standard.</span></span> <span data-ttu-id="3d381-156">Azure IoT stöder [TLS 1.2][lnk-tls12], TLS 1.1 och TLS 1.0 i den här ordningen.</span><span class="sxs-lookup"><span data-stu-id="3d381-156">Azure IoT supports [TLS 1.2][lnk-tls12], TLS 1.1 and TLS 1.0, in this order.</span></span> <span data-ttu-id="3d381-157">Stöd för TLS 1.0 tillhandahålls endast för bakåtkompatibilitet.</span><span class="sxs-lookup"><span data-stu-id="3d381-157">Support for TLS 1.0 is provided for backward compatibility only.</span></span> <span data-ttu-id="3d381-158">Det rekommenderas att använda TLS 1.2 eftersom det ger bäst skydd.</span><span class="sxs-lookup"><span data-stu-id="3d381-158">It is recommended to use TLS 1.2 since it provides the most security.</span></span>

<span data-ttu-id="3d381-159">Azure IoT Suite stöder följande krypteringssviter i den här ordningen.</span><span class="sxs-lookup"><span data-stu-id="3d381-159">Azure IoT Suite supports the following Cipher Suites, in this order.</span></span>

| <span data-ttu-id="3d381-160">Chiffersvit</span><span class="sxs-lookup"><span data-stu-id="3d381-160">Cipher Suite</span></span> | <span data-ttu-id="3d381-161">Längd</span><span class="sxs-lookup"><span data-stu-id="3d381-161">Length</span></span> |
| --- | --- |
| <span data-ttu-id="3d381-162">TLS\_ECDHE\_RSA\_WITH\_AES\_256\_CBC\_SHA384 (0xc028) ECDH secp384r1 (eq.</span><span class="sxs-lookup"><span data-stu-id="3d381-162">TLS\_ECDHE\_RSA\_WITH\_AES\_256\_CBC\_SHA384 (0xc028) ECDH secp384r1 (eq.</span></span> <span data-ttu-id="3d381-163">FS 7680 bitar RSA)</span><span class="sxs-lookup"><span data-stu-id="3d381-163">7680 bits RSA) FS</span></span> |<span data-ttu-id="3d381-164">256</span><span class="sxs-lookup"><span data-stu-id="3d381-164">256</span></span> |
| <span data-ttu-id="3d381-165">TLS\_ECDHE\_RSA\_WITH\_AES\_128\_CBC\_SHA256 (0xc027) ECDH secp256r1 (eq.</span><span class="sxs-lookup"><span data-stu-id="3d381-165">TLS\_ECDHE\_RSA\_WITH\_AES\_128\_CBC\_SHA256 (0xc027) ECDH secp256r1 (eq.</span></span> <span data-ttu-id="3d381-166">FS 3072 bitar RSA)</span><span class="sxs-lookup"><span data-stu-id="3d381-166">3072 bits RSA) FS</span></span> |<span data-ttu-id="3d381-167">128</span><span class="sxs-lookup"><span data-stu-id="3d381-167">128</span></span> |
| <span data-ttu-id="3d381-168">TLS\_ECDHE\_RSA\_WITH\_AES\_256\_CBC\_SHA (0xc014) ECDH secp384r1 (eq.</span><span class="sxs-lookup"><span data-stu-id="3d381-168">TLS\_ECDHE\_RSA\_WITH\_AES\_256\_CBC\_SHA (0xc014) ECDH secp384r1 (eq.</span></span> <span data-ttu-id="3d381-169">FS 7680 bitar RSA)</span><span class="sxs-lookup"><span data-stu-id="3d381-169">7680 bits RSA) FS</span></span> |<span data-ttu-id="3d381-170">256</span><span class="sxs-lookup"><span data-stu-id="3d381-170">256</span></span> |
| <span data-ttu-id="3d381-171">TLS\_ECDHE\_RSA\_WITH\_AES\_128\_CBC\_SHA (0xc013) ECDH secp256r1 (eq.</span><span class="sxs-lookup"><span data-stu-id="3d381-171">TLS\_ECDHE\_RSA\_WITH\_AES\_128\_CBC\_SHA (0xc013) ECDH secp256r1 (eq.</span></span> <span data-ttu-id="3d381-172">FS 3072 bitar RSA)</span><span class="sxs-lookup"><span data-stu-id="3d381-172">3072 bits RSA) FS</span></span> |<span data-ttu-id="3d381-173">128</span><span class="sxs-lookup"><span data-stu-id="3d381-173">128</span></span> |
| <span data-ttu-id="3d381-174">TLS\_RSA\_WITH\_AES\_256\_GCM\_SHA384 (0x9d)</span><span class="sxs-lookup"><span data-stu-id="3d381-174">TLS\_RSA\_WITH\_AES\_256\_GCM\_SHA384 (0x9d)</span></span> |<span data-ttu-id="3d381-175">256</span><span class="sxs-lookup"><span data-stu-id="3d381-175">256</span></span> |
| <span data-ttu-id="3d381-176">TLS\_RSA\_WITH\_AES\_128\_GCM\_SHA256 (0x9c)</span><span class="sxs-lookup"><span data-stu-id="3d381-176">TLS\_RSA\_WITH\_AES\_128\_GCM\_SHA256 (0x9c)</span></span> |<span data-ttu-id="3d381-177">128</span><span class="sxs-lookup"><span data-stu-id="3d381-177">128</span></span> |
| <span data-ttu-id="3d381-178">TLS\_RSA\_WITH\_AES\_256\_CBC\_SHA256 (0x3d)</span><span class="sxs-lookup"><span data-stu-id="3d381-178">TLS\_RSA\_WITH\_AES\_256\_CBC\_SHA256 (0x3d)</span></span> |<span data-ttu-id="3d381-179">256</span><span class="sxs-lookup"><span data-stu-id="3d381-179">256</span></span> |
| <span data-ttu-id="3d381-180">TLS\_RSA\_WITH\_AES\_128\_CBC\_SHA256 (0x3c)</span><span class="sxs-lookup"><span data-stu-id="3d381-180">TLS\_RSA\_WITH\_AES\_128\_CBC\_SHA256 (0x3c)</span></span> |<span data-ttu-id="3d381-181">128</span><span class="sxs-lookup"><span data-stu-id="3d381-181">128</span></span> |
| <span data-ttu-id="3d381-182">TLS\_RSA\_WITH\_AES\_256\_CBC\_SHA (0x35)</span><span class="sxs-lookup"><span data-stu-id="3d381-182">TLS\_RSA\_WITH\_AES\_256\_CBC\_SHA (0x35)</span></span> |<span data-ttu-id="3d381-183">256</span><span class="sxs-lookup"><span data-stu-id="3d381-183">256</span></span> |
| <span data-ttu-id="3d381-184">TLS\_RSA\_WITH\_AES\_128\_CBC\_SHA (0x2f)</span><span class="sxs-lookup"><span data-stu-id="3d381-184">TLS\_RSA\_WITH\_AES\_128\_CBC\_SHA (0x2f)</span></span> |<span data-ttu-id="3d381-185">128</span><span class="sxs-lookup"><span data-stu-id="3d381-185">128</span></span> |
| <span data-ttu-id="3d381-186">TLS\_RSA\_WITH\_3DES\_Nederländerna\_CBC\_SHA (0xa)</span><span class="sxs-lookup"><span data-stu-id="3d381-186">TLS\_RSA\_WITH\_3DES\_EDE\_CBC\_SHA (0xa)</span></span> |<span data-ttu-id="3d381-187">112</span><span class="sxs-lookup"><span data-stu-id="3d381-187">112</span></span> |

## <a name="securing-the-cloud"></a><span data-ttu-id="3d381-188">Skydda molnet</span><span class="sxs-lookup"><span data-stu-id="3d381-188">Securing the cloud</span></span>
<span data-ttu-id="3d381-189">Azure IoT-hubb tillåter definition av [åtkomstprinciper kontrollen] [ lnk-protocols] för varje säkerhetsnyckel.</span><span class="sxs-lookup"><span data-stu-id="3d381-189">Azure IoT Hub allows definition of [access control policies][lnk-protocols] for each security key.</span></span> <span data-ttu-id="3d381-190">Följande uppsättning behörigheter som används för att bevilja åtkomst till var och en av IoT-hubb slutpunkter.</span><span class="sxs-lookup"><span data-stu-id="3d381-190">It uses the following set of permissions to grant access to each of IoT Hub's endpoints.</span></span> <span data-ttu-id="3d381-191">Behörigheter som begränsar åtkomsten till en IoT-hubb som baseras på funktionen.</span><span class="sxs-lookup"><span data-stu-id="3d381-191">Permissions limit the access to an IoT Hub based on functionality.</span></span>

* <span data-ttu-id="3d381-192">**RegistryRead**.</span><span class="sxs-lookup"><span data-stu-id="3d381-192">**RegistryRead**.</span></span> <span data-ttu-id="3d381-193">Ger läsbehörighet till identitetsregistret.</span><span class="sxs-lookup"><span data-stu-id="3d381-193">Grants read access to the identity registry.</span></span> <span data-ttu-id="3d381-194">Mer information finns i [identitetsregistret][lnk-identity-registry].</span><span class="sxs-lookup"><span data-stu-id="3d381-194">For more information, see [identity registry][lnk-identity-registry].</span></span>
* <span data-ttu-id="3d381-195">**RegistryReadWrite**.</span><span class="sxs-lookup"><span data-stu-id="3d381-195">**RegistryReadWrite**.</span></span> <span data-ttu-id="3d381-196">Ger Läs- och skrivåtkomst till identitetsregistret.</span><span class="sxs-lookup"><span data-stu-id="3d381-196">Grants read and write access to the identity registry.</span></span> <span data-ttu-id="3d381-197">Mer information finns i [identitetsregistret][lnk-identity-registry].</span><span class="sxs-lookup"><span data-stu-id="3d381-197">For more information, see [identity registry][lnk-identity-registry].</span></span>
* <span data-ttu-id="3d381-198">**ServiceConnect**.</span><span class="sxs-lookup"><span data-stu-id="3d381-198">**ServiceConnect**.</span></span> <span data-ttu-id="3d381-199">Ger åtkomst till cloud service-kommunikation och övervakning av slutpunkter.</span><span class="sxs-lookup"><span data-stu-id="3d381-199">Grants access to cloud service-facing communication and monitoring endpoints.</span></span> <span data-ttu-id="3d381-200">Till exempel ger den behörighet till backend-molntjänster att ta emot meddelanden från enhet till moln, skicka meddelanden moln till enhet och hämta motsvarande leverans bekräftelser.</span><span class="sxs-lookup"><span data-stu-id="3d381-200">For example, it grants permission to back-end cloud services to receive device-to-cloud messages, send cloud-to-device messages, and retrieve the corresponding delivery acknowledgments.</span></span>
* <span data-ttu-id="3d381-201">**DeviceConnect**.</span><span class="sxs-lookup"><span data-stu-id="3d381-201">**DeviceConnect**.</span></span> <span data-ttu-id="3d381-202">Ger åtkomst till enheten riktade slutpunkter.</span><span class="sxs-lookup"><span data-stu-id="3d381-202">Grants access to device-facing endpoints.</span></span> <span data-ttu-id="3d381-203">Det ger till exempel behörighet att skicka meddelanden från enhet till moln och ta emot meddelanden moln till enhet.</span><span class="sxs-lookup"><span data-stu-id="3d381-203">For example, it grants permission to send device-to-cloud messages and receive cloud-to-device messages.</span></span> <span data-ttu-id="3d381-204">Den här behörigheten används av enheter.</span><span class="sxs-lookup"><span data-stu-id="3d381-204">This permission is used by devices.</span></span>

<span data-ttu-id="3d381-205">Det finns två sätt att hämta **DeviceConnect** behörigheter med IoT-hubb med [säkerhetstoken][lnk-sas-tokens]: med identitetsnyckel en enhet eller en nyckel för delad åtkomst.</span><span class="sxs-lookup"><span data-stu-id="3d381-205">There are two ways to obtain **DeviceConnect** permissions with IoT Hub with [security tokens][lnk-sas-tokens]: using a device identity key, or a shared access key.</span></span> <span data-ttu-id="3d381-206">Dessutom är det viktigt att Observera att alla funktioner som är tillgängliga från enheter exponeras avsiktligt på slutpunkter med prefixet `/devices/{deviceId}`.</span><span class="sxs-lookup"><span data-stu-id="3d381-206">Moreover, it is important to note that all functionality accessible from devices is exposed by design on endpoints with prefix `/devices/{deviceId}`.</span></span>

<span data-ttu-id="3d381-207">[Tjänstens komponenter kan bara generera säkerhetstoken] [ lnk-service-tokens] använder delad åtkomstprinciper som beviljar behörighet.</span><span class="sxs-lookup"><span data-stu-id="3d381-207">[Service components can only generate security tokens][lnk-service-tokens] using shared access policies granting the appropriate permissions.</span></span>

<span data-ttu-id="3d381-208">Azure IoT-hubb och andra tjänster som kan vara en del av lösningen kan hantering av användare med Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="3d381-208">Azure IoT Hub and other services which may be part of the solution allow management of users using the Azure Active Directory.</span></span>

<span data-ttu-id="3d381-209">Data som inhämtas av Azure IoT-hubb kan användas av en mängd olika tjänster, till exempel Azure Stream Analytics och Azure-blobblagring.</span><span class="sxs-lookup"><span data-stu-id="3d381-209">Data ingested by Azure IoT Hub can be consumed by a variety of services such as Azure Stream Analytics and Azure blob storage.</span></span> <span data-ttu-id="3d381-210">Dessa tjänster tillåta åtkomst.</span><span class="sxs-lookup"><span data-stu-id="3d381-210">These services allow management access.</span></span> <span data-ttu-id="3d381-211">Läs mer om dessa tjänster och alternativen nedan:</span><span class="sxs-lookup"><span data-stu-id="3d381-211">Read more about these services and available options below:</span></span>

* <span data-ttu-id="3d381-212">[Azure DocumentDB][lnk-docdb]: en skalbar, -indexerat databastjänst för halvstrukturerade data som hanterar metadata för enheterna som du etablerar, till exempel attribut, konfiguration och egenskaper för säkerhetsbehörighet.</span><span class="sxs-lookup"><span data-stu-id="3d381-212">[Azure DocumentDB][lnk-docdb]: A scalable, fully-indexed database service for semi-structured data that manages metadata for the devices you provision, such as attributes, configuration, and security properties.</span></span> <span data-ttu-id="3d381-213">DocumentDB ger hög prestanda och hög genomströmning bearbetning, schema-oberoende indexering av data och en omfattande SQL-gränssnitt.</span><span class="sxs-lookup"><span data-stu-id="3d381-213">DocumentDB offers high-performance and high-throughput processing, schema-agnostic indexing of data, and a rich SQL query interface.</span></span>
* <span data-ttu-id="3d381-214">[Azure Stream Analytics][lnk-asa]: realtid dataströmmen som bearbetas i molnet som gör att du kan snabbt utveckla och distribuera en billig analytics lösning för att upptäcka realtidsinsikter från enheter, sensorer, infrastruktur och program.</span><span class="sxs-lookup"><span data-stu-id="3d381-214">[Azure Stream Analytics][lnk-asa]: Real-time stream processing in the cloud that enables you to rapidly develop and deploy a low-cost analytics solution to uncover real-time insights from devices, sensors, infrastructure, and applications.</span></span> <span data-ttu-id="3d381-215">Data från den här fullständigt hanterade tjänsten kan skalas till någon volym och ändå upprätthålla högt genomflöde, låg latens och återhämtning.</span><span class="sxs-lookup"><span data-stu-id="3d381-215">The data from this fully-managed service can scale to any volume while still achieving high throughput, low latency, and resiliency.</span></span>
* <span data-ttu-id="3d381-216">[Azure Apptjänst][lnk-appservices]: en molnplattform för att skapa kraftfulla webb- och mobilappar som ansluter till data var som helst; i molnet eller lokalt.</span><span class="sxs-lookup"><span data-stu-id="3d381-216">[Azure App Services][lnk-appservices]: A cloud platform to build powerful web and mobile apps that connect to data anywhere; in the cloud or on-premises.</span></span> <span data-ttu-id="3d381-217">Skapa spännande mobilappar för iOS, Android och Windows.</span><span class="sxs-lookup"><span data-stu-id="3d381-217">Build engaging mobile apps for iOS, Android, and Windows.</span></span> <span data-ttu-id="3d381-218">Integrera med programvara som en tjänst (SaaS) och företagsprogram med out box anslutningen till massor av molnbaserade tjänster och företagsprogram.</span><span class="sxs-lookup"><span data-stu-id="3d381-218">Integrate with your Software as a Service (SaaS) and enterprise applications with out-of-the-box connectivity to dozens of cloud-based services and enterprise applications.</span></span> <span data-ttu-id="3d381-219">Kod i dina Favoriter språk och IDE (.NET, Node.js, PHP, Python eller Java) att skapa webbprogram och API: er snabbare än någonsin.</span><span class="sxs-lookup"><span data-stu-id="3d381-219">Code in your favorite language and IDE (.NET, Node.js, PHP, Python, or Java) to build web apps and APIs faster than ever.</span></span>
* <span data-ttu-id="3d381-220">[Logic Apps][lnk-logicapps]: funktion i Logic Apps i Azure App Service hjälper till att integrera IoT-lösningen till din befintliga line-of-business-system och automatisera arbetsflödesprocesser.</span><span class="sxs-lookup"><span data-stu-id="3d381-220">[Logic Apps][lnk-logicapps]: The Logic Apps feature of Azure App Service helps integrate your IoT solution to your existing line-of-business systems and automate workflow processes.</span></span> <span data-ttu-id="3d381-221">Logic Apps kan utvecklare utforma arbetsflöden som startar från en utlösare och sedan exekverar en följd av steg, regler och åtgärder som använder kraftfulla kopplingar för att integrera med dina affärsprocesser.</span><span class="sxs-lookup"><span data-stu-id="3d381-221">Logic Apps enables developers to design workflows that start from a trigger and then execute a series of steps—rules and actions that use powerful connectors to integrate with your business processes.</span></span> <span data-ttu-id="3d381-222">Logic Apps erbjuder out box-anslutning till ett brett spektrum av SaaS, molnbaserade, och lokala program.</span><span class="sxs-lookup"><span data-stu-id="3d381-222">Logic Apps offers out-of-the-box connectivity to a vast ecosystem of SaaS, cloud-based, and on-premises applications.</span></span>
* <span data-ttu-id="3d381-223">[Azure-blobblagring][lnk-blob]: tillförlitliga ekonomiska molnlagring för de data som dina enheter skicka till molnet.</span><span class="sxs-lookup"><span data-stu-id="3d381-223">[Azure blob storage][lnk-blob]: Reliable, economical cloud storage for the data that your devices send to the cloud.</span></span>

## <a name="conclusion"></a><span data-ttu-id="3d381-224">Slutsats</span><span class="sxs-lookup"><span data-stu-id="3d381-224">Conclusion</span></span>
<span data-ttu-id="3d381-225">Den här artikeln innehåller översikt över implementering information för att utforma och distribuera en IoT-infrastruktur med hjälp av Azure IoT.</span><span class="sxs-lookup"><span data-stu-id="3d381-225">This article provides overview of implementation level details for designing and deploying an IoT infrastructure using Azure IoT.</span></span> <span data-ttu-id="3d381-226">Nyckeln i att skydda den övergripande IoT-infrastrukturen är att konfigurera varje komponent säker.</span><span class="sxs-lookup"><span data-stu-id="3d381-226">Configuring each component to be secure is key in securing the overall IoT infrastructure.</span></span> <span data-ttu-id="3d381-227">Designalternativ som är tillgängliga i Azure IoT tillhandahåller en viss nivå flexibilitet och val. varje alternativ kan dock ha säkerhetsaspekter.</span><span class="sxs-lookup"><span data-stu-id="3d381-227">The design choices available in Azure IoT provide some level of flexibility and choice; however, each choice may have security implications.</span></span> <span data-ttu-id="3d381-228">Du rekommenderas att var och en av dessa alternativ att utvärderas via en utvärdering av risk/kostnad.</span><span class="sxs-lookup"><span data-stu-id="3d381-228">It is recommended that each of these choices be evaluated through a risk/cost assessment.</span></span>

[img-overview]: media/iot-secure-your-deployment/overview.png

[lnk-security-tokens]: ../articles/iot-hub/iot-hub-devguide-security.md#security-token-structure
[lnk-sas-tokens]: ../articles/iot-hub/iot-hub-devguide-security.md#use-sas-tokens-in-a-device-app
[lnk-identity-registry]: ../articles/iot-hub/iot-hub-devguide-identity-registry.md
[lnk-protocols]: ../articles/iot-hub/iot-hub-devguide-security.md
[lnk-custom-auth]: ../articles/iot-hub/iot-hub-devguide-security.md#custom-device-authentication
[lnk-x509]: http://www.itu.int/rec/T-REC-X.509-201210-I/en
[lnk-use-x509]: ../articles/iot-hub/iot-hub-devguide-security.md
[lnk-tls12]: https://tools.ietf.org/html/rfc5246
[lnk-service-tokens]: ../articles/iot-hub/iot-hub-devguide-security.md#use-security-tokens-from-service-components
[lnk-docdb]: https://azure.microsoft.com/services/documentdb/
[lnk-asa]: https://azure.microsoft.com/services/stream-analytics/
[lnk-appservices]: https://azure.microsoft.com/services/app-service/
[lnk-logicapps]: https://azure.microsoft.com/services/app-service/logic/
[lnk-blob]: https://azure.microsoft.com/services/storage/
